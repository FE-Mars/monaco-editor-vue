{"version":3,"sources":["webpack://monaco-editor-vue/webpack/bootstrap","webpack://monaco-editor-vue/./node_modules/core-js/modules/_iter-define.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/currentLineMarginHighlight/currentLineMarginHighlight.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/menu/menu.css?ed14","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/actionbar/actionbar.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/es7.promise.finally.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/indentGuides/indentGuides.css?1251","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/media/diffReview.css?2799","webpack://monaco-editor-vue/./node_modules/core-js/modules/_object-keys.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_object-gopd.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_object-dps.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/controller/textAreaHandler.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/scrollbar/media/scrollbars.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_task.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/marginDecorations/marginDecorations.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_iter-call.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_dom-create.js","webpack://monaco-editor-vue/./node_modules/css-loader/lib/css-base.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_classof.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_object-gops.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lineNumbers/lineNumbers.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/linesDecorations/linesDecorations.css?0d0c","webpack://monaco-editor-vue/./node_modules/core-js/modules/core.get-iterator-method.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lineNumbers/lineNumbers.css?8653","webpack://monaco-editor-vue/./node_modules/core-js/modules/_redefine.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_object-create.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_wks.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_library.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_cof.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/platform.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_invoke.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_hide.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_is-array-iter.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/aria/aria.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLines.css?ce6e","webpack://monaco-editor-vue/./node_modules/core-js/modules/_object-gpo.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/contextview/contextview.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/indentGuides/indentGuides.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_iter-create.js","webpack://monaco-editor-vue/./node_modules/node-libs-browser/mock/process.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/browser/standalone-tokens.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_to-integer.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_property-desc.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/decorations/decorations.css","webpack://monaco-editor-vue/./node_modules/vue-style-loader/lib/listToStyles.js","webpack://monaco-editor-vue/./node_modules/vue-style-loader/lib/addStylesClient.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/media/diffReview.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_for-of.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_to-object.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/contextview/contextview.css?47d8","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/currentLineMarginHighlight/currentLineMarginHighlight.css?0ee1","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/aria/aria.css?5ce2","webpack://monaco-editor-vue/./node_modules/core-js/modules/_object-pie.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/winjs.base.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/es6.promise.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_shared.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/decorations/decorations.css?bc75","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/controller/textAreaHandler.css?a9f1","webpack://monaco-editor-vue/./node_modules/core-js/modules/_export.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_iter-detect.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/marginDecorations/marginDecorations.css?c3a1","webpack://monaco-editor-vue/./node_modules/core-js/modules/_inherit-if-required.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_shared-key.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_iobject.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/glyphMargin/glyphMargin.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_to-iobject.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_has.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_to-primitive.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.css?14bf","webpack://monaco-editor-vue/./node_modules/core-js/modules/_object-assign.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_global.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_to-absolute-index.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/selections/selections.css?7c0f","webpack://monaco-editor-vue/./node_modules/core-js/modules/_fails.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/contextview/browser/contextMenuHandler.css?f985","webpack://monaco-editor-vue/./node_modules/core-js/modules/_set-species.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/scrollbar/media/scrollbars.css?f6fb","webpack://monaco-editor-vue/./node_modules/core-js/modules/_set-to-string-tag.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_microtask.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_core.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/glyphMargin/glyphMargin.css?fb2d","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/selections/selections.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_iterators.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_object-dp.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_set-proto.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_object-gopn.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLines.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/currentLineHighlight/currentLineHighlight.css?5961","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/media/diffEditor.css?2c80","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/media/editor.css?d735","webpack://monaco-editor-vue/./node_modules/core-js/modules/_ctx.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_add-to-unscopables.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_perform.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_to-length.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_descriptors.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_user-agent.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_new-promise-capability.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/linesDecorations/linesDecorations.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/media/editor.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_string-trim.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/browser/standalone-tokens.css?bb63","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/media/tokens.css?e59a","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/sash/sash.css?3885","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/sash/sash.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_promise-resolve.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/parts/tree/browser/tree.css?24d4","webpack://monaco-editor-vue/./node_modules/core-js/modules/_defined.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimap.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_array-includes.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/es6.number.constructor.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_ie8-dom-define.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/actionbar/actionbar.css?8685","webpack://monaco-editor-vue/(webpack)/buildin/global.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_uid.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/es6.array.iterator.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_an-object.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_object-keys-internal.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_is-object.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_iter-step.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.css?3fbf","webpack://monaco-editor-vue/./node_modules/core-js/modules/_a-function.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursors.css?8df0","webpack://monaco-editor-vue/./node_modules/core-js/modules/_redefine-all.js","webpack://monaco-editor-vue/./node_modules/path-browserify/index.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/media/diffEditor.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_enum-bug-keys.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/currentLineHighlight/currentLineHighlight.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/contextview/browser/contextMenuHandler.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/rulers/rulers.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursors.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/parts/tree/browser/tree.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_species-constructor.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/rulers/rulers.css?074b","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.css","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimap.css?c842","webpack://monaco-editor-vue/./node_modules/core-js/modules/_an-instance.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/media/tokens.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/es6.object.assign.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/menu/menu.css","webpack://monaco-editor-vue/./node_modules/core-js/modules/_html.js","webpack://monaco-editor-vue/./node_modules/@vue/cli-service/lib/commands/build/setPublicPath.js","webpack://monaco-editor-vue/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://monaco-editor-vue/./node_modules/@babel/runtime/helpers/esm/objectSpread.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/errors.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/functional.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/lifecycle.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/iterator.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/linkedList.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/event.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/cancellation.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/async.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/winjs.polyfill.promise.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/nls.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/arrays.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/types.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/objects.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/wordHelper.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/config/editorOptions.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/keyCodes.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/uri.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/core/position.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/core/range.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/core/selection.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/core/token.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/standalone/standaloneEnums.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/standalone/standaloneBase.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/instantiation/common/instantiation.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/services/codeEditorService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/browser.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/event.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/keyboardEvent.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/iframe.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/mouseEvent.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/dom.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/marshalling.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/network.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/strings.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/paths.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/resources.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/commands/common/commands.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/telemetry/common/telemetry.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/telemetry/common/telemetryUtils.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/services/openerService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/assert.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/diffNavigator.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/config/editorZoom.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/config/fontInfo.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/editorCommon.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/map.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/glob.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/languageSelector.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/services/modelService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/languageFeatureRegistry.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/tokenizationRegistry.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/nullMode.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/services/editorWorkerService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/services/resolverService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/worker/simpleWorker.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/worker/defaultWorkerFactory.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/languageConfiguration.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/supports.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/supports/characterPair.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/supports/richEditBrackets.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/supports/electricCharacter.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/supports/indentRules.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/supports/onEnter.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/languageConfigurationRegistry.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/diff/diffChange.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/diff/diff.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/diff/diffComputer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/core/uint.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewModel/prefixSumComputer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/mirrorTextModel.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/core/characterClassifier.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/linkComputer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/supports/inplaceReplaceSupport.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/services/editorSimpleWorker.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/services/resourceConfiguration.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/services/editorWorkerServiceImpl.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/services/webWorker.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/core/lineTokens.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/core/stringBuilder.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewLayout/lineDecorations.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewLayout/viewLineRenderer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewModel/viewModel.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/browser/colorizer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/severity.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/editorBrowser.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/registry/common/platform.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/jsonschemas/common/jsonContributionRegistry.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/configuration/common/configurationRegistry.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/config/commonEditorConfig.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/core/editOperation.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/contextkey/common/contextkey.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/actions.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/actions/common/actions.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/actions/common/menu.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/configuration/common/configuration.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/configuration/common/configurationModels.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/keybinding/common/abstractKeybindingService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/keybinding/common/keybindingResolver.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/keybinding/common/keybindingsRegistry.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/keybinding/common/resolvedKeybindingItem.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/keybindingLabels.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/keybinding/common/usLayoutResolvedKeybinding.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/notification/common/notification.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/workspace/common/workspace.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/browser/simpleServices.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/aria/aria.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/config/charWidthReader.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/config/elementSizeObserver.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/config/configuration.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/editorExtensions.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/fastDomNode.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/decorators.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/touch.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/globalMouseMoveMonitor.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/editorDom.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewModel/viewEventHandler.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/view/viewPart.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/view/renderingContext.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/rangeUtil.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/theme/common/themeService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLine.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/controller/mouseTarget.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/controller/mouseHandler.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/controller/pointerHandler.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/controller/textAreaState.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/controller/textAreaInput.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/view/dynamicViewOverlay.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/color.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/theme/common/colorRegistry.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/view/editorColorRegistry.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lineNumbers/lineNumbers.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/margin/margin.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/controller/wordCharacterClassifier.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/view/viewEvents.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/controller/textAreaHandler.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/stopwatch.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/editStack.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/indentationGuesser.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/intervalTree.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/pieceTreeTextBuffer/rbTreeBase.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/textModelSearch.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/pieceTreeTextBuffer/pieceTreeBase.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/pieceTreeTextBuffer/pieceTreeTextBuffer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/pieceTreeTextBuffer/pieceTreeTextBufferBuilder.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/textModelEvents.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/textModelTokens.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/model/textModel.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/controller/cursorCommon.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/controller/cursorColumnSelection.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/commands/replaceCommand.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/controller/cursorMoveOperations.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/controller/cursorDeleteOperations.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/controller/cursorWordOperations.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/controller/cursorMoveCommands.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/commands/shiftCommand.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/commands/surroundSelectionCommand.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/controller/cursorTypeOperations.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/editorContextKeys.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/controller/coreCommands.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/view/viewController.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/view/viewLayer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/view/viewOverlays.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/contentWidgets/contentWidgets.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/currentLineHighlight/currentLineHighlight.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/currentLineMarginHighlight/currentLineMarginHighlight.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/decorations/decorations.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/widget.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/scrollbar/scrollbarArrow.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/scrollbar/scrollbarVisibilityController.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/scrollbar/abstractScrollbar.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/scrollbar/scrollbarState.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/scrollbar/horizontalScrollbar.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/scrollbar/verticalScrollbar.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/scrollable.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/scrollbar/scrollableElement.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/editorScrollbar/editorScrollbar.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/glyphMargin/glyphMargin.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/indentGuides/indentGuides.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLines.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/linesDecorations/linesDecorations.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/marginDecorations/marginDecorations.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/core/rgba.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/view/minimapCharRenderer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/view/runtimeMinimapCharRenderer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimap.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/view/overviewZoneManager.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overviewRuler/overviewRuler.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/rulers/rulers.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/selections/selections.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursor.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursors.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewZones/viewZones.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/view/viewContext.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/view/viewEventDispatcher.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewLayout/viewLinesViewportData.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/view/viewImpl.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/view/viewOutgoingEvents.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/controller/oneCursor.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/controller/cursorCollection.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/controller/cursor.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/editorAction.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/textToHtmlTokenizer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewLayout/whitespaceComputer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewLayout/linesLayout.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewLayout/viewLayout.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewModel/splitLinesCollection.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewModel/characterHardWrappingLineMapper.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewModel/viewModelDecorations.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/viewModel/viewModelImpl.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/instantiation/common/serviceCollection.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/codeEditorWidget.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/sash/sash.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/core/editorState.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/actionbar/actionbar.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/diffReview.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/widget/diffEditorWidget.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/common/standaloneThemeService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/contextview/browser/contextView.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/keybinding/common/keybinding.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneCodeEditor.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/services/bulkEditService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/services/modeService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/abstractMode.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/mime.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/modesRegistry.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/services/languagesRegistry.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/services/modeServiceImpl.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/htmlContent.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/markers/common/markers.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/services/modelServiceImpl.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/services/abstractCodeEditorService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/browser/services/codeEditorServiceImpl.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneCodeServiceImpl.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/common/modes/supports/tokenization.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/common/themes.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneThemeServiceImpl.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/contextkey/browser/contextKeyService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/menu/menu.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/theme/common/styler.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/contextview/browser/contextMenuHandler.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/contextview/browser/contextMenuService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/range.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/ui/contextview/contextview.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/log/common/log.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/contextview/browser/contextViewService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/dialogs/common/dialogs.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/common/collections.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/instantiation/common/graph.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/instantiation/common/descriptors.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/instantiation/common/instantiationService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/label/common/label.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeDefaults.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeModel.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeDnd.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeViewModel.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/parts/tree/browser/tree.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/browser/dnd.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeView.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeImpl.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/list/browser/listService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/markers/common/markerService.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/progress/common/progress.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/storage/common/storage.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneServices.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/platform/opener/common/opener.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneEditor.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/common/monarch/monarchCommon.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/common/monarch/monarchCompile.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/common/monarch/monarchLexer.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneLanguages.js","webpack://monaco-editor-vue/./node_modules/monaco-editor/esm/vs/editor/editor.api.js","webpack://monaco-editor-vue/./src/index.js","webpack://monaco-editor-vue/./node_modules/@vue/cli-service/lib/commands/build/entry-lib.js","webpack://monaco-editor-vue/./node_modules/core-js/modules/_string-ws.js"],"names":["noop","name","props","diffEditor","type","Boolean","default","width","String","Number","height","original","value","language","theme","options","Object","editorMounted","Function","editorBeforeMount","watch","deep","handler","editor","updateOptions","getValue","setValue","getModel","modified","monaco","setModelLanguage","setTheme","style","$nextTick","layout","computed","test","mounted","initMonaco","beforeDestroy","dispose","render","h","methods","assign","_editorBeforeMount","$el","_setModel","_editorMounted","originalModel","createModel","modifiedModel","setModel","onDidUpdateDiff","_emitChange","event","onDidChangeModelContent","$emit"],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;AClFa;AACb,cAAc,mBAAO,CAAC,MAAY;AAClC,cAAc,mBAAO,CAAC,MAAW;AACjC,eAAe,mBAAO,CAAC,MAAa;AACpC,WAAW,mBAAO,CAAC,MAAS;AAC5B,gBAAgB,mBAAO,CAAC,MAAc;AACtC,kBAAkB,mBAAO,CAAC,MAAgB;AAC1C,qBAAqB,mBAAO,CAAC,MAAsB;AACnD,qBAAqB,mBAAO,CAAC,MAAe;AAC5C,eAAe,mBAAO,CAAC,MAAQ;AAC/B,8CAA8C;AAC9C;AACA;AACA;;AAEA,8BAA8B,aAAa;;AAE3C;AACA;AACA;AACA;AACA;AACA,yCAAyC,oCAAoC;AAC7E,6CAA6C,oCAAoC;AACjF,KAAK,4BAA4B,oCAAoC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,mBAAmB;AACnC;AACA;AACA,kCAAkC,2BAA2B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;;;;;;ACpEA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,sDAAsD,cAAc,kBAAkB,OAAO,MAAM,sBAAsB,gGAAgG,eAAe;;AAE/P;;;;;;;;ACPA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,kCAAkC,kBAAkB,MAAM,OAAO;;AAExF;;;;;;;;ACPA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAA4I;AAClK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,sBAAsB,iBAAiB,gBAAgB,mBAAmB,sCAAsC,aAAa,cAAc,UAAU,WAAW,yBAAyB,+CAA+C,qBAAqB,8CAA8C,2BAA2B,gCAAgC,eAAe,qBAAqB,+BAA+B,kBAAkB,yCAAyC,eAAe,gDAAgD,6BAA6B,sCAAsC,qBAAqB,iCAAiC,eAAe,iBAAiB,yCAAyC,eAAe,iBAAiB,kBAAkB,oHAAoH,WAAW,4BAA4B,gBAAgB,yCAAyC,cAAc,oDAAoD,cAAc,6BAA6B,gBAAgB,iBAAiB,kBAAkB,yDAAyD,yBAAyB,oDAAoD,gBAAgB,iDAAiD,gBAAgB,OAAO,gBAAgB,eAAe,aAAa,mBAAmB,uBAAuB;;AAEt9C;;;;;;;;;ACPA;AACa;AACb,cAAc,mBAAO,CAAC,MAAW;AACjC,WAAW,mBAAO,CAAC,MAAS;AAC5B,aAAa,mBAAO,CAAC,MAAW;AAChC,yBAAyB,mBAAO,CAAC,MAAwB;AACzD,qBAAqB,mBAAO,CAAC,MAAoB;;AAEjD,2CAA2C;AAC3C;AACA;AACA;AACA;AACA,8DAA8D,UAAU,EAAE;AAC1E,KAAK;AACL;AACA,8DAA8D,SAAS,EAAE;AACzE,KAAK;AACL;AACA,CAAC,EAAE;;;;;;;;ACnBH;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAoJ;AAC1K,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAkJ;AACxK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;AACA,YAAY,mBAAO,CAAC,MAAyB;AAC7C,kBAAkB,mBAAO,CAAC,MAAkB;;AAE5C;AACA;AACA;;;;;;;;ACNA,UAAU,mBAAO,CAAC,MAAe;AACjC,iBAAiB,mBAAO,CAAC,MAAkB;AAC3C,gBAAgB,mBAAO,CAAC,MAAe;AACvC,kBAAkB,mBAAO,CAAC,MAAiB;AAC3C,UAAU,mBAAO,CAAC,MAAQ;AAC1B,qBAAqB,mBAAO,CAAC,MAAmB;AAChD;;AAEA,YAAY,mBAAO,CAAC,MAAgB;AACpC;AACA;AACA;AACA;AACA,GAAG,YAAY;AACf;AACA;;;;;;;;ACfA,SAAS,mBAAO,CAAC,MAAc;AAC/B,eAAe,mBAAO,CAAC,MAAc;AACrC,cAAc,mBAAO,CAAC,MAAgB;;AAEtC,iBAAiB,mBAAO,CAAC,MAAgB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACZA,2BAA2B,mBAAO,CAAC,MAA8C;AACjF;;;AAGA;AACA,cAAc,QAAS,6BAA6B,YAAY,aAAa,SAAS,UAAU,kBAAkB,uBAAuB,YAAY,YAAY,gBAAgB,kBAAkB,6BAA6B,oCAAoC,WAAW;;AAE/Q;;;;;;;;ACPA,2BAA2B,mBAAO,CAAC,MAAoD;AACvF;;;AAGA;AACA,cAAc,QAAS,mDAAmD,oCAAoC,uOAAuO,eAAe,kDAAkD,oCAAoC,uOAAuO,eAAe,kDAAkD,oCAAoC,uOAAuO,eAAe,mDAAmD,oCAAoC,uOAAuO,eAAe,mHAAmH,oCAAoC,uOAAuO,uHAAuH,oCAAoC,uOAAuO,uHAAuH,oCAAoC,uOAAuO,yHAAyH,oCAAoC,uOAAuO,oCAAoC,UAAU,uBAAuB,8BAA8B,sCAAsC,UAAU,oBAAoB,2CAA2C,8BAA8B,mCAAmC,kBAAkB,aAAa,uCAAuC,cAAc,MAAM,SAAS,WAAW,WAAW,qCAAqC,wCAAwC,cAAc,QAAQ,OAAO,YAAY,UAAU,qCAAqC,mDAAmD,cAAc,MAAM,OAAO,WAAW,UAAU,4CAA4C,uCAAuC,kDAAkD,+BAA+B,uDAAuD,+BAA+B,wDAAwD,gCAAgC,oDAAoD,+BAA+B,8DAA8D,gCAAgC,qDAAqD,0BAA0B,8DAA8D,+BAA+B,+DAA+D,mBAAmB,gDAAgD,gBAAgB,iDAAiD,qCAAqC,qDAAqD,uCAAuC,yJAAyJ,gBAAgB;;AAE/nJ;;;;;;;;ACPA,UAAU,mBAAO,CAAC,MAAQ;AAC1B,aAAa,mBAAO,CAAC,MAAW;AAChC,WAAW,mBAAO,CAAC,MAAS;AAC5B,UAAU,mBAAO,CAAC,MAAe;AACjC,aAAa,mBAAO,CAAC,MAAW;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,mBAAO,CAAC,MAAQ;AACtB;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACnFA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,8CAA8C,kBAAkB,OAAO,WAAW,YAAY;;AAErH;;;;;;;;ACPA;AACA,eAAe,mBAAO,CAAC,MAAc;AACrC;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;;;;;;;ACXA,eAAe,mBAAO,CAAC,MAAc;AACrC,eAAe,mBAAO,CAAC,MAAW;AAClC;AACA;AACA;AACA;AACA;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mCAAmC,gBAAgB;AACnD,IAAI;AACJ;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA,YAAY,oBAAoB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,oDAAoD,cAAc;;AAElE;AACA;;;;;;;;AC3EA;AACA,UAAU,mBAAO,CAAC,MAAQ;AAC1B,UAAU,mBAAO,CAAC,MAAQ;AAC1B;AACA,2BAA2B,kBAAkB,EAAE;;AAE/C;AACA;AACA;AACA;AACA,GAAG,YAAY;AACf;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACtBA;;;;;;;;ACAA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,sDAAsD,kBAAkB,iBAAiB,qBAAqB,sBAAsB,sBAAsB,eAAe,YAAY,6CAA6C,gBAAgB,qBAAqB,WAAW,mDAAmD,kDAAkD,+PAA+P,wQAAwQ,uDAAuD,kDAAkD,2XAA2X,gZAAgZ,0DAA0D,eAAe;;AAEl1D;;;;;;;;ACPA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAwJ;AAC9K,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF,cAAc,mBAAO,CAAC,MAAY;AAClC,eAAe,mBAAO,CAAC,MAAQ;AAC/B,gBAAgB,mBAAO,CAAC,MAAc;AACtC,iBAAiB,mBAAO,CAAC,MAAS;AAClC;AACA;AACA;AACA;;;;;;;;ACPA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAmJ;AACzK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF,aAAa,mBAAO,CAAC,MAAW;AAChC,WAAW,mBAAO,CAAC,MAAS;AAC5B,UAAU,mBAAO,CAAC,MAAQ;AAC1B,UAAU,mBAAO,CAAC,MAAQ;AAC1B;AACA;AACA;;AAEA,mBAAO,CAAC,MAAS;AACjB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA,CAAC;AACD;AACA,CAAC;;;;;;;;AC9BD;AACA,eAAe,mBAAO,CAAC,MAAc;AACrC,UAAU,mBAAO,CAAC,MAAe;AACjC,kBAAkB,mBAAO,CAAC,MAAkB;AAC5C,eAAe,mBAAO,CAAC,MAAe;AACtC,yBAAyB;AACzB;;AAEA;AACA;AACA;AACA,eAAe,mBAAO,CAAC,MAAe;AACtC;AACA;AACA;AACA;AACA;AACA,EAAE,mBAAO,CAAC,MAAS;AACnB,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;;ACxCA,YAAY,mBAAO,CAAC,MAAW;AAC/B,UAAU,mBAAO,CAAC,MAAQ;AAC1B,aAAa,mBAAO,CAAC,MAAW;AAChC;;AAEA;AACA;AACA;AACA;;AAEA;;;;;;;;ACVA;;;;;;;;ACAA,iBAAiB;;AAEjB;AACA;AACA;;;;;;;;;ACJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gDAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACA;AACA;AACA;AACA;AACP,0FAA0F;AACnF;AACP;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;;;;;;;;;AC/EP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;ACfA,SAAS,mBAAO,CAAC,MAAc;AAC/B,iBAAiB,mBAAO,CAAC,MAAkB;AAC3C,iBAAiB,mBAAO,CAAC,MAAgB;AACzC;AACA,CAAC;AACD;AACA;AACA;;;;;;;;ACPA;AACA,gBAAgB,mBAAO,CAAC,MAAc;AACtC,eAAe,mBAAO,CAAC,MAAQ;AAC/B;;AAEA;AACA;AACA;;;;;;;;ACPA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,0BAA0B,kBAAkB,YAAY;;AAE/E;;;;;;;;ACPA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAiJ;AACvK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;AACA,UAAU,mBAAO,CAAC,MAAQ;AAC1B,eAAe,mBAAO,CAAC,MAAc;AACrC,eAAe,mBAAO,CAAC,MAAe;AACtC;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;ACZA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,iBAAiB,kBAAkB,aAAa;;AAEvE;;;;;;;;ACPA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,4EAA4E,kBAAkB;;AAErH;;;;;;;;;ACPa;AACb,aAAa,mBAAO,CAAC,MAAkB;AACvC,iBAAiB,mBAAO,CAAC,MAAkB;AAC3C,qBAAqB,mBAAO,CAAC,MAAsB;AACnD;;AAEA;AACA,mBAAO,CAAC,MAAS,qBAAqB,mBAAO,CAAC,MAAQ,4BAA4B,aAAa,EAAE;;AAEjG;AACA,qDAAqD,4BAA4B;AACjF;AACA;;;;;;;;ACZA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA,0BAA0B,mBAAO,CAAC,MAAM;AACxC;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;;;;;;;AC7BA,2BAA2B,mBAAO,CAAC,MAA8C;AACjF;;;AAGA;AACA,cAAc,QAAS,kBAAkB,iHAAiH,ySAAyS,mBAAmB,uBAAuB,SAAS,wBAAwB,8BAA8B,6CAA6C,mGAAmG,kCAAkC,cAAc,eAAe,yDAAyD,sCAAsC,iEAAiE,kCAAkC,uEAAuE,qCAAqC,+DAA+D,8BAA8B,yEAAyE,2BAA2B,mHAAmH,8BAA8B,uEAAuE,8BAA8B,gUAAgU,sCAAsC,iCAAiC,sBAAsB,yEAAyE,iCAAiC,yCAAyC,sBAAsB,uEAAuE,kCAAkC,iCAAiC,4IAA4I,yCAAyC,iCAAiC,sBAAsB,mEAAmE,4BAA4B,qGAAqG,8BAA8B,2BAA2B,qHAAqH,8BAA8B,qCAAqC,iHAAiH,iCAAiC,2BAA2B,sBAAsB,qGAAqG,8BAA8B,2BAA2B,4OAA4O,8BAA8B,qCAAqC,iHAAiH,iCAAiC,2BAA2B,sBAAsB,qHAAqH,8BAA8B,gCAAgC,4BAA4B,sBAAsB,qIAAqI,gCAAgC,oSAAoS,+BAA+B,6FAA6F,UAAU,2DAA2D,aAAa,6EAA6E,iCAAiC,iCAAiC,4JAA4J,iCAAiC,2EAA2E,iCAAiC,uMAAuM,8BAA8B,8BAA8B,qCAAqC,uMAAuM,8BAA8B,iCAAiC,2BAA2B,sBAAsB,yFAAyF,aAAa,sIAAsI,iCAAiC,qCAAqC,sBAAsB,sIAAsI,kCAAkC;;AAEviM;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACPA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,sCAAsC,kBAAkB;;AAE/E;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACe;AACf;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,wBAAwB;AAC3D,KAAK;AACL;AACA;AACA;AACA;AACA;;;AC1BA;AAAA;AACA;AACA;AACA;AACA;;AAEyC;;AAEzC;;AAEA;AACA;AACA;AACA;AACA,UAAU,iBAAiB;AAC3B;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEe;AACf;;AAEA;;AAEA,eAAe,YAAY;AAC3B;;AAEA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA,KAAK;AACL;AACA;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAiB,mBAAmB;AACpC;AACA;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA,YAAY,uBAAuB;AACnC;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,qBAAqB,uBAAuB;AAC5C;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC7NA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,gDAAgD,iBAAiB,qBAAqB,iCAAiC,kBAAkB,yBAAyB,qBAAqB,wBAAwB,sBAAsB,oBAAoB,iBAAiB,yCAAyC,kBAAkB,wCAAwC,kBAAkB,qCAAqC,gBAAgB,uCAAuC,cAAc,eAAe,qCAAqC,kBAAkB,WAAW,sCAAsC,mBAAmB,wCAAwC,qBAAqB,WAAW,yCAAyC,qBAAqB,kBAAkB,WAAW,QAAQ,uDAAuD,WAAW,YAAY,aAAa,yDAAyD,oCAAoC,yXAAyX,mIAAmI,oCAAoC,yXAAyX;;AAEt4D;;;;;;;;ACPA,UAAU,mBAAO,CAAC,MAAQ;AAC1B,WAAW,mBAAO,CAAC,MAAc;AACjC,kBAAkB,mBAAO,CAAC,MAAkB;AAC5C,eAAe,mBAAO,CAAC,MAAc;AACrC,eAAe,mBAAO,CAAC,MAAc;AACrC,gBAAgB,mBAAO,CAAC,MAA4B;AACpD;AACA;AACA;AACA,uCAAuC,iBAAiB,EAAE;AAC1D;AACA;AACA;AACA;AACA;AACA,mEAAmE,gBAAgB;AACnF;AACA;AACA,GAAG,4CAA4C,gCAAgC;AAC/E;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACxBA;AACA,cAAc,mBAAO,CAAC,MAAY;AAClC;AACA;AACA;;;;;;;;ACJA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAmJ;AACzK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAkK;AACxL,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;;AAEA;AACA,cAAc,mBAAO,CAAC,MAA4I;AAClK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF,cAAc;;;;;;;;;ACAd;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,mCAAmC;AACnC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,iCAAiC;;AAEjC;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;AAEA,uDAAuD;AACvD,CAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sCAAsC,SAAS;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,SAAS;AACzE;AACA;AACA;AACA,6BAA6B,UAAU;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,+BAA+B,gFAAgF;;AAE/G,qBAAqB,sEAAsE;;AAE3F,oBAAoB,oEAAoE;;AAExF,4BAA4B;;AAE5B,SAAS;;AAET,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D;AACA;AACA;AACA,6EAA6E,2EAA2E;AACxJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET,KAAK;;AAEL;AACA;AACA;AACA;;AAEA,CAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA,CAAC;;;AAGD;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,iCAAiC,0BAA0B,+BAA+B,EAAE;AAC5F,yEAAyE,qEAAqE;AAC9I;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,sBAAsB,gCAAgC;AACtD,yBAAyB,gCAAgC;AACzD;AACA,kCAAkC,oBAAoB;AACtD,aAAa;AACb;AACA,kCAAkC,mCAAmC;AACrE,aAAa;AACb,sBAAsB,gCAAgC;AACtD,yBAAyB,4BAA4B;AACrD;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,SAAS;AACjE;AACA;AACA;AACA;AACA;AACA,iCAAiC,6CAA6C;AAC9E,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,wDAAwD;AAC/G;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,SAAS;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL,CAAC;;;AAGD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;AAEA;;AAEA,iEAAiE,YAAY,GAAG,gCAAgC;AAChH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;;AAEpB;AACA;;AAEA,kBAAkB;;AAElB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,mBAAmB;AAC7D,aAAa;AACb;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,iEAAiE;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E,SAAS;AACnF;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E,SAAS;AACnF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8EAA8E,SAAS;AACvF;AACA;AACA;AACA,yBAAyB,mBAAmB,EAAE,aAAa;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,kFAAkF;AACjH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA,wCAAwC,qBAAqB,wBAAwB,EAAE,EAAE;AACzF,yCAAyC,sBAAsB;AAC/D,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,+BAA+B,aAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,QAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yCAAyC,kBAAkB;AAC3D,yCAAyC,kBAAkB;AAC3D;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,yCAAyC,uBAAuB;AAChE,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,WAAW,+BAA+B,EAAE,EAAE;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,+BAA+B;AAC1E;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA,6BAA6B;AAC7B,0CAA0C,uBAAuB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA,sDAAsD,sBAAsB,cAAc,EAAE;AAC5F,sDAAsD,qBAAqB,cAAc;AACzF;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA,kCAAkC,qBAAqB,EAAE;AACzD,uCAAuC,sBAAsB;AAC7D,aAAa;AACb;AACA;AACA;AACA,yBAAyB,mBAAmB,EAAE,YAAY,gBAAgB;AAC1E;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,yBAAyB,EAAE;AAC7D,kCAAkC,mBAAmB;AACrD;AACA;AACA,aAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA,CAAC;;AAED;AACO;AACA;AACA;AACP;;;;;;;;;;AC/iEa;AACb,cAAc,mBAAO,CAAC,MAAY;AAClC,aAAa,mBAAO,CAAC,MAAW;AAChC,UAAU,mBAAO,CAAC,MAAQ;AAC1B,cAAc,mBAAO,CAAC,MAAY;AAClC,cAAc,mBAAO,CAAC,MAAW;AACjC,eAAe,mBAAO,CAAC,MAAc;AACrC,gBAAgB,mBAAO,CAAC,MAAe;AACvC,iBAAiB,mBAAO,CAAC,MAAgB;AACzC,YAAY,mBAAO,CAAC,MAAW;AAC/B,yBAAyB,mBAAO,CAAC,MAAwB;AACzD,WAAW,mBAAO,CAAC,MAAS;AAC5B,gBAAgB,mBAAO,CAAC,MAAc;AACtC,iCAAiC,mBAAO,CAAC,MAA2B;AACpE,cAAc,mBAAO,CAAC,MAAY;AAClC,gBAAgB,mBAAO,CAAC,MAAe;AACvC,qBAAqB,mBAAO,CAAC,MAAoB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA,+CAA+C,EAAE,mBAAO,CAAC,MAAQ;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,YAAY;AACf,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,mBAAmB,kCAAkC;AACrD,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,eAAe,uCAAuC;AACtD;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH,kBAAkB,yBAAyB,KAAK;AAChD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,wBAAwB;AACxB,gBAAgB;AAChB,oBAAoB;AACpB,wBAAwB;AACxB,gBAAgB;AAChB,oBAAoB;AACpB;AACA,uBAAuB,mBAAO,CAAC,MAAiB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0DAA0D,oBAAoB;AAC9E,mBAAO,CAAC,MAAsB;AAC9B,mBAAO,CAAC,MAAgB;AACxB,UAAU,mBAAO,CAAC,MAAS;;AAE3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,gDAAgD,mBAAO,CAAC,MAAgB;AACxE;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,CAAC;;;;;;;;AC7RD,WAAW,mBAAO,CAAC,MAAS;AAC5B,aAAa,mBAAO,CAAC,MAAW;AAChC;AACA,kDAAkD;;AAElD;AACA,qEAAqE;AACrE,CAAC;AACD;AACA,QAAQ,mBAAO,CAAC,MAAY;AAC5B;AACA,CAAC;;;;;;;;ACXD;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAmJ;AACzK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAiJ;AACvK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA4D;AAC9E,6CAA6C,qCAAqC,E;;;;;;;ACRlF,aAAa,mBAAO,CAAC,MAAW;AAChC,WAAW,mBAAO,CAAC,MAAS;AAC5B,WAAW,mBAAO,CAAC,MAAS;AAC5B,eAAe,mBAAO,CAAC,MAAa;AACpC,UAAU,mBAAO,CAAC,MAAQ;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kFAAkF,uBAAuB;AACzG,iEAAiE;AACjE,+DAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,cAAc;AACd,cAAc;AACd,cAAc;AACd,eAAe;AACf,eAAe;AACf,eAAe;AACf,gBAAgB;AAChB;;;;;;;;AC1CA,eAAe,mBAAO,CAAC,MAAQ;AAC/B;;AAEA;AACA;AACA,iCAAiC,qBAAqB;AACtD;AACA,iCAAiC,SAAS,EAAE;AAC5C,CAAC,YAAY;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,SAAS,qBAAqB;AAC3D,iCAAiC,aAAa;AAC9C;AACA,GAAG,YAAY;AACf;AACA;;;;;;;;ACrBA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAyJ;AAC/K,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF,eAAe,mBAAO,CAAC,MAAc;AACrC,qBAAqB,mBAAO,CAAC,MAAc;AAC3C;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;ACRA,aAAa,mBAAO,CAAC,MAAW;AAChC,UAAU,mBAAO,CAAC,MAAQ;AAC1B;AACA;AACA;;;;;;;;ACJA;AACA,UAAU,mBAAO,CAAC,MAAQ;AAC1B;AACA;AACA;AACA;;;;;;;;ACLA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,gCAAgC,kBAAkB,MAAM,2CAA2C,kBAAkB;;AAE5I;;;;;;;;ACPA;AACA,cAAc,mBAAO,CAAC,MAAY;AAClC,cAAc,mBAAO,CAAC,MAAY;AAClC;AACA;AACA;;;;;;;;ACLA,uBAAuB;AACvB;AACA;AACA;;;;;;;;ACHA;AACA,eAAe,mBAAO,CAAC,MAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACXA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAsJ;AAC5K,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;;ACRrE;AACb;AACA,cAAc,mBAAO,CAAC,MAAgB;AACtC,WAAW,mBAAO,CAAC,MAAgB;AACnC,UAAU,mBAAO,CAAC,MAAe;AACjC,eAAe,mBAAO,CAAC,MAAc;AACrC,cAAc,mBAAO,CAAC,MAAY;AAClC;;AAEA;AACA,6BAA6B,mBAAO,CAAC,MAAU;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,UAAU,EAAE;AAChD,mBAAmB,sCAAsC;AACzD,CAAC,qCAAqC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC;;;;;;;;ACjCD;AACA;AACA;AACA;AACA;AACA,yCAAyC;;;;;;;;ACLzC,gBAAgB,mBAAO,CAAC,MAAe;AACvC;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACNA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAkJ;AACxK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;;;;;;ACNA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAoJ;AAC1K,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA4D;AAC9E,6CAA6C,qCAAqC,E;;;;;;;;ACRrE;AACb,aAAa,mBAAO,CAAC,MAAW;AAChC,SAAS,mBAAO,CAAC,MAAc;AAC/B,kBAAkB,mBAAO,CAAC,MAAgB;AAC1C,cAAc,mBAAO,CAAC,MAAQ;;AAE9B;AACA;AACA;AACA;AACA,sBAAsB,aAAa;AACnC,GAAG;AACH;;;;;;;;ACZA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAwJ;AAC9K,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAAkE;AACpF,6CAA6C,qCAAqC,E;;;;;;;ACRlF,UAAU,mBAAO,CAAC,MAAc;AAChC,UAAU,mBAAO,CAAC,MAAQ;AAC1B,UAAU,mBAAO,CAAC,MAAQ;;AAE1B;AACA,oEAAoE,iCAAiC;AACrG;;;;;;;;ACNA,aAAa,mBAAO,CAAC,MAAW;AAChC,gBAAgB,mBAAO,CAAC,MAAS;AACjC;AACA;AACA;AACA,aAAa,mBAAO,CAAC,MAAQ;;AAE7B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,uCAAuC,sBAAsB,EAAE;AAC/D;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;;;;;;;ACpEA,6BAA6B;AAC7B,uCAAuC;;;;;;;;ACDvC;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAmJ;AACzK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,uCAAuC,kBAAkB,gCAAgC,2BAA2B,mCAAmC,8BAA8B,iCAAiC,4BAA4B,oCAAoC,+BAA+B,yCAAyC,yBAAyB,4CAA4C,4BAA4B,0CAA0C,0BAA0B,6CAA6C,6BAA6B;;AAEpmB;;;;;;;;ACPA;;;;;;;;ACAA,eAAe,mBAAO,CAAC,MAAc;AACrC,qBAAqB,mBAAO,CAAC,MAAmB;AAChD,kBAAkB,mBAAO,CAAC,MAAiB;AAC3C;;AAEA,YAAY,mBAAO,CAAC,MAAgB;AACpC;AACA;AACA;AACA;AACA;AACA,GAAG,YAAY;AACf;AACA;AACA;AACA;;;;;;;;ACfA;AACA;AACA,eAAe,mBAAO,CAAC,MAAc;AACrC,eAAe,mBAAO,CAAC,MAAc;AACrC;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA,cAAc,mBAAO,CAAC,MAAQ,iBAAiB,mBAAO,CAAC,MAAgB;AACvE;AACA;AACA,OAAO,YAAY,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,GAAG;AACR;AACA;;;;;;;;ACxBA;AACA,YAAY,mBAAO,CAAC,MAAyB;AAC7C,iBAAiB,mBAAO,CAAC,MAAkB;;AAE3C;AACA;AACA;;;;;;;;ACNA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,2GAA2G,yBAAyB,iBAAiB,mFAAmF,yBAAyB,qBAAqB,wBAAwB,sBAAsB,oBAAoB,iBAAiB,2BAA2B,YAAY,mBAAmB,+EAA+E,4CAA4C,2KAA2K,sXAAsX,0BAA0B,kBAAkB,WAAW;;AAE7oC;;;;;;;;ACPA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAA4J;AAClL,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAkJ;AACxK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;;AAEA;AACA,cAAc,mBAAO,CAAC,MAA8I;AACpK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;AACA,gBAAgB,mBAAO,CAAC,MAAe;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACnBA;AACA,kBAAkB,mBAAO,CAAC,MAAQ;AAClC;AACA,0CAA0C,mBAAO,CAAC,MAAS,6BAA6B;AACxF;AACA;AACA;;;;;;;;ACNA;AACA;AACA,YAAY;AACZ,GAAG;AACH,YAAY;AACZ;AACA;;;;;;;;ACNA;AACA,gBAAgB,mBAAO,CAAC,MAAe;AACvC;AACA;AACA,2DAA2D;AAC3D;;;;;;;;ACLA;AACA,kBAAkB,mBAAO,CAAC,MAAU;AACpC,iCAAiC,QAAQ,mBAAmB,UAAU,EAAE,EAAE;AAC1E,CAAC;;;;;;;;ACHD,aAAa,mBAAO,CAAC,MAAW;AAChC;;AAEA;;;;;;;;;ACHa;AACb;AACA,gBAAgB,mBAAO,CAAC,MAAe;;AAEvC;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;ACjBA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,qCAAqC,kBAAkB,MAAM,gBAAgB,2CAA2C,kBAAkB,YAAY;;AAE7K;;;;;;;;ACPA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,eAAe,aAAa,oCAAoC,cAAc,eAAe,kBAAkB,iBAAiB,8BAA8B,wDAAwD,gDAAgD,gCAAgC,sDAAsD,8CAA8C,+BAA+B,kBAAkB,gBAAgB,8BAA8B,kBAAkB,MAAM;;AAExhB;;;;;;;;ACPA,cAAc,mBAAO,CAAC,MAAW;AACjC,cAAc,mBAAO,CAAC,MAAY;AAClC,YAAY,mBAAO,CAAC,MAAU;AAC9B,aAAa,mBAAO,CAAC,MAAc;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;AC7BA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAmJ;AACzK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA4D;AAC9E,6CAA6C,qCAAqC,E;;;;;;;ACRlF;;AAEA;AACA,cAAc,mBAAO,CAAC,MAA8I;AACpK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;;AAEA;AACA,cAAc,mBAAO,CAAC,MAA4I;AAClK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,gBAAgB,kBAAkB,WAAW,kBAAkB,sBAAsB,oBAAoB,sBAAsB,iBAAiB,MAAM,UAAU,YAAY,0BAA0B,kBAAkB,8BAA8B,gBAAgB,8BAA8B,gBAAgB,wBAAwB,iBAAiB,OAAO,WAAW,WAAW,4BAA4B,kBAAkB,gCAAgC,gBAAgB,gCAAgC,gBAAgB,qGAAqG,cAAc,WAAW,UAAU,YAAY,cAAc,kBAAkB,kBAAkB,8CAA8C,UAAU,SAAS,2CAA2C,UAAU,YAAY,gDAAgD,SAAS,UAAU,6CAA6C,SAAS,WAAW,sBAAsB,yBAAyB,4BAA4B,WAAW,8BAA8B,YAAY,kCAAkC,gBAAgB,iHAAiH,eAAe;;AAE7xC;;;;;;;;ACPA,eAAe,mBAAO,CAAC,MAAc;AACrC,eAAe,mBAAO,CAAC,MAAc;AACrC,2BAA2B,mBAAO,CAAC,MAA2B;;AAE9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACXA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAA4I;AAClK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;AACA;AACA;AACA;AACA;;;;;;;;ACJA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,4DAA4D,UAAU,8BAA8B,+HAA+H,UAAU,sCAAsC,kBAAkB,QAAQ,uCAAuC,kBAAkB,UAAU,UAAU;;AAEjZ;;;;;;;;ACPA;AACA;AACA,gBAAgB,mBAAO,CAAC,MAAe;AACvC,eAAe,mBAAO,CAAC,MAAc;AACrC,sBAAsB,mBAAO,CAAC,MAAsB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,YAAY,eAAe;AAChC;AACA,KAAK;AACL;AACA;;;;;;;;;ACtBa;AACb,aAAa,mBAAO,CAAC,MAAW;AAChC,UAAU,mBAAO,CAAC,MAAQ;AAC1B,UAAU,mBAAO,CAAC,MAAQ;AAC1B,wBAAwB,mBAAO,CAAC,MAAwB;AACxD,kBAAkB,mBAAO,CAAC,MAAiB;AAC3C,YAAY,mBAAO,CAAC,MAAU;AAC9B,WAAW,mBAAO,CAAC,MAAgB;AACnC,WAAW,mBAAO,CAAC,MAAgB;AACnC,SAAS,mBAAO,CAAC,MAAc;AAC/B,YAAY,mBAAO,CAAC,MAAgB;AACpC;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAO,CAAC,MAAkB;AAC/C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD;AACpD,KAAK;AACL;AACA,oCAAoC,cAAc,OAAO;AACzD,qCAAqC,cAAc,OAAO;AAC1D;AACA;AACA,oEAAoE,OAAO;AAC3E;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,0BAA0B,EAAE;AACtE;AACA;AACA,kBAAkB,mBAAO,CAAC,MAAgB;AAC1C;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,mBAAO,CAAC,MAAa;AACvB;;;;;;;;ACpEA,kBAAkB,mBAAO,CAAC,MAAgB,MAAM,mBAAO,CAAC,MAAU;AAClE,+BAA+B,mBAAO,CAAC,MAAe,gBAAgB,mBAAmB,UAAU,EAAE,EAAE;AACvG,CAAC;;;;;;;;ACFD;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAiJ;AACvK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;ACnBA;AACA;AACA;AACA;AACA;;;;;;;;;ACJa;AACb,uBAAuB,mBAAO,CAAC,MAAuB;AACtD,WAAW,mBAAO,CAAC,MAAc;AACjC,gBAAgB,mBAAO,CAAC,MAAc;AACtC,gBAAgB,mBAAO,CAAC,MAAe;;AAEvC;AACA;AACA;AACA;AACA,iBAAiB,mBAAO,CAAC,MAAgB;AACzC,gCAAgC;AAChC,cAAc;AACd,iBAAiB;AACjB;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;;;;;;;;ACjCA,eAAe,mBAAO,CAAC,MAAc;AACrC;AACA;AACA;AACA;;;;;;;;ACJA,UAAU,mBAAO,CAAC,MAAQ;AAC1B,gBAAgB,mBAAO,CAAC,MAAe;AACvC,mBAAmB,mBAAO,CAAC,MAAmB;AAC9C,eAAe,mBAAO,CAAC,MAAe;;AAEtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AChBA;AACA;AACA;;;;;;;;ACFA;AACA,UAAU;AACV;;;;;;;;ACFA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAwJ;AAC9K,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;AACA;AACA;AACA;;;;;;;;ACHA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAAmJ;AACzK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF,eAAe,mBAAO,CAAC,MAAa;AACpC;AACA;AACA;AACA;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,QAAQ;AACxC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU,MAAM;AAChB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,6BAA6B,IAAI;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC,8BAA8B;AAClE;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU,oBAAoB;AAC9B;AACA;;AAEA;AACA,UAAU,UAAU;AACpB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA,+BAA+B,sBAAsB;AACrD;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAmB,eAAe;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;;;;;;;;;AC/NA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,qCAAqC,UAAU,qCAAqC,2BAA2B,0CAA0C,+BAA+B,kCAAkC,mCAAmC,0BAA0B,qFAAqF,8BAA8B,qJAAqJ,uBAAuB,8EAA8E,gBAAgB,kEAAkE,WAAW,+CAA+C,+BAA+B,wDAAwD,gBAAgB,0HAA0H,oBAAoB,WAAW,4BAA4B,4BAA4B,wBAAwB,0BAA0B,8JAA8J,UAAU,6DAA6D,0CAA0C,+MAA+M,6DAA6D,0CAA0C,2JAA2J,4JAA4J,0CAA0C,+MAA+M,4JAA4J,0CAA0C,2JAA2J,8FAA8F,iBAAiB,8BAA8B,gCAAgC,mQAAmQ,sCAAsC,WAAW,uCAAuC,gBAAgB,uDAAuD,qBAAqB;;AAE3sG;;;;;;;;ACPA;AACA;AACA;AACA;;;;;;;;ACHA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,+CAA+C,cAAc,kBAAkB,OAAO,MAAM,sBAAsB;;AAEzI;;;;;;;;ACPA,2BAA2B,mBAAO,CAAC,MAA8C;AACjF;;;AAGA;AACA,cAAc,QAAS,8BAA8B,gBAAgB;;AAErE;;;;;;;;ACPA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,8BAA8B,kBAAkB,MAAM;;AAE7E;;;;;;;;ACPA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,iCAAiC,kBAAkB,MAAM,sCAAsC,kBAAkB,YAAY,gBAAgB,iEAAiE,sBAAsB,iCAAiC,mBAAmB,iBAAiB,6DAA6D,wBAAwB,0BAA0B,iCAAiC,sBAAsB,kEAAkE,wBAAwB,0BAA0B,iCAAiC,sBAAsB,gCAAgC,OAAO,UAAU,OAAO,WAAW,+BAA+B,OAAO,UAAU,OAAO,WAAW,gCAAgC,OAAO,oBAAoB,OAAO,qBAAqB,eAAe,+DAA+D,cAAc,8DAA8D,uBAAuB,+DAA+D;;AAE7lC;;;;;;;;ACPA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,gBAAgB,YAAY,WAAW,mBAAmB,yBAAyB,wBAAwB,2BAA2B,qBAAqB,oBAAoB,iBAAiB,kBAAkB,wCAAwC,YAAY,6DAA6D,YAAY,WAAW,kBAAkB,+BAA+B,kBAAkB,WAAW,YAAY,gDAAgD,2BAA2B,yBAAyB,0BAA0B,sBAAsB,eAAe,gBAAgB,WAAW,kBAAkB,yDAAyD,kBAAkB,YAAY,wBAAwB,qBAAqB,gBAAgB,mBAAmB,eAAe,kBAAkB,0DAA0D,aAAa,2FAA2F,cAAc,kBAAkB,cAAc,oCAAoC,yNAAyN,WAAW,YAAY,MAAM,WAAW,uFAAuF,0CAA0C,2KAA2K,qFAAqF,0CAA0C,miCAAmiC,8EAA8E,WAAW,oGAAoG,0CAA0C,uMAAuM,gGAAgG,0CAA0C,2KAA2K,8FAA8F,0CAA0C,2jCAA2jC,qGAAqG,0CAA0C,uMAAuM,iGAAiG,0CAA0C,mLAAmL,+FAA+F,0CAA0C,2jCAA2jC,iCAAiC,oCAAoC,6TAA6T,qFAAqF,oCAAoC,6TAA6T;;AAE51O;;;;;;;;ACPA;AACA,eAAe,mBAAO,CAAC,MAAc;AACrC,gBAAgB,mBAAO,CAAC,MAAe;AACvC,cAAc,mBAAO,CAAC,MAAQ;AAC9B;AACA;AACA;AACA;AACA;;;;;;;;ACRA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAA8I;AACpK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,qCAAqC,kBAAkB,MAAM,OAAO,WAAW;;AAEtG;;;;;;;;ACPA;;AAEA;AACA,cAAc,mBAAO,CAAC,MAA+I;AACrK,4CAA4C,QAAS;AACrD;AACA;AACA,UAAU,mBAAO,CAAC,MAA+D;AACjF,6CAA6C,qCAAqC,E;;;;;;;ACRlF;AACA;AACA;AACA,GAAG;AACH;;;;;;;;ACJA,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,iCAAiC,qBAAqB;;AAE7E;;;;;;;;ACPA;AACA,cAAc,mBAAO,CAAC,MAAW;;AAEjC,0CAA0C,SAAS,mBAAO,CAAC,MAAkB,GAAG;;;;;;;;ACHhF,2BAA2B,mBAAO,CAAC,MAAiD;AACpF;;;AAGA;AACA,cAAc,QAAS,4CAA4C,cAAc,iBAAiB,4DAA4D,cAAc,sDAAsD,UAAU,eAAe,oBAAoB,aAAa,6DAA6D,eAAe,2DAA2D,kBAAkB,cAAc,oBAAoB,aAAa,WAAW,mBAAmB,uDAAuD,kBAAkB,cAAc,qBAAqB,cAAc,gBAAgB,eAAe,cAAc,iHAAiH,qBAAqB,kBAAkB,cAAc,cAAc,iBAAiB,eAAe,cAAc,4DAA4D,YAAY,sCAAsC,uRAAuR,8BAA8B,uRAAuR,6JAA6J,WAAW,uEAAuE,qBAAqB,8BAA8B,yBAAyB,2BAA2B,0BAA0B,sBAAsB,SAAS,iEAAiE,mBAAmB,mBAAmB,WAAW,sEAAsE,0BAA0B,gBAAgB,UAAU,6DAA6D,cAAc,0DAA0D,kBAAkB,kBAAkB,sCAAsC,2OAA2O,8BAA8B,2OAA2O,UAAU,YAAY,oFAAoF,mBAAmB,oCAAoC,iHAAiH,UAAU,YAAY,qCAAqC,gCAAgC,kCAAkC,iCAAiC,6BAA6B,wLAAwL,UAAU,sDAAsD,6BAA6B,8CAA8C,gBAAgB,wEAAwE,gBAAgB;;AAE3vH;;;;;;;;ACPA,eAAe,mBAAO,CAAC,MAAW;AAClC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACDA;;AAEA;AACA,MAAM,eAAC;AACP,OAAO,eAAC,sCAAsC,eAAC,GAAG,eAAC;AACnD,IAAI,qBAAuB,GAAG,eAAC;AAC/B;AACA;;AAEA;AACe,sDAAI;;;ACVJ;AACf;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;AACA,C;;ACb8C;AAC/B;AACf,iBAAiB,sBAAsB;AACvC;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA,MAAM,eAAc;AACpB,KAAK;AACL;;AAEA;AACA,C;;;;;;;;;;;;;;;;;;;;;;;AClBA;AACA;AACA;AACA;AAC2C;AAC3C;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,8BAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACjB;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;;ACzIA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AChBO;AACP;AACA;AACA;AACO,SAAS,iBAAO;AACvB;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA,oCAAoC,yBAAyB,EAAE;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,iBAAO;AACf,QAAQ,iBAAO;AACf;AACA;AACA;AACO;AACP,YAAY,uBAAuB,QAAQ,iBAAO,cAAc,EAAE;AAClE;AACO;AACP,YAAY,uBAAuB,MAAM,EAAE;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,iBAAO;AACjC;AACA;AACA;AACA;AACA;AACA,qCAAqC,uBAAuB,EAAE,EAAE;AAChE;AACA,CAAC;AACqB;AACtB;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA,CAAC;AAC4B;;;ACtD7B;AACA;AACA;AACA;AACA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACM,WAAW;AACX;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,WAAW;AAC1C,gCAAgC,uBAAuB;AACvD;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,YAAY;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,2BAA2B,EAAE;AACzE;AACA;AACA;AACA,CAAC,4BAA4B;AAC7B;AACA;AACA,+BAA+B,WAAW;AAC1C,6BAA6B,oBAAoB;AACjD,+BAA+B,mBAAmB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;AACzB;AACA;AACA;AACA,+BAA+B,WAAW;AAC1C,6BAA6B,oBAAoB;AACjD,+BAA+B,mBAAmB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,sCAAsC;AACvF;AACA,CAAC;AACyB;;;AC9J1B;AACA;AACA;AACA;AACoC;AACpC,IAAI,eAAI;AACR;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,qBAAU;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,eAAI;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,eAAI;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,GAAG;AAC9B;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;AClGtB;AACA;AACA;AACA;AACgD;AACC;AAC6B;AACjC;AACtC;AACP;AACA,uBAAuB,uBAAuB,EAAE;AAChD,8BAA8B,oBAAoB;AAClD,CAAC,sBAAsB;AACvB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,aAAO;AACX;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,qBAAU;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,SAAS;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,CAAC;AACkB;AACnB,IAAI,sBAAgB;AACpB;AACA;AACA;AACA;AACA,2BAA2B,aAAO;AAClC,6CAA6C,mCAAmC,EAAE;AAClF,+CAA+C,qCAAqC;AACpF,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY,CAAC,IAAM;AAClC;AACA;AACA;AACA;AACA,0CAA0C,sBAAsB,EAAE;AAClE;AACA;AACA;AACA;AACA,0CAA0C,wBAAwB,EAAE;AACpE;AACA;AACA;AACA,2CAA2C,8BAA8B,EAAE;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AACrB,SAAS,UAAI;AACpB;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD,eAAe,kBAAkB,8BAA8B,4BAA4B,mCAAmC,EAAE,qBAAqB,EAAE;AACvJ;AACA;AACO;AACP,2BAA2B,aAAa;AACxC,6BAA6B,iBAAiB;AAC9C;AACA;AACA;AACA;AACA,sBAAsB,aAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,mCAAmC,EAAE;AAClF;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,gBAAgB,EAAE;AAC3D;AACA;AACA;AACA,CAAC;AACwB;AAClB;AACP;AACA,kCAAkC,iBAAiB;AACnD,mCAAmC,wCAAwC,EAAE;AAC7E;AACA;AACO;AACP;AACA,kCAAkC,iBAAiB;AACnD,mCAAmC,gDAAgD,EAAE;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,oBAAoB,EAAE;AAChD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACM,SAAS,WAAK;AACrB;AACA;AACA,IAAI,WAAK;AACT;AACA;AACA;AACA;AACA,kCAAkC,UAAU;AAC5C,2BAA2B,aAAO;AAClC;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;;;AC5XjB;AACA;AACA;AACA;AAC4C;AAC5C;AACA;AACA,YAAY,uBAAuB,sBAAsB,EAAE;AAC3D,CAAC;AACM,IAAI,8BAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA,6BAA6B,yBAAY;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,KAAK;AACtC,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,CAAC,EAAE,8BAAiB,KAAK,8BAAiB,KAAK;AAC/C,IAAI,yBAAY;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,aAAO;AAC3C;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,yBAAY;AAC9C;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,0BAA0B,8BAAiB;AAC3C;AACA,wCAAwC,yBAAY;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8BAAiB;AAC3C;AACA,wCAAwC,yBAAY;AACpD;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;;;ACnHnC;AACA;AACA;AACA;AACA,IAAI,aAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2D;AACtB;AACM;AACD;AACpC;AACP;AACA;AACO;AACP,qBAAqB,uBAAuB;AAC5C;AACA;AACA;AACA,mBAAmB,QAAe;AAClC,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,sBAAsB,EAAE;AACrD;AACA;AACA,IAAI,aAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2BAA2B;AAC1D;AACA;AACA;AACA,yCAAyC,8BAAQ;AACjD;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,0BAA0B,QAAe;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;AACZ,SAAS,aAAO;AACvB;AACA,yDAAyD,QAAQ,aAAO,gBAAgB,EAAE;AAC1F;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAe;AAClC,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAwB;AACpC;AACA;AACA,+BAA+B,uBAAuB,EAAE,gBAAgB,uBAAuB,EAAE;AACjG;AACA;AACO,SAAS,WAAK;AACrB,gCAAgC,4BAA4B,YAAY,GAAG;AAC3E,kCAAkC,qBAAqB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,IAAI,aAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,UAAU;AACY;AACxB;AACA,IAAI,aAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,UAAU;AACa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sBAAsB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,wCAAwC,WAAW;AACnD,SAAS;AACT;AACA,qCAAqC,aAAa;AAClD,iDAAiD,4BAA4B,EAAE;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oFAAoF,mBAAmB;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,0BAA0B,EAAE;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;AACrB;;;ACtXA;AACA;AACA;AACA;AAC0D;AAChB;AACF;AACxC;AACA,WAAW,UAAU;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,sCAAe;AACnB;AACA;AACA;AACA;AACA;AACA,qCAAqC,6BAAY;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,gCAAqB,cAAc,uBAAuB,EAAE;AACpF;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,wBAAwB,gCAAqB,cAAc,oBAAoB,EAAE;AACjF;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA,mCAAmC,6BAAY;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,kCAAkC,qCAAqC;AACvE;AACA,mCAAmC,6BAAY,uCAAuC,oBAAoB,EAAE,kBAAkB,kBAAkB,EAAE;AAClJ;AACA;AACA,mCAAmC,6BAAY;AAC/C;AACA;AACA,mCAAmC,6BAAY;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAAY;AACvC,oBAAoB,gCAAqB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,2BAA2B,6BAAY;AACvC,oBAAoB,gCAAqB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;ACrH3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,OAAO;AAC3C;AACA;AACA,SAAS;AACT;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;;;ACvBA;AACA;AACA;AACA;AACA;AACO;AACP,uBAAuB,OAAO;AAC9B;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP,gCAAgC,+BAA+B,gBAAgB,GAAG;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,SAAS;AAC9C;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,oBAAoB,SAAS;AAC7B;AACA;AACA,oBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,4DAA4D,gBAAgB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,sCAAsC,YAAY,EAAE;AACpD;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACO;AACP,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,YAAK;AACrB,mCAAmC,sBAAsB;AACzD;AACA;AACA;AACO;AACP;AACA;AACA;AACO,SAAS,YAAK;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA,0BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;;;ACzNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,IAAI,oBAAc;AAClB;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,YAAY,oBAAc;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACO;AACP;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;;;ACrIA;AACA;AACA;AACA;AACsC;AAC/B;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,+BAA+B,kBAAkB;AACjD,SAAS,QAAQ;AACjB;AACA;AACA,QAAQ,QAAQ;AAChB;AACA;AACA;AACA,wBAAwB,QAAQ,sBAAsB,QAAQ;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACO,SAAS,cAAM;AACtB;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA,uCAAuC,oDAAoD,uCAAuC,EAAE,EAAE,EAAE;AACxI;AACA;AACO,SAAS,cAAM;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC,iBAAiB,cAAM;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,cAAM;AACnB;AACA;AACA,mBAAmB,oBAAoB;AACvC,iBAAiB,cAAM;AACvB;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,qCAAqC,yBAAyB;AAC9D;AACA,oCAAoC,wBAAwB,EAAE;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,kCAAkC,qBAAqB;AACvD;AACA;AACA;;;AClKA;AACA;AACA;AACA;AACO,8CAA8C,EAAE,IAAI;AAC3D;AACA;AACA;AACA;AACA;AACA,wDAAwD,IAAI,MAAM;AAClE;AACA;AACA,kCAAkC,mBAAmB;AACrD;AACA,mBAAmB,kCAAkC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/GA;AACA;AACA;AACA;AACA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACuC;AACkB;AACE;AACE;AACE;AAC/D;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,sDAAsD;AACvD;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,mCAAqB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,MAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,gBAAgB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,oCAAsB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,+BAAoB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,cAAc;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE;AACrE;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC;AACA;AACA;AACA,IAAI,0CAA4B;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,QAAY;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mCAAqB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC;AACuC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC;AACA;AACA;AACA;AACA;AACA;AACO;AACP,iBAAiB,+BAAoB,8BAA8B,2BAAgB;AACnF;AACA,eAAe,+BAAoB;AACnC;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,qBAAqB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC,uCAAuC,OAAO;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,2BAA2B,+CAA+C;AAC1E;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,6BAA6B;AAC7B;AACA,KAAK;AACL;;;ACl3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,6CAA6C,+BAA+B;AAC5E,kDAAkD,gDAAgD;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,KAAK;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACM;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,oCAAoC;AAC9B;AACP;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;;;ACnQ9B;AACA;AACA;AACA;AACA,IAAI,WAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,KAAE;AACoC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,iJAAiJ;AAC9M;AACA;AACA,0DAA0D,iJAAiJ;AAC3M;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,OAAG;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE,YAAY;AAClF;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,6BAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,sBAAsB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACc;AACf;AACA;AACA,IAAI,WAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,sCAAsC,sBAAsB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,OAAG;AACL;AACA,mBAAmB,KAAE,KAAK;AAC1B,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN,IAAI,KAAE;AACN;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAmB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,6BAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF;AACnF;AACA;AACA;AACA;AACA;AACA,6EAA6E;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC9iBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,iCAAiC;AACxE,mCAAmC,yBAAyB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,qBAAqB;AAC9D,qCAAqC,iBAAiB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;;;AC3IpB;AACA;AACA;AACA;AACyC;AACzC;AACA;AACA;AACA,IAAI,WAAK;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,aAAa;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;;;ACtUjB;AACA;AACA;AACA;AACA,IAAI,iBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACwC;AACN;AACnC;AACA;AACA;AACA;AACA,IAAI,mBAAS;AACb,IAAI,iBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,aAAa;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,WAAK;AACc;;;ACpJrB;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;;;AC/B/B;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,CAAC,8BAA8B;AACxB,IAAI,8BAAc;AACzB;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,8BAAc,KAAK,8BAAc,KAAK;AACzC;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA,yCAAyC;AACzC,4CAA4C;AAC5C;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA,yCAAyC;AACzC,4CAA4C;AAC5C;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,0BAA0B;AAC3B;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,gDAAgD;AAC1C;AACP;AACA;AACA;AACA;AACA,CAAC,kDAAkD;AACnD;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,CAAC,8CAA8C;AAC/C;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,kDAAkD;AACnD;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,4CAA4C;AAC7C;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,8CAA8C;AAC/C;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,CAAC,wDAAwD;AAClD;AACP;AACA;AACA;AACA,CAAC,gCAAgC;AACjC;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,gDAAgD;AAC1C;AACP;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,sCAAsC;AACvC;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,wCAAwC;AACzC;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,sEAAsE;AACvE;AACA;AACA;AACO,IAAI,qCAAqB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,qCAAqB,KAAK,qCAAqB,KAAK;AAChD;AACP;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,sDAAsD;AACvD;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,0EAA0E;AAC3E;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,0EAA0E;AAC3E;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,0CAA0C;AAC3C;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,oCAAoC;AAC9B;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,gDAAgD;AAC1C;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,oEAAoE;AACrE;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,CAAC,sDAAsD;AAChD;AACP;AACA;AACA;AACA;AACA,CAAC,gEAAgE;AACjE;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,sDAAsD;AACvD;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,gCAAgC;;;ACxoBjC;AACA;AACA;AACA;AAC+E;AACvB;AACI;AACV;AACY;AACf;AACN;AACQ;AACR;AACe;AACxD,IAAI,qBAAM;AACV;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;AACX;AACP;AACA;AACA;AACA,iCAAiC,uBAAuB;AACxD,iBAAiB,aAAO;AACxB,iBAAiB,OAAuB;AACxC,gBAAgB,qBAAM;AACtB,kBAAkB,QAAQ;AAC1B,eAAe,WAAK;AACpB,mBAAmB,mBAAS;AAC5B,4BAA4B,kBAAkC;AAC9D,wBAAwB,8BAA8B;AACtD,mBAAmB,SAAyB;AAC5C,iBAAiB,8BAAQ;AACzB,aAAa,OAAG;AAChB,eAAe,KAAK;AACpB;AACA;;;;;;AC7CA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,sBAAsB;AAChB;AACP;AACA;AACA,4CAA4C,2CAA2C;AACvF;AACA;AACA,0CAA0C,2CAA2C;AACrF;AACA;AACA;AACA;AACA,oCAAoC,mBAAmB;AACvD;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,kBAAkB;AACjD;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;;ACpDA;AACA;AACA;AACA;AAC0F;AACnF,yBAAyB,eAAe;;;ACL/C;AACA;AACA;AACA;AAC6C;AAC7C,IAAI,qBAAa;AACjB;AACA;AACA;AACA;AACA,yCAAyC,aAAO;AAChD;AACA;AACA;AACA,oDAAoD,aAAO;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACM;AACP,WAAW,qBAAa;AACxB;AACA;AACO;AACP,WAAW,qBAAa;AACxB;AACO;AACP,WAAW,qBAAa;AACxB;AACO;AACP,WAAW,qBAAa;AACxB;AACO;AACP,WAAW,qBAAa;AACxB;AACO;AACP,WAAW,qBAAa;AACxB;AACA;AACO;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjFA;AACA;AACA;AACA;AACuD;AAChD;AACP,2BAA2B,wBAAwB;AACnD,sBAAsB,aAAO;AAC7B;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACO;AACP,WAAW,QAAQ;AACnB;AACA;AACA;AACA,KAAK;AACL;;;ACvBA;AACA;AACA;AACA;AACwC;AAC+B;AACrB;AAClD;AACA;AACA;AACA,mBAAmB,iCAAiC;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,IAAY;AACpB;AACA;AACA,aAAa,SAAiB;AAC9B;AACA;AACA;AACA,YAAY,+BAAoB;AAChC;AACA;AACA;AACA,aAAa,QAAgB;AAC7B;AACA,YAAY,+BAAoB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA;AACA,kBAAkB,+BAAoB;AACtC;AACA;AACA,kBAAkB,+BAAoB;AACtC,IAAI,mCAAqB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,OAAO,aAAa,UAAU,SAAS,MAAM;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA,CAAC;AACgC;;;ACxOjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;AC7GvB;AACA;AACA;AACA;AACA,IAAI,kBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACuC;AACE;AACQ;AAClD,IAAI,6BAAkB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,WAAW;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AAC9B;AACA,IAAI,kBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,6BAAkB;AACM;AAC1B,IAAI,kCAAuB;AAC3B;AACA,gCAAgC,YAAY;AAC5C,gCAAgC,YAAY;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,QAAgB,IAAI,6BAAkB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;;;AC7HnC;AACA;AACA;AACA;AACA,IAAI,WAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACuC;AACF;AACqB;AACN;AACH;AACM;AACX;AACgB;AACX;AAC3C;AACP;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA,iDAAiD,sDAAsD,mCAAmC,EAAE,EAAE,EAAE;AAChJ;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA,iDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA,iDAAiD,sDAAsD,sCAAsC,EAAE,EAAE,EAAE;AACnJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA,iDAAiD,sDAAsD,mCAAmC,EAAE,EAAE,EAAE;AAChJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA,iDAAiD,sDAAsD,sCAAsC,EAAE,EAAE,EAAE;AACnJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,iBAAiB,IAAY;AACtB;AACA;AACA;AACA;AACA;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACM;AACP;AACA;AACA;AACA;AACA,2BAA2B,6BAAkB;AAC7C;AACA;AACA;AACA;AACA,2BAA2B,mCAAqB;AAChD;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,2CAA2C,uCAAuC,EAAE;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACO,IAAI,gCAA4B;AACvC,IAAI,2BAAuB;AAC3B;AACA,kCAAkC,cAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2BAAuB;AACtD;AACA;AACA;AACA;AACA;AACA,IAAI,gCAA4B;AAChC,kCAAkC,cAAc;AAChD,uBAAuB,2BAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,2BAAuB;AAClD;AACA;AACA;AACA;AACA,mBAAmB,gCAA4B;AAC/C;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,IAAI,+BAA2B;AAC/B,IAAI,WAAS;AACb;AACA,qCAAqC,oCAAoC;AACzE,uCAAuC,iCAAiC;AACxE;AACA;AACA;AACA,0CAA0C,YAAY;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACL;AACP,eAAe,+BAA2B;AAC1C;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;AACd;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,CAAC;AACD;AACA;AACO;AACP;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,+BAA+B,sDAAsD;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,2BAA2B,+BAA+B;AAC1D;AACA;AACA;AACA,wCAAwC,gBAAgB;AACxD;AACO;AACP,2BAA2B,+BAA+B;AAC1D;AACA;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA,qCAAqC,QAAQ;AAC7C;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,QAAgB;AACrC,mBAAmB,QAAgB;AACnC,yBAAyB,QAAgB;AACzC;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,mBAAmB,6CAA6C;AAChE;AACA;AACA;AACA;AACA;AACO;AACP,mBAAmB,6CAA6C;AAChE;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,gBAAY;AAChB;AACA;AACA,+BAA+B,aAAO;AACtC;AACA,8BAA8B,aAAO;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,QAAQ,QAAQ;AAChB,QAAQ,QAAQ;AAChB;AACA;AACA,2BAA2B,iBAAO;AAClC;AACA;AACA;AACA;AACA,CAAC;AACM;AACP,eAAe,gBAAY;AAC3B;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA,uCAAuC,kCAAkC,EAAE;AAC3E;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,kCAAkC,gBAAgB,EAAE;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA,2CAA2C,wBAAwB;AACnE;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA,2CAA2C,wBAAwB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,QAAQ,4BAAiB,IAAI,aAAqB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACx5BA;AACA;AACA;AACA;AAC+B;AACxB,SAAS,iBAAK;AACrB;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,2BAA2B,OAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3BA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,0BAA0B;;;ACjC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACO,IAAI,aAAK;AACT;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,0BAA0B,YAAY;AACtC;AACA;AACA,4BAA4B,OAAO;AACnC;AACA;AACA;AACA;AACA,sBAAsB,MAAM;AAC5B;AACA;AACA,8BAA8B,EAAE;AAChC;AACA,iCAAiC,EAAE;AACnC;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACO,SAAS,cAAM;AACtB;AACA;AACA,kCAAkC;AAClC,kCAAkC;AAClC,mCAAmC;AACnC;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACO;AACP,iCAAiC,EAAE;AACnC;AACA;AACA;AACA;AACA;AACA;AACO;AACP,4BAA4B,cAAc;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,mCAAmC,EAAE;AACrC;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,6BAA6B,cAAc;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,+BAAuB;AACvC,qCAAqC,SAAS;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,2BAA2B,WAAW;AACtC,yBAAyB,kBAAkB;AAC3C,uBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,8BAAsB;AACtC,gCAAgC,6BAA6B;AAC7D,4BAA4B,QAAQ;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,eAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mBAAmB;AAC/C;AACA;AACA;AACA,mBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,mBAAW;AAC3B;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,oBAAY;AAC5B;AACA;AACO;AACP,qCAAqC,SAAS;AAC9C;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACO;AACA;AACP;AACA;AACO;AACP,yCAAyC;AACzC;AACO;AACP;AACA,mBAAmB,WAAW;AAC9B;AACA;AACA;AACA;;;ACtbA;AACA;AACA;AACA;AAC0C;AACU;AACpD;AACA;AACA;AACO,IAAI,SAAG;AACd;AACA;AACA;AACO,gBAAgB,6BAAS;AAChC;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,aAAO;AACvB,+BAA+B,uBAAuB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAO;AACtB;AACA;AACA;AACA,YAAY,6BAAS;AACrB,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,cAAQ;AACxB;AACA;AACA;AACA;AACA;AACA,eAAe,cAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,WAAW,cAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,6BAAS;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,YAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,yBAAyB,WAAW;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,aAAa;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,aAAa;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,cAAc,WAAW;AACzB;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,SAAG;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,+BAA+B,uBAAuB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,oBAAoB;AAC7C;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACtPA;AACA;AACA;AACA;AACoC;AACL;AACiB;AACT;AACY;AAC5C;AACP;AACA;AACA,2CAA2C,OAAO,SAAS,2BAAO;AAClE;AACO;AACP,WAAW,kBAAQ;AACnB;AACO;AACP,gCAAgC,qCAAqC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B;AACA;AACA;AACO,SAAS,kBAAQ;AACxB,WAAW,cAAc;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,iBAAO;AACvB,4BAA4B,OAAO;AACnC,eAAe,OAAG,MAAM,aAAa;AACrC;AACA,kBAAkB,aAAa;AAC/B;AACA,oBAAoB;AACpB;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,4BAA4B,OAAO;AACnC,qBAAqB,OAAG,MAAM,IAAU;AACxC;AACA;AACA,qBAAqB,IAAU;AAC/B;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,4BAA4B,OAAO;AACnC,yBAAyB,OAAG,MAAM,SAAe;AACjD;AACA;AACA,yBAAyB,SAAe;AACxC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,aAAa,6BAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,6BAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,UAAU,gBAAgB,4BAA4B;AACjG,sCAAsC,gBAAgB;AACtD,iEAAiE,mCAAmC;AACpG,qBAAqB;AACrB;AACA;AACA;AACA;AACA,SAAS;AACT,2CAA2C,UAAU,gBAAgB,4BAA4B;AACjG;AACA,oEAAoE;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,0BAA0B;;;AC/I3B;AACA;AACA;AACA;AACiE;AACG;AACU;AACd;AACzD,sBAAsB,eAAe;AACrC;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,oCAAoC;AAC7E;AACA;AACA;AACA;AACA,+DAA+D,gBAAgB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,uBAAuB;AACvD;AACA;AACA,gBAAgB,mBAAmB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAU;AACrC;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,4BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC;;;AClFD;AACA;AACA;AACA;AAC8E;AACvE,wBAAwB,eAAe;;;ACL9C;AACA;AACA;AACA;AAC8D;AACvD;AACP;AACA;AACA;AACA,eAAe,8BAAQ;AACvB;AACA;AACA,eAAe,8BAAQ;AACvB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC;;;ACnBD;AACA;AACA;AACA;AACA,kBAAkB,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,eAAe,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AACoD;AACQ;AACF;AACK;AACH;AACsC;AACf;AACC;AACQ;AAC5F,IAAI,2BAAa;AACjB;AACA,2CAA2C,qBAAqB,oBAAoB,CAAC;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA,+DAA+D,0BAA0B;AACzF;AACA;AACA;AACA,uBAAuB,OAAO,oBAAoB,OAAO,qBAAqB,OAAO;AACrF;AACA,YAAY,kBAAsB;AAClC;AACA,yCAAyC,gBAAgB;AACzD;AACA;AACA;AACA,uBAAuB,iBAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,eAAe;AACzD;AACA;AACA;AACA;AACA;AACA,yCAAyC,OAAO;AAChD,2BAA2B,aAAuB,WAAW;AAC7D;AACA,0DAA0D,+BAA+B,wBAAwB,EAAE;AACnH;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC,mBAAmB,eAAe;AAClC,mBAAmB,QAAQ,CAAC,iBAAiB;AAC7C;AACA;AACA,CAAC;AACwB;;;AC3FzB;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;;;ACXA;AACA;AACA;AACA;AACyD;AACD;AACI;AACD;AACR;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,2BAAa;AACjB;AACA,iCAAiC,cAAc;AAC/C;AACA,gCAAgC,aAAO;AACvC;AACA,wBAAwB,KAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE,wBAAwB,EAAE;AAChG,yEAAyE,+BAA+B,EAAE;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,WAAK;AAC5C,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA,mCAAmC,WAAK;AACxC,qBAAqB;AACrB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,mBAAmB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,EAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,QAAQ,iBAAO;AACf;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;ACjLzB;AACA;AACA;AACA;AACwD;AACjD;AACP;AACA;AACA,yCAAyC,aAAO;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;ACvBD;AACA;AACA;AACA;AACA,IAAI,gBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC4D;AACH;AACb;AAC7C;AACA;AACA;AACA;AACA,+BAA+B,+BAAoB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,eAAO;AAChB;AACA;AACA;AACA;AACA;AACA,IAAI,qBAAY;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,eAAO,kBAAkB,oBAAoB;AACtE,yBAAyB,eAAO,kBAAkB,oBAAoB;AACtE,qDAAqD,oBAAoB;AACzE;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,UAAU;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA,IAAI,gBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,qBAAY;AACM;;;ACnLpB;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,IAAI,uBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,uBAAiB,KAAK,uBAAiB,KAAK;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;;;ACpE5B;AACA;AACA;AACA;AACA,IAAI,WAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACM,SAAS,UAAM;AACtB;AACA,0CAA0C,2BAA2B,EAAE;AACvE;AACA;AACO,SAAS,QAAI;AACpB;AACA,uCAAuC,yBAAyB,EAAE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,+BAA+B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;AAC7B;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,+BAA+B,sBAAsB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sBAAsB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,kCAAkC;AAClC;AACA;AACA,iBAAiB;AACjB,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,kCAAkC;AAClC;AACA;AACA,iBAAiB;AACjB,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC;AACoB;AACrB;AACA,IAAI,WAAS;AACb;AACA,+BAA+B,WAAW;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;;;ACrgBpB;AACA;AACA;AACA;AACsC;AACE;AACJ;AACA;AACI;AACxC;AACA;AACA,2BAA2B;AAC3B,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,uBAAuB,EAAE;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oBAAoB;AAC/C;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sBAA8B;AAC5D;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA,qCAAqC,QAAQ;AAC7C,4EAA4E,uBAAuB,EAAE;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA,iCAAiC,sBAA8B;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,gCAAgC;AAChC,iCAAiC;AACjC,YAAY,qDAAqD,GAAG,KAAK,yBAAyB,KAAK;AACvG,cAAc,uEAAuE,GAAG;AACxF,oCAAoC;AACpC,wCAAwC;AACxC,gBAAgB,QAAQ,QAAQ;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B,uCAAuC;AACvC;AACA,2BAA2B,QAAgB;AAC3C;AACA;AACA,oEAAoE;AACpE;AACA;AACA,qEAAqE,+CAA+C;AACpH;AACA;AACA,oEAAoE;AACpE;AACA;AACA,oEAAoE;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,eAAqB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,QAAgB,mEAAmE;AAC3H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,QAAgB,qBAAqB,QAAgB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA,iCAAiC,uCAAuC,EAAE;AAC1E,oCAAoC,yBAAyB,EAAE;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,YAAY,qCAAqC,+BAA+B,EAAE;AAC1G;AACA;AACA;AACA,kEAAkE,8DAA8D,EAAE;AAClI;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,SAAe,KAAK,SAAS,qCAAqC,SAAe;AACtG,wBAAwB,SAAe;AACvC;AACA,+CAA+C,QAAgB;AAC/D,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,UAAK;AACrB;AACA;AACA;AACA,WAAW,UAAK;AAChB;AACO,SAAS,UAAK;AACrB,6BAA6B,cAAc;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,iCAAiC,sEAAsE,EAAE;AACzG,oCAAoC,yBAAyB,EAAE;AAC/D;AACA;AACA;AACA;AACA,uDAAuD,yCAAyC,EAAE;AAClG;AACA;AACA;AACA;AACA,wDAAwD,SAAS;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,YAAY,qCAAqC,+BAA+B,EAAE;AAChH;AACA;AACA;AACA,wEAAwE,8DAA8D,EAAE;AACxI;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA,+BAA+B,cAAc;AAC7C;AACA;AACA,gEAAgE,OAAa;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,YAAY,qCAAqC,+BAA+B,EAAE;AAC1G;AACA;AACA;AACA,kEAAkE,8DAA8D,EAAE;AAClI;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,UAAU;AACjC,+CAA+C,2BAA2B,EAAE;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2EAA2E,kCAAkC,EAAE;AAC/G;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,6CAA6C,OAAO;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,OAAO;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,iCAAiC,EAAE;AAChH;AACA;AACA;;;AC/eA;AACA;AACA;AACA;AACyE;AAClE;AACP;AACA;AACA;AACA,+CAA+C,wBAAwB;AACvE;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,UAAgB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AChFA;AACA;AACA;AACA;AAC0F;AACnF,oBAAoB,eAAe;AACnC;AACP;AACA;;;ACRA;AACA;AACA;AACA;AACwD;AACS;AACnB;AACuB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,+CAAuB;AAC3B;AACA;AACA;AACA,gCAAgC,aAAO;AACvC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,gBAAgB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,oCAAoC,EAAE;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,6BAA6B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,gBAAgB;AAC5D;AACA,2BAA2B,KAAK,oEAAoE,sBAAsB;AAC1H;AACA;AACA;AACA,oDAAoD,gBAAgB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;;;AC1JnC;AACA;AACA;AACA;AACwD;AACS;AACjE,IAAI,6CAAwB;AAC5B;AACA,gCAAgC,aAAO;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,4BAA4B,EAAE;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmC;;;ACjEpC;AACA;AACA;AACA;AACsD;AACuB;AACF;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D;AACA,0CAA0C;AAC1C;AACA;AACA,yCAAyC;AACzC;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA,CAAC;AACwB;AACzB;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACM,IAAI,gCAA0B;AACrC;AACA;AACA;AACA;AACA,CAAC,EAAE,gCAA0B,KAAK,gCAA0B,KAAK;AACjE;AACA;AACA;AACO,IAAI,2BAAqB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,2BAAqB,KAAK,2BAAqB,KAAK;AACvD;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACO;AACP,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACO,oCAAoC,+CAAuB;AAClE;AACA;AACA;AACO,iCAAiC,+CAAuB;AAC/D;AACA;AACA;AACO,qCAAqC,+CAAuB;AACnE;AACA;AACA;AACO,wCAAwC,+CAAuB;AACtE;AACA;AACA;AACO,gCAAgC,+CAAuB;AAC9D;AACA;AACA;AACO,yCAAyC,+CAAuB;AACvE;AACA;AACA;AACO,4CAA4C,+CAAuB;AAC1E;AACA;AACA;AACO,qCAAqC,+CAAuB;AACnE;AACA;AACA;AACO,yCAAyC,+CAAuB;AACvE;AACA;AACA;AACO,yCAAyC,+CAAuB;AACvE;AACA;AACA;AACO,mCAAmC,+CAAuB;AACjE;AACA;AACA;AACO,qCAAqC,+CAAuB;AACnE;AACA;AACA;AACO,iDAAiD,+CAAuB;AAC/E;AACA;AACA;AACO,sDAAsD,+CAAuB;AACpF;AACA;AACA;AACO,+CAA+C,+CAAuB;AAC7E;AACA;AACA;AACO,+BAA+B,+CAAuB;AAC7D;AACA;AACA;AACO,gCAAgC,+CAAuB;AAC9D;AACA;AACA;AACO,uCAAuC,+CAAuB;AACrE;AACA;AACA;AACO,+BAA+B,6CAAwB;;;ACpT9D;AACA;AACA;AACA;AACkF;AACjC;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACM;AACA;AACA,mCAAmC,kBAAkB;AACrD;AACP,eAAe,kBAAkB,MAAM,KAAK;AAC5C;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC;;;AChCA;AACA;AACA;AACA;AAC0F;AACnF;AACA,2BAA2B,eAAe;;;ACNjD;AACA;AACA;AACA;AAC0F;AACnF,wBAAwB,eAAe;;;ACL9C;AACA;AACA;AACA;AACA,IAAI,oBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC6D;AACjB;AACN;AACwB;AAC/D;AACA;AACA;AACA;AACA,qBAAqB,sCAAe;AACpC;AACA;AACA;AACO;AACP,SAAS,yBAAK;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,iCAAoB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,2BAA2B,8BAA8B;AACzD;AACA;AACA;AACA;AACA;AACA,qBAAqB,8BAA8B;AACnD,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,IAAI,oBAAS;AACb;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,8BAA8B,iCAAoB;AAClD;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,6BAA6B;AAC5D;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACkB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,iCAAoB;AACjD;AACA;AACA,aAAa;AACb,oDAAoD,2CAA2C;AAC/F,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,uBAAuB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,CAAC;AAC6B;AAC9B;AACA;AACA;AACO,SAAS,mBAAM;AACtB;AACA;;;ACxTA;AACA;AACA;AACA;AACgD;AAC2B;AAC3E;AACA;AACA,QAAQ,2BAAO;AACf,mBAAmB,2BAAO;AAC1B,mBAAmB,2BAAO;AAC1B;AACA,mBAAmB,2BAAO;AAC1B,8BAA8B,2BAAO;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,yCAAoB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,uBAAuB;AACnC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC;AAC+B;;;AC3EhC;AACA;AACA;AACA;AACA;AACA;AACA;AACO,IAAI,kCAAY;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,kCAAY,KAAK,kCAAY,KAAK;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,SAAS;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6C;;;AC3D9C;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AACrB;AACP;AACA;;;AC7CA;AACA;AACA;AACA;AACiF;AACjF,IAAI,kCAAoB;AACxB;AACA;AACA,gFAAgF,YAAY,kCAAkC,KAAK,EAAE;AACrI;AACA;AACA,uEAAuE,YAAY,kCAAkC,EAAE,0BAA0B,EAAE,EAAE;AACrJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE,KAAK;AAC5E;AACA,CAAC;AAC+B;;;AC9ChC;AACA;AACA;AACA;AAC8D;AAClB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA,+FAA+F,0BAA0B,mCAAmC,0BAA0B;AACtL,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC;AAC2B;AAC5B,SAAS,qBAAI;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,qBAAI,mBAAmB,uBAAuB,gBAAgB,EAAE;AAC7F;AACA,CAAC;AACD,qCAAqC,qBAAI,mBAAmB,uBAAuB,gBAAgB,EAAE;AACrG;AACA,CAAC;AACD,0BAA0B,qBAAI,mBAAmB,gCAAgC,mBAAmB,YAAY,EAAE,SAAS,GAAG,EAAE;AAChI;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;AACD,kCAAkC,qBAAI,mBAAmB,gCAAgC,mBAAmB,YAAY,EAAE,SAAS,GAAG,EAAE;AACxI;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA,UAAU,sBAA8B;AACxC;AACA;AACA;AACA;AACA,WAAW,YAAoB;AAC/B;AACA;AACA;AACA;AACA,oCAAoC,QAAQ;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,8BAAa;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA,8HAA8H;AAC9H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;AC3IzB;AACA;AACA;AACA;AACiF;AAC1B;AACD;AACtD,IAAI,iDAA+B;AACnC;AACA;AACA;AACA,6EAA6E,6CAA6C,EAAE,qBAAqB,YAAY,kCAAkC,KAAK,EAAE;AACtM;AACA;AACA,iDAAiD,kCAAkC,EAAE,2EAA2E;AAChK;AACA;AACA;AACA;AACA;AACA,yEAAyE,SAAS;AAClF;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,gBAAgB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,qBAAqB;AACjC;AACA;AACA;AACA;AACA,gBAAgB,8BAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,SAAS;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,CAAC;AAC0C;;;ACvG3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;;;ACxD9B;AACA;AACA;AACA;AACsE;AACR;AACH;AAC3D,IAAI,sBAAc;AAClB;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,uDAAuD,SAAS;AAChE;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,SAAS;AACjE;AACA;AACA,4BAA4B,eAAe,kCAAY;AACvD;AACA;AACA;AACA;AACA;AACA,wDAAwD,SAAS;AACjE;AACA;AACA,4BAA4B,eAAe,kCAAY;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,sBAA8B;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,sBAA8B;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA,CAAC;AACyB;;;AClG1B;AACA;AACA;AACA;AACmE;AACX;AACS;AACN;AAClB;AAC+C;AAC9B;AACH;AACY;AACe;AACnB;AACR;AACW;AAClE,IAAI,6CAAe;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,kCAAoB;AACrD,wDAAwD,mBAAmB;AAC3E;AACA;AACA,0CAA0C,kBAAkB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,gBAAgB;AACrD;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC,qBAAqB;AACrB;AACA,8CAA8C,iDAA+B;AAC7E;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA,CAAC;AAC2C;AAC5C,IAAI,+DAAiC;AACrC;AACA,gCAAgC,aAAO;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,6CAAe;AACzC;AACA,gCAAgC,yCAAyC;AACzE,eAAe,YAAY;AAC3B;AACA;AACA,yCAAyC,yCAAyC;AAClF;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sBAAsB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kCAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sBAAsB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,yBAAyB;AAC5C;AACA,eAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,qBAAqB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,6BAA6B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,oBAA4B;AACzD,wBAAwB,kCAAY;AACpC;AACA;AACA;AACA;AACA;AACA,6BAA6B,oBAA4B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,oBAA4B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,OAAO;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,oBAA4B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,oBAA4B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,OAAO;AAC3D;AACA;AACA;AACA,yCAAyC,oBAA4B;AACrE,oCAAoC,kCAAY;AAChD;AACA;AACA;AACA;AACA;AACA,2CAA2C,OAAO;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,oBAA4B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,oBAA4B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,oBAA4B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA,sCAAsC,oBAA4B;AAClE;AACA;AACA;AACA,sDAAsD,kCAAY;AAClE,sDAAsD,kCAAY;AAClE;AACA;AACA,0DAA0D,kCAAY;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oBAA4B;AACvD;AACA;AACA;AACA,sCAAsC,kCAAY;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,kCAAY;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sBAAsB;AACrD;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,oBAA4B;AAC5D;AACA;AACA;AACA;AACA;AACA,2DAA2D,kCAAY;AACvE;AACA;AACA;AACA;AACA,oDAAoD,KAAa,CAAC,KAAa;AAC/E;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,oBAA4B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,kCAAY;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,kCAAY;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,WAAK;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,kCAAY;AAC9D,kDAAkD,kCAAY;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,oBAA4B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sBAAsB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4C;AACtC,wCAAwC,+DAAiC;;;AC3qBhF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;ACjCtB;AACA;AACA;AACA;AAC6C;AAC7C;AACA;AACA,gCAAgC,iBAAiB,EAAE;AACnD,2CAA2C,0BAA0B;AACrE;AACA;AACO;AACP,eAAe,YAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,YAAY;AACnC;AACA;AACA;AACA;AACA,CAAC;AACkB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,qBAAgB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,UAAU;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,IAAI,YAAO;AACX;AACA;AACA;AACA;AACA,qDAAqD,oCAAoC;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,UAAU;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,UAAU;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,UAAU;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA;AACA,+BAA+B,qBAAgB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,UAAU;AAC9B;AACA;AACA;AACA;AACA,+BAA+B,qBAAgB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA4E;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA4E;AAC5E;AACA;AACA;AACA,2DAA2D;AAC3D;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,4CAA4C;AAC5E;AACA;AACA;AACA;AACA;AACA,iDAAiD,gCAAgC;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,UAAU;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,gCAAgC;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,QAAQ;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,UAAU;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;;;ACnxBnB;AACA;AACA;AACA;AAC4D;AACD;AAC3D,4BAA4B;AAC5B;AACA;AACA,uBAAuB,YAAO;AAC9B;AACA;AACA,IAAI,+BAAkB;AACtB;AACA;AACA;AACA,gDAAgD,cAAc;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,+BAA+B;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8BAA8B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,mBAAmB;AACvD;AACA;AACA;AACA,uCAAuC,iBAAiB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,cAAc;AACvE;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,+BAAkB;AAC9C,4BAA4B,+BAAkB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,cAAc;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,SAAS;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,+BAAkB;AACpE,kDAAkD,+BAAkB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,+BAAkB;AAClE,gDAAgD,+BAAkB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;;;AC5XxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;AAChB;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA;AACA;;;AChDA;AACA;AACA;AACA;AAC2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC,IAAI,mCAAiB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,QAAQ;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,QAAQ;AAC7B,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,YAAY;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;AAC7B;AACA;AACA;AACA;AACA,2BAA2B,mCAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,yCAAyC;AACnG;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqC;;;ACvMtC;AACA;AACA;AACA;AAC+C;AACuB;AACtE,IAAI,+BAAe;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA,uCAAuC,QAAQ;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA,mCAAmC,mCAAiB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;AC3G3B;AACA;AACA;AACA;AACoC;AACpC;AACA;AACA;AACA,IAAI,uCAAmB;AACvB;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA,oBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA,2BAA2B,uCAAmB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;;;ACtDxB;AACA;AACA;AACA;AACqE;AACvB;AAC9C,IAAI,yBAAY;AAChB;AACA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,WAAW;AACpC,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,4BAA4B,yBAAY;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,uCAAmB;AAC7C;AACA,uBAAuB,yCAAyC;AAChE;AACA;AACA,6CAA6C;AAC7C,uBAAuB,uCAAuC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,KAAK;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,gBAAgB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;;;ACrOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B,sBAAsB;AACtB,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,4BAA4B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;;;ACtF/B;AACA;AACA;AACA;AACA,IAAI,0BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC0D;AACI;AACR;AACI;AACT;AACH;AACN;AACc;AAC0B;AACC;AAC1B;AACyB;AACX;AACtE;AACA;AACA;AACA,IAAI,8BAAW;AACf,IAAI,0BAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,aAAa,kBAAkB,yBAAyB;AACjF;AACA,uBAAuB,WAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,GAAG;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA,yBAAyB,yDAAyD;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,kBAAkB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,+DAA+D;AAC3G,0CAA0C,2DAA2D;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,CAAC,CAAC,+BAAe;AACjB;AACA;AACA;AACA,IAAI,yCAAsB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,YAAY;AAC3C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2BAA2B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,SAAS;AACzB;AACA,uBAAuB,WAAK;AAC5B;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,yCAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,2BAA2B;AACxD;AACA;AACA;AACA,0BAA0B,UAAU;AACpC,4CAA4C,WAAK;AACjD,iDAAiD,uBAAuB;AACxE;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,kDAAkD;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,YAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iFAAiF,2EAA2E;AAC5J;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB,aAAa;AACb;AACA,gCAAgC,2BAA2B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,4BAA4B;AAC1E;AACA,6CAA6C,qBAAqB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,+DAA+D;AAChH;AACA;AACA;AACA;AACA,qBAAqB,mBAAmB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,gCAAgC;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC;AACA;AACA;AACA,IAAI,yCAAsB;AAC1B,IAAI,0BAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,qCAAqC,EAAE;AACjG;AACA;AACA;AACA,qCAAqC,8BAAW,CAAC,OAAG;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,yCAAsB;AACU;AAClC;AACA;AACA;AACA;AACO,SAAS,yBAAM;AACtB,eAAe,yCAAsB;AACrC;AACA;AACA;AACA,IAAI,2BAAO,UAAU,mBAAmB;AACxC;;;AC7hB0F;AACnF,wCAAwC,eAAe;AACvD,qCAAqC,eAAe;;;ACF3D;AACA;AACA;AACA;AACA,IAAI,+BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,gCAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,6BAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AAC8D;AACwB;AACoB;AACtB;AAC/C;AACqD;AACzB;AACf;AAC6B;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,+CAAuB;AAC3B,IAAI,+BAAS;AACb;AACA;AACA;AACA,mDAAmD,qCAAa;AAChE;AACA,wBAAwB,oBAA0B;AAClD;AACA;AACA,+CAA+C;AAC/C;AACA,iFAAiF,uCAAuC,EAAE;AAC1H;AACA,SAAS;AACT,wBAAwB,0BAAgC;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,qEAAqE,EAAE;AAC/I;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA,4EAA4E,wDAAwD,EAAE;AACtI;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,qDAAqD,EAAE;AAC/H;AACA;AACA;AACA;AACA;AACA,wEAAwE,kDAAkD,EAAE;AAC5H;AACA,8BAA8B,gCAAU;AACxC,QAAQ,6BAAO,IAAI,aAAa;AAChC,QAAQ,6BAAO,IAAI,iCAAiC;AACpD;AACA;AACA,CAAC,CAAC,UAAU;AACuB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA,wEAAwE,mDAAmD,EAAE;AAC7H;AACA;AACA,CAAC;AACD,IAAI,qCAAa;AACjB,IAAI,+BAAS;AACb;AACA;AACA;AACA;AACA,qDAAqD,aAAa;AAClE,qDAAqD,qCAAqC,EAAE;AAC5F,yEAAyE,sCAAsC,EAAE;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,0CAAkB;AAC7D;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACZ,IAAI,0CAAkB;AACtB,IAAI,+BAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,aAAa;AACzC,4CAA4C,oCAAoC,EAAE;AAClF;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,uBAAuB,YAAY;AACnC;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,iBAAO;AACf;AACA;AACA,CAAC,CAAC,UAAU;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,0CAAkB;AACtB,IAAI,+BAAS;AACb;AACA;AACA;AACA,mCAAmC,yCAAoB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,kBAAkB;AACpE;AACA;AACA,gBAAgB,uBAAuB;AACvC,+DAA+D,yCAAsB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,uBAAuB;AACnC,4DAA4D,yCAAsB;AAClF;AACA,SAAS;AACT;AACA;AACA;AACA,oDAAoD,0CAAkB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,UAAU;AACkB;;;AC1X9B;AACA;AACA;AACA;AACA,IAAI,iBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACiE;AAClE;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,IAAI,iBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,2BAA2B;AAC9D;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE,yBAAyB,EAAE;AAClG;AACA;AACA,CAAC,CAAC,0CAAkB;;;ACnEpB;AACA;AACA;AACA;AAC4C;AAC5C,IAAI,qBAAU;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,SAAS;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;;;AChK5B;AACA;AACA;AACA;AAC2D;AACpD;AACP;AACA,+CAA+C,YAAY,2BAAa,WAAW;AACnF;AACA;AACA,+CAA+C,kCAAkC;AACjF;AACA,IAAI,2BAAa;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,eAAuB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,YAAY;AACnC;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;ACpGD;AACA;AACA;AACA;AAC2D;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,UAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,gBAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,yCAAyB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,eAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA,oBAAoB,eAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoC;;;AC5KrC;AACA;AACA;AACA;AAC2D;AACI;AACkB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,gCAAe;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AACrB;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,SAAS;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;AACtB;AACP,aAAa,mBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,WAAW;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,wBAAwB;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,mBAAmB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,iBAAiB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8HAA8H,YAAY,sCAAsC;AAChL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,+BAA+B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,8BAA8B;AAC/D;AACA;AACA,2BAA2B,8BAA8B;AACzD;AACA;AACA;AACA;AACA,iBAAiB,oBAA4B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,iBAAiB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,oBAA4B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,cAAc;AACxC,0BAA0B,yCAAyB;AACnD;AACA;AACA;AACA,mDAAmD,oBAAoB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,uBAAuB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,2BAA2B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,0BAA0B;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,0BAA0B;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA,mDAAmD;AACnD;AACA;AACA;AACA,mDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,oBAA4B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;;;AC7pBA;AACA;AACA;AACA;AAC2D;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB,IAAI,+BAAqB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;;;AC7E/B;AACA;AACA;AACA;AAC6D;AACF;AACE;AACA;AACoD;AACrC;AAC5E,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sGAAsG,2BAA2B,EAAE;AACnI;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAyB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,oBAAoB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,oBAAoB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,YAAY;AACtC;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,iCAAiC,aAAa;AAC9C,2BAA2B,+BAAqB;AAChD,0BAA0B,+BAAqB;AAC/C,2BAA2B,eAAc,KAAK,gCAAe;AAC7D;AACA;AACA;AACA,iCAAiC,aAAa;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,cAAc;AAC1D;AACA;AACA,6BAA6B,qBAAU;AACvC,2BAA2B,+BAAqB;AAChD,0BAA0B,+BAAqB;AAC/C,2BAA2B,eAAc,KAAK,gCAAe;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,cAAc;AAC1D;AACA;AACA,QAAQ,qBAAU;AAClB,6BAA6B,qBAAU;AACvC,2BAA2B,+BAAqB;AAChD,0BAA0B,+BAAqB;AAC/C,2BAA2B,eAAc,KAAK,gCAAe;AAC7D;AACA;AACA;AACA;AACA;AACA;;;ACrIA;AACA;AACA;AACA;AACoC;AACI;AACxC,IAAI,iBAAQ;AACZ;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,iBAAQ,KAAK,iBAAQ,KAAK;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,QAAY;AAClD,wCAAwC,QAAY;AACpD,qCAAqC,QAAY;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gBAAwB;AACpC;AACA;AACA,YAAY,gBAAwB,qBAAqB,gBAAwB;AACjF;AACA;AACA,YAAY,gBAAwB;AACpC;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,iBAAQ,KAAK,iBAAQ,KAAK;AACd,qEAAQ,EAAC;;;AC3CxB;AACA;AACA;AACA;AAC0D;AAC1D;AACA;AACA;AACO;AACP;AACA,yCAAyC,UAAuB;AAChE;AACA;AACA;AACA;AACA;;;ACfA;AACA;AACA;AACA;AACuD;AACE;AACzD,IAAI,qBAAY;AAChB;AACA;AACA;AACA;AACA,QAAQ,EAAS,CAAC,QAAc;AAChC,QAAQ,EAAS,CAAC,QAAc;AAChC,QAAQ,EAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACM,mBAAmB,qBAAY;;;ACrBtC;AACA;AACA;AACA;AAC8D;AACN;AACjD;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,iDAAwB;AAC5B;AACA,sCAAsC,aAAO;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,mCAAmC,iDAAwB;AAC3D,QAAiB;;;AC3BjB;AACA;AACA;AACA;AACuC;AACiB;AACK;AACN;AACI;AACyC;AAC7F,IAAI,gCAAU;AACrB;AACA;AACO,mBAAmB,eAAe,uBAAuB;AACzD,2BAA2B,eAAe,uBAAuB;AACjE,sBAAsB,eAAe,uBAAuB;AAC5D,wBAAwB,eAAe,uBAAuB;AAC9D;AACP,2BAA2B,QAAQ,IAAI,UAAc;AACrD,IAAI,2CAAqB;AACzB;AACA;AACA,sCAAsC,aAAO;AAC7C,+CAA+C,aAAO;AACtD;AACA,0CAA0C,eAAe,uBAAuB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,4GAA4G;AAC5G;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAY;AAC/B;AACA;AACA,yEAAyE,qCAAqC;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,QAAY,kFAAkF,EAAE;AACrI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD,+BAA+B,wBAAwB;AACvD,qCAAqC,qBAAqB;AAC1D,gBAAgB,iBAAuB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,WAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,4CAA4C,WAAW;AACnG;AACA;AACA,qCAAqC,iBAAuB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,wBAAwB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,QAAY;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,8BAA8B,EAAE;AACjF;AACA;AACA;AACA,uHAAuH,EAAE,uDAAuD,QAAQ,YAAoB,2BAA2B,EAAE;AACzO;AACA;AACA,CAAC;AACD;AACA;AACA,gDAAgD,EAAE;AAC3C;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,2CAAqB;AACrD,QAAQ,KAAK,gCAAU;AAChB;AACP;AACA,eAAe,QAAY,uDAAuD,EAAE;AACpF;AACA;AACA,eAAe,QAAY,iDAAiD,EAAE;AAC9E;AACA;AACA;;;ACjPA;AACA;AACA;AACA;AACA,IAAI,0BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACsC;AACiB;AACO;AACJ;AACE;AACT;AACP;AACA;AACgD;AACpB;AACzE,IAAI,kCAAe,GAAG,eAA6B;AACnD,IAAI,uCAAoB,GAAG,oBAAkC;AAC7D,IAAI,wCAAqB,GAAG,qBAAmC;AACxD;AACP;AACA;AACA,wCAAwC,aAAO;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,iCAAc;AAClB,IAAI,4CAAyB;AAC7B,IAAI,0BAAS;AACb;AACA;AACA,iDAAiD,aAAO;AACxD;AACA;AACA,4BAA4B,KAAa,GAAG,eAAe;AAC3D,sCAAsC,KAAa,GAAG,mCAAmC;AACzF,oCAAoC,KAAa,GAAG,iCAAiC;AACrF,iCAAiC,KAAa,GAAG,8BAA8B;AAC/E,kCAAkC,KAAa,GAAG,+BAA+B;AACjF,2CAA2C,KAAa,GAAG,wCAAwC;AACnG,kCAAkC,oCAAoC,6BAA6B,kCAAe;AAClH;AACA;AACA,wBAAwB,UAAU,oCAAoC,kCAAkC,EAAE;AAC1G,mEAAmE,kCAAkC,EAAE;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAY;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,0CAA0C;AACzD;AACA;AACA;AACA;AACA;AACA,uBAAuB,cAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iCAAc;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,KAAa,mCAAmC;AAC3E,iCAAiC,oCAAoC,4BAA4B,kCAAe;AAChH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACyB;AACrC,IAAI,wCAAqB,GAAG,QAAQ,IAAI,gCAAU;AAClD;AACA;AACA;AACA;AACA,aAAa,QAAY;AACzB;AACA;AACA;AACA;AACA;AACA,uBAAuB,uCAAoB;AAC3C,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA,uBAAuB,uCAAoB;AAC3C,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,uCAAoB;AAC3C,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,uCAAoB;AAC3C,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,uCAAoB;AAC3C,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B;AACA;AACA,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,wCAAqB;AAC5C;AACA,mCAAmC,QAAY;AAC/C,SAAS;AACT;AACA;AACA,uBAAuB,wCAAqB;AAC5C,mCAAmC,QAAY;AAC/C,SAAS;AACT;AACA;AACA,uBAAuB,wCAAqB;AAC5C,mCAAmC,QAAY;AAC/C,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,wBAAwB,+BAAoB;AAC5C,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B;AACA;AACA;AACA;AACA,iBAAiB;AACjB,gBAAgB,QAAY;AAC5B;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC;AACA,mCAAmC,QAAY;AAC/C;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B;AACA;AACA,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,mCAAmC,QAAY;AAC/C,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B;AACA;AACA,mCAAmC,QAAY;AAC/C;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,QAAY;AACrD,yBAAyB;AACzB;AACA;AACA;AACA,yCAAyC,QAAY;AACrD,yBAAyB;AACzB;AACA;AACA;AACA,yCAAyC,QAAY;AACrD,yBAAyB;AACzB;AACA;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC;AACA,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA,uBAAuB,kCAAe;AACtC;AACA;AACA,gBAAgB,QAAY;AAC5B;AACA;AACA,mCAAmC,QAAY;AAC/C,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,mCAAmC,QAAY,2JAA2J;AAC1M,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B;AACA;AACA,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA,mCAAmC,QAAY;AAC/C,SAAS;AACT;AACA;AACA;AACA;AACA,mCAAmC,QAAY;AAC/C,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B;AACA,yBAAyB,QAAY;AACrC,SAAS;AACT;AACA;AACA;AACA,yBAAyB,QAAY;AACrC,SAAS;AACT;AACA;AACA;AACA,yBAAyB,QAAY;AACrC,SAAS;AACT;AACA;AACA;AACA,yBAAyB,QAAY;AACrC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA,uBAAuB,qBAAmC,CAAC,kCAAe;AAC1E,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,mCAAmC,QAAY;AAC/C,SAAS;AACT;AACA;AACA;AACA,uBAAuB,mBAAiC,CAAC,kCAAe;AACxE,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,mCAAmC,QAAY;AAC/C,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B;AACA;AACA,qBAAqB,kCAAe;AACpC,yBAAyB,QAAY;AACrC,SAAS;AACT;AACA;AACA,qBAAqB,kCAAe;AACpC,yBAAyB,QAAY;AACrC,SAAS;AACT;AACA;AACA,qBAAqB,kCAAe;AACpC,yBAAyB,QAAY;AACrC,SAAS;AACT;AACA;AACA,qBAAqB,kCAAe;AACpC,yBAAyB,QAAY;AACrC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B;AACA,qBAAqB,kCAAe;AACpC,yBAAyB,QAAY;AACrC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA,uBAAuB,kCAAe;AACtC,mCAAmC,QAAY;AAC/C,SAAS;AACT;AACA;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,wCAAqB;AAC5C,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA,mCAAmC,QAAY;AAC/C,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B,gBAAgB,QAAY;AAC5B;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,mCAAmC,QAAY;AAC/C;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,kCAAe;AACtC,2BAA2B,QAAY;AACvC,wBAAwB,2BAAgB;AACxC,SAAS;AACT;AACA;AACA;AACA,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA,uBAAuB,wCAAqB;AAC5C,2BAA2B,QAAY;AACvC,SAAS;AACT;AACA;AACA;AACA,2BAA2B,QAAY;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACO;AACP;AACA;AACA;AACO;AACP;AACA;AACA;AACA,wCAAqB;;;ACx0BrB;AACA;AACA;AACA;AACmC;AACnC,IAAI,2BAAa;AACjB;AACA;AACA;AACA;AACA,uBAAuB,WAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;ACpCzB;AACA;AACA;AACA;AACA,IAAI,kBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACqE;AACQ;AAC9E,IAAI,yBAAc;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,iCAAiC,EAAE;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,mBAAmB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,SAAS;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gBAAgB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;AAC7B;AACA,IAAI,kBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,yBAAc;AAC7B;AACA;AACA,CAAC;AACwB;AAClB,yBAAyB,eAAe;AACxC;;;AClbP;AACA;AACA;AACA;AACA,IAAI,eAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2C;AACP;AACrC,IAAI,cAAM;AACV;AACA,+BAA+B,YAAY;AAC3C,kCAAkC,eAAe;AACjD,iCAAiC,gBAAgB;AACjD,gCAAgC,aAAO;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,oCAAoC,eAAe;AACnD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,oCAAoC,iBAAiB;AACrD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,oCAAoC,eAAe;AACnD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,oCAAoC,iBAAiB;AACrD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,oCAAoC,iBAAiB;AACrD;AACA;AACA;AACA;AACA;AACA,oCAAoC,eAAe;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;AAClB,IAAI,oBAAY;AAChB,IAAI,eAAS;AACb;AACA;AACA,oDAAoD,aAAO;AAC3D;AACA,8CAA8C,aAAO;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,iBAAiB;AACpD;AACA,kCAAkC,iCAAiC;AACnE,SAAS;AACT,kCAAkC,+BAA+B;AACjE,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACY;;;AC/KxB;AACA;AACA;AACA;AACA,IAAI,sBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,gBAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,aAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AACyD;AACqB;AACH;AACP;AAC7D;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;AACX,mBAAmB,eAAe;AAClC;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,0BAA0B,EAAE;AAC9E,uCAAuC,oBAAoB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8BAA8B;AAC3D;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,4BAAoB;AACxB,IAAI,sBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA,2BAA2B,gBAAU;AACrC,QAAQ,aAAO,IAAI,eAAe;AAClC;AACA;AACA,CAAC,CAAC,cAAM;AACwB;AAChC;AACA,IAAI,sBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,cAAM;AACqB;AAC7B,IAAI,sBAAc;AAClB,IAAI,sBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,gBAAU;AAC/B,QAAQ,aAAO,IAAI,kBAAkB;AACrC,QAAQ,aAAO,IAAI,eAAe;AAClC;AACA;AACA,CAAC,CAAC,4BAAoB;AACI;;;AClL1B;AACA;AACA;AACA;AACA,IAAI,aAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,UAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AACwD;AACI;AACe;AACiB;AACxB;AACpE,IAAI,SAAI;AACR;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,aAAO;AACvC;AACA,4BAA4B,YAAY;AACxC;AACA;AACA;AACA,qDAAqD,yBAAyB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,WAAW;AAC/B;AACA;AACA;AACA,oBAAoB,WAAW;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA,4BAA4B,iBAAO;AACnC;AACA;AACA;AACA;AACA,+CAA+C,gBAAgB;AAC/D;AACA;AACA;AACA,6CAA6C,qBAAqB;AAClE;AACA;AACA,iCAAiC,WAAW,aAAa,sBAAc,uFAAuF,iBAAiB;AAC/K;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,gBAAgB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,aAAU;AACrB,QAAQ,UAAO,IAAI,eAAe;AAClC,QAAQ,UAAO,IAAI,kBAAkB;AACrC;AACA;AACA,CAAC;AACe;;;ACvI6C;AACiB;AACtB;AACjD,4BAA4B,eAAe;AAC3C;AACP;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,mBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,qBAAqB,QAAQ,IAAI,gCAAU;AAC3C;AACA;AACO;AACP;AACA,qBAAqB,QAAQ,IAAI,gCAAU;AAC3C;AACA;AACA,sEAAsE,kEAAkE,EAAE;AAC1I;AACA;AACA;AACO;AACP;AACA;;;AC3FA,IAAI,2BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACyD;AACD;AACF;AACI;AACY;AAC0G;AACjL,IAAI,sCAAkB;AACtB;AACA,mCAAmC,gBAAgB;AACnD,+BAA+B,YAAY;AAC3C,oCAAoC,iBAAiB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,yBAAyB,qBAAqB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,QAAe,mEAAmE,gBAAgB;AAChI;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,SAAiB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA,uBAAuB,SAAiB;AACxC,wBAAwB,SAAiB;AACzC;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA;AACA,8DAA8D,QAAQ,MAAa,2CAA2C,EAAE;AAChI;AACA;AACA;AACA;AACA,mCAAmC,SAAiB;AACpD;AACA;AACA;AACA,kDAAkD,gBAAgB;AAClE;AACA;AACA;AACA,6CAA6C,gBAAgB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,gBAAgB;AAClE;AACA;AACA,oBAAoB,QAAc,iBAAiB,QAAc;AACjE;AACA;AACA;AACA;AACA,0BAA0B,SAAiB;AAC3C;AACA;AACA;AACA;AACA,mBAAmB,UAAkB;AACrC;AACA;AACA;AACA;AACA,6CAA6C,gBAAgB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,cAAc,0CAA0C,oBAAoB,EAAE;AACtF;AACA;AACA;AACA,YAAY,mBAAmB;AAC/B;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AAC9B,IAAI,6CAAyB;AAC7B,IAAI,2BAAS;AACb;AACA;AACA,uBAAuB,gBAAgB;AACvC,mBAAmB,oBAAoB;AACvC;AACA,oDAAoD,gBAAgB;AACpE;AACA,gBAAgB,yBAAyB;AACzC;AACA,kCAAkC,yBAAyB;AAC3D,8BAA8B,YAAY,oCAAoC,uEAAuE,EAAE;AACvJ,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,sCAAkB;AACiB;AACrC,IAAI,iCAAa;AACjB;AACA,iDAAiD,+BAA+B,sCAAkB,GAAG;AACrG,+CAA+C,6BAA6B,WAAW,GAAG;AAC1F,8CAA8C,4BAA4B,sCAAkB,GAAG;AAC/F,wDAAwD,sCAAsC,WAAW,GAAG;AAC5G,iCAAiC,gBAAgB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,WAAW;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,gBAAgB;AACnD;AACA;AACA;AACA;AACA,0CAA0C,sCAAkB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;ACvSzB;AACA;AACA;AACA;AACA,IAAI,iCAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACsC;AACuB;AACC;AACA;AAC/D,IAAI,mDAAyB;AAC7B,IAAI,iCAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,aAAa;AACtD;AACA,4DAA4D,aAAO;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uFAAuF,KAAK,MAAM;AAClG,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF,QAAY,mBAAmB,EAAE;AACpH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,QAAY,yCAAyC,EAAE,GAAG,EAAE;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6GAA6G,6CAA6C,EAAE;AAC5J;AACA;AACA,wIAAwI,6CAA6C,EAAE;AACvL;AACA;AACA;AACA,4BAA4B,kEAAkE;AAC9F,6BAA6B;AAC7B;AACA;AACA,yEAAyE,kDAAkD;AAC3H;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACyB;;;ACtIqC;AAC1E,IAAI,qCAAkB;AACtB;AACA;AACA;AACA,wDAAwD,SAAS;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,SAAS;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,SAAS;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,QAAQ;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,QAAQ;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,iBAAiB;AAC3D,0CAA0C,iBAAiB;AAC3D;AACA,4BAA4B,8BAA8B;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,QAAQ;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;;;AC9N9B;AACA;AACA;AACA;AACoE;AACd;AACe;AACR;AAC7D,IAAI,2CAAuB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sBAAE;AACd;AACA;AACA;AACA;AACA,iBAAiB,sBAAE;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,uBAAuB;AACvD;AACA;AACA,qBAAqB,gBAAgB,mBAAmB,sBAAE;AAC1D;AACA;AACA;AACA;AACA;AACA,4DAA4D,SAAS;AACrE;AACA,yBAAyB,gBAAgB,IAAI,sBAAE;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,uBAAuB;AACvD;AACA,QAAQ,gBAAgB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,sBAAE;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACM,8BAA8B,2CAAuB;AAC5D;AACO,IAAI,8BAAU;AACrB;AACA;AACA,QAAQ,KAAK,8BAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;;;ACxBlC;AACA;AACA;AACA;AACoC;AACpC;AACA;AACA,+BAA+B,iBAAiB;AAChD,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,aAAa,QAAY,EAAE,0FAA0F;AACrH,cAAc,QAAY,EAAE,yFAAyF;AACrH,YAAY,QAAY,EAAE,qFAAqF;AAC/G,aAAa,QAAY,EAAE,6FAA6F;AACxH;AACA,CAAC;AACD,aAAa,QAAY,EAAE,0FAA0F;AACrH,cAAc,QAAY,EAAE,yFAAyF;AACrH,YAAY,QAAY,EAAE,qFAAqF;AAC/G,aAAa,QAAY,EAAE,yFAAyF;AACpH;AACA,CAAC;AACD;AACA;AACA;AACO;AACP,aAAa,QAAY,EAAE,8FAA8F;AACzH,cAAc,QAAY,EAAE,6FAA6F;AACzH,YAAY,QAAY,EAAE,yFAAyF;AACnH,aAAa,QAAY,EAAE,6FAA6F;AACxH;AACA,CAAC;AACD,aAAa,QAAY,EAAE,8FAA8F;AACzH,cAAc,QAAY,EAAE,6FAA6F;AACzH,YAAY,QAAY,EAAE,yFAAyF;AACnH,aAAa,QAAY,EAAE,iGAAiG;AAC5H;AACA,CAAC;AACD,aAAa,QAAY,EAAE,8FAA8F;AACzH,cAAc,QAAY,EAAE,6FAA6F;AACzH,YAAY,QAAY,EAAE,yFAAyF;AACnH,aAAa,QAAY,EAAE,6FAA6F;AACxH;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/FA;AACA;AACA;AACA;AACA,IAAI,kCAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2G;AACd;AAC9F;AACA;AACA;AACA,IAAI,qDAA0B;AAC9B,IAAI,kCAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,YAAY;AAC9B;AACA;AACA;AACA,CAAC,CAAC,kBAAkB;AACkB;;;AC1HtC;AACA;AACA;AACA;AAC4D;AACkB;AACvE,IAAI,qBAAQ,GAAG,eAAY;AAC3B,2BAA2B,eAAe;AACjD;AACA;AACA;AACA;AACA,CAAC;AAC2B;;;ACb5B;AACA;AACA;AACA;AACkD;AACa;AACe;AACd;AACzD,+BAA+B,eAAe;AAC9C;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,gCAAgC;AAC1B,IAAI,0BAAgB;AAC3B;AACA;AACA;AACA,eAAe,OAAG;AAClB;AACA;AACA;AACA;AACA,CAAC,EAAE,0BAAgB,KAAK,0BAAgB,KAAK;AAC7C,IAAI,mBAAS;AACb;AACA,iCAAiC,cAAc;AAC/C,wCAAwC,uBAAuB;AAC/D;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C,2CAA2C,gBAAgB;AAC3D;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,CAAC;AACoB;AACrB,IAAI,yBAAe;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAkB;AACjC;AACA;AACA,gBAAgB;AAChB;AACA;AACA,CAAC;AAC0B;;;ACnG3B;AACA;AACA;AACA;AACA,IAAI,sBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,uBAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,oBAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AAC2C;AACS;AAC2B;AACvB;AAC8B;AACkB;AAC5B;AACpB;AACN;AACY;AACA;AACqD;AAChD;AACH;AACb;AACQ;AACK;AACiB;AACe;AAC6C;AAChC;AACd;AACE;AACM;AACQ;AACtB;AACP;AAClF,IAAI,0BAAW;AACf;AACA;AACA,8BAA8B,aAAO;AACrC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA,QAAQ,YAAY;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,+CAAgC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,0CAA0C,EAAE,yBAAyB,+HAA+H,EAAE;AACtQ;AACA,mBAAmB,8BAAQ,QAAQ,iBAAiB;AACpD;AACA,eAAe,8BAAQ,QAAQ,iBAAiB,KAAK,0BAAW;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA,CAAC;AAC8B;AAC/B,IAAI,wCAAyB;AAC7B;AACA;AACA;AACA,4BAA4B,WAAW,eAAQ,yBAAyB;AACxE;AACA;AACA,4BAA4B,WAAW,eAAQ,4BAA4B;AAC3E;AACA;AACA,4BAA4B,WAAW,eAAQ,wBAAwB;AACvE;AACA;AACA;AACA,iBAAiB,eAAQ;AACzB;AACA;AACA,iBAAiB,eAAQ;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,gBAAgB;AAC1D;AACA,CAAC;AACoC;AACrC,IAAI,uCAAwB;AAC5B;AACA,yCAAyC,aAAO;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA,SAAS;AACT;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA,6CAA6C,gBAAgB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmC;AACpC,IAAI,0CAA2B;AAC/B,IAAI,sBAAS;AACb;AACA;AACA;AACA;AACA,wBAAwB,qBAAyB,UAAU,SAAa;AACxE,+BAA+B,mCAAqB;AACpD;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,gBAAgB,aAAa,sBAAE;AACvD;AACA;AACA;AACA;AACA,SAAS;AACT,uBAAuB,YAAY;AACnC,2BAA2B,sCAAsC;AACjE;AACA;AACA;AACA,0CAA0C,0BAA0B;AACpE;AACA;AACA;AACA,SAAS;AACT;AACA,sCAAsC,uCAAwB;AAC9D;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,6BAA6B,0BAA0B;AACvD,eAAe,kBAAkB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,mBAAmB;AAChF;AACA,uCAAuC,qCAAkB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA,0CAA0C,sBAAsB;AAChE;AACA;AACA;AACA,+BAA+B,gCAAgC;AAC/D,8CAA8C,sBAAsB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,qDAA0B,aAAa,sBAAE;AAC7D;AACA;AACA,6BAA6B,gBAAgB;AAC7C,mBAAmB,qDAA0B,aAAa,sBAAE;AAC5D;AACA;AACA,CAAC,CAAC,mDAAyB;AACY;AACvC;AACA;AACA;AACA;AACA,yDAAyD,OAAG;AAC5D;AACA,IAAI,yCAA0B;AAC9B;AACA,6CAA6C,aAAO;AACpD;AACA,kCAAkC,iCAAa,KAAK,6CAAyB,QAAQ,sCAAkB;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqC;AACtC,IAAI,iDAAkC;AACtC;AACA;AACA;AACA,oDAAoD,aAAO;AAC3D;AACA;AACA,SAAS;AACT;AACA;AACA,uBAAuB,QAAG;AAC1B;AACA;AACA;AACA;AACA,CAAC;AAC6C;AAC9C,IAAI,8CAA+B;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,2BAAO,IAAI,+BAAW;AACtC;AACA,sCAAsC,uBAAU;AAChD,QAAQ,oBAAO,IAAI,qBAAqB;AACxC;AACA;AACA,CAAC;AAC0C;AAC3C,IAAI,gCAAiB;AACrB;AACA;AACA;AACA;AACA,mBAAmB,SAAI,KAAK,8BAAQ;AACpC;AACA;AACA,CAAC;AAC4B;AAC7B,IAAI,yCAA0B;AAC9B;AACA;AACA;AACA,eAAe,8BAAQ;AACvB;AACA;AACA,CAAC;AACqC;AACtC,IAAI,4CAA6B;AACjC;AACA,uBAAuB,OAAG,OAAO,8EAA8E;AAC/G,0BAA0B,2DAA2D,yBAAe,EAAE,oCAAoC;AAC1I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwC;AAClC;AACP;AACA;AACA;AACA,0CAA0C,yCAA0B;AACpE;AACA;AACA;AACA,YAAY,wBAAwB;AACpC;AACA;AACA,4BAA4B,4BAA4B;AACxD;AACA;AACA,KAAK;AACL;AACA,IAAI,oCAAqB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,gBAAgB;AAClE;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,QAAQ,2BAAa,aAAa,WAAK,8BAA8B,EAAE;AAC/H;AACA;AACA,SAAS;AACT;AACA;AACA,yBAAyB,QAAQ,mBAAmB,EAAE,WAAW,EAAE;AACnE,SAAS;AACT;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;;;;;;ACvbjC;AACA;AACA;AACA;AACoB;AACsB;AACgB;AACtB;AACpC;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,UAAK;AACrB;AACA;AACA;AACA;AACA;AACO,SAAS,WAAM;AACtB,QAAQ,+BAAW;AACnB,QAAQ,UAAK,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,QAAY,eAAe,EAAE;AAC/C;AACA;AACA,kBAAkB,QAAY,qBAAqB,EAAE,YAAY,EAAE;AACnE;AACA;AACA,IAAI,SAAa;AACjB;AACA;AACA;AACA;AACA;;;;;;;;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACM;AACP;AACA;AACA;;;AClHA;AACA;AACA;AACA;AACA,IAAI,2BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC8D;AAC/D;AACA,IAAI,2BAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA4E,+CAA+C,EAAE;AAC7H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACmB;;;AC9E/B;AACA;AACA;AACA;AACA,IAAI,qBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2D;AACJ;AACO;AACF;AACW;AACT;AACuB;AAC3B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,0BAA0B,EAAE;AACtF;AACA;AACA,CAAC;AACD,IAAI,mCAAqB;AACzB,IAAI,qBAAS;AACb;AACA;AACA,iDAAiD,aAAO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,QAAQ;AACzC,+BAA+B,YAAoB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,gBAAgB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,cAAc;AACtB;AACA;AACA;AACA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAwC;AAChF,mBAAmB,QAAQ;AAC3B,uBAAuB,YAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACZ,IAAI,2BAAa;AACjB,IAAI,qBAAS;AACb;AACA,6CAA6C,4BAA4B;AACzE;AACA,yDAAyD,mBAAmB,mCAAmC,kDAAkD,EAAE;AACnK,wBAAwB,mCAAqB,mCAAmC,gDAAgD,EAAE;AAClI;AACA;AACA;AACA,wBAAwB,oBAA4B,eAAe,kCAAkC,EAAE;AACvG,wBAAwB,+BAAuC,cAAc,kCAAkC,EAAE;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,IAAY;AACxB;AACA;AACA,iBAAiB,SAAiB;AAClC;AACA;AACA,iBAAiB,MAAc;AAC/B;AACA;AACA,iBAAiB,QAAgB;AACjC;AACA;AACA,YAAY,+BAAoB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,QAAgB,IAAI,SAAiB;AAC1E,wBAAwB,aAAqB;AAC7C,uBAAuB,YAAoB;AAC3C,kCAAkC,uBAA+B;AACjE;AACA;AACA;AACA,eAAe,mCAAqB;AACpC;AACA;AACA,CAAC,CAAC,4CAAyB;AACF;;;AC9RzB;AACA;AACA;AACA;AACA,IAAI,wBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,uBAAQ,IAAI,SAAI,IAAI,SAAI;AAC5B,IAAI,uBAAQ;AACZ,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,uBAAQ;AACnB;AACoD;AACU;AACf;AACsB;AACf;AACa;AACO;AACM;AACF;AACsB;AACN;AACxB;AACW;AACjF,IAAI,wBAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,YAAY;AACxB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,6BAA6B,yBAAc;AAC3C;AACA;AACA;AACA;AACA;AACA,YAAY,mBAAmB;AAC/B;AACA,oDAAoD,yCAAyC,EAAE;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,YAAY,gBAAgB;AAC5B;AACA,oDAAoD,yCAAyC,EAAE;AAC/F;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACkB;AACnB,IAAI,8BAAa;AACjB,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,wBAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,6CAA6C,kBAAkB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,kBAAkB;AACjE;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,wBAAO;AACgB;AACzB,IAAI,6BAAY;AAChB,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,YAAY,gBAAgB,MAAM;AAC9C;AACA;AACA;AACA,iBAAiB;AACjB,sBAAsB,yBAAc;AACpC;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA,0BAA0B,kEAAkE;AAC5F,uBAAuB,kEAAkE;AACzF,mBAAmB,QAAQ;AAC3B,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA,qBAAqB,iBAAiB,mCAAmC,uBAAQ,EAAE,gCAAgC;AACnH;AACA;AACA,CAAC,CAAC,8BAAa;AACS;AACxB;AACA;AACO;AACP,IAAI,gBAAgB,gDAAgD,oCAAoC,EAAE,EAAE;AAC5G;AACO;AACP;AACA;AACA,kCAAkC,OAAG;AACrC,kBAAkB,eAAe;AACjC;AACA,aAAa,QAAQ;AACrB,kBAAkB,eAAe;AACjC;AACA,iCAAiC,aAAa;AAC9C;AACA,iCAAiC,QAAQ;AACzC;AACA;AACA,4BAA4B,iBAAiB;AAC7C,mBAAmB,MAAM;AACzB;AACA,2EAA2E,QAAQ;AACnF;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb,SAAS;AACT,KAAK;AACL;AACO;AACP;AACA;AACA;AACO;AACP;AACA;AACO;AACP;AACA;AACO;AACP;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,4DAA4D;AAC7D;AACA,IAAI,2BAAU;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,QAAQ,KAAK,2BAAU;;;ACvRvB;AACA;AACA;AACA;AACgC;AAChC,IAAI,uBAAW;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,WAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;AAChB;AACP,eAAe,uBAAW;AAC1B;;;AC7KO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;;ACjCA;AACA;AACA;AACA;AACA,IAAI,aAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,cAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AAC8C;AACM;AACf;AACa;AAC3C,IAAI,eAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,eAAS,KAAK,eAAS,KAAK;AAC/B,IAAI,aAAO;AACX,IAAI,aAAS;AACb;AACA;AACA;AACA;AACA;AACA,wBAAwB,qBAA8B,uCAAuC,8BAA8B,EAAE;AAC7H,wBAAwB,qBAA8B,qCAAqC,4BAA4B,EAAE;AACzH,wBAAwB,qBAA8B,sCAAsC,6BAA6B,EAAE;AAC3H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA,qDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,eAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,IAAW;AAC3D,gDAAgD,IAAW;AAC3D,iDAAiD,eAAS;AAC1D,4BAA4B,IAAW;AACvC,4BAA4B,IAAW;AACvC;AACA;AACA;AACA,gDAAgD,IAAW;AAC3D,gDAAgD,IAAW;AAC3D,iDAAiD,eAAS;AAC1D,4BAA4B,IAAW;AACvC,4BAA4B,IAAW;AACvC;AACA;AACA;AACA,6BAA6B,IAAW;AACxC,6BAA6B,IAAW;AACxC,6BAA6B,IAAW;AACxC;AACA;AACA;AACA,qEAAqE,6EAA6E,EAAE;AACpJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,eAAS;AACjE;AACA;AACA;AACA;AACA,sDAAsD,SAAS;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,sBAAsB,gCAAqC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,eAAS;AACrD;AACA;AACA,6CAA6C,6BAA6B,EAAE;AAC5E;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,mCAAmC;AACnC,sDAAsD,SAAS;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,eAAS;AACpD,6CAA6C,IAAW;AACxD,6CAA6C,IAAW;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,cAAU;AACd,QAAQ,OAAO;AACf;AACA;AACA,CAAC,CAAC,UAAU;AACO;;;ACvOnB;AACA;AACA;AACA;AACA,IAAI,8BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC+B;AACU;AACW;AACQ;AACtD;AACP,iBAAiB,6BAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6CAAsB;AAC1B,IAAI,8BAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAO;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,WAAW;AACrC,uBAAuB,wBAAwB;AAC/C,4BAA4B,8BAAkC,+DAA+D,sCAAsC,EAAE,sCAAsC,4DAA4D,EAAE;AACzQ,4BAA4B,qBAAyB,0DAA0D,mCAAmC,EAAE;AACpJ;AACA,YAAY,WAAW;AACvB;AACA;AACA;AACA,4BAA4B,qBAAyB;AACrD,4BAA4B,6BAAkB;AAC9C;AACA;AACA;AACA,aAAa;AACb;AACA,4BAA4B,qBAAyB;AACrD,4BAA4B,6BAAkB;AAC9C;AACA;AACA;AACA,aAAa;AACb;AACA,4BAA4B,qBAAyB;AACrD;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACsB;;;ACrGlC;AACA;AACA;AACA;AACA,IAAI,iBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACgD;AACqC;AAChB;AACV;AAC5D;AACA;AACA;AACA,IAAI,yBAAe;AACnB;AACA;AACA;AACA;AACA;AACA,mBAAmB,2BAAiB,UAAU,cAAkB,mBAAmB,cAAkB;AACrG;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,2BAAiB;AACrB;AACA;AACA;AACA;AACA;AACA,mBAAmB,yBAAe,gBAAgB,cAAkB,yBAAyB,cAAkB;AAC/G;AACA;AACA,CAAC;AAC4B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AACvB;AACP,oBAAoB,sBAA0B;AAC9C;AACA;AACA;AACA,IAAI,iBAAS;AACb;AACA;AACA,wBAAwB,yBAAe;AACvC;AACA;AACA;AACA;AACA,CAAC,CAAC,6BAAkB;AACQ;AAC5B,IAAI,iCAAuB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,qBAAyB;AACxC;AACA,SAAS;AACT;AACA;AACA;AACA,eAAe,qBAAyB;AACxC;AACA,SAAS;AACT;AACA;AACA;AACA,eAAe,qBAAyB;AACxC;AACA,SAAS;AACT;AACA;AACA;AACA,eAAe,wCAA4C;AAC3D;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,8BAAkC;AACjD;AACA;AACA,CAAC;AACkC;AACnC,IAAI,sCAA4B;AAChC,IAAI,iBAAS;AACb;AACA;AACA;AACA,4DAA4D,6CAAsB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,6BAAiC;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,UAAU;AAC4B;;;ACzJxC;AACA;AACA;AACA;AACA,IAAI,wBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC8D;AAC/D;AACA,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACgB;;;ACvL5B;AACA;AACA;AACA;AACA,IAAI,gBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACkE;AACW;AAC9E;AACA,IAAI,gBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,gBAAgB;AACE;AACpB,IAAI,yBAAgB;AACpB;AACA;AACA;AACA,8BAA8B,uBAAW;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;;;ACvE5B;AACA;AACA;AACA;AACA,IAAI,wBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqC;AACtC;AACA,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;AC7E3B;AACA;AACA;AACA;AAC2E;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,eAAe;AACvC;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,eAAe;AACzD;AACA;AACA;AACA;AACA,kCAAkC,eAAe;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;AC7HrB;AACA;AACA;AACA;AAC8E;AACb;AACH;AACN;AACjD,oBAAoB,eAAe;AACnC;AACP,YAAY;AACZ;AACA;AACO;AACA;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACO,IAAI,uBAAU;AACrB;AACA;AACA,IAAI,4BAAe;AACnB;AACA;AACA;AACA,oDAAoD,aAAO;AAC3D;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,0BAA0B,4BAAe;AACzC,QAAiB,KAAK,uBAAU;AACzB;AACP;AACA;;;AClDA;AACA;AACA;AACA;AACA,IAAI,gBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC8D;AACa;AACZ;AACrB;AACgC;AACI;AACoC;AACjC;AAClF;AACA,QAAQ,4BAAiB;AACzB;AACA;AACA;AACA,QAAQ,2BAAgB,IAAI,SAAiB,IAAI,QAAgB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,mCAAmC,UAAkB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,CAAC;AAC4B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B,IAAI,iBAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,iBAAiB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE,aAAa;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,cAAc;AACpD,iEAAiE,aAAa;AAC9E;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,cAAc;AACnE;AACA;AACA;AACA,kCAAkC,gCAAe;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,iCAAiC;AACjC;AACA;AACA,qBAAqB,cAAc;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,6BAAoB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC,kCAAkC;AAClC;AACA;AACA,6FAA6F;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;AACpB;AACA;AACA;AACA,IAAI,6BAAoB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,eAAe;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,IAAI,yBAAgB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,eAAe;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,eAAe;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,eAAe;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,mBAAS;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,gBAAgB;AACxC,+BAA+B,gBAAgB;AAC/C,gBAAgB,mBAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,eAAe;AACvC;AACA;AACA,6BAA6B,gBAAgB;AAC7C,oCAAoC,gBAAgB;AACpD;AACA,2BAA2B,gBAAgB;AAC3C,kCAAkC,gBAAgB;AAClD,eAAe,mBAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,IAAI,gBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,yBAAgB;AAClB;AACA,QAAQ,QAAgB;AACxB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,eAAe,yBAAgB;AAC/B;;;ACxdA;AACA;AACA;AACA;AACA,IAAI,mBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2D;AACV;AACK;AACG;AACD;AACS;AAClE,IAAI,uBAAW;AACf;AACA,qCAAqC,iBAAiB;AACtD,kCAAkC,iBAAiB;AACnD,+BAA+B,cAAc;AAC7C,gCAAgC,eAAe;AAC/C;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,0BAAc;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,QAAQ;AAC5C;AACA;AACA;AACA,qCAAqC,QAAQ;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,WAAW;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,8BAAkB;AACzD;AACA;AACA,CAAC;AACD,IAAI,0BAAc;AAClB,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA;AACA,+BAA+B,yBAAgB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD,+BAA+B,cAAc;AAC7C,gCAAgC,eAAe;AAC/C,mBAAmB,uBAAW;AAC9B;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,8BAAkB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,yBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0BAAc;AACpC,0BAA0B,0BAAc;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,+BAA+B,mBAAmB,QAAQ;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,SAAS;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,SAAS;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,QAAQ;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE,QAAQ;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,QAAQ;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,QAAQ;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,QAAQ;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,QAAQ;AAC9B;AACA;AACA,gBAAgB,MAAc;AAC9B;AACA;AACA,kEAAkE,QAAQ;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,4CAA4C;AACjE;AACA;AACA;AACA,6BAA6B,kDAAkD;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,kDAAkD;AAC/E;AACA;AACA,qCAAqC,4BAA4B,EAAE;AACnE,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA,8BAA8B,WAAW;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,yBAAe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD;AACpD,8DAA8D;AAC9D,8DAA8D;AAC9D;AACA,qCAAqC,iBAAQ;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD;AACpD,8DAA8D;AAC9D;AACA,qCAAqC,iBAAQ;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D,8DAA8D;AAC9D,8DAA8D;AAC9D;AACA,qCAAqC,iBAAQ;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,iBAAQ;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;;;AC/uB9B;AACA;AACA;AACA;AACA,IAAI,oBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2D;AACR;AAC0B;AACC;AAChB;AACF;AACsB;AACkD;AACtE;AACN;AACE;AACmB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,yBAAY;AAChB,IAAI,oBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,8BAAkB;AACzD,wDAAwD,+BAAkB,wFAAwF,qDAAqD,EAAE,gBAAgB,iCAAiC,EAAE;AAC5Q,gDAAgD,gBAAgB,cAAc,yCAAyC,EAAE;AACzH;AACA,8BAA8B,iCAAuB;AACrD,8FAA8F,sCAAsC,EAAE;AACtI,qGAAqG,8BAA8B,EAAE;AACrI,0FAA0F,4BAA4B,EAAE;AACxH,6FAA6F,+BAA+B,EAAE;AAC9H,4FAA4F,8BAA8B,EAAE;AAC5H;AACA;AACA;AACA;AACA,wBAAwB,kCAAuB;AAC/C;AACA,gCAAgC,UAAU;AAC1C;AACA,gBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA,wBAAwB,qBAAyB;AACjD,wBAAwB,qBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,2BAAiB;AAC7C;AACA,wBAAwB,wBAAwB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,+BAAoB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,IAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,+CAA+C;AAC/C;AACA,CAAC,CAAC,gBAAgB;AACM;AACxB,IAAI,+BAAkB;AACtB,IAAI,oBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,sCAA4B;AAClF,qDAAqD,YAAY;AACjE;AACA,sCAAsC,mBAAS;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mGAAmG,sCAAsC,EAAE;AAC3I;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,mGAAmG,sCAAsC,EAAE,eAAe,sBAAsB,EAAE;AAClL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0BAAc;AAC7C;AACA;AACA;AACA,+BAA+B,uBAAW;AAC1C;AACA;AACA;AACA,uBAAuB,uBAAW,iDAAiD,QAAQ;AAC3F;AACA;AACA;AACA,+BAA+B,0BAAc;AAC7C;AACA;AACA;AACA,+BAA+B,uBAAW;AAC1C;AACA;AACA;AACA,uBAAuB,uBAAW,iDAAiD,QAAQ;AAC3F;AACA;AACA;AACA,uBAAuB,uBAAW,iDAAiD,QAAQ;AAC3F;AACA;AACA,uBAAuB,uBAAW,iDAAiD,QAAQ;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,uBAAW;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,QAAQ;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,UAAU;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,qBAAqB,EAAE;AACjD;AACA;AACA,KAAK;AACL;AACA,0BAA0B,sBAAsB,EAAE;AAClD;AACA;AACA,KAAK;AACL;AACA,0BAA0B,sBAAsB,EAAE;AAClD;AACA;AACA,KAAK;AACL;AACA,0BAA0B,uBAAuB,EAAE;AACnD;AACA;AACA,KAAK;AACL;AACA,0BAA0B,yBAAyB,EAAE;AACrD;AACA;AACA,KAAK;AACL;AACA,0BAA0B,2BAA2B,EAAE;AACvD;AACA;AACA,KAAK;AACL;AACA,0BAA0B,mCAAmC,EAAE;AAC/D;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA,CAAC;;;ACnfD;AACA;AACA;AACA;AACA,IAAI,sBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACmD;AACgB;AACnB;AACE;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,+BAAgB;AACpB,IAAI,sBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,gCAAgC,8BAAkC,wEAAwE,kCAAkC,EAAE;AAC9K,gCAAgC,qBAAyB,qEAAqE,sCAAsC,EAAE;AACtK;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,gBAAgB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,yBAAY;AACd;AACA;AACA;AACA,IAAI,qCAAsB;AAC1B,IAAI,sBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,gCAAgC,8BAAkC,wEAAwE,kCAAkC,EAAE;AAC9K,gCAAgC,qBAAyB,qEAAqE,sCAAsC,EAAE;AACtK;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,gBAAgB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,yBAAY;AACd,IAAI,2BAAY;AAChB,IAAI,sBAAS;AACb;AACA;AACA,QAAQ,aAAO;AACf,wBAAwB,qBAAyB,uCAAuC,eAAS,oBAAoB,uBAAuB,EAAE;AAC9I,wBAAwB,qBAAyB,uCAAuC,eAAS,uBAAuB,0BAA0B,EAAE;AACpJ,wBAAwB,qBAAyB,uCAAuC,eAAS,4BAA4B,iCAAiC,gBAAgB,0CAA0C,EAAE;AAC1N;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,gBAAgB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,yBAAY;AACd,IAAI,6BAAc;AAClB;AACA;AACA,+BAA+B,+BAAgB;AAC/C;AACA;AACA,+BAA+B,2BAAY;AAC3C;AACA;AACA,+BAA+B,qCAAsB;AACrD;AACA;AACA,+BAA+B,yBAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;;;;ACpO1B;AACA;AACA;AACA;AAC2D;AACF;AACN;AACnD,IAAI,2BAAa;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,UAAkB,iCAAiC,QAAgB;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kBAA0B;AACrD;AACA;AACA;AACA;AACA,2BAA2B,kBAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,UAAkB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,QAAgB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE;AACpE;AACA;AACA;AACA;AACA;AACA,0DAA0D,aAAqB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,0BAAkC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;AACzB,IAAI,uCAAyB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE,WAAK;AAC5E;AACA;AACA;AACA,sEAAsE,WAAK;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,2BAAa,8EAA8E,QAAQ,wDAAwD,QAAQ;AACtL;AACA;AACA;AACA,CAAC;AACoC;;;ACnOrC;AACA;AACA;AACA;AACA,IAAI,qBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2D;AACR;AACa;AACT;AACO;AACF;AACF;AACR;AACQ;AACpD;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,2BAAa;AACjB,IAAI,qBAAS;AACb;AACA;AACA,6CAA6C,aAAO;AACpD;AACA,4CAA4C,aAAO;AACnD;AACA,+CAA+C,aAAO;AACtD;AACA,6CAA6C,aAAO;AACpD;AACA,2CAA2C,aAAO;AAClD;AACA,6CAA6C,aAAO;AACpD;AACA,4CAA4C,aAAO;AACnD;AACA,wDAAwD,aAAO;AAC/D;AACA,yDAAyD,aAAO;AAChE;AACA,sDAAsD,aAAO;AAC7D;AACA,8DAA8D,aAAO;AACrE;AACA;AACA,8CAA8C,6BAAe;AAC7D;AACA,qDAAqD,gBAAgB,cAAc,4BAA4B,EAAE;AACjH,+BAA+B,2BAAa;AAC5C;AACA;AACA;AACA;AACA,wBAAwB,6BAAiC;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,wBAAwB,6BAAiC;AACzD;AACA,SAAS;AACT,wBAAwB,qBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,UAAkB;AACnC,oEAAoE,2BAAa;AACjF;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,2BAA2B,2BAAa;AACxC,8BAA8B,2BAAa;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,2BAAa;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAkB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,IAAY;AAC5B;AACA;AACA;AACA;AACA,wBAAwB,qBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,wBAAwB,qBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAkB,IAAI,QAAgB;AACtD,uCAAuC,2BAAa;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,wBAAwB,qBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,+BAAoB,sDAAsD,+BAAoB;AACtK,iFAAiF,eAAuB;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;AACT;AACA,wBAAwB,qBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,wBAAwB,qBAAyB;AACjD;AACA;AACA,SAAS;AACT,wBAAwB,qBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,6DAA6D,2BAAa;AAC1E;AACA;AACA;AACA,SAAS;AACT,wBAAwB,qBAAyB;AACjD;AACA;AACA,SAAS;AACT,wBAAwB,qBAAyB;AACjD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,qBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,QAAgB,KAAK,6BAAkB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,mBAAS;AAC5C;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,MAAc;AAC9B;AACA;AACA,4DAA4D,2BAAa;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,2BAAa;AACvE;AACA;AACA;AACA,YAAY,mBAA2B;AACvC;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,6BAAe;AACnB,IAAI,qBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,SAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,SAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,oBAAwB;AACtD;AACA;AACA;AACA,YAAY,uBAA2B;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;;;;;;AC/eZ;AACA;AACA;AACA;AACA,IAAI,0BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC6E;AAC9E;AACA,IAAI,0BAAS;AACb;AACA;AACA;AACA;AACA,CAAC,CAAC,gBAAgB;AACY;;;ACzB9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,iBAAiB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,sCAAsC;AAC/C,KAAK,6CAA6C;AAClD,CAAC,sBAAsB;;;AC7cvB;AACA;AACA;AACA;AAC8D;AACF;AACrB;AACvC;AACO,IAAI,wBAAU;AACrB;AACA;AACA,IAAI,2BAAa;AACjB;AACA,4BAA4B,8BAA8B,QAAY,kEAAkE;AACxI,qCAAqC;AACrC;AACA;AACA;AACA,2CAA2C,2BAA2B;AACtE,iCAAiC;AACjC;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2EAA2E,4DAA4D,EAAE;AACzI;AACA;AACA,CAAC;AACD,wBAAwB,2BAAa;AACrC,QAAiB,KAAK,wBAAU;AACzB;AACP;AACA;AACA;AACO,IAAI,wBAAU,gCAAgC,mDAAmD,EAAE,QAAY;AAC/G,IAAI,6BAAe,qCAAqC,mDAAmD,EAAE,QAAY;AACzH,gDAAgD,OAAO,KAAK,6CAA6C,KAAK,qDAAqD,EAAE,QAAY;AACjL,sDAAsD,yCAAyC,EAAE,QAAY;AAC7G,kEAAkE,2CAA2C,EAAE,QAAY;AAC3H,+DAA+D,mDAAmD,EAAE,QAAY;AAChI,yEAAyE,4CAA4C,KAAK,QAAQ,EAAE,QAAY;AACvJ;AACO,mDAAmD,8CAA8C,EAAE,QAAY;AAC/G,yDAAyD,yBAAyB,KAAK,YAAY,KAAK,QAAQ,EAAE,QAAY;AAC9H,yDAAyD,OAAO,wBAAU,SAAS,wBAAU,MAAM,wBAAU,EAAE,EAAE,QAAY;AAC7H,iDAAiD,8CAA8C,EAAE,QAAY;AAC7G,yEAAyE,8DAA8D,EAAE,QAAY;AACrJ,qFAAqF,wCAAwC,KAAK,QAAQ,EAAE,QAAY;AACxJ,qFAAqF,oCAAoC,EAAE,QAAY;AACvI,6EAA6E,wDAAwD,EAAE,QAAY;AACnJ,2FAA2F,wCAAwC,KAAK,QAAQ,EAAE,QAAY;AAC9J,2FAA2F,oCAAoC,EAAE,QAAY;AAC7I,mFAAmF,wDAAwD,EAAE,QAAY;AACzJ,uFAAuF,wCAAwC,KAAK,QAAQ,EAAE,QAAY;AAC1J,uFAAuF,oCAAoC,EAAE,QAAY;AACzI,+EAA+E,wDAAwD,EAAE,QAAY;AACrJ,6DAA6D,yBAAyB,KAAK,YAAY,KAAK,QAAQ,EAAE,QAAY;AAClI,6DAA6D,mCAAmC,KAAK,QAAQ,EAAE,QAAY;AAC3H,iEAAiE,8CAA8C,EAAE,QAAY;AAC7H,iEAAiE,oCAAoC,EAAE,QAAY;AACnH,qFAAqF,8CAA8C,EAAE,QAAY;AACjJ,qFAAqF,OAAO,KAAK,eAAe,KAAK,kBAAkB,EAAE,QAAY;AACrJ,yFAAyF,8CAA8C,EAAE,QAAY;AACrJ,yFAAyF,oCAAoC,EAAE,QAAY;AAC3I,iFAAiF,8CAA8C,EAAE,QAAY;AAC7I,iEAAiE,8CAA8C,EAAE,QAAY;AAC7H,iEAAiE,oCAAoC,EAAE,QAAY;AACnH,+DAA+D,kEAAkE,EAAE,QAAY;AAC/I,yEAAyE,qDAAqD,EAAE,QAAY;AAC5I,qEAAqE,wCAAwC,KAAK,QAAQ,EAAE,QAAY;AACxI,6DAA6D,wCAAwC,KAAK,QAAQ,EAAE,QAAY;AAChI,yDAAyD,wCAAwC,KAAK,QAAQ,EAAE,QAAY;AAC5H,yDAAyD,OAAO,KAAK,2BAA2B,KAAK,QAAQ,EAAE,QAAY;AAC3H,yDAAyD,8CAA8C,EAAE,QAAY;AACrH,6EAA6E,OAAO,KAAK,6CAA6C,KAAK,4EAA4E,EAAE,QAAY;AACrO,uFAAuF,OAAO,KAAK,6CAA6C,KAAK,4EAA4E,EAAE,QAAY;AAC/O,yFAAyF,OAAO,KAAK,6CAA6C,KAAK,0DAA0D,EAAE,QAAY;AAC/N,qEAAqE,OAAO,KAAK,4BAA4B,KAAK,yCAAyC,EAAE,QAAY;AACzK,+CAA+C,8CAA8C,EAAE,QAAY;AAC3G,uDAAuD,wEAAwE,EAAE,QAAY;AAC7I,uDAAuD,wEAAwE,EAAE,QAAY;AAC7I,yEAAyE,+GAA+G,EAAE,QAAY;AACtM,yEAAyE,+GAA+G,EAAE,QAAY;AACtM,iEAAiE,oDAAoD,EAAE,QAAY;AACnI,yEAAyE,wDAAwD,EAAE,QAAY;AACtJ;AACA;AACA;AACA;AACA;AACO,2DAA2D,wCAAwC,KAAK,QAAQ,EAAE,QAAY;AACrI;AACA;AACA;AACO,2DAA2D,wCAAwC,KAAK,QAAQ,EAAE,QAAY;AACrI;AACA;AACA;AACO,uEAAuE,mDAAmD,EAAE,QAAY;AACxI,+DAA+D,wDAAwD,EAAE,QAAY;AACrI,2EAA2E,oCAAoC,EAAE,QAAY;AACpI;AACA;AACA;AACO,6EAA6E,mDAAmD,EAAE,QAAY;AAC9I,6EAA6E,yCAAyC,EAAE,QAAY;AACpI,mFAAmF,yJAAyJ,EAAE,QAAY;AAC1P,qFAAqF,oKAAoK,EAAE,QAAY;AACvQ,uFAAuF,oDAAoD,EAAE,QAAY;AAChK;AACA;AACA;AACO,mEAAmE,8CAA8C,EAAE,QAAY;AAC/H,qFAAqF,kDAAkD,EAAE,QAAY;AACrJ,qFAAqF,kDAAkD,EAAE,QAAY;AACrJ,qEAAqE,oDAAoD,EAAE,QAAY;AACvI,uFAAuF,oDAAoD,EAAE,QAAY;AACzJ,uFAAuF,sEAAsE,EAAE,QAAY;AAClL;AACA;AACA;AACO,6EAA6E,yDAAyD,EAAE,QAAY;AACpJ,2EAA2E,0FAA0F,EAAE,QAAY;AACnL,mEAAmE,8EAA8E,EAAE,QAAY;AACtK;AACA;AACA;AACO,+EAA+E,yBAAyB,KAAK,WAAW,KAAK,OAAO,EAAE,QAAY;AACzJ;AACA;AACA;AACO,6BAA6B,KAAK,KAAK,IAAI;AAC3C,6BAA6B,KAAK,KAAK,IAAI;AAC3C,uEAAuE,gEAAgE,EAAE,QAAY;AACrJ,qEAAqE,gEAAgE,EAAE,QAAY;AACnJ,0EAA0E,2CAA2C,EAAE,QAAY;AACnI,wEAAwE,yCAAyC,EAAE,QAAY;AAC/H,qDAAqD,8CAA8C,EAAE,QAAY;AACxH;AACA;AACA;AACO,mGAAmG,WAAW,KAAK,KAAK,IAAI,kCAAkC,KAAK,KAAK,IAAI,6BAA6B,KAAK,KAAK,IAAI,uBAAuB,EAAE,QAAY;AAC5P,2FAA2F,oCAAoC,EAAE,QAAY;AAC7I,6GAA6G,oCAAoC,EAAE,QAAY;AAC/J,qGAAqG,6BAA6B,KAAK,KAAK,IAAI,oCAAoC,EAAE,QAAY;AACzM,gCAAgC,KAAK,KAAK,IAAI;AACvC,iGAAiG,uFAAuF,EAAE,QAAY;AACtM,mHAAmH,yDAAyD,EAAE,QAAY;AAC1L;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA,qDAAqD,2BAA2B;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,KAAK;AAChC;AACA,uBAAuB,KAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,KAAK;AACxB;AACA;AACA;AACA,mCAAmC,KAAK;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3OA;AACA;AACA;AACA;AACuC;AACqB;AAC8E;AAC9C;AAC5F;AACA;AACA;AACO,0BAA0B,aAAa,oCAAoC,oCAAoC,EAAE,QAAY;AAC7H,gCAAgC,aAAa,gCAAgC,mDAAmD,EAAE,QAAY;AAC9I,2BAA2B,aAAa,qCAAqC,kDAAkD,EAAE,QAAY;AAC7I,iCAAiC,aAAa,iCAAiC,8BAA8B,oBAAoB,EAAE,EAAE,QAAY;AACjJ,6BAA6B,aAAa,6BAA6B,yBAAyB,KAAK,YAAY,KAAK,QAAQ,EAAE,QAAY;AAC5I,6BAA6B,aAAa,kCAAkC,QAAY;AACxF,wBAAwB,aAAa,iCAAiC,yDAAyD,EAAE,QAAY;AAC7I,yBAAyB,aAAa,kCAAkC,2EAA2E,EAAE,QAAY;AACjK,+BAA+B,aAAa,wCAAwC,2EAA2E,EAAE,QAAY;AAC7K,wBAAwB,aAAa,iCAAiC,wCAAwC,KAAK,QAAQ,EAAE,QAAY;AAChJ,uCAAuC,aAAa,uCAAuC,wCAAwC,oBAAoB,EAAE,EAAE,QAAY,yEAAyE,QAAY;AACrP,6BAA6B,aAAa,uCAAuC,wHAAwH,EAAE,QAAY;AACvN,kBAAkB,aAAa,4BAA4B,yBAAyB,KAAK,gBAAgB,KAAK,QAAQ,EAAE,QAAY;AACpI,+BAA+B,aAAa,+BAA+B,mDAAmD,EAAE,QAAY;AAC5I,mCAAmC,aAAa,mCAAmC,yDAAyD,EAAE,QAAY;AAC1J,+BAA+B,aAAa,+BAA+B,6CAA6C,EAAE,QAAY;AACtI,gCAAgC,aAAa,gCAAgC,yDAAyD,EAAE,QAAY;AACpJ,mBAAmB,aAAa,6BAA6B,OAAO,gBAAgB,SAAS,gBAAgB,MAAM,gBAAgB,EAAE,EAAE,QAAY;AACnJ,4BAA4B,aAAa,4BAA4B,8CAA8C,EAAE,QAAY;AACjI,wBAAwB,aAAa,wBAAwB,8BAA8B,KAAK,sCAAsC,EAAE,QAAY;AACpJ,8BAA8B,aAAa,8BAA8B,8CAA8C,EAAE,QAAY;AACrI,0BAA0B,aAAa,0BAA0B,8BAA8B,KAAK,sCAAsC,EAAE,QAAY;AACxJ,2BAA2B,aAAa,2BAA2B,8CAA8C,EAAE,QAAY;AAC/H,uBAAuB,aAAa,uBAAuB,8BAA8B,KAAK,sCAAsC,EAAE,QAAY;AAClJ,2BAA2B,aAAa,2BAA2B,OAAO,KAAK,kEAAkE,EAAE,QAAY;AAC/J,uBAAuB,aAAa,uBAAuB,8BAA8B,KAAK,sCAAsC,EAAE,QAAY;AAClJ,kCAAkC,aAAa,kCAAkC,8BAA8B,KAAK,mCAAmC,EAAE,QAAY;AACrK,mCAAmC,aAAa,mCAAmC,OAAO,KAAK,0BAA0B,KAAK,6BAA6B,EAAE,QAAY;AACzK,yBAAyB,aAAa,yCAAyC,WAAW,KAAK,KAAK,IAAI,gCAAgC,KAAK,KAAK,IAAI,6BAA6B,KAAK,KAAK,IAAI,mBAAmB,EAAE,QAAY;AAClO,2BAA2B,aAAa,2CAA2C,WAAW,KAAK,KAAK,IAAI,gCAAgC,KAAK,KAAK,IAAI,6BAA6B,KAAK,KAAK,IAAI,mBAAmB,EAAE,QAAY;AACtO,wBAAwB,aAAa,wCAAwC,WAAW,KAAK,KAAK,IAAI,gCAAgC,KAAK,KAAK,IAAI,6BAA6B,KAAK,KAAK,IAAI,mBAAmB,EAAE,QAAY;AACvO;AACA,0BAA0B;AAC1B,oCAAoC,gBAAgB;AACpD;AACA,2GAA2G,sCAAsC,EAAE;AACnJ;AACA,oCAAoC,gBAAgB;AACpD;AACA,gFAAgF,2BAA2B,EAAE;AAC7G;AACA;AACA;AACA,mDAAmD,kCAAkC,EAAE;AACvF;AACA;AACA;AACA,2DAA2D,0CAA0C,EAAE;AACvG;AACA;AACA;AACA,2DAA2D,6FAA6F,EAAE;AAC1J;AACA;AACA;AACA,2CAA2C,sCAAsC,EAAE;AACnF;AACA,CAAC;;;ACpED;AACA;AACA;AACA;AACA,IAAI,mBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC0B;AACqC;AACM;AACV;AAC4C;AACT;AAC/F,IAAI,8BAAkB;AACtB,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA,6CAA6C,QAAQ;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4GAA4G,QAAQ;AACpH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,2BAAgB;AACnD;AACA;AACA,sJAAsJ,kDAAkD;AACxM;AACA,qDAAqD,oCAAoC;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,kBAAkB;AACU;AAC9B;AACA,0BAA0B;AAC1B,qCAAqC,iBAAiB;AACtD;AACA,yDAAyD,4BAA4B,EAAE;AACvF;AACA,0CAA0C,sBAAsB;AAChE;AACA,yEAAyE,iCAAiC,EAAE;AAC5G;AACA,CAAC;;;AC1JD;AACA;AACA;AACA;AACA,IAAI,cAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2E;AAC1B;AAClD,IAAI,aAAM;AACV,IAAI,cAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,iBAAiB;AACvC;AACA;AACA;AACA;AACA,6CAA6C,iBAAiB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AACQ;;;ACjFlB;AACA;AACA;AACA;AACA,IAAI,+BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACoE;AACrE;AACA,IAAI,+BAAS;AACb;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,uCAAmB;AACc;AACnC,SAAS,4BAAI;AACb,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACO,8BAA8B,4BAAI,mBAAmB,2CAA2C,EAAE;;;ACzCzG;AACA;AACA;AACA;AACA,IAAI,kBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACwD;AACoB;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA,CAAC;AACyC;AAC1C,IAAI,2BAAgB;AACpB,IAAI,kBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA,mDAAmD,SAAS;AAC5D;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,UAAU;AACgB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA;AACA;AACA,QAAQ,iBAAwB;AAChC;AACA;;;ACrPA;AACA;AACA;AACA;AACA,IAAI,uBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC8B;AAC6B;AACa;AACZ;AACF;AACA;AACK;AACc;AACb;AACY;AACtB;AACsC;AACpC;AACN;AACQ;AACG;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,8BAA8B,UAAkB,IAAI,SAAiB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,+BAAe;AACnB,IAAI,uBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,mBAAS;AAC1C;AACA,yBAAyB,iBAAiB;AAC1C,QAAQ,yBAAgB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,iBAAiB;AAC/C;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,+HAA+H,6BAAkB;AACjJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAiB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,2DAA2D,WAAW;AACtE;AACA;AACA;AACA,aAAa;AACb;AACA,oBAAoB,MAAc;AAClC;AACA,2BAA2B,2BAAa;AACxC;AACA;AACA;AACA;AACA;AACA,wBAAwB,+BAAoB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,2BAAa;AACxD;AACA;AACA;AACA,2BAA2B,2BAAa;AACxC;AACA,uBAAuB,uCAAyB;AAChD,aAAa;AACb;AACA;AACA;AACA;AACA,mDAAmD,2BAAa;AAChE;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,wDAAwD,2BAAsC,KAAK,WAAK;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,gBAAgB,UAAkB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,wDAAwD,qBAAgC;AACxF,SAAS;AACT;AACA,wDAAwD,qBAAgC;AACxF,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,uBAAuB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,eAAuB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,2BAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,2BAAa;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE,aAAM;AAC/E;AACA;AACA;AACA,6EAA6E,8BAAkB;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AACiB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,SAAiB;AACzB,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC1cA;AACA;AACA;AACA;AACwC;AACxC,yBAAyB,2BAAO,uBAAuB,2BAAO;AAC9D,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,uBAAuB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2BAAO;AAC7C;AACA;AACA,CAAC;AACoB;;;AC3BrB;AACA;AACA;AACA;AACmE;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,QAAQ;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;AC3KrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,4BAA4B;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,aAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,aAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,uCAAuC;AACvC,yCAAyC;AACzC,8BAA8B;AAC9B,oCAAoC;AACpC,yDAAyD;AACzD,uCAAuC;AACvC,sDAAsD;AACtD;AACA,4BAA4B,0BAA0B;AACtD;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,uCAAuC;AACvC,uCAAuC;AACvC,qCAAqC;AACrC,iDAAiD,UAAU;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC1JA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACjB;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,uBAAuB;AACvB,qBAAqB;AACrB;AACA;AACA;AACA;AACA,oBAAoB;AACpB,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;;;ACz9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mBAAQ;AACnC,mBAAmB,kBAAO;AAC1B;AACA;AACA,+BAA+B,mBAAQ;AACvC;AACA;AACA;AACA;AACA;AACA,4BAA4B,mBAAQ;AACpC,mBAAmB,mBAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,mBAAQ;AAClC;AACA;AACA;AACA,+BAA+B,mBAAQ;AACvC;AACA;AACA;AACA;AACA;AACA,4BAA4B,mBAAQ;AACpC,mBAAmB,mBAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;AACb,IAAI,mBAAQ;AACnB,mBAAQ,UAAU,mBAAQ;AAC1B,mBAAQ,QAAQ,mBAAQ;AACxB,mBAAQ,SAAS,mBAAQ;AACzB,mBAAQ;AACD,SAAS,kBAAO;AACvB,yBAAyB,mBAAQ;AACjC;AACA;AACA;AACA;AACO;AACP,0BAA0B,mBAAQ;AAClC;AACA;AACA;AACA;AACO;AACP,iBAAiB,mBAAQ;AACzB;AACA;AACA;AACA;AACO;AACP,iBAAiB,mBAAQ;AACzB;AACA;AACA;AACA;AACO,SAAS,wBAAa;AAC7B,IAAI,mBAAQ,UAAU,mBAAQ;AAC9B;AACO,SAAS,qBAAU;AAC1B;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAQ;AAC3B;AACA;AACA;AACA,qBAAqB,mBAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,sBAAW;AAC3B;AACA;AACA,oBAAoB,mBAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,mBAAmB,mBAAQ;AAC3B;AACA;AACA;AACA,yBAAyB,mBAAQ;AACjC;AACA;AACA;AACA;AACA,YAAY,kBAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,wBAAa;AACrB,2BAA2B,mBAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAQ;AAC/B;AACA;AACA,wBAAwB,mBAAQ;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,wBAAa;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,qBAAU;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,sBAAW;AAC/B;AACA;AACA;AACA;AACA;AACA,gBAAgB,qBAAU;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,sBAAW;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,qBAAU;AAC9B;AACA;AACA;AACA;AACA;AACA,gBAAgB,sBAAW;AAC3B;AACA;AACA;AACA;AACA;AACA,IAAI,wBAAa;AACjB;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,qBAAU;AAC9B;AACA;AACA;AACA,gBAAgB,sBAAW;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,sBAAW;AAC/B;AACA;AACA;AACA,gBAAgB,qBAAU;AAC1B;AACA;AACA;AACA;AACA;AACO;AACP;AACA,oCAAoC,mBAAQ;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3WA;AACA;AACA;AACA;AAC2D;AACwB;AACpC;AACN;AACD;AACxC;AACA,IAAI,4BAAY;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,YAAoB;AACxC;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,uBAAuB;AAClF;AACA;AACA,CAAC;AACuB;AACjB;AACP;AACA;AACA;AACA,8CAA8C,SAAS;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACf;AACP;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA,8CAA8C,aAAa;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,+BAAe;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,wEAAwE;AACtI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,SAAS,KAAK,WAAK;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,WAAK;AAC/D;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,QAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA,6CAA6C,WAAK;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,QAAQ;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,WAAK;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,WAAK;AACnE;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,QAAQ;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,WAAK;AAClD;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC;AACmB;;;ACtcpB;AACA;AACA;AACA;AACkD;AACN;AACD;AACuE;AAClC;AAChF;AACO;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACf;AACP,8BAA8B,iBAAiB;AAC/C;AACA,qCAAqC,SAAS;AAC9C;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,qCAAqC,SAAS;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,gBAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,2BAAa;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC,oBAAoB,mBAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA,8CAA8C,qBAAqB,GAAG,iIAAiI;AACvM;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA,qBAAqB,mBAAQ;AAC7B,2BAA2B,mBAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,QAAQ;AACvC;AACA,2BAA2B,QAAQ;AACnC;AACA;AACA;AACA;AACA,gCAAgC,mBAAQ;AACxC;AACA;AACA;AACA,+BAA+B,QAAQ;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,eAAe,KAAK,WAAK;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,2BAA2B,QAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,YAAY;AACnD,8CAA8C,SAAS,KAAK,WAAK;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,eAAe,KAAK,WAAK;AAC/D;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,uCAAuC,uBAAuB;AAC9D;AACA;AACA;AACA,0BAA0B,mBAAQ;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sBAAsB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mBAAmB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mBAAQ;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA,oBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,UAAU,mBAAQ,qBAAqB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA,YAAY,kBAAkB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,QAAQ;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF,qBAAqB,GAAG,kGAAkG;AAC7M;AACA;AACA;AACA,+EAA+E,qBAAqB,GAAG,6FAA6F;AACpM;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA,2BAA2B,uBAAuB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,uBAAuB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,mBAAQ;AACjC,+BAA+B,mBAAQ;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAQ;AAC7B,2BAA2B,mBAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mBAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mBAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,QAAQ;AAC5B;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAQ;AAC7B,4BAA4B,mBAAQ;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,QAAQ;AAC5B,iBAAiB,mBAAQ;AACzB,kBAAkB,mBAAQ;AAC1B,mBAAmB,mBAAQ;AAC3B;AACA;AACA;AACA,kBAAkB,mBAAQ;AAC1B;AACA;AACA;AACA,gCAAgC,mBAAQ;AACxC;AACA;AACA;AACA;AACA,2BAA2B,kBAAO;AAClC;AACA;AACA;AACA,QAAQ,SAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,QAAQ;AAC5B,iBAAiB,mBAAQ;AACzB,kBAAkB,mBAAQ;AAC1B,mBAAmB,mBAAQ;AAC3B;AACA;AACA,0BAA0B,mBAAQ;AAClC;AACA;AACA;AACA,+BAA+B,mBAAQ;AACvC;AACA;AACA;AACA;AACA,2BAA2B,SAAS,YAAY;AAChD;AACA;AACA;AACA,QAAQ,SAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC;AACwB;;;ACzzCzB;AACA;AACA;AACA;AAC8D;AAClB;AACM;AACC;AACnD,IAAI,uCAAmB;AACvB;AACA;AACA;AACA;AACA,8BAA8B,2BAAa;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA,6BAA6B,2BAA2B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,2BAA2B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8BAA8B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,mBAAmB;AACrD;AACA;AACA,6CAA6C,oBAAoB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,WAAW;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA,mEAAmE,0CAA0C;AAC7G;AACA;AACA;AACA,4BAA4B,+BAA+B;AAC3D;AACA;AACA;AACA,0DAA0D,yDAAyD;AACnH;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,kCAAkC,EAAE;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,oCAAoC,EAAE;AACxG;AACA,yEAAyE,SAAS;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA+E,+BAA+B;AAC9G;AACA;AACA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2JAA2J,WAAK;AAChK,gDAAgD,SAAS;AACzD;AACA;AACA;AACA,oDAAoD,oCAAoC;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,UAAU;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,wBAAwB;AACzE;AACA;AACA;AACA;AACA,yCAAyC,WAAK;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,WAAK;AAC3C;AACA;AACA;AACA,sCAAsC,WAAK;AAC3C;AACA;AACA;AACA;AACA,kCAAkC,WAAK;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,WAAK;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,WAAK;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;;;ACpY/B;AACA;AACA;AACA;AAC8D;AAC4B;AAC3B;AAC/D,IAAI,qDAA0B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA,mCAAmC,oBAAoB;AACvD,gCAAgC,YAAY;AAC5C;AACA;AACA,mBAAmB,uCAAmB;AACtC;AACA;AACA,CAAC;AACqC;AACtC,IAAI,qDAA0B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAyB;AACzC,2BAA2B,kBAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,gBAAgB;AACzC,6BAA6B,YAAY;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mBAAmB;AAClD;AACA;AACA;AACA,sCAAsC,qBAAqB;AAC3D;AACA,mBAAmB,qDAA0B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,oBAAoB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqC;;;ACvItC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,SAAS;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0C;;;AC/H3C;AACA;AACA;AACA;AACyD;AACU;AAChB;AACJ;AACM;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,+BAAe;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,qBAAU;AACvC;AACA;AACA;AACA;AACA;AACA,wCAAwC,iBAAiB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,0BAA0B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,qBAAU;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,0BAA0B;AACvE;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,gCAAgB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA,sCAAsC,+BAAe;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAU;AACjC;AACA;AACA;AACA;AACA,mBAAmB,qBAAU;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,+BAAe;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,qBAAU;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,+BAAe;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,QAAQ;AAC7C;AACA;AACA;AACA,mCAAmC,QAAQ;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,QAAQ;AAC1C,4BAA4B,+BAAe;AAC3C;AACA,uBAAuB,WAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,2BAA2B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA,oBAAoB,aAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyC;;;ACla1C;AACA;AACA;AACA;AACA,IAAI,iBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACkE;AACX;AACO;AACD;AACH;AACT;AACiB;AACpB;AACN;AACQ;AACZ;AACM;AACgB;AAC+C;AACT;AACwG;AACpI;AACmB;AACxC;AACG;AACuC;AAC1B;AACH;AACS;AACtE;AACA;AACA,eAAe,qDAA0B;AACzC;AACO;AACP;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,0BAAgB;AACb;AACP,+BAA+B,4CAA4C;AAC3E,IAAI,mBAAS;AACb,IAAI,iBAAS;AACb;AACA;AACA,4CAA4C,2BAA2B;AACvE;AACA;AACA,mDAAmD,aAAO;AAC1D;AACA,4DAA4D,qCAA2B;AACvF;AACA,yDAAyD,aAAO;AAChE;AACA,sEAAsE,aAAO;AAC7E;AACA,uDAAuD,aAAO;AAC9D;AACA,wDAAwD,aAAO;AAC/D;AACA,kDAAkD,iCAAuB;AACzE;AACA;AACA;AACA;AACA;AACA,wCAAwC,OAAG;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE,WAAK;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,wBAAwB;AAClF,sCAAsC,oBAAoB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA,0CAA0C,6BAA6B;AACvE;AACA,+DAA+D;AAC/D;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,qCAAqC,0BAAgB;AACrD,oCAAoC,mBAAS;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,8CAA8C;AAC/E,4CAA4C,2BAA2B;AACvE,6BAA6B,YAAY;AACzC;AACA;AACA;AACA;AACA,qCAAqC,gBAAgB;AACrD,uBAAuB,wBAA8B;AACrD;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,mBAAmB,wBAA8B;AACjD;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,0DAA0D,2CAA2C,EAAE;AACvG;AACA;AACA,0DAA0D,2CAA2C,EAAE;AACvG;AACA;AACA,0DAA0D,wCAAwC,EAAE;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,+BAA+B;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,0BAAgB;AACpD;AACA,mCAAmC,mBAAS;AAC5C;AACA,0CAA0C,2BAA2B;AACrE,gBAAgB,aAAa;AAC7B,2EAA2E,WAAK;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,2BAA2B;AACrE,gBAAgB,kBAAkB;AAClC,2EAA2E,WAAK;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,eAAe;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,oBAAoB;AAClC,2BAA2B,gCAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,yBAAyB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,wBAA8B;AACxD;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,gBAAgB;AACjD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,aAAa;AACxC;AACA;AACA;AACA,uBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA;AACA,sCAAsC,+BAA+B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,aAAa;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,2BAA2B;AACxD;AACA;AACA;AACA;AACA,6BAA6B,2BAA2B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,WAAK;AACrC,kCAAkC,mBAAS;AAC3C;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,eAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,eAAuB;AACvC,2BAA2B,QAAQ;AACnC;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA,gCAAgC,QAAQ;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,eAAuB;AAClE,yCAAyC,eAAuB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,WAAK,yBAAyB,mBAAS;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,eAAuB;AAC9D,qCAAqC,eAAuB;AAC5D;AACA,uBAAuB,WAAK;AAC5B;AACA;AACA;AACA,uBAAuB,WAAK;AAC5B;AACA;AACA;AACA,uBAAuB,WAAK;AAC5B;AACA;AACA;AACA,uBAAuB,WAAK;AAC5B;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA,0CAA0C,oBAAoB,0BAAgB,CAAC;AAC/E;AACA;AACA,YAAY,WAAK;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4BAAY;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,+BAAe,uBAAuB,4BAAY;AACjE;AACA;AACA;AACA;AACA;AACA,mCAAmC,4BAAY;AAC/C;AACA;AACA;AACA;AACA;AACA,kCAAkC,WAAK;AACvC;AACA,YAAY,+BAAe,yBAAyB,4BAAY;AAChE;AACA;AACA;AACA,8BAA8B,WAAK;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,+BAAe,yBAAyB,4BAAY;AACnE;AACA;AACA;AACA;AACA,eAAe,+BAAe,6BAA6B,4BAAY;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA,4DAA4D,UAAU;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2EAA2E,SAAS;AACpF;AACA;AACA;AACA,gEAAgE,UAAU;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,WAAK;AAC5C;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,SAAS;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,SAAS;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,gCAAgB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,QAAQ;AACrD;AACA;AACA,+CAA+C,mBAAmB;AAClE;AACA;AACA;AACA;AACA,+CAA+C,oBAAoB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,WAAW;AAChD;AACA;AACA;AACA,+CAA+C,qBAAqB;AACpE;AACA;AACA;AACA;AACA,8CAA8C,2BAA2B;AACzE;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,aAAa;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,iCAAiC;AACnG,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,aAAa;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,iEAAiE;AACxH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,aAAa;AAC9C,6CAA6C,6BAA6B;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,aAAa;AAC9C,6CAA6C,6BAA6B;AAC1E;AACA;AACA;AACA;AACA,+CAA+C,WAAK;AACpD;AACA;AACA,iCAAiC,aAAa;AAC9C,6CAA6C,6BAA6B;AAC1E;AACA;AACA;AACA;AACA,iCAAiC,aAAa;AAC9C,6CAA6C,6BAA6B;AAC1E;AACA;AACA;AACA;AACA;AACA,iCAAiC,aAAa;AAC9C,6CAA6C,6BAA6B;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D,+BAA+B,YAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,8BAA8B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,UAAU;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,sBAAsB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,8BAA8B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,SAAS;AACT;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA,wCAAwC,2CAA2C;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,4CAA4C;AAClF;AACA,+BAA+B,8BAA8B;AAC7D,iBAAiB,mBAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,aAAa,kBAAkB,6BAA6B;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,aAAa,kBAAkB,6BAA6B;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,sDAAsD;AACtF;AACA;AACA;AACA;AACA,oEAAoE,8DAA8D;AAClI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,6BAA6B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,6BAA6B;AAC/D;AACA,oCAAoC,qBAAqB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8BAAa;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,6BAA6B;AAChE;AACA,qCAAqC,qBAAqB;AAC1D;AACA;AACA,mCAAmC,8BAAa;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,iBAAiB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,iBAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,qBAAqB;AAC5E;AACA,gCAAgC,8BAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF,yBAAyB;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,yBAAyB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,qBAAqB;AAC5E;AACA,gCAAgC,8BAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF,yBAAyB;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,yBAAyB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,6BAA6B;AAChE;AACA,qCAAqC,qBAAqB;AAC1D,4BAA4B,8BAAa;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA,0CAA0C;AAC1C;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,gBAAgB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,uBAAuB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,gBAAgB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,uBAAuB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,gBAAgB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA,uCAAuC;AACvC;AACA,uCAAuC;AACvC;AACA,8CAA8C,6BAA6B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,gBAAgB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,uBAAuB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD,2DAA2D;AAC3D,2DAA2D;AAC3D;AACA;AACA,iBAAiB,qBAAqB;AACtC,sBAAsB,qBAAqB;AAC3C;AACA;AACA,4BAA4B,qBAAqB;AACjD,gCAAgC,qBAAqB;AACrD;AACA;AACA,CAAC,CAAC,UAAU;AACS;AACrB;AACA,IAAI,0BAAgB;AACpB;AACA,qCAAqC,YAAY;AACjD,qCAAqC,YAAY;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,wBAAwB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,wBAAwB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,wBAAwB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,IAAI,6CAAmC;AACvC;AACA,sCAAsC,aAAa;AACnD,8CAA8C,aAAa;AAC3D,mFAAmF,uBAAuB;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,aAAa;AAChC;AACA;AACA;AACA;AACA,CAAC;AAC8C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,6CAAmC;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC,iEAAiE;AACjE;AACA;AACA;AACA;AACA,qCAAqC,mDAAmD;AACxF,qCAAqC,kDAAkD;AACvF,qCAAqC,gDAAgD;AACrF,qCAAqC,+CAA+C;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,qCAA2B;AAC/B,IAAI,iBAAS;AACb;AACA;AACA,4CAA4C,aAAO;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AAC2B;AACvC;AACA,IAAI,iCAAuB;AAC3B,IAAI,iBAAS;AACb;AACA;AACA;AACA;AACA;AACA,iDAAiD,aAAO;AACxD;AACA,iDAAiD,aAAO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACuB;;;AC7yEnC;AACA;AACA;AACA;AACmE;AACR;AACZ;AACN;AACQ;AACC;AACwC;AAC1F,oCAAoC,aAAa;AACjD,mCAAmC,cAAc;AACjD,gDAAgD,sCAAsC;AACtF,IAAI,gCAAmB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B;AAC7D;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,eAAe,mBAAS;AACxB;AACA;AACA;AACA,mBAAmB,6BAA6B;AAChD;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA,mBAAmB,6BAA6B;AAChD;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,6BAA6B;AACpE,iCAAiC,+CAA+C;AAChF;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA,mBAAmB,6BAA6B;AAChD;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA,IAAI,8BAAiB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6GAA6G,QAAQ;AACrH;AACA;AACA;AACA,6CAA6C,WAAK,sEAAsE,QAAQ;AAChI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAS;AAC5B;AACA;AACA,CAAC;AAC4B;AAC7B,IAAI,0BAAa;AACjB;AACA;AACA;AACA,0BAA0B,gCAAmB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0FAA0F,QAAQ;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC,IAAI,wBAAW;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8BAAiB,KAAK,WAAK,yGAAyG,QAAQ;AACzK;AACA;AACA;AACA;AACA,qDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA,IAAI,0BAAa;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,cAAsB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAuB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA,qBAAqB,oBAA4B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA,qBAAqB,oBAA4B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;AAClB;AACP;AACA;;;ACpZA;AACA;AACA;AACA;AACqE;AACtB;AACN;AACzC,IAAI,qCAAe;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,kBAAkB,qBAAqB,gBAAgB;AACpG,uBAAuB,eAAe;AACtC;AACA,8BAA8B,0BAAa;AAC3C,4BAA4B,0BAAa;AACzC,qCAAqC,0BAAa,6CAA6C,QAAQ;AACvG,mCAAmC,0BAAa,6CAA6C,QAAQ;AACrG,0CAA0C,WAAW,wBAAwB,mBAAmB,sBAAsB,iBAAiB;AACvI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8BAAiB,KAAK,WAAK,2DAA2D,QAAQ;AAC1H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,QAAQ;AAC3C,oCAAoC,0BAAa;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,iCAAiC;AACjF;AACA,0CAA0C,0BAAa,6CAA6C,QAAQ;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;AC5F3B;AACA;AACA;AACA;AACiD;AACjD,IAAI,6BAAc;AAClB;AACA,+CAA+C,+BAA+B;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAS;AAC5B;AACA;AACA,CAAC;AACyB;AAC1B,IAAI,oDAAqC;AACzC;AACA,+CAA+C,+BAA+B;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAS;AAC5B;AACA;AACA,CAAC;AACgD;AACjD,IAAI,kDAAmC;AACvC;AACA,+CAA+C,+BAA+B;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAS;AAC5B;AACA;AACA,CAAC;AAC8C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+C;;;AC5EhD;AACA;AACA;AACA;AACqE;AACtB;AACN;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B,IAAI,mCAAc;AAClB;AACA;AACA;AACA;AACA,gBAAgB,0BAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,0BAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAAa;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,0BAAa;AACjC;AACA;AACA;AACA;AACA;AACA,qBAAqB,0BAAa;AAClC,gBAAgB,0BAAa;AAC7B;AACA;AACA;AACA,wDAAwD,0BAAa;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,8BAAiB,KAAK,WAAK,iJAAiJ,QAAQ;AACvM;AACA;AACA,mCAAmC,0BAAa;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,0BAAa;AACjC;AACA;AACA;AACA;AACA;AACA,qBAAqB,0BAAa;AAClC,gBAAgB,0BAAa;AAC7B;AACA;AACA;AACA,wDAAwD,0BAAa;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,8BAAiB,KAAK,WAAK,iJAAiJ,QAAQ;AACvM;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;ACrM1B;AACA;AACA;AACA;AAC2D;AACI;AACiB;AACrB;AAClB;AACzC,IAAI,uCAAgB;AACpB;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA,sCAAsC,mCAAc;AACpD,sCAAsC,WAAK;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,6BAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA,sCAAsC,WAAK;AAC3C,8BAA8B,6BAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,+BAA+B;AACjF;AACA;AACA;AACA;AACA,gDAAgD,0BAAa;AAC7D,8CAA8C,0BAAa;AAC3D,uCAAuC,0BAAa;AACpD,8CAA8C,WAAK;AACnD;AACA;AACA,8CAA8C,WAAK;AACnD;AACA;AACA;AACA,yCAAyC,mCAAc;AACvD,0CAA0C,WAAK;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,6BAAc;AAC5C;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,WAAK;AACnD;AACA,0CAA0C,6BAAc;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,6BAAc;AAChD;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC;AAC2B;;;AC/K5B;AACA;AACA;AACA;AACA,IAAI,4BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC0D;AACL;AACiB;AACxB;AACN;AACzC,IAAI,mCAAc;AAClB;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,cAAc;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,eAAe;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,eAAe;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,cAAc;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+FAA+F,QAAQ;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,QAAQ;AACvC;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mGAAmG,QAAQ;AAC3G;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA,+FAA+F,QAAQ;AACvG;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA,yCAAyC,QAAQ;AACjD;AACA;AACA,8CAA8C,YAAY;AAC1D;AACA;AACA;AACA;AACA,2BAA2B,QAAQ;AACnC;AACA,gBAAgB,kBAA0B,UAAU,kBAA0B;AAC9E;AACA,2BAA2B,QAAQ;AACnC;AACA,gBAAgB,kBAA0B,UAAU,kBAA0B;AAC9E;AACA;AACA;AACA,wBAAwB,kBAA0B;AAClD,mCAAmC,QAAQ;AAC3C;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2FAA2F,QAAQ;AACnG;AACA;AACA;AACA;AACA,mGAAmG,QAAQ;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+FAA+F,QAAQ;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA,4DAA4D,QAAQ;AACpE;AACA;AACA,8CAA8C,oBAAoB;AAClE;AACA;AACA;AACA;AACA,2BAA2B,QAAQ;AACnC;AACA,gBAAgB,kBAA0B,UAAU,kBAA0B;AAC9E;AACA,2BAA2B,QAAQ;AACnC;AACA,gBAAgB,kBAA0B,UAAU,kBAA0B;AAC9E;AACA;AACA;AACA,wBAAwB,kBAA0B;AAClD,mCAAmC,QAAQ;AAC3C;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA,gCAAgC,8BAA8B;AAC9D;AACA,uBAAuB,WAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,QAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mGAAmG,QAAQ;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA,sCAAsC,eAAe;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,QAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mGAAmG,QAAQ;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+FAA+F,QAAQ;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mGAAmG,QAAQ;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA,6BAA6B,uBAAuB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAAiB,KAAK,WAAK,+EAA+E,QAAQ;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,QAAQ;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,QAAQ;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B,IAAI,uCAAkB;AACtB,IAAI,4BAAS;AACb;AACA;AACA;AACA;AACA;AACA,YAAY,mCAAc;AAC1B,YAAY,mCAAc;AAC1B,YAAY,mCAAc;AAC1B;AACA,wBAAwB,WAAK;AAC7B;AACA;AACA;AACA;AACA,YAAY,mCAAc;AAC1B,YAAY,mCAAc;AAC1B,YAAY,mCAAc;AAC1B;AACA,wBAAwB,WAAK;AAC7B;AACA;AACA;AACA;AACA,YAAY,mCAAc;AAC1B,YAAY,mCAAc;AAC1B,YAAY,mCAAc;AAC1B;AACA,wBAAwB,QAAQ;AAChC;AACA;AACA;AACA;AACA,YAAY,mCAAc;AAC1B,YAAY,mCAAc;AAC1B,YAAY,mCAAc;AAC1B;AACA,wBAAwB,QAAQ;AAChC;AACA;AACA;AACA,CAAC,CAAC,mCAAc;AACc;AAC9B;AACA,qCAAqC,oBAAoB,EAAE;AAC3D;;;ACjiBA;AACA;AACA;AACA;AACuD;AACY;AACR;AACA;AACZ;AACN;AACzC,IAAI,qCAAkB;AACtB;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA,sCAAsC,wBAAW;AACjD;AACA,sCAAsC,wBAAW,gBAAgB,mCAAc;AAC/E;AACA;AACA,sCAAsC,wBAAW,eAAe,mCAAc;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA,sCAAsC,wBAAW;AACjD;AACA,sCAAsC,wBAAW,gBAAgB,mCAAc;AAC/E;AACA;AACA,sCAAsC,wBAAW,eAAe,mCAAc;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,wBAAW,eAAe,mCAAc;AACvD;AACA;AACA,eAAe,wBAAW,gBAAgB,mCAAc;AACxD;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,wBAAW,eAAe,mCAAc;AACvD;AACA;AACA,eAAe,wBAAW,gBAAgB,mCAAc;AACxD;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,wBAAW,mBAAmB,8BAAiB,KAAK,WAAK,iDAAiD,QAAQ;AAC1I;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA,wBAAwB,wBAAW,gBAAgB,mCAAc;AACjE;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA,wBAAwB,wBAAW,gBAAgB,mCAAc;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,wBAAW,oBAAoB,8BAAiB,KAAK,WAAK,qBAAqB,QAAQ;AACtG;AACA;AACA;AACA;AACA,+CAA+C,QAAQ;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,wBAAW,oBAAoB,8BAAiB,KAAK,WAAK,qEAAqE,QAAQ;AAC1J;AACA;AACA;AACA;AACA,mBAAmB,wBAAW;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,wBAAW;AAC9B;AACA;AACA;AACA,mBAAmB,wBAAW;AAC9B;AACA;AACA;AACA;AACA,eAAe,wBAAW,gBAAgB,mCAAc;AACxD;AACA;AACA;AACA,uBAAuB,wBAAW;AAClC;AACA;AACA;AACA,eAAe,wBAAW,mBAAmB,8BAAiB,KAAK,WAAK,iDAAiD,QAAQ;AACjI;AACA;AACA;AACA;AACA,+CAA+C,QAAQ;AACvD;AACA,eAAe,wBAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA,+BAA+B,mCAAc;AAC7C;AACA;AACA;AACA;AACA;AACA,mCAAmC,mCAAc;AACjD;AACA;AACA,wBAAwB,wBAAW;AACnC;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA,wBAAwB,wBAAW,eAAe,mCAAc;AAChE;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA,+BAA+B,mCAAc;AAC7C;AACA;AACA;AACA;AACA;AACA,mCAAmC,mCAAc;AACjD;AACA;AACA,wBAAwB,wBAAW;AACnC;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA,wBAAwB,wBAAW,eAAe,mCAAc;AAChE;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA,wBAAwB,wBAAW,eAAe,mCAAc;AAChE;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA,wBAAwB,wBAAW,gBAAgB,mCAAc;AACjE;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA,wBAAwB,wBAAW,eAAe,mCAAc;AAChE;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA,wBAAwB,wBAAW,gBAAgB,mCAAc;AACjE;AACA;AACA;AACA;AACA,eAAe,wBAAW;AAC1B;AACA;AACA,eAAe,wBAAW;AAC1B;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AACvB,IAAI,6BAAU;AACrB;AACA;AACA,aAAa,QAAc;AAC3B;AACA;AACA;AACA,aAAa,QAAc;AAC3B;AACA;AACA,aAAa,WAAiB,2BAA2B,SAAe;AACxE;AACA;AACA,aAAa,WAAiB,uBAAuB,QAAc;AACnE;AACA;AACA,aAAa,WAAiB,0BAA0B,QAAc;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,6BAAU,KAAK,6BAAU,KAAK;;;ACjmBjC;AACA;AACA;AACA;AAC2D;AACG;AACrB;AACQ;AACyC;AAC1F,IAAI,yBAAY;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,0BAAa;AACrD,6BAA6B,0BAAa;AAC1C;AACA;AACA;AACA;AACA;AACA,wCAAwC,0BAAa;AACrD,6BAA6B,0BAAa;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,uBAAuB;AACnE;AACA;AACA,0CAA0C,+BAA+B;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,0BAAa;AACjE;AACA;AACA;AACA;AACA,8CAA8C,6BAA6B;AAC3E;AACA;AACA;AACA,yFAAyF,mCAAmC;AAC5H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,iBAAiB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,yBAAyB;AACrE;AACA;AACA,oDAAoD,WAAK;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,uBAAuB;AACnE;AACA,0CAA0C,+BAA+B;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,yBAAyB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,WAAK;AAC7D;AACA;AACA,wDAAwD,WAAK;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAS;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mBAAS;AACpC;AACA,uBAAuB,mBAAS;AAChC;AACA;AACA;AACA;AACA,CAAC;AACuB;;;ACjMxB;AACA;AACA;AACA;AACyC;AACQ;AACjD,IAAI,iDAAwB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,WAAK;AACjD,4CAA4C,WAAK;AACjD;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAS;AAC5B;AACA;AACA,CAAC;AACmC;;;ACxBpC;AACA;AACA;AACA;AACmE;AACR;AACgF;AAChF;AACwB;AACH;AACT;AAC9B;AACwB;AACyB;AAC1F,IAAI,mCAAc;AAClB;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD,8BAA8B,yBAAY;AAC1C;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD,8BAA8B,yBAAY;AAC1C;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,iCAAiC,yBAAY;AAC7C;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,yBAAY;AAC7C;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD,8BAA8B,6BAAc;AAC5C;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,WAAK;AAC7C,kCAAkC,6BAAc;AAChD;AACA;AACA,kCAAkC,6BAAc;AAChD;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,WAAK;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,6BAA6B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,qBAAqB;AACtE;AACA,uCAAuC,8BAA8B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,6BAA6B,2BAA2B,WAAK;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kCAAY;AACvC;AACA;AACA,2BAA2B,kCAAY;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,0BAAa;AACvD;AACA;AACA,2BAA2B,eAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,6BAAc;AACjC;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,UAAkB;AAC3C,0CAA0C,6BAAc,KAAK,WAAK;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,yBAAY;AAC9C;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,WAAK;AACjC,8BAA8B,6BAAc;AAC5C;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,uBAAuB,oDAAqC;AAC5D;AACA;AACA,uBAAuB,6BAAc;AACrC;AACA;AACA;AACA;AACA;AACA,gCAAgC,oBAA4B;AAC5D;AACA;AACA,gBAAgB,6BAA6B;AAC7C;AACA;AACA;AACA,6CAA6C,kCAAY;AACzD;AACA;AACA;AACA,kDAAkD,kCAAY;AAC9D;AACA;AACA;AACA,kDAAkD,kCAAY;AAC9D;AACA;AACA;AACA;AACA;AACA,+BAA+B,oDAAqC;AACpE;AACA;AACA,+BAA+B,kDAAmC;AAClE;AACA;AACA,kDAAkD,kCAAY;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,oBAA4B;AAC5D;AACA;AACA,iBAAiB,6BAA6B;AAC9C;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA,0BAA0B,oBAA4B;AACtD;AACA,mCAAmC,0BAAa;AAChD;AACA;AACA;AACA;AACA,4BAA4B,WAAK;AACjC;AACA;AACA,qCAAqC,+BAA+B;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oDAAqC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kDAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,6BAA6B;AAC9D,gCAAgC,6BAA6B;AAC7D;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,WAAK;AAC5D;AACA;AACA,uDAAuD,WAAK;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,OAAO;AACrC;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA,oCAAoC,WAAK;AACzC,8BAA8B,6BAAc;AAC5C;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,OAAO;AAC/B;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,uBAAuB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,6BAA6B;AACnE;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA,8BAA8B,kDAAmC;AACjE;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,OAAO;AAC7C,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA,4DAA4D,uCAAuC;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA,8BAA8B,iDAAwB;AACtD;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,6BAA6B;AAC1D;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,kDAAmC;AACjE,uBAAuB,mBAAmB;AAC1C;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,oBAA4B;AACvE;AACA;AACA;AACA;AACA;AACA,wCAAwC,WAAK;AAC7C,kCAAkC,6BAAc;AAChD,2BAA2B,mBAAmB;AAC9C;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE;AAClE;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,OAAO;AAC3B,yCAAyC,uBAAuB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,6BAA6B;AACvE;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA,sCAAsC,kDAAmC;AACzE;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mBAAmB;AAC9C;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD,8BAA8B,6BAAc;AAC5C;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,gDAAgD,SAAS;AACzD,8BAA8B,6BAAc;AAC5C;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA,kCAAkC,oDAAqC,KAAK,WAAK;AACjF;AACA;AACA;AACA;AACA,oEAAoE,WAAK;AACzE;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA,gEAAgE,WAAK;AACrE;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;ACvxB1B;AACA;AACA;AACA;AAC+E;AACxE,IAAI,mCAAiB;AAC5B;AACA;AACA;AACA;AACA,4CAA4C,aAAa;AACzD;AACA;AACA;AACA,kCAAkC,aAAa;AAC/C;AACA;AACA;AACA,2CAA2C,aAAa;AACxD,qCAAqC,aAAa;AAClD;AACA,iDAAiD,aAAa;AAC9D;AACA,kDAAkD,aAAa;AAC/D;AACA,0CAA0C,aAAa;AACvD;AACA,+CAA+C,aAAa;AAC5D,oCAAoC,aAAa;AACjD,oCAAoC,aAAa;AACjD;AACA,uCAAuC,aAAa;AACpD,sDAAsD,aAAa;AACnE,mDAAmD,aAAa;AAChE,gDAAgD,aAAa;AAC7D,kDAAkD,aAAa;AAC/D,sDAAsD,aAAa;AACnE,sDAAsD,aAAa;AACnE,6CAA6C,aAAa;AAC1D,yDAAyD,aAAa;AACtE,sDAAsD,aAAa;AACnE,iDAAiD,aAAa;AAC9D,8CAA8C,aAAa;AAC3D,0DAA0D,aAAa;AACvE,mEAAmE,aAAa;AAChF,qDAAqD,aAAa;AAClE,CAAC,EAAE,mCAAiB,KAAK,mCAAiB,KAAK;;;AC9C/C;AACA;AACA;AACA;AACA,IAAI,oBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACsC;AACgB;AACgC;AACjB;AACa;AACb;AACe;AACyB;AAC7B;AACxB;AACN;AACI;AACe;AACD;AACc;AACnF;AACA;AACA,IAAI,oBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA;AACA,CAAC,CAAC,8BAAa;AACc;AACtB,IAAI,0BAAa;AACxB;AACA;AACA,aAAa,QAAc;AAC3B;AACA;AACA;AACA,aAAa,QAAc;AAC3B;AACA;AACA,aAAa,WAAiB,mBAAmB,QAAc;AAC/D;AACA;AACA,aAAa,WAAiB,sBAAsB,QAAc;AAClE;AACA;AACA,aAAa,WAAiB,6BAA6B,SAAe;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,0BAAa,KAAK,0BAAa,KAAK;AAChC,IAAI,wBAAW;AACtB;AACA;AACA,aAAa,QAAc;AAC3B;AACA;AACA;AACA,aAAa,QAAc;AAC3B;AACA;AACA,aAAa,WAAiB,sBAAsB,QAAc;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,wBAAW,KAAK,wBAAW,KAAK;AAC5B,IAAI,mCAAsB;AACjC;AACA;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,qCAAkB;AAClC;AACA;AACA;AACA;AACA,KAAK;AACL,oCAAoC,qBAAqB;AACzD;AACA;AACA;AACA,KAAK;AACL,0CAA0C,qBAAqB;AAC/D;AACA;AACA;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,yGAAyG,QAAQ,wBAAW,0BAA0B,EAAE;AACxJ;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL,0CAA0C,qBAAqB;AAC/D,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE,QAAQ;AACjF;AACA;AACA;AACA;AACA,mBAAmB,qCAAe;AAClC;AACA;AACA,KAAK;AACL,oDAAoD,qBAAqB;AACzE,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA,4BAA4B;AAC5B;AACA,aAAa;AACb;AACA;AACA,mBAAmB,qCAAe;AAClC;AACA;AACA,KAAK;AACL,qDAAqD,qBAAqB;AAC1E,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA,4BAA4B;AAC5B;AACA,aAAa;AACb;AACA;AACA,mBAAmB,qCAAe;AAClC;AACA;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,qCAAe;AAClC;AACA;AACA,KAAK;AACL,kDAAkD,qBAAqB;AACvE;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,oBAAoB;AACpB;AACA,KAAK;AACL,sDAAsD,qBAAqB;AAC3E;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,oBAAoB;AACpB;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,qCAAe;AAClC;AACA;AACA,KAAK;AACL,oDAAoD,qBAAqB;AACzE;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,oBAAoB;AACpB;AACA,KAAK;AACL,wDAAwD,qBAAqB;AAC7E;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,oBAAoB;AACpB;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA,6BAA6B,6BAAW;AACxC,aAAa;AACb;AACA;AACA,yBAAyB,6BAAW;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,qCAAkB;AAC1E;AACA;AACA;AACA,KAAK;AACL;AACA,wCAAwC,qBAAqB;AAC7D;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,wCAAwC,qBAAqB;AAC7D;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL,8CAA8C,qBAAqB;AACnE;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA;AACA,KAAK;AACL,yCAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL,+CAA+C,qBAAqB;AACpE;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA;AACA,KAAK;AACL,sCAAsC,qBAAqB;AAC3D;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL,4CAA4C,qBAAqB;AACjE;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA;AACA,kBAAkB,+CAA+C;AACjE,oBAAoB;AACpB;AACA,KAAK;AACL,0CAA0C,qBAAqB;AAC/D;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA;AACA,KAAK;AACL,gDAAgD,qBAAqB;AACrE;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA;AACA,KAAK;AACL,wCAAwC,qBAAqB;AAC7D;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL,8CAA8C,qBAAqB;AACnE;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA;AACA,kBAAkB,iDAAiD;AACnE,oBAAoB;AACpB;AACA,KAAK;AACL,4CAA4C,qBAAqB;AACjE;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA;AACA,KAAK;AACL,kDAAkD,qBAAqB;AACvE;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA;AACA,KAAK;AACL,0CAA0C,qBAAqB;AAC/D,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,2BAA2B,qCAAkB;AAC7C;AACA;AACA,2BAA2B,qCAAkB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,oDAAoD,qBAAqB;AACzE,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,qCAAkB;AAChE;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,qCAAkB;AAC/E;AACA;AACA;AACA,KAAK;AACL,wCAAwC,qBAAqB;AAC7D;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL,8CAA8C,qBAAqB;AACnE;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL,6CAA6C,qBAAqB;AAClE,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA,0BAA0B;AAC1B;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA,4BAA4B,wBAAW;AACvC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,qCAAkB;AAC/E;AACA;AACA;AACA,KAAK;AACL,uCAAuC,qBAAqB;AAC5D;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL,6CAA6C,qBAAqB;AAClE;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL,2CAA2C,qBAAqB;AAChE,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA,0BAA0B;AAC1B;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA,4BAA4B,wBAAW;AACvC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,qCAAkB;AAC/E;AACA;AACA;AACA,KAAK;AACL,uCAAuC,qBAAqB;AAC5D;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL,6CAA6C,qBAAqB;AAClE;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,qCAAkB;AAC/E;AACA;AACA;AACA,KAAK;AACL,0CAA0C,qBAAqB;AAC/D;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL,gDAAgD,qBAAqB;AACrE;AACA;AACA;AACA;AACA;AACA,oBAAoB,mCAAiB;AACrC;AACA,kBAAkB;AAClB;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA,6BAA6B,0BAAa;AAC1C,aAAa;AACb;AACA;AACA,yBAAyB,0BAAa;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,qCAAkB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4FAA4F,QAAQ;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,0CAA0C,qBAAqB;AAC/D,0CAA0C,qBAAqB;AAC/D,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA,0BAA0B;AAC1B;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL,0CAA0C,qBAAqB;AAC/D,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA,0BAA0B,2CAA2C;AACrE,4BAA4B;AAC5B;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL,4CAA4C,qBAAqB;AACjE,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA,0BAA0B;AAC1B;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL,4CAA4C,qBAAqB;AACjE,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA,0BAA0B,6CAA6C;AACvE,4BAA4B;AAC5B;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,qCAAkB;AAClC;AACA;AACA;AACA;AACA,KAAK;AACL,wCAAwC,qBAAqB;AAC7D;AACA;AACA;AACA,KAAK;AACL,4CAA4C,qBAAqB;AACjE;AACA;AACA;AACA,KAAK;AACL,kDAAkD,qBAAqB;AACvE,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,qCAAkB;AAChE;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,qCAAkB;AAClC;AACA;AACA;AACA;AACA,KAAK;AACL,wCAAwC,qBAAqB;AAC7D;AACA;AACA;AACA,KAAK;AACL,4CAA4C,qBAAqB;AACjE;AACA;AACA;AACA,KAAK;AACL;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,qCAAkB;AAChE;AACA;AACA;AACA;AACA,KAAK;AACL,kDAAkD,qBAAqB;AACvE;AACA;AACA;AACA,KAAK;AACL,sDAAsD,qBAAqB;AAC3E;AACA;AACA;AACA,KAAK;AACL,iDAAiD,qBAAqB;AACtE,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,6DAA6D,qCAAkB;AAC/E;AACA;AACA;AACA,KAAK;AACL,6CAA6C,qBAAqB;AAClE,QAAQ,oBAAS;AACjB;AACA;AACA;AACA,8BAA8B,mCAAiB;AAC/C;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,gBAAgB,qCAAkB;AAClC;AACA;AACA;AACA;AACA,KAAK;AACL,oDAAoD,qBAAqB;AACzE,QAAQ,oBAAS;AACjB;AACA;AACA;AACA,8BAA8B,mCAAiB;AAC/C;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,wCAAwC,qBAAqB;AAC7D,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA,6BAA6B,wBAAW;AACxC,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,WAAK;AACjC;AACA;AACA;AACA,yBAAyB,wBAAW;AACpC;AACA;AACA,yBAAyB,wBAAW;AACpC;AACA;AACA,yBAAyB,wBAAW;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,uCAAuC,qBAAqB;AAC5D,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,gBAAgB,qCAAkB;AAClC;AACA;AACA;AACA,KAAK;AACL,0CAA0C,qBAAqB;AAC/D,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,gBAAgB,wBAAW;AAC3B;AACA;AACA;AACA,KAAK;AACL,CAAC,EAAE,mCAAsB,KAAK,mCAAsB,KAAK;AAClD,IAAI,gCAAmB;AAC9B;AACA;AACA,QAAQ,oBAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE;AAClE;AACA;AACA,KAAK,CAAC,8BAAa;AACnB;AACA,0CAA0C,qBAAqB;AAC/D,QAAQ,oBAAS;AACjB;AACA;AACA;AACA,8BAA8B,mCAAiB;AAC/C;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA,0BAA0B;AAC1B;AACA,aAAa;AACb;AACA;AACA;AACA,4CAA4C,mCAAc,mGAAmG,+BAA+B,EAAE;AAC9L;AACA;AACA,KAAK;AACL,kCAAkC,qBAAqB;AACvD,QAAQ,oBAAS;AACjB;AACA;AACA;AACA,8BAA8B,mCAAiB;AAC/C;AACA;AACA,4BAA4B,yBAAc,KAAK,mCAAiB,kBAAkB,mCAAiB;AACnG;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,4CAA4C,mCAAc,2FAA2F,+BAA+B,EAAE;AACtL;AACA;AACA;AACA,KAAK;AACL,8BAA8B,qBAAqB;AACnD,QAAQ,oBAAS;AACjB;AACA;AACA;AACA,8BAA8B,mCAAiB;AAC/C;AACA;AACA,4BAA4B,yBAAc,KAAK,mCAAiB,kBAAkB,mCAAiB;AACnG;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,4CAA4C,mCAAc,uFAAuF,+BAA+B,EAAE;AAClL;AACA;AACA;AACA,KAAK;AACL,qCAAqC,qBAAqB;AAC1D,QAAQ,oBAAS;AACjB;AACA;AACA;AACA,8BAA8B,mCAAiB;AAC/C;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA;AACA,0BAA0B;AAC1B;AACA,aAAa;AACb;AACA;AACA,qBAAqB,uCAAgB,kIAAkI,+BAA+B,EAAE;AACxM;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,sCAAsC,qBAAqB;AAC3D,QAAQ,oBAAS;AACjB;AACA;AACA;AACA,8BAA8B,mCAAiB;AAC/C;AACA;AACA,4BAA4B,mCAAiB;AAC7C;AACA,0BAA0B;AAC1B;AACA,aAAa;AACb;AACA;AACA,qBAAqB,uCAAgB,mIAAmI,+BAA+B,EAAE;AACzM;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC,EAAE,gCAAmB,KAAK,gCAAmB,KAAK;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,2CAA8B;AAClC,IAAI,oBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,kBAAkB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,kBAAkB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,wBAAO;AACT;AACA;AACA;AACA,IAAI,iCAAoB;AACxB,IAAI,oBAAS;AACb;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,kCAAkC,kBAAkB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,wBAAO;AACT,oBAAoB,2CAA8B;AAClD,mBAAmB,mCAAsB;AACzC;AACA;AACA,kBAAkB,mCAAiB;AACnC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,gBAAgB,MAAM;AACtB;AACA,eAAe,QAAY,EAAE,yDAAyD;AACtF;AACA;AACA,CAAC;AACD,oBAAoB,2CAA8B;AAClD,mBAAmB,OAAO;AAC1B;AACA,QAAQ,OAAO;AACf,kBAAkB,mCAAiB;AACnC;AACA;AACA,gBAAgB,mCAAiB;AACjC;AACA,KAAK;AACL;AACA,gBAAgB,MAAM;AACtB;AACA,eAAe,QAAY,EAAE,oDAAoD;AACjF;AACA;AACA,CAAC;AACD,oBAAoB,iCAAoB,cAAc,OAAO,OAAO,OAAO;AAC3E,oBAAoB,2CAA8B;AAClD,mBAAmB,OAAO;AAC1B;AACA,QAAQ,OAAO;AACf,kBAAkB,mCAAiB;AACnC;AACA;AACA,gBAAgB,mCAAiB;AACjC;AACA;AACA,cAAc;AACd,KAAK;AACL;AACA,gBAAgB,MAAM;AACtB;AACA,eAAe,QAAY,EAAE,oDAAoD;AACjF;AACA;AACA,CAAC;AACD,oBAAoB,iCAAoB,cAAc,OAAO,OAAO,OAAO;AAC3E;AACA,wBAAwB,iCAAoB;AAC5C,wBAAwB,iCAAoB;AAC5C;AACA,4BAA4B,OAAO;AACnC,4BAA4B,OAAO;AACnC,4BAA4B,OAAO;AACnC,4BAA4B,OAAO;AACnC,4BAA4B,OAAO;AACnC,4BAA4B,OAAO;;;AC5+CnC;AACA;AACA;AACA;AACuE;AACd;AACzD,IAAI,6BAAc;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,mCAAsB;AACxE;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA,+BAA+B,mCAAsB;AACrD;AACA;AACA,+BAA+B,mCAAsB,cAAc;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;ACxP1B;AACA;AACA;AACA;AACyE;AACA;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,6BAA6B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,yCAAyC;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,kBAAkB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;AACnC,IAAI,gCAAsB;AAC1B;AACA;AACA;AACA;AACA,yEAAyE,wCAAwC,EAAE;AACnH;AACA;AACA,sBAAsB,iBAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,2BAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC,IAAI,2BAAiB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,eAAe;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,4BAA4B;AACzE;AACA;AACA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,4BAA4B;AACzE;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,QAAQ;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mBAAmB;AAC/C;AACA,CAAC;;;ACzcD;AACA;AACA;AACA;AACA,IAAI,oBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACwE;AACd;AACH;AACf;AACzC,IAAI,yBAAY;AAChB,IAAI,oBAAS;AACb;AACA;AACA,kCAAkC,gCAAsB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,4BAAe;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,6BAA6B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,+BAA+B,EAAE;AACzG,8CAA8C,SAAS;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AACc;AACxB,IAAI,4BAAe;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,iBAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;AACA,iCAAiC,WAAW;AAC5C;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA,IAAI,oBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,yBAAY;AACiB;AAC/B,IAAI,+BAAkB;AACtB,IAAI,oBAAS;AACb;AACA;AACA;AACA;AACA;AACA,QAAQ,2BAAa;AACrB;AACA;AACA;AACA;AACA;AACA,YAAY,2BAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,yBAAY;AACgB;;;AC3O9B;AACA;AACA;AACA;AACA,IAAI,sBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACsD;AACqB;AACR;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,iCAAkB;AACtB,IAAI,sBAAS;AACb;AACA;AACA;AACA;AACA,wBAAwB,iBAAiB;AACzC,QAAQ,yBAAgB;AACxB;AACA;AACA;AACA,iDAAiD,iBAAiB;AAClE,QAAQ,yBAAgB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAM;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AACoB;AAC9B,IAAI,qBAAM;AACV;AACA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sBAA0B;AACxD,gEAAgE,cAAkB;AAClF,gEAAgE,cAAkB;AAClF,mEAAmE,cAAkB;AACrF,mEAAmE,cAAkB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,QAAQ;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,kFAAkF,UAAU;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,WAAW;AACzC,+BAA+B,6BAA6B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;ACnbD;AACA;AACA;AACA;AACA,IAAI,4BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACmC;AACkC;AACuC;AACd;AAC/F;AACA,IAAI,4BAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,kBAAkB;AACmB;AACvC,0BAA0B;AAC1B,uCAAuC,mBAAmB;AAC1D;AACA,wEAAwE,yCAAyC,EAAE;AACnH;AACA,yEAAyE,yBAAyB;AAClG,iDAAiD,yBAAyB;AAC1E;AACA,4EAA4E,+CAA+C,EAAE;AAC7H;AACA,gFAAgF,mBAAmB,EAAE;AACrG;AACA;AACA;AACA,CAAC;;;;;;ACjID;AACA;AACA;AACA;AACA,IAAI,kCAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACyC;AAC4B;AACuC;AACd;AAC/F;AACA,IAAI,kCAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,kBAAkB;AACyB;AAC7C,0BAA0B;AAC1B,uCAAuC,mBAAmB;AAC1D;AACA,sFAAsF,yCAAyC,cAAc,EAAE;AAC/I;AACA;AACA,iDAAiD,yBAAyB;AAC1E;AACA,0FAA0F,+CAA+C,EAAE;AAC3I;AACA;AACA,0FAA0F,mBAAmB,EAAE;AAC/G;AACA;AACA,CAAC;;;;;;AC1HD;AACA;AACA;AACA;AACA,IAAI,mBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC0B;AAC2C;AAChB;AACqB;AAC3E,IAAI,8BAAkB;AACtB,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,SAAS;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB,SAAS;AACT;AACA;AACA;AACA,qDAAqD,oCAAoC;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,UAAU;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,WAAW;AAC9C;AACA,sBAAsB;AACtB;AACA;AACA,yCAAyC,oBAAoB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,UAAU;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,WAAK;AACjC;AACA,0FAA0F,WAAK;AAC/F;AACA,4BAA4B,WAAK;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,UAAU;AACnE;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,eAAe;AACrE;AACA;AACA,mEAAmE,UAAU;AAC7E;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,0BAA0B;AAC1B;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,kBAAkB;AACU;;;;;;AC/M9B;AACA;AACA;AACA;AACA,IAAI,cAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACgC;AAC2B;AACN;AACC;AACvD,IAAI,aAAM;AACV,IAAI,cAAS;AACb;AACA;AACA;AACA;AACA,uBAAuB,qBAAyB,UAAU,SAAa,sBAAsB,qBAAqB,6BAAkB,KAAK,EAAE;AAC3I;AACA;AACA,uBAAuB,qBAAyB,UAAU,SAAa,2BAA2B,qBAAqB,6BAAkB,KAAK,EAAE;AAChJ;AACA;AACA,uBAAuB,qBAAyB,UAAU,SAAa,2BAA2B,qBAAqB,6BAAkB,KAAK,EAAE;AAChJ;AACA;AACA,uBAAuB,wCAA4C,wBAAwB,qBAAqB,6BAAkB,KAAK,EAAE;AACzI;AACA;AACA,uBAAuB,qBAAyB,UAAU,SAAa,yBAAyB,qBAAqB,mCAAqB,KAAK,EAAE;AACjJ;AACA;AACA,uBAAuB,qBAAyB,UAAU,SAAa,uBAAuB,qBAAqB,mCAAqB,KAAK,EAAE;AAC/I;AACA;AACA,uBAAuB,qBAAyB,UAAU,SAAa;AACvE;AACA;AACA,uBAAuB,qBAAyB,UAAU,SAAa;AACvE;AACA;AACA,uBAAuB,qBAAyB,UAAU,SAAa;AACvE;AACA;AACA,uBAAuB,qBAAyB,UAAU,SAAa;AACvE;AACA;AACA,CAAC,CAAC,UAAU;AACM;;;AC1DlB;AACA;AACA;AACA;AACA,IAAI,sBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACiG;AAC5D;AACiC;AACvE;AACA;AACA;AACO;AACP,IAAI,6BAAc;AAClB,IAAI,sBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,6CAAsB;AAC5E,yDAAyD,iCAAiC,EAAE;AAC5F,uDAAuD,iCAAiC,EAAE;AAC1F,0DAA0D,aAAa;AACvE,kEAAkE,YAAY;AAC9E;AACA;AACA;AACA;AACA;AACA,kEAAkE,4BAA4B,EAAE;AAChG;AACA;AACA;AACA;AACA,+CAA+C,uBAAuB;AACtE;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC,CAAC,aAAM;AACkB;;;ACxF1B;AACA;AACA;AACA;AACA,IAAI,qCAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACuD;AACE;AAC1D,IAAI,2DAA6B;AACjC,IAAI,qCAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,YAAY;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AAC6B;;;ACpGzC;AACA;AACA;AACA;AACA,IAAI,yBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACmC;AACqB;AACyC;AAC7C;AAC8B;AAC7C;AACkB;AACxD;AACA;AACA;AACA;AACA,IAAI,mCAAiB;AACrB,IAAI,yBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,2DAA6B;AACvF,sDAAsD,6CAAsB;AAC5E;AACA,wBAAwB,iBAAiB;AACzC;AACA;AACA;AACA;AACA,+DAA+D,mCAAmC,EAAE;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,6BAAc;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,iBAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,EAAE;AACzD;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,EAAE;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,sBAA0B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,EAAE;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,uBAAuB;AACtE;AACA;AACA,gBAAgB,6BAAkB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,aAAM;AACqB;;;ACxM7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;AC3I1B;AACA;AACA;AACA;AACA,IAAI,2BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC6D;AACH;AACN;AACA;AACrD,IAAI,uCAAmB;AACvB,IAAI,2BAAS;AACb;AACA;AACA;AACA;AACA,gCAAgC,cAAc;AAC9C;AACA;AACA;AACA,SAAS;AACT;AACA,kDAAkD,cAAc;AAChE,oEAAoE,cAAc;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,qCAAqC,kCAAuB,cAAc,EAAE;AACrH,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,qCAAqC,kCAAuB,eAAe,EAAE;AACtH,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,mCAAiB;AACY;;;ACzF/B;AACA;AACA;AACA;AACA,IAAI,yBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC6D;AACH;AACN;AACA;AACrD,IAAI,mCAAiB;AACrB,IAAI,yBAAS;AACb;AACA;AACA;AACA;AACA,gCAAgC,cAAc;AAC9C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,kDAAkD,cAAc;AAChE,kEAAkE,cAAc;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,qCAAqC,kCAAuB,cAAc,EAAE;AACrH,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,qCAAqC,kCAAuB,eAAe,EAAE;AACtH,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,mCAAiB;AACU;;;AC3F7B;AACA;AACA;AACA;AACA,IAAI,kBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACoC;AACO;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;AACvB,IAAI,qBAAU;AACd,IAAI,kBAAS;AACb;AACA;AACA,8CAA8C,aAAO;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACU;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmC;AACpC;AACA;AACA;AACA;AACA;AACA;;;AC5TA;AACA;AACA;AACA;AACA,IAAI,yBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC+B;AACI;AACqB;AACK;AACC;AACJ;AACrB;AACkB;AACL;AACI;AACC;AACG;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC,IAAI,2CAAyB;AAC7B,IAAI,yBAAS;AACb;AACA;AACA,8CAA8C,aAAO;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,sDAAsD,6CAA6C,EAAE;AACrG,sCAAsC,6BAA6B,EAAE;AACrE,oCAAoC,2BAA2B,EAAE;AACjE;AACA,uDAAuD,mCAAiB;AACxE,yDAAyD,uCAAmB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,iBAAiB;AACxD;AACA;AACA,sCAAsC,iBAAiB;AACvD;AACA;AACA,0CAA0C,iBAAiB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,8BAA8B,EAAE;AAChG,0EAA0E,6BAA6B,EAAE;AACzG,iDAAiD,YAAY;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,iBAAO;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,+BAAoB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,iBAAO;AAC3C;AACA;AACA;AACA,4BAA4B,kCAAuB;AACnD;AACA;AACA,2CAA2C,qBAAyB;AACpE,2CAA2C,qBAAyB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,WAAW,IAAI,SAAS,IAAI,SAAS;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,+BAAoB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,sBAAsB,EAAE;AAChF;AACA;AACA;AACA,CAAC,CAAC,aAAM;AAC6B;AACrC,IAAI,mCAAiB;AACrB,IAAI,yBAAS;AACb;AACA;AACA;AACA;AACA,6BAA6B,qBAAU,yBAAyB,QAAQ,gCAAgC,WAAW,EAAE;AACrH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,2CAAyB;AACE;AAC7B;AACA,IAAI,yBAAS;AACb;AACA;AACA;AACA;AACA,CAAC,CAAC,2CAAyB;AACQ;AACnC;AACA,IAAI,yBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,mCAAiB;AACa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,+BAAoB;AAC5B;AACA;AACA;AACA;;;AC5cA;AACA;AACA;AACA;AACA,IAAI,uBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACsD;AACqB;AACyB;AACjC;AACqB;AACzF,IAAI,+BAAe;AACnB,IAAI,uBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,oBAAoB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,uBAAuB;AACrE,QAAQ,yBAAgB;AACxB,iCAAiC,iBAAiB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,qBAAyB,8CAA8C,kEAAkE,EAAE;AACnK,wBAAwB,qBAAyB,+CAA+C,oEAAoE,EAAE;AACtK,wBAAwB,qBAAyB,uDAAuD,4EAA4E,EAAE;AACtL,wBAAwB,qBAAyB,yDAAyD,8EAA8E,EAAE;AAC1L;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,oBAAoB;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AACiB;;;;;;ACrI3B;AACA;AACA;AACA;AACA,IAAI,mBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC0B;AAC2C;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AAC9B;AACA,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA;AACA,qDAAqD,oCAAoC;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,yBAAyB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,kBAAkB;AACI;AACxB;AACA,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,2BAA2B,4BAA4B;AAC1G;AACA,qDAAqD,oCAAoC;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;;;;;;ACpL9B;AACA;AACA;AACA;AACA,IAAI,oBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2B;AAC0C;AACV;AAC+C;AACZ;AAC/F,IAAI,gCAAmB;AACvB,IAAI,oBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,oCAAoC;AACzF;AACA;AACA;AACA;AACA,0EAA0E,QAAQ;AAClF;AACA,2BAA2B,aAAa;AACxC;AACA,wFAAwF,4BAA4B;AACpH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,kBAAkB;AACW;AAC/B,0BAA0B;AAC1B,iDAAiD,kBAAkB;AACnE;AACA,gEAAgE,6DAA6D,EAAE;AAC/H;AACA,uDAAuD,wBAAwB;AAC/E;AACA,iEAAiE,mEAAmE,EAAE;AACtI;AACA,CAAC;;;;;;AC1JD;AACA;AACA;AACA;AACA,IAAI,iBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACwB;AAC2C;AACN;AACG;AACG;AACS;AACjB;AACN;AACuB;AAC7E,IAAI,0BAAgB;AACpB;AACA,wCAAwC,WAAK;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,mBAAS;AACb,IAAI,iBAAS;AACb;AACA;AACA;AACA;AACA,kCAAkC,gCAAsB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,eAAe;AACpD,QAAQ,yBAAgB;AACxB;AACA,QAAQ,2BAAa;AACrB;AACA;AACA,2CAA2C,gBAAgB;AAC3D;AACA,SAAS;AACT,sCAAsC,0BAAgB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,iBAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,2BAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,eAAe;AACpD;AACA;AACA;AACA;AACA,kDAAkD,6BAA6B;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,iCAAiC;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,iCAAiC;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iFAAiF,8BAA8B;AAC/G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA,mCAAmC,iBAAQ;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,6BAA6B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,WAAK;AACzB;AACA;AACA;AACA;AACA,oCAAoC,iBAAiB;AACrD;AACA;AACA,sHAAsH,QAAQ;AAC9H;AACA;AACA;AACA,oDAAoD,mCAAmC;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0HAA0H,QAAQ;AAClI;AACA;AACA;AACA;AACA,oDAAoD,iBAAiB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,WAAK;AACzB;AACA;AACA;AACA;AACA,oCAAoC,iBAAiB;AACrD;AACA;AACA,oDAAoD,mCAAmC;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,WAAK;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,iCAAiC;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,WAAK;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AACW;;;;;;AC7jBrB;AACA;AACA;AACA;AACA,IAAI,wBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC+B;AACiD;AACjF,IAAI,wCAAuB;AAC3B,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA,gCAAgC,kBAAkB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,sBAAsB;AACzE;AACA,qDAAqD,oCAAoC;AACzF;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,YAAY;AACqB;;;;;;ACxGnC;AACA;AACA;AACA;AACA,IAAI,yBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACgC;AACgD;AACjF,IAAI,kDAAgC;AACpC,IAAI,yBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA,gCAAgC,kBAAkB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,oCAAoC;AACzF;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,YAAY;AAC8B;;;;;;AC/F5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;;;AC3BjB;AACA;AACA;AACA;AACwD;AAChB;AACW;AACnD,IAAI,6CAAyB;AAC7B;AACA;AACA,gCAAgC,aAAO;AACvC;AACA;AACA,QAAQ,oBAAoB;AAC5B;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA,4BAA4B,KAAK;AACjC;AACA;AACA;AACA,wBAAwB,KAAK;AAC7B,6BAA6B,2BAA2B;AACxD;AACA;AACA,wCAAwC,KAAK;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;;;ACvR/B;AACA;AACA;AACA;AAC+D;AAC/D;AACA;AACA,qCAAqC,SAAS;AAC9C;AACA;AACA;AACA;AACA,IAAI,8CAAmB;AAChB;AACP,SAAS,8CAAmB;AAC5B;AACA;AACA;AACA;AACA,QAAQ,8CAAmB,OAAO,mBAAmB;AACrD;AACA,WAAW,8CAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AClxBA;AACA;AACA;AACA;AACA,IAAI,eAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACsB;AACgC;AACqB;AACyC;AACrD;AACF;AACI;AACE;AACd;AACkC;AACY;AACnC;AACgH;AAClF;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,iCAAyB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,kBAAU;AACd;AACA;AACA;AACA,kCAAkC,uBAAuB,cAAc,4BAA4B,EAAE;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,YAAY;AACnC,2BAA2B,WAAW;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,eAAO;AACX,IAAI,eAAS;AACb;AACA;AACA;AACA;AACA;AACA,yBAAyB,iBAAiB;AAC1C,QAAQ,yBAAgB;AACxB;AACA;AACA;AACA;AACA,wBAAwB,iBAAiB;AACzC;AACA;AACA,wBAAwB,iBAAiB;AACzC;AACA;AACA;AACA,wBAAwB,iBAAiB;AACzC;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA,oCAAoC,6CAAyB;AAC7D;AACA,mCAAmC,6BAAiC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,2BAAsC,KAAK,WAAK;AACxG,SAAS;AACT,4CAA4C,6CAAsB;AAClE,yCAAyC,6BAAiC;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,uBAAuB;AACrF;AACA,wBAAwB,6BAAkB,2BAA2B,iCAAyB;AAC9F;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gFAAgF,uBAAuB;AACvG;AACA,oHAAoH,8BAA8B;AAClJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kBAAU;AAC7B;AACA;AACA;AACA;AACA,sEAAsE,SAAS;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA,8CAA8C,6BAA6B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,wBAAwB;AACvF;AACA;AACA;AACA,kBAAkB,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,oBAA4B;AAC5D,mCAAmC,WAAW;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AACS;AACnB,0BAA0B;AAC1B,0CAA0C,yBAAyB;AACnE;AACA;AACA,sHAAsH,0CAA0C,EAAE;AAClK;AACA,+CAA+C,8BAA8B;AAC7E;AACA;AACA,kIAAkI,+CAA+C,EAAE;AACnL;AACA,gDAAgD,+BAA+B;AAC/E;AACA;AACA,oIAAoI,gDAAgD,EAAE;AACtL;AACA,gCAAgC,eAAe;AAC/C;AACA,mEAAmE,kDAAkD,EAAE;AACvH;AACA,CAAC;;;;;;AC7pBD;AACA;AACA;AACA;AACA,IAAI,sBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC6B;AAC8C;AACR;AACpE,IAAI,iCAAkB;AACtB,IAAI,sBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,iBAAiB;AAC1C,QAAQ,yBAAgB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,iBAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AACoB;;;ACxH9B;AACA;AACA;AACA;AACA,IAAI,gCAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2E;AACnB;AACP;AACU;AACI;AACgD;AAChH,IAAI,iCAAQ;AACZ;AACA;AACA;AACA;AACA;AACA,yCAAyC,yBAAyB;AAClE;AACA;AACA,yCAAyC,sBAAsB;AAC/D;AACA;AACA;AACA;AACA,gDAAgD,oBAAoB;AACpE;AACA;AACA;AACA;AACA,mCAAmC,KAAK;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,iDAAwB;AAC5B,IAAI,gCAAS;AACb;AACA;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA,4CAA4C,oBAAoB;AAChE;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,iCAAQ;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,SAAS;AAC3D;AACA;AACA,mCAAmC,QAAQ;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,eAAe;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,SAAS;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,SAAS;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AAC0B;;;ACnWpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD,6DAA6D;AAC7D,wDAAwD;AACxD;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;;;ACzK/B;AACA;AACA;AACA;AACA,IAAI,qBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2E;AACM;AACD;AACjF,IAAI,2BAAa;AACjB,IAAI,qBAAS;AACb;AACA;AACA;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA,iCAAiC,mBAAmB,wBAAwB,6EAA6E,EAAE;AAC3J;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,gBAAgB;AACO;;;;;;AC7IzB;AACA;AACA;AACA;AACA,IAAI,cAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACqB;AACsD;AAC1B;AACwB;AACqB;AAC/F,IAAI,aAAM;AACV,IAAI,cAAS;AACb;AACA;AACA,wBAAwB,iBAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,SAAS;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AACQ;AAClB,0BAA0B;AAC1B,oCAAoC,WAAW;AAC/C;AACA,uDAAuD,gDAAgD,EAAE;AACzG;AACA,CAAC;;;;;;ACjGD;AACA;AACA;AACA;AACA,IAAI,wBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC+B;AAC4C;AAC1B;AACmC;AACU;AAC/F,IAAI,yCAAwB;AAC5B,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AAC0B;AACpC,0BAA0B;AAC1B,gCAAgC,eAAe;AAC/C;AACA,8DAA8D,iDAAiD,EAAE;AACjH;AACA,CAAC;;;;;;AChGD;AACA;AACA;AACA;AACA,IAAI,kBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACyB;AACqC;AACO;AAC6E;AACpD;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,UAAkB;AAChE;AACA,IAAI,kBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,SAAS;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,+CAA+C;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,gCAAgC;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,SAAS;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA,kBAAkB;AAClB;AACA,kBAAkB;AAClB;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,SAAS;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,UAAU;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,oCAAoC;AACzF;AACA;AACA;AACA;AACA,sDAAsD,SAAS;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,kBAAkB;AACS;AAC7B,0BAA0B;AAC1B,8CAA8C,yBAAyB;AACvE;AACA,mEAAmE,gDAAgD,EAAE;AACrH;AACA,sDAAsD,uBAAuB;AAC7E;AACA,0DAA0D,wDAAwD,EAAE;AACpH;AACA,wDAAwD,yBAAyB;AACjF;AACA,gFAAgF,+CAA+C,EAAE;AACjI;AACA,CAAC;AACD;AACA;AACA;;;;;;ACpWA;AACA;AACA;AACA;AACuD;AACqB;AACd;AACA;AACkB;AACpB;AACN;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,qBAAU;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,iBAAiB;AACzC;AACA;AACA;AACA;AACA,QAAQ,2BAAa;AACrB;AACA,gCAAgC,QAAQ;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,2BAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,qBAAqB,+BAA+B,qBAAqB;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,qBAAqB;AAC3D,0BAA0B,sBAA0B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,sBAA0B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E,WAAK;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,qBAAqB;AACvD;AACA;AACA,gBAAgB,eAAuB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,qBAAqB,oCAAoC,qBAAqB;AAChH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;ACnKtB;AACA;AACA;AACA;AACA,IAAI,mBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC0B;AACiD;AACG;AAC7B;AACL;AACmC;AAC6B;AACd;AAC/F,IAAI,uBAAW;AACf,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,qBAAU;AAC7C;AACA;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA,+CAA+C,YAAY;AAC3D,6CAA6C,aAAa;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,SAAS;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,YAAY;AACvC,oCAAoC,qBAAU;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,eAAe;AAC1C;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA,kDAAkD,SAAS;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,SAAS;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,SAAS;AACrE;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,SAAS;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,SAAS;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,SAAS;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AACa;AACvB,0BAA0B;AAC1B,+BAA+B,sBAAsB;AACrD;AACA,6CAA6C,sBAAsB;AACnE;AACA;AACA;AACA,mDAAmD,iCAAiC,6BAA6B,gCAAgC,EAAE;AACnJ;AACA,oFAAoF,gDAAgD,iDAAiD,EAAE;AACvL;AACA;AACA,CAAC;;;AC5TD;AACA;AACA;AACA;AACA,IAAI,iBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC2E;AACN;AACpB;AACU;AAC5D,IAAI,mBAAS;AACb,IAAI,iBAAS;AACb;AACA;AACA;AACA;AACA;AACA,wBAAwB,iBAAiB;AACzC;AACA;AACA;AACA;AACA,8BAA8B,iBAAiB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,yCAAyC,QAAQ;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC,gDAAgD,iBAAiB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,SAAS;AACjE;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,QAAQ;AACW;;;ACtSrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;ACpBvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,SAAS;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,SAAS;AAChE;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;;;AC3E/B;AACA;AACA;AACA;AACyC;AACzC;AACA;AACA;AACA,IAAI,kCAAY;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,WAAK;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;;;AC3BxB;AACA;AACA;AACA;AACA,IAAI,gBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACmD;AACqB;AACN;AACF;AACE;AACd;AACuB;AAC3B;AACkC;AACqB;AACkB;AAC7C;AACK;AACL;AACG;AACH;AACjB;AACgC;AACrC;AACgD;AAC7C;AACyB;AACe;AACtB;AACrB;AACsC;AACnB;AACJ;AACN;AACP;AACgB;AACV;AACgB;AACjB;AACkB;AACF;AACQ;AACtF,IAAI,oBAAW,gBAAgB,4CAA4C;AAC3E,IAAI,aAAI;AACR,IAAI,gBAAS;AACb;AACA;AACA;AACA;AACA;AACA,iCAAiC,6BAAc;AAC/C;AACA,oCAAoC,mBAAmB,sBAAsB,oCAAoC,EAAE;AACnH;AACA;AACA;AACA,6BAA6B,WAAW;AACxC;AACA;AACA,2CAA2C,qBAAgC;AAC3E;AACA,SAAS;AACT;AACA;AACA,qCAAqC,+BAAe;AACpD;AACA;AACA;AACA;AACA,mCAAmC,6BAAc;AACjD;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,4BAA4B,iBAAiB;AAC7C;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA,sCAAsC,iBAAiB;AACvD,QAAQ,yBAAgB;AACxB;AACA,8BAA8B,+BAAe;AAC7C;AACA;AACA,6BAA6B,mBAAS;AACtC;AACA,6BAA6B,mBAAS;AACtC;AACA;AACA,2CAA2C,iDAAwB;AACnE;AACA,mCAAmC,yCAAwB;AAC3D;AACA,sCAAsC,mBAAmB;AACzD;AACA,kDAAkD,2BAA2B;AAC7E,kDAAkD,iBAAiB;AACnE,kDAAkD,gCAAmB;AACrE,kDAAkD,8BAAkB;AACpE,qCAAqC,+BAAkB;AACvD;AACA,iDAAiD,iCAAiC;AAClF,iDAAiD,kBAAkB;AACnE,iDAAiD,kDAAgC;AACjF,iDAAiD,wCAAuB;AACxE,iDAAiD,8BAAkB;AACnE,yBAAyB,aAAM;AAC/B;AACA;AACA;AACA;AACA,kCAAkC,iCAAkB;AACpD;AACA,+BAA+B,uBAAW;AAC1C;AACA;AACA,kCAAkC,iCAAkB;AACpD;AACA,yBAAyB,aAAM;AAC/B;AACA,0BAA0B,eAAO;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,mEAAmE,QAAQ;AAC3E,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,QAAQ;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E,oBAAoB;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,uCAA2C;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,8BAA8B,EAAE;AACrE;AACA;AACA;AACA,oDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,kCAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,gBAAgB;AACnD;AACA,uDAAuD,SAAS;AAChE;AACA;AACA;AACA,uDAAuD,SAAS;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,sCAAsC;AAC7F;AACA;AACA,uDAAuD,wCAAwC;AAC/F;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,sEAAsE,QAAQ;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,2BAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,oBAAW;AAChD,wCAAwC,oBAAW;AACnD,wCAAwC,oBAAW;AACnD;AACA;AACA,4DAA4D,qBAAgC;AAC5F;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,SAAS;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,gBAAgB;AACF;AAChB;AACA;AACA;AACA;AACA;AACA,QAAQ,iBAAiB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,iBAAiB;AACzB;AACA;;;AC7cA;AACA;AACA;AACA;AACA,IAAI,0BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC8D;AACJ;AAC3D;AACA,IAAI,0BAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,sCAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACkB;AAC9B,IAAI,sCAAmB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,uBAAW;AAC1B;AACA;AACA,CAAC;;;ACpID;AACA;AACA;AACA;AACmE;AACpB;AACN;AACQ;AACjD,IAAI,mBAAS;AACb;AACA;AACA;AACA,oCAAoC,8BAAiB,KAAK,WAAK,qBAAqB,QAAQ,gBAAgB,8BAAiB,KAAK,WAAK,qBAAqB,QAAQ;AACpK;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,wBAAW;AAC9B;AACA;AACA;AACA;AACA,uBAAuB,mBAAS;AAChC;AACA,mBAAmB,mBAAS;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8BAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8BAAiB;AAC9C;AACA;AACA;AACA,qFAAqF,QAAQ;AAC7F,qFAAqF,QAAQ;AAC7F,yCAAyC,WAAK;AAC9C;AACA,4BAA4B,8BAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA,4BAA4B,8BAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;ACzFrB;AACA;AACA;AACA;AACgD;AACL;AACM;AACjD,IAAI,iCAAgB;AACpB;AACA;AACA,iCAAiC,mBAAS;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,eAAe;AAC1C;AACA;AACA;AACA;AACA;AACA,2BAA2B,eAAe;AAC1C;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,mBAAS;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,SAAS;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,uCAAuC,8CAA8C;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,mBAAS;AAC1D;AACA;AACA,iDAAiD,mBAAS;AAC1D;AACA;AACA,yCAAyC,wBAAW;AACpD;AACA;AACA,+BAA+B,0BAA0B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;;;AC/N5B;AACA;AACA;AACA;AACA,IAAI,cAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACsC;AAC4B;AACX;AACG;AACF;AAC+D;AACzD;AACJ;AAClB;AACQ;AACE;AACC;AACpD;AACA,wCAAwC,SAAS;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,SAAS;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B,IAAI,aAAM;AACV,IAAI,cAAS;AACb;AACA;AACA,8DAA8D,aAAO;AACrE;AACA,8DAA8D,aAAO;AACrE;AACA,iDAAiD,aAAO;AACxD;AACA;AACA;AACA;AACA;AACA,4BAA4B,0BAAa;AACzC,6BAA6B,iCAAgB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,gCAAgC,0BAAa;AAC7C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA,gBAAgB,gCAAmB;AACnC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,uDAAuD,wBAAW;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,iCAAgB;AAChD;AACA;AACA;AACA;AACA,sEAAsE,wBAAW;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,0BAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,wBAAW;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,sBAAe;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,2BAAsC;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE,8EAA8E,EAAE;AACvJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,WAAK;AACjC;AACA;AACA;AACA;AACA;AACA,qCAAqC,2BAAsC;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAoB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,mCAAc;AACrD;AACA;AACA;AACA;AACA;AACA,8CAA8C,SAAS;AACvD;AACA;AACA,oBAAoB,eAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,mCAAc;AACzD;AACA;AACA;AACA,uCAAuC,mCAAc;AACrD;AACA;AACA;AACA,mCAAmC,mCAAc;AACjD;AACA;AACA,mCAAmC,mCAAc;AACjD;AACA;AACA,mCAAmC,uCAAgB;AACnD;AACA;AACA;AACA,uCAAuC,mBAAmB;AAC1D;AACA;AACA,SAAS;AACT;AACA;AACA,uCAAuC,mBAAmB;AAC1D;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC,CAAC,2BAA2B;AACX;AAClB,IAAI,sBAAe;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,SAAS;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,SAAS;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iCAAiC;AAC5D;AACA;AACA,2BAA2B,kCAAkC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,2CAA2C,mBAAS;AACpD;AACA,uCAAuC,mBAAS;AAChD;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,2BAA2B,iCAAiC;AAC5D;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA,8CAA8C,SAAS;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,SAAS;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,QAAY;AAC5C,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,WAAK;AAC1B,SAAS;AACT;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,uBAAuB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AC9tBD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;;;ACzBhC;AACA;AACA;AACA;AAC2D;AACR;AACO;AAC1D,IAAI,4BAAQ;AACZ,kCAAkC,QAAQ,UAAU,CAAC,EAAE;AACvD,sDAAsD,QAAQ,aAAa,2CAA2C;AACtH;AACO;AACP,yCAAyC,uBAAuB,4BAAQ,CAAC;AACzE,0DAA0D,4BAAQ;AAClE;AACO;AACP;AACA;AACA;AACA,oEAAoE,yBAAyB;AAC7F;AACA;AACA;AACA;AACA;AACA,cAAc,oDAAoD;AAClE;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA,wCAAwC;AACxC;AACA;AACA,yCAAyC;AACzC;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA,QAAQ,qBAAU;AAClB,6BAA6B,qBAAU;AACvC;AACA;AACA,yDAAyD,UAAU;AACnE;AACA;AACA,wDAAwD,cAAc;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,SAAS;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,SAAS;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,YAAY;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,SAAS;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,CAAC;AAC6B;;;AC9X9B;AACA;AACA;AACA;AAC6D;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,uBAAW;AACf;AACA;AACA;AACA,gCAAgC,kBAAkB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,6BAA6B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,eAAe;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;ACjYvB;AACA;AACA;AACA;AACA,IAAI,kBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC8D;AACC;AACjB;AACM;AACrD;AACA,IAAI,qBAAU;AACd,IAAI,kBAAS;AACb;AACA;AACA;AACA,iCAAiC,uBAAW;AAC5C,+CAA+C,qBAAU;AACzD;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC,CAAC,UAAU;AACU;;;AC3NtB;AACA;AACA;AACA;AAC+C;AACN;AACsB;AACX;AACgB;AACtB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B,IAAI,yCAAoB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC,IAAI,yCAAoB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,yCAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,+CAA+C,EAAE,OAAO,WAAK;AAClI;AACA;AACA;AACA,uBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,0BAA0B;AAC/D;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,qCAAqC,EAAE,OAAO,WAAK;AAClG;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA,gCAAgC,WAAK;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAK;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,+CAA+C,EAAE,OAAO,WAAK;AAChI;AACA;AACA,2BAA2B,sBAAsB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,yBAAyB,sBAAsB;AAC/C,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,qBAAgC;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,QAAQ;AACvC,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,sBAAiC;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,qBAAgC;AAClG,mEAAmE,sBAAiC;AACpG,kEAAkE,qBAAgC;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,qCAAqC;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,QAAQ;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,WAAW;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uFAAuF,sBAAsB;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,QAAQ;AAC5E;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,QAAQ;AACvD;AACA;AACA;AACA,4DAA4D,QAAQ;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,WAAK;AAC7D;AACA;AACA;AACA;AACA;AACA,sDAAsD,qCAAqC;AAC3F;AACA;AACA;AACA;AACA,mCAAmC,QAAQ;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,gFAAgF,WAAK;AACrF;AACA;AACA;AACA;AACA;AACA,wEAAwE,WAAK;AAC7E;AACA;AACA;AACA,sBAAsB,WAAK;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC,IAAI,6CAAwB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,6CAAwB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,8BAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA,sDAAsD,qCAAqC;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;AACrB;AACA;AACA;AACA;AACA;AACA,mBAAmB,6CAAwB;AAC3C;AACA;AACA;AACA;AACA,mBAAmB,8BAAS;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuC;AACxC,IAAI,4CAAuB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,qBAAgC;AACnD;AACA;AACA,mBAAmB,sBAAiC;AACpD;AACA;AACA,2BAA2B,qBAAgC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,iCAAiC;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;ACnkCD;AACA;AACA;AACA;AACA,IAAI,uCAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC0D;AACU;AACrB;AACW;AACA;AAC3D;AACA,IAAI,uCAAS;AACb;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,uCAAmB;AACrB,IAAI,sEAAsC;AAC1C;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD,2BAA2B;AAC3B,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B,yCAAyC;AACzC,2DAA2D;AAC3D,iDAAiD;AACjD;AACA;AACA;AACA;AACA,sCAAsC,+BAA+B;AACrE;AACA;AACA;AACA,+BAA+B,6BAA6B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4BAA4B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC,iCAAiC;AACjC,qCAAqC;AACrC,8BAA8B;AAC9B,iCAAiC;AACjC,uCAAuC;AACvC,sCAAsC;AACtC,4CAA4C;AAC5C;AACA,uBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA,gBAAgB,oBAA4B;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gEAAgC,KAAK,mCAAiB,CAAC,aAAa;AACvF;AACA;AACA,CAAC;AACiD;AAClD,IAAI,gEAAgC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA,CAAC;AAC2C;;;AC9O5C;AACA;AACA;AACA;AAC+C;AACN;AAC8B;AACvE,IAAI,yCAAoB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8FAA8F,QAAQ;AACtG,4FAA4F,QAAQ;AACpG,gCAAgC,WAAK;AACrC;AACA;AACA;AACA;AACA,oBAAoB,mBAAmB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,oBAAoB;AACzD;AACA;AACA,sDAAsD,SAAS;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,gBAAgB;AAC3D;AACA;AACA,wDAAwD,+BAA+B;AACvF;AACA;AACA;AACA;AACA;AACA,+CAA+C,gBAAgB,KAAK,WAAK;AACzE;AACA;AACA;AACA;AACA;AACA,+CAA+C,gBAAgB,KAAK,WAAK;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;;;AC9GhC;AACA;AACA;AACA;AACA,IAAI,qBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACqD;AACK;AACZ;AACN;AACU;AACkB;AACM;AACvB;AACK;AACqC;AACJ;AACR;AACjB;AACjE;AACA,IAAI,uBAAS;AACb,IAAI,qBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,4CAAuB;AACrD;AACA;AACA;AACA,oDAAoD,sEAAsC;AAC1F,8BAA8B,yCAAoB;AAClD;AACA;AACA,+CAA+C,qBAAU;AACzD;AACA;AACA;AACA,yCAAyC,sBAAiC;AAC1E;AACA;AACA;AACA;AACA,SAAS;AACT,gCAAgC,yCAAoB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,wBAAwB,6CAAyB;AACjD;AACA;AACA,yCAAyC,4BAAuC;AAChF;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,QAAQ;AAChE;AACA;AACA;AACA;AACA;AACA,qCAAqC,gBAA2B;AAChE,qCAAqC,2BAAsC;AAC3E,qCAAqC,2BAAsC;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,2BAAsC;AAC3E;AACA,iCAAiC,6BAAwC;AACzE;AACA;AACA;AACA;AACA,kDAAkD,2DAA2D;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,UAAU;AAChE;AACA;AACA;AACA;AACA,qDAAqD,gBAA2B;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,2BAAsC;AACnF,6CAA6C,2BAAsC;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,4DAA4D;AACvH;AACA;AACA,SAAS;AACT;AACA;AACA,mDAAmD,UAAU;AAC7D;AACA,4GAA4G,QAAQ;AACpH,0GAA0G,QAAQ;AAClH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,sBAAiC;AAC1E;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,yCAAyC,8BAAyC;AAClF;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,gBAA2B;AACxE,6CAA6C,2BAAsC;AACnF,6CAA6C,2BAAsC;AACnF;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,yCAAyC,2BAAsC;AAC/E;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,gBAA2B;AACpE,yCAAyC,2BAAsC;AAC/E,yCAAyC,2BAAsC;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,WAAK;AAC/C;AACA;AACA;AACA;AACA;AACA,sCAAsC,WAAK;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA;AACA,6FAA6F,QAAQ;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wFAAwF,QAAQ;AAChG,iHAAiH,WAAK;AACtH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8BAA8B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,+BAAqB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,yBAAyB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,WAAK;AACzB,yDAAyD,qBAAqB,EAAE;AAChF;AACA;AACA;AACA;AACA;AACA,wCAAwC,QAAQ;AAChD;AACA,aAAa;AACb;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAK;AAC7B;AACA;AACA;AACA;AACA,mEAAmE;AACnE,8EAA8E;AAC9E,yDAAyD;AACzD,yDAAyD;AACzD,uDAAuD;AACvD,2DAA2D;AAC3D,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,6BAA6B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,kBAAkB;AAC5C;AACA;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA,kDAAkD,SAAS;AAC3D,4BAA4B,KAAK;AACjC;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,2BAA2B;AACR;;;ACpjBrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA,6CAA6C,uBAAuB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;;;AC7B7B;AACA;AACA;AACA;AACA,IAAI,wBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,yBAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,sBAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AAC4B;AACA;AACW;AACa;AACe;AACX;AACgB;AACd;AACC;AACO;AACI;AAC3B;AACwB;AACR;AACa;AACf;AACN;AACQ;AACS;AACP;AACS;AACvB;AAC8O;AACzN;AACY;AACO;AACS;AACA;AACH;AACc;AAC3G;AACA;AACA,IAAI,0BAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,iBAAO;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,iCAAgB;AACpB,IAAI,wBAAS;AACb;AACA;AACA;AACA,kDAAkD,aAAO;AACzD;AACA,6DAA6D,aAAO;AACpE;AACA,8DAA8D,aAAO;AACrE;AACA,2EAA2E,aAAO;AAClF;AACA,6DAA6D,aAAO;AACpE;AACA,iEAAiE,aAAO;AACxE;AACA,8DAA8D,aAAO;AACrE;AACA,sDAAsD,aAAO;AAC7D;AACA,+DAA+D,aAAO;AACtE;AACA,gEAAgE,aAAO;AACvE;AACA,8DAA8D,aAAO;AACrE;AACA,uDAAuD,aAAO;AAC9D;AACA,qDAAqD,oCAAmB;AACxE;AACA;AACA,uDAAuD,oCAAmB;AAC1E;AACA;AACA,gDAAgD,aAAO;AACvD;AACA,+CAA+C,aAAO;AACtD;AACA,wDAAwD,aAAO;AAC/D;AACA,sDAAsD,aAAO;AAC7D;AACA,gDAAgD,aAAO;AACvD;AACA,+CAA+C,aAAO;AACtD;AACA,iDAAiD,aAAO;AACxD;AACA,iDAAiD,aAAO;AACxD;AACA,iDAAiD,aAAO;AACxD;AACA,mDAAmD,aAAO;AAC1D;AACA,iDAAiD,aAAO;AACxD;AACA,kDAAkD,aAAO;AACzD;AACA,6CAA6C,aAAO;AACpD;AACA,+CAA+C,aAAO;AACtD;AACA,uDAAuD,aAAO;AAC9D;AACA,0DAA0D,aAAO;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,4BAA4B,yCAAwB;AACpD,4BAA4B,kCAAiB;AAC7C,2EAA2E,iBAAiB,EAAE,kBAAkB;AAChH;AACA;AACA;AACA,kCAAkC,6CAA4B;AAC9D;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,wBAAwB;AACpD;AACA,mDAAmD,SAAS;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA,QAAQ,wBAAwB;AAChC,qCAAqC,oBAAoB;AACzD;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,mBAAmB,2BAAa;AAChC;AACA;AACA;AACA;AACA;AACA,eAAe,UAAuB;AACtC;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,gBAAgB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,cAAc;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8EAA8E,QAAQ,WAAK,SAAS,EAAE;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,0BAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa,WAAK;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,WAAK;AACvC;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA,kCAAkC,WAAK;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,mBAAS;AACnC,sBAAsB,WAAK;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mBAAS;AACrC;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,WAAK;AACvC;AACA;AACA,oCAAoC,6BAA6B;AACjE,gDAAgD,gCAAgC;AAChF,0CAA0C,yBAAyB;AACnE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,aAAa,WAAK;AAClB;AACA;AACA,8BAA8B,WAAK;AACnC;AACA;AACA,gCAAgC,gBAAgB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD,iBAAiB,mBAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,SAAS;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sHAAsH,QAAQ;AAC9H,oHAAoH,QAAQ;AAC5H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,6BAA6B,EAAE;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,OAAoB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,OAAoB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,WAAK;AAC/C;AACA;AACA;AACA,0BAA0B,OAAoB;AAC9C;AACA;AACA,0BAA0B,OAAoB;AAC9C;AACA;AACA;AACA;AACA,qDAAqD,iBAAiB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,wBAAwB;AAC9C;AACA;AACA;AACA;AACA,+FAA+F,iBAAiB;AAChH,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,OAAoB;AACnE;AACA;AACA;AACA;AACA;AACA,+CAA+C,OAAoB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,2BAAa;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,uBAAS,4DAA4D,QAAQ,gCAAgC,WAAW,EAAE;AACtJ,0EAA0E,mDAAmD,EAAE;AAC/H;AACA;AACA;AACA,SAAS;AACT,oFAAoF,6DAA6D,EAAE;AACnJ,sEAAsE,+CAA+C,EAAE;AACvH,sEAAsE,+CAA+C,EAAE;AACvH;AACA,gEAAgE,6BAA6B,EAAE;AAC/F,yBAAyB,aAAM;AAC/B;AACA,4CAA4C,QAAY,gEAAgE,EAAE,IAAI,aAAM;AACpI,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,sDAAsD,SAAS;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,8CAA8C,SAAS;AACvD;AACA;AACA;AACA;AACA,8CAA8C,SAAS;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,0BAAS;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,0CAA0C,OAAoB,SAAS,+EAA+E;AACtJ,iBAAiB;AACjB;AACA,0CAA0C,OAAoB,QAAQ,aAAa;AACnF,iBAAiB;AACjB;AACA,0CAA0C,OAAoB,uBAAuB,6CAA6C;AAClI,iBAAiB;AACjB;AACA,0CAA0C,OAAoB;AAC9D,iBAAiB;AACjB;AACA,0CAA0C,OAAoB;AAC9D,iBAAiB;AACjB;AACA,0CAA0C,OAAoB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,yDAAyD,OAAoB;AAC7E;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA,yDAAyD,OAAoB;AAC7E;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA,yDAAyD,OAAoB;AAC7E;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA,yDAAyD,OAAoB,qBAAqB;AAClG,iBAAiB;AACjB;AACA,yDAAyD,OAAoB,mBAAmB;AAChG,iBAAiB;AACjB;AACA,yDAAyD,OAAoB,QAAQ;AACrF;AACA;AACA;AACA,qCAAqC,kBAAkB;AACvD;AACA;AACA;AACA;AACA;AACA,uDAAuD,yCAAyC;AAChG,yDAAyD,+CAA+C;AACxG,yDAAyD,qCAAqC;AAC9F,uDAAuD,mCAAmC;AAC1F,qDAAqD,iCAAiC;AACtF,uDAAuD,mCAAmC;AAC1F,uDAAuD,mCAAmC;AAC1F,mDAAmD,+BAA+B;AAClF,uDAAuD,mCAAmC;AAC1F,wDAAwD,oCAAoC;AAC5F,qDAAqD,iCAAiC;AACtF,uBAAuB,aAAI;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAU;AACjC,QAAQ,sBAAO,IAAI,qBAAqB;AACxC,QAAQ,sBAAO,IAAI,kBAAkB;AACrC,QAAQ,sBAAO,IAAI,eAAe;AAClC,QAAQ,sBAAO,IAAI,kBAAkB;AACrC,QAAQ,sBAAO,IAAI,aAAa;AAChC,QAAQ,sBAAO,IAAI,oBAAoB;AACvC;AACA;AACA,CAAC,CAAC,UAAU;AACgB;AAC5B,IAAI,oCAAmB;AACvB,IAAI,wBAAS;AACb;AACA;AACA,uDAAuD,aAAO;AAC9D;AACA,wDAAwD,aAAO;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACmB;AAC/B,IAAI,yCAAwB;AAC5B,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA,6BAA6B,mCAAiB;AAC9C,gCAAgC,mCAAiB;AACjD,iCAAiC,mCAAiB;AAClD,qCAAqC,mCAAiB;AACtD,gCAAgC,mCAAiB;AACjD,uCAAuC,mCAAiB;AACxD,sCAAsC,mCAAiB;AACvD,yBAAyB,mCAAiB;AAC1C,yBAAyB,mCAAiB;AAC1C,4EAA4E,kCAAkC,EAAE;AAChH,8EAA8E,qCAAqC,EAAE;AACrH,0EAA0E,iCAAiC,EAAE;AAC7G,yEAAyE,iCAAiC,EAAE;AAC5G,wEAAwE,iCAAiC,EAAE;AAC3G,uEAAuE,iCAAiC,EAAE;AAC1G,oEAAoE,iCAAiC,EAAE;AACvG,4EAA4E,iCAAiC,EAAE;AAC/G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE,qBAAqB,EAAE;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACZ,IAAI,kCAAiB;AACrB,IAAI,wBAAS;AACb;AACA;AACA;AACA,wBAAwB,mCAAiB;AACzC,2CAA2C,mCAAiB;AAC5D,wCAAwC,mCAAiB;AACzD,qCAAqC,mCAAiB;AACtD,uCAAuC,mCAAiB;AACxD,2CAA2C,mCAAiB;AAC5D,2CAA2C,mCAAiB;AAC5D,kCAAkC,mCAAiB;AACnD,8CAA8C,mCAAiB;AAC/D,2CAA2C,mCAAiB;AAC5D,sCAAsC,mCAAiB;AACvD,mCAAmC,mCAAiB;AACpD,+CAA+C,mCAAiB;AAChE,wDAAwD,mCAAiB;AACzE,0CAA0C,mCAAiB;AAC3D,iCAAiC,mCAAiB;AAClD,kCAAkC,wBAAwB;AAC1D;AACA;AACA;AACA;AACA,wBAAwB,0BAAgC;AACxD,wBAAwB,0BAAgC;AACxD,wBAAwB,wBAA8B;AACtD,wBAAwB,0BAAgC;AACxD,wBAAwB,8BAAoC;AAC5D,wBAAwB,8BAAoC;AAC5D,wBAAwB,qBAA2B;AACnD,wBAAwB,iCAAuC;AAC/D,wBAAwB,8BAAoC;AAC5D,wBAAwB,yBAA+B;AACvD,wBAAwB,sBAA4B;AACpD,wBAAwB,sCAA4C;AACpE,wBAAwB,2CAAiD;AACzE,wBAAwB,6BAAmC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,0BAAgC;AAC5E,yCAAyC,0BAAgC;AACzE,sCAAsC,wBAA8B;AACpE,wCAAwC,0BAAgC;AACxE,4CAA4C,8BAAoC;AAChF,4CAA4C,8BAAoC;AAChF,mCAAmC,qBAA2B;AAC9D,+CAA+C,iCAAuC;AACtF,4CAA4C,8BAAoC;AAChF,uCAAuC,yBAA+B;AACtE,oCAAoC,sBAA4B;AAChE,2CAA2C,6BAAmC;AAC9E,gDAAgD,sCAA4C,eAAe,2CAAiD;AAC5J,yDAAyD,2CAAiD;AAC1G,uDAAuD,OAAO;AAC9D;AACA;AACA,CAAC,CAAC,UAAU;AACiB;AAC7B,IAAI,6CAA4B;AAChC,IAAI,wBAAS;AACb;AACA;AACA,8CAA8C,aAAO;AACrD;AACA;AACA,iDAAiD,UAAc;AAC/D;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,0CAA0C,iBAAiB;AAC3D;AACA,iGAAiG,oDAAoD,EAAE;AACvJ;AACA,yCAAyC,qBAAqB;AAC9D;AACA,iGAAiG,0GAA0G,EAAE;AAC7M;AACA,4CAA4C,mBAAmB;AAC/D;AACA,qGAAqG,sDAAsD,EAAE;AAC7J;AACA,2CAA2C,uBAAuB;AAClE;AACA,qGAAqG,4GAA4G,EAAE;AACnN;AACA,yCAAyC,gBAAgB;AACzD;AACA,+FAA+F,mDAAmD,EAAE;AACpJ;AACA,wCAAwC,oBAAoB;AAC5D;AACA,+FAA+F,yGAAyG,EAAE;AAC1M;AACA,yCAAyC,gBAAgB;AACzD;AACA,+FAA+F,mDAAmD,EAAE;AACpJ;AACA,wCAAwC,oBAAoB;AAC5D;AACA,+FAA+F,2GAA2G,EAAE;AAC5M;AACA,+CAA+C,4BAA4B;AAC3E;AACA,6JAA6J,+CAA+C,sBAAsB,EAAE,GAAG;AACvO;AACA,2CAA2C,2BAA2B;AACtE;AACA,gJAAgJ,qDAAqD,EAAE;AACvM;AACA,CAAC;;;;;;;;;ACv1CD;AACA;AACA;AACA;AACA,IAAI,YAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACmB;AAC+C;AACzB;AACgB;AACR;AACE;AACK;AACN;AACsG;AAC/G;AAC1C;AACA,IAAI,SAAI;AACR,IAAI,YAAS;AACb;AACA,iCAAiC,cAAc;AAC/C;AACA;AACA,2DAA2D,aAAO;AAClE;AACA,gDAAgD,aAAO;AACvD;AACA,iDAAiD,aAAO;AACxD;AACA,gDAAgD,aAAO;AACvD;AACA,8CAA8C,aAAO;AACrD;AACA;AACA;AACA;AACA,mBAAmB,MAAM,YAAY,CAAC;AACtC,YAAY,+BAAW;AACvB,YAAY,QAAQ;AACpB;AACA,wBAAwB,QAAQ;AAChC,wBAAwB,QAAQ;AAChC,QAAQ,aAAO;AACf,wBAAwB,QAAQ,WAAW,eAAS;AACpD,YAAY,MAAM;AAClB;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,WAAW;AACnB;AACA;AACA;AACA,0BAA0B,oBAAoB,EAAE;AAChD;AACA;AACA;AACA;AACA,YAAY,WAAW;AACvB,YAAY,WAAW;AACvB,YAAY,WAAW;AACvB;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,0BAA0B,kCAAkC,EAAE;AAC9D;AACA,kDAAkD,iBAAO;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,0BAA0B,gCAAgC,EAAE;AAC5D;AACA,gDAAgD,iBAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,WAAW;AACvB;AACA;AACA,YAAY,WAAW;AACvB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,WAAW;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,oBAAoB;AAC1C,6CAA6C,uBAAuB;AACpE;AACA,gDAAgD;AAChD;AACA,iCAAiC,6BAAkB;AACnD;AACA;AACA;AACA,0BAA0B;AAC1B,QAAQ,QAAQ;AAChB;AACA;AACA,oBAAoB,gBAAgB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,+BAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,+BAAW;AACxC;AACA;AACA,kCAAkC,mCAAmC,EAAE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,WAAW;AACvB,qCAAqC,6BAAkB;AACvD,yBAAyB;AACzB;AACA;AACA;AACA,YAAY,WAAW;AACvB;AACA,YAAY,WAAW;AACvB;AACA,YAAY,iBAAO;AACnB,0BAA0B,oBAAoB;AAC9C,iDAAiD,uBAAuB;AACxE;AACA;AACA;AACA;AACA,QAAQ,QAAQ;AAChB,QAAQ,QAAQ;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,WAAW;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,uBAAuB,qBAAqB,UAAU,eAAS;AAC/D,gBAAgB,QAAc,iBAAiB,QAAc;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT,uBAAuB,qBAAqB,UAAU,eAAS;AAC/D;AACA,YAAY,iBAAO;AACnB,SAAS;AACT;AACA;AACA,mBAAmB,MAAM;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,WAAW;AACnB;AACA;AACA,QAAQ,WAAW;AACnB;AACA;AACA;AACA,8CAA8C,iBAAO;AACrD,4CAA4C,iBAAO;AACnD;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA,CAAC,CAAC,UAAU;AACI;;;ACtThB;AACA;AACA;AACA;AAC2D;AAC3D,IAAI,uBAAW;AACf;AACA;AACA;AACA;AACA,0CAA0C,MAAc,GAAG,EAAE,EAAE,EAAE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;;;;;;;;;AC1EnC;AACA;AACA;AACA;AACA,IAAI,iBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACwB;AAC+B;AACd;AACyB;AACD;AAC9B;AACc;AACE;AACW;AACZ;AACnD,IAAI,wBAAc;AAClB,IAAI,iBAAS;AACb;AACA;AACA;AACA;AACA;AACA,8BAA8B,cAAM;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,aAAO;AACf;AACA;AACA;AACA;AACA,uBAAuB,qBAAyB,eAAe,eAAS,oBAAoB,yBAAyB,EAAE;AACvH,uBAAuB,qBAAyB,eAAe,SAAa;AAC5E;AACA,gBAAgB,WAAe,eAAe;AAC9C;AACA;AACA;AACA,gBAAgB,QAAY;AAC5B;AACA,SAAS;AACT,uBAAuB,qBAAyB,eAAe,SAAa;AAC5E,YAAY,WAAe;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,gCAAqB,cAAc,yBAAyB,EAAE;AAC9E;AACA,SAAS;AACT,uBAAuB,qBAAyB,eAAe,SAAa;AAC5E,YAAY,WAAe;AAC3B,SAAS;AACT,SAAS,SAAa,WAAW,SAAa;AAC9C,4BAA4B,qBAAyB;AACrD,gBAAgB,WAAe;AAC/B,gBAAgB,WAAe;AAC/B,aAAa;AACb,SAAS;AACT;AACA;AACA,QAAQ,WAAe;AACvB;AACA,YAAY,iBAAuB;AACnC;AACA;AACA;AACA;AACA,gBAAgB,QAAc;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,QAAY;AACxB;AACA;AACA;AACA;AACA;AACA,YAAY,WAAe;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,UAAc;AAC1B;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACc;AAC1B;AACA,IAAI,iBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,cAAM;AACa;AACrB,IAAI,oBAAU;AACd,IAAI,iBAAS;AACb;AACA,iCAAiC,cAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,MAAU,eAAe,CAAK;AACnD;AACA,4DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,MAAU,eAAe,CAAK;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,QAAY,EAAE,oEAAoE,IAAI,EAAE,GAAG,EAAE;AACrH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,aAAiB;AAC7B;AACA;AACA;AACA,YAAY,QAAY;AACxB;AACA,gBAAgB,UAAc;AAC9B;AACA;AACA;AACA;AACA,YAAY,WAAe;AAC3B;AACA;AACA;AACA;AACA;AACA,YAAY,WAAe;AAC3B,YAAY,WAAe;AAC3B;AACA;AACA;AACA;AACA,YAAY,QAAY;AACxB,YAAY,QAAY;AACxB,YAAY,4BAAgC;AAC5C;AACA;AACA;AACA;AACA,YAAY,QAAY;AACxB;AACA;AACA,YAAY,WAAe;AAC3B;AACA;AACA;AACA,CAAC,CAAC,wBAAc;AACM;AACtB,IAAI,wBAAc;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,mBAAS;AACb,IAAI,iBAAS;AACb;AACA,iCAAiC,WAAW,wBAAc,CAAC;AAC3D;AACA,+CAA+C,aAAO;AACtD,iDAAiD,aAAO;AACxD,8CAA8C,aAAO;AACrD,oDAAoD,aAAO;AAC3D;AACA;AACA;AACA;AACA,wCAAwC,wBAAc;AACtD;AACA;AACA,sCAAsC,oBAAY;AAClD;AACA;AACA,mEAAmE,gCAAgC,EAAE;AACrG,yEAAyE,sCAAsC,EAAE;AACjH;AACA;AACA;AACA;AACA;AACA,YAAY,QAAY;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,qBAAyB,gBAAgB,SAAa;AAC9E,4BAA4B,mCAAqB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,wBAAwB,qBAAyB,gBAAgB,SAAa;AAC9E,4BAA4B,mCAAqB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,6CAA6C,UAAc;AAC3D;AACA,6DAA6D,UAAc;AAC3E;AACA;AACA;AACA,SAAS;AACT,mEAAmE,kCAAkC,EAAE;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8BAA8B,EAAE;AAC1D;AACA;AACA,KAAK;AACL;AACA,0BAA0B,gCAAgC,EAAE;AAC5D;AACA;AACA,KAAK;AACL;AACA,0BAA0B,6BAA6B,EAAE;AACzD;AACA;AACA,KAAK;AACL;AACA,0BAA0B,mCAAmC,EAAE;AAC/D;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,uBAAuB,sCAAsC;AAC7D;AACA,gBAAgB,UAAc;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,6CAA6C,oCAAoC,EAAE;AACnF,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iCAAiC,cAAc;AAC/C;AACA,oBAAoB,QAAc;AAClC;AACA;AACA;AACA;AACA;AACA,4BAA4B,qBAAyB,oBAAoB,SAAa;AACtF;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,2BAA2B,oBAAU;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,qBAAqB,iBAAO;AAC5B,QAAQ,SAAa;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA,oBAAoB,UAAgB;AACpC,kDAAkD,UAAgB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,UAAgB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA,kCAAkC,wBAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAO;AACnB;AACA;AACA,QAAQ,UAAc;AACtB;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACS;;;ACvlBrB;AACA;AACA;AACA;AACA,IAAI,kBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC+B;AACO;AACa;AACqB;AACG;AACmB;AACtC;AACM;AACJ;AACiB;AACN;AACT;AACJ;AACoB;AACoC;AACrC;AACO;AACD;AACU;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,qBAAU;AACd,IAAI,kBAAS;AACb;AACA;AACA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA,mCAAmC,iBAAiB;AACpD;AACA,+CAA+C,mBAAS;AACxD,kCAAkC,cAAM,qBAAqB,QAAY;AACzE;AACA;AACA,SAAS,IAAI,2BAA2B;AACxC,wBAAwB,iBAAiB;AACzC;AACA,yBAAyB,iBAAiB;AAC1C;AACA,8CAA8C,oBAAoB,2BAA2B;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT,wBAAwB,6BAAiC;AACzD;AACA,sBAAsB,mBAAuB;AAC7C;AACA;AACA;AACA,SAAS;AACT,wBAAwB,6BAAiC;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,QAAQ;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,QAAQ;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,QAAQ;AACrD,gDAAgD,QAAQ;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,SAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,2BAAa;AACrB;AACA;AACA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,QAAY;AACnC;AACA;AACA,uBAAuB,QAAY;AACnC;AACA;AACA,uBAAuB,QAAY,iBAAiB,EAAE;AACtD;AACA;AACA;AACA;AACA,0CAA0C,QAAY;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,eAAe,EAAE,KAAK,EAAE,YAAY,EAAE,GAAG,EAAE,YAAY,EAAE,GAAG,EAAE;AACvE;AACA;AACA;AACA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,SAAa;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,UAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA,sCAAsC,MAAM;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,QAAY;AAC1C;AACA;AACA;AACA;AACA,gCAAgC,QAAY,yBAAyB,EAAE,YAAY,EAAE,GAAG,EAAE;AAC1F;AACA;AACA,gCAAgC,QAAY,4BAA4B,EAAE,GAAG,EAAE;AAC/E;AACA;AACA,gCAAgC,QAAY,4BAA4B,EAAE,GAAG,EAAE;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,qBAAU;AACvC,2BAA2B,+BAAqB;AAChD,0BAA0B,+BAAqB;AAC/C,gBAAgB,eAAc,KAAK,gCAAe;AAClD;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACU;AACtB;AACA,0BAA0B;AAC1B,qCAAqC,iBAAiB;AACtD;AACA,yEAAyE,4BAA4B,EAAE;AACvG;AACA,gCAAgC,eAAe;AAC/C;AACA,oEAAoE,kDAAkD,EAAE;AACxH;AACA,CAAC;AACD,IAAI,yBAAc;AAClB,IAAI,kBAAS;AACb;AACA;AACA;AACA,mBAAmB,QAAY;AAC/B;AACA,0BAA0B,yBAAc;AACxC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,6BAAY;AACd,IAAI,yBAAc;AAClB,IAAI,kBAAS;AACb;AACA;AACA;AACA,mBAAmB,QAAY;AAC/B;AACA,0BAA0B,yBAAc;AACxC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,6BAAY;AACd;AACA,yCAAyC,kBAAkB;AAC3D;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,CAAC,yBAAc;AACnC,oBAAoB,CAAC,yBAAc;;;AC3rBnC;AACA;AACA;AACA;AACA,IAAI,wBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,yBAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,sBAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AACgC;AACO;AACa;AACqB;AACZ;AACI;AACT;AACO;AACJ;AACA;AACM;AACK;AACb;AACZ;AACyB;AACnB;AACsB;AACZ;AACY;AACW;AACP;AACD;AACkB;AACA;AACP;AACS;AACA;AACH;AAC6G;AACzE;AACjI,IAAI,kCAAiB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,uCAAuC,EAAE;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,cAAc;AAC7E;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,uBAAuB;AACtE;AACA;AACA,2DAA2D,cAAc;AACzE;AACA;AACA;AACA;AACA,mEAAmE,cAAc;AACjF;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,IAAI,iCAAgB;AACpB,IAAI,wBAAS;AACb;AACA;AACA,kDAAkD,aAAO;AACzD;AACA,qDAAqD,aAAO;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,gBAAgB,cAAc,mCAAmC,EAAE;AAChI;AACA;AACA;AACA;AACA;AACA,4CAA4C,iBAAiB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6BAAiC;AACzD;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,kCAAiB;AAC1D,yCAAyC,kCAAiB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,iBAAiB;AAChD,yBAAyB,kBAAkB;AAC3C;AACA;AACA;AACA,gCAAgC,iBAAiB;AACjD,0BAA0B,kBAAkB;AAC5C;AACA;AACA;AACA,gCAAgC,qBAAU;AAC1C;AACA;AACA;AACA;AACA,4EAA4E,wCAAwC,EAAE;AACtH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0CAAyB;AAC5D;AACA;AACA,mCAAmC,sCAAqB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,eAAe,UAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,oBAAoB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,mDAAmD,iCAAgB,wBAAwB;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,UAAuB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,0CAAyB;AAC/D;AACA;AACA,sCAAsC,sCAAqB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE,gDAAgD,gCAAgC;AAChF,0CAA0C,yBAAyB;AACnE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA,oCAAoC,6BAA6B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,wCAAwC,EAAE;AACvH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,QAAY;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,SAAiB,cAAc;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,eAA6B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,iEAAiE;AACrG,oCAAoC,6HAA6H;AACjK;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oGAAoG,2CAA2C,EAAE;AACjJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oGAAoG,2CAA2C,EAAE;AACjJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD,uBAAuB,yBAAU;AACjC,QAAQ,sBAAO,IAAI,oBAAoB;AACvC,QAAQ,sBAAO,IAAI,kBAAkB;AACrC,QAAQ,sBAAO,IAAI,qBAAqB;AACxC,QAAQ,sBAAO,IAAI,kBAAkB;AACrC,QAAQ,sBAAO,IAAI,aAAa;AAChC,QAAQ,sBAAO,IAAI,oBAAoB;AACvC;AACA;AACA,CAAC,CAAC,UAAU;AACgB;AAC5B,IAAI,sCAAqB;AACzB,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,YAAY,KAAK,kBAAkB;AAChF,6CAA6C,WAAW,KAAK,kBAAkB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,eAAe;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,mBAAmB,WAAK;AACxB;AACA;AACA;AACA;AACA,gBAAgB,sBAAsB;AACtC;AACA,KAAK;AACL,yBAAyB,sBAAsB;AAC/C;AACA;AACA,KAAK;AACL,gBAAgB,sBAAsB;AACtC;AACA,KAAK;AACL,yBAAyB,sBAAsB;AAC/C;AACA;AACA,KAAK;AACL,gBAAgB,sBAAsB;AACtC;AACA;AACA;AACA,KAAK;AACL,wBAAwB,sBAAsB;AAC9C;AACA;AACA;AACA;AACA,KAAK;AACL,gBAAgB,sBAAsB;AACtC;AACA;AACA;AACA,KAAK;AACL,wBAAwB,sBAAsB;AAC9C;AACA;AACA;AACA;AACA,KAAK;AACL,sBAAsB,sBAAsB;AAC5C;AACA,KAAK;AACL;AACA,IAAI,0CAAyB;AAC7B,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAI;AAC9C;AACA;AACA;AACA,4CAA4C,gCAAgC,EAAE;AAC9E,8CAA8C,4BAA4B,EAAE;AAC5E,0CAA0C,8BAA8B,EAAE;AAC1E,4CAA4C,4BAA4B,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,6BAA6B;AAChE;AACA,+BAA+B,iCAAgB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,iCAAgB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,cAAc;AACpE;AACA;AACA;AACA,+BAA+B,WAAK;AACpC;AACA,iBAAiB;AACjB;AACA;AACA;AACA,8CAA8C,iBAAiB;AAC/D;AACA,4EAA4E,aAAa;AACzF;AACA;AACA;AACA,yFAAyF,gDAAgD;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,cAAc;AACpE;AACA;AACA;AACA,+BAA+B,WAAK;AACpC;AACA,iBAAiB;AACjB;AACA;AACA;AACA,8CAA8C,iBAAiB;AAC/D;AACA,4EAA4E,aAAa;AACzF;AACA;AACA;AACA,yFAAyF,gDAAgD;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,sCAAqB;AACvB;AACA,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,sCAAqB;AACzB,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,wCAAuB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,cAAc;AACpE;AACA;AACA;AACA;AACA,+BAA+B,WAAK;AACpC;AACA,iBAAiB;AACjB,8CAA8C,iBAAiB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,cAAc;AACpE;AACA;AACA;AACA;AACA,+BAA+B,WAAK;AACpC;AACA,iBAAiB;AACjB,8CAA8C,iBAAiB;AAC/D;AACA,4EAA4E,aAAa;AACzF;AACA;AACA;AACA,yFAAyF,gDAAgD;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,sCAAqB;AACvB,IAAI,wCAAuB;AAC3B,IAAI,wBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,aAAa;AACjF;AACA;AACA,yCAAyC,gBAAgB,KAAK,WAAK;AACnE;AACA;AACA;AACA,iBAAiB,mBAAmB;AACpC;AACA;AACA;AACA;AACA;AACA,iEAAiE,gDAAgD;AACjH;AACA;AACA;AACA;AACA,0EAA0E,iCAAiC,qCAAqC,4BAA4B,QAAQ;AACpL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,2BAAa;AACrB;AACA;AACA;AACA,QAAQ,2BAAa;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,cAAc;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,gBAAgB;AACjD,2BAA2B,+BAAqB;AAChD,0BAA0B,+BAAqB;AAC/C,qBAAqB,cAAc,KAAK,gCAAe;AACvD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,+BAA+B,YAAY;AAC3C;AACA,qFAAqF,iCAAiC,EAAE;AACxH,+FAA+F,iCAAiC,EAAE;AAClI,0EAA0E,iCAAiC,EAAE;AAC7G;AACA,iCAAiC,WAAW;AAC5C;AACA,qFAAqF,mCAAmC,EAAE;AAC1H,+FAA+F,mCAAmC,EAAE;AACpI,4EAA4E,mCAAmC,EAAE;AACjH;AACA,sCAAsC,mBAAmB;AACzD;AACA,qFAAqF,qFAAqF,EAAE;AAC5K;AACA,wCAAwC,kBAAkB;AAC1D;AACA,qFAAqF,uFAAuF,EAAE;AAC9K;AACA,gCAAgC,eAAe;AAC/C;AACA,8EAA8E,4CAA4C,EAAE;AAC5H;AACA,gCAAgC,UAAU;AAC1C;AACA,8EAA8E,uCAAuC,EAAE;AACvH;AACA,CAAC;;;AC5kDD;AACA;AACA;AACA;AAC0F;AACnF,8BAA8B,eAAe;;;ACLpD;AACA;AACA;AACA;AAC8E;AACvE,0BAA0B,eAAe;AACzC,0BAA0B,eAAe;;;ACNhD;AACA;AACA;AACA;AAC8E;AACvE,yBAAyB,eAAe;;;ACL/C;AACA;AACA;AACA;AACA,IAAI,4BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,6BAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,0BAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AACuC;AACqB;AACE;AACmC;AAChB;AACL;AACA;AACR;AACgB;AACQ;AACd;AACK;AACe;AACF;AACO;AACZ;AACK;AACT;AACM;AACd;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,gBAAqB;AACzB;AACA;AACA;AACA;AACA,IAAI,yCAAoB;AACxB,IAAI,4BAAS;AACb;AACA;AACA;AACA,iDAAiD,QAAY;AAC7D,kDAAkD,KAAK,IAAY;AACnE,cAAc,QAAY;AAC1B,cAAc,QAAY;AAC1B,yDAAyD;AACzD,yCAAyC,0CAA2B;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,yBAAc;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,UAAU;AAC7B;AACA;AACA;AACA;AACA,2BAA2B,yBAAc,KAAK,yBAAc,mCAAmC,yBAAc;AAC7G;AACA,8BAA8B,yBAAc,mBAAmB,yBAAc;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,2BAA2B,YAAY,gBAAgB,MAAM;AAC7D;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,iCAAiC,oBAAoB;AACrD;AACA;AACA,uBAAuB,YAAY;AACnC;AACA,SAAS;AACT,eAAe,kBAAkB;AACjC;AACA,2BAA2B,6BAAU;AACrC,QAAQ,0BAAO,IAAI,qBAAqB;AACxC,QAAQ,0BAAO,IAAI,kBAAkB;AACrC,QAAQ,0BAAO,IAAI,eAAe;AAClC,QAAQ,0BAAO,IAAI,kBAAkB;AACrC,QAAQ,0BAAO,IAAI,kBAAkB;AACrC,QAAQ,0BAAO,IAAI,aAAa;AAChC,QAAQ,0BAAO,IAAI,oBAAoB;AACvC;AACA;AACA,CAAC,CAAC,iCAAgB;AACc;AAChC,IAAI,qCAAgB;AACpB,IAAI,4BAAS;AACb;AACA;AACA,QAAQ,wBAAwB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,wBAAwB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAAU;AACjC,QAAQ,0BAAO,IAAI,qBAAqB;AACxC,QAAQ,0BAAO,IAAI,kBAAkB;AACrC,QAAQ,0BAAO,IAAI,eAAe;AAClC,QAAQ,0BAAO,IAAI,kBAAkB;AACrC,QAAQ,0BAAO,IAAI,kBAAkB;AACrC,QAAQ,0BAAO,IAAI,mBAAmB;AACtC,QAAQ,0BAAO,IAAI,uBAAuB;AAC1C,QAAQ,0BAAO,KAAK,oBAAoB;AACxC,QAAQ,0BAAO,KAAK,qBAAqB;AACzC;AACA;AACA,CAAC,CAAC,yCAAoB;AACM;AAC5B,IAAI,yCAAoB;AACxB,IAAI,4BAAS;AACb;AACA;AACA,QAAQ,wBAAwB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,wBAAwB;AAChC;AACA;AACA;AACA,mDAAmD,yCAAoB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAAU;AACrC,QAAQ,0BAAO,IAAI,qBAAqB;AACxC,QAAQ,0BAAO,IAAI,kBAAkB;AACrC,QAAQ,0BAAO,IAAI,kBAAkB;AACrC,QAAQ,0BAAO,IAAI,mBAAmB;AACtC,QAAQ,0BAAO,IAAI,oBAAoB;AACvC,QAAQ,0BAAO,IAAI,kBAAkB;AACrC,QAAQ,0BAAO,IAAI,uBAAuB;AAC1C,QAAQ,0BAAO,KAAK,oBAAoB;AACxC,QAAQ,0BAAO,KAAK,qBAAqB;AACzC;AACA;AACA,CAAC,CAAC,iCAAgB;AACc;;;ACnRhC;AACA;AACA;AACA;AAC0F;AACnF,uBAAuB,eAAe;;;ACL7C;AACA;AACA;AACA;AAC0F;AACnF,mBAAmB,eAAe;;;ACLzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;;;ACb5B;AACA;AACA;AACA;AACoC;AACI;AACN;AAC3B;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACO;AACP,qCAAqC,yBAAyB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qFAAqF,SAAS;AAC9F;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,QAAQ;AACjD;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA,6EAA6E;AAC7E,oBAAoB,UAAK;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,QAAgB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,iBAAyB;AACjC;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACxJA;AACA;AACA;AACA;AACuC;AACiB;AACP;AACkC;AACV;AACzE;AACO,IAAI,wBAAU;AACrB;AACA;AACA,IAAI,iCAAmB;AACvB;AACA,sCAAsC,aAAO;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;AACxB,wBAAwB,iCAAmB;AAClD,QAAQ,KAAK,wBAAU;AAChB;AACA,wCAAwC,kBAAkB;AACjE;AACA;AACA;AACA,cAAc,QAAY;AAC1B;AACA,CAAC;AACD,6BAA6B;AAC7B;AACA;AACA;AACA,WAAW,KAAK;AAChB;AACA,CAAC;;;AC9CD;AACA;AACA;AACA;AACA,IAAI,yBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACkE;AACX;AACO;AACV;AACM;AACV;AACS;AACoB;AACe;AACpB;AACzE,IAAI,gCAAc;AAClB,IAAI,mCAAiB;AACrB,IAAI,yBAAS;AACb;AACA,0CAA0C,yBAAyB;AACnE,yCAAyC,yBAAyB;AAClE;AACA,iDAAiD,aAAO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,aAAa;AAClD,4BAA4B,aAAa,iCAAiC,oCAAoC,EAAE;AAChH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb,SAAS;AACT,QAAQ,QAAQ,IAAI,gCAAU,4CAA4C,aAAa,yCAAyC,oBAAoB,EAAE;AACtJ;AACA;AACA;AACA;AACA;AACA,YAAY,gCAAc;AAC1B;AACA;AACA;AACA;AACA;AACA,gCAAgC,kBAAkB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,gBAAgB;AAClE;AACA,gBAAgB,gBAAqB,EAAE,sDAAsD;AAC7F;AACA;AACA;AACA;AACA,iDAAiD,gBAAgB;AACjE;AACA,gBAAgB,gBAAqB,EAAE,oDAAoD;AAC3F;AACA;AACA;AACA;AACA,wDAAwD,gBAAgB;AACxE;AACA,gBAAgB,gBAAqB,EAAE,8DAA8D;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,wBAAgC;AACrD,oBAAoB,gBAAqB,EAAE,2DAA2D;AACtG;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,wBAAwB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gCAAc;AAC1B;AACA;AACA;AACA,eAAe,gCAAc;AAC7B;AACA;AACA,aAAa,gCAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,4BAA4B,EAAE;AACvE;AACA,gBAAgB,gCAAc;AAC9B;AACA;AACA;AACA,SAAS;AACT;AACA,mBAAmB,gCAAc;AACjC,SAAS;AACT;AACA;AACA,wBAAwB,YAAY;AACpC,mBAAmB,wBAAwB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,gCAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,cAAmB;AAC3C;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACiB;;;AChP7B;AACA;AACA;AACA;AACA,IAAI,uBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACuD;AACO;AACH;AACI;AACL;AAC3D,IAAI,iCAAiB;AACrB,IAAI,uBAAS;AACb;AACA;AACA,iDAAiD,aAAO;AACxD;AACA;AACA;AACA,6DAA6D,0BAA0B,EAAE;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACZ,IAAI,+BAAe;AACnB;AACA,yCAAyC,yBAAyB;AAClE;AACA,oCAAoC,aAAO;AAC3C;AACA,4CAA4C,aAAO;AACnD;AACA;AACA,6BAA6B,mCAAiB;AAC9C,gDAAgD,8CAA8C,EAAE;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,iCAAiB;AACpC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,mBAAmB,iCAAiB;AACpC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,sFAAsF,wBAAwB;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2EAA2E,wBAAwB;AACnG,kDAAkD,gBAAgB;AAClE;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;ACnH3B;AACA;AACA;AACA;AACqC;AACrC;AACA;AACA,+BAA+B,YAAY;AAC3C;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AACnB;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,oCAAoC;AACpC;;;ACpFA;AACA;AACA;AACA;AAC8E;AACnC;AACa;AACjD,IAAI,sBAAc;AACzB;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,sBAAc,KAAK,sBAAc,KAAK;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD,8CAA8C,QAAQ;AACtD,2CAA2C,QAAQ;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,eAAQ;AACzB,iBAAiB,eAAQ;AACzB,iBAAiB,eAAQ;AACzB,iBAAiB,eAAQ;AACzB;AACA;AACA;AACA,CAAC,EAAE,sBAAc,KAAK,sBAAc,KAAK;AAClC;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,sBAAc;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,kCAAkC;AAC5B,qBAAqB,eAAe;;;AC/F3C;AACA;AACA;AACA;AACA,IAAI,wBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,yBAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,sBAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AACuC;AACyB;AACR;AACa;AACG;AACb;AACF;AACI;AACM;AAC1B;AACO;AACE;AACwB;AACE;AACiC;AACb;AACH;AACX;AAClF,SAAS,yBAAQ;AACjB;AACA;AACA,IAAI,0BAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,6BAA6B,EAAE;AACvG,+EAA+E,sCAAsC,EAAE;AACvH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,iBAAO;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2FAA2F,kEAAkE,EAAE;AAC/J;AACA;AACA;AACA,CAAC;AACD,IAAI,mCAAkB;AACtB;AACA;AACA;AACA;AACA,0CAA0C,2CAA2C;AACrF;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,kBAAkB,WAAK;AACvB,mCAAmC,sBAAc;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,WAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,WAAK;AACnC;AACA;AACA;AACA,8BAA8B,WAAK;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,WAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,sBAAc;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,sBAAc;AAC/B;AACA,wBAAwB,gBAAgB,CAAC,oBAAoB;AAC7D;AACA;AACA,iBAAiB,sBAAc;AAC/B;AACA,wBAAwB,gBAAgB,CAAC,iBAAiB;AAC1D;AACA;AACA,iBAAiB,sBAAc;AAC/B;AACA;AACA,wBAAwB,gBAAgB,CAAC,kBAAkB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,QAAY,qCAAqC,EAAE,IAAI,EAAE,GAAG,EAAE;AAChG;AACA;AACA,kCAAkC,QAAY,8BAA8B,EAAE,IAAI,EAAE;AACpF;AACA;AACA;AACA;AACA,kCAAkC,QAAY,4BAA4B,EAAE,GAAG,EAAE,GAAG,EAAE;AACtF;AACA;AACA,kCAAkC,QAAY,qBAAqB,EAAE,GAAG,EAAE;AAC1E;AACA;AACA;AACA,+BAA+B,cAAc;AAC7C,iBAAiB,cAAc;AAC/B;AACA,yDAAyD,gBAAgB;AACzE;AACA,wDAAwD,cAAQ;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,uBAAiB;AAC3C,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,mBAAmB,2BAAgB,IAAI,+BAAoB;AAC3D,IAAI,iCAAgB;AACpB,IAAI,wBAAS;AACb;AACA;AACA,kDAAkD,aAAO;AACzD;AACA,oDAAoD,aAAO;AAC3D;AACA,wDAAwD,aAAO;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qHAAqH,oCAAoC,EAAE;AAC3J;AACA;AACA;AACA;AACA,sBAAsB,qBAAqB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,qBAAqB;AACtD;AACA;AACA;AACA,gCAAgC,qBAAqB;AACrD;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,mDAAmD;AAC3H;AACA,kEAAkE,2BAA2B;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,yBAAQ;AAClC;AACA;AACA;AACA;AACA,YAAY,mCAAkB;AAC9B,SAAS;AACT;AACA;AACA;AACA;AACA,iCAAiC,OAAe;AAChD,oCAAoC,OAAe;AACnD,oCAAoC,OAAe;AACnD;AACA,0CAA0C,sBAAsB,yBAAyB,qBAAqB,EAAE,4BAA4B,wDAAwD,EAAE;AACtM;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mBAAS;AACjC,sBAAsB,yBAAQ;AAC9B;AACA;AACA;AACA;AACA,4BAA4B,0BAAS,0BAA0B,oCAAoC,EAAE,uBAAuB,6CAA6C,EAAE;AAC3K;AACA;AACA;AACA;AACA,2CAA2C,2BAA2B;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,6BAA6B;AAClF;AACA;AACA;AACA,YAAY,mCAAkB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,yBAAQ;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,yBAAQ;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,yBAAQ;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,qCAAqC;AAC5E;AACA,uBAAuB,yBAAU;AACjC,QAAQ,sBAAO,IAAI,cAAc;AACjC,QAAQ,sBAAO,IAAI,qBAAqB;AACxC,QAAQ,sBAAO,IAAI,8BAA8B;AACjD;AACA;AACA,CAAC,CAAC,UAAU;AACgB;;;ACvc5B;AACA;AACA;AACA;AACA,IAAI,iCAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACuD;AACO;AAC/D,IAAI,mDAAyB;AAC7B,IAAI,iCAAS;AACb;AACA;AACA,qDAAqD,aAAO;AAC5D;AACA,wDAAwD,aAAO;AAC/D,qDAAqD,aAAO;AAC5D,wDAAwD,aAAO;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,+BAA+B,EAAE;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,+BAA+B,EAAE;AAClG;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACyB;;;AC3ErC;AACA;AACA;AACA;AACA,IAAI,6BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,8BAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,2BAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AACoD;AACsB;AACf;AACT;AACyB;AACf;AACF;AACqB;AAC/E,IAAI,2CAAqB;AACzB,IAAI,6BAAS;AACb;AACA,oCAAoC,cAAc,gBAAoB,GAAG;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mDAA6B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,kCAAkC,EAAE;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8BAAU;AACtC,QAAQ,2BAAO,IAAI,aAAa;AAChC;AACA;AACA,CAAC,CAAC,mDAAyB;AACM;AACjC;AACA;AACA;AACA;AACA,uCAAuC,wCAAkB;AACzD,sCAAsC,wCAAkB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,mDAA6B;AACjC;AACA;AACA;AACA;AACA;AACA,4BAA4B,wCAAkB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,wCAAkB;AAC9C;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,uBAAiB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,iBAAU;AACtC;AACA;AACA,CAAC;AACD;AACA,mBAAmB,EAAE,YAAY;AACjC,uBAAuB,GAAG,sBAAsB;AAChD,wCAAwC,GAAG;AAC3C,uBAAuB,GAAG;AAC1B,kCAAkC,GAAG;AACrC,kCAAkC,GAAG;AACrC,kCAAkC,GAAG;AACrC,qBAAqB,GAAG;AACxB,gCAAgC,GAAG;AACnC,kCAAkC,GAAG;AACrC,oCAAoC,GAAG;AACvC,gCAAgC,GAAG;AACnC,gCAAgC,GAAG;AACnC,4BAA4B,GAAG;AAC/B,8BAA8B,GAAG;AACjC,sCAAsC,GAAG;AACzC,qBAAqB,GAAG;AACxB,oCAAoC,GAAG;AACvC,uCAAuC,EAAE,4BAA4B;AACrE,sCAAsC,GAAG;AACzC,6BAA6B,EAAE,GAAG;AAClC,qCAAqC,EAAE,IAAI;AAC3C,qBAAqB,GAAG;AACxB,mBAAmB,GAAG;AACtB,qBAAqB,GAAG;AACxB;AACA,IAAI,wCAAkB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,oBAAoB;AAC7E;AACA;AACA;AACA,iEAAiE,iBAAiB;AAClF;AACA;AACA;AACA,+GAA+G,gBAAgB;AAC/H;AACA;AACA;AACA;AACA;AACA,QAAQ,gCAAoC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,MAAc,2BAA2B,OAAG;AAChF;AACA;AACA,oCAAoC,MAAc,2BAA2B,OAAG;AAChF;AACA;AACA;AACA,mEAAmE;AACnE;AACA,gCAAgC,MAAc;AAC9C;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,MAAc,0BAA0B,OAAG;AAC3E;AACA;AACA,gCAAgC,MAAc,0BAA0B,OAAG;AAC3E;AACA;AACA,gCAAgC,MAAc;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,MAAc,yBAAyB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,0BAA0B;AAC7E;AACA;AACA;AACA,gCAAgC,MAAc;AAC9C;AACA;AACA;AACA;AACA;AACA,YAAY,YAAY;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AC7bD;AACA;AACA;AACA;AACA,IAAI,iCAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACiE;AACR;AAC8B;AACxF,IAAI,yDAA+B;AACnC,IAAI,iCAAS;AACb;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,OAAO,oBAAoB,OAAO;AACjE;AACA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,2CAAqB;AACoB;;;ACzE3C;AACA;AACA;AACA;AACyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,wCAAwC,SAAS;AACjD;AACA;AACA;AACA;AACA;AACA,mDAAmD,UAAU;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAQ;AAC/B;AACA,6DAA6D,iCAAiC;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,SAAS;AAC3D;AACA;AACA;AACA;AACA;AACA,mCAAmC,EAAE,cAAc,EAAE;AACrD,IAAI,qBAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,KAAK;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACtB;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AACrB;AACP;AACA,0CAA0C,SAAS;AACnD;AACA,mCAAmC,sBAAsB,EAAE;AAC3D;AACA,uBAAuB,oBAAoB,EAAE;AAC7C,uBAAuB,mBAAmB,EAAE;AAC5C,uBAAuB,4BAA4B,gCAAgC,EAAE;AACrF;AACA;;;AC3RA;AACA;AACA;AACA;AACA,IAAI,QAAE,EAAE,QAAE,EAAE,QAAE;AAC0F;AACgD;AACxJ;AACO;AACP;AACA;AACA;AACA,SAAS,wDAAwD;AACjE,SAAS,yCAAyC;AAClD,SAAS,yCAAyC;AAClD,SAAS,qCAAqC;AAC9C,SAAS,0CAA0C;AACnD,SAAS,qDAAqD;AAC9D,SAAS,0CAA0C;AACnD,SAAS,yCAAyC;AAClD,SAAS,wCAAwC;AACjD,SAAS,4CAA4C;AACrD,SAAS,wCAAwC;AACjD,SAAS,4CAA4C;AACrD,SAAS,sCAAsC;AAC/C,SAAS,2CAA2C;AACpD,SAAS,gDAAgD;AACzD,SAAS,+CAA+C;AACxD,SAAS,qCAAqC;AAC9C,SAAS,4CAA4C;AACrD,SAAS,+CAA+C;AACxD,SAAS,2CAA2C;AACpD,SAAS,yCAAyC;AAClD,SAAS,sDAAsD;AAC/D,SAAS,8CAA8C;AACvD,SAAS,6CAA6C;AACtD,SAAS,0CAA0C;AACnD,SAAS,qCAAqC;AAC9C,SAAS,iDAAiD;AAC1D,SAAS,mDAAmD;AAC5D,SAAS,gDAAgD;AACzD,SAAS,iDAAiD;AAC1D,SAAS,wDAAwD;AACjE,SAAS,sDAAsD;AAC/D,SAAS,sDAAsD;AAC/D,SAAS,qDAAqD;AAC9D,SAAS,wCAAwC;AACjD,SAAS,6CAA6C;AACtD,SAAS,4CAA4C;AACrD,SAAS,6CAA6C;AACtD,SAAS,yCAAyC;AAClD,SAAS,8CAA8C;AACvD,SAAS,8CAA8C;AACvD,SAAS,mDAAmD;AAC5D,SAAS,+CAA+C;AACxD,SAAS,8CAA8C;AACvD,SAAS,gDAAgD;AACzD,SAAS,gDAAgD;AACzD;AACA,aAAa,QAAE,KAAK;AACpB,QAAQ,QAAE,CAAC,gBAAgB;AAC3B,QAAQ,QAAE,CAAC,gBAAgB;AAC3B,QAAQ,QAAE,CAAC,uBAAuB;AAClC,QAAQ,QAAE,CAAC,kBAAkB;AAC7B,QAAQ,QAAE,CAAC,wBAAwB;AACnC,QAAQ,QAAE,CAAC,wBAAwB;AACnC,QAAQ,QAAE;AACV;AACA;AACA;AACO;AACP;AACA;AACA;AACA,SAAS,wDAAwD;AACjE,SAAS,yCAAyC;AAClD,SAAS,yCAAyC;AAClD,SAAS,qCAAqC;AAC9C,SAAS,0CAA0C;AACnD,SAAS,qDAAqD;AAC9D,SAAS,oDAAoD;AAC7D,SAAS,0CAA0C;AACnD,SAAS,yCAAyC;AAClD,SAAS,wCAAwC;AACjD,SAAS,4CAA4C;AACrD,SAAS,wCAAwC;AACjD,SAAS,4CAA4C;AACrD,SAAS,sCAAsC;AAC/C,SAAS,2CAA2C;AACpD,SAAS,gDAAgD;AACzD,SAAS,+CAA+C;AACxD,SAAS,qCAAqC;AAC9C,SAAS,4CAA4C;AACrD,SAAS,+CAA+C;AACxD,SAAS,2CAA2C;AACpD,SAAS,0CAA0C;AACnD,SAAS,yCAAyC;AAClD,SAAS,sDAAsD;AAC/D,SAAS,8CAA8C;AACvD,SAAS,6CAA6C;AACtD,SAAS,0CAA0C;AACnD,SAAS,qCAAqC;AAC9C,SAAS,iDAAiD;AAC1D,SAAS,mDAAmD;AAC5D,SAAS,gDAAgD;AACzD,SAAS,iDAAiD;AAC1D,SAAS,4DAA4D;AACrE,SAAS,0DAA0D;AACnE,SAAS,yDAAyD;AAClE,SAAS,wCAAwC;AACjD,SAAS,4CAA4C;AACrD,SAAS,yCAAyC;AAClD,SAAS,8CAA8C;AACvD,SAAS,8CAA8C;AACvD,SAAS,mDAAmD;AAC5D,SAAS,+CAA+C;AACxD,SAAS,8CAA8C;AACvD,SAAS,gDAAgD;AACzD,SAAS,gDAAgD;AACzD;AACA,aAAa,QAAE,KAAK;AACpB,QAAQ,QAAE,CAAC,gBAAgB;AAC3B,QAAQ,QAAE,CAAC,gBAAgB;AAC3B,QAAQ,QAAE,CAAC,uBAAuB;AAClC,QAAQ,QAAE,CAAC,kBAAkB;AAC7B,QAAQ,QAAE,CAAC,wBAAwB;AACnC,QAAQ,QAAE,CAAC,wBAAwB;AACnC,QAAQ,QAAE;AACV;AACA;AACA;AACO;AACP;AACA;AACA;AACA,SAAS,wDAAwD;AACjE,SAAS,yCAAyC;AAClD,SAAS,yCAAyC;AAClD,SAAS,qCAAqC;AAC9C,SAAS,0CAA0C;AACnD,SAAS,oDAAoD;AAC7D,SAAS,0CAA0C;AACnD,SAAS,yCAAyC;AAClD,SAAS,wCAAwC;AACjD,SAAS,wCAAwC;AACjD,SAAS,4CAA4C;AACrD,SAAS,sCAAsC;AAC/C,SAAS,2CAA2C;AACpD,SAAS,gDAAgD;AACzD,SAAS,qCAAqC;AAC9C,SAAS,4CAA4C;AACrD,SAAS,+CAA+C;AACxD,SAAS,sCAAsC;AAC/C,SAAS,0CAA0C;AACnD,SAAS,yCAAyC;AAClD,SAAS,sDAAsD;AAC/D,SAAS,8CAA8C;AACvD,SAAS,6CAA6C;AACtD,SAAS,0CAA0C;AACnD,SAAS,qCAAqC;AAC9C,SAAS,4CAA4C;AACrD,SAAS,8CAA8C;AACvD,SAAS,gDAAgD;AACzD,SAAS,iDAAiD;AAC1D,SAAS,wCAAwC;AACjD,SAAS,4CAA4C;AACrD,SAAS,yCAAyC;AAClD,SAAS,8CAA8C;AACvD,SAAS,8CAA8C;AACvD,SAAS,gDAAgD;AACzD,SAAS,gDAAgD;AACzD;AACA,aAAa,QAAE,KAAK;AACpB,QAAQ,QAAE,CAAC,gBAAgB;AAC3B,QAAQ,QAAE,CAAC,gBAAgB;AAC3B,QAAQ,QAAE,CAAC,kBAAkB;AAC7B,QAAQ,QAAE,CAAC,wBAAwB;AACnC,QAAQ,QAAE;AACV;AACA;;;ACnLA;AACA;AACA;AACA;AACoD;AACE;AACE;AACK;AAC0C;AAC3C;AACa;AACI;AACoB;AACjG;AACA;AACA;AACA,IAAI,wCAAa,GAAG,QAAQ,IAAI,wBAAU;AAC1C,IAAI,0CAAe,GAAG,QAAQ,IAAI,uBAAiB;AACnD,IAAI,0CAAe;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,KAAK;AAClC;AACA;AACA;AACA;AACA;AACA,qCAAqC,KAAK;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,wCAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,UAAU;AAC7C;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,EAAE;AACrB;AACA,mBAAmB,OAAO;AAC1B;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA,eAAe,0CAAe;AAC9B;AACA,IAAI,qDAA0B;AAC9B;AACA;AACA,kCAAkC,aAAO;AACzC,sCAAsC,aAAO;AAC7C;AACA;AACA;AACA;AACA,6BAA6B,gBAAoB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,0CAAe;AAC5D;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,0CAAe,gDAAgD,mDAAmD,EAAE;AAC5H;AACA;AACA,8BAA8B,4BAA4B;AAC1D;AACA,QAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqC;;;ACnOtC;AACA;AACA;AACA;AACA,IAAI,yBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,0BAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,uBAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AACuE;AACX;AACT;AACkB;AACe;AACC;AACF;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;AACnB;AACA,IAAI,yBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,mDAAiC;AACrC,IAAI,yBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,QAAI;AAClC;AACA;AACA;AACA;AACA;AACA,yDAAyD,gBAAgB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,gBAAgB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC,IAAI,2CAAyB;AAC7B;AACA;AACA;AACA,0CAA0C,aAAO;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,aAAa;AACxD;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,qCAAkB;AACvC;AACA,wCAAwC,4BAA4B,EAAE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoC;AACrC,IAAI,mCAAiB;AACrB,IAAI,yBAAS;AACb;AACA;AACA;AACA;AACA;AACA,4BAA4B,mDAAiC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,0BAA0B,iBAAO;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,qCAAqC;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0BAAU;AAClC,QAAQ,uBAAO,IAAI,qBAAqB;AACxC;AACA;AACA,CAAC,CAAC,2CAAyB;AACE;AAC7B;AACA,IAAI,yBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,qCAAqC;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,2CAAyB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB,sBAAsB;AACvD,iBAAiB,kBAAkB;AACnC,CAAC;;;;;;;;;AC9XD;AACA;AACA;AACA;AACA,IAAI,YAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACmB;AACsB;AACY;AACF;AACyC;AAClC;AACkJ;AAC9I;AACH;AACL;AAChD,+BAA+B,IAAI,QAAQ,IAAI;AAC/C,2CAA2C,EAAE,IAAI;AACxD;AACA,IAAI,YAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,cAAM;AACiB;AACzB,IAAI,cAAI;AACR,IAAI,YAAS;AACb;AACA,iCAAiC,cAAc;AAC/C;AACA,QAAQ,QAAQ;AAChB;AACA;AACA,QAAQ,QAAQ;AAChB;AACA;AACA;AACA;AACA,mDAAmD,2DAA2D,EAAE;AAChH;AACA;AACA;AACA,0BAA0B;AAC1B,SAAS;AACT;AACA;AACA;AACA;AACA,uCAAuC,qBAAqB,gBAAgB,SAAS;AACrF,0BAA0B,YAAY;AACtC;AACA,oBAAoB,WAAW;AAC/B;AACA;AACA,oDAAoD,sBAAiB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,wBAAwB,qBAAqB,gBAAgB,SAAS;AACtE;AACA,iBAAiB,UAAU;AAC3B;AACA;AACA;AACA;AACA,SAAS;AACT,wBAAwB,qBAAqB,oBAAoB,SAAS;AAC1E;AACA,4BAA4B,UAAU;AACtC;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,6BAA6B,wCAAwC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,mBAAc;AAClD;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sCAAsC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,SAAS;AACvC,yEAAyE,aAAa;AACtF;AACA;AACA,qCAAqC,sBAAiB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,mBAAc;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,oBAAoB;AACzD;AACA;AACA;AACA,CAAC,CAAC,mBAAS;AACK;AAChB,IAAI,mBAAc;AAClB,IAAI,YAAS;AACb;AACA,iCAAiC,cAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,YAAY;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,MAAM,eAAe,CAAC;AAC1C,gCAAgC,SAAS;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,MAAM,YAAY,CAAC;AACxC;AACA,qBAAqB,MAAM,YAAY,CAAC;AACxC;AACA,YAAY,MAAM,YAAY,CAAC;AAC/B;AACA,uBAAuB,qBAAqB,eAAe,SAAS;AACpE,YAAY,WAAW;AACvB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,cAAc;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,QAAY,EAAE,oEAAoE,IAAI,EAAE,GAAG,EAAE;AACrH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,aAAa;AACzB;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA,gBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA,YAAY,WAAW;AACvB,YAAY,WAAW;AACvB;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,4BAA4B;AACxC;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,QAAQ;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,wBAAc;AAChB,IAAI,sBAAiB;AACrB,IAAI,YAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,gBAAgB;AAClD;AACA;AACA;AACA;AACA,SAAS;AACT,kCAAkC,gBAAgB;AAClD,kBAAkB,UAAU;AAC5B;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,QAAQ,QAAQ;AAChB;AACA,gCAAgC,MAAM,YAAY,CAAC;AACnD;AACA,uBAAuB,qBAAqB,eAAe,SAAS;AACpE,4BAA4B,mCAAqB;AACjD;AACA,gBAAgB,WAAW;AAC3B;AACA;AACA,SAAS;AACT,uBAAuB,qBAAqB,eAAe,SAAS;AACpE,4BAA4B,mCAAqB;AACjD;AACA,gBAAgB,WAAW;AAC3B;AACA,SAAS;AACT,uBAAuB,qBAAqB,eAAe,SAAS;AACpE;AACA;AACA;AACA;AACA,SAAS;AACT,uBAAuB,qBAAqB,eAAe,SAAS;AACpE;AACA,SAAS;AACT,uBAAuB,qBAAqB,eAAe,SAAS;AACpE,iBAAiB,UAAU;AAC3B;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,QAAQ,WAAW;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,iBAAO;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,wBAAwB;AACjE;AACA,oCAAoC,MAAM,eAAe,CAAC;AAC1D,YAAY,UAAU;AACtB,+CAA+C,aAAa;AAC5D,yCAAyC,qBAAqB,wBAAwB,SAAS;AAC/F,gCAAgC,mCAAqB;AACrD;AACA,oBAAoB,WAAW;AAC/B;AACA;AACA;AACA,+CAA+C,iBAAO;AACtD;AACA;AACA,aAAa;AACb,yCAAyC,qBAAqB,wBAAwB,SAAS;AAC/F,gCAAgC,mCAAqB;AACrD;AACA,oBAAoB,WAAW;AAC/B;AACA,aAAa;AACb,0CAA0C,cAAI;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,iBAAO;AAClD;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,QAAQ;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,iBAAO;AAC7C;AACA;AACA;AACA;AACA,CAAC,CAAC,mBAAc;AAChB;AACA,IAAI,YAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,oBAAU;AACL;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3fA;AACA;AACA;AACA;AACA,IAAI,aAAQ,IAAI,SAAI,IAAI,SAAI;AAC5B,IAAI,aAAQ;AACZ,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,aAAQ;AACnB;AACg7B;AACx3B;AACjD;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,6DAA6D,eAAe;AAC5E,6DAA6D,eAAe;AAC5E,qBAAqB,cAAc;AACnC,KAAK;AACL;AACO;AACP;AACA,mDAAmD,wBAAU;AAC7D,mDAAmD,gBAAgB;AACnE,mDAAmD,cAAc;AACjE,qDAAqD,YAAY;AACjE,uEAAuE,qBAAqB;AAC5F,uEAAuE,qBAAqB;AAC5F,+DAA+D,iBAAiB;AAChF,6DAA6D,eAAe;AAC5E,6DAA6D,eAAe;AAC5E,qDAAqD,WAAW;AAChE,iFAAiF,yBAAyB;AAC1G,yFAAyF,6BAA6B;AACtH,yFAAyF,6BAA6B;AACtH,uFAAuF,4BAA4B;AACnH,+FAA+F,gCAAgC;AAC/H,+FAA+F,gCAAgC;AAC/H,mFAAmF,0BAA0B;AAC7G,2FAA2F,8BAA8B;AACzH,2FAA2F,8BAA8B;AACzH,qEAAqE,mBAAmB;AACxF,qEAAqE,mBAAmB;AACxF,yFAAyF,6BAA6B;AACtH,yFAAyF,6BAA6B;AACtH,2FAA2F,6BAA6B;AACxH,6FAA6F,6BAA6B;AAC1H,6FAA6F,+BAA+B;AAC5H,6FAA6F,+BAA+B;AAC5H,qFAAqF,2BAA2B;AAChH,qEAAqE,mBAAmB;AACxF,qEAAqE,mBAAmB;AACxF,mEAAmE,kBAAkB;AACrF,+DAA+D,oBAAoB;AACnF,uEAAuE,oBAAoB;AAC3F,+DAA+D,oBAAoB;AACnF,KAAK;AACL;AACO;AACP,sCAAsC,KAAK;AAC3C;AACO;AACP,yBAAyB,mBAAmB;AAC5C,yBAAyB,mBAAmB;AAC5C,mCAAmC,6BAA6B;AAChE,mCAAmC,6BAA6B;AAChE,qCAAqC,6BAA6B;AAClE,qCAAqC,6BAA6B;AAClE,qCAAqC,+BAA+B;AACpE,qCAAqC,+BAA+B;AACpE,iCAAiC,2BAA2B;AAC5D,yBAAyB,mBAAmB;AAC5C,yBAAyB,mBAAmB;AAC5C,wBAAwB,kBAAkB;AAC1C,sBAAsB,oBAAoB;AAC1C,0BAA0B,oBAAoB;AAC9C,sBAAsB,oBAAoB;AAC1C;AACO;AACP,iBAAiB,YAAY;AAC7B,iBAAiB,UAAU;AAC3B,qBAAqB,cAAc;AACnC,qBAAqB,cAAc;AACnC,8BAA8B,uBAAuB;AACrD,8BAA8B,uBAAuB;AACrD,0BAA0B,mBAAmB;AAC7C,oBAAoB,uBAAuB;AAC3C;AACO;AACP,iBAAiB,aAAQ,GAAG;AAC5B;AACA,6JAA6J,wBAAU;AACvK;AACA,sCAAsC,aAAQ,GAAG;AACjD;;;AC5HA;AACA;AACA;AACA;AACkC;AAC8C;AACP;AACV;AACF;AACmB;AAChB;AACN;AAC1D,IAAI,qCAAkB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,iBAAO;AAC5C;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB,eAAe,SAAS,2BAA2B,6BAA6B,EAAE;AAC5I;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA,wCAAwC,6BAA6B,EAAE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,oBAAY;AAChF;AACA;AACA,+BAA+B,cAAI;AACnC;AACA;AACA;AACA,4GAA4G,4DAA4D;AACxK,qBAAqB;AACrB,yCAAyC,gBAAgB;AACzD,kDAAkD,uDAAuD,EAAE;AAC3G,gDAAgD,uDAAuD,EAAE;AACzG,oBAAoB,QAAQ,SAAS,SAAS,oBAAoB,gDAAgD,EAAE;AACpH,2BAA2B,kBAAkB;AAC7C,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,4BAA4B,kEAAkE;AAC9F,6BAA6B;AAC7B;AACA;AACA,wEAAwE,uCAAuC;AAC/G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6BAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;;;ACrH9B;AACA;AACA;AACA;AACA,IAAI,0BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,2BAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,wBAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AAC6D;AACN;AACiB;AAChB;AACyB;AACd;AACQ;AACZ;AAC/D,IAAI,qCAAkB;AACtB,IAAI,0BAAS;AACb;AACA;AACA,sDAAsD,aAAO;AAC7D,uDAAuD,qCAAkB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,2BAAU;AACnC,QAAQ,wBAAO,IAAI,iBAAiB;AACpC,QAAQ,wBAAO,IAAI,oBAAoB;AACvC,QAAQ,wBAAO,IAAI,mBAAmB;AACtC,QAAQ,wBAAO,IAAI,kBAAkB;AACrC,QAAQ,wBAAO,IAAI,aAAa;AAChC;AACA;AACA,CAAC,CAAC,UAAU;AACkB;;;;;;AC3D9B;AACA;AACA;AACA;AACO,IAAI,kBAAK;AAChB;AACA;AACA;AACA,iBAAiB,mBAAmB;AACpC;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,kBAAK,KAAK,kBAAK,KAAK;;;AC3CvB;AACA;AACA;AACA;AACA,IAAI,mBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC0B;AACS;AACiE;AACpD;AACjD;AACA;AACA;AACA;AACA;AACO,SAAS,kBAAM;AACtB;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,4CAA4C;AAC5C;AACA,oDAAoD;AACpD;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,6BAA6B;AAC7B;AACA,iBAAiB;AACjB;AACA;AACA,IAAI,uBAAW;AACf,IAAI,mBAAS;AACb;AACA;AACA,qBAAqB,CAAK;AAC1B,QAAQ,IAAQ;AAChB;AACA,wBAAwB,YAAY,cAAc,iCAAiC,EAAE;AACrF;AACA;AACA;AACA;AACA;AACA,2CAA2C,iBAAO;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,6BAAiC;AAChF;AACA,iBAAiB;AACjB,aAAa;AACb;AACA,+CAA+C,6BAAiC;AAChF;AACA,iBAAiB;AACjB,aAAa;AACb,2CAA2C,kBAAkB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,SAAa;AACrB;AACA;AACA;AACA,QAAQ,IAAQ;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,aAAiB;AAC7B,kCAAkC,sBAA0B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,aAAiB;AAC7C,6BAA6B,cAAkB;AAC/C;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,gCAAgC;AAChC;AACA;AACA,gCAAgC;AAChC;AACA,kBAAkB,kBAAM;AACxB;AACA,YAAY,kBAAK,aAAa,wCAAwC,GAAG,iFAAiF;AAC1J;AACA;AACA,mBAAmB,kBAAM;AACzB,QAAQ,aAAiB;AACzB,QAAQ,QAAY;AACpB,QAAQ,QAAY;AACpB,gCAAgC,sBAA0B;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,IAAQ;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,UAAc;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACW;;;ACzMvB;AACA;AACA;AACA;AACwG;AACjG,kBAAkB,eAAsB;AAC/C;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA,oDAAoD;AACpD;AACA,CAAC;AACyB;;;ACxB1B;AACA;AACA;AACA;AACA,IAAI,0BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,2BAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,wBAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AACkF;AACV;AAClB;AACS;AAC/D,IAAI,qCAAkB;AACtB,IAAI,0BAAS;AACb;AACA;AACA;AACA,gDAAgD,uBAAW;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,2BAAU;AACnC,QAAQ,wBAAO,IAAI,iBAAiB;AACpC,QAAQ,wBAAO,IAAI,WAAW;AAC9B;AACA;AACA,CAAC,CAAC,UAAU;AACkB;;;AC5DgD;AACvE,qBAAqB,eAAe;;;ACD3C;AACA;AACA;AACA;AACA,IAAI,0BAAc;AAClB;AACA;AACA,gEAAgE,OAAO;AACvE;AACO;AACP;AACA,YAAY,0BAAc;AAC1B,mCAAmC,6BAA6B;AAChE;AACA,aAAa;AACb;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACzBA;AACA;AACA;AACA;AAC8D;AACA;AAC9D,SAAS,aAAO;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,WAAK;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,OAAO;AACf,gBAAgB,aAAa;AAC7B;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,OAAO;AACf;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,mBAAmB,aAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,OAAO;AACf;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC;AACgB;;;ACjEjB;AACA;AACA,yCAAyC,sBAAsB;AAC/D,sDAAsD,sCAAsC;AAC5F;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;ACV1B;AACA;AACA;AACA;AACA,IAAI,4BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC6D;AACP;AACpB;AACe;AAC0B;AACjB;AAC3D;AACA;AACA,IAAI,yCAAoB;AACxB;AACA,kCAAkC,gBAAgB,iBAAiB,GAAG;AACtE,gCAAgC,gBAAgB;AAChD;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,YAAY;AAC1C;AACA;AACA,kDAAkD,QAAQ;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA,wCAAwC,cAAc;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,WAAW;AACzC;AACA,kCAAkC,KAAK,oDAAoD,0BAA0B,EAAE;AACvH;AACA,qEAAqE,mCAAmC;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,MAAM;AACrB;AACA;AACA,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,cAAc;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAK,kBAAkB,2BAA2B,EAAE;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,qCAAqC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,KAAK;AACpC,2DAA2D,4BAA4B;AACvF;AACA;AACA;AACA;AACA;AACA,8CAA8C,cAAc;AAC5D,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,qBAAqB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,WAAW;AACzC,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,WAAW;AACzC;AACA;AACA;AACA,CAAC;AAC+B;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,gBAAgB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,4BAAS;AACjB;AACA;AACA;AACA,8CAA8C;AAC9C,gDAAgD,aAAa;AAC7D;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;;;AClRA;AACA;AACA;AACA;AAC8E;AAC9E;AACO,oBAAoB,eAAe;;;ACNc;AACJ;AACL;AACgB;AAC/D,IAAI,iCAAoB;AACxB;AACA;AACA;AACA;AACA;AACA,wBAAwB,gBAAgB,aAAa,sBAAW;AAChE;AACA,SAAS;AACT;AACA;AACA;AACA,0CAA0C,QAAQ;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC,IAAI,8BAAiB;AACrB;AACA,iCAAiC,YAAY,+FAA+F;AAC5I;AACA;AACA,4CAA4C,iCAAoB;AAChE,0CAA0C,iCAAoB;AAC9D;AACA,iFAAiF,yBAAyB,EAAE;AAC5G,mFAAmF,2BAA2B,EAAE;AAChH,mFAAmF,2BAA2B,EAAE;AAChH,oFAAoF,4BAA4B,EAAE;AAClH,gBAAgB,+BAAoB;AACpC,0GAA0G,2BAA2B,EAAE;AACvI,uGAAuG,2BAA2B,EAAE;AACpI,uGAAuG,yBAAyB,EAAE;AAClI;AACA,gFAAgF,6BAA6B,EAAE;AAC/G,kFAAkF,+BAA+B,EAAE;AACnH,8EAA8E,2BAA2B,EAAE;AAC3G,6EAA6E,0BAA0B,EAAE;AACzG,+EAA+E,4BAA4B,EAAE;AAC7G,+EAA+E,6BAA6B,EAAE;AAC9G;AACA;AACA;AACA;AACA;AACA,gCAAgC,kBAAkB;AAClD;AACA;AACA;AACA,iCAAiC;AACjC;AACA,oBAAoB,mBAAuB;AAC3C;AACA;AACA,oBAAoB,mBAAuB,6CAA6C;AACxF,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,+BAAoB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,gCAAgC,kBAAkB;AAClD;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,iBAAwB;AAC9E;AACA;AACA,oDAAoD,iBAAwB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,aAAa,QAAY;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,oDAAoD,iBAAwB;AAC5E;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,oDAAoD,iBAAwB;AAC5E;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,oDAAoD,iBAAwB;AAC5E;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,oDAAoD,iBAAwB;AAC5E;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,oDAAoD,iBAAwB;AAC5E;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,oDAAoD,iBAAwB;AAC5E;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,aAAa,iBAAwB;AAClD;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,aAAa,iBAAwB;AAClD;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6HAA6H,sDAAsD,EAAE;AACrL;AACA;AACA,6HAA6H,2CAA2C,EAAE;AAC1K;AACA;AACA,8HAA8H,gEAAgE,EAAE;AAChM;AACA;AACA,8HAA8H,qDAAqD,EAAE;AACrL;AACA;AACA,kLAAkL,kEAAkE,EAAE;AACtP;AACA;AACA,kLAAkL,uDAAuD,EAAE;AAC3O;AACA;AACA,sHAAsH,kEAAkE,EAAE;AAC1L;AACA;AACA,sHAAsH,uDAAuD,EAAE;AAC/K;AACA;AACA,gJAAgJ,sDAAsD,EAAE;AACxM;AACA;AACA,gJAAgJ,2CAA2C,EAAE;AAC7L;AACA;AACA,uLAAuL,gEAAgE,2BAA2B,EAAE;AACpR;AACA;AACA,0HAA0H,mDAAmD,kBAAkB,EAAE,uGAAuG,+BAA+B,EAAE,yHAAyH,oDAAoD,EAAE,0HAA0H,mDAAmD,EAAE,qHAAqH,mDAAmD,EAAE,mIAAmI,oDAAoD,EAAE,oLAAoL,oDAAoD,EAAE;AACpvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;;;;;;ACtZ7B;AACA;AACA;AACA;AACA,IAAI,iBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACmD;AACU;AACI;AACX;AAC2B;AAClF,IAAI,kBAAQ;AACZ;AACA,8BAA8B,aAAO;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;AACpB,IAAI,cAAI;AACR;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAAc;AACrC,gBAAgB,UAAI;AACpB;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA,mBAAmB,8BAAc;AACjC;AACA;AACA;AACA,kDAAkD,kBAAQ;AAC1D;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;AAChB,IAAI,sBAAY;AAChB;AACA;AACA,oCAAoC,sBAAgB;AACpD;AACA,iCAAiC,sBAAgB;AACjD;AACA,oCAAoC,sBAAgB;AACpD;AACA,mCAAmC,sBAAgB;AACnD;AACA,sCAAsC,sBAAgB;AACtD;AACA,sCAAsC,sBAAgB;AACtD;AACA,yCAAyC,sBAAgB;AACzD;AACA,qCAAqC,sBAAgB;AACrD;AACA,0CAA0C,sBAAgB;AAC1D;AACA,6CAA6C,sBAAgB;AAC7D;AACA,qCAAqC,sBAAgB;AACrD;AACA;AACA;AACA;AACA,QAAQ,EAAS;AACjB,yBAAyB,kBAAkB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA,QAAQ,EAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB,IAAI,cAAI;AACR;AACA,gCAAgC,aAAO;AACvC,gCAAgC,aAAO;AACvC;AACA,6BAA6B,aAAO;AACpC;AACA,gCAAgC,aAAO;AACvC;AACA,+BAA+B,aAAO;AACtC;AACA,kCAAkC,aAAO;AACzC;AACA,kCAAkC,aAAO;AACzC;AACA,qCAAqC,aAAO;AAC5C;AACA,iCAAiC,aAAO;AACxC;AACA,sCAAsC,aAAO;AAC7C;AACA,yCAAyC,aAAO;AAChD;AACA,iCAAiC,aAAO;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,oBAAoB;AACzD,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,mBAAmB,8BAAc;AACjC;AACA;AACA;AACA,uBAAuB,8BAAc;AACrC;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8BAAc;AACvC;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,aAAa,EAAE;AAClF;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,mCAAmC,mBAAmB;AACtD;AACA,0CAA0C,8BAAc;AACxD;AACA,oFAAoF,6BAA6B,EAAE;AACnH,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,uBAAuB,8BAAc;AACrC;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,uBAAuB,8BAAc;AACrC,aAAa;AACb;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,cAAc;AAC5C,+BAA+B,eAAe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,8BAAc;AACjC;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,8BAAc;AAChD;AACA;AACA;AACA,2BAA2B,8BAAc;AACzC;AACA;AACA,2BAA2B,8BAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,SAAS;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAAa;AACxC;AACA,qBAAqB;AACrB;AACA;AACA,2BAA2B,6BAAa;AACxC;AACA;AACA;AACA;AACA;AACA,mCAAmC,8BAAc;AACjD;AACA,qBAAqB;AACrB;AACA,aAAa;AACb;AACA,4BAA4B,iBAAiB;AAC7C,mCAAmC,oDAAoD,EAAE;AACzF;AACA;AACA;AACA;AACA,8BAA8B,cAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4BAA4B;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,wBAAwB,EAAE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;AAChB;AACA,IAAI,iBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,cAAI;AACN;AACA;AACA,qCAAqC,oBAAoB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;AACzB,IAAI,mBAAS;AACb;AACA,+BAA+B,aAAO;AACtC;AACA,kCAAkC,aAAO;AACzC;AACA,8BAA8B,aAAO;AACrC;AACA,iCAAiC,aAAO;AACxC;AACA,mCAAmC,aAAO;AAC1C;AACA,gCAAgC,aAAO;AACvC;AACA,+BAA+B,aAAO;AACtC;AACA,oCAAoC,WAAK;AACzC;AACA,iCAAiC,WAAK;AACtC;AACA,oCAAoC,WAAK;AACzC;AACA,mCAAmC,WAAK;AACxC;AACA,sCAAsC,WAAK;AAC3C;AACA,sCAAsC,WAAK;AAC3C;AACA,yCAAyC,WAAK;AAC9C;AACA,qCAAqC,WAAK;AAC1C;AACA,0CAA0C,WAAK;AAC/C;AACA,6CAA6C,WAAK;AAClD;AACA,qCAAqC,WAAK;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,wBAAwB,cAAI;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,sBAAY;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,sDAAsD,mDAAmD,EAAE,EAAE,EAAE;AAC9J;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,gBAAgB;AACjD,mCAAmC,kBAAkB;AACrD;AACA;AACA,mBAAmB,8BAAc;AACjC;AACA,yBAAyB;AACzB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,mBAAmB,8BAAc;AACjC;AACA;AACA;AACA;AACA,mCAAmC,mBAAmB;AACtD;AACA;AACA,mBAAmB,8BAAc;AACjC;AACA;AACA;AACA;AACA,mCAAmC,mBAAmB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,oBAAoB;AACzD;AACA,yBAAyB,8BAAc;AACvC;AACA,kDAAkD,wBAAwB,EAAE;AAC5E,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAAc;AACrC;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,WAAW;AAC1C;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,WAAW;AAC1C;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,gBAAgB;AACjD,qCAAqC,oBAAoB;AACzD;AACA;AACA;AACA,iCAAiC,gBAAgB;AACjD;AACA;AACA;AACA,oCAAoC,cAAI;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,SAAS;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,SAAS;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,SAAS;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;AClgCrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,yBAAyB,EAAE;AACpF;AACA;AACA;AACA,CAAC;AACiC;;;AC1ClC;AACA;AACA;AACA;AAC4D;AAC5D,IAAI,uBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,oBAAoB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,2BAA2B;AAC9C;AACA;AACA;AACA;AACA,0CAA0C,QAAQ;AAClD;AACA;AACA,2CAA2C,QAAQ;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,2BAA2B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,kDAAkD,EAAE;AAC1G,gCAAgC,aAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,uCAAuC;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;AChLrB;AACA;AACA;AACA;AACA,IAAI,YAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,CAAC;AAC2B;AAC5B;AACA,IAAI,YAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA,IAAI,YAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmC;;;ACtEpC;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AClBA;AACA;AACA;AACA;AACA,IAAI,gBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACuD;AACD;AACG;AACX;AACM;AACF;AACG;AACE;AACM;AAC1B;AACwC;AACW;AACxC;AAChB;AACoB;AACK;AACF;AACM;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;AACpB,IAAI,iBAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,gCAAgC,EAAE;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA,wCAAwC,wBAAwB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,QAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,qBAAyB;AAChE;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,eAAmB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,iBAAQ;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;AACpB;AACA,IAAI,gBAAS;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,iBAAQ;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,iBAAQ;AACZ,IAAI,gBAAS;AACb;AACA;AACA;AACA,8CAA8C,aAAO;AACrD;AACA;AACA,sCAAsC,UAAoB;AAC1D,gCAAgC,aAAO;AACvC,+BAA+B,aAAO;AACtC,iCAAiC,aAAO;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,gBAAoB;AACjD;AACA;AACA,mCAAmC,iBAAiB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,QAAY;AACxB;AACA;AACA,YAAY,QAAY;AACxB;AACA;AACA;AACA,sCAAsC,mCAAiB;AACvD;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT,YAAY,IAAY;AACxB;AACA;AACA;AACA;AACA,YAAY,aAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,UAAc;AACzC,sEAAsE,wBAAwB,EAAE;AAChG,qEAAqE,uBAAuB,EAAE;AAC9F;AACA,iCAAiC,qBAAyB,yCAAyC,2BAA2B,EAAE;AAChI,iCAAiC,qBAAyB,uCAAuC,yBAAyB,EAAE;AAC5H,iCAAiC,qBAAyB,2CAA2C,6BAA6B,EAAE;AACpI,iCAAiC,qBAAyB,yCAAyC,2BAA2B,EAAE;AAChI,iCAAiC,qBAAyB;AAC1D;AACA;AACA;AACA,SAAS;AACT,iCAAiC,qBAAyB,uCAAuC,yBAAyB,EAAE;AAC5H,iCAAiC,qBAAyB,6CAA6C,+BAA+B,EAAE;AACxI,iCAAiC,qBAAyB,gBAAgB,eAAe,oBAAoB,uBAAuB,EAAE;AACtI,iCAAiC,qBAAyB,gBAAgB,eAAe,uBAAuB,+BAA+B,EAAE;AACjJ,YAAY,IAAY;AACxB,qCAAqC,qBAAyB,+CAA+C,iCAAiC,EAAE;AAChJ,qCAAqC,qBAAyB,8CAA8C,gCAAgC,EAAE;AAC9I;AACA,qCAAqC,8BAAkC,iDAAiD,4CAA4C,EAAE;AACtK;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,iCAAiC,qBAAyB,mCAAmC,4BAA4B,EAAE;AAC3H,iCAAiC,qBAAyB,sCAAsC,wBAAwB,EAAE;AAC1H,iCAAiC,qBAAyB,kCAAkC,2BAA2B,EAAE;AACzH,iCAAiC,qBAAyB,oCAAoC,4BAA4B,EAAE;AAC5H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,+BAA+B,EAAE;AAC3D;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,mBAAmB,iBAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,+CAA+C,EAAE,OAAO;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,gBAAoB,eAAe;AACvE;AACA;AACA,sCAAsC,eAAmB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+GAA+G,WAAW;AAC1H;AACA;AACA;AACA,+HAA+H,WAAW;AAC1I;AACA;AACA;AACA,+HAA+H,UAAU;AACzI;AACA;AACA;AACA,qIAAqI,UAAU;AAC/I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4BAA4B;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,oBAAoB;AAC/D;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,wDAAwD,iBAAiB;AACzE,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,wDAAwD,6BAA6B;AACrF,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,wDAAwD,mBAAmB;AAC3E,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,wDAAwD,2BAA2B;AACnF,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,mCAAmC,cAAc,uCAAuC,wBAAwB,EAAE;AAClH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,YAAY;AAC1C,4CAA4C,mCAAmC,EAAE;AACjF,qDAAqD,+BAA+B;AACpF,iBAAiB;AACjB,4CAA4C,+BAA+B,EAAE;AAC7E,qDAAqD,8BAA8B;AACnF,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+FAA+F,SAAS;AACxG;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,kDAAkD,SAAS;AAC3D;AACA;AACA,+CAA+C,aAAa;AAC5D;AACA;AACA;AACA;AACA,+CAA+C,aAAa;AAC5D;AACA;AACA;AACA;AACA,uCAAuC,aAAa;AACpD,uCAAuC,aAAa;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,4CAA4C,EAAE;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,cAAc,uCAAuC,wBAAwB,EAAE;AAClH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,QAAY;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,WAAe;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,WAAe;AACvB;AACA;AACA,+DAA+D,QAAgB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,4BAA4B;AACrE;AACA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6BAAwB;AAChD;AACA;AACA;AACA;AACA,YAAY,IAAY;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6BAAwB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6BAAwB;AAChD,6BAA6B,4BAAiB,IAAI,+BAAoB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6BAAwB;AAChD,6BAA6B,4BAAiB,IAAI,+BAAoB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,mCAA8B;AAClE;AACA;AACA;AACA;AACA,2BAA2B,sBAA0B;AACrD;AACA;AACA;AACA;AACA,2BAA2B,sBAA0B;AACrD;AACA,8BAA8B,wBAA0B;AACxD;AACA;AACA,iCAAiC,6BAAwB;AACzD;AACA;AACA;AACA;AACA;AACA,8BAA8B,qBAAuB;AACrD;AACA;AACA;AACA;AACA,wBAAwB,mCAA8B;AACtD;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,mCAA8B;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,aAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,+CAA+C,EAAE;AACrF;AACA,0CAA0C,uBAA2B;AACrE,sDAAsD,+BAAmC;AACzF,yFAAyF,cAAoB;AAC7G;AACA;AACA;AACA,sBAAsB,gBAAoB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,cAAoB;AAC5C;AACA,8FAA8F,SAAa;AAC3G;AACA;AACA;AACA,8DAA8D,6BAA6B,EAAE;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,sBAA0B;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,6BAA6B,EAAE;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,aAAO;AAClD,iDAAiD,YAAsB,cAAc,kCAAkC,EAAE;AACzH;AACA,2CAA2C,4DAA4D,EAAE;AACzG,2CAA2C,kDAAkD,EAAE;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,cAAoB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,6BAA6B,EAAE;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,QAAY;AACxB;AACA;AACA;AACA;AACA;AACA,YAAY,WAAe;AAC3B;AACA,8DAA8D;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,iBAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,yCAAyC,EAAE;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,uBAAS;AACS;;;ACr1CpB;AACA;AACA;AACA;AACoB;AAC8B;AACV;AACF;AACoB;AACT;AACE;AACnD,IAAI,oBAAW;AACf;AACA,iCAAiC,cAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,8BAA8B,EAAE,+HAA+H;AACzN,4CAA4C,kBAA+B;AAC3E,kDAAkD,aAA0B;AAC5E;AACA,gFAAgF,4BAAyC;AACzH;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA,yBAAyB,KAAK;AAC9B,mCAAmC,KAAK;AACxC,mCAAmC,KAAK;AACxC,qCAAqC,KAAK;AAC1C,qCAAqC,KAAK;AAC1C,qCAAqC,KAAK;AAC1C,yBAAyB,KAAK;AAC9B,wBAAwB,KAAK;AAC7B;AACA,IAAI,aAAI;AACR;AACA,iCAAiC,cAAc;AAC/C,qCAAqC,WAAK;AAC1C;AACA,yCAAyC,WAAK;AAC9C;AACA,sCAAsC,WAAK;AAC3C,oCAAoC,WAAK;AACzC,sCAAsC,WAAK;AAC3C,8BAA8B,aAAO;AACrC;AACA;AACA,QAAQ,KAAK;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oBAAW;AACtC,yBAAyB,mBAAe;AACxC,wBAAwB,iBAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,gBAAgB;AACjD,mCAAmC,kBAAkB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,mBAAmB;AACtD;AACA;AACA;AACA,mCAAmC,mBAAmB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,oBAAoB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;;;ACrMhB;AACA;AACA;AACA;AACA,IAAI,mBAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,IAAI,kBAAQ,IAAI,SAAI,IAAI,SAAI;AAC5B,IAAI,kBAAQ;AACZ,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,kBAAQ;AACnB;AACA,IAAI,oBAAU,IAAI,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,IAAI,iBAAO,IAAI,SAAI,IAAI,SAAI;AAC3B,mCAAmC,oCAAoC;AACvE;AACA,IAAI,aAAE;AAC0D;AAC8B;AAC5B;AACsC;AACpC;AACzB;AACyC;AACwB;AAClB;AACW;AACxC;AACqC;AAC/B;AAC5D,mBAAmB,eAAe;AACzC,IAAI,uBAAW;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,0CAA0C,4BAA4B,EAAE;AACxE;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA,qBAAqB,kBAAkB;AACvC,2CAA2C,0CAA0C,EAAE;AACvF,YAAY,YAAY,cAAc,mEAAmE,EAAE;AAC3G;AACA,+DAA+D,6BAA6B,EAAE;AAC9F;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,kBAAkB,oBAAU;AAC5B,QAAQ,iBAAO,IAAI,kBAAkB;AACrC;AACA;AACA,CAAC;AACsB;AACvB,0CAA0C,aAAa;AAChD,qDAAqD,aAAa;AAClE,2CAA2C,aAAa;AACxD,uCAAuC,aAAa;AACpD,sCAAsC,aAAa;AAC1D;AACA;AACA;AACA;AACA;AACO;AACA;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,gBAAgB;AAC/C;AACA;AACA;AACA;AACA;AACA,uEAAuE,mCAAuB,IAAI;AAClG;AACA;AACA,mCAAmC,iBAAiB;AACpD;AACA;AACA;AACA,IAAI,yBAAa;AACjB,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA,mBAAmB,kBAAQ,EAAE,qEAAqE,EAAE,aAAa,0BAA0B,iBAAiB;AAC5J;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qFAAqF,gBAAgB;AACrG;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,2BAA2B,iBAAO;AAClC;AACA,oBAAoB,oBAAU;AAC9B,QAAQ,iBAAO,IAAI,kBAAkB;AACrC,QAAQ,iBAAO;AACf,QAAQ,iBAAO,IAAI,aAAa;AAChC,QAAQ,iBAAO,IAAI,qBAAqB;AACxC,QAAQ,iBAAO,IAAI,qBAAqB;AACxC;AACA;AACA,CAAC,CAAC,aAAI;AACmB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,mCAAuB;AAC3B,IAAI,mBAAS;AACb;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAO;AAClC;AACA,8BAA8B,oBAAU;AACxC,QAAQ,iBAAO,IAAI,qBAAqB;AACxC;AACA;AACA,CAAC,CAAC,8BAAiB;AACgB;AACnC,IAAI,iCAAqB,GAAG,QAAQ,IAAI,gCAAuB;AAC/D,iCAAqB;AACrB;AACA;AACA,aAAa,QAAQ;AACrB;AACA,mBAAmB,aAAE,KAAK;AAC1B,QAAQ,aAAE;AACV;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,QAAQ;AACxB;AACA;AACA,2BAA2B,QAAQ;AACnC;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT,QAAQ,aAAE;AACV;AACA;AACA;AACA,2BAA2B,QAAQ;AACnC;AACA;AACA,aAAa;AACb,SAAS;AACT,QAAQ,aAAE;AACV;AACA;AACA,2BAA2B,QAAQ;AACnC,SAAS;AACT,QAAQ,aAAE;AACV,CAAC;;;ACtQD;AACA;AACA;AACA;AACgE;AACN;AACI;AACS;AACzB;AAC9C,IAAI,oBAAM;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE,oBAAM,KAAK,oBAAM,KAAK;AACzB,IAAI,yBAAW;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,yBAAyB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,gCAAgC,OAAO,iCAAiC,OAAO,oCAAoC,OAAO;AAC1H;AACA;AACA,kDAAkD,qBAAqB,EAAE,gBAAgB;AACzF;AACA,6BAA6B,sBAAc;AAC3C;AACA;AACA,kCAAkC,sBAAc;AAChD;AACA;AACA,kCAAkC,sBAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,2BAAa;AACjB;AACA,oCAAoC,aAAO;AAC3C,qCAAqC,aAAa;AAClD;AACA;AACA,0BAA0B,yBAAW;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,aAAa,cAAc;AAC3B,qDAAqD,yBAAyB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,cAAc;AAC1B;AACA,oBAAoB,oBAAM;AAC1B,oBAAoB,oBAAM;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,0BAA0B;AACjF;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,oBAAM;AAClB,YAAY,oBAAM;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,8BAA8B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oBAAM;AAC7B;AACA;AACA;AACA;AACA;AACA,+CAA+C,oBAAoB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE,gBAAgB;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,gBAAgB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;AC5QzB;AACA;AACA;AACA;AAC8E;AACvE,uBAAuB,eAAe;;;ACL7C;AACA;AACA;AACA;AAC8E;AACxB;AAC/C,sBAAsB,eAAe;AACrC;AACP;AACA;AACA,kCAAkC,KAAK;AACvC,+BAA+B,KAAK;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AC7BD;AACA;AACA;AACA;AACA,IAAI,0BAAS,IAAI,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AAC8D;AACc;AACI;AACG;AACO;AACvB;AACO;AACL;AACO;AACsD;AAC6P;AAC/S;AACJ;AACC;AACH;AACK;AACgB;AACF;AACP;AACU;AACe;AACf;AACpB;AACoC;AACX;AACN;AACT;AACf;AACkB;AACR;AACA;AACL;AACgB;AACZ;AACiB;AACd;AACL;AACY;AACpF,IAAI,iCAAc;AACzB;AACA,iCAAiC,iBAAiB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,wBAAwB,EAAE;AACxD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA,2BAA2B,eAAe;AAC1C;AACA;AACA;AACA,yCAAyC,uDAAuD,EAAE;AAClG;AACA,uCAAuC,yCAAoB;AAC3D,mBAAmB,qBAAqB;AACxC;AACA;AACA;AACA,iDAAiD,qBAAqB,eAAe,YAAY,yCAAoB,2BAA2B,EAAE;AAClJ,uCAAuC,yCAA0B;AACjE,iDAAiD,qBAAqB,eAAe,iCAAiC,EAAE;AACxH,yDAAyD,iCAAiC,eAAe,YAAY,iDAAkC,2BAA2B,EAAE;AACpL,sDAAsD,8BAA8B,eAAe,YAAY,8CAA+B,2BAA2B,EAAE;AAC3K,2CAA2C,wBAAwB,eAAe,YAAY,4CAA6B,GAAG,EAAE;AAChI,yCAAyC,aAAa,eAAe,YAAY,qBAAqB,GAAG,EAAE;AAC3G,6CAA6C,iBAAiB,eAAe,YAAY,yCAA0B,GAAG,EAAE;AACxH,0CAA0C,cAAc,eAAe,YAAY,mBAAmB,GAAG,EAAE;AAC3G,gDAAgD,oBAAoB,eAAe,YAAY,wCAAyB,GAAG,EAAE;AAC7H,0CAA0C,cAAc,eAAe,YAAY,2BAAa,GAAG,EAAE;AACrG,wCAAwC,YAAY,gBAAgB,YAAY,+BAAe,GAAG,EAAE;AACpG,yCAAyC,aAAa,gBAAgB,YAAY,iCAAgB,mIAAmI,EAAE;AACvO,gDAAgD,oBAAoB,gBAAgB,YAAY,+CAAuB,yFAAyF,EAAE;AAClN,mDAAmD,uBAAuB,eAAe,YAAY,qDAA0B,GAAG,EAAE;AACpI,8CAA8C,kBAAkB,gBAAgB,YAAY,yDAA+B,+CAA+C,EAAE;AAC5K,4CAA4C,gBAAgB,eAAe,YAAY,qBAAqB,GAAG,EAAE;AACjH,2CAA2C,eAAe,eAAe,QAAQ,kBAAkB,CAAC,EAAE;AACtG,uCAAuC,WAAW,eAAe,YAAY,cAAc,GAAG,EAAE;AAChG,CAAC,EAAE,iCAAc,KAAK,iCAAc,KAAK;AACzC,IAAI,4CAAyB;AAC7B,IAAI,0BAAS;AACb;AACA;AACA,iBAAiB,iCAAc;AAC/B;AACA;AACA,6CAA6C,qBAAqB;AAClE,4CAA4C,oBAAoB;AAChE,yCAAyC,iBAAiB;AAC1D,qCAAqC,aAAa;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,kBAAkB,eAAe,4BAA4B,mCAAiB,wBAAwB,EAAE;AAC/I,eAAe,YAAY,eAAe,YAAY,uBAAW,oBAAoB,EAAE;AACvF,oCAAoC,eAAe,eAAe,YAAY,uCAAwB,8BAA8B,EAAE;AACtI,uCAAuC,kBAAkB,eAAe,4BAA4B,0CAA2B,wFAAwF,EAAE;AACzN,wCAAwC,mBAAmB,eAAe,4BAA4B,qCAAkB,mCAAmC,cAAc,KAAK,EAAE;AAChL,eAAe,mBAAmB,eAAe,4BAA4B,qCAAkB,0GAA0G,EAAE;AAC3M,eAAe,YAAY,eAAe,YAAY,gCAAiB,iBAAiB,EAAE;AAC1F,eAAe,gBAAgB,eAAe,YAAY,oCAAqB,CAAC,iCAAc,kBAAkB,aAAa,GAAG,EAAE;AAClI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,UAAU;AACyB;;;ACjLrC;AACA;AACA;AACA;AAC8E;AACvE,qBAAqB,eAAe;AACpC;AACP;AACA,uBAAuB,mCAAmC;AAC1D,CAAC;;;ACTD;AACA;AACA;AACA;AACiC;AACgD;AACT;AACF;AACA;AACG;AACZ;AACe;AAC7B;AAC2B;AACU;AACP;AACiB;AAChB;AACnC;AAC4B;AACY;AACC;AACN;AACE;AACgB;AACT;AACI;AACK;AACT;AACM;AAClB;AAC3E;AACA,uBAAuB,4CAAyB;AAChD;AACA,sBAAsB,iBAAiB;AACvC,+CAA+C,+CAAgC;AAC/E,qBAAqB,iBAAiB;AACtC;AACA,sBAAsB,cAAc;AACpC,qBAAqB,cAAc,MAAM,2BAAa,cAAc,kBAAkB,gBAAgB,eAAe;AACrH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,uBAAM;AACtB,+DAA+D;AAC/D,mBAAmB,qCAAgB,6CAA6C,qBAAqB,gBAAgB,kBAAkB,gBAAgB,eAAe,gBAAgB,kBAAkB,gBAAgB,kBAAkB,gBAAgB,mBAAmB,gBAAgB,uBAAuB,gBAAgB,oBAAoB,gBAAgB,qBAAqB;AAC7X,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACO;AACP,WAAW,iCAAc;AACzB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,mBAAmB,yCAAoB,6CAA6C,qBAAqB,gBAAgB,kBAAkB,gBAAgB,kBAAkB,gBAAgB,mBAAmB,gBAAgB,oBAAoB,gBAAgB,kBAAkB,gBAAgB,uBAAuB,gBAAgB,oBAAoB,gBAAgB,qBAAqB;AACtY,KAAK;AACL;AACO;AACP,eAAe,2BAAa;AAC5B;AACA;AACA,WAAW,iCAAc;AACzB;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,iCAAc;AAClD;AACA,gCAAgC,iCAAc;AAC9C;AACA;AACA;AACA;AACO;AACP,IAAI,iCAAc,mCAAmC,iCAAc;AACnE;AACA;AACA;AACA;AACO;AACP;AACA,QAAQ,iCAAc;AACtB;AACA;AACA;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACO;AACP,WAAW,iCAAc;AACzB;AACA;AACA;AACA;AACO;AACP,WAAW,iCAAc;AACzB;AACA;AACA;AACA;AACO;AACP,WAAW,iCAAc;AACzB;AACA;AACA;AACA;AACA;AACO;AACP,WAAW,iCAAc;AACzB;AACA;AACA;AACA;AACA;AACO;AACP,WAAW,iCAAc;AACzB;AACA;AACA;AACA;AACA;AACO;AACP,WAAW,iCAAc;AACzB;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACO,SAAS,gCAAe;AAC/B,WAAW,eAAqB,CAAC,iCAAc;AAC/C;AACA;AACA;AACA;AACO;AACP,WAAW,mBAAS,iBAAiB,iCAAc,+BAA+B,iCAAc;AAChG;AACA;AACA;AACA;AACO;AACP,WAAW,mBAAS,UAAU,iCAAc;AAC5C;AACA;AACA;AACA;AACO;AACP,6BAA6B,aAAa;AAC1C,WAAW,mBAAS;AACpB;AACA;AACA;AACA;AACA;AACA,8BAA8B,oBAA0B;AACxD;AACA;AACA;AACA;AACA,sCAAsC,QAAQ,UAAU,CAAC,EAAE;AAC3D,uDAAuD,QAAQ,YAAY,qCAAqC,EAAE;AAClH;AACA;AACA;AACA;AACA;AACA;AACO;AACP,sBAAsB,iCAAc;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,IAAI,iCAAc;AAClB;AACA;AACA;AACA;AACO;AACP,IAAI,iCAAc;AAClB;AACA;AACA;AACA;AACO;AACP;AACA;AACA,gBAAgB,uBAAM;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,gCAAe;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,mBAAmC;AAChE,wBAAwB,cAA8B;AACtD,2BAA2B,iBAAiC;AAC5D,6BAA6B,mBAAmC;AAChE,0BAA0B,gBAAgC;AAC1D,2BAA2B,iBAAiC;AAC5D,gCAAgC,sBAAsC;AACtE,4BAA4B,kBAAkC;AAC9D,yBAAyB,eAA+B;AACxD,+BAA+B,qCAAqC;AACpE,uCAAuC,6BAA6C;AACpF,yCAAyC,+BAA+C;AACxF,yCAAyC,+BAA+C;AACxF,uBAAuB,aAA6B;AACpD,oBAAoB,UAA0B;AAC9C,+BAA+B,qBAAqC;AACpE;AACA,+BAA+B,mCAAmC;AAClE,sBAAsB,qBAAY;AAClC,kBAAkB,QAAQ;AAC1B,kCAAkC,wBAAwB;AAC1D,mBAAmB,SAAS;AAC5B;AACA,oBAAoB,UAAuB;AAC3C;AACA;;;AC3RA;AACA;AACA;AACA;AACO;AACP;AACA;AACO;AACP;AACA;AACO,SAAS,sBAAQ;AACxB;AACA;AACO;AACP,YAAY,sBAAQ;AACpB;AACA;AACA;AACA;AACA;AACO,SAAS,mBAAK;AACrB;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,aAAa,mBAAK;AAClB,uBAAuB;AACvB;AACA,aAAa,mBAAK;AAClB,sCAAsC;AACtC;AACA,aAAa,mBAAK;AAClB,8CAA8C;AAC9C;AACA,aAAa,mBAAK;AAClB,+BAA+B;AAC/B;AACA,oCAAoC;AACpC;AACA;AACA;AACA,aAAa,mBAAK;AAClB,mDAAmD;AACnD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC8D;AACV;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,WAAyB;AACnD;AACA;AACA,0BAA0B,WAAyB;AACnD;AACA;AACA,oBAAoB,mBAAmB;AACvC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,oBAA4B;AACpD,+BAA+B,oDAAoD;AACnF;AACA;AACA;AACA;AACA,kBAAkB,WAAyB;AAC3C;AACA,yCAAyC,qCAAqC,EAAE;AAChF,kBAAkB,WAAyB;AAC3C;AACA,wBAAwB,oBAA4B;AACpD,+BAA+B,oDAAoD;AACnF;AACA;AACA;AACA;AACA;AACA,mCAAmC,oDAAoD;AACvF;AACA;AACA;AACA,oDAAoD,iBAA+B;AACnF;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,yBAAyB,OAAqB;AAC9C,mCAAmC,oDAAoD;AACvF;AACA;AACA,yBAAyB,OAAqB;AAC9C;AACA,6BAA6B,iBAA+B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,sBAAsB,KAAK;AAC3B;AACA;AACA;AACA,kBAAkB,WAAyB;AAC3C,oBAAoB;AACpB;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,WAAyB;AACnD;AACA;AACA;AACA;AACA,0BAA0B,WAAyB;AACnD;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA,oDAAoD;AACpD,iCAAiC,WAAyB,QAAQ,iBAA+B;AACjG,sCAAsC,WAAyB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,0CAA0C;AAC5E;AACA;AACA,kCAAkC,2CAA2C,YAAY,EAAE,0BAA0B;AACrH;AACA;AACA,0EAA0E;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,WAAyB,+GAA+G;AACtJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,mBAAI;AACR;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,WAAyB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,WAAyB;AACvD;AACA;AACA,oDAAoD;AACpD;AACA;AACA,8BAA8B,WAAyB;AACvD;AACA;AACA;AACA;AACA,sCAAsC,mBAAI;AAC1C;AACA;AACA;AACA;AACA;AACA,6DAA6D,gCAAgC;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,WAAyB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,WAAyB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,WAAyB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA,kBAAkB,WAAyB;AAC3C;AACA;AACA;AACA;AACA,aAAa,SAAS,YAAY,6BAA6B;AAC/D,aAAa,mDAAmD;AAChE,aAAa,wDAAwD;AACrE,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,sBAAsB,WAAyB;AAC/C;AACA;AACA;AACA;AACA;AACA,0BAA0B,OAAqB;AAC/C,2BAA2B,OAAqB;AAChD,iBAAiB;AACjB;AACA;AACA,sBAAsB,WAAyB,8DAA8D,iBAAiB;AAC9H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC5eA;AACA;AACA;AACA;AAC+F;AAC7C;AAC2B;AACzB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,IAAI,2BAAc;AAClB,IAAI,0CAA6B;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,KAAK;AACnC;AACA;AACA;AACA;AACA,4CAA4C,oBAA0B;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA,CAAC;AACD,IAAI,yCAA4B;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,UAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,oBAA0B;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,CAAC;AACD,IAAI,6BAAgB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,oBAA0B;AACvE;AACA;AACA;AACA;AACA,4DAA4D,SAAS;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,oBAA0B;AAC1C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,0CAA6B;AAC/D;AACA;AACA;AACA;AACA,kCAAkC,yCAA4B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,SAAuB,iCAAiC;AAC5E;AACA,sBAAsB,WAAyB;AAC/C;AACA;AACA;AACA;AACA;AACA,iBAAiB,2BAAc;AAC/B;AACA;AACA;AACA,iBAAiB,SAAuB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,WAAyB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,SAAuB,qBAAqB;AACxE;AACA,8BAA8B,WAAyB;AACvD;AACA;AACA;AACA;AACA;AACA,wBAAwB,2BAAc;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,aAA2B,YAAY,SAAuB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,iBAA+B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,WAAyB;AAC3D;AACA;AACA;AACA;AACA,8BAA8B,WAAyB;AACvD;AACA;AACA,+CAA+C,iBAA+B;AAC9E;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA,oCAAoC,iBAA+B,wDAAwD;AAC3H;AACA,wDAAwD;AACxD;AACA,yBAAyB,SAAuB;AAChD,8BAA8B,WAAyB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,WAAyB;AACnD;AACA;AACA;AACA;AACA,kCAAkC,WAAyB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,WAAyB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,iBAA+B;AACvE;AACA,4DAA4D;AAC5D;AACA,6BAA6B,SAAuB;AACpD,kCAAkC,WAAyB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,GAAiB,8CAA8C,iBAA+B;AAClH;AACA;AACA;AACA;AACA,sBAAsB,WAAyB;AAC/C;AACA;AACA;AACA;AACA,0BAA0B,WAAyB;AACnD;AACA;AACA,0BAA0B,WAAyB;AACnD;AACA;AACA,+BAA+B,oBAAoB;AACnD;AACA;AACA;AACA,0BAA0B,WAAyB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mBAAmB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,WAAyB;AACvD,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,8BAA8B,WAAyB;AACvD,mCAAmC;AACnC;AACA,gCAAgC,QAAsB;AACtD;AACA;AACA;AACA,gCAAgC,QAAsB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,oBAA0B;AAChE;AACA;AACA;AACA;AACA,oDAAoD,YAAY,EAAE,UAAU;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,OAAqB;AACnC;AACA,mBAAmB,qBAAqB;AACxC;AACA;AACA,oBAAoB;AACpB;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACO;AACP,eAAe,6BAAgB;AAC/B;;;ACprBA;AACA;AACA;AACA;AACmD;AACyC;AAC7C;AACqD;AAChC;AACU;AACrB;AACK;AACgB;AAC9E;AACA;AACA;AACO;AACP,IAAI,aAAa;AACjB;AACA;AACA;AACA;AACO;AACP;AACA,2BAA2B,aAAa;AACxC;AACA;AACO;AACP,cAAc,iCAAc;AAC5B;AACA;AACA;AACA;AACA;AACA;AACO;AACP,qBAAqB,iCAAc;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACO;AACP,6BAA6B,iCAAc;AAC3C;AACA;AACA;AACA,WAAW,6BAA6B;AACxC;AACA;AACA;AACA;AACA,IAAI,sDAAkC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,CAAC;AAC6C;AAC9C;AACA;AACA;AACA,IAAI,+CAA2B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,KAAK;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA,CAAC;AACsC;AACvC;AACA;AACA;AACA;AACA;AACA;AACO;AACP,6BAA6B,iCAAc;AAC3C;AACA;AACA;AACA;AACA;AACA,sBAAsB,sDAAkC;AACxD;AACA;AACA,sBAAsB,+CAA2B,CAAC,iCAAc;AAChE;AACA,WAAW,oBAA0B;AACrC;AACA;AACA;AACA;AACO;AACP,gBAAgB,OAAO;AACvB,kBAAkB,yBAAyB,CAAC,iCAAc,oBAAoB,iCAAc;AAC5F,WAAW,oBAA0B;AACrC;AACA;AACA;AACA;AACO;AACP,WAAW,yBAA+B;AAC1C;AACA;AACA;AACA;AACO;AACP,WAAW,sBAA4B;AACvC;AACA;AACA;AACA;AACO;AACP,WAAW,6BAAmC;AAC9C;AACA;AACA;AACA;AACO;AACP,WAAW,qBAA2B;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,WAAK;AAC3C;AACA;AACA,sCAAsC,WAAK;AAC3C;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACO;AACP,WAAW,8BAAoC;AAC/C;AACA;AACA;AACA;AACO;AACP,WAAW,iCAAuC;AAClD;AACA;AACA;AACA;AACO;AACP,WAAW,0BAAgC;AAC3C;AACA;AACA;AACA;AACO;AACP,WAAW,8BAAoC;AAC/C;AACA;AACA;AACA;AACO;AACP,WAAW,8BAAoC;AAC/C;AACA;AACA;AACA;AACO;AACP,WAAW,wBAA8B;AACzC;AACA;AACA;AACA;AACO;AACP,WAAW,0BAAgC;AAC3C;AACA,0BAA0B,iCAAc,2BAA2B,sBAAsB;AACzF,uBAAuB,WAAK;AAC5B,aAAa;AACb,8DAA8D,uCAAuC;AACrG;AACA,KAAK;AACL;AACA;AACA;AACA;AACO;AACP,WAAW,sCAA4C;AACvD;AACA;AACA;AACA;AACO;AACP,WAAW,2CAAiD;AAC5D;AACA;AACA;AACA;AACO;AACP,WAAW,oCAA0C;AACrD;AACA;AACA;AACA;AACO;AACP,WAAW,oBAA0B;AACrC;AACA;AACA;AACA;AACO;AACP,WAAW,0BAAgC;AAC3C;AACA;AACA;AACA;AACO;AACP,WAAW,qBAA2B;AACtC;AACA;AACA;AACA;AACO;AACP,WAAW,4BAAkC;AAC7C;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,qBAAqC;AACpE,4BAA4B,kBAAkC;AAC9D,sCAAsC,4BAA4C;AAClF,oBAAoB,UAA0B;AAC9C,sBAAsB,YAA4B;AAClD,+BAA+B,qBAAqC;AACpE,oCAAoC,0BAA0C;AAC9E;AACA,0BAA0B,gBAAsB;AAChD;AACA;;;AClXA;AACA;AACA;AACA;AAC2E;AACR;AACS;AACK;AACM;AACvF,IAAI,iBAAM;AACV;AACA;AACA,WAAW,iBAAM;AACjB,IAAI,iBAAM,WAAW,sCAAe;AACpC;AACA;AACA,eAAe;AACf,eAAe;AACf,eAAe;AACf,UAAU,mBAAmB;AAC7B,aAAa,qBAAqB;AAClC,gBAAgB,wBAAwB;AACjC,IAAI,kCAAuB;AAC3B,IAAI,kBAAO;AACX,IAAI,kBAAO;AACX,IAAI,iBAAM;AACV,IAAI,mBAAQ;AACZ,IAAI,gBAAK;AACT,IAAI,oBAAS;AACb,IAAI,6BAAkB;AACtB,IAAI,yBAAc;AAClB,IAAI,oBAAS;AACb,IAAI,kBAAO;AACX;AACA,IAAI,gBAAK;AACT,IAAI,iBAAM;AACV;AACP,iBAAM;AACN,WAAW,iBAAM,mCAAmC,iBAAM;AAC1D,IAAI,iBAAM;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;;;;;;;;ACpDA;;AAEA,SAASA,IAAT,GAAgB,CAAG;;AAEJ;AACbC,MAAI,EAAE,cADO;AAEbC,OAAK,EAAE;AACLC,cAAU,EAAE;AAAEC,UAAI,EAAEC,OAAR;AAAiBC,aAAO,EAAE;AAA1B,KADP;AAC+C;AACpDC,SAAK,EAAE;AAACH,UAAI,EAAE,CAACI,MAAD,EAASC,MAAT,CAAP;AAAyBH,aAAO,EAAE;AAAlC,KAFF;AAGLI,UAAM,EAAE;AAACN,UAAI,EAAE,CAACI,MAAD,EAASC,MAAT,CAAP;AAAyBH,aAAO,EAAE;AAAlC,KAHH;AAILK,YAAQ,EAAEH,MAJL;AAImB;AACxBI,SAAK,EAAEJ,MALF;AAMLK,YAAQ,EAAE;AAACT,UAAI,EAAEI,MAAP;AAAeF,aAAO,EAAE;AAAxB,KANL;AAOLQ,SAAK,EAAE;AAACV,UAAI,EAAEI,MAAP;AAAeF,aAAO,EAAE;AAAxB,KAPF;AAQLS,WAAO,EAAE;AAACX,UAAI,EAAEY,MAAP;AAAeV,aAAf,sBAAyB;AAAC,eAAO,EAAP;AAAW;AAArC,KARJ;AASLW,iBAAa,EAAE;AAACb,UAAI,EAAEc,QAAP;AAAiBZ,aAAO,EAAEN;AAA1B,KATV;AAULmB,qBAAiB,EAAE;AAACf,UAAI,EAAEc,QAAP;AAAiBZ,aAAO,EAAEN;AAA1B;AAVd,GAFM;AAeboB,OAAK,EAAE;AACLL,WAAO,EAAE;AACPM,UAAI,EAAE,IADC;AAEPC,aAFO,mBAECP,OAFD,EAEU;AACf,aAAKQ,MAAL,IAAe,KAAKA,MAAL,CAAYC,aAAZ,CAA0BT,OAA1B,CAAf;AACD;AAJM,KADJ;AAQLH,SARK,mBAQG;AACN,WAAKW,MAAL,IAAe,KAAKX,KAAL,KAAe,KAAKW,MAAL,CAAYE,QAAZ,EAA9B,IAAwD,KAAKF,MAAL,CAAYG,QAAZ,CAAqB,KAAKd,KAA1B,CAAxD;AACD,KAVI;AAYLC,YAZK,sBAYM;AACT,UAAG,CAAC,KAAKU,MAAT,EAAiB;;AACjB,UAAG,KAAKpB,UAAR,EAAmB;AAAO;AAAP,oCACc,KAAKoB,MAAL,CAAYI,QAAZ,EADd;AAAA,YACThB,QADS,yBACTA,QADS;AAAA,YACCiB,QADD,yBACCA,QADD;;AAEjBC,yBAAA,CAAcC,gBAAd,CAA+BnB,QAA/B,EAAyC,KAAKE,QAA9C;AACAgB,yBAAA,CAAcC,gBAAd,CAA+BF,QAA/B,EAAyC,KAAKf,QAA9C;AACD,OAJD,MAKEgB,iBAAA,CAAcC,gBAAd,CAA+B,KAAKP,MAAL,CAAYI,QAAZ,EAA/B,EAAuD,KAAKd,QAA5D;AACH,KApBI;AAsBLC,SAtBK,mBAsBG;AACN,WAAKS,MAAL,IAAeM,iBAAA,CAAcE,QAAd,CAAuB,KAAKjB,KAA5B,CAAf;AACD,KAxBI;AA0BLkB,SA1BK,mBA0BG;AAAA;;AACN,WAAKT,MAAL,IAAe,KAAKU,SAAL,CAAe,YAAM;AAClC,aAAI,CAACV,MAAL,CAAYW,MAAZ;AACD,OAFc,CAAf;AAGD;AA9BI,GAfM;AAgDbC,UAAQ,EAAE;AACRH,SADQ,mBACA;AACN,aAAO;AACLzB,aAAK,EAAE,CAAC,QAAQ6B,IAAR,CAAa,KAAK7B,KAAlB,CAAD,GAA4B,KAAKA,KAAjC,aAA4C,KAAKA,KAAjD,OADF;AAELG,cAAM,EAAE,CAAC,QAAQ0B,IAAR,CAAa,KAAK1B,MAAlB,CAAD,GAA6B,KAAKA,MAAlC,aAA8C,KAAKA,MAAnD;AAFH,OAAP;AAID;AANO,GAhDG;AAyDb2B,SAzDa,qBAyDF;AACT,SAAKC,UAAL;AACD,GA3DY;AA6DbC,eA7Da,2BA6DG;AACd,SAAKhB,MAAL,IAAe,KAAKA,MAAL,CAAYiB,OAAZ,EAAf;AACD,GA/DY;AAiEbC,QAjEa,kBAiELC,CAjEK,EAiEF;AACT,WACE;AAAK,eAAM,yBAAX;AAAqC,WAAK,EAAE,KAAKV;AAAjD,MADF;AAGD,GArEY;AAuEbW,SAAO,EAAE;AACPL,cADO,wBACM;AAAA,UACH1B,KADG,GACiC,IADjC,CACHA,KADG;AAAA,UACIC,QADJ,GACiC,IADjC,CACIA,QADJ;AAAA,UACcC,KADd,GACiC,IADjC,CACcA,KADd;AAAA,UACqBC,OADrB,GACiC,IADjC,CACqBA,OADrB;AAEXC,YAAM,CAAC4B,MAAP,CAAc7B,OAAd,EAAuB,KAAK8B,kBAAL,EAAvB,EAFW,CAE6C;;AACxD,WAAKtB,MAAL,GAAcM,iBAAA,CAAc,KAAK1B,UAAL,GAAkB,kBAAlB,GAAuC,QAArD,EAA+D,KAAK2C,GAApE;AACZlC,aAAK,EAAE,KAAKA,KADA;AAEZC,gBAAQ,EAAE,KAAKA,QAFH;AAGZC,aAAK,EAAE,KAAKA;AAHA,SAITC,OAJS,EAAd;AAMA,WAAKZ,UAAL,IAAmB,KAAK4C,SAAL,CAAe,KAAKnC,KAApB,EAA2B,KAAKD,QAAhC,CAAnB;;AACA,WAAKqC,cAAL,CAAoB,KAAKzB,MAAzB,EAVW,CAU4B;;AACxC,KAZM;AAcPwB,aAdO,qBAcGnC,KAdH,EAcUD,QAdV,EAcoB;AAAM;AAAN,UACjBE,QADiB,GACJ,IADI,CACjBA,QADiB;AAEzB,UAAMoC,aAAa,GAAGpB,iBAAA,CAAcqB,WAAd,CAA0BvC,QAA1B,EAAoCE,QAApC,CAAtB;AACA,UAAMsC,aAAa,GAAGtB,iBAAA,CAAcqB,WAAd,CAA0BtC,KAA1B,EAAiCC,QAAjC,CAAtB;AACA,WAAKU,MAAL,CAAY6B,QAAZ,CAAqB;AACnBzC,gBAAQ,EAAEsC,aADS;AAEnBrB,gBAAQ,EAAEuB;AAFS,OAArB;AAID,KAtBM;AAwBPN,sBAxBO,gCAwBc;AACnB,UAAM9B,OAAO,GAAG,KAAKI,iBAAL,CAAuBU,0BAAvB,CAAhB;AACA,aAAOd,OAAO,IAAI,EAAlB;AACD,KA3BM;AA6BPiC,kBA7BO,0BA6BQzB,MA7BR,EA6BgB;AAAA;;AACrB,WAAKN,aAAL,CAAmBM,MAAnB,EAA2BM,0BAA3B;;AACA,UAAG,KAAK1B,UAAR,EAAmB;AACjBoB,cAAM,CAAC8B,eAAP,CAAuB,YAAM;AAC3B,cAAMzC,KAAK,GAAGW,MAAM,CAACI,QAAP,GAAkBC,QAAlB,CAA2BH,QAA3B,EAAd;;AACA,gBAAI,CAAC6B,WAAL,CAAiB1C,KAAjB,EAAwB2C,KAAxB;AACD,SAHD;AAID,OALD,MAKK;AACHhC,cAAM,CAACiC,uBAAP,CAA+B,UAAAD,KAAK,EAAI;AACtC,cAAM3C,KAAK,GAAGW,MAAM,CAACE,QAAP,EAAd;;AACA,gBAAI,CAAC6B,WAAL,CAAiB1C,KAAjB,EAAwB2C,KAAxB;AACD,SAHD;AAID;AACF,KA1CM;AA4CPD,eA5CO,uBA4CK1C,KA5CL,EA4CY2C,KA5CZ,EA4CmB;AACxB,WAAKE,KAAL,CAAW,QAAX,EAAqB7C,KAArB,EAA4B2C,KAA5B;AACA,WAAKE,KAAL,CAAW,OAAX,EAAoB7C,KAApB;AACD;AA/CM;AAvEI,CAAf,E;;ACJwB;AACA;AACT,kFAAG;AACI;;;;;;;;ACHtB;AACA","file":"monaco-editor-vue.common.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"fb15\");\n","'use strict';\nvar LIBRARY = require('./_library');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar $iterCreate = require('./_iter-create');\nvar setToStringTag = require('./_set-to-string-tag');\nvar getPrototypeOf = require('./_object-gpo');\nvar ITERATOR = require('./_wks')('iterator');\nvar BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`\nvar FF_ITERATOR = '@@iterator';\nvar KEYS = 'keys';\nvar VALUES = 'values';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function (kind) {\n    if (!BUGGY && kind in proto) return proto[kind];\n    switch (kind) {\n      case KEYS: return function keys() { return new Constructor(this, kind); };\n      case VALUES: return function values() { return new Constructor(this, kind); };\n    } return function entries() { return new Constructor(this, kind); };\n  };\n  var TAG = NAME + ' Iterator';\n  var DEF_VALUES = DEFAULT == VALUES;\n  var VALUES_BUG = false;\n  var proto = Base.prototype;\n  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];\n  var $default = $native || getMethod(DEFAULT);\n  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;\n  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;\n  var methods, key, IteratorPrototype;\n  // Fix native\n  if ($anyNative) {\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));\n    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEF_VALUES && $native && $native.name !== VALUES) {\n    VALUES_BUG = true;\n    $default = function values() { return $native.call(this); };\n  }\n  // Define iterator\n  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG] = returnThis;\n  if (DEFAULT) {\n    methods = {\n      values: DEF_VALUES ? $default : getMethod(VALUES),\n      keys: IS_SET ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if (FORCED) for (key in methods) {\n      if (!(key in proto)) redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .margin-view-overlays .current-line{display:block;position:absolute;left:0;top:0;box-sizing:border-box}.monaco-editor .margin-view-overlays .current-line.current-line-margin.current-line-margin-both{border-right:0}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .overlayWidgets{position:absolute;top:0;left:0}\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./menu.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"76bb5da4\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-action-bar{text-align:right;overflow:hidden;white-space:nowrap}.monaco-action-bar .actions-container{display:flex;margin:0 auto;padding:0;width:100%;justify-content:flex-end}.monaco-action-bar.vertical .actions-container{display:inline-block}.monaco-action-bar.reverse .actions-container{flex-direction:row-reverse}.monaco-action-bar .action-item{cursor:pointer;display:inline-block;transition:transform 50ms ease;position:relative}.monaco-action-bar .action-item.disabled{cursor:default}.monaco-action-bar.animated .action-item.active{transform:scale(1.272019649)}.monaco-action-bar .action-item .icon{display:inline-block}.monaco-action-bar .action-label{font-size:11px;margin-right:4px}.monaco-action-bar .action-label.octicon{font-size:15px;line-height:35px;text-align:center}.monaco-action-bar .action-item.disabled .action-label,.monaco-action-bar .action-item.disabled .action-label:hover{opacity:.4}.monaco-action-bar.vertical{text-align:left}.monaco-action-bar.vertical .action-item{display:block}.monaco-action-bar.vertical .action-label.separator{display:block;border-bottom:1px solid #bbb;padding-top:1px;margin-left:.8em;margin-right:.8em}.monaco-action-bar.animated.vertical .action-item.active{transform:translate(5px)}.secondary-actions .monaco-action-bar .action-label{margin-left:6px}.monaco-action-bar .action-item.select-container{overflow:hidden;flex:1;max-width:170px;min-width:60px;display:flex;align-items:center;justify-content:center}\", \"\"]);\n\n// exports\n","// https://github.com/tc39/proposal-promise-finally\n'use strict';\nvar $export = require('./_export');\nvar core = require('./_core');\nvar global = require('./_global');\nvar speciesConstructor = require('./_species-constructor');\nvar promiseResolve = require('./_promise-resolve');\n\n$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {\n  var C = speciesConstructor(this, core.Promise || global.Promise);\n  var isFunction = typeof onFinally == 'function';\n  return this.then(\n    isFunction ? function (x) {\n      return promiseResolve(C, onFinally()).then(function () { return x; });\n    } : onFinally,\n    isFunction ? function (e) {\n      return promiseResolve(C, onFinally()).then(function () { throw e; });\n    } : onFinally\n  );\n} });\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./indentGuides.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"4ee2c4ed\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./diffReview.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"913f7b2a\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = require('./_object-keys-internal');\nvar enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n","var pIE = require('./_object-pie');\nvar createDesc = require('./_property-desc');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar has = require('./_has');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nexports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return gOPD(O, P);\n  } catch (e) { /* empty */ }\n  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);\n};\n","var dP = require('./_object-dp');\nvar anObject = require('./_an-object');\nvar getKeys = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = getKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var P;\n  while (length > i) dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n","exports = module.exports = require(\"../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .inputarea{min-width:0;min-height:0;margin:0;padding:0;position:absolute;outline:none!important;resize:none;border:none;overflow:hidden;color:transparent;background-color:transparent}.monaco-editor .inputarea.ime-input{z-index:10}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-scrollable-element>.scrollbar>.up-arrow{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTEgMTEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTkuNDggOC45NjFsMS4yNi0xLjI2LTUuMDQtNS4wNC01LjQ2IDUuMDQgMS4yNiAxLjI2IDQuMi0zLjc4IDMuNzggMy43OHoiIGZpbGw9IiM0MjQyNDIiLz48L3N2Zz4=\\\");cursor:pointer}.monaco-scrollable-element>.scrollbar>.down-arrow{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMSAxMSI+PHBhdGggZmlsbD0iIzQyNDI0MiIgZD0iTTEuNSAyLjY2MkwuMjQgMy45MjJsNS4wNCA1LjA0IDUuNDYtNS4wNC0xLjI2LTEuMjYtNC4yIDMuNzgtMy43OC0zLjc4eiIvPjwvc3ZnPg==\\\");cursor:pointer}.monaco-scrollable-element>.scrollbar>.left-arrow{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMSAxMSI+PHBhdGggZmlsbD0iIzQyNDI0MiIgZD0iTTguNjQgMS40NDFMNy4zOC4xODFsLTUuMDQgNS4wNCA1LjA0IDUuNDYgMS4yNi0xLjI2LTMuNzgtNC4yIDMuNzgtMy43OHoiLz48L3N2Zz4=\\\");cursor:pointer}.monaco-scrollable-element>.scrollbar>.right-arrow{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTEgMTEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0iIzQyNDI0MiIgZD0iTTIuNDY3IDkuNTQ4bDEuMjYgMS4yNiA1LjA0LTUuMDQtNS4wNC01LjQ2LTEuMjYgMS4yNiAzLjc4IDQuMi0zLjc4IDMuNzh6Ii8+PC9zdmc+\\\");cursor:pointer}.hc-black .monaco-scrollable-element>.scrollbar>.up-arrow,.vs-dark .monaco-scrollable-element>.scrollbar>.up-arrow{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTEgMTEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTkuNDggOC45NjFsMS4yNi0xLjI2LTUuMDQtNS4wNC01LjQ2IDUuMDQgMS4yNiAxLjI2IDQuMi0zLjc4IDMuNzggMy43OHoiIGZpbGw9IiNFOEU4RTgiLz48L3N2Zz4=\\\")}.hc-black .monaco-scrollable-element>.scrollbar>.down-arrow,.vs-dark .monaco-scrollable-element>.scrollbar>.down-arrow{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMSAxMSI+PHBhdGggZmlsbD0iI0U4RThFOCIgZD0iTTEuNSAyLjY2MkwuMjQgMy45MjJsNS4wNCA1LjA0IDUuNDYtNS4wNC0xLjI2LTEuMjYtNC4yIDMuNzgtMy43OC0zLjc4eiIvPjwvc3ZnPg==\\\")}.hc-black .monaco-scrollable-element>.scrollbar>.left-arrow,.vs-dark .monaco-scrollable-element>.scrollbar>.left-arrow{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMSAxMSI+PHBhdGggZmlsbD0iI0U4RThFOCIgZD0iTTguNjQgMS40NDFMNy4zOC4xODFsLTUuMDQgNS4wNCA1LjA0IDUuNDYgMS4yNi0xLjI2LTMuNzgtNC4yIDMuNzgtMy43OHoiLz48L3N2Zz4=\\\")}.hc-black .monaco-scrollable-element>.scrollbar>.right-arrow,.vs-dark .monaco-scrollable-element>.scrollbar>.right-arrow{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTEgMTEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0iI0U4RThFOCIgZD0iTTIuNDY3IDkuNTQ4bDEuMjYgMS4yNiA1LjA0LTUuMDQtNS4wNC01LjQ2LTEuMjYgMS4yNiAzLjc4IDQuMi0zLjc4IDMuNzh6Ii8+PC9zdmc+\\\")}.monaco-scrollable-element>.visible{opacity:1;background:transparent;transition:opacity .1s linear}.monaco-scrollable-element>.invisible{opacity:0;pointer-events:none}.monaco-scrollable-element>.invisible.fade{transition:opacity .8s linear}.monaco-scrollable-element>.shadow{position:absolute;display:none}.monaco-scrollable-element>.shadow.top{display:block;top:0;left:3px;height:3px;width:100%;box-shadow:inset 0 6px 6px -6px #ddd}.monaco-scrollable-element>.shadow.left{display:block;top:3px;left:0;height:100%;width:3px;box-shadow:inset 6px 0 6px -6px #ddd}.monaco-scrollable-element>.shadow.top-left-corner{display:block;top:0;left:0;height:3px;width:3px}.monaco-scrollable-element>.shadow.top.left{box-shadow:inset 6px 6px 6px -6px #ddd}.vs .monaco-scrollable-element>.scrollbar>.slider{background:hsla(0,0%,39.2%,.4)}.vs-dark .monaco-scrollable-element>.scrollbar>.slider{background:hsla(0,0%,47.5%,.4)}.hc-black .monaco-scrollable-element>.scrollbar>.slider{background:rgba(111,195,223,.6)}.monaco-scrollable-element>.scrollbar>.slider:hover{background:hsla(0,0%,39.2%,.7)}.hc-black .monaco-scrollable-element>.scrollbar>.slider:hover{background:rgba(111,195,223,.8)}.monaco-scrollable-element>.scrollbar>.slider.active{background:rgba(0,0,0,.6)}.vs-dark .monaco-scrollable-element>.scrollbar>.slider.active{background:hsla(0,0%,74.9%,.4)}.hc-black .monaco-scrollable-element>.scrollbar>.slider.active{background:#6fc3df}.vs-dark .monaco-scrollable-element .shadow.top{box-shadow:none}.vs-dark .monaco-scrollable-element .shadow.left{box-shadow:inset 6px 0 6px -6px #000}.vs-dark .monaco-scrollable-element .shadow.top.left{box-shadow:inset 6px 6px 6px -6px #000}.hc-black .monaco-scrollable-element .shadow.left,.hc-black .monaco-scrollable-element .shadow.top,.hc-black .monaco-scrollable-element .shadow.top.left{box-shadow:none}\", \"\"]);\n\n// exports\n","var ctx = require('./_ctx');\nvar invoke = require('./_invoke');\nvar html = require('./_html');\nvar cel = require('./_dom-create');\nvar global = require('./_global');\nvar process = global.process;\nvar setTask = global.setImmediate;\nvar clearTask = global.clearImmediate;\nvar MessageChannel = global.MessageChannel;\nvar Dispatch = global.Dispatch;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar defer, channel, port;\nvar run = function () {\n  var id = +this;\n  // eslint-disable-next-line no-prototype-builtins\n  if (queue.hasOwnProperty(id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listener = function (event) {\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!setTask || !clearTask) {\n  setTask = function setImmediate(fn) {\n    var args = [];\n    var i = 1;\n    while (arguments.length > i) args.push(arguments[i++]);\n    queue[++counter] = function () {\n      // eslint-disable-next-line no-new-func\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (require('./_cof')(process) == 'process') {\n    defer = function (id) {\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if (MessageChannel) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {\n    defer = function (id) {\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in cel('script')) {\n    defer = function (id) {\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set: setTask,\n  clear: clearTask\n};\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .margin-view-overlays .cmdr{position:absolute;left:0;width:100%;height:100%}\", \"\"]);\n\n// exports\n","// call something on iterator step with safe closing on error\nvar anObject = require('./_an-object');\nmodule.exports = function (iterator, fn, value, entries) {\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (e) {\n    var ret = iterator['return'];\n    if (ret !== undefined) anObject(ret.call(iterator));\n    throw e;\n  }\n};\n","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./_cof');\nvar TAG = require('./_wks')('toStringTag');\n// ES3 wrong here\nvar ARG = cof(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (e) { /* empty */ }\n};\n\nmodule.exports = function (it) {\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n","exports.f = Object.getOwnPropertySymbols;\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .margin-view-overlays .line-numbers{position:absolute;text-align:right;display:inline-block;vertical-align:middle;box-sizing:border-box;cursor:default;height:100%}.monaco-editor .relative-current-line-number{text-align:left;display:inline-block;width:100%}.monaco-editor .margin-view-overlays .line-numbers{cursor:-webkit-image-set(url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNSIgaGVpZ2h0PSIyMSI+PHBhdGggZmlsbD0iI2ZmZiIgc3Ryb2tlPSIjMDAwIiBkPSJNMTQuNSAxLjJMMS45IDEzLjhoNS4ybC0yLjYgNS4zIDMuMiAxIDIuNi01LjIgNC4yIDMuMXoiLz48L3N2Zz4=\\\") 1x,url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMCIgaGVpZ2h0PSI0MiI+PHBhdGggZmlsbD0iI2ZmZiIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjIiIGQ9Ik0yOSAyLjRMMy44IDI3LjZoMTAuNUw5IDM4LjFsNi40IDIuMSA1LjItMTAuNUwyOSAzNnoiLz48L3N2Zz4=\\\") 2x) 30 0,default}.monaco-editor.mac .margin-view-overlays .line-numbers{cursor:-webkit-image-set(url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxOCI+PHBhdGggZD0iTTQuMyAxNi41bDEuNi00LjZIMS4xTDExLjUgMS4ydjE0LjRMOC43IDEzbC0xLjYgNC41eiIvPjxwYXRoIGQ9Ik0xMSAxNC41bC0yLjUtMi4zTDcgMTYuNyA1IDE2bDEuNi00LjVoLTRsOC41LTlNMCAxMi41aDUuMmwtMS41IDQuMUw3LjUgMTggOSAxNC4ybDIuOSAyLjNWMEwwIDEyLjV6IiBmaWxsPSIjZmZmIi8+PC9zdmc+\\\") 1x,url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIzNiIgdmlld0JveD0iMCAwIDI0IDM2LjEiPjxwYXRoIGQ9Ik04LjYgMzMuMWwzLjItOS4ySDIuMkwyMyAyLjV2MjguOGwtNS42LTUuMi0zLjIgOS01LjYtMnoiLz48cGF0aCBkPSJNMjIgMjkuMWwtNS00LjYtMy4wNjIgOC45MzgtNC4wNjItMS41TDEzIDIzSDVMMjIgNU0wIDI1aDEwLjRsLTMgOC4zIDcuNiAyLjggMy4xMjUtNy42NjJMMjQgMzNWMHoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=\\\") 2x) 24 3,default}.monaco-editor .margin-view-overlays .line-numbers.lh-odd{margin-top:1px}\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./linesDecorations.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"6461e128\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var classof = require('./_classof');\nvar ITERATOR = require('./_wks')('iterator');\nvar Iterators = require('./_iterators');\nmodule.exports = require('./_core').getIteratorMethod = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./lineNumbers.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"8fd450ec\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var global = require('./_global');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar SRC = require('./_uid')('src');\nvar TO_STRING = 'toString';\nvar $toString = Function[TO_STRING];\nvar TPL = ('' + $toString).split(TO_STRING);\n\nrequire('./_core').inspectSource = function (it) {\n  return $toString.call(it);\n};\n\n(module.exports = function (O, key, val, safe) {\n  var isFunction = typeof val == 'function';\n  if (isFunction) has(val, 'name') || hide(val, 'name', key);\n  if (O[key] === val) return;\n  if (isFunction) has(val, SRC) || hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));\n  if (O === global) {\n    O[key] = val;\n  } else if (!safe) {\n    delete O[key];\n    hide(O, key, val);\n  } else if (O[key]) {\n    O[key] = val;\n  } else {\n    hide(O, key, val);\n  }\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, TO_STRING, function toString() {\n  return typeof this == 'function' && this[SRC] || $toString.call(this);\n});\n","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = require('./_an-object');\nvar dPs = require('./_object-dps');\nvar enumBugKeys = require('./_enum-bug-keys');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar Empty = function () { /* empty */ };\nvar PROTOTYPE = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe');\n  var i = enumBugKeys.length;\n  var lt = '<';\n  var gt = '>';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n","var store = require('./_shared')('wks');\nvar uid = require('./_uid');\nvar Symbol = require('./_global').Symbol;\nvar USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function (name) {\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n","module.exports = false;\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar _isWindows = false;\r\nvar _isMacintosh = false;\r\nvar _isLinux = false;\r\nvar _isNative = false;\r\nvar _isWeb = false;\r\nvar _locale = undefined;\r\nvar _language = undefined;\r\nvar _translationsConfigFile = undefined;\r\nexport var LANGUAGE_DEFAULT = 'en';\r\nvar isElectronRenderer = (typeof process !== 'undefined' && typeof process.versions !== 'undefined' && typeof process.versions.electron !== 'undefined' && process.type === 'renderer');\r\n// OS detection\r\nif (typeof navigator === 'object' && !isElectronRenderer) {\r\n    var userAgent = navigator.userAgent;\r\n    _isWindows = userAgent.indexOf('Windows') >= 0;\r\n    _isMacintosh = userAgent.indexOf('Macintosh') >= 0;\r\n    _isLinux = userAgent.indexOf('Linux') >= 0;\r\n    _isWeb = true;\r\n    _locale = navigator.language;\r\n    _language = _locale;\r\n}\r\nelse if (typeof process === 'object') {\r\n    _isWindows = (process.platform === 'win32');\r\n    _isMacintosh = (process.platform === 'darwin');\r\n    _isLinux = (process.platform === 'linux');\r\n    _locale = LANGUAGE_DEFAULT;\r\n    _language = LANGUAGE_DEFAULT;\r\n    var rawNlsConfig = process.env['VSCODE_NLS_CONFIG'];\r\n    if (rawNlsConfig) {\r\n        try {\r\n            var nlsConfig = JSON.parse(rawNlsConfig);\r\n            var resolved = nlsConfig.availableLanguages['*'];\r\n            _locale = nlsConfig.locale;\r\n            // VSCode's default language is 'en'\r\n            _language = resolved ? resolved : LANGUAGE_DEFAULT;\r\n            _translationsConfigFile = nlsConfig._translationsConfigFile;\r\n        }\r\n        catch (e) {\r\n        }\r\n    }\r\n    _isNative = true;\r\n}\r\nvar _platform = 0 /* Web */;\r\nif (_isNative) {\r\n    if (_isMacintosh) {\r\n        _platform = 1 /* Mac */;\r\n    }\r\n    else if (_isWindows) {\r\n        _platform = 3 /* Windows */;\r\n    }\r\n    else if (_isLinux) {\r\n        _platform = 2 /* Linux */;\r\n    }\r\n}\r\nexport var isWindows = _isWindows;\r\nexport var isMacintosh = _isMacintosh;\r\nexport var isLinux = _isLinux;\r\nexport var isNative = _isNative;\r\nexport var isWeb = _isWeb;\r\nvar _globals = (typeof self === 'object' ? self : typeof global === 'object' ? global : {});\r\nexport var globals = _globals;\r\nvar _setImmediate = null;\r\nexport function setImmediate(callback) {\r\n    if (_setImmediate === null) {\r\n        if (globals.setImmediate) {\r\n            _setImmediate = globals.setImmediate.bind(globals);\r\n        }\r\n        else if (typeof process !== 'undefined' && typeof process.nextTick === 'function') {\r\n            _setImmediate = process.nextTick.bind(process);\r\n        }\r\n        else {\r\n            _setImmediate = globals.setTimeout.bind(globals);\r\n        }\r\n    }\r\n    return _setImmediate(callback);\r\n}\r\nexport var OS = (_isMacintosh ? 2 /* Macintosh */ : (_isWindows ? 1 /* Windows */ : 3 /* Linux */));\r\n","// fast apply, http://jsperf.lnkit.com/fast-apply/5\nmodule.exports = function (fn, args, that) {\n  var un = that === undefined;\n  switch (args.length) {\n    case 0: return un ? fn()\n                      : fn.call(that);\n    case 1: return un ? fn(args[0])\n                      : fn.call(that, args[0]);\n    case 2: return un ? fn(args[0], args[1])\n                      : fn.call(that, args[0], args[1]);\n    case 3: return un ? fn(args[0], args[1], args[2])\n                      : fn.call(that, args[0], args[1], args[2]);\n    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n                      : fn.call(that, args[0], args[1], args[2], args[3]);\n  } return fn.apply(that, args);\n};\n","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","// check on default Array iterator\nvar Iterators = require('./_iterators');\nvar ITERATOR = require('./_wks')('iterator');\nvar ArrayProto = Array.prototype;\n\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-aria-container{position:absolute;left:-999em}\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./viewLines.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"860f90da\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has = require('./_has');\nvar toObject = require('./_to-object');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".context-view{position:absolute;z-index:2000}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .lines-content .cigr,.monaco-editor .lines-content .cigra{position:absolute}\", \"\"]);\n\n// exports\n","'use strict';\nvar create = require('./_object-create');\nvar descriptor = require('./_property-desc');\nvar setToStringTag = require('./_set-to-string-tag');\nvar IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });\n\nmodule.exports = function (Constructor, NAME, next) {\n  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n","exports.nextTick = function nextTick(fn) {\n\tsetTimeout(fn, 0);\n};\n\nexports.platform = exports.arch = \nexports.execPath = exports.title = 'browser';\nexports.pid = 1;\nexports.browser = true;\nexports.env = {};\nexports.argv = [];\n\nexports.binding = function (name) {\n\tthrow new Error('No such module. (Possibly not yet loaded)')\n};\n\n(function () {\n    var cwd = '/';\n    var path;\n    exports.cwd = function () { return cwd };\n    exports.chdir = function (dir) {\n        if (!path) path = require('path');\n        cwd = path.resolve(dir, cwd);\n    };\n})();\n\nexports.exit = exports.kill = \nexports.umask = exports.dlopen = \nexports.uptime = exports.memoryUsage = \nexports.uvCounters = function() {};\nexports.features = {};\n","exports = module.exports = require(\"../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor{font-family:-apple-system,BlinkMacSystemFont,Segoe WPC,Segoe UI,HelveticaNeue-Light,Ubuntu,Droid Sans,sans-serif}.monaco-editor.hc-black .monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .action-label,.monaco-editor.vs-dark .monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .action-label,.monaco-menu .monaco-action-bar.vertical .action-item .action-menu-item:focus .action-label{stroke-width:1.2px}.monaco-editor-hover p{margin:0}.monaco-editor.hc-black{-ms-high-contrast-adjust:none}@media screen and (-ms-high-contrast:active){.monaco-editor.vs-dark .view-overlays .current-line,.monaco-editor.vs .view-overlays .current-line{border-color:windowtext!important;border-left:0;border-right:0}.monaco-editor.vs-dark .cursor,.monaco-editor.vs .cursor{background-color:windowtext!important}.monaco-editor.vs-dark .dnd-target,.monaco-editor.vs .dnd-target{border-color:windowtext!important}.monaco-editor.vs-dark .selected-text,.monaco-editor.vs .selected-text{background-color:highlight!important}.monaco-editor.vs-dark .view-line,.monaco-editor.vs .view-line{-ms-high-contrast-adjust:none}.monaco-editor.vs-dark .view-line span,.monaco-editor.vs .view-line span{color:windowtext!important}.monaco-editor.vs-dark .view-line span.inline-selected-text,.monaco-editor.vs .view-line span.inline-selected-text{color:highlighttext!important}.monaco-editor.vs-dark .view-overlays,.monaco-editor.vs .view-overlays{-ms-high-contrast-adjust:none}.monaco-editor.vs-dark .reference-decoration,.monaco-editor.vs-dark .selectionHighlight,.monaco-editor.vs-dark .wordHighlight,.monaco-editor.vs-dark .wordHighlightStrong,.monaco-editor.vs .reference-decoration,.monaco-editor.vs .selectionHighlight,.monaco-editor.vs .wordHighlight,.monaco-editor.vs .wordHighlightStrong{border:2px dotted highlight!important;background:transparent!important;box-sizing:border-box}.monaco-editor.vs-dark .rangeHighlight,.monaco-editor.vs .rangeHighlight{background:transparent!important;border:1px dotted activeborder!important;box-sizing:border-box}.monaco-editor.vs-dark .bracket-match,.monaco-editor.vs .bracket-match{border-color:windowtext!important;background:transparent!important}.monaco-editor.vs-dark .currentFindMatch,.monaco-editor.vs-dark .findMatch,.monaco-editor.vs .currentFindMatch,.monaco-editor.vs .findMatch{border:2px dotted activeborder!important;background:transparent!important;box-sizing:border-box}.monaco-editor.vs-dark .find-widget,.monaco-editor.vs .find-widget{border:1px solid windowtext}.monaco-editor.vs-dark .monaco-list .monaco-list-row,.monaco-editor.vs .monaco-list .monaco-list-row{-ms-high-contrast-adjust:none;color:windowtext!important}.monaco-editor.vs-dark .monaco-list .monaco-list-row.focused,.monaco-editor.vs .monaco-list .monaco-list-row.focused{color:highlighttext!important;background-color:highlight!important}.monaco-editor.vs-dark .monaco-list .monaco-list-row:hover,.monaco-editor.vs .monaco-list .monaco-list-row:hover{background:transparent!important;border:1px solid highlight;box-sizing:border-box}.monaco-editor.vs-dark .monaco-tree .monaco-tree-row,.monaco-editor.vs .monaco-tree .monaco-tree-row{-ms-high-contrast-adjust:none;color:windowtext!important}.monaco-editor.vs-dark .monaco-tree .monaco-tree-row.focused,.monaco-editor.vs-dark .monaco-tree .monaco-tree-row.selected,.monaco-editor.vs .monaco-tree .monaco-tree-row.focused,.monaco-editor.vs .monaco-tree .monaco-tree-row.selected{color:highlighttext!important;background-color:highlight!important}.monaco-editor.vs-dark .monaco-tree .monaco-tree-row:hover,.monaco-editor.vs .monaco-tree .monaco-tree-row:hover{background:transparent!important;border:1px solid highlight;box-sizing:border-box}.monaco-editor.vs-dark .monaco-scrollable-element>.scrollbar,.monaco-editor.vs .monaco-scrollable-element>.scrollbar{-ms-high-contrast-adjust:none;background:background!important;border:1px solid windowtext;box-sizing:border-box}.monaco-editor.vs-dark .monaco-scrollable-element>.scrollbar>.slider,.monaco-editor.vs .monaco-scrollable-element>.scrollbar>.slider{background:windowtext!important}.monaco-editor.vs-dark .monaco-scrollable-element>.scrollbar>.slider.active,.monaco-editor.vs-dark .monaco-scrollable-element>.scrollbar>.slider:hover,.monaco-editor.vs .monaco-scrollable-element>.scrollbar>.slider.active,.monaco-editor.vs .monaco-scrollable-element>.scrollbar>.slider:hover{background:highlight!important}.monaco-editor.vs-dark .decorationsOverviewRuler,.monaco-editor.vs .decorationsOverviewRuler{opacity:0}.monaco-editor.vs-dark .minimap,.monaco-editor.vs .minimap{display:none}.monaco-editor.vs-dark .squiggly-d-error,.monaco-editor.vs .squiggly-d-error{background:transparent!important;border-bottom:4px double #e47777}.monaco-editor.vs-dark .squiggly-b-info,.monaco-editor.vs-dark .squiggly-c-warning,.monaco-editor.vs .squiggly-b-info,.monaco-editor.vs .squiggly-c-warning{border-bottom:4px double #71b771}.monaco-editor.vs-dark .squiggly-a-hint,.monaco-editor.vs .squiggly-a-hint{border-bottom:4px double #6c6c6c}.monaco-editor.vs-dark .monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .action-label,.monaco-editor.vs .monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .action-label{-ms-high-contrast-adjust:none;color:highlighttext!important;background-color:highlight!important}.monaco-editor.vs-dark .monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .action-label,.monaco-editor.vs .monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .action-label{-ms-high-contrast-adjust:none;background:transparent!important;border:1px solid highlight;box-sizing:border-box}.monaco-diff-editor.vs-dark .diffOverviewRuler,.monaco-diff-editor.vs .diffOverviewRuler{display:none}.monaco-editor.vs-dark .line-delete,.monaco-editor.vs-dark .line-insert,.monaco-editor.vs .line-delete,.monaco-editor.vs .line-insert{background:transparent!important;border:1px solid highlight!important;box-sizing:border-box}.monaco-editor.vs-dark .char-delete,.monaco-editor.vs-dark .char-insert,.monaco-editor.vs .char-delete,.monaco-editor.vs .char-insert{background:transparent!important}}\", \"\"]);\n\n// exports\n","// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .lines-content .cdr{position:absolute}\", \"\"]);\n\n// exports\n","/**\n * Translates the list format produced by css-loader into something\n * easier to manipulate.\n */\nexport default function listToStyles (parentId, list) {\n  var styles = []\n  var newStyles = {}\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i]\n    var id = item[0]\n    var css = item[1]\n    var media = item[2]\n    var sourceMap = item[3]\n    var part = {\n      id: parentId + ':' + i,\n      css: css,\n      media: media,\n      sourceMap: sourceMap\n    }\n    if (!newStyles[id]) {\n      styles.push(newStyles[id] = { id: id, parts: [part] })\n    } else {\n      newStyles[id].parts.push(part)\n    }\n  }\n  return styles\n}\n","/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n  Modified by Evan You @yyx990803\n*/\n\nimport listToStyles from './listToStyles'\n\nvar hasDocument = typeof document !== 'undefined'\n\nif (typeof DEBUG !== 'undefined' && DEBUG) {\n  if (!hasDocument) {\n    throw new Error(\n    'vue-style-loader cannot be used in a non-browser environment. ' +\n    \"Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.\"\n  ) }\n}\n\n/*\ntype StyleObject = {\n  id: number;\n  parts: Array<StyleObjectPart>\n}\n\ntype StyleObjectPart = {\n  css: string;\n  media: string;\n  sourceMap: ?string\n}\n*/\n\nvar stylesInDom = {/*\n  [id: number]: {\n    id: number,\n    refs: number,\n    parts: Array<(obj?: StyleObjectPart) => void>\n  }\n*/}\n\nvar head = hasDocument && (document.head || document.getElementsByTagName('head')[0])\nvar singletonElement = null\nvar singletonCounter = 0\nvar isProduction = false\nvar noop = function () {}\nvar options = null\nvar ssrIdKey = 'data-vue-ssr-id'\n\n// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n// tags it will allow on a page\nvar isOldIE = typeof navigator !== 'undefined' && /msie [6-9]\\b/.test(navigator.userAgent.toLowerCase())\n\nexport default function addStylesClient (parentId, list, _isProduction, _options) {\n  isProduction = _isProduction\n\n  options = _options || {}\n\n  var styles = listToStyles(parentId, list)\n  addStylesToDom(styles)\n\n  return function update (newList) {\n    var mayRemove = []\n    for (var i = 0; i < styles.length; i++) {\n      var item = styles[i]\n      var domStyle = stylesInDom[item.id]\n      domStyle.refs--\n      mayRemove.push(domStyle)\n    }\n    if (newList) {\n      styles = listToStyles(parentId, newList)\n      addStylesToDom(styles)\n    } else {\n      styles = []\n    }\n    for (var i = 0; i < mayRemove.length; i++) {\n      var domStyle = mayRemove[i]\n      if (domStyle.refs === 0) {\n        for (var j = 0; j < domStyle.parts.length; j++) {\n          domStyle.parts[j]()\n        }\n        delete stylesInDom[domStyle.id]\n      }\n    }\n  }\n}\n\nfunction addStylesToDom (styles /* Array<StyleObject> */) {\n  for (var i = 0; i < styles.length; i++) {\n    var item = styles[i]\n    var domStyle = stylesInDom[item.id]\n    if (domStyle) {\n      domStyle.refs++\n      for (var j = 0; j < domStyle.parts.length; j++) {\n        domStyle.parts[j](item.parts[j])\n      }\n      for (; j < item.parts.length; j++) {\n        domStyle.parts.push(addStyle(item.parts[j]))\n      }\n      if (domStyle.parts.length > item.parts.length) {\n        domStyle.parts.length = item.parts.length\n      }\n    } else {\n      var parts = []\n      for (var j = 0; j < item.parts.length; j++) {\n        parts.push(addStyle(item.parts[j]))\n      }\n      stylesInDom[item.id] = { id: item.id, refs: 1, parts: parts }\n    }\n  }\n}\n\nfunction createStyleElement () {\n  var styleElement = document.createElement('style')\n  styleElement.type = 'text/css'\n  head.appendChild(styleElement)\n  return styleElement\n}\n\nfunction addStyle (obj /* StyleObjectPart */) {\n  var update, remove\n  var styleElement = document.querySelector('style[' + ssrIdKey + '~=\"' + obj.id + '\"]')\n\n  if (styleElement) {\n    if (isProduction) {\n      // has SSR styles and in production mode.\n      // simply do nothing.\n      return noop\n    } else {\n      // has SSR styles but in dev mode.\n      // for some reason Chrome can't handle source map in server-rendered\n      // style tags - source maps in <style> only works if the style tag is\n      // created and inserted dynamically. So we remove the server rendered\n      // styles and inject new ones.\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  if (isOldIE) {\n    // use singleton mode for IE9.\n    var styleIndex = singletonCounter++\n    styleElement = singletonElement || (singletonElement = createStyleElement())\n    update = applyToSingletonTag.bind(null, styleElement, styleIndex, false)\n    remove = applyToSingletonTag.bind(null, styleElement, styleIndex, true)\n  } else {\n    // use multi-style-tag mode in all other cases\n    styleElement = createStyleElement()\n    update = applyToTag.bind(null, styleElement)\n    remove = function () {\n      styleElement.parentNode.removeChild(styleElement)\n    }\n  }\n\n  update(obj)\n\n  return function updateStyle (newObj /* StyleObjectPart */) {\n    if (newObj) {\n      if (newObj.css === obj.css &&\n          newObj.media === obj.media &&\n          newObj.sourceMap === obj.sourceMap) {\n        return\n      }\n      update(obj = newObj)\n    } else {\n      remove()\n    }\n  }\n}\n\nvar replaceText = (function () {\n  var textStore = []\n\n  return function (index, replacement) {\n    textStore[index] = replacement\n    return textStore.filter(Boolean).join('\\n')\n  }\n})()\n\nfunction applyToSingletonTag (styleElement, index, remove, obj) {\n  var css = remove ? '' : obj.css\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = replaceText(index, css)\n  } else {\n    var cssNode = document.createTextNode(css)\n    var childNodes = styleElement.childNodes\n    if (childNodes[index]) styleElement.removeChild(childNodes[index])\n    if (childNodes.length) {\n      styleElement.insertBefore(cssNode, childNodes[index])\n    } else {\n      styleElement.appendChild(cssNode)\n    }\n  }\n}\n\nfunction applyToTag (styleElement, obj) {\n  var css = obj.css\n  var media = obj.media\n  var sourceMap = obj.sourceMap\n\n  if (media) {\n    styleElement.setAttribute('media', media)\n  }\n  if (options.ssrId) {\n    styleElement.setAttribute(ssrIdKey, obj.id)\n  }\n\n  if (sourceMap) {\n    // https://developer.chrome.com/devtools/docs/javascript-debugging\n    // this makes source maps inside style tags work properly in Chrome\n    css += '\\n/*# sourceURL=' + sourceMap.sources[0] + ' */'\n    // http://stackoverflow.com/a/26603875\n    css += '\\n/*# sourceMappingURL=data:application/json;base64,' + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + ' */'\n  }\n\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild)\n    }\n    styleElement.appendChild(document.createTextNode(css))\n  }\n}\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-diff-editor .diff-review-line-number{text-align:right;display:inline-block}.monaco-diff-editor .diff-review{position:absolute;-webkit-user-select:none;-ms-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none}.monaco-diff-editor .diff-review-summary{padding-left:10px}.monaco-diff-editor .diff-review-shadow{position:absolute}.monaco-diff-editor .diff-review-row{white-space:pre}.monaco-diff-editor .diff-review-table{display:table;min-width:100%}.monaco-diff-editor .diff-review-row{display:table-row;width:100%}.monaco-diff-editor .diff-review-cell{display:table-cell}.monaco-diff-editor .diff-review-spacer{display:inline-block;width:10px}.monaco-diff-editor .diff-review-actions{display:inline-block;position:absolute;right:10px;top:2px}.monaco-diff-editor .diff-review-actions .action-label{width:16px;height:16px;margin:2px 0}.monaco-diff-editor .action-label.icon.close-diff-review{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMyAzIDE2IDE2Ij48cGF0aCBmaWxsPSIjNDI0MjQyIiBkPSJNMTIuNTk3IDExLjA0MmwyLjgwMyAyLjgwMy0xLjU1NiAxLjU1NS0yLjgwMi0yLjgwMkw4LjIzOSAxNS40bC0xLjU1Ni0xLjU1NSAyLjgwMi0yLjgwMy0yLjgwMi0yLjgwMyAxLjU1NS0xLjU1NiAyLjgwNCAyLjgwMyAyLjgwMy0yLjgwM0wxNS40IDguMjM5eiIvPjwvc3ZnPg==\\\") 50% no-repeat}.monaco-diff-editor.hc-black .action-label.icon.close-diff-review,.monaco-diff-editor.vs-dark .action-label.icon.close-diff-review{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMyAzIDE2IDE2Ij48cGF0aCBmaWxsPSIjZThlOGU4IiBkPSJNMTIuNTk3IDExLjA0MmwyLjgwMyAyLjgwMy0xLjU1NiAxLjU1NS0yLjgwMi0yLjgwMkw4LjIzOSAxNS40bC0xLjU1Ni0xLjU1NSAyLjgwMi0yLjgwMy0yLjgwMi0yLjgwMyAxLjU1NS0xLjU1NiAyLjgwNCAyLjgwMyAyLjgwMy0yLjgwM0wxNS40IDguMjM5eiIvPjwvc3ZnPg==\\\") 50% no-repeat}\", \"\"]);\n\n// exports\n","var ctx = require('./_ctx');\nvar call = require('./_iter-call');\nvar isArrayIter = require('./_is-array-iter');\nvar anObject = require('./_an-object');\nvar toLength = require('./_to-length');\nvar getIterFn = require('./core.get-iterator-method');\nvar BREAK = {};\nvar RETURN = {};\nvar exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {\n  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);\n  var f = ctx(fn, that, entries ? 2 : 1);\n  var index = 0;\n  var length, step, iterator, result;\n  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {\n    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n    if (result === BREAK || result === RETURN) return result;\n  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {\n    result = call(iterator, f, step.value, entries);\n    if (result === BREAK || result === RETURN) return result;\n  }\n};\nexports.BREAK = BREAK;\nexports.RETURN = RETURN;\n","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./contextview.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"57d89641\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./currentLineMarginHighlight.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"07ce9097\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./aria.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"e2a429e4\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","exports.f = {}.propertyIsEnumerable;\n","/**\n * Extracted from https://github.com/winjs/winjs\n * Version: 4.4.0(ec3258a9f3a36805a187848984e3bb938044178d)\n * Copyright (c) Microsoft Corporation.\n * All Rights Reserved.\n * Licensed under the MIT License.\n */\nvar __winjs_exports;\n\n(function() {\n\nvar _modules = Object.create(null);//{};\n_modules[\"WinJS/Core/_WinJS\"] = {};\n\nvar _winjs = function(moduleId, deps, factory) {\n    var exports = {};\n    var exportsPassedIn = false;\n\n    var depsValues = deps.map(function(dep) {\n        if (dep === 'exports') {\n            exportsPassedIn = true;\n            return exports;\n        }\n        return _modules[dep];\n    });\n\n    var result = factory.apply({}, depsValues);\n\n    _modules[moduleId] = exportsPassedIn ? exports : result;\n};\n\n\n_winjs(\"WinJS/Core/_Global\", [], function () {\n    \"use strict\";\n\n    // Appease jshint\n    /* global window, self, global */\n\n    var globalObject =\n        typeof window !== 'undefined' ? window :\n        typeof self !== 'undefined' ? self :\n        typeof global !== 'undefined' ? global :\n        {};\n    return globalObject;\n});\n\n_winjs(\"WinJS/Core/_BaseCoreUtils\", [\"WinJS/Core/_Global\"], function baseCoreUtilsInit(_Global) {\n    \"use strict\";\n\n    var hasWinRT = !!_Global.Windows;\n\n    function markSupportedForProcessing(func) {\n        /// <signature helpKeyword=\"WinJS.Utilities.markSupportedForProcessing\">\n        /// <summary locid=\"WinJS.Utilities.markSupportedForProcessing\">\n        /// Marks a function as being compatible with declarative processing, such as WinJS.UI.processAll\n        /// or WinJS.Binding.processAll.\n        /// </summary>\n        /// <param name=\"func\" type=\"Function\" locid=\"WinJS.Utilities.markSupportedForProcessing_p:func\">\n        /// The function to be marked as compatible with declarative processing.\n        /// </param>\n        /// <returns type=\"Function\" locid=\"WinJS.Utilities.markSupportedForProcessing_returnValue\">\n        /// The input function.\n        /// </returns>\n        /// </signature>\n        func.supportedForProcessing = true;\n        return func;\n    }\n\n    var actualSetImmediate = null;\n\n    return {\n        hasWinRT: hasWinRT,\n        markSupportedForProcessing: markSupportedForProcessing,\n        _setImmediate: function (callback) {\n            // BEGIN monaco change\n            if (actualSetImmediate === null) {\n                if (_Global.setImmediate) {\n                    actualSetImmediate = _Global.setImmediate.bind(_Global);\n                } else if (typeof process !== 'undefined' && typeof process.nextTick === 'function') {\n                    actualSetImmediate = process.nextTick.bind(process);\n                } else {\n                    actualSetImmediate = _Global.setTimeout.bind(_Global);\n                }\n            }\n            actualSetImmediate(callback);\n            // END monaco change\n        }\n    };\n});\n_winjs(\"WinJS/Core/_WriteProfilerMark\", [\"WinJS/Core/_Global\"], function profilerInit(_Global) {\n    \"use strict\";\n\n    return _Global.msWriteProfilerMark || function () { };\n});\n_winjs(\"WinJS/Core/_Base\", [\"WinJS/Core/_WinJS\",\"WinJS/Core/_Global\",\"WinJS/Core/_BaseCoreUtils\",\"WinJS/Core/_WriteProfilerMark\"], function baseInit(_WinJS, _Global, _BaseCoreUtils, _WriteProfilerMark) {\n    \"use strict\";\n\n    function initializeProperties(target, members, prefix) {\n        var keys = Object.keys(members);\n        var isArray = Array.isArray(target);\n        var properties;\n        var i, len;\n        for (i = 0, len = keys.length; i < len; i++) {\n            var key = keys[i];\n            var enumerable = key.charCodeAt(0) !== /*_*/95;\n            var member = members[key];\n            if (member && typeof member === 'object') {\n                if (member.value !== undefined || typeof member.get === 'function' || typeof member.set === 'function') {\n                    if (member.enumerable === undefined) {\n                        member.enumerable = enumerable;\n                    }\n                    if (prefix && member.setName && typeof member.setName === 'function') {\n                        member.setName(prefix + \".\" + key);\n                    }\n                    properties = properties || {};\n                    properties[key] = member;\n                    continue;\n                }\n            }\n            if (!enumerable) {\n                properties = properties || {};\n                properties[key] = { value: member, enumerable: enumerable, configurable: true, writable: true };\n                continue;\n            }\n            if (isArray) {\n                target.forEach(function (target) {\n                    target[key] = member;\n                });\n            } else {\n                target[key] = member;\n            }\n        }\n        if (properties) {\n            if (isArray) {\n                target.forEach(function (target) {\n                    Object.defineProperties(target, properties);\n                });\n            } else {\n                Object.defineProperties(target, properties);\n            }\n        }\n    }\n\n    (function () {\n\n        var _rootNamespace = _WinJS;\n        if (!_rootNamespace.Namespace) {\n            _rootNamespace.Namespace = Object.create(Object.prototype);\n        }\n\n        function createNamespace(parentNamespace, name) {\n            var currentNamespace = parentNamespace || {};\n            if (name) {\n                var namespaceFragments = name.split(\".\");\n                if (currentNamespace === _Global && namespaceFragments[0] === \"WinJS\") {\n                    currentNamespace = _WinJS;\n                    namespaceFragments.splice(0, 1);\n                }\n                for (var i = 0, len = namespaceFragments.length; i < len; i++) {\n                    var namespaceName = namespaceFragments[i];\n                    if (!currentNamespace[namespaceName]) {\n                        Object.defineProperty(currentNamespace, namespaceName,\n                            { value: {}, writable: false, enumerable: true, configurable: true }\n                        );\n                    }\n                    currentNamespace = currentNamespace[namespaceName];\n                }\n            }\n            return currentNamespace;\n        }\n\n        function defineWithParent(parentNamespace, name, members) {\n            /// <signature helpKeyword=\"WinJS.Namespace.defineWithParent\">\n            /// <summary locid=\"WinJS.Namespace.defineWithParent\">\n            /// Defines a new namespace with the specified name under the specified parent namespace.\n            /// </summary>\n            /// <param name=\"parentNamespace\" type=\"Object\" locid=\"WinJS.Namespace.defineWithParent_p:parentNamespace\">\n            /// The parent namespace.\n            /// </param>\n            /// <param name=\"name\" type=\"String\" locid=\"WinJS.Namespace.defineWithParent_p:name\">\n            /// The name of the new namespace.\n            /// </param>\n            /// <param name=\"members\" type=\"Object\" locid=\"WinJS.Namespace.defineWithParent_p:members\">\n            /// The members of the new namespace.\n            /// </param>\n            /// <returns type=\"Object\" locid=\"WinJS.Namespace.defineWithParent_returnValue\">\n            /// The newly-defined namespace.\n            /// </returns>\n            /// </signature>\n            var currentNamespace = createNamespace(parentNamespace, name);\n\n            if (members) {\n                initializeProperties(currentNamespace, members, name || \"<ANONYMOUS>\");\n            }\n\n            return currentNamespace;\n        }\n\n        function define(name, members) {\n            /// <signature helpKeyword=\"WinJS.Namespace.define\">\n            /// <summary locid=\"WinJS.Namespace.define\">\n            /// Defines a new namespace with the specified name.\n            /// </summary>\n            /// <param name=\"name\" type=\"String\" locid=\"WinJS.Namespace.define_p:name\">\n            /// The name of the namespace. This could be a dot-separated name for nested namespaces.\n            /// </param>\n            /// <param name=\"members\" type=\"Object\" locid=\"WinJS.Namespace.define_p:members\">\n            /// The members of the new namespace.\n            /// </param>\n            /// <returns type=\"Object\" locid=\"WinJS.Namespace.define_returnValue\">\n            /// The newly-defined namespace.\n            /// </returns>\n            /// </signature>\n            return defineWithParent(_Global, name, members);\n        }\n\n        var LazyStates = {\n            uninitialized: 1,\n            working: 2,\n            initialized: 3,\n        };\n\n        function lazy(f) {\n            var name;\n            var state = LazyStates.uninitialized;\n            var result;\n            return {\n                setName: function (value) {\n                    name = value;\n                },\n                get: function () {\n                    switch (state) {\n                        case LazyStates.initialized:\n                            return result;\n\n                        case LazyStates.uninitialized:\n                            state = LazyStates.working;\n                            try {\n                                _WriteProfilerMark(\"WinJS.Namespace._lazy:\" + name + \",StartTM\");\n                                result = f();\n                            } finally {\n                                _WriteProfilerMark(\"WinJS.Namespace._lazy:\" + name + \",StopTM\");\n                                state = LazyStates.uninitialized;\n                            }\n                            f = null;\n                            state = LazyStates.initialized;\n                            return result;\n\n                        case LazyStates.working:\n                            throw \"Illegal: reentrancy on initialization\";\n\n                        default:\n                            throw \"Illegal\";\n                    }\n                },\n                set: function (value) {\n                    switch (state) {\n                        case LazyStates.working:\n                            throw \"Illegal: reentrancy on initialization\";\n\n                        default:\n                            state = LazyStates.initialized;\n                            result = value;\n                            break;\n                    }\n                },\n                enumerable: true,\n                configurable: true,\n            };\n        }\n\n        // helper for defining AMD module members\n        function moduleDefine(exports, name, members) {\n            var target = [exports];\n            var publicNS = null;\n            if (name) {\n                publicNS = createNamespace(_Global, name);\n                target.push(publicNS);\n            }\n            initializeProperties(target, members, name || \"<ANONYMOUS>\");\n            return publicNS;\n        }\n\n        // Establish members of the \"WinJS.Namespace\" namespace\n        Object.defineProperties(_rootNamespace.Namespace, {\n\n            defineWithParent: { value: defineWithParent, writable: true, enumerable: true, configurable: true },\n\n            define: { value: define, writable: true, enumerable: true, configurable: true },\n\n            _lazy: { value: lazy, writable: true, enumerable: true, configurable: true },\n\n            _moduleDefine: { value: moduleDefine, writable: true, enumerable: true, configurable: true }\n\n        });\n\n    })();\n\n    (function () {\n\n        function define(constructor, instanceMembers, staticMembers) {\n            /// <signature helpKeyword=\"WinJS.Class.define\">\n            /// <summary locid=\"WinJS.Class.define\">\n            /// Defines a class using the given constructor and the specified instance members.\n            /// </summary>\n            /// <param name=\"constructor\" type=\"Function\" locid=\"WinJS.Class.define_p:constructor\">\n            /// A constructor function that is used to instantiate this class.\n            /// </param>\n            /// <param name=\"instanceMembers\" type=\"Object\" locid=\"WinJS.Class.define_p:instanceMembers\">\n            /// The set of instance fields, properties, and methods made available on the class.\n            /// </param>\n            /// <param name=\"staticMembers\" type=\"Object\" locid=\"WinJS.Class.define_p:staticMembers\">\n            /// The set of static fields, properties, and methods made available on the class.\n            /// </param>\n            /// <returns type=\"Function\" locid=\"WinJS.Class.define_returnValue\">\n            /// The newly-defined class.\n            /// </returns>\n            /// </signature>\n            constructor = constructor || function () { };\n            _BaseCoreUtils.markSupportedForProcessing(constructor);\n            if (instanceMembers) {\n                initializeProperties(constructor.prototype, instanceMembers);\n            }\n            if (staticMembers) {\n                initializeProperties(constructor, staticMembers);\n            }\n            return constructor;\n        }\n\n        function derive(baseClass, constructor, instanceMembers, staticMembers) {\n            /// <signature helpKeyword=\"WinJS.Class.derive\">\n            /// <summary locid=\"WinJS.Class.derive\">\n            /// Creates a sub-class based on the supplied baseClass parameter, using prototypal inheritance.\n            /// </summary>\n            /// <param name=\"baseClass\" type=\"Function\" locid=\"WinJS.Class.derive_p:baseClass\">\n            /// The class to inherit from.\n            /// </param>\n            /// <param name=\"constructor\" type=\"Function\" locid=\"WinJS.Class.derive_p:constructor\">\n            /// A constructor function that is used to instantiate this class.\n            /// </param>\n            /// <param name=\"instanceMembers\" type=\"Object\" locid=\"WinJS.Class.derive_p:instanceMembers\">\n            /// The set of instance fields, properties, and methods to be made available on the class.\n            /// </param>\n            /// <param name=\"staticMembers\" type=\"Object\" locid=\"WinJS.Class.derive_p:staticMembers\">\n            /// The set of static fields, properties, and methods to be made available on the class.\n            /// </param>\n            /// <returns type=\"Function\" locid=\"WinJS.Class.derive_returnValue\">\n            /// The newly-defined class.\n            /// </returns>\n            /// </signature>\n            if (baseClass) {\n                constructor = constructor || function () { };\n                var basePrototype = baseClass.prototype;\n                constructor.prototype = Object.create(basePrototype);\n                _BaseCoreUtils.markSupportedForProcessing(constructor);\n                Object.defineProperty(constructor.prototype, \"constructor\", { value: constructor, writable: true, configurable: true, enumerable: true });\n                if (instanceMembers) {\n                    initializeProperties(constructor.prototype, instanceMembers);\n                }\n                if (staticMembers) {\n                    initializeProperties(constructor, staticMembers);\n                }\n                return constructor;\n            } else {\n                return define(constructor, instanceMembers, staticMembers);\n            }\n        }\n\n        function mix(constructor) {\n            /// <signature helpKeyword=\"WinJS.Class.mix\">\n            /// <summary locid=\"WinJS.Class.mix\">\n            /// Defines a class using the given constructor and the union of the set of instance members\n            /// specified by all the mixin objects. The mixin parameter list is of variable length.\n            /// </summary>\n            /// <param name=\"constructor\" locid=\"WinJS.Class.mix_p:constructor\">\n            /// A constructor function that is used to instantiate this class.\n            /// </param>\n            /// <returns type=\"Function\" locid=\"WinJS.Class.mix_returnValue\">\n            /// The newly-defined class.\n            /// </returns>\n            /// </signature>\n            constructor = constructor || function () { };\n            var i, len;\n            for (i = 1, len = arguments.length; i < len; i++) {\n                initializeProperties(constructor.prototype, arguments[i]);\n            }\n            return constructor;\n        }\n\n        // Establish members of \"WinJS.Class\" namespace\n        _WinJS.Namespace.define(\"WinJS.Class\", {\n            define: define,\n            derive: derive,\n            mix: mix\n        });\n\n    })();\n\n    return {\n        Namespace: _WinJS.Namespace,\n        Class: _WinJS.Class\n    };\n\n});\n_winjs(\"WinJS/Core/_ErrorFromName\", [\"WinJS/Core/_Base\"], function errorsInit(_Base) {\n    \"use strict\";\n\n    var ErrorFromName = _Base.Class.derive(Error, function (name, message) {\n        /// <signature helpKeyword=\"WinJS.ErrorFromName\">\n        /// <summary locid=\"WinJS.ErrorFromName\">\n        /// Creates an Error object with the specified name and message properties.\n        /// </summary>\n        /// <param name=\"name\" type=\"String\" locid=\"WinJS.ErrorFromName_p:name\">The name of this error. The name is meant to be consumed programmatically and should not be localized.</param>\n        /// <param name=\"message\" type=\"String\" optional=\"true\" locid=\"WinJS.ErrorFromName_p:message\">The message for this error. The message is meant to be consumed by humans and should be localized.</param>\n        /// <returns type=\"Error\" locid=\"WinJS.ErrorFromName_returnValue\">Error instance with .name and .message properties populated</returns>\n        /// </signature>\n        this.name = name;\n        this.message = message || name;\n    }, {\n        /* empty */\n    }, {\n        supportedForProcessing: false,\n    });\n\n    _Base.Namespace.define(\"WinJS\", {\n        // ErrorFromName establishes a simple pattern for returning error codes.\n        //\n        ErrorFromName: ErrorFromName\n    });\n\n    return ErrorFromName;\n\n});\n\n\n_winjs(\"WinJS/Core/_Events\", [\"exports\",\"WinJS/Core/_Base\"], function eventsInit(exports, _Base) {\n    \"use strict\";\n\n\n    function createEventProperty(name) {\n        var eventPropStateName = \"_on\" + name + \"state\";\n\n        return {\n            get: function () {\n                var state = this[eventPropStateName];\n                return state && state.userHandler;\n            },\n            set: function (handler) {\n                var state = this[eventPropStateName];\n                if (handler) {\n                    if (!state) {\n                        state = { wrapper: function (evt) { return state.userHandler(evt); }, userHandler: handler };\n                        Object.defineProperty(this, eventPropStateName, { value: state, enumerable: false, writable:true, configurable: true });\n                        this.addEventListener(name, state.wrapper, false);\n                    }\n                    state.userHandler = handler;\n                } else if (state) {\n                    this.removeEventListener(name, state.wrapper, false);\n                    this[eventPropStateName] = null;\n                }\n            },\n            enumerable: true\n        };\n    }\n\n    function createEventProperties() {\n        /// <signature helpKeyword=\"WinJS.Utilities.createEventProperties\">\n        /// <summary locid=\"WinJS.Utilities.createEventProperties\">\n        /// Creates an object that has one property for each name passed to the function.\n        /// </summary>\n        /// <param name=\"events\" locid=\"WinJS.Utilities.createEventProperties_p:events\">\n        /// A variable list of property names.\n        /// </param>\n        /// <returns type=\"Object\" locid=\"WinJS.Utilities.createEventProperties_returnValue\">\n        /// The object with the specified properties. The names of the properties are prefixed with 'on'.\n        /// </returns>\n        /// </signature>\n        var props = {};\n        for (var i = 0, len = arguments.length; i < len; i++) {\n            var name = arguments[i];\n            props[\"on\" + name] = createEventProperty(name);\n        }\n        return props;\n    }\n\n    var EventMixinEvent = _Base.Class.define(\n        function EventMixinEvent_ctor(type, detail, target) {\n            this.detail = detail;\n            this.target = target;\n            this.timeStamp = Date.now();\n            this.type = type;\n        },\n        {\n            bubbles: { value: false, writable: false },\n            cancelable: { value: false, writable: false },\n            currentTarget: {\n                get: function () { return this.target; }\n            },\n            defaultPrevented: {\n                get: function () { return this._preventDefaultCalled; }\n            },\n            trusted: { value: false, writable: false },\n            eventPhase: { value: 0, writable: false },\n            target: null,\n            timeStamp: null,\n            type: null,\n\n            preventDefault: function () {\n                this._preventDefaultCalled = true;\n            },\n            stopImmediatePropagation: function () {\n                this._stopImmediatePropagationCalled = true;\n            },\n            stopPropagation: function () {\n            }\n        }, {\n            supportedForProcessing: false,\n        }\n    );\n\n    var eventMixin = {\n        _listeners: null,\n\n        addEventListener: function (type, listener, useCapture) {\n            /// <signature helpKeyword=\"WinJS.Utilities.eventMixin.addEventListener\">\n            /// <summary locid=\"WinJS.Utilities.eventMixin.addEventListener\">\n            /// Adds an event listener to the control.\n            /// </summary>\n            /// <param name=\"type\" locid=\"WinJS.Utilities.eventMixin.addEventListener_p:type\">\n            /// The type (name) of the event.\n            /// </param>\n            /// <param name=\"listener\" locid=\"WinJS.Utilities.eventMixin.addEventListener_p:listener\">\n            /// The listener to invoke when the event is raised.\n            /// </param>\n            /// <param name=\"useCapture\" locid=\"WinJS.Utilities.eventMixin.addEventListener_p:useCapture\">\n            /// if true initiates capture, otherwise false.\n            /// </param>\n            /// </signature>\n            useCapture = useCapture || false;\n            this._listeners = this._listeners || {};\n            var eventListeners = (this._listeners[type] = this._listeners[type] || []);\n            for (var i = 0, len = eventListeners.length; i < len; i++) {\n                var l = eventListeners[i];\n                if (l.useCapture === useCapture && l.listener === listener) {\n                    return;\n                }\n            }\n            eventListeners.push({ listener: listener, useCapture: useCapture });\n        },\n        dispatchEvent: function (type, details) {\n            /// <signature helpKeyword=\"WinJS.Utilities.eventMixin.dispatchEvent\">\n            /// <summary locid=\"WinJS.Utilities.eventMixin.dispatchEvent\">\n            /// Raises an event of the specified type and with the specified additional properties.\n            /// </summary>\n            /// <param name=\"type\" locid=\"WinJS.Utilities.eventMixin.dispatchEvent_p:type\">\n            /// The type (name) of the event.\n            /// </param>\n            /// <param name=\"details\" locid=\"WinJS.Utilities.eventMixin.dispatchEvent_p:details\">\n            /// The set of additional properties to be attached to the event object when the event is raised.\n            /// </param>\n            /// <returns type=\"Boolean\" locid=\"WinJS.Utilities.eventMixin.dispatchEvent_returnValue\">\n            /// true if preventDefault was called on the event.\n            /// </returns>\n            /// </signature>\n            var listeners = this._listeners && this._listeners[type];\n            if (listeners) {\n                var eventValue = new EventMixinEvent(type, details, this);\n                // Need to copy the array to protect against people unregistering while we are dispatching\n                listeners = listeners.slice(0, listeners.length);\n                for (var i = 0, len = listeners.length; i < len && !eventValue._stopImmediatePropagationCalled; i++) {\n                    listeners[i].listener(eventValue);\n                }\n                return eventValue.defaultPrevented || false;\n            }\n            return false;\n        },\n        removeEventListener: function (type, listener, useCapture) {\n            /// <signature helpKeyword=\"WinJS.Utilities.eventMixin.removeEventListener\">\n            /// <summary locid=\"WinJS.Utilities.eventMixin.removeEventListener\">\n            /// Removes an event listener from the control.\n            /// </summary>\n            /// <param name=\"type\" locid=\"WinJS.Utilities.eventMixin.removeEventListener_p:type\">\n            /// The type (name) of the event.\n            /// </param>\n            /// <param name=\"listener\" locid=\"WinJS.Utilities.eventMixin.removeEventListener_p:listener\">\n            /// The listener to remove.\n            /// </param>\n            /// <param name=\"useCapture\" locid=\"WinJS.Utilities.eventMixin.removeEventListener_p:useCapture\">\n            /// Specifies whether to initiate capture.\n            /// </param>\n            /// </signature>\n            useCapture = useCapture || false;\n            var listeners = this._listeners && this._listeners[type];\n            if (listeners) {\n                for (var i = 0, len = listeners.length; i < len; i++) {\n                    var l = listeners[i];\n                    if (l.listener === listener && l.useCapture === useCapture) {\n                        listeners.splice(i, 1);\n                        if (listeners.length === 0) {\n                            delete this._listeners[type];\n                        }\n                        // Only want to remove one element for each call to removeEventListener\n                        break;\n                    }\n                }\n            }\n        }\n    };\n\n    _Base.Namespace._moduleDefine(exports, \"WinJS.Utilities\", {\n        _createEventProperty: createEventProperty,\n        createEventProperties: createEventProperties,\n        eventMixin: eventMixin\n    });\n\n});\n\n\n_winjs(\"WinJS/Core/_Trace\", [\"WinJS/Core/_Global\"], function traceInit(_Global) {\n    \"use strict\";\n\n    function nop(v) {\n        return v;\n    }\n\n    return {\n        _traceAsyncOperationStarting: (_Global.Debug && _Global.Debug.msTraceAsyncOperationStarting && _Global.Debug.msTraceAsyncOperationStarting.bind(_Global.Debug)) || nop,\n        _traceAsyncOperationCompleted: (_Global.Debug && _Global.Debug.msTraceAsyncOperationCompleted && _Global.Debug.msTraceAsyncOperationCompleted.bind(_Global.Debug)) || nop,\n        _traceAsyncCallbackStarting: (_Global.Debug && _Global.Debug.msTraceAsyncCallbackStarting && _Global.Debug.msTraceAsyncCallbackStarting.bind(_Global.Debug)) || nop,\n        _traceAsyncCallbackCompleted: (_Global.Debug && _Global.Debug.msTraceAsyncCallbackCompleted && _Global.Debug.msTraceAsyncCallbackCompleted.bind(_Global.Debug)) || nop\n    };\n});\n_winjs(\"WinJS/Promise/_StateMachine\", [\"WinJS/Core/_Global\",\"WinJS/Core/_BaseCoreUtils\",\"WinJS/Core/_Base\",\"WinJS/Core/_ErrorFromName\",\"WinJS/Core/_Events\",\"WinJS/Core/_Trace\"], function promiseStateMachineInit(_Global, _BaseCoreUtils, _Base, _ErrorFromName, _Events, _Trace) {\n    \"use strict\";\n\n    _Global.Debug && (_Global.Debug.setNonUserCodeExceptions = true);\n\n    var ListenerType = _Base.Class.mix(_Base.Class.define(null, { /*empty*/ }, { supportedForProcessing: false }), _Events.eventMixin);\n    var promiseEventListeners = new ListenerType();\n    // make sure there is a listeners collection so that we can do a more trivial check below\n    promiseEventListeners._listeners = {};\n    var errorET = \"error\";\n    var canceledName = \"Canceled\";\n    var tagWithStack = false;\n    var tag = {\n        promise: 0x01,\n        thenPromise: 0x02,\n        errorPromise: 0x04,\n        exceptionPromise: 0x08,\n        completePromise: 0x10,\n    };\n    tag.all = tag.promise | tag.thenPromise | tag.errorPromise | tag.exceptionPromise | tag.completePromise;\n\n    //\n    // Global error counter, for each error which enters the system we increment this once and then\n    // the error number travels with the error as it traverses the tree of potential handlers.\n    //\n    // When someone has registered to be told about errors (WinJS.Promise.callonerror) promises\n    // which are in error will get tagged with a ._errorId field. This tagged field is the\n    // contract by which nested promises with errors will be identified as chaining for the\n    // purposes of the callonerror semantics. If a nested promise in error is encountered without\n    // a ._errorId it will be assumed to be foreign and treated as an interop boundary and\n    // a new error id will be minted.\n    //\n    var error_number = 1;\n\n    //\n    // The state machine has a interesting hiccup in it with regards to notification, in order\n    // to flatten out notification and avoid recursion for synchronous completion we have an\n    // explicit set of *_notify states which are responsible for notifying their entire tree\n    // of children. They can do this because they know that immediate children are always\n    // ThenPromise instances and we can therefore reach into their state to access the\n    // _listeners collection.\n    //\n    // So, what happens is that a Promise will be fulfilled through the _completed or _error\n    // messages at which point it will enter a *_notify state and be responsible for to move\n    // its children into an (as appropriate) success or error state and also notify that child's\n    // listeners of the state transition, until leaf notes are reached.\n    //\n\n    var state_created,              // -> working\n        state_working,              // -> error | error_notify | success | success_notify | canceled | waiting\n        state_waiting,              // -> error | error_notify | success | success_notify | waiting_canceled\n        state_waiting_canceled,     // -> error | error_notify | success | success_notify | canceling\n        state_canceled,             // -> error | error_notify | success | success_notify | canceling\n        state_canceling,            // -> error_notify\n        state_success_notify,       // -> success\n        state_success,              // -> .\n        state_error_notify,         // -> error\n        state_error;                // -> .\n\n    // Noop function, used in the various states to indicate that they don't support a given\n    // message. Named with the somewhat cute name '_' because it reads really well in the states.\n\n    function _() { }\n\n    // Initial state\n    //\n    state_created = {\n        name: \"created\",\n        enter: function (promise) {\n            promise._setState(state_working);\n        },\n        cancel: _,\n        done: _,\n        then: _,\n        _completed: _,\n        _error: _,\n        _notify: _,\n        _progress: _,\n        _setCompleteValue: _,\n        _setErrorValue: _\n    };\n\n    // Ready state, waiting for a message (completed/error/progress), able to be canceled\n    //\n    state_working = {\n        name: \"working\",\n        enter: _,\n        cancel: function (promise) {\n            promise._setState(state_canceled);\n        },\n        done: done,\n        then: then,\n        _completed: completed,\n        _error: error,\n        _notify: _,\n        _progress: progress,\n        _setCompleteValue: setCompleteValue,\n        _setErrorValue: setErrorValue\n    };\n\n    // Waiting state, if a promise is completed with a value which is itself a promise\n    // (has a then() method) it signs up to be informed when that child promise is\n    // fulfilled at which point it will be fulfilled with that value.\n    //\n    state_waiting = {\n        name: \"waiting\",\n        enter: function (promise) {\n            var waitedUpon = promise._value;\n            // We can special case our own intermediate promises which are not in a\n            //  terminal state by just pushing this promise as a listener without\n            //  having to create new indirection functions\n            if (waitedUpon instanceof ThenPromise &&\n                waitedUpon._state !== state_error &&\n                waitedUpon._state !== state_success) {\n                pushListener(waitedUpon, { promise: promise });\n            } else {\n                var error = function (value) {\n                    if (waitedUpon._errorId) {\n                        promise._chainedError(value, waitedUpon);\n                    } else {\n                        // Because this is an interop boundary we want to indicate that this\n                        //  error has been handled by the promise infrastructure before we\n                        //  begin a new handling chain.\n                        //\n                        callonerror(promise, value, detailsForHandledError, waitedUpon, error);\n                        promise._error(value);\n                    }\n                };\n                error.handlesOnError = true;\n                waitedUpon.then(\n                    promise._completed.bind(promise),\n                    error,\n                    promise._progress.bind(promise)\n                );\n            }\n        },\n        cancel: function (promise) {\n            promise._setState(state_waiting_canceled);\n        },\n        done: done,\n        then: then,\n        _completed: completed,\n        _error: error,\n        _notify: _,\n        _progress: progress,\n        _setCompleteValue: setCompleteValue,\n        _setErrorValue: setErrorValue\n    };\n\n    // Waiting canceled state, when a promise has been in a waiting state and receives a\n    // request to cancel its pending work it will forward that request to the child promise\n    // and then waits to be informed of the result. This promise moves itself into the\n    // canceling state but understands that the child promise may instead push it to a\n    // different state.\n    //\n    state_waiting_canceled = {\n        name: \"waiting_canceled\",\n        enter: function (promise) {\n            // Initiate a transition to canceling. Triggering a cancel on the promise\n            // that we are waiting upon may result in a different state transition\n            // before the state machine pump runs again.\n            promise._setState(state_canceling);\n            var waitedUpon = promise._value;\n            if (waitedUpon.cancel) {\n                waitedUpon.cancel();\n            }\n        },\n        cancel: _,\n        done: done,\n        then: then,\n        _completed: completed,\n        _error: error,\n        _notify: _,\n        _progress: progress,\n        _setCompleteValue: setCompleteValue,\n        _setErrorValue: setErrorValue\n    };\n\n    // Canceled state, moves to the canceling state and then tells the promise to do\n    // whatever it might need to do on cancelation.\n    //\n    state_canceled = {\n        name: \"canceled\",\n        enter: function (promise) {\n            // Initiate a transition to canceling. The _cancelAction may change the state\n            // before the state machine pump runs again.\n            promise._setState(state_canceling);\n            promise._cancelAction();\n        },\n        cancel: _,\n        done: done,\n        then: then,\n        _completed: completed,\n        _error: error,\n        _notify: _,\n        _progress: progress,\n        _setCompleteValue: setCompleteValue,\n        _setErrorValue: setErrorValue\n    };\n\n    // Canceling state, commits to the promise moving to an error state with an error\n    // object whose 'name' and 'message' properties contain the string \"Canceled\"\n    //\n    state_canceling = {\n        name: \"canceling\",\n        enter: function (promise) {\n            var error = new Error(canceledName);\n            error.name = error.message;\n            promise._value = error;\n            promise._setState(state_error_notify);\n        },\n        cancel: _,\n        done: _,\n        then: _,\n        _completed: _,\n        _error: _,\n        _notify: _,\n        _progress: _,\n        _setCompleteValue: _,\n        _setErrorValue: _\n    };\n\n    // Success notify state, moves a promise to the success state and notifies all children\n    //\n    state_success_notify = {\n        name: \"complete_notify\",\n        enter: function (promise) {\n            promise.done = CompletePromise.prototype.done;\n            promise.then = CompletePromise.prototype.then;\n            if (promise._listeners) {\n                var queue = [promise];\n                var p;\n                while (queue.length) {\n                    p = queue.shift();\n                    p._state._notify(p, queue);\n                }\n            }\n            promise._setState(state_success);\n        },\n        cancel: _,\n        done: null, /*error to get here */\n        then: null, /*error to get here */\n        _completed: _,\n        _error: _,\n        _notify: notifySuccess,\n        _progress: _,\n        _setCompleteValue: _,\n        _setErrorValue: _\n    };\n\n    // Success state, moves a promise to the success state and does NOT notify any children.\n    // Some upstream promise is owning the notification pass.\n    //\n    state_success = {\n        name: \"success\",\n        enter: function (promise) {\n            promise.done = CompletePromise.prototype.done;\n            promise.then = CompletePromise.prototype.then;\n            promise._cleanupAction();\n        },\n        cancel: _,\n        done: null, /*error to get here */\n        then: null, /*error to get here */\n        _completed: _,\n        _error: _,\n        _notify: notifySuccess,\n        _progress: _,\n        _setCompleteValue: _,\n        _setErrorValue: _\n    };\n\n    // Error notify state, moves a promise to the error state and notifies all children\n    //\n    state_error_notify = {\n        name: \"error_notify\",\n        enter: function (promise) {\n            promise.done = ErrorPromise.prototype.done;\n            promise.then = ErrorPromise.prototype.then;\n            if (promise._listeners) {\n                var queue = [promise];\n                var p;\n                while (queue.length) {\n                    p = queue.shift();\n                    p._state._notify(p, queue);\n                }\n            }\n            promise._setState(state_error);\n        },\n        cancel: _,\n        done: null, /*error to get here*/\n        then: null, /*error to get here*/\n        _completed: _,\n        _error: _,\n        _notify: notifyError,\n        _progress: _,\n        _setCompleteValue: _,\n        _setErrorValue: _\n    };\n\n    // Error state, moves a promise to the error state and does NOT notify any children.\n    // Some upstream promise is owning the notification pass.\n    //\n    state_error = {\n        name: \"error\",\n        enter: function (promise) {\n            promise.done = ErrorPromise.prototype.done;\n            promise.then = ErrorPromise.prototype.then;\n            promise._cleanupAction();\n        },\n        cancel: _,\n        done: null, /*error to get here*/\n        then: null, /*error to get here*/\n        _completed: _,\n        _error: _,\n        _notify: notifyError,\n        _progress: _,\n        _setCompleteValue: _,\n        _setErrorValue: _\n    };\n\n    //\n    // The statemachine implementation follows a very particular pattern, the states are specified\n    // as static stateless bags of functions which are then indirected through the state machine\n    // instance (a Promise). As such all of the functions on each state have the promise instance\n    // passed to them explicitly as a parameter and the Promise instance members do a little\n    // dance where they indirect through the state and insert themselves in the argument list.\n    //\n    // We could instead call directly through the promise states however then every caller\n    // would have to remember to do things like pumping the state machine to catch state transitions.\n    //\n\n    var PromiseStateMachine = _Base.Class.define(null, {\n        _listeners: null,\n        _nextState: null,\n        _state: null,\n        _value: null,\n\n        cancel: function () {\n            /// <signature helpKeyword=\"WinJS.PromiseStateMachine.cancel\">\n            /// <summary locid=\"WinJS.PromiseStateMachine.cancel\">\n            /// Attempts to cancel the fulfillment of a promised value. If the promise hasn't\n            /// already been fulfilled and cancellation is supported, the promise enters\n            /// the error state with a value of Error(\"Canceled\").\n            /// </summary>\n            /// </signature>\n            this._state.cancel(this);\n            this._run();\n        },\n        done: function Promise_done(onComplete, onError, onProgress) {\n            /// <signature helpKeyword=\"WinJS.PromiseStateMachine.done\">\n            /// <summary locid=\"WinJS.PromiseStateMachine.done\">\n            /// Allows you to specify the work to be done on the fulfillment of the promised value,\n            /// the error handling to be performed if the promise fails to fulfill\n            /// a value, and the handling of progress notifications along the way.\n            ///\n            /// After the handlers have finished executing, this function throws any error that would have been returned\n            /// from then() as a promise in the error state.\n            /// </summary>\n            /// <param name='onComplete' type='Function' locid=\"WinJS.PromiseStateMachine.done_p:onComplete\">\n            /// The function to be called if the promise is fulfilled successfully with a value.\n            /// The fulfilled value is passed as the single argument. If the value is null,\n            /// the fulfilled value is returned. The value returned\n            /// from the function becomes the fulfilled value of the promise returned by\n            /// then(). If an exception is thrown while executing the function, the promise returned\n            /// by then() moves into the error state.\n            /// </param>\n            /// <param name='onError' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.done_p:onError\">\n            /// The function to be called if the promise is fulfilled with an error. The error\n            /// is passed as the single argument. If it is null, the error is forwarded.\n            /// The value returned from the function is the fulfilled value of the promise returned by then().\n            /// </param>\n            /// <param name='onProgress' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.done_p:onProgress\">\n            /// the function to be called if the promise reports progress. Data about the progress\n            /// is passed as the single argument. Promises are not required to support\n            /// progress.\n            /// </param>\n            /// </signature>\n            this._state.done(this, onComplete, onError, onProgress);\n        },\n        then: function Promise_then(onComplete, onError, onProgress) {\n            /// <signature helpKeyword=\"WinJS.PromiseStateMachine.then\">\n            /// <summary locid=\"WinJS.PromiseStateMachine.then\">\n            /// Allows you to specify the work to be done on the fulfillment of the promised value,\n            /// the error handling to be performed if the promise fails to fulfill\n            /// a value, and the handling of progress notifications along the way.\n            /// </summary>\n            /// <param name='onComplete' type='Function' locid=\"WinJS.PromiseStateMachine.then_p:onComplete\">\n            /// The function to be called if the promise is fulfilled successfully with a value.\n            /// The value is passed as the single argument. If the value is null, the value is returned.\n            /// The value returned from the function becomes the fulfilled value of the promise returned by\n            /// then(). If an exception is thrown while this function is being executed, the promise returned\n            /// by then() moves into the error state.\n            /// </param>\n            /// <param name='onError' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.then_p:onError\">\n            /// The function to be called if the promise is fulfilled with an error. The error\n            /// is passed as the single argument. If it is null, the error is forwarded.\n            /// The value returned from the function becomes the fulfilled value of the promise returned by then().\n            /// </param>\n            /// <param name='onProgress' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.then_p:onProgress\">\n            /// The function to be called if the promise reports progress. Data about the progress\n            /// is passed as the single argument. Promises are not required to support\n            /// progress.\n            /// </param>\n            /// <returns type=\"WinJS.Promise\" locid=\"WinJS.PromiseStateMachine.then_returnValue\">\n            /// The promise whose value is the result of executing the complete or\n            /// error function.\n            /// </returns>\n            /// </signature>\n            // BEGIN monaco change\n            if (this.then !== Promise_then) {\n                this.then(onComplete, onError, onProgress);\n                return;\n            }\n            // END monaco change\n            return this._state.then(this, onComplete, onError, onProgress);\n        },\n\n        _chainedError: function (value, context) {\n            var result = this._state._error(this, value, detailsForChainedError, context);\n            this._run();\n            return result;\n        },\n        _completed: function (value) {\n            var result = this._state._completed(this, value);\n            this._run();\n            return result;\n        },\n        _error: function (value) {\n            var result = this._state._error(this, value, detailsForError);\n            this._run();\n            return result;\n        },\n        _progress: function (value) {\n            this._state._progress(this, value);\n        },\n        _setState: function (state) {\n            this._nextState = state;\n        },\n        _setCompleteValue: function (value) {\n            this._state._setCompleteValue(this, value);\n            this._run();\n        },\n        _setChainedErrorValue: function (value, context) {\n            var result = this._state._setErrorValue(this, value, detailsForChainedError, context);\n            this._run();\n            return result;\n        },\n        _setExceptionValue: function (value) {\n            var result = this._state._setErrorValue(this, value, detailsForException);\n            this._run();\n            return result;\n        },\n        _run: function () {\n            while (this._nextState) {\n                this._state = this._nextState;\n                this._nextState = null;\n                this._state.enter(this);\n            }\n        }\n    }, {\n        supportedForProcessing: false\n    });\n\n    //\n    // Implementations of shared state machine code.\n    //\n\n    function completed(promise, value) {\n        var targetState;\n        if (value && typeof value === \"object\" && typeof value.then === \"function\") {\n            targetState = state_waiting;\n        } else {\n            targetState = state_success_notify;\n        }\n        promise._value = value;\n        promise._setState(targetState);\n    }\n    function createErrorDetails(exception, error, promise, id, parent, handler) {\n        return {\n            exception: exception,\n            error: error,\n            promise: promise,\n            handler: handler,\n            id: id,\n            parent: parent\n        };\n    }\n    function detailsForHandledError(promise, errorValue, context, handler) {\n        var exception = context._isException;\n        var errorId = context._errorId;\n        return createErrorDetails(\n            exception ? errorValue : null,\n            exception ? null : errorValue,\n            promise,\n            errorId,\n            context,\n            handler\n        );\n    }\n    function detailsForChainedError(promise, errorValue, context) {\n        var exception = context._isException;\n        var errorId = context._errorId;\n        setErrorInfo(promise, errorId, exception);\n        return createErrorDetails(\n            exception ? errorValue : null,\n            exception ? null : errorValue,\n            promise,\n            errorId,\n            context\n        );\n    }\n    function detailsForError(promise, errorValue) {\n        var errorId = ++error_number;\n        setErrorInfo(promise, errorId);\n        return createErrorDetails(\n            null,\n            errorValue,\n            promise,\n            errorId\n        );\n    }\n    function detailsForException(promise, exceptionValue) {\n        var errorId = ++error_number;\n        setErrorInfo(promise, errorId, true);\n        return createErrorDetails(\n            exceptionValue,\n            null,\n            promise,\n            errorId\n        );\n    }\n    function done(promise, onComplete, onError, onProgress) {\n        var asyncOpID = _Trace._traceAsyncOperationStarting(\"WinJS.Promise.done\");\n        pushListener(promise, { c: onComplete, e: onError, p: onProgress, asyncOpID: asyncOpID });\n    }\n    function error(promise, value, onerrorDetails, context) {\n        promise._value = value;\n        callonerror(promise, value, onerrorDetails, context);\n        promise._setState(state_error_notify);\n    }\n    function notifySuccess(promise, queue) {\n        var value = promise._value;\n        var listeners = promise._listeners;\n        if (!listeners) {\n            return;\n        }\n        promise._listeners = null;\n        var i, len;\n        for (i = 0, len = Array.isArray(listeners) ? listeners.length : 1; i < len; i++) {\n            var listener = len === 1 ? listeners : listeners[i];\n            var onComplete = listener.c;\n            var target = listener.promise;\n\n            _Trace._traceAsyncOperationCompleted(listener.asyncOpID, _Global.Debug && _Global.Debug.MS_ASYNC_OP_STATUS_SUCCESS);\n\n            if (target) {\n                _Trace._traceAsyncCallbackStarting(listener.asyncOpID);\n                try {\n                    target._setCompleteValue(onComplete ? onComplete(value) : value);\n                } catch (ex) {\n                    target._setExceptionValue(ex);\n                } finally {\n                    _Trace._traceAsyncCallbackCompleted();\n                }\n                if (target._state !== state_waiting && target._listeners) {\n                    queue.push(target);\n                }\n            } else {\n                CompletePromise.prototype.done.call(promise, onComplete);\n            }\n        }\n    }\n    function notifyError(promise, queue) {\n        var value = promise._value;\n        var listeners = promise._listeners;\n        if (!listeners) {\n            return;\n        }\n        promise._listeners = null;\n        var i, len;\n        for (i = 0, len = Array.isArray(listeners) ? listeners.length : 1; i < len; i++) {\n            var listener = len === 1 ? listeners : listeners[i];\n            var onError = listener.e;\n            var target = listener.promise;\n\n            var errorID = _Global.Debug && (value && value.name === canceledName ? _Global.Debug.MS_ASYNC_OP_STATUS_CANCELED : _Global.Debug.MS_ASYNC_OP_STATUS_ERROR);\n            _Trace._traceAsyncOperationCompleted(listener.asyncOpID, errorID);\n\n            if (target) {\n                var asyncCallbackStarted = false;\n                try {\n                    if (onError) {\n                        _Trace._traceAsyncCallbackStarting(listener.asyncOpID);\n                        asyncCallbackStarted = true;\n                        if (!onError.handlesOnError) {\n                            callonerror(target, value, detailsForHandledError, promise, onError);\n                        }\n                        target._setCompleteValue(onError(value));\n                    } else {\n                        target._setChainedErrorValue(value, promise);\n                    }\n                } catch (ex) {\n                    target._setExceptionValue(ex);\n                } finally {\n                    if (asyncCallbackStarted) {\n                        _Trace._traceAsyncCallbackCompleted();\n                    }\n                }\n                if (target._state !== state_waiting && target._listeners) {\n                    queue.push(target);\n                }\n            } else {\n                ErrorPromise.prototype.done.call(promise, null, onError);\n            }\n        }\n    }\n    function callonerror(promise, value, onerrorDetailsGenerator, context, handler) {\n        if (promiseEventListeners._listeners[errorET]) {\n            if (value instanceof Error && value.message === canceledName) {\n                return;\n            }\n            promiseEventListeners.dispatchEvent(errorET, onerrorDetailsGenerator(promise, value, context, handler));\n        }\n    }\n    function progress(promise, value) {\n        var listeners = promise._listeners;\n        if (listeners) {\n            var i, len;\n            for (i = 0, len = Array.isArray(listeners) ? listeners.length : 1; i < len; i++) {\n                var listener = len === 1 ? listeners : listeners[i];\n                var onProgress = listener.p;\n                if (onProgress) {\n                    try { onProgress(value); } catch (ex) { }\n                }\n                if (!(listener.c || listener.e) && listener.promise) {\n                    listener.promise._progress(value);\n                }\n            }\n        }\n    }\n    function pushListener(promise, listener) {\n        var listeners = promise._listeners;\n        if (listeners) {\n            // We may have either a single listener (which will never be wrapped in an array)\n            // or 2+ listeners (which will be wrapped). Since we are now adding one more listener\n            // we may have to wrap the single listener before adding the second.\n            listeners = Array.isArray(listeners) ? listeners : [listeners];\n            listeners.push(listener);\n        } else {\n            listeners = listener;\n        }\n        promise._listeners = listeners;\n    }\n    // The difference beween setCompleteValue()/setErrorValue() and complete()/error() is that setXXXValue() moves\n    // a promise directly to the success/error state without starting another notification pass (because one\n    // is already ongoing).\n    function setErrorInfo(promise, errorId, isException) {\n        promise._isException = isException || false;\n        promise._errorId = errorId;\n    }\n    function setErrorValue(promise, value, onerrorDetails, context) {\n        promise._value = value;\n        callonerror(promise, value, onerrorDetails, context);\n        promise._setState(state_error);\n    }\n    function setCompleteValue(promise, value) {\n        var targetState;\n        if (value && typeof value === \"object\" && typeof value.then === \"function\") {\n            targetState = state_waiting;\n        } else {\n            targetState = state_success;\n        }\n        promise._value = value;\n        promise._setState(targetState);\n    }\n    function then(promise, onComplete, onError, onProgress) {\n        var result = new ThenPromise(promise);\n        var asyncOpID = _Trace._traceAsyncOperationStarting(\"WinJS.Promise.then\");\n        pushListener(promise, { promise: result, c: onComplete, e: onError, p: onProgress, asyncOpID: asyncOpID });\n        return result;\n    }\n\n    //\n    // Internal implementation detail promise, ThenPromise is created when a promise needs\n    // to be returned from a then() method.\n    //\n    var ThenPromise = _Base.Class.derive(PromiseStateMachine,\n        function (creator) {\n\n            if (tagWithStack && (tagWithStack === true || (tagWithStack & tag.thenPromise))) {\n                this._stack = Promise._getStack();\n            }\n\n            this._creator = creator;\n            this._setState(state_created);\n            this._run();\n        }, {\n            _creator: null,\n\n            _cancelAction: function () { if (this._creator) { this._creator.cancel(); } },\n            _cleanupAction: function () { this._creator = null; }\n        }, {\n            supportedForProcessing: false\n        }\n    );\n\n    //\n    // Slim promise implementations for already completed promises, these are created\n    // under the hood on synchronous completion paths as well as by WinJS.Promise.wrap\n    // and WinJS.Promise.wrapError.\n    //\n\n    var ErrorPromise = _Base.Class.define(\n        function ErrorPromise_ctor(value) {\n\n            if (tagWithStack && (tagWithStack === true || (tagWithStack & tag.errorPromise))) {\n                this._stack = Promise._getStack();\n            }\n\n            this._value = value;\n            callonerror(this, value, detailsForError);\n        }, {\n            cancel: function () {\n                /// <signature helpKeyword=\"WinJS.PromiseStateMachine.cancel\">\n                /// <summary locid=\"WinJS.PromiseStateMachine.cancel\">\n                /// Attempts to cancel the fulfillment of a promised value. If the promise hasn't\n                /// already been fulfilled and cancellation is supported, the promise enters\n                /// the error state with a value of Error(\"Canceled\").\n                /// </summary>\n                /// </signature>\n            },\n            done: function ErrorPromise_done(unused, onError) {\n                /// <signature helpKeyword=\"WinJS.PromiseStateMachine.done\">\n                /// <summary locid=\"WinJS.PromiseStateMachine.done\">\n                /// Allows you to specify the work to be done on the fulfillment of the promised value,\n                /// the error handling to be performed if the promise fails to fulfill\n                /// a value, and the handling of progress notifications along the way.\n                ///\n                /// After the handlers have finished executing, this function throws any error that would have been returned\n                /// from then() as a promise in the error state.\n                /// </summary>\n                /// <param name='onComplete' type='Function' locid=\"WinJS.PromiseStateMachine.done_p:onComplete\">\n                /// The function to be called if the promise is fulfilled successfully with a value.\n                /// The fulfilled value is passed as the single argument. If the value is null,\n                /// the fulfilled value is returned. The value returned\n                /// from the function becomes the fulfilled value of the promise returned by\n                /// then(). If an exception is thrown while executing the function, the promise returned\n                /// by then() moves into the error state.\n                /// </param>\n                /// <param name='onError' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.done_p:onError\">\n                /// The function to be called if the promise is fulfilled with an error. The error\n                /// is passed as the single argument. If it is null, the error is forwarded.\n                /// The value returned from the function is the fulfilled value of the promise returned by then().\n                /// </param>\n                /// <param name='onProgress' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.done_p:onProgress\">\n                /// the function to be called if the promise reports progress. Data about the progress\n                /// is passed as the single argument. Promises are not required to support\n                /// progress.\n                /// </param>\n                /// </signature>\n                var value = this._value;\n                if (onError) {\n                    try {\n                        if (!onError.handlesOnError) {\n                            callonerror(null, value, detailsForHandledError, this, onError);\n                        }\n                        var result = onError(value);\n                        if (result && typeof result === \"object\" && typeof result.done === \"function\") {\n                            // If a promise is returned we need to wait on it.\n                            result.done();\n                        }\n                        return;\n                    } catch (ex) {\n                        value = ex;\n                    }\n                }\n                if (value instanceof Error && value.message === canceledName) {\n                    // suppress cancel\n                    return;\n                }\n                // force the exception to be thrown asyncronously to avoid any try/catch blocks\n                //\n                Promise._doneHandler(value);\n            },\n            then: function ErrorPromise_then(unused, onError) {\n                /// <signature helpKeyword=\"WinJS.PromiseStateMachine.then\">\n                /// <summary locid=\"WinJS.PromiseStateMachine.then\">\n                /// Allows you to specify the work to be done on the fulfillment of the promised value,\n                /// the error handling to be performed if the promise fails to fulfill\n                /// a value, and the handling of progress notifications along the way.\n                /// </summary>\n                /// <param name='onComplete' type='Function' locid=\"WinJS.PromiseStateMachine.then_p:onComplete\">\n                /// The function to be called if the promise is fulfilled successfully with a value.\n                /// The value is passed as the single argument. If the value is null, the value is returned.\n                /// The value returned from the function becomes the fulfilled value of the promise returned by\n                /// then(). If an exception is thrown while this function is being executed, the promise returned\n                /// by then() moves into the error state.\n                /// </param>\n                /// <param name='onError' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.then_p:onError\">\n                /// The function to be called if the promise is fulfilled with an error. The error\n                /// is passed as the single argument. If it is null, the error is forwarded.\n                /// The value returned from the function becomes the fulfilled value of the promise returned by then().\n                /// </param>\n                /// <param name='onProgress' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.then_p:onProgress\">\n                /// The function to be called if the promise reports progress. Data about the progress\n                /// is passed as the single argument. Promises are not required to support\n                /// progress.\n                /// </param>\n                /// <returns type=\"WinJS.Promise\" locid=\"WinJS.PromiseStateMachine.then_returnValue\">\n                /// The promise whose value is the result of executing the complete or\n                /// error function.\n                /// </returns>\n                /// </signature>\n\n                // If the promise is already in a error state and no error handler is provided\n                // we optimize by simply returning the promise instead of creating a new one.\n                //\n                if (!onError) { return this; }\n                var result;\n                var value = this._value;\n                try {\n                    if (!onError.handlesOnError) {\n                        callonerror(null, value, detailsForHandledError, this, onError);\n                    }\n                    result = new CompletePromise(onError(value));\n                } catch (ex) {\n                    // If the value throw from the error handler is the same as the value\n                    // provided to the error handler then there is no need for a new promise.\n                    //\n                    if (ex === value) {\n                        result = this;\n                    } else {\n                        result = new ExceptionPromise(ex);\n                    }\n                }\n                return result;\n            }\n        }, {\n            supportedForProcessing: false\n        }\n    );\n\n    var ExceptionPromise = _Base.Class.derive(ErrorPromise,\n        function ExceptionPromise_ctor(value) {\n\n            if (tagWithStack && (tagWithStack === true || (tagWithStack & tag.exceptionPromise))) {\n                this._stack = Promise._getStack();\n            }\n\n            this._value = value;\n            callonerror(this, value, detailsForException);\n        }, {\n            /* empty */\n        }, {\n            supportedForProcessing: false\n        }\n    );\n\n    var CompletePromise = _Base.Class.define(\n        function CompletePromise_ctor(value) {\n\n            if (tagWithStack && (tagWithStack === true || (tagWithStack & tag.completePromise))) {\n                this._stack = Promise._getStack();\n            }\n\n            if (value && typeof value === \"object\" && typeof value.then === \"function\") {\n                var result = new ThenPromise(null);\n                result._setCompleteValue(value);\n                return result;\n            }\n            this._value = value;\n        }, {\n            cancel: function () {\n                /// <signature helpKeyword=\"WinJS.PromiseStateMachine.cancel\">\n                /// <summary locid=\"WinJS.PromiseStateMachine.cancel\">\n                /// Attempts to cancel the fulfillment of a promised value. If the promise hasn't\n                /// already been fulfilled and cancellation is supported, the promise enters\n                /// the error state with a value of Error(\"Canceled\").\n                /// </summary>\n                /// </signature>\n            },\n            done: function CompletePromise_done(onComplete) {\n                /// <signature helpKeyword=\"WinJS.PromiseStateMachine.done\">\n                /// <summary locid=\"WinJS.PromiseStateMachine.done\">\n                /// Allows you to specify the work to be done on the fulfillment of the promised value,\n                /// the error handling to be performed if the promise fails to fulfill\n                /// a value, and the handling of progress notifications along the way.\n                ///\n                /// After the handlers have finished executing, this function throws any error that would have been returned\n                /// from then() as a promise in the error state.\n                /// </summary>\n                /// <param name='onComplete' type='Function' locid=\"WinJS.PromiseStateMachine.done_p:onComplete\">\n                /// The function to be called if the promise is fulfilled successfully with a value.\n                /// The fulfilled value is passed as the single argument. If the value is null,\n                /// the fulfilled value is returned. The value returned\n                /// from the function becomes the fulfilled value of the promise returned by\n                /// then(). If an exception is thrown while executing the function, the promise returned\n                /// by then() moves into the error state.\n                /// </param>\n                /// <param name='onError' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.done_p:onError\">\n                /// The function to be called if the promise is fulfilled with an error. The error\n                /// is passed as the single argument. If it is null, the error is forwarded.\n                /// The value returned from the function is the fulfilled value of the promise returned by then().\n                /// </param>\n                /// <param name='onProgress' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.done_p:onProgress\">\n                /// the function to be called if the promise reports progress. Data about the progress\n                /// is passed as the single argument. Promises are not required to support\n                /// progress.\n                /// </param>\n                /// </signature>\n                if (!onComplete) { return; }\n                try {\n                    var result = onComplete(this._value);\n                    if (result && typeof result === \"object\" && typeof result.done === \"function\") {\n                        result.done();\n                    }\n                } catch (ex) {\n                    // force the exception to be thrown asynchronously to avoid any try/catch blocks\n                    Promise._doneHandler(ex);\n                }\n            },\n            then: function CompletePromise_then(onComplete) {\n                /// <signature helpKeyword=\"WinJS.PromiseStateMachine.then\">\n                /// <summary locid=\"WinJS.PromiseStateMachine.then\">\n                /// Allows you to specify the work to be done on the fulfillment of the promised value,\n                /// the error handling to be performed if the promise fails to fulfill\n                /// a value, and the handling of progress notifications along the way.\n                /// </summary>\n                /// <param name='onComplete' type='Function' locid=\"WinJS.PromiseStateMachine.then_p:onComplete\">\n                /// The function to be called if the promise is fulfilled successfully with a value.\n                /// The value is passed as the single argument. If the value is null, the value is returned.\n                /// The value returned from the function becomes the fulfilled value of the promise returned by\n                /// then(). If an exception is thrown while this function is being executed, the promise returned\n                /// by then() moves into the error state.\n                /// </param>\n                /// <param name='onError' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.then_p:onError\">\n                /// The function to be called if the promise is fulfilled with an error. The error\n                /// is passed as the single argument. If it is null, the error is forwarded.\n                /// The value returned from the function becomes the fulfilled value of the promise returned by then().\n                /// </param>\n                /// <param name='onProgress' type='Function' optional='true' locid=\"WinJS.PromiseStateMachine.then_p:onProgress\">\n                /// The function to be called if the promise reports progress. Data about the progress\n                /// is passed as the single argument. Promises are not required to support\n                /// progress.\n                /// </param>\n                /// <returns type=\"WinJS.Promise\" locid=\"WinJS.PromiseStateMachine.then_returnValue\">\n                /// The promise whose value is the result of executing the complete or\n                /// error function.\n                /// </returns>\n                /// </signature>\n                try {\n                    // If the value returned from the completion handler is the same as the value\n                    // provided to the completion handler then there is no need for a new promise.\n                    //\n                    var newValue = onComplete ? onComplete(this._value) : this._value;\n                    return newValue === this._value ? this : new CompletePromise(newValue);\n                } catch (ex) {\n                    return new ExceptionPromise(ex);\n                }\n            }\n        }, {\n            supportedForProcessing: false\n        }\n    );\n\n    //\n    // Promise is the user-creatable WinJS.Promise object.\n    //\n\n    function timeout(timeoutMS) {\n        var id;\n        return new Promise(\n            function (c) {\n                if (timeoutMS) {\n                    id = _Global.setTimeout(c, timeoutMS);\n                } else {\n                    _BaseCoreUtils._setImmediate(c);\n                }\n            },\n            function () {\n                if (id) {\n                    _Global.clearTimeout(id);\n                }\n            }\n        );\n    }\n\n    function timeoutWithPromise(timeout, promise) {\n        var cancelPromise = function () { promise.cancel(); };\n        var cancelTimeout = function () { timeout.cancel(); };\n        timeout.then(cancelPromise);\n        promise.then(cancelTimeout, cancelTimeout);\n        return promise;\n    }\n\n    var staticCanceledPromise;\n\n    var Promise = _Base.Class.derive(PromiseStateMachine,\n        function Promise_ctor(init, oncancel) {\n            /// <signature helpKeyword=\"WinJS.Promise\">\n            /// <summary locid=\"WinJS.Promise\">\n            /// A promise provides a mechanism to schedule work to be done on a value that\n            /// has not yet been computed. It is a convenient abstraction for managing\n            /// interactions with asynchronous APIs.\n            /// </summary>\n            /// <param name=\"init\" type=\"Function\" locid=\"WinJS.Promise_p:init\">\n            /// The function that is called during construction of the  promise. The function\n            /// is given three arguments (complete, error, progress). Inside this function\n            /// you should add event listeners for the notifications supported by this value.\n            /// </param>\n            /// <param name=\"oncancel\" optional=\"true\" locid=\"WinJS.Promise_p:oncancel\">\n            /// The function to call if a consumer of this promise wants\n            /// to cancel its undone work. Promises are not required to\n            /// support cancellation.\n            /// </param>\n            /// </signature>\n\n            if (tagWithStack && (tagWithStack === true || (tagWithStack & tag.promise))) {\n                this._stack = Promise._getStack();\n            }\n\n            this._oncancel = oncancel;\n            this._setState(state_created);\n            this._run();\n\n            try {\n                var complete = this._completed.bind(this);\n                var error = this._error.bind(this);\n                var progress = this._progress.bind(this);\n                init(complete, error, progress);\n            } catch (ex) {\n                this._setExceptionValue(ex);\n            }\n        }, {\n            _oncancel: null,\n\n            _cancelAction: function () {\n                // BEGIN monaco change\n                try {\n                    if (this._oncancel) {\n                        this._oncancel();\n                    } else {\n                        throw new Error('Promise did not implement oncancel');\n                    }\n                } catch (ex) {\n                    // Access fields to get them created\n                    var msg = ex.message;\n                    var stack = ex.stack;\n                    promiseEventListeners.dispatchEvent('error', ex);\n                }\n                // END monaco change\n            },\n            _cleanupAction: function () { this._oncancel = null; }\n        }, {\n\n            addEventListener: function Promise_addEventListener(eventType, listener, capture) {\n                /// <signature helpKeyword=\"WinJS.Promise.addEventListener\">\n                /// <summary locid=\"WinJS.Promise.addEventListener\">\n                /// Adds an event listener to the control.\n                /// </summary>\n                /// <param name=\"eventType\" locid=\"WinJS.Promise.addEventListener_p:eventType\">\n                /// The type (name) of the event.\n                /// </param>\n                /// <param name=\"listener\" locid=\"WinJS.Promise.addEventListener_p:listener\">\n                /// The listener to invoke when the event is raised.\n                /// </param>\n                /// <param name=\"capture\" locid=\"WinJS.Promise.addEventListener_p:capture\">\n                /// Specifies whether or not to initiate capture.\n                /// </param>\n                /// </signature>\n                promiseEventListeners.addEventListener(eventType, listener, capture);\n            },\n            any: function Promise_any(values) {\n                /// <signature helpKeyword=\"WinJS.Promise.any\">\n                /// <summary locid=\"WinJS.Promise.any\">\n                /// Returns a promise that is fulfilled when one of the input promises\n                /// has been fulfilled.\n                /// </summary>\n                /// <param name=\"values\" type=\"Array\" locid=\"WinJS.Promise.any_p:values\">\n                /// An array that contains promise objects or objects whose property\n                /// values include promise objects.\n                /// </param>\n                /// <returns type=\"WinJS.Promise\" locid=\"WinJS.Promise.any_returnValue\">\n                /// A promise that on fulfillment yields the value of the input (complete or error).\n                /// </returns>\n                /// </signature>\n                return new Promise(\n                    function (complete, error) {\n                        var keys = Object.keys(values);\n                        if (keys.length === 0) {\n                            complete();\n                        }\n                        var canceled = 0;\n                        keys.forEach(function (key) {\n                            Promise.as(values[key]).then(\n                                function () { complete({ key: key, value: values[key] }); },\n                                function (e) {\n                                    if (e instanceof Error && e.name === canceledName) {\n                                        if ((++canceled) === keys.length) {\n                                            complete(Promise.cancel);\n                                        }\n                                        return;\n                                    }\n                                    error({ key: key, value: values[key] });\n                                }\n                            );\n                        });\n                    },\n                    function () {\n                        var keys = Object.keys(values);\n                        keys.forEach(function (key) {\n                            var promise = Promise.as(values[key]);\n                            if (typeof promise.cancel === \"function\") {\n                                promise.cancel();\n                            }\n                        });\n                    }\n                );\n            },\n            as: function Promise_as(value) {\n                /// <signature helpKeyword=\"WinJS.Promise.as\">\n                /// <summary locid=\"WinJS.Promise.as\">\n                /// Returns a promise. If the object is already a promise it is returned;\n                /// otherwise the object is wrapped in a promise.\n                /// </summary>\n                /// <param name=\"value\" locid=\"WinJS.Promise.as_p:value\">\n                /// The value to be treated as a promise.\n                /// </param>\n                /// <returns type=\"WinJS.Promise\" locid=\"WinJS.Promise.as_returnValue\">\n                /// A promise.\n                /// </returns>\n                /// </signature>\n                if (value && typeof value === \"object\" && typeof value.then === \"function\") {\n                    return value;\n                }\n                return new CompletePromise(value);\n            },\n            /// <field type=\"WinJS.Promise\" helpKeyword=\"WinJS.Promise.cancel\" locid=\"WinJS.Promise.cancel\">\n            /// Canceled promise value, can be returned from a promise completion handler\n            /// to indicate cancelation of the promise chain.\n            /// </field>\n            cancel: {\n                get: function () {\n                    return (staticCanceledPromise = staticCanceledPromise || new ErrorPromise(new _ErrorFromName(canceledName)));\n                }\n            },\n            dispatchEvent: function Promise_dispatchEvent(eventType, details) {\n                /// <signature helpKeyword=\"WinJS.Promise.dispatchEvent\">\n                /// <summary locid=\"WinJS.Promise.dispatchEvent\">\n                /// Raises an event of the specified type and properties.\n                /// </summary>\n                /// <param name=\"eventType\" locid=\"WinJS.Promise.dispatchEvent_p:eventType\">\n                /// The type (name) of the event.\n                /// </param>\n                /// <param name=\"details\" locid=\"WinJS.Promise.dispatchEvent_p:details\">\n                /// The set of additional properties to be attached to the event object.\n                /// </param>\n                /// <returns type=\"Boolean\" locid=\"WinJS.Promise.dispatchEvent_returnValue\">\n                /// Specifies whether preventDefault was called on the event.\n                /// </returns>\n                /// </signature>\n                return promiseEventListeners.dispatchEvent(eventType, details);\n            },\n            is: function Promise_is(value) {\n                /// <signature helpKeyword=\"WinJS.Promise.is\">\n                /// <summary locid=\"WinJS.Promise.is\">\n                /// Determines whether a value fulfills the promise contract.\n                /// </summary>\n                /// <param name=\"value\" locid=\"WinJS.Promise.is_p:value\">\n                /// A value that may be a promise.\n                /// </param>\n                /// <returns type=\"Boolean\" locid=\"WinJS.Promise.is_returnValue\">\n                /// true if the specified value is a promise, otherwise false.\n                /// </returns>\n                /// </signature>\n                return value && typeof value === \"object\" && typeof value.then === \"function\";\n            },\n            join: function Promise_join(values) {\n                /// <signature helpKeyword=\"WinJS.Promise.join\">\n                /// <summary locid=\"WinJS.Promise.join\">\n                /// Creates a promise that is fulfilled when all the values are fulfilled.\n                /// </summary>\n                /// <param name=\"values\" type=\"Object\" locid=\"WinJS.Promise.join_p:values\">\n                /// An object whose fields contain values, some of which may be promises.\n                /// </param>\n                /// <returns type=\"WinJS.Promise\" locid=\"WinJS.Promise.join_returnValue\">\n                /// A promise whose value is an object with the same field names as those of the object in the values parameter, where\n                /// each field value is the fulfilled value of a promise.\n                /// </returns>\n                /// </signature>\n                return new Promise(\n                    function (complete, error, progress) {\n                        var keys = Object.keys(values);\n                        var errors = Array.isArray(values) ? [] : {};\n                        var results = Array.isArray(values) ? [] : {};\n                        var undefineds = 0;\n                        var pending = keys.length;\n                        var argDone = function (key) {\n                            if ((--pending) === 0) {\n                                var errorCount = Object.keys(errors).length;\n                                if (errorCount === 0) {\n                                    complete(results);\n                                } else {\n                                    var canceledCount = 0;\n                                    keys.forEach(function (key) {\n                                        var e = errors[key];\n                                        if (e instanceof Error && e.name === canceledName) {\n                                            canceledCount++;\n                                        }\n                                    });\n                                    if (canceledCount === errorCount) {\n                                        complete(Promise.cancel);\n                                    } else {\n                                        error(errors);\n                                    }\n                                }\n                            } else {\n                                progress({ Key: key, Done: true });\n                            }\n                        };\n                        keys.forEach(function (key) {\n                            var value = values[key];\n                            if (value === undefined) {\n                                undefineds++;\n                            } else {\n                                Promise.then(value,\n                                    function (value) { results[key] = value; argDone(key); },\n                                    function (value) { errors[key] = value; argDone(key); }\n                                );\n                            }\n                        });\n                        pending -= undefineds;\n                        if (pending === 0) {\n                            complete(results);\n                            return;\n                        }\n                    },\n                    function () {\n                        Object.keys(values).forEach(function (key) {\n                            var promise = Promise.as(values[key]);\n                            if (typeof promise.cancel === \"function\") {\n                                promise.cancel();\n                            }\n                        });\n                    }\n                );\n            },\n            removeEventListener: function Promise_removeEventListener(eventType, listener, capture) {\n                /// <signature helpKeyword=\"WinJS.Promise.removeEventListener\">\n                /// <summary locid=\"WinJS.Promise.removeEventListener\">\n                /// Removes an event listener from the control.\n                /// </summary>\n                /// <param name='eventType' locid=\"WinJS.Promise.removeEventListener_eventType\">\n                /// The type (name) of the event.\n                /// </param>\n                /// <param name='listener' locid=\"WinJS.Promise.removeEventListener_listener\">\n                /// The listener to remove.\n                /// </param>\n                /// <param name='capture' locid=\"WinJS.Promise.removeEventListener_capture\">\n                /// Specifies whether or not to initiate capture.\n                /// </param>\n                /// </signature>\n                promiseEventListeners.removeEventListener(eventType, listener, capture);\n            },\n            supportedForProcessing: false,\n            then: function Promise_then(value, onComplete, onError, onProgress) {\n                /// <signature helpKeyword=\"WinJS.Promise.then\">\n                /// <summary locid=\"WinJS.Promise.then\">\n                /// A static version of the promise instance method then().\n                /// </summary>\n                /// <param name=\"value\" locid=\"WinJS.Promise.then_p:value\">\n                /// the value to be treated as a promise.\n                /// </param>\n                /// <param name=\"onComplete\" type=\"Function\" locid=\"WinJS.Promise.then_p:complete\">\n                /// The function to be called if the promise is fulfilled with a value.\n                /// If it is null, the promise simply\n                /// returns the value. The value is passed as the single argument.\n                /// </param>\n                /// <param name=\"onError\" type=\"Function\" optional=\"true\" locid=\"WinJS.Promise.then_p:error\">\n                /// The function to be called if the promise is fulfilled with an error. The error\n                /// is passed as the single argument.\n                /// </param>\n                /// <param name=\"onProgress\" type=\"Function\" optional=\"true\" locid=\"WinJS.Promise.then_p:progress\">\n                /// The function to be called if the promise reports progress. Data about the progress\n                /// is passed as the single argument. Promises are not required to support\n                /// progress.\n                /// </param>\n                /// <returns type=\"WinJS.Promise\" locid=\"WinJS.Promise.then_returnValue\">\n                /// A promise whose value is the result of executing the provided complete function.\n                /// </returns>\n                /// </signature>\n                return Promise.as(value).then(onComplete, onError, onProgress);\n            },\n            thenEach: function Promise_thenEach(values, onComplete, onError, onProgress) {\n                /// <signature helpKeyword=\"WinJS.Promise.thenEach\">\n                /// <summary locid=\"WinJS.Promise.thenEach\">\n                /// Performs an operation on all the input promises and returns a promise\n                /// that has the shape of the input and contains the result of the operation\n                /// that has been performed on each input.\n                /// </summary>\n                /// <param name=\"values\" locid=\"WinJS.Promise.thenEach_p:values\">\n                /// A set of values (which could be either an array or an object) of which some or all are promises.\n                /// </param>\n                /// <param name=\"onComplete\" type=\"Function\" locid=\"WinJS.Promise.thenEach_p:complete\">\n                /// The function to be called if the promise is fulfilled with a value.\n                /// If the value is null, the promise returns the value.\n                /// The value is passed as the single argument.\n                /// </param>\n                /// <param name=\"onError\" type=\"Function\" optional=\"true\" locid=\"WinJS.Promise.thenEach_p:error\">\n                /// The function to be called if the promise is fulfilled with an error. The error\n                /// is passed as the single argument.\n                /// </param>\n                /// <param name=\"onProgress\" type=\"Function\" optional=\"true\" locid=\"WinJS.Promise.thenEach_p:progress\">\n                /// The function to be called if the promise reports progress. Data about the progress\n                /// is passed as the single argument. Promises are not required to support\n                /// progress.\n                /// </param>\n                /// <returns type=\"WinJS.Promise\" locid=\"WinJS.Promise.thenEach_returnValue\">\n                /// A promise that is the result of calling Promise.join on the values parameter.\n                /// </returns>\n                /// </signature>\n                var result = Array.isArray(values) ? [] : {};\n                Object.keys(values).forEach(function (key) {\n                    result[key] = Promise.as(values[key]).then(onComplete, onError, onProgress);\n                });\n                return Promise.join(result);\n            },\n            timeout: function Promise_timeout(time, promise) {\n                /// <signature helpKeyword=\"WinJS.Promise.timeout\">\n                /// <summary locid=\"WinJS.Promise.timeout\">\n                /// Creates a promise that is fulfilled after a timeout.\n                /// </summary>\n                /// <param name=\"timeout\" type=\"Number\" optional=\"true\" locid=\"WinJS.Promise.timeout_p:timeout\">\n                /// The timeout period in milliseconds. If this value is zero or not specified\n                /// setImmediate is called, otherwise setTimeout is called.\n                /// </param>\n                /// <param name=\"promise\" type=\"Promise\" optional=\"true\" locid=\"WinJS.Promise.timeout_p:promise\">\n                /// A promise that will be canceled if it doesn't complete before the\n                /// timeout has expired.\n                /// </param>\n                /// <returns type=\"WinJS.Promise\" locid=\"WinJS.Promise.timeout_returnValue\">\n                /// A promise that is completed asynchronously after the specified timeout.\n                /// </returns>\n                /// </signature>\n                var to = timeout(time);\n                return promise ? timeoutWithPromise(to, promise) : to;\n            },\n            wrap: function Promise_wrap(value) {\n                /// <signature helpKeyword=\"WinJS.Promise.wrap\">\n                /// <summary locid=\"WinJS.Promise.wrap\">\n                /// Wraps a non-promise value in a promise. You can use this function if you need\n                /// to pass a value to a function that requires a promise.\n                /// </summary>\n                /// <param name=\"value\" locid=\"WinJS.Promise.wrap_p:value\">\n                /// Some non-promise value to be wrapped in a promise.\n                /// </param>\n                /// <returns type=\"WinJS.Promise\" locid=\"WinJS.Promise.wrap_returnValue\">\n                /// A promise that is successfully fulfilled with the specified value\n                /// </returns>\n                /// </signature>\n                return new CompletePromise(value);\n            },\n            wrapError: function Promise_wrapError(error) {\n                /// <signature helpKeyword=\"WinJS.Promise.wrapError\">\n                /// <summary locid=\"WinJS.Promise.wrapError\">\n                /// Wraps a non-promise error value in a promise. You can use this function if you need\n                /// to pass an error to a function that requires a promise.\n                /// </summary>\n                /// <param name=\"error\" locid=\"WinJS.Promise.wrapError_p:error\">\n                /// A non-promise error value to be wrapped in a promise.\n                /// </param>\n                /// <returns type=\"WinJS.Promise\" locid=\"WinJS.Promise.wrapError_returnValue\">\n                /// A promise that is in an error state with the specified value.\n                /// </returns>\n                /// </signature>\n                return new ErrorPromise(error);\n            },\n\n            _veryExpensiveTagWithStack: {\n                get: function () { return tagWithStack; },\n                set: function (value) { tagWithStack = value; }\n            },\n            _veryExpensiveTagWithStack_tag: tag,\n            _getStack: function () {\n                if (_Global.Debug && _Global.Debug.debuggerEnabled) {\n                    try { throw new Error(); } catch (e) { return e.stack; }\n                }\n            },\n\n            _cancelBlocker: function Promise__cancelBlocker(input, oncancel) {\n                //\n                // Returns a promise which on cancelation will still result in downstream cancelation while\n                //  protecting the promise 'input' from being  canceled which has the effect of allowing\n                //  'input' to be shared amoung various consumers.\n                //\n                if (!Promise.is(input)) {\n                    return Promise.wrap(input);\n                }\n                var complete;\n                var error;\n                var output = new Promise(\n                    function (c, e) {\n                        complete = c;\n                        error = e;\n                    },\n                    function () {\n                        complete = null;\n                        error = null;\n                        oncancel && oncancel();\n                    }\n                );\n                input.then(\n                    function (v) { complete && complete(v); },\n                    function (e) { error && error(e); }\n                );\n                return output;\n            },\n\n        }\n    );\n    Object.defineProperties(Promise, _Events.createEventProperties(errorET));\n\n    Promise._doneHandler = function (value) {\n        _BaseCoreUtils._setImmediate(function Promise_done_rethrow() {\n            throw value;\n        });\n    };\n\n    return {\n        PromiseStateMachine: PromiseStateMachine,\n        Promise: Promise,\n        state_created: state_created\n    };\n});\n\n_winjs(\"WinJS/Promise\", [\"WinJS/Core/_Base\",\"WinJS/Promise/_StateMachine\"], function promiseInit( _Base, _StateMachine) {\n    \"use strict\";\n\n    _Base.Namespace.define(\"WinJS\", {\n        Promise: _StateMachine.Promise\n    });\n\n    return _StateMachine.Promise;\n});\n\n__winjs_exports = _modules[\"WinJS/Core/_WinJS\"];\n__winjs_exports.TPromise = __winjs_exports.Promise;\n__winjs_exports.PPromise = __winjs_exports.Promise;\n\n// ESM-comment-begin\n// if (typeof exports === 'undefined' && typeof define === 'function' && define.amd) {\n//     define([], __winjs_exports);\n// } else {\n//     module.exports = __winjs_exports;\n// }\n// ESM-comment-end\n\n})();\n\n// ESM-uncomment-begin\nexport var Promise = __winjs_exports.Promise;\nexport var TPromise = __winjs_exports.TPromise;\nexport var PPromise = __winjs_exports.PPromise;\n// ESM-uncomment-end\n","'use strict';\nvar LIBRARY = require('./_library');\nvar global = require('./_global');\nvar ctx = require('./_ctx');\nvar classof = require('./_classof');\nvar $export = require('./_export');\nvar isObject = require('./_is-object');\nvar aFunction = require('./_a-function');\nvar anInstance = require('./_an-instance');\nvar forOf = require('./_for-of');\nvar speciesConstructor = require('./_species-constructor');\nvar task = require('./_task').set;\nvar microtask = require('./_microtask')();\nvar newPromiseCapabilityModule = require('./_new-promise-capability');\nvar perform = require('./_perform');\nvar userAgent = require('./_user-agent');\nvar promiseResolve = require('./_promise-resolve');\nvar PROMISE = 'Promise';\nvar TypeError = global.TypeError;\nvar process = global.process;\nvar versions = process && process.versions;\nvar v8 = versions && versions.v8 || '';\nvar $Promise = global[PROMISE];\nvar isNode = classof(process) == 'process';\nvar empty = function () { /* empty */ };\nvar Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;\nvar newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;\n\nvar USE_NATIVE = !!function () {\n  try {\n    // correct subclassing with @@species support\n    var promise = $Promise.resolve(1);\n    var FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function (exec) {\n      exec(empty, empty);\n    };\n    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n    return (isNode || typeof PromiseRejectionEvent == 'function')\n      && promise.then(empty) instanceof FakePromise\n      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n      // we can't detect it synchronously, so just check versions\n      && v8.indexOf('6.6') !== 0\n      && userAgent.indexOf('Chrome/66') === -1;\n  } catch (e) { /* empty */ }\n}();\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar notify = function (promise, isReject) {\n  if (promise._n) return;\n  promise._n = true;\n  var chain = promise._c;\n  microtask(function () {\n    var value = promise._v;\n    var ok = promise._s == 1;\n    var i = 0;\n    var run = function (reaction) {\n      var handler = ok ? reaction.ok : reaction.fail;\n      var resolve = reaction.resolve;\n      var reject = reaction.reject;\n      var domain = reaction.domain;\n      var result, then, exited;\n      try {\n        if (handler) {\n          if (!ok) {\n            if (promise._h == 2) onHandleUnhandled(promise);\n            promise._h = 1;\n          }\n          if (handler === true) result = value;\n          else {\n            if (domain) domain.enter();\n            result = handler(value); // may throw\n            if (domain) {\n              domain.exit();\n              exited = true;\n            }\n          }\n          if (result === reaction.promise) {\n            reject(TypeError('Promise-chain cycle'));\n          } else if (then = isThenable(result)) {\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch (e) {\n        if (domain && !exited) domain.exit();\n        reject(e);\n      }\n    };\n    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach\n    promise._c = [];\n    promise._n = false;\n    if (isReject && !promise._h) onUnhandled(promise);\n  });\n};\nvar onUnhandled = function (promise) {\n  task.call(global, function () {\n    var value = promise._v;\n    var unhandled = isUnhandled(promise);\n    var result, handler, console;\n    if (unhandled) {\n      result = perform(function () {\n        if (isNode) {\n          process.emit('unhandledRejection', value, promise);\n        } else if (handler = global.onunhandledrejection) {\n          handler({ promise: promise, reason: value });\n        } else if ((console = global.console) && console.error) {\n          console.error('Unhandled promise rejection', value);\n        }\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      promise._h = isNode || isUnhandled(promise) ? 2 : 1;\n    } promise._a = undefined;\n    if (unhandled && result.e) throw result.v;\n  });\n};\nvar isUnhandled = function (promise) {\n  return promise._h !== 1 && (promise._a || promise._c).length === 0;\n};\nvar onHandleUnhandled = function (promise) {\n  task.call(global, function () {\n    var handler;\n    if (isNode) {\n      process.emit('rejectionHandled', promise);\n    } else if (handler = global.onrejectionhandled) {\n      handler({ promise: promise, reason: promise._v });\n    }\n  });\n};\nvar $reject = function (value) {\n  var promise = this;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  promise._v = value;\n  promise._s = 2;\n  if (!promise._a) promise._a = promise._c.slice();\n  notify(promise, true);\n};\nvar $resolve = function (value) {\n  var promise = this;\n  var then;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  try {\n    if (promise === value) throw TypeError(\"Promise can't be resolved itself\");\n    if (then = isThenable(value)) {\n      microtask(function () {\n        var wrapper = { _w: promise, _d: false }; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch (e) {\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      promise._v = value;\n      promise._s = 1;\n      notify(promise, false);\n    }\n  } catch (e) {\n    $reject.call({ _w: promise, _d: false }, e); // wrap\n  }\n};\n\n// constructor polyfill\nif (!USE_NATIVE) {\n  // 25.4.3.1 Promise(executor)\n  $Promise = function Promise(executor) {\n    anInstance(this, $Promise, PROMISE, '_h');\n    aFunction(executor);\n    Internal.call(this);\n    try {\n      executor(ctx($resolve, this, 1), ctx($reject, this, 1));\n    } catch (err) {\n      $reject.call(this, err);\n    }\n  };\n  // eslint-disable-next-line no-unused-vars\n  Internal = function Promise(executor) {\n    this._c = [];             // <- awaiting reactions\n    this._a = undefined;      // <- checked in isUnhandled reactions\n    this._s = 0;              // <- state\n    this._d = false;          // <- done\n    this._v = undefined;      // <- value\n    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled\n    this._n = false;          // <- notify\n  };\n  Internal.prototype = require('./_redefine-all')($Promise.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected) {\n      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));\n      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      reaction.domain = isNode ? process.domain : undefined;\n      this._c.push(reaction);\n      if (this._a) this._a.push(reaction);\n      if (this._s) notify(this, false);\n      return reaction.promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    this.promise = promise;\n    this.resolve = ctx($resolve, promise, 1);\n    this.reject = ctx($reject, promise, 1);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === $Promise || C === Wrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });\nrequire('./_set-to-string-tag')($Promise, PROMISE);\nrequire('./_set-species')(PROMISE);\nWrapper = require('./_core')[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    var $$reject = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x) {\n    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function (iter) {\n  $Promise.all(iter)['catch'](empty);\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var values = [];\n      var index = 0;\n      var remaining = 1;\n      forOf(iterable, false, function (promise) {\n        var $index = index++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        C.resolve(promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[$index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      forOf(iterable, false, function (promise) {\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  }\n});\n","var core = require('./_core');\nvar global = require('./_global');\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: core.version,\n  mode: require('./_library') ? 'pure' : 'global',\n  copyright: '© 2018 Denis Pushkarev (zloirock.ru)'\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./decorations.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"1583f4b7\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./textAreaHandler.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"8b8a5a74\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var global = require('./_global');\nvar core = require('./_core');\nvar hide = require('./_hide');\nvar redefine = require('./_redefine');\nvar ctx = require('./_ctx');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] || (global[name] = {}) : (global[name] || {})[PROTOTYPE];\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE] || (exports[PROTOTYPE] = {});\n  var key, own, out, exp;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    // export native or passed\n    out = (own ? target : source)[key];\n    // bind timers to global for call from export context\n    exp = IS_BIND && own ? ctx(out, global) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // extend global\n    if (target) redefine(target, key, out, type & $export.U);\n    // export\n    if (exports[key] != out) hide(exports, key, exp);\n    if (IS_PROTO && expProto[key] != out) expProto[key] = out;\n  }\n};\nglobal.core = core;\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n","var ITERATOR = require('./_wks')('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function () { SAFE_CLOSING = true; };\n  // eslint-disable-next-line no-throw-literal\n  Array.from(riter, function () { throw 2; });\n} catch (e) { /* empty */ }\n\nmodule.exports = function (exec, skipClosing) {\n  if (!skipClosing && !SAFE_CLOSING) return false;\n  var safe = false;\n  try {\n    var arr = [7];\n    var iter = arr[ITERATOR]();\n    iter.next = function () { return { done: safe = true }; };\n    arr[ITERATOR] = function () { return iter; };\n    exec(arr);\n  } catch (e) { /* empty */ }\n  return safe;\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./marginDecorations.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"2ea0e4a9\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var isObject = require('./_is-object');\nvar setPrototypeOf = require('./_set-proto').set;\nmodule.exports = function (that, target, C) {\n  var S = target.constructor;\n  var P;\n  if (S !== C && typeof S == 'function' && (P = S.prototype) !== C.prototype && isObject(P) && setPrototypeOf) {\n    setPrototypeOf(that, P);\n  } return that;\n};\n","var shared = require('./_shared')('keys');\nvar uid = require('./_uid');\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .glyph-margin{position:absolute;top:0}.monaco-editor .margin-view-overlays .cgmr{position:absolute}\", \"\"]);\n\n// exports\n","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject');\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./overlayWidgets.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"61cc0731\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","'use strict';\n// 19.1.2.1 Object.assign(target, source, ...)\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nvar toObject = require('./_to-object');\nvar IObject = require('./_iobject');\nvar $assign = Object.assign;\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = !$assign || require('./_fails')(function () {\n  var A = {};\n  var B = {};\n  // eslint-disable-next-line no-undef\n  var S = Symbol();\n  var K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function (k) { B[k] = k; });\n  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;\n}) ? function assign(target, source) { // eslint-disable-line no-unused-vars\n  var T = toObject(target);\n  var aLen = arguments.length;\n  var index = 1;\n  var getSymbols = gOPS.f;\n  var isEnum = pIE.f;\n  while (aLen > index) {\n    var S = IObject(arguments[index++]);\n    var keys = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S);\n    var length = keys.length;\n    var j = 0;\n    var key;\n    while (length > j) if (isEnum.call(S, key = keys[j++])) T[key] = S[key];\n  } return T;\n} : $assign;\n","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n","var toInteger = require('./_to-integer');\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./selections.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"3ba10d89\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./contextMenuHandler.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"59b57c3c\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","'use strict';\nvar global = require('./_global');\nvar dP = require('./_object-dp');\nvar DESCRIPTORS = require('./_descriptors');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (KEY) {\n  var C = global[KEY];\n  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {\n    configurable: true,\n    get: function () { return this; }\n  });\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./scrollbars.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"66061424\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var def = require('./_object-dp').f;\nvar has = require('./_has');\nvar TAG = require('./_wks')('toStringTag');\n\nmodule.exports = function (it, tag, stat) {\n  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });\n};\n","var global = require('./_global');\nvar macrotask = require('./_task').set;\nvar Observer = global.MutationObserver || global.WebKitMutationObserver;\nvar process = global.process;\nvar Promise = global.Promise;\nvar isNode = require('./_cof')(process) == 'process';\n\nmodule.exports = function () {\n  var head, last, notify;\n\n  var flush = function () {\n    var parent, fn;\n    if (isNode && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (e) {\n        if (head) notify();\n        else last = undefined;\n        throw e;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // Node.js\n  if (isNode) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339\n  } else if (Observer && !(global.navigator && global.navigator.standalone)) {\n    var toggle = true;\n    var node = document.createTextNode('');\n    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    var promise = Promise.resolve(undefined);\n    notify = function () {\n      promise.then(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function () {\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n\n  return function (fn) {\n    var task = { fn: fn, next: undefined };\n    if (last) last.next = task;\n    if (!head) {\n      head = task;\n      notify();\n    } last = task;\n  };\n};\n","var core = module.exports = { version: '2.6.1' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./glyphMargin.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"707de44e\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .lines-content .cslr{position:absolute}.monaco-editor .top-left-radius{border-top-left-radius:3px}.monaco-editor .bottom-left-radius{border-bottom-left-radius:3px}.monaco-editor .top-right-radius{border-top-right-radius:3px}.monaco-editor .bottom-right-radius{border-bottom-right-radius:3px}.monaco-editor.hc-black .top-left-radius{border-top-left-radius:0}.monaco-editor.hc-black .bottom-left-radius{border-bottom-left-radius:0}.monaco-editor.hc-black .top-right-radius{border-top-right-radius:0}.monaco-editor.hc-black .bottom-right-radius{border-bottom-right-radius:0}\", \"\"]);\n\n// exports\n","module.exports = {};\n","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar isObject = require('./_is-object');\nvar anObject = require('./_an-object');\nvar check = function (O, proto) {\n  anObject(O);\n  if (!isObject(proto) && proto !== null) throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line\n    function (test, buggy, set) {\n      try {\n        set = require('./_ctx')(Function.call, require('./_object-gopd').f(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch (e) { buggy = true; }\n      return function setPrototypeOf(O, proto) {\n        check(O, proto);\n        if (buggy) O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};\n","// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys = require('./_object-keys-internal');\nvar hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return $keys(O, hiddenKeys);\n};\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor.safari .lines-content,.monaco-editor.safari .view-line,.monaco-editor.safari .view-lines{-webkit-user-select:text;user-select:text}.monaco-editor .lines-content,.monaco-editor .view-line,.monaco-editor .view-lines{-webkit-user-select:none;-ms-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none}.monaco-editor .view-lines{cursor:text;white-space:nowrap}.monaco-editor.hc-black.mac .view-lines,.monaco-editor.vs-dark.mac .view-lines{cursor:-webkit-image-set(url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAL0lEQVQoz2NgCD3x//9/BhBYBWdhgFVAiVW4JBFKGIa4AqD0//9D3pt4I4tAdAMAHTQ/j5Zom30AAAAASUVORK5CYII=) 1x,url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAAz0lEQVRIx2NgYGBY/R8I/vx5eelX3n82IJ9FxGf6tksvf/8FiTMQAcAGQMDvSwu09abffY8QYSAScNk45G198eX//yev73/4///701eh//kZSARckrNBRvz//+8+6ZohwCzjGNjdgQxkAg7B9WADeBjIBqtJCbhRA0YNoIkBSNmaPEMoNmA0FkYNoFKhapJ6FGyAH3nauaSmPfwI0v/3OukVi0CIZ+F25KrtYcx/CTIy0e+rC7R1Z4KMICVTQQ14feVXIbR695u14+Ir4gwAAD49E54wc1kWAAAAAElFTkSuQmCC) 2x) 5 8,text}.monaco-editor .view-line{position:absolute;width:100%}\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./currentLineHighlight.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"7018a689\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./diffEditor.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"3d10c64b\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./editor.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"c8f78f2a\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","// 22.1.3.31 Array.prototype[@@unscopables]\nvar UNSCOPABLES = require('./_wks')('unscopables');\nvar ArrayProto = Array.prototype;\nif (ArrayProto[UNSCOPABLES] == undefined) require('./_hide')(ArrayProto, UNSCOPABLES, {});\nmodule.exports = function (key) {\n  ArrayProto[UNSCOPABLES][key] = true;\n};\n","module.exports = function (exec) {\n  try {\n    return { e: false, v: exec() };\n  } catch (e) {\n    return { e: true, v: e };\n  }\n};\n","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer');\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","var global = require('./_global');\nvar navigator = global.navigator;\n\nmodule.exports = navigator && navigator.userAgent || '';\n","'use strict';\n// 25.4.1.5 NewPromiseCapability(C)\nvar aFunction = require('./_a-function');\n\nfunction PromiseCapability(C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject = aFunction(reject);\n}\n\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .lines-decorations{position:absolute;top:0;background:#fff}.monaco-editor .margin-view-overlays .cldr{position:absolute;height:100%}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"::-ms-clear{display:none}.monaco-editor .editor-widget input{color:inherit}.monaco-editor{position:relative;overflow:visible;-webkit-text-size-adjust:100%;-webkit-font-feature-settings:\\\"liga\\\" off,\\\"calt\\\" off;font-feature-settings:\\\"liga\\\" off,\\\"calt\\\" off}.monaco-editor.enable-ligatures{-webkit-font-feature-settings:\\\"liga\\\" on,\\\"calt\\\" on;font-feature-settings:\\\"liga\\\" on,\\\"calt\\\" on}.monaco-editor .overflow-guard{position:relative;overflow:hidden}.monaco-editor .view-overlays{position:absolute;top:0}\", \"\"]);\n\n// exports\n","var $export = require('./_export');\nvar defined = require('./_defined');\nvar fails = require('./_fails');\nvar spaces = require('./_string-ws');\nvar space = '[' + spaces + ']';\nvar non = '\\u200b\\u0085';\nvar ltrim = RegExp('^' + space + space + '*');\nvar rtrim = RegExp(space + space + '*$');\n\nvar exporter = function (KEY, exec, ALIAS) {\n  var exp = {};\n  var FORCE = fails(function () {\n    return !!spaces[KEY]() || non[KEY]() != non;\n  });\n  var fn = exp[KEY] = FORCE ? exec(trim) : spaces[KEY];\n  if (ALIAS) exp[ALIAS] = fn;\n  $export($export.P + $export.F * FORCE, 'String', exp);\n};\n\n// 1 -> String#trimLeft\n// 2 -> String#trimRight\n// 3 -> String#trim\nvar trim = exporter.trim = function (string, TYPE) {\n  string = String(defined(string));\n  if (TYPE & 1) string = string.replace(ltrim, '');\n  if (TYPE & 2) string = string.replace(rtrim, '');\n  return string;\n};\n\nmodule.exports = exporter;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./standalone-tokens.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"1c19f4a5\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./tokens.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"5e9736cb\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./sash.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"308af230\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-sash{position:absolute;z-index:90;touch-action:none}.monaco-sash.disabled{pointer-events:none}.monaco-sash.vertical{cursor:ew-resize;top:0;width:4px;height:100%}.monaco-sash.mac.vertical{cursor:col-resize}.monaco-sash.vertical.minimum{cursor:e-resize}.monaco-sash.vertical.maximum{cursor:w-resize}.monaco-sash.horizontal{cursor:ns-resize;left:0;width:100%;height:4px}.monaco-sash.mac.horizontal{cursor:row-resize}.monaco-sash.horizontal.minimum{cursor:s-resize}.monaco-sash.horizontal.maximum{cursor:n-resize}.monaco-sash:not(.disabled).orthogonal-end:after,.monaco-sash:not(.disabled).orthogonal-start:before{content:\\\" \\\";height:8px;width:8px;z-index:100;display:block;cursor:all-scroll;position:absolute}.monaco-sash.orthogonal-start.vertical:before{left:-2px;top:-4px}.monaco-sash.orthogonal-end.vertical:after{left:-2px;bottom:-4px}.monaco-sash.orthogonal-start.horizontal:before{top:-2px;left:-4px}.monaco-sash.orthogonal-end.horizontal:after{top:-2px;right:-4px}.monaco-sash.disabled{cursor:default!important}.monaco-sash.touch.vertical{width:20px}.monaco-sash.touch.horizontal{height:20px}.monaco-sash.debug:not(.disabled){background:#0ff}.monaco-sash.debug:not(.disabled).orthogonal-end:after,.monaco-sash.debug:not(.disabled).orthogonal-start:before{background:red}\", \"\"]);\n\n// exports\n","var anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar newPromiseCapability = require('./_new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./tree.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"48a22289\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .minimap.slider-mouseover .minimap-slider{opacity:0;transition:opacity .1s linear}.monaco-editor .minimap.slider-mouseover .minimap-slider.active,.monaco-editor .minimap.slider-mouseover:hover .minimap-slider{opacity:1}.monaco-editor .minimap-shadow-hidden{position:absolute;width:0}.monaco-editor .minimap-shadow-visible{position:absolute;left:-6px;width:6px}\", \"\"]);\n\n// exports\n","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n","'use strict';\nvar global = require('./_global');\nvar has = require('./_has');\nvar cof = require('./_cof');\nvar inheritIfRequired = require('./_inherit-if-required');\nvar toPrimitive = require('./_to-primitive');\nvar fails = require('./_fails');\nvar gOPN = require('./_object-gopn').f;\nvar gOPD = require('./_object-gopd').f;\nvar dP = require('./_object-dp').f;\nvar $trim = require('./_string-trim').trim;\nvar NUMBER = 'Number';\nvar $Number = global[NUMBER];\nvar Base = $Number;\nvar proto = $Number.prototype;\n// Opera ~12 has broken Object#toString\nvar BROKEN_COF = cof(require('./_object-create')(proto)) == NUMBER;\nvar TRIM = 'trim' in String.prototype;\n\n// 7.1.3 ToNumber(argument)\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, false);\n  if (typeof it == 'string' && it.length > 2) {\n    it = TRIM ? it.trim() : $trim(it, 3);\n    var first = it.charCodeAt(0);\n    var third, radix, maxCode;\n    if (first === 43 || first === 45) {\n      third = it.charCodeAt(2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (it.charCodeAt(1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal /^0o[0-7]+$/i\n        default: return +it;\n      }\n      for (var digits = it.slice(2), i = 0, l = digits.length, code; i < l; i++) {\n        code = digits.charCodeAt(i);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\nif (!$Number(' 0o1') || !$Number('0b1') || $Number('+0x1')) {\n  $Number = function Number(value) {\n    var it = arguments.length < 1 ? 0 : value;\n    var that = this;\n    return that instanceof $Number\n      // check on 1..constructor(foo) case\n      && (BROKEN_COF ? fails(function () { proto.valueOf.call(that); }) : cof(that) != NUMBER)\n        ? inheritIfRequired(new Base(toNumber(it)), that, $Number) : toNumber(it);\n  };\n  for (var keys = require('./_descriptors') ? gOPN(Base) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES6 (in case, if modules with ES6 Number statics required before):\n    'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,' +\n    'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (has(Base, key = keys[j]) && !has($Number, key)) {\n      dP($Number, key, gOPD(Base, key));\n    }\n  }\n  $Number.prototype = proto;\n  proto.constructor = $Number;\n  require('./_redefine')(global, NUMBER, $Number);\n}\n","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./actionbar.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"d7f6c048\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n","'use strict';\nvar addToUnscopables = require('./_add-to-unscopables');\nvar step = require('./_iter-step');\nvar Iterators = require('./_iterators');\nvar toIObject = require('./_to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var kind = this._k;\n  var index = this._i++;\n  if (!O || index >= O.length) {\n    this._t = undefined;\n    return step(1);\n  }\n  if (kind == 'keys') return step(0, index);\n  if (kind == 'values') return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n","var has = require('./_has');\nvar toIObject = require('./_to-iobject');\nvar arrayIndexOf = require('./_array-includes')(false);\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","module.exports = function (done, value) {\n  return { value: value, done: !!done };\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./scrollDecoration.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"cc65b25a\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./viewCursors.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"2d54748c\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var redefine = require('./_redefine');\nmodule.exports = function (target, src, safe) {\n  for (var key in src) redefine(target, key, src[key], safe);\n  return target;\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nvar splitPathRe =\n    /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\nvar splitPath = function(filename) {\n  return splitPathRe.exec(filename).slice(1);\n};\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function(path) {\n  var result = splitPath(path),\n      root = result[0],\n      dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n};\n\n\nexports.basename = function(path, ext) {\n  var f = splitPath(path)[2];\n  // TODO: make this comparison case-insensitive on windows?\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\n\nexports.extname = function(path) {\n  return splitPath(path)[3];\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-diff-editor .diffOverview{z-index:9}.monaco-diff-editor.vs .diffOverview{background:rgba(0,0,0,.03)}.monaco-diff-editor.vs-dark .diffOverview{background:hsla(0,0%,100%,.01)}.monaco-diff-editor .diffViewport{box-shadow:inset 0 0 1px 0 #b9b9b9;background:rgba(0,0,0,.1)}.monaco-diff-editor.hc-black .diffViewport,.monaco-diff-editor.vs-dark .diffViewport{background:hsla(0,0%,100%,.1)}.monaco-scrollable-element.modified-in-monaco-diff-editor.vs-dark .scrollbar,.monaco-scrollable-element.modified-in-monaco-diff-editor.vs .scrollbar{background:transparent}.monaco-scrollable-element.modified-in-monaco-diff-editor.hc-black .scrollbar{background:none}.monaco-scrollable-element.modified-in-monaco-diff-editor .slider{z-index:10}.modified-in-monaco-diff-editor .slider.active{background:hsla(0,0%,67.1%,.4)}.modified-in-monaco-diff-editor.hc-black .slider.active{background:none}.monaco-diff-editor .delete-sign,.monaco-diff-editor .insert-sign,.monaco-editor .delete-sign,.monaco-editor .insert-sign{background-size:60%;opacity:.7;background-repeat:no-repeat;background-position:50% 50%;background-position:50%;background-size:11px 11px}.monaco-diff-editor.hc-black .delete-sign,.monaco-diff-editor.hc-black .insert-sign,.monaco-editor.hc-black .delete-sign,.monaco-editor.hc-black .insert-sign{opacity:1}.monaco-diff-editor .insert-sign,.monaco-editor .insert-sign{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0iIzQyNDI0MiIgZD0iTTcgM2gzdjExSDd6Ii8+PHBhdGggZmlsbD0iIzQyNDI0MiIgZD0iTTMgN2gxMXYzSDN6Ii8+PC9zdmc+\\\")}.monaco-diff-editor .delete-sign,.monaco-editor .delete-sign{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0iIzQyNDI0MiIgZD0iTTMgN2gxMXYzSDN6Ii8+PC9zdmc+\\\")}.monaco-diff-editor.hc-black .insert-sign,.monaco-diff-editor.vs-dark .insert-sign,.monaco-editor.hc-black .insert-sign,.monaco-editor.vs-dark .insert-sign{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0iI0M1QzVDNSIgZD0iTTcgM2gzdjExSDd6Ii8+PHBhdGggZmlsbD0iI0M1QzVDNSIgZD0iTTMgN2gxMXYzSDN6Ii8+PC9zdmc+\\\")}.monaco-diff-editor.hc-black .delete-sign,.monaco-diff-editor.vs-dark .delete-sign,.monaco-editor.hc-black .delete-sign,.monaco-editor.vs-dark .delete-sign{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0iI0M1QzVDNSIgZD0iTTMgN2gxMXYzSDN6Ii8+PC9zdmc+\\\")}.monaco-editor .inline-added-margin-view-zone,.monaco-editor .inline-deleted-margin-view-zone{text-align:right}.monaco-editor .diagonal-fill{background:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAChJREFUKFNjOH/+fAMDDgCSu3Dhwn9c8gwwBTgNGR4KQP4HhQOhsAIAZCBTkhtqePcAAAAASUVORK5CYII=\\\")}.monaco-editor.vs-dark .diagonal-fill{opacity:.2}.monaco-editor.hc-black .diagonal-fill{background:none}.monaco-editor .view-zones .view-lines .view-line span{display:inline-block}\", \"\"]);\n\n// exports\n","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .view-overlays .current-line{display:block;position:absolute;left:0;top:0;box-sizing:border-box}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".context-view .monaco-menu{min-width:130px}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .view-ruler{position:absolute;top:0}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .cursors-layer{position:absolute;top:0}.monaco-editor .cursors-layer>.cursor{position:absolute;cursor:text;overflow:hidden}.monaco-editor .cursors-layer.cursor-block-outline-style>.cursor{box-sizing:border-box;background:transparent!important;border-style:solid;border-width:1px}.monaco-editor .cursors-layer.cursor-underline-style>.cursor{border-bottom-width:2px;border-bottom-style:solid;background:transparent!important;box-sizing:border-box}.monaco-editor .cursors-layer.cursor-underline-thin-style>.cursor{border-bottom-width:1px;border-bottom-style:solid;background:transparent!important;box-sizing:border-box}@keyframes monaco-cursor-smooth{0%,20%{opacity:1}60%,to{opacity:0}}@keyframes monaco-cursor-phase{0%,20%{opacity:1}90%,to{opacity:0}}@keyframes monaco-cursor-expand{0%,20%{transform:scaleY(1)}80%,to{transform:scaleY(0)}}.cursor-smooth{animation:monaco-cursor-smooth .5s ease-in-out 0s 20 alternate}.cursor-phase{animation:monaco-cursor-phase .5s ease-in-out 0s 20 alternate}.cursor-expand>.cursor{animation:monaco-cursor-expand .5s ease-in-out 0s 20 alternate}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-tree{height:100%;width:100%;white-space:nowrap;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:-moz-none;-ms-user-select:none;-o-user-select:none;user-select:none;position:relative}.monaco-tree>.monaco-scrollable-element{height:100%}.monaco-tree>.monaco-scrollable-element>.monaco-tree-wrapper{height:100%;width:100%;position:relative}.monaco-tree .monaco-tree-rows{position:absolute;width:100%;height:100%}.monaco-tree .monaco-tree-rows>.monaco-tree-row{-moz-box-sizing:border-box;-o-box-sizing:border-box;-ms-box-sizing:border-box;box-sizing:border-box;cursor:pointer;overflow:hidden;width:100%;touch-action:none}.monaco-tree .monaco-tree-rows>.monaco-tree-row>.content{position:relative;height:100%}.monaco-tree-drag-image{display:inline-block;padding:1px 7px;border-radius:10px;font-size:12px;position:absolute}.monaco-tree .monaco-tree-rows>.monaco-tree-row.scrolling{display:none}.monaco-tree .monaco-tree-rows.show-twisties>.monaco-tree-row.has-children>.content:before{content:\\\" \\\";position:absolute;display:block;background:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHBhdGggZmlsbD0iIzY0NjQ2NSIgZD0iTTYgNHY4bDQtNC00LTR6bTEgMi40MTRMOC41ODYgOCA3IDkuNTg2VjYuNDE0eiIvPjwvc3ZnPg==\\\") 50% 50% no-repeat;width:16px;height:100%;top:0;left:-16px}.monaco-tree .monaco-tree-rows.show-twisties>.monaco-tree-row.expanded>.content:before{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHBhdGggZmlsbD0iIzY0NjQ2NSIgZD0iTTExIDEwSDUuMzQ0TDExIDQuNDE0VjEweiIvPjwvc3ZnPg==\\\")}.monaco-tree .monaco-tree-rows>.monaco-tree-row.has-children.loading>.content:before{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCI+PHN0eWxlPmNpcmNsZXthbmltYXRpb246YmFsbCAuNnMgbGluZWFyIGluZmluaXRlfWNpcmNsZTpudGgtY2hpbGQoMil7YW5pbWF0aW9uLWRlbGF5Oi4wNzVzfWNpcmNsZTpudGgtY2hpbGQoMyl7YW5pbWF0aW9uLWRlbGF5Oi4xNXN9Y2lyY2xlOm50aC1jaGlsZCg0KXthbmltYXRpb24tZGVsYXk6LjIyNXN9Y2lyY2xlOm50aC1jaGlsZCg1KXthbmltYXRpb24tZGVsYXk6LjNzfWNpcmNsZTpudGgtY2hpbGQoNil7YW5pbWF0aW9uLWRlbGF5Oi4zNzVzfWNpcmNsZTpudGgtY2hpbGQoNyl7YW5pbWF0aW9uLWRlbGF5Oi40NXN9Y2lyY2xlOm50aC1jaGlsZCg4KXthbmltYXRpb24tZGVsYXk6LjUyNXN9PC9zdHlsZT48Y2lyY2xlIGN4PSI1IiBjeT0iMSIgcj0iMSIgb3BhY2l0eT0iLjMiLz48Y2lyY2xlIGN4PSI3LjgyOCIgY3k9IjIuMTcyIiByPSIxIiBvcGFjaXR5PSIuMyIvPjxjaXJjbGUgY3g9IjkiIGN5PSI1IiByPSIxIiBvcGFjaXR5PSIuMyIvPjxjaXJjbGUgY3g9IjcuODI4IiBjeT0iNy44MjgiIHI9IjEiIG9wYWNpdHk9Ii4zIi8+PGNpcmNsZSBjeD0iNSIgY3k9IjkiIHI9IjEiIG9wYWNpdHk9Ii4zIi8+PGNpcmNsZSBjeD0iMi4xNzIiIGN5PSI3LjgyOCIgcj0iMSIgb3BhY2l0eT0iLjMiLz48Y2lyY2xlIGN4PSIxIiBjeT0iNSIgcj0iMSIgb3BhY2l0eT0iLjMiLz48Y2lyY2xlIGN4PSIyLjE3MiIgY3k9IjIuMTcyIiByPSIxIiBvcGFjaXR5PSIuMyIvPjwvc3ZnPg==\\\")}.monaco-tree.highlighted .monaco-tree-rows>.monaco-tree-row:not(.highlighted){opacity:.3}.vs-dark .monaco-tree .monaco-tree-rows.show-twisties>.monaco-tree-row.has-children>.content:before{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHBhdGggZmlsbD0iI0U4RThFOCIgZD0iTTYgNHY4bDQtNC00LTR6bTEgMi40MTRMOC41ODYgOCA3IDkuNTg2VjYuNDE0eiIvPjwvc3ZnPg==\\\")}.vs-dark .monaco-tree .monaco-tree-rows.show-twisties>.monaco-tree-row.expanded>.content:before{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHBhdGggZmlsbD0iI0U4RThFOCIgZD0iTTExIDEwSDUuMzQ0TDExIDQuNDE0VjEweiIvPjwvc3ZnPg==\\\")}.vs-dark .monaco-tree .monaco-tree-rows>.monaco-tree-row.has-children.loading>.content:before{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCI+PHN0eWxlPmNpcmNsZXthbmltYXRpb246YmFsbCAuNnMgbGluZWFyIGluZmluaXRlfWNpcmNsZTpudGgtY2hpbGQoMil7YW5pbWF0aW9uLWRlbGF5Oi4wNzVzfWNpcmNsZTpudGgtY2hpbGQoMyl7YW5pbWF0aW9uLWRlbGF5Oi4xNXN9Y2lyY2xlOm50aC1jaGlsZCg0KXthbmltYXRpb24tZGVsYXk6LjIyNXN9Y2lyY2xlOm50aC1jaGlsZCg1KXthbmltYXRpb24tZGVsYXk6LjNzfWNpcmNsZTpudGgtY2hpbGQoNil7YW5pbWF0aW9uLWRlbGF5Oi4zNzVzfWNpcmNsZTpudGgtY2hpbGQoNyl7YW5pbWF0aW9uLWRlbGF5Oi40NXN9Y2lyY2xlOm50aC1jaGlsZCg4KXthbmltYXRpb24tZGVsYXk6LjUyNXN9PC9zdHlsZT48ZyBmaWxsPSJncmF5Ij48Y2lyY2xlIGN4PSI1IiBjeT0iMSIgcj0iMSIgb3BhY2l0eT0iLjMiLz48Y2lyY2xlIGN4PSI3LjgyOCIgY3k9IjIuMTcyIiByPSIxIiBvcGFjaXR5PSIuMyIvPjxjaXJjbGUgY3g9IjkiIGN5PSI1IiByPSIxIiBvcGFjaXR5PSIuMyIvPjxjaXJjbGUgY3g9IjcuODI4IiBjeT0iNy44MjgiIHI9IjEiIG9wYWNpdHk9Ii4zIi8+PGNpcmNsZSBjeD0iNSIgY3k9IjkiIHI9IjEiIG9wYWNpdHk9Ii4zIi8+PGNpcmNsZSBjeD0iMi4xNzIiIGN5PSI3LjgyOCIgcj0iMSIgb3BhY2l0eT0iLjMiLz48Y2lyY2xlIGN4PSIxIiBjeT0iNSIgcj0iMSIgb3BhY2l0eT0iLjMiLz48Y2lyY2xlIGN4PSIyLjE3MiIgY3k9IjIuMTcyIiByPSIxIiBvcGFjaXR5PSIuMyIvPjwvZz48L3N2Zz4=\\\")}.hc-black .monaco-tree .monaco-tree-rows.show-twisties>.monaco-tree-row.has-children>.content:before{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiI+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTYgNHY4bDQtNC00LTR6bTEgMi40MTRMOC41ODYgOCA3IDkuNTg2VjYuNDE0eiIvPjwvc3ZnPg==\\\")}.hc-black .monaco-tree .monaco-tree-rows.show-twisties>.monaco-tree-row.expanded>.content:before{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiI+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTExIDEwLjA3SDUuMzQ0TDExIDQuNDE0djUuNjU2eiIvPjwvc3ZnPg==\\\")}.hc-black .monaco-tree .monaco-tree-rows>.monaco-tree-row.has-children.loading>.content:before{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCI+PHN0eWxlPmNpcmNsZXthbmltYXRpb246YmFsbCAuNnMgbGluZWFyIGluZmluaXRlfWNpcmNsZTpudGgtY2hpbGQoMil7YW5pbWF0aW9uLWRlbGF5Oi4wNzVzfWNpcmNsZTpudGgtY2hpbGQoMyl7YW5pbWF0aW9uLWRlbGF5Oi4xNXN9Y2lyY2xlOm50aC1jaGlsZCg0KXthbmltYXRpb24tZGVsYXk6LjIyNXN9Y2lyY2xlOm50aC1jaGlsZCg1KXthbmltYXRpb24tZGVsYXk6LjNzfWNpcmNsZTpudGgtY2hpbGQoNil7YW5pbWF0aW9uLWRlbGF5Oi4zNzVzfWNpcmNsZTpudGgtY2hpbGQoNyl7YW5pbWF0aW9uLWRlbGF5Oi40NXN9Y2lyY2xlOm50aC1jaGlsZCg4KXthbmltYXRpb24tZGVsYXk6LjUyNXN9PC9zdHlsZT48ZyBmaWxsPSIjZmZmIj48Y2lyY2xlIGN4PSI1IiBjeT0iMSIgcj0iMSIgb3BhY2l0eT0iLjMiLz48Y2lyY2xlIGN4PSI3LjgyOCIgY3k9IjIuMTcyIiByPSIxIiBvcGFjaXR5PSIuMyIvPjxjaXJjbGUgY3g9IjkiIGN5PSI1IiByPSIxIiBvcGFjaXR5PSIuMyIvPjxjaXJjbGUgY3g9IjcuODI4IiBjeT0iNy44MjgiIHI9IjEiIG9wYWNpdHk9Ii4zIi8+PGNpcmNsZSBjeD0iNSIgY3k9IjkiIHI9IjEiIG9wYWNpdHk9Ii4zIi8+PGNpcmNsZSBjeD0iMi4xNzIiIGN5PSI3LjgyOCIgcj0iMSIgb3BhY2l0eT0iLjMiLz48Y2lyY2xlIGN4PSIxIiBjeT0iNSIgcj0iMSIgb3BhY2l0eT0iLjMiLz48Y2lyY2xlIGN4PSIyLjE3MiIgY3k9IjIuMTcyIiByPSIxIiBvcGFjaXR5PSIuMyIvPjwvZz48L3N2Zz4=\\\")}.monaco-tree-action.collapse-all{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iLTEgMCAxNiAxNiI+PHBhdGggZmlsbD0iIzQyNDI0MiIgZD0iTTE0IDF2OWgtMVYySDVWMWg5ek0zIDN2MWg4djhoMVYzSDN6bTcgMnY5SDFWNWg5ek04IDdIM3Y1aDVWN3oiLz48cGF0aCBmaWxsPSIjMDA1MzlDIiBkPSJNNCA5aDN2MUg0eiIvPjwvc3ZnPg==\\\") 50% no-repeat}.hc-black .monaco-tree-action.collapse-all,.vs-dark .monaco-tree-action.collapse-all{background:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iLTEgMCAxNiAxNiI+PHBhdGggZmlsbD0iI0M1QzVDNSIgZD0iTTE0IDF2OWgtMVYySDVWMWg5ek0zIDN2MWg4djhoMVYzSDN6bTcgMnY5SDFWNWg5ek04IDdIM3Y1aDVWN3oiLz48cGF0aCBmaWxsPSIjNzVCRUZGIiBkPSJNNCA5aDN2MUg0eiIvPjwvc3ZnPg==\\\") 50% no-repeat}\", \"\"]);\n\n// exports\n","// 7.3.20 SpeciesConstructor(O, defaultConstructor)\nvar anObject = require('./_an-object');\nvar aFunction = require('./_a-function');\nvar SPECIES = require('./_wks')('species');\nmodule.exports = function (O, D) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);\n};\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./rulers.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"0f76ceb3\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .scroll-decoration{position:absolute;top:0;left:0;height:6px}\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../css-loader/index.js??ref--6-oneOf-3-1!../../../../../../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./minimap.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"0e1d474e\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","module.exports = function (it, Constructor, name, forbiddenField) {\n  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {\n    throw TypeError(name + ': incorrect invocation!');\n  } return it;\n};\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-editor .vs-whitespace{display:inline-block}\", \"\"]);\n\n// exports\n","// 19.1.3.1 Object.assign(target, source)\nvar $export = require('./_export');\n\n$export($export.S + $export.F, 'Object', { assign: require('./_object-assign') });\n","exports = module.exports = require(\"../../../../../../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".monaco-menu .monaco-action-bar.vertical{margin-left:0;overflow:visible}.monaco-menu .monaco-action-bar.vertical .actions-container{display:block}.monaco-menu .monaco-action-bar.vertical .action-item{padding:0;transform:none;display:-ms-flexbox;display:flex}.monaco-menu .monaco-action-bar.vertical .action-item.active{transform:none}.monaco-menu .monaco-action-bar.vertical .action-menu-item{-ms-flex:1 1 auto;flex:1 1 auto;display:-ms-flexbox;display:flex;height:2em;align-items:center}.monaco-menu .monaco-action-bar.vertical .action-label{-ms-flex:1 1 auto;flex:1 1 auto;text-decoration:none;padding:0 1em;background:none;font-size:12px;line-height:1}.monaco-menu .monaco-action-bar.vertical .keybinding,.monaco-menu .monaco-action-bar.vertical .submenu-indicator{display:inline-block;-ms-flex:2 1 auto;flex:2 1 auto;padding:0 1em;text-align:right;font-size:12px;line-height:1}.monaco-menu .monaco-action-bar.vertical .submenu-indicator{height:100%;-webkit-mask:url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTQuNTIgMTIuMzY0TDkuODc5IDcgNC41MiAxLjYzNmwuNjE1LS42MTVMMTEuMTIyIDdsLTUuOTg2IDUuOTgtLjYxNS0uNjE2eiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==\\\") no-repeat 90% 50%/13px 13px;mask:url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTQuNTIgMTIuMzY0TDkuODc5IDcgNC41MiAxLjYzNmwuNjE1LS42MTVMMTEuMTIyIDdsLTUuOTg2IDUuOTgtLjYxNS0uNjE2eiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==\\\") no-repeat 90% 50%/13px 13px}.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator{opacity:.4}.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator){display:inline-block;-webkit-box-sizing:border-box;-o-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;box-sizing:border-box;margin:0}.monaco-menu .monaco-action-bar.vertical .action-label.separator{padding:.5em 0 0 0;margin-bottom:.5em;width:100%}.monaco-menu .monaco-action-bar.vertical .action-label.separator.text{padding:.7em 1em .1em 1em;font-weight:700;opacity:1}.monaco-menu .monaco-action-bar.vertical .action-label:hover{color:inherit}.monaco-menu .monaco-action-bar.vertical .menu-item-check{position:absolute;visibility:hidden;-webkit-mask:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iLTIgLTIgMTYgMTYiPjxwYXRoIGZpbGw9IiM0MjQyNDIiIGQ9Ik05IDBMNC41IDkgMyA2SDBsMyA2aDNsNi0xMnoiLz48L3N2Zz4=\\\") no-repeat 50% 56%/15px 15px;mask:url(\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iLTIgLTIgMTYgMTYiPjxwYXRoIGZpbGw9IiM0MjQyNDIiIGQ9Ik05IDBMNC41IDkgMyA2SDBsMyA2aDNsNi0xMnoiLz48L3N2Zz4=\\\") no-repeat 50% 56%/15px 15px;width:1em;height:100%}.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check{visibility:visible}.context-view.monaco-menu-container{font-family:-apple-system,BlinkMacSystemFont,Segoe WPC,Segoe UI,HelveticaNeue-Light,Ubuntu,Droid Sans,sans-serif;outline:0;border:none;-webkit-animation:fadeIn 83ms linear;-o-animation:fadeIn 83ms linear;-moz-animation:fadeIn 83ms linear;-ms-animation:fadeIn 83ms linear;animation:fadeIn 83ms linear}.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,.context-view.monaco-menu-container .monaco-action-bar.vertical :focus,.context-view.monaco-menu-container :focus{outline:0}.monaco-menu .monaco-action-bar.vertical .action-item{border:1px solid transparent}.hc-black .context-view.monaco-menu-container{box-shadow:none}.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused{background:none}\", \"\"]);\n\n// exports\n","var document = require('./_global').document;\nmodule.exports = document && document.documentElement;\n","// This file is imported into lib/wc client bundles.\n\nif (typeof window !== 'undefined') {\n  var i\n  if ((i = window.document.currentScript) && (i = i.src.match(/(.+\\/)[^/]+\\.js(\\?.*)?$/))) {\n    __webpack_public_path__ = i[1] // eslint-disable-line\n  }\n}\n\n// Indicate to webpack that this file can be concatenated\nexport default null\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"./defineProperty\";\nexport default function _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { TPromise } from './winjs.base.js';\r\n// ------ BEGIN Hook up error listeners to winjs promises\r\nvar outstandingPromiseErrors = {};\r\nfunction promiseErrorHandler(e) {\r\n    //\r\n    // e.detail looks like: { exception, error, promise, handler, id, parent }\r\n    //\r\n    var details = e.detail;\r\n    var id = details.id;\r\n    // If the error has a parent promise then this is not the origination of the\r\n    //  error so we check if it has a handler, and if so we mark that the error\r\n    //  was handled by removing it from outstandingPromiseErrors\r\n    //\r\n    if (details.parent) {\r\n        if (details.handler && outstandingPromiseErrors) {\r\n            delete outstandingPromiseErrors[id];\r\n        }\r\n        return;\r\n    }\r\n    // Indicate that this error was originated and needs to be handled\r\n    outstandingPromiseErrors[id] = details;\r\n    // The first time the queue fills up this iteration, schedule a timeout to\r\n    // check if any errors are still unhandled.\r\n    if (Object.keys(outstandingPromiseErrors).length === 1) {\r\n        setTimeout(function () {\r\n            var errors = outstandingPromiseErrors;\r\n            outstandingPromiseErrors = {};\r\n            Object.keys(errors).forEach(function (errorId) {\r\n                var error = errors[errorId];\r\n                if (error.exception) {\r\n                    onUnexpectedError(error.exception);\r\n                }\r\n                else if (error.error) {\r\n                    onUnexpectedError(error.error);\r\n                }\r\n                console.log('WARNING: Promise with no error callback:' + error.id);\r\n                console.log(error);\r\n                if (error.exception) {\r\n                    console.log(error.exception.stack);\r\n                }\r\n            });\r\n        }, 0);\r\n    }\r\n}\r\nTPromise.addEventListener('error', promiseErrorHandler);\r\n// Avoid circular dependency on EventEmitter by implementing a subset of the interface.\r\nvar ErrorHandler = /** @class */ (function () {\r\n    function ErrorHandler() {\r\n        this.listeners = [];\r\n        this.unexpectedErrorHandler = function (e) {\r\n            setTimeout(function () {\r\n                if (e.stack) {\r\n                    throw new Error(e.message + '\\n\\n' + e.stack);\r\n                }\r\n                throw e;\r\n            }, 0);\r\n        };\r\n    }\r\n    ErrorHandler.prototype.emit = function (e) {\r\n        this.listeners.forEach(function (listener) {\r\n            listener(e);\r\n        });\r\n    };\r\n    ErrorHandler.prototype.onUnexpectedError = function (e) {\r\n        this.unexpectedErrorHandler(e);\r\n        this.emit(e);\r\n    };\r\n    // For external errors, we don't want the listeners to be called\r\n    ErrorHandler.prototype.onUnexpectedExternalError = function (e) {\r\n        this.unexpectedErrorHandler(e);\r\n    };\r\n    return ErrorHandler;\r\n}());\r\nexport { ErrorHandler };\r\nexport var errorHandler = new ErrorHandler();\r\nexport function onUnexpectedError(e) {\r\n    // ignore errors from cancelled promises\r\n    if (!isPromiseCanceledError(e)) {\r\n        errorHandler.onUnexpectedError(e);\r\n    }\r\n    return undefined;\r\n}\r\nexport function onUnexpectedExternalError(e) {\r\n    // ignore errors from cancelled promises\r\n    if (!isPromiseCanceledError(e)) {\r\n        errorHandler.onUnexpectedExternalError(e);\r\n    }\r\n    return undefined;\r\n}\r\nexport function transformErrorForSerialization(error) {\r\n    if (error instanceof Error) {\r\n        var name_1 = error.name, message = error.message;\r\n        var stack = error.stacktrace || error.stack;\r\n        return {\r\n            $isError: true,\r\n            name: name_1,\r\n            message: message,\r\n            stack: stack\r\n        };\r\n    }\r\n    // return as is\r\n    return error;\r\n}\r\nvar canceledName = 'Canceled';\r\n/**\r\n * Checks if the given error is a promise in canceled state\r\n */\r\nexport function isPromiseCanceledError(error) {\r\n    return error instanceof Error && error.name === canceledName && error.message === canceledName;\r\n}\r\n/**\r\n * Returns an error that signals cancellation.\r\n */\r\nexport function canceled() {\r\n    var error = new Error(canceledName);\r\n    error.name = error.message;\r\n    return error;\r\n}\r\nexport function illegalArgument(name) {\r\n    if (name) {\r\n        return new Error(\"Illegal argument: \" + name);\r\n    }\r\n    else {\r\n        return new Error('Illegal argument');\r\n    }\r\n}\r\nexport function illegalState(name) {\r\n    if (name) {\r\n        return new Error(\"Illegal state: \" + name);\r\n    }\r\n    else {\r\n        return new Error('Illegal state');\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport function once(fn) {\r\n    var _this = this;\r\n    var didCall = false;\r\n    var result;\r\n    return function () {\r\n        if (didCall) {\r\n            return result;\r\n        }\r\n        didCall = true;\r\n        result = fn.apply(_this, arguments);\r\n        return result;\r\n    };\r\n}\r\n","export function isDisposable(thing) {\r\n    return typeof thing.dispose === 'function'\r\n        && thing.dispose.length === 0;\r\n}\r\nexport function dispose(first) {\r\n    var rest = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        rest[_i - 1] = arguments[_i];\r\n    }\r\n    if (Array.isArray(first)) {\r\n        first.forEach(function (d) { return d && d.dispose(); });\r\n        return [];\r\n    }\r\n    else if (rest.length === 0) {\r\n        if (first) {\r\n            first.dispose();\r\n            return first;\r\n        }\r\n        return undefined;\r\n    }\r\n    else {\r\n        dispose(first);\r\n        dispose(rest);\r\n        return [];\r\n    }\r\n}\r\nexport function combinedDisposable(disposables) {\r\n    return { dispose: function () { return dispose(disposables); } };\r\n}\r\nexport function toDisposable(fn) {\r\n    return { dispose: function () { fn(); } };\r\n}\r\nvar Disposable = /** @class */ (function () {\r\n    function Disposable() {\r\n        this._toDispose = [];\r\n    }\r\n    Disposable.prototype.dispose = function () {\r\n        this._toDispose = dispose(this._toDispose);\r\n    };\r\n    Disposable.prototype._register = function (t) {\r\n        this._toDispose.push(t);\r\n        return t;\r\n    };\r\n    Disposable.None = Object.freeze({ dispose: function () { } });\r\n    return Disposable;\r\n}());\r\nexport { Disposable };\r\nvar ImmortalReference = /** @class */ (function () {\r\n    function ImmortalReference(object) {\r\n        this.object = object;\r\n    }\r\n    ImmortalReference.prototype.dispose = function () { };\r\n    return ImmortalReference;\r\n}());\r\nexport { ImmortalReference };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nexport var FIN = { done: true, value: undefined };\r\nexport var Iterator;\r\n(function (Iterator) {\r\n    var _empty = {\r\n        next: function () {\r\n            return FIN;\r\n        }\r\n    };\r\n    function empty() {\r\n        return _empty;\r\n    }\r\n    Iterator.empty = empty;\r\n    function fromArray(array, index, length) {\r\n        if (index === void 0) { index = 0; }\r\n        if (length === void 0) { length = array.length; }\r\n        return {\r\n            next: function () {\r\n                if (index >= length) {\r\n                    return FIN;\r\n                }\r\n                return { done: false, value: array[index++] };\r\n            }\r\n        };\r\n    }\r\n    Iterator.fromArray = fromArray;\r\n    function from(elements) {\r\n        if (!elements) {\r\n            return Iterator.empty();\r\n        }\r\n        else if (Array.isArray(elements)) {\r\n            return Iterator.fromArray(elements);\r\n        }\r\n        else {\r\n            return elements;\r\n        }\r\n    }\r\n    Iterator.from = from;\r\n    function map(iterator, fn) {\r\n        return {\r\n            next: function () {\r\n                var element = iterator.next();\r\n                if (element.done) {\r\n                    return FIN;\r\n                }\r\n                else {\r\n                    return { done: false, value: fn(element.value) };\r\n                }\r\n            }\r\n        };\r\n    }\r\n    Iterator.map = map;\r\n    function filter(iterator, fn) {\r\n        return {\r\n            next: function () {\r\n                while (true) {\r\n                    var element = iterator.next();\r\n                    if (element.done) {\r\n                        return FIN;\r\n                    }\r\n                    if (fn(element.value)) {\r\n                        return { done: false, value: element.value };\r\n                    }\r\n                }\r\n            }\r\n        };\r\n    }\r\n    Iterator.filter = filter;\r\n    function forEach(iterator, fn) {\r\n        for (var next = iterator.next(); !next.done; next = iterator.next()) {\r\n            fn(next.value);\r\n        }\r\n    }\r\n    Iterator.forEach = forEach;\r\n    function collect(iterator) {\r\n        var result = [];\r\n        forEach(iterator, function (value) { return result.push(value); });\r\n        return result;\r\n    }\r\n    Iterator.collect = collect;\r\n})(Iterator || (Iterator = {}));\r\nvar ArrayIterator = /** @class */ (function () {\r\n    function ArrayIterator(items, start, end, index) {\r\n        if (start === void 0) { start = 0; }\r\n        if (end === void 0) { end = items.length; }\r\n        if (index === void 0) { index = start - 1; }\r\n        this.items = items;\r\n        this.start = start;\r\n        this.end = end;\r\n        this.index = index;\r\n    }\r\n    ArrayIterator.prototype.next = function () {\r\n        this.index = Math.min(this.index + 1, this.end);\r\n        return this.current();\r\n    };\r\n    ArrayIterator.prototype.current = function () {\r\n        if (this.index === this.start - 1 || this.index === this.end) {\r\n            return null;\r\n        }\r\n        return this.items[this.index];\r\n    };\r\n    return ArrayIterator;\r\n}());\r\nexport { ArrayIterator };\r\nvar ArrayNavigator = /** @class */ (function (_super) {\r\n    __extends(ArrayNavigator, _super);\r\n    function ArrayNavigator(items, start, end, index) {\r\n        if (start === void 0) { start = 0; }\r\n        if (end === void 0) { end = items.length; }\r\n        if (index === void 0) { index = start - 1; }\r\n        return _super.call(this, items, start, end, index) || this;\r\n    }\r\n    ArrayNavigator.prototype.current = function () {\r\n        return _super.prototype.current.call(this);\r\n    };\r\n    ArrayNavigator.prototype.previous = function () {\r\n        this.index = Math.max(this.index - 1, this.start - 1);\r\n        return this.current();\r\n    };\r\n    ArrayNavigator.prototype.first = function () {\r\n        this.index = this.start;\r\n        return this.current();\r\n    };\r\n    ArrayNavigator.prototype.last = function () {\r\n        this.index = this.end - 1;\r\n        return this.current();\r\n    };\r\n    ArrayNavigator.prototype.parent = function () {\r\n        return null;\r\n    };\r\n    return ArrayNavigator;\r\n}(ArrayIterator));\r\nexport { ArrayNavigator };\r\nvar MappedIterator = /** @class */ (function () {\r\n    function MappedIterator(iterator, fn) {\r\n        this.iterator = iterator;\r\n        this.fn = fn;\r\n        // noop\r\n    }\r\n    MappedIterator.prototype.next = function () { return this.fn(this.iterator.next()); };\r\n    return MappedIterator;\r\n}());\r\nexport { MappedIterator };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { FIN } from './iterator.js';\r\nvar Node = /** @class */ (function () {\r\n    function Node(element) {\r\n        this.element = element;\r\n    }\r\n    return Node;\r\n}());\r\nvar LinkedList = /** @class */ (function () {\r\n    function LinkedList() {\r\n    }\r\n    LinkedList.prototype.isEmpty = function () {\r\n        return !this._first;\r\n    };\r\n    LinkedList.prototype.unshift = function (element) {\r\n        return this.insert(element, false);\r\n    };\r\n    LinkedList.prototype.push = function (element) {\r\n        return this.insert(element, true);\r\n    };\r\n    LinkedList.prototype.insert = function (element, atTheEnd) {\r\n        var _this = this;\r\n        var newNode = new Node(element);\r\n        if (!this._first) {\r\n            this._first = newNode;\r\n            this._last = newNode;\r\n        }\r\n        else if (atTheEnd) {\r\n            // push\r\n            var oldLast = this._last;\r\n            this._last = newNode;\r\n            newNode.prev = oldLast;\r\n            oldLast.next = newNode;\r\n        }\r\n        else {\r\n            // unshift\r\n            var oldFirst = this._first;\r\n            this._first = newNode;\r\n            newNode.next = oldFirst;\r\n            oldFirst.prev = newNode;\r\n        }\r\n        return function () {\r\n            var candidate = _this._first;\r\n            while (candidate instanceof Node) {\r\n                if (candidate !== newNode) {\r\n                    candidate = candidate.next;\r\n                    continue;\r\n                }\r\n                if (candidate.prev && candidate.next) {\r\n                    // middle\r\n                    var anchor = candidate.prev;\r\n                    anchor.next = candidate.next;\r\n                    candidate.next.prev = anchor;\r\n                }\r\n                else if (!candidate.prev && !candidate.next) {\r\n                    // only node\r\n                    _this._first = undefined;\r\n                    _this._last = undefined;\r\n                }\r\n                else if (!candidate.next) {\r\n                    // last\r\n                    _this._last = _this._last.prev;\r\n                    _this._last.next = undefined;\r\n                }\r\n                else if (!candidate.prev) {\r\n                    // first\r\n                    _this._first = _this._first.next;\r\n                    _this._first.prev = undefined;\r\n                }\r\n                // done\r\n                break;\r\n            }\r\n        };\r\n    };\r\n    LinkedList.prototype.iterator = function () {\r\n        var element;\r\n        var node = this._first;\r\n        return {\r\n            next: function () {\r\n                if (!node) {\r\n                    return FIN;\r\n                }\r\n                if (!element) {\r\n                    element = { done: false, value: node.element };\r\n                }\r\n                else {\r\n                    element.value = node.element;\r\n                }\r\n                node = node.next;\r\n                return element;\r\n            }\r\n        };\r\n    };\r\n    return LinkedList;\r\n}());\r\nexport { LinkedList };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { onUnexpectedError } from './errors.js';\r\nimport { once as onceFn } from './functional.js';\r\nimport { combinedDisposable, Disposable, toDisposable } from './lifecycle.js';\r\nimport { LinkedList } from './linkedList.js';\r\nexport var Event;\r\n(function (Event) {\r\n    var _disposable = { dispose: function () { } };\r\n    Event.None = function () { return _disposable; };\r\n})(Event || (Event = {}));\r\n/**\r\n * The Emitter can be used to expose an Event to the public\r\n * to fire it from the insides.\r\n * Sample:\r\n    class Document {\r\n\r\n        private _onDidChange = new Emitter<(value:string)=>any>();\r\n\r\n        public onDidChange = this._onDidChange.event;\r\n\r\n        // getter-style\r\n        // get onDidChange(): Event<(value:string)=>any> {\r\n        // \treturn this._onDidChange.event;\r\n        // }\r\n\r\n        private _doIt() {\r\n            //...\r\n            this._onDidChange.fire(value);\r\n        }\r\n    }\r\n */\r\nvar Emitter = /** @class */ (function () {\r\n    function Emitter(_options) {\r\n        if (_options === void 0) { _options = null; }\r\n        this._options = _options;\r\n        this._event = null;\r\n        this._disposed = false;\r\n        this._deliveryQueue = null;\r\n        this._listeners = null;\r\n    }\r\n    Object.defineProperty(Emitter.prototype, \"event\", {\r\n        /**\r\n         * For the public to allow to subscribe\r\n         * to events from this Emitter\r\n         */\r\n        get: function () {\r\n            var _this = this;\r\n            if (!this._event) {\r\n                this._event = function (listener, thisArgs, disposables) {\r\n                    if (!_this._listeners) {\r\n                        _this._listeners = new LinkedList();\r\n                    }\r\n                    var firstListener = _this._listeners.isEmpty();\r\n                    if (firstListener && _this._options && _this._options.onFirstListenerAdd) {\r\n                        _this._options.onFirstListenerAdd(_this);\r\n                    }\r\n                    var remove = _this._listeners.push(!thisArgs ? listener : [listener, thisArgs]);\r\n                    if (firstListener && _this._options && _this._options.onFirstListenerDidAdd) {\r\n                        _this._options.onFirstListenerDidAdd(_this);\r\n                    }\r\n                    if (_this._options && _this._options.onListenerDidAdd) {\r\n                        _this._options.onListenerDidAdd(_this, listener, thisArgs);\r\n                    }\r\n                    var result;\r\n                    result = {\r\n                        dispose: function () {\r\n                            result.dispose = Emitter._noop;\r\n                            if (!_this._disposed) {\r\n                                remove();\r\n                                if (_this._options && _this._options.onLastListenerRemove) {\r\n                                    var hasListeners = (_this._listeners && !_this._listeners.isEmpty());\r\n                                    if (!hasListeners) {\r\n                                        _this._options.onLastListenerRemove(_this);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    };\r\n                    if (Array.isArray(disposables)) {\r\n                        disposables.push(result);\r\n                    }\r\n                    return result;\r\n                };\r\n            }\r\n            return this._event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * To be kept private to fire an event to\r\n     * subscribers\r\n     */\r\n    Emitter.prototype.fire = function (event) {\r\n        if (this._listeners) {\r\n            // put all [listener,event]-pairs into delivery queue\r\n            // then emit all event. an inner/nested event might be\r\n            // the driver of this\r\n            if (!this._deliveryQueue) {\r\n                this._deliveryQueue = [];\r\n            }\r\n            for (var iter = this._listeners.iterator(), e = iter.next(); !e.done; e = iter.next()) {\r\n                this._deliveryQueue.push([e.value, event]);\r\n            }\r\n            while (this._deliveryQueue.length > 0) {\r\n                var _a = this._deliveryQueue.shift(), listener = _a[0], event_1 = _a[1];\r\n                try {\r\n                    if (typeof listener === 'function') {\r\n                        listener.call(undefined, event_1);\r\n                    }\r\n                    else {\r\n                        listener[0].call(listener[1], event_1);\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    onUnexpectedError(e);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Emitter.prototype.dispose = function () {\r\n        if (this._listeners) {\r\n            this._listeners = null;\r\n        }\r\n        if (this._deliveryQueue) {\r\n            this._deliveryQueue.length = 0;\r\n        }\r\n        this._disposed = true;\r\n    };\r\n    Emitter._noop = function () { };\r\n    return Emitter;\r\n}());\r\nexport { Emitter };\r\nvar EventMultiplexer = /** @class */ (function () {\r\n    function EventMultiplexer() {\r\n        var _this = this;\r\n        this.hasListeners = false;\r\n        this.events = [];\r\n        this.emitter = new Emitter({\r\n            onFirstListenerAdd: function () { return _this.onFirstListenerAdd(); },\r\n            onLastListenerRemove: function () { return _this.onLastListenerRemove(); }\r\n        });\r\n    }\r\n    Object.defineProperty(EventMultiplexer.prototype, \"event\", {\r\n        get: function () {\r\n            return this.emitter.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    EventMultiplexer.prototype.add = function (event) {\r\n        var _this = this;\r\n        var e = { event: event, listener: null };\r\n        this.events.push(e);\r\n        if (this.hasListeners) {\r\n            this.hook(e);\r\n        }\r\n        var dispose = function () {\r\n            if (_this.hasListeners) {\r\n                _this.unhook(e);\r\n            }\r\n            var idx = _this.events.indexOf(e);\r\n            _this.events.splice(idx, 1);\r\n        };\r\n        return toDisposable(onceFn(dispose));\r\n    };\r\n    EventMultiplexer.prototype.onFirstListenerAdd = function () {\r\n        var _this = this;\r\n        this.hasListeners = true;\r\n        this.events.forEach(function (e) { return _this.hook(e); });\r\n    };\r\n    EventMultiplexer.prototype.onLastListenerRemove = function () {\r\n        var _this = this;\r\n        this.hasListeners = false;\r\n        this.events.forEach(function (e) { return _this.unhook(e); });\r\n    };\r\n    EventMultiplexer.prototype.hook = function (e) {\r\n        var _this = this;\r\n        e.listener = e.event(function (r) { return _this.emitter.fire(r); });\r\n    };\r\n    EventMultiplexer.prototype.unhook = function (e) {\r\n        if (e.listener) {\r\n            e.listener.dispose();\r\n        }\r\n        e.listener = null;\r\n    };\r\n    EventMultiplexer.prototype.dispose = function () {\r\n        this.emitter.dispose();\r\n    };\r\n    return EventMultiplexer;\r\n}());\r\nexport { EventMultiplexer };\r\nexport function once(event) {\r\n    return function (listener, thisArgs, disposables) {\r\n        if (thisArgs === void 0) { thisArgs = null; }\r\n        // we need this, in case the event fires during the listener call\r\n        var didFire = false;\r\n        var result = event(function (e) {\r\n            if (didFire) {\r\n                return;\r\n            }\r\n            else if (result) {\r\n                result.dispose();\r\n            }\r\n            else {\r\n                didFire = true;\r\n            }\r\n            return listener.call(thisArgs, e);\r\n        }, null, disposables);\r\n        if (didFire) {\r\n            result.dispose();\r\n        }\r\n        return result;\r\n    };\r\n}\r\nexport function anyEvent() {\r\n    var events = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        events[_i] = arguments[_i];\r\n    }\r\n    return function (listener, thisArgs, disposables) {\r\n        if (thisArgs === void 0) { thisArgs = null; }\r\n        return combinedDisposable(events.map(function (event) { return event(function (e) { return listener.call(thisArgs, e); }, null, disposables); }));\r\n    };\r\n}\r\nexport function debounceEvent(event, merger, delay, leading) {\r\n    if (delay === void 0) { delay = 100; }\r\n    if (leading === void 0) { leading = false; }\r\n    var subscription;\r\n    var output = undefined;\r\n    var handle = undefined;\r\n    var numDebouncedCalls = 0;\r\n    var emitter = new Emitter({\r\n        onFirstListenerAdd: function () {\r\n            subscription = event(function (cur) {\r\n                numDebouncedCalls++;\r\n                output = merger(output, cur);\r\n                if (leading && !handle) {\r\n                    emitter.fire(output);\r\n                }\r\n                clearTimeout(handle);\r\n                handle = setTimeout(function () {\r\n                    var _output = output;\r\n                    output = undefined;\r\n                    handle = undefined;\r\n                    if (!leading || numDebouncedCalls > 1) {\r\n                        emitter.fire(_output);\r\n                    }\r\n                    numDebouncedCalls = 0;\r\n                }, delay);\r\n            });\r\n        },\r\n        onLastListenerRemove: function () {\r\n            subscription.dispose();\r\n        }\r\n    });\r\n    return emitter.event;\r\n}\r\n/**\r\n * The EventDelayer is useful in situations in which you want\r\n * to delay firing your events during some code.\r\n * You can wrap that code and be sure that the event will not\r\n * be fired during that wrap.\r\n *\r\n * ```\r\n * const emitter: Emitter;\r\n * const delayer = new EventDelayer();\r\n * const delayedEvent = delayer.wrapEvent(emitter.event);\r\n *\r\n * delayedEvent(console.log);\r\n *\r\n * delayer.bufferEvents(() => {\r\n *   emitter.fire(); // event will not be fired yet\r\n * });\r\n *\r\n * // event will only be fired at this point\r\n * ```\r\n */\r\nvar EventBufferer = /** @class */ (function () {\r\n    function EventBufferer() {\r\n        this.buffers = [];\r\n    }\r\n    EventBufferer.prototype.wrapEvent = function (event) {\r\n        var _this = this;\r\n        return function (listener, thisArgs, disposables) {\r\n            return event(function (i) {\r\n                var buffer = _this.buffers[_this.buffers.length - 1];\r\n                if (buffer) {\r\n                    buffer.push(function () { return listener.call(thisArgs, i); });\r\n                }\r\n                else {\r\n                    listener.call(thisArgs, i);\r\n                }\r\n            }, void 0, disposables);\r\n        };\r\n    };\r\n    EventBufferer.prototype.bufferEvents = function (fn) {\r\n        var buffer = [];\r\n        this.buffers.push(buffer);\r\n        var r = fn();\r\n        this.buffers.pop();\r\n        buffer.forEach(function (flush) { return flush(); });\r\n        return r;\r\n    };\r\n    return EventBufferer;\r\n}());\r\nexport { EventBufferer };\r\nexport function mapEvent(event, map) {\r\n    return function (listener, thisArgs, disposables) {\r\n        if (thisArgs === void 0) { thisArgs = null; }\r\n        return event(function (i) { return listener.call(thisArgs, map(i)); }, null, disposables);\r\n    };\r\n}\r\nexport function filterEvent(event, filter) {\r\n    return function (listener, thisArgs, disposables) {\r\n        if (thisArgs === void 0) { thisArgs = null; }\r\n        return event(function (e) { return filter(e) && listener.call(thisArgs, e); }, null, disposables);\r\n    };\r\n}\r\nvar ChainableEvent = /** @class */ (function () {\r\n    function ChainableEvent(_event) {\r\n        this._event = _event;\r\n    }\r\n    Object.defineProperty(ChainableEvent.prototype, \"event\", {\r\n        get: function () { return this._event; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ChainableEvent.prototype.map = function (fn) {\r\n        return new ChainableEvent(mapEvent(this._event, fn));\r\n    };\r\n    ChainableEvent.prototype.filter = function (fn) {\r\n        return new ChainableEvent(filterEvent(this._event, fn));\r\n    };\r\n    ChainableEvent.prototype.on = function (listener, thisArgs, disposables) {\r\n        return this._event(listener, thisArgs, disposables);\r\n    };\r\n    return ChainableEvent;\r\n}());\r\nexport function chain(event) {\r\n    return new ChainableEvent(event);\r\n}\r\nvar Relay = /** @class */ (function () {\r\n    function Relay() {\r\n        var _this = this;\r\n        this.listening = false;\r\n        this.inputEvent = Event.None;\r\n        this.inputEventListener = Disposable.None;\r\n        this.emitter = new Emitter({\r\n            onFirstListenerDidAdd: function () {\r\n                _this.listening = true;\r\n                _this.inputEventListener = _this.inputEvent(_this.emitter.fire, _this.emitter);\r\n            },\r\n            onLastListenerRemove: function () {\r\n                _this.listening = false;\r\n                _this.inputEventListener.dispose();\r\n            }\r\n        });\r\n        this.event = this.emitter.event;\r\n    }\r\n    Object.defineProperty(Relay.prototype, \"input\", {\r\n        set: function (event) {\r\n            this.inputEvent = event;\r\n            if (this.listening) {\r\n                this.inputEventListener.dispose();\r\n                this.inputEventListener = event(this.emitter.fire, this.emitter);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Relay.prototype.dispose = function () {\r\n        this.inputEventListener.dispose();\r\n        this.emitter.dispose();\r\n    };\r\n    return Relay;\r\n}());\r\nexport { Relay };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter, Event } from './event.js';\r\nvar shortcutEvent = Object.freeze(function (callback, context) {\r\n    var handle = setTimeout(callback.bind(context), 0);\r\n    return { dispose: function () { clearTimeout(handle); } };\r\n});\r\nexport var CancellationToken;\r\n(function (CancellationToken) {\r\n    function isCancellationToken(thing) {\r\n        if (thing === CancellationToken.None || thing === CancellationToken.Cancelled) {\r\n            return true;\r\n        }\r\n        if (thing instanceof MutableToken) {\r\n            return true;\r\n        }\r\n        if (!thing || typeof thing !== 'object') {\r\n            return false;\r\n        }\r\n        return typeof thing.isCancellationRequested === 'boolean'\r\n            && typeof thing.onCancellationRequested === 'function';\r\n    }\r\n    CancellationToken.isCancellationToken = isCancellationToken;\r\n    CancellationToken.None = Object.freeze({\r\n        isCancellationRequested: false,\r\n        onCancellationRequested: Event.None\r\n    });\r\n    CancellationToken.Cancelled = Object.freeze({\r\n        isCancellationRequested: true,\r\n        onCancellationRequested: shortcutEvent\r\n    });\r\n})(CancellationToken || (CancellationToken = {}));\r\nvar MutableToken = /** @class */ (function () {\r\n    function MutableToken() {\r\n        this._isCancelled = false;\r\n        this._emitter = null;\r\n    }\r\n    MutableToken.prototype.cancel = function () {\r\n        if (!this._isCancelled) {\r\n            this._isCancelled = true;\r\n            if (this._emitter) {\r\n                this._emitter.fire(undefined);\r\n                this.dispose();\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(MutableToken.prototype, \"isCancellationRequested\", {\r\n        get: function () {\r\n            return this._isCancelled;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MutableToken.prototype, \"onCancellationRequested\", {\r\n        get: function () {\r\n            if (this._isCancelled) {\r\n                return shortcutEvent;\r\n            }\r\n            if (!this._emitter) {\r\n                this._emitter = new Emitter();\r\n            }\r\n            return this._emitter.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MutableToken.prototype.dispose = function () {\r\n        if (this._emitter) {\r\n            this._emitter.dispose();\r\n            this._emitter = null;\r\n        }\r\n    };\r\n    return MutableToken;\r\n}());\r\nvar CancellationTokenSource = /** @class */ (function () {\r\n    function CancellationTokenSource() {\r\n    }\r\n    Object.defineProperty(CancellationTokenSource.prototype, \"token\", {\r\n        get: function () {\r\n            if (!this._token) {\r\n                // be lazy and create the token only when\r\n                // actually needed\r\n                this._token = new MutableToken();\r\n            }\r\n            return this._token;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CancellationTokenSource.prototype.cancel = function () {\r\n        if (!this._token) {\r\n            // save an object by returning the default\r\n            // cancelled token when cancellation happens\r\n            // before someone asks for the token\r\n            this._token = CancellationToken.Cancelled;\r\n        }\r\n        else if (this._token instanceof MutableToken) {\r\n            // actually cancel\r\n            this._token.cancel();\r\n        }\r\n    };\r\n    CancellationTokenSource.prototype.dispose = function () {\r\n        if (!this._token) {\r\n            // ensure to initialize with an empty token if we had none\r\n            this._token = CancellationToken.None;\r\n        }\r\n        else if (this._token instanceof MutableToken) {\r\n            // actually dispose\r\n            this._token.dispose();\r\n        }\r\n    };\r\n    return CancellationTokenSource;\r\n}());\r\nexport { CancellationTokenSource };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { CancellationTokenSource } from './cancellation.js';\r\nimport * as errors from './errors.js';\r\nimport { Disposable } from './lifecycle.js';\r\nimport { TPromise } from './winjs.base.js';\r\nexport function isThenable(obj) {\r\n    return obj && typeof obj.then === 'function';\r\n}\r\nexport function createCancelablePromise(callback) {\r\n    var source = new CancellationTokenSource();\r\n    var thenable = callback(source.token);\r\n    var promise = new Promise(function (resolve, reject) {\r\n        source.token.onCancellationRequested(function () {\r\n            reject(errors.canceled());\r\n        });\r\n        Promise.resolve(thenable).then(function (value) {\r\n            source.dispose();\r\n            resolve(value);\r\n        }, function (err) {\r\n            source.dispose();\r\n            reject(err);\r\n        });\r\n    });\r\n    return new /** @class */ (function () {\r\n        function class_1() {\r\n        }\r\n        class_1.prototype.cancel = function () {\r\n            source.cancel();\r\n        };\r\n        class_1.prototype.then = function (resolve, reject) {\r\n            return promise.then(resolve, reject);\r\n        };\r\n        class_1.prototype.catch = function (reject) {\r\n            return this.then(undefined, reject);\r\n        };\r\n        return class_1;\r\n    }());\r\n}\r\n/**\r\n * A helper to delay execution of a task that is being requested often.\r\n *\r\n * Following the throttler, now imagine the mail man wants to optimize the number of\r\n * trips proactively. The trip itself can be long, so he decides not to make the trip\r\n * as soon as a letter is submitted. Instead he waits a while, in case more\r\n * letters are submitted. After said waiting period, if no letters were submitted, he\r\n * decides to make the trip. Imagine that N more letters were submitted after the first\r\n * one, all within a short period of time between each other. Even though N+1\r\n * submissions occurred, only 1 delivery was made.\r\n *\r\n * The delayer offers this behavior via the trigger() method, into which both the task\r\n * to be executed and the waiting period (delay) must be passed in as arguments. Following\r\n * the example:\r\n *\r\n * \t\tconst delayer = new Delayer(WAITING_PERIOD);\r\n * \t\tconst letters = [];\r\n *\r\n * \t\tfunction letterReceived(l) {\r\n * \t\t\tletters.push(l);\r\n * \t\t\tdelayer.trigger(() => { return makeTheTrip(); });\r\n * \t\t}\r\n */\r\nvar Delayer = /** @class */ (function () {\r\n    function Delayer(defaultDelay) {\r\n        this.defaultDelay = defaultDelay;\r\n        this.timeout = null;\r\n        this.completionPromise = null;\r\n        this.doResolve = null;\r\n        this.task = null;\r\n    }\r\n    Delayer.prototype.trigger = function (task, delay) {\r\n        var _this = this;\r\n        if (delay === void 0) { delay = this.defaultDelay; }\r\n        this.task = task;\r\n        this.cancelTimeout();\r\n        if (!this.completionPromise) {\r\n            this.completionPromise = new TPromise(function (c, e) {\r\n                _this.doResolve = c;\r\n                _this.doReject = e;\r\n            }).then(function () {\r\n                _this.completionPromise = null;\r\n                _this.doResolve = null;\r\n                var task = _this.task;\r\n                _this.task = null;\r\n                return task();\r\n            });\r\n        }\r\n        this.timeout = setTimeout(function () {\r\n            _this.timeout = null;\r\n            _this.doResolve(null);\r\n        }, delay);\r\n        return this.completionPromise;\r\n    };\r\n    Delayer.prototype.cancel = function () {\r\n        this.cancelTimeout();\r\n        if (this.completionPromise) {\r\n            this.doReject(errors.canceled());\r\n            this.completionPromise = null;\r\n        }\r\n    };\r\n    Delayer.prototype.cancelTimeout = function () {\r\n        if (this.timeout !== null) {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = null;\r\n        }\r\n    };\r\n    Delayer.prototype.dispose = function () {\r\n        this.cancelTimeout();\r\n    };\r\n    return Delayer;\r\n}());\r\nexport { Delayer };\r\nexport function timeout(millis, token) {\r\n    if (!token) {\r\n        return createCancelablePromise(function (token) { return timeout(millis, token); });\r\n    }\r\n    return new Promise(function (resolve, reject) {\r\n        var handle = setTimeout(resolve, millis);\r\n        token.onCancellationRequested(function () {\r\n            clearTimeout(handle);\r\n            reject(errors.canceled());\r\n        });\r\n    });\r\n}\r\n/**\r\n * Returns a new promise that joins the provided promise. Upon completion of\r\n * the provided promise the provided function will always be called. This\r\n * method is comparable to a try-finally code block.\r\n * @param promise a promise\r\n * @param callback a function that will be call in the success and error case.\r\n */\r\nexport function always(promise, callback) {\r\n    function safeCallback() {\r\n        try {\r\n            callback();\r\n        }\r\n        catch (err) {\r\n            errors.onUnexpectedError(err);\r\n        }\r\n    }\r\n    promise.then(function (_) { return safeCallback(); }, function (_) { return safeCallback(); });\r\n    return Promise.resolve(promise);\r\n}\r\nexport function first(promiseFactories, shouldStop, defaultValue) {\r\n    if (shouldStop === void 0) { shouldStop = function (t) { return !!t; }; }\r\n    if (defaultValue === void 0) { defaultValue = null; }\r\n    var index = 0;\r\n    var len = promiseFactories.length;\r\n    var loop = function () {\r\n        if (index >= len) {\r\n            return Promise.resolve(defaultValue);\r\n        }\r\n        var factory = promiseFactories[index++];\r\n        var promise = Promise.resolve(factory());\r\n        return promise.then(function (result) {\r\n            if (shouldStop(result)) {\r\n                return Promise.resolve(result);\r\n            }\r\n            return loop();\r\n        });\r\n    };\r\n    return loop();\r\n}\r\nvar TimeoutTimer = /** @class */ (function (_super) {\r\n    __extends(TimeoutTimer, _super);\r\n    function TimeoutTimer(runner, timeout) {\r\n        var _this = _super.call(this) || this;\r\n        _this._token = -1;\r\n        if (typeof runner === 'function' && typeof timeout === 'number') {\r\n            _this.setIfNotSet(runner, timeout);\r\n        }\r\n        return _this;\r\n    }\r\n    TimeoutTimer.prototype.dispose = function () {\r\n        this.cancel();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    TimeoutTimer.prototype.cancel = function () {\r\n        if (this._token !== -1) {\r\n            clearTimeout(this._token);\r\n            this._token = -1;\r\n        }\r\n    };\r\n    TimeoutTimer.prototype.cancelAndSet = function (runner, timeout) {\r\n        var _this = this;\r\n        this.cancel();\r\n        this._token = setTimeout(function () {\r\n            _this._token = -1;\r\n            runner();\r\n        }, timeout);\r\n    };\r\n    TimeoutTimer.prototype.setIfNotSet = function (runner, timeout) {\r\n        var _this = this;\r\n        if (this._token !== -1) {\r\n            // timer is already set\r\n            return;\r\n        }\r\n        this._token = setTimeout(function () {\r\n            _this._token = -1;\r\n            runner();\r\n        }, timeout);\r\n    };\r\n    return TimeoutTimer;\r\n}(Disposable));\r\nexport { TimeoutTimer };\r\nvar IntervalTimer = /** @class */ (function (_super) {\r\n    __extends(IntervalTimer, _super);\r\n    function IntervalTimer() {\r\n        var _this = _super.call(this) || this;\r\n        _this._token = -1;\r\n        return _this;\r\n    }\r\n    IntervalTimer.prototype.dispose = function () {\r\n        this.cancel();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    IntervalTimer.prototype.cancel = function () {\r\n        if (this._token !== -1) {\r\n            clearInterval(this._token);\r\n            this._token = -1;\r\n        }\r\n    };\r\n    IntervalTimer.prototype.cancelAndSet = function (runner, interval) {\r\n        this.cancel();\r\n        this._token = setInterval(function () {\r\n            runner();\r\n        }, interval);\r\n    };\r\n    return IntervalTimer;\r\n}(Disposable));\r\nexport { IntervalTimer };\r\nvar RunOnceScheduler = /** @class */ (function () {\r\n    function RunOnceScheduler(runner, timeout) {\r\n        this.timeoutToken = -1;\r\n        this.runner = runner;\r\n        this.timeout = timeout;\r\n        this.timeoutHandler = this.onTimeout.bind(this);\r\n    }\r\n    /**\r\n     * Dispose RunOnceScheduler\r\n     */\r\n    RunOnceScheduler.prototype.dispose = function () {\r\n        this.cancel();\r\n        this.runner = null;\r\n    };\r\n    /**\r\n     * Cancel current scheduled runner (if any).\r\n     */\r\n    RunOnceScheduler.prototype.cancel = function () {\r\n        if (this.isScheduled()) {\r\n            clearTimeout(this.timeoutToken);\r\n            this.timeoutToken = -1;\r\n        }\r\n    };\r\n    /**\r\n     * Cancel previous runner (if any) & schedule a new runner.\r\n     */\r\n    RunOnceScheduler.prototype.schedule = function (delay) {\r\n        if (delay === void 0) { delay = this.timeout; }\r\n        this.cancel();\r\n        this.timeoutToken = setTimeout(this.timeoutHandler, delay);\r\n    };\r\n    /**\r\n     * Returns true if scheduled.\r\n     */\r\n    RunOnceScheduler.prototype.isScheduled = function () {\r\n        return this.timeoutToken !== -1;\r\n    };\r\n    RunOnceScheduler.prototype.onTimeout = function () {\r\n        this.timeoutToken = -1;\r\n        if (this.runner) {\r\n            this.doRun();\r\n        }\r\n    };\r\n    RunOnceScheduler.prototype.doRun = function () {\r\n        if (this.runner) {\r\n            this.runner();\r\n        }\r\n    };\r\n    return RunOnceScheduler;\r\n}());\r\nexport { RunOnceScheduler };\r\n/**\r\n * Execute the callback the next time the browser is idle\r\n */\r\nexport var runWhenIdle;\r\n(function () {\r\n    if (typeof requestIdleCallback !== 'function' || typeof cancelIdleCallback !== 'function') {\r\n        var dummyIdle_1 = Object.freeze({\r\n            didTimeout: true,\r\n            timeRemaining: function () { return 15; }\r\n        });\r\n        runWhenIdle = function (runner, timeout) {\r\n            if (timeout === void 0) { timeout = 0; }\r\n            var handle = setTimeout(function () { return runner(dummyIdle_1); }, timeout);\r\n            var disposed = false;\r\n            return {\r\n                dispose: function () {\r\n                    if (disposed) {\r\n                        return;\r\n                    }\r\n                    disposed = true;\r\n                    clearTimeout(handle);\r\n                }\r\n            };\r\n        };\r\n    }\r\n    else {\r\n        runWhenIdle = function (runner, timeout) {\r\n            var handle = requestIdleCallback(runner, typeof timeout === 'number' ? { timeout: timeout } : undefined);\r\n            var disposed = false;\r\n            return {\r\n                dispose: function () {\r\n                    if (disposed) {\r\n                        return;\r\n                    }\r\n                    disposed = true;\r\n                    cancelIdleCallback(handle);\r\n                }\r\n            };\r\n        };\r\n    }\r\n})();\r\n/**\r\n * An implementation of the \"idle-until-urgent\"-strategy as introduced\r\n * here: https://philipwalton.com/articles/idle-until-urgent/\r\n */\r\nvar IdleValue = /** @class */ (function () {\r\n    function IdleValue(executor) {\r\n        var _this = this;\r\n        this._executor = function () {\r\n            try {\r\n                _this._value = executor();\r\n            }\r\n            catch (err) {\r\n                _this._error = err;\r\n            }\r\n            finally {\r\n                _this._didRun = true;\r\n            }\r\n        };\r\n        this._handle = runWhenIdle(function () { return _this._executor(); });\r\n    }\r\n    IdleValue.prototype.dispose = function () {\r\n        this._handle.dispose();\r\n    };\r\n    IdleValue.prototype.getValue = function () {\r\n        if (!this._didRun) {\r\n            this._handle.dispose();\r\n            this._executor();\r\n        }\r\n        if (this._error) {\r\n            throw this._error;\r\n        }\r\n        return this._value;\r\n    };\r\n    return IdleValue;\r\n}());\r\nexport { IdleValue };\r\n//#endregion\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Promise as WinJSPromise } from './winjs.base.js';\r\nimport * as platform from './platform.js';\r\nimport { isThenable } from './async.js';\r\nfunction isWinJSPromise(candidate) {\r\n    return isThenable(candidate) && typeof candidate.done === 'function';\r\n}\r\n/**\r\n * A polyfill for the native promises. The implementation is based on\r\n * WinJS promises but tries to gap differences between winjs promises\r\n * and native promises.\r\n */\r\nvar PolyfillPromise = /** @class */ (function () {\r\n    function PolyfillPromise(initOrPromise) {\r\n        if (isWinJSPromise(initOrPromise)) {\r\n            this._winjsPromise = initOrPromise;\r\n        }\r\n        else {\r\n            this._winjsPromise = new WinJSPromise(function (resolve, reject) {\r\n                var initializing = true;\r\n                initOrPromise(function (value) {\r\n                    if (!initializing) {\r\n                        resolve(value);\r\n                    }\r\n                    else {\r\n                        platform.setImmediate(function () { return resolve(value); });\r\n                    }\r\n                }, function (err) {\r\n                    if (!initializing) {\r\n                        reject(err);\r\n                    }\r\n                    else {\r\n                        platform.setImmediate(function () { return reject(err); });\r\n                    }\r\n                });\r\n                initializing = false;\r\n            });\r\n        }\r\n    }\r\n    PolyfillPromise.all = function (thenables) {\r\n        return new PolyfillPromise(WinJSPromise.join(thenables).then(null, function (values) {\r\n            // WinJSPromise returns a sparse array whereas\r\n            // native promises return the *first* error\r\n            for (var key in values) {\r\n                if (values.hasOwnProperty(key)) {\r\n                    return values[key];\r\n                }\r\n            }\r\n        }));\r\n    };\r\n    PolyfillPromise.race = function (thenables) {\r\n        // WinJSPromise returns `{ key: <index/key>, value: <promise> }`\r\n        // from the `any` call and Promise.race just wants the value\r\n        return new PolyfillPromise(WinJSPromise.any(thenables).then(function (entry) { return entry.value; }, function (err) { return err.value; }));\r\n    };\r\n    PolyfillPromise.resolve = function (value) {\r\n        return new PolyfillPromise(WinJSPromise.wrap(value));\r\n    };\r\n    PolyfillPromise.reject = function (value) {\r\n        return new PolyfillPromise(WinJSPromise.wrapError(value));\r\n    };\r\n    PolyfillPromise.prototype.then = function (onFulfilled, onRejected) {\r\n        var sync = true;\r\n        // To support chaining, we need to return the value of the\r\n        // onFulfilled and onRejected callback.\r\n        // WinJSPromise supports a flat-map style #then, ie. the callbacks\r\n        // passed to WinJSPromise#then can return a Promise.\r\n        var promise = new PolyfillPromise(this._winjsPromise.then(onFulfilled && function (value) {\r\n            if (!sync) {\r\n                return onFulfilled(value);\r\n            }\r\n            else {\r\n                return new WinJSPromise(function (resolve, reject) {\r\n                    platform.setImmediate(function () {\r\n                        var result;\r\n                        try {\r\n                            result = onFulfilled(value);\r\n                        }\r\n                        catch (err2) {\r\n                            reject(err2);\r\n                            return;\r\n                        }\r\n                        resolve(result);\r\n                    });\r\n                });\r\n            }\r\n        }, onRejected && function (err) {\r\n            if (!sync) {\r\n                return onRejected(err);\r\n            }\r\n            else {\r\n                return new WinJSPromise(function (resolve, reject) {\r\n                    platform.setImmediate(function () {\r\n                        var result;\r\n                        try {\r\n                            result = onRejected(err);\r\n                        }\r\n                        catch (err2) {\r\n                            reject(err2);\r\n                            return;\r\n                        }\r\n                        resolve(result);\r\n                    });\r\n                });\r\n            }\r\n        }));\r\n        sync = false;\r\n        return promise;\r\n    };\r\n    PolyfillPromise.prototype.catch = function (onRejected) {\r\n        return this.then(null, onRejected);\r\n    };\r\n    return PolyfillPromise;\r\n}());\r\nexport { PolyfillPromise };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nfunction _format(message, args) {\r\n    var result;\r\n    if (args.length === 0) {\r\n        result = message;\r\n    }\r\n    else {\r\n        result = message.replace(/\\{(\\d+)\\}/g, function (match, rest) {\r\n            var index = rest[0];\r\n            return typeof args[index] !== 'undefined' ? args[index] : match;\r\n        });\r\n    }\r\n    return result;\r\n}\r\nexport function localize(data, message) {\r\n    var args = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        args[_i - 2] = arguments[_i];\r\n    }\r\n    return _format(message, args);\r\n}\r\n","/**\r\n * Returns the last element of an array.\r\n * @param array The array.\r\n * @param n Which element from the end (default is zero).\r\n */\r\nexport function tail(array, n) {\r\n    if (n === void 0) { n = 0; }\r\n    return array[array.length - (1 + n)];\r\n}\r\nexport function tail2(arr) {\r\n    if (arr.length === 0) {\r\n        throw new Error('Invalid tail call');\r\n    }\r\n    return [arr.slice(0, arr.length - 1), arr[arr.length - 1]];\r\n}\r\nexport function equals(one, other, itemEquals) {\r\n    if (itemEquals === void 0) { itemEquals = function (a, b) { return a === b; }; }\r\n    if (one === other) {\r\n        return true;\r\n    }\r\n    if (!one || !other) {\r\n        return false;\r\n    }\r\n    if (one.length !== other.length) {\r\n        return false;\r\n    }\r\n    for (var i = 0, len = one.length; i < len; i++) {\r\n        if (!itemEquals(one[i], other[i])) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nexport function binarySearch(array, key, comparator) {\r\n    var low = 0, high = array.length - 1;\r\n    while (low <= high) {\r\n        var mid = ((low + high) / 2) | 0;\r\n        var comp = comparator(array[mid], key);\r\n        if (comp < 0) {\r\n            low = mid + 1;\r\n        }\r\n        else if (comp > 0) {\r\n            high = mid - 1;\r\n        }\r\n        else {\r\n            return mid;\r\n        }\r\n    }\r\n    return -(low + 1);\r\n}\r\n/**\r\n * Takes a sorted array and a function p. The array is sorted in such a way that all elements where p(x) is false\r\n * are located before all elements where p(x) is true.\r\n * @returns the least x for which p(x) is true or array.length if no element fullfills the given function.\r\n */\r\nexport function findFirstInSorted(array, p) {\r\n    var low = 0, high = array.length;\r\n    if (high === 0) {\r\n        return 0; // no children\r\n    }\r\n    while (low < high) {\r\n        var mid = Math.floor((low + high) / 2);\r\n        if (p(array[mid])) {\r\n            high = mid;\r\n        }\r\n        else {\r\n            low = mid + 1;\r\n        }\r\n    }\r\n    return low;\r\n}\r\n/**\r\n * Like `Array#sort` but always stable. Usually runs a little slower `than Array#sort`\r\n * so only use this when actually needing stable sort.\r\n */\r\nexport function mergeSort(data, compare) {\r\n    _sort(data, compare, 0, data.length - 1, []);\r\n    return data;\r\n}\r\nfunction _merge(a, compare, lo, mid, hi, aux) {\r\n    var leftIdx = lo, rightIdx = mid + 1;\r\n    for (var i = lo; i <= hi; i++) {\r\n        aux[i] = a[i];\r\n    }\r\n    for (var i = lo; i <= hi; i++) {\r\n        if (leftIdx > mid) {\r\n            // left side consumed\r\n            a[i] = aux[rightIdx++];\r\n        }\r\n        else if (rightIdx > hi) {\r\n            // right side consumed\r\n            a[i] = aux[leftIdx++];\r\n        }\r\n        else if (compare(aux[rightIdx], aux[leftIdx]) < 0) {\r\n            // right element is less -> comes first\r\n            a[i] = aux[rightIdx++];\r\n        }\r\n        else {\r\n            // left element comes first (less or equal)\r\n            a[i] = aux[leftIdx++];\r\n        }\r\n    }\r\n}\r\nfunction _sort(a, compare, lo, hi, aux) {\r\n    if (hi <= lo) {\r\n        return;\r\n    }\r\n    var mid = lo + ((hi - lo) / 2) | 0;\r\n    _sort(a, compare, lo, mid, aux);\r\n    _sort(a, compare, mid + 1, hi, aux);\r\n    if (compare(a[mid], a[mid + 1]) <= 0) {\r\n        // left and right are sorted and if the last-left element is less\r\n        // or equals than the first-right element there is nothing else\r\n        // to do\r\n        return;\r\n    }\r\n    _merge(a, compare, lo, mid, hi, aux);\r\n}\r\nexport function groupBy(data, compare) {\r\n    var result = [];\r\n    var currentGroup = undefined;\r\n    for (var _i = 0, _a = mergeSort(data.slice(0), compare); _i < _a.length; _i++) {\r\n        var element = _a[_i];\r\n        if (!currentGroup || compare(currentGroup[0], element) !== 0) {\r\n            currentGroup = [element];\r\n            result.push(currentGroup);\r\n        }\r\n        else {\r\n            currentGroup.push(element);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * @returns a new array with all falsy values removed. The original array IS NOT modified.\r\n */\r\nexport function coalesce(array) {\r\n    if (!array) {\r\n        return array;\r\n    }\r\n    return array.filter(function (e) { return !!e; });\r\n}\r\n/**\r\n * @returns {{false}} if the provided object is an array\r\n * \tand not empty.\r\n */\r\nexport function isFalsyOrEmpty(obj) {\r\n    return !Array.isArray(obj) || obj.length === 0;\r\n}\r\n/**\r\n * Removes duplicates from the given array. The optional keyFn allows to specify\r\n * how elements are checked for equalness by returning a unique string for each.\r\n */\r\nexport function distinct(array, keyFn) {\r\n    if (!keyFn) {\r\n        return array.filter(function (element, position) {\r\n            return array.indexOf(element) === position;\r\n        });\r\n    }\r\n    var seen = Object.create(null);\r\n    return array.filter(function (elem) {\r\n        var key = keyFn(elem);\r\n        if (seen[key]) {\r\n            return false;\r\n        }\r\n        seen[key] = true;\r\n        return true;\r\n    });\r\n}\r\nexport function firstIndex(array, fn) {\r\n    for (var i = 0; i < array.length; i++) {\r\n        var element = array[i];\r\n        if (fn(element)) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\nexport function first(array, fn, notFoundValue) {\r\n    if (notFoundValue === void 0) { notFoundValue = null; }\r\n    var index = firstIndex(array, fn);\r\n    return index < 0 ? notFoundValue : array[index];\r\n}\r\nexport function flatten(arr) {\r\n    var _a;\r\n    return (_a = []).concat.apply(_a, arr);\r\n}\r\nexport function range(arg, to) {\r\n    var from = typeof to === 'number' ? arg : 0;\r\n    if (typeof to === 'number') {\r\n        from = arg;\r\n    }\r\n    else {\r\n        from = 0;\r\n        to = arg;\r\n    }\r\n    var result = [];\r\n    if (from <= to) {\r\n        for (var i = from; i < to; i++) {\r\n            result.push(i);\r\n        }\r\n    }\r\n    else {\r\n        for (var i = from; i > to; i--) {\r\n            result.push(i);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Insert `insertArr` inside `target` at `insertIndex`.\r\n * Please don't touch unless you understand https://jsperf.com/inserting-an-array-within-an-array\r\n */\r\nexport function arrayInsert(target, insertIndex, insertArr) {\r\n    var before = target.slice(0, insertIndex);\r\n    var after = target.slice(insertIndex);\r\n    return before.concat(insertArr, after);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar _typeof = {\r\n    number: 'number',\r\n    string: 'string',\r\n    undefined: 'undefined',\r\n    object: 'object',\r\n    function: 'function'\r\n};\r\n/**\r\n * @returns whether the provided parameter is a JavaScript Array or not.\r\n */\r\nexport function isArray(array) {\r\n    if (Array.isArray) {\r\n        return Array.isArray(array);\r\n    }\r\n    if (array && typeof (array.length) === _typeof.number && array.constructor === Array) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * @returns whether the provided parameter is a JavaScript String or not.\r\n */\r\nexport function isString(str) {\r\n    if (typeof (str) === _typeof.string || str instanceof String) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n *\r\n * @returns whether the provided parameter is of type `object` but **not**\r\n *\t`null`, an `array`, a `regexp`, nor a `date`.\r\n */\r\nexport function isObject(obj) {\r\n    // The method can't do a type cast since there are type (like strings) which\r\n    // are subclasses of any put not positvely matched by the function. Hence type\r\n    // narrowing results in wrong results.\r\n    return typeof obj === _typeof.object\r\n        && obj !== null\r\n        && !Array.isArray(obj)\r\n        && !(obj instanceof RegExp)\r\n        && !(obj instanceof Date);\r\n}\r\n/**\r\n * In **contrast** to just checking `typeof` this will return `false` for `NaN`.\r\n * @returns whether the provided parameter is a JavaScript Number or not.\r\n */\r\nexport function isNumber(obj) {\r\n    if ((typeof (obj) === _typeof.number || obj instanceof Number) && !isNaN(obj)) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * @returns whether the provided parameter is a JavaScript Boolean or not.\r\n */\r\nexport function isBoolean(obj) {\r\n    return obj === true || obj === false;\r\n}\r\n/**\r\n * @returns whether the provided parameter is undefined.\r\n */\r\nexport function isUndefined(obj) {\r\n    return typeof (obj) === _typeof.undefined;\r\n}\r\n/**\r\n * @returns whether the provided parameter is undefined or null.\r\n */\r\nexport function isUndefinedOrNull(obj) {\r\n    return isUndefined(obj) || obj === null;\r\n}\r\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\r\n/**\r\n * @returns whether the provided parameter is an empty JavaScript Object or not.\r\n */\r\nexport function isEmptyObject(obj) {\r\n    if (!isObject(obj)) {\r\n        return false;\r\n    }\r\n    for (var key in obj) {\r\n        if (hasOwnProperty.call(obj, key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * @returns whether the provided parameter is a JavaScript Function or not.\r\n */\r\nexport function isFunction(obj) {\r\n    return typeof obj === _typeof.function;\r\n}\r\nexport function validateConstraints(args, constraints) {\r\n    var len = Math.min(args.length, constraints.length);\r\n    for (var i = 0; i < len; i++) {\r\n        validateConstraint(args[i], constraints[i]);\r\n    }\r\n}\r\nexport function validateConstraint(arg, constraint) {\r\n    if (isString(constraint)) {\r\n        if (typeof arg !== constraint) {\r\n            throw new Error(\"argument does not match constraint: typeof \" + constraint);\r\n        }\r\n    }\r\n    else if (isFunction(constraint)) {\r\n        if (arg instanceof constraint) {\r\n            return;\r\n        }\r\n        if (!isUndefinedOrNull(arg) && arg.constructor === constraint) {\r\n            return;\r\n        }\r\n        if (constraint.length === 1 && constraint.call(undefined, arg) === true) {\r\n            return;\r\n        }\r\n        throw new Error(\"argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true\");\r\n    }\r\n}\r\n/**\r\n * Creates a new object of the provided class and will call the constructor with\r\n * any additional argument supplied.\r\n */\r\nexport function create(ctor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    var obj = Object.create(ctor.prototype);\r\n    ctor.apply(obj, args);\r\n    return obj;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isObject } from './types.js';\r\nexport function deepClone(obj) {\r\n    if (!obj || typeof obj !== 'object') {\r\n        return obj;\r\n    }\r\n    if (obj instanceof RegExp) {\r\n        // See https://github.com/Microsoft/TypeScript/issues/10990\r\n        return obj;\r\n    }\r\n    var result = Array.isArray(obj) ? [] : {};\r\n    Object.keys(obj).forEach(function (key) {\r\n        if (obj[key] && typeof obj[key] === 'object') {\r\n            result[key] = deepClone(obj[key]);\r\n        }\r\n        else {\r\n            result[key] = obj[key];\r\n        }\r\n    });\r\n    return result;\r\n}\r\nexport function deepFreeze(obj) {\r\n    if (!obj || typeof obj !== 'object') {\r\n        return obj;\r\n    }\r\n    var stack = [obj];\r\n    while (stack.length > 0) {\r\n        var obj_1 = stack.shift();\r\n        Object.freeze(obj_1);\r\n        for (var key in obj_1) {\r\n            if (_hasOwnProperty.call(obj_1, key)) {\r\n                var prop = obj_1[key];\r\n                if (typeof prop === 'object' && !Object.isFrozen(prop)) {\r\n                    stack.push(prop);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return obj;\r\n}\r\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\r\n/**\r\n * Copies all properties of source into destination. The optional parameter \"overwrite\" allows to control\r\n * if existing properties on the destination should be overwritten or not. Defaults to true (overwrite).\r\n */\r\nexport function mixin(destination, source, overwrite) {\r\n    if (overwrite === void 0) { overwrite = true; }\r\n    if (!isObject(destination)) {\r\n        return source;\r\n    }\r\n    if (isObject(source)) {\r\n        Object.keys(source).forEach(function (key) {\r\n            if (key in destination) {\r\n                if (overwrite) {\r\n                    if (isObject(destination[key]) && isObject(source[key])) {\r\n                        mixin(destination[key], source[key], overwrite);\r\n                    }\r\n                    else {\r\n                        destination[key] = source[key];\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                destination[key] = source[key];\r\n            }\r\n        });\r\n    }\r\n    return destination;\r\n}\r\nexport function assign(destination) {\r\n    var sources = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        sources[_i - 1] = arguments[_i];\r\n    }\r\n    sources.forEach(function (source) { return Object.keys(source).forEach(function (key) { return destination[key] = source[key]; }); });\r\n    return destination;\r\n}\r\nexport function equals(one, other) {\r\n    if (one === other) {\r\n        return true;\r\n    }\r\n    if (one === null || one === undefined || other === null || other === undefined) {\r\n        return false;\r\n    }\r\n    if (typeof one !== typeof other) {\r\n        return false;\r\n    }\r\n    if (typeof one !== 'object') {\r\n        return false;\r\n    }\r\n    if ((Array.isArray(one)) !== (Array.isArray(other))) {\r\n        return false;\r\n    }\r\n    var i;\r\n    var key;\r\n    if (Array.isArray(one)) {\r\n        if (one.length !== other.length) {\r\n            return false;\r\n        }\r\n        for (i = 0; i < one.length; i++) {\r\n            if (!equals(one[i], other[i])) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        var oneKeys = [];\r\n        for (key in one) {\r\n            oneKeys.push(key);\r\n        }\r\n        oneKeys.sort();\r\n        var otherKeys = [];\r\n        for (key in other) {\r\n            otherKeys.push(key);\r\n        }\r\n        otherKeys.sort();\r\n        if (!equals(oneKeys, otherKeys)) {\r\n            return false;\r\n        }\r\n        for (i = 0; i < oneKeys.length; i++) {\r\n            if (!equals(one[oneKeys[i]], other[oneKeys[i]])) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\nexport function arrayToHash(array) {\r\n    var result = {};\r\n    for (var i = 0; i < array.length; ++i) {\r\n        result[array[i]] = true;\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Given an array of strings, returns a function which, given a string\r\n * returns true or false whether the string is in that array.\r\n */\r\nexport function createKeywordMatcher(arr, caseInsensitive) {\r\n    if (caseInsensitive === void 0) { caseInsensitive = false; }\r\n    if (caseInsensitive) {\r\n        arr = arr.map(function (x) { return x.toLowerCase(); });\r\n    }\r\n    var hash = arrayToHash(arr);\r\n    if (caseInsensitive) {\r\n        return function (word) {\r\n            return hash[word.toLowerCase()] !== undefined && hash.hasOwnProperty(word.toLowerCase());\r\n        };\r\n    }\r\n    else {\r\n        return function (word) {\r\n            return hash[word] !== undefined && hash.hasOwnProperty(word);\r\n        };\r\n    }\r\n}\r\nexport function getOrDefault(obj, fn, defaultValue) {\r\n    if (defaultValue === void 0) { defaultValue = null; }\r\n    var result = fn(obj);\r\n    return typeof result === 'undefined' ? defaultValue : result;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport var USUAL_WORD_SEPARATORS = '`~!@#$%^&*()-=+[{]}\\\\|;:\\'\",.<>/?';\r\n/**\r\n * Create a word definition regular expression based on default word separators.\r\n * Optionally provide allowed separators that should be included in words.\r\n *\r\n * The default would look like this:\r\n * /(-?\\d*\\.\\d\\w*)|([^\\`\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\=\\+\\[\\{\\]\\}\\\\\\|\\;\\:\\'\\\"\\,\\.\\<\\>\\/\\?\\s]+)/g\r\n */\r\nfunction createWordRegExp(allowInWords) {\r\n    if (allowInWords === void 0) { allowInWords = ''; }\r\n    var source = '(-?\\\\d*\\\\.\\\\d\\\\w*)|([^';\r\n    for (var i = 0; i < USUAL_WORD_SEPARATORS.length; i++) {\r\n        if (allowInWords.indexOf(USUAL_WORD_SEPARATORS[i]) >= 0) {\r\n            continue;\r\n        }\r\n        source += '\\\\' + USUAL_WORD_SEPARATORS[i];\r\n    }\r\n    source += '\\\\s]+)';\r\n    return new RegExp(source, 'g');\r\n}\r\n// catches numbers (including floating numbers) in the first group, and alphanum in the second\r\nexport var DEFAULT_WORD_REGEXP = createWordRegExp();\r\nexport function ensureValidWordDefinition(wordDefinition) {\r\n    var result = DEFAULT_WORD_REGEXP;\r\n    if (wordDefinition && (wordDefinition instanceof RegExp)) {\r\n        if (!wordDefinition.global) {\r\n            var flags = 'g';\r\n            if (wordDefinition.ignoreCase) {\r\n                flags += 'i';\r\n            }\r\n            if (wordDefinition.multiline) {\r\n                flags += 'm';\r\n            }\r\n            result = new RegExp(wordDefinition.source, flags);\r\n        }\r\n        else {\r\n            result = wordDefinition;\r\n        }\r\n    }\r\n    result.lastIndex = 0;\r\n    return result;\r\n}\r\nfunction getWordAtPosFast(column, wordDefinition, text, textOffset) {\r\n    // find whitespace enclosed text around column and match from there\r\n    var pos = column - 1 - textOffset;\r\n    var start = text.lastIndexOf(' ', pos - 1) + 1;\r\n    var end = text.indexOf(' ', pos);\r\n    if (end === -1) {\r\n        end = text.length;\r\n    }\r\n    wordDefinition.lastIndex = start;\r\n    var match;\r\n    while (match = wordDefinition.exec(text)) {\r\n        var matchIndex = match.index || 0;\r\n        if (matchIndex <= pos && wordDefinition.lastIndex >= pos) {\r\n            return {\r\n                word: match[0],\r\n                startColumn: textOffset + 1 + matchIndex,\r\n                endColumn: textOffset + 1 + wordDefinition.lastIndex\r\n            };\r\n        }\r\n    }\r\n    return null;\r\n}\r\nfunction getWordAtPosSlow(column, wordDefinition, text, textOffset) {\r\n    // matches all words starting at the beginning\r\n    // of the input until it finds a match that encloses\r\n    // the desired column. slow but correct\r\n    var pos = column - 1 - textOffset;\r\n    wordDefinition.lastIndex = 0;\r\n    var match;\r\n    while (match = wordDefinition.exec(text)) {\r\n        var matchIndex = match.index || 0;\r\n        if (matchIndex > pos) {\r\n            // |nW -> matched only after the pos\r\n            return null;\r\n        }\r\n        else if (wordDefinition.lastIndex >= pos) {\r\n            // W|W -> match encloses pos\r\n            return {\r\n                word: match[0],\r\n                startColumn: textOffset + 1 + matchIndex,\r\n                endColumn: textOffset + 1 + wordDefinition.lastIndex\r\n            };\r\n        }\r\n    }\r\n    return null;\r\n}\r\nexport function getWordAtText(column, wordDefinition, text, textOffset) {\r\n    // if `words` can contain whitespace character we have to use the slow variant\r\n    // otherwise we use the fast variant of finding a word\r\n    wordDefinition.lastIndex = 0;\r\n    var match = wordDefinition.exec(text);\r\n    if (!match) {\r\n        return null;\r\n    }\r\n    // todo@joh the `match` could already be the (first) word\r\n    var ret = match[0].indexOf(' ') >= 0\r\n        // did match a word which contains a space character -> use slow word find\r\n        ? getWordAtPosSlow(column, wordDefinition, text, textOffset)\r\n        // sane word definition -> use fast word find\r\n        : getWordAtPosFast(column, wordDefinition, text, textOffset);\r\n    // both (getWordAtPosFast and getWordAtPosSlow) leave the wordDefinition-RegExp\r\n    // in an undefined state and to not confuse other users of the wordDefinition\r\n    // we reset the lastIndex\r\n    wordDefinition.lastIndex = 0;\r\n    return ret;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as arrays from '../../../base/common/arrays.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { USUAL_WORD_SEPARATORS } from '../model/wordHelper.js';\r\n/**\r\n * @internal\r\n */\r\nexport function blinkingStyleToString(blinkingStyle) {\r\n    if (blinkingStyle === 1 /* Blink */) {\r\n        return 'blink';\r\n    }\r\n    else if (blinkingStyle === 4 /* Expand */) {\r\n        return 'expand';\r\n    }\r\n    else if (blinkingStyle === 3 /* Phase */) {\r\n        return 'phase';\r\n    }\r\n    else if (blinkingStyle === 2 /* Smooth */) {\r\n        return 'smooth';\r\n    }\r\n    else if (blinkingStyle === 5 /* Solid */) {\r\n        return 'solid';\r\n    }\r\n    else {\r\n        throw new Error('blinkingStyleToString: Unknown blinkingStyle');\r\n    }\r\n}\r\n/**\r\n * The style in which the editor's cursor should be rendered.\r\n */\r\nexport var TextEditorCursorStyle;\r\n(function (TextEditorCursorStyle) {\r\n    /**\r\n     * As a vertical line (sitting between two characters).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"Line\"] = 1] = \"Line\";\r\n    /**\r\n     * As a block (sitting on top of a character).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"Block\"] = 2] = \"Block\";\r\n    /**\r\n     * As a horizontal line (sitting under a character).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"Underline\"] = 3] = \"Underline\";\r\n    /**\r\n     * As a thin vertical line (sitting between two characters).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"LineThin\"] = 4] = \"LineThin\";\r\n    /**\r\n     * As an outlined block (sitting on top of a character).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"BlockOutline\"] = 5] = \"BlockOutline\";\r\n    /**\r\n     * As a thin horizontal line (sitting under a character).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"UnderlineThin\"] = 6] = \"UnderlineThin\";\r\n})(TextEditorCursorStyle || (TextEditorCursorStyle = {}));\r\n/**\r\n * @internal\r\n */\r\nexport function cursorStyleToString(cursorStyle) {\r\n    if (cursorStyle === TextEditorCursorStyle.Line) {\r\n        return 'line';\r\n    }\r\n    else if (cursorStyle === TextEditorCursorStyle.Block) {\r\n        return 'block';\r\n    }\r\n    else if (cursorStyle === TextEditorCursorStyle.Underline) {\r\n        return 'underline';\r\n    }\r\n    else if (cursorStyle === TextEditorCursorStyle.LineThin) {\r\n        return 'line-thin';\r\n    }\r\n    else if (cursorStyle === TextEditorCursorStyle.BlockOutline) {\r\n        return 'block-outline';\r\n    }\r\n    else if (cursorStyle === TextEditorCursorStyle.UnderlineThin) {\r\n        return 'underline-thin';\r\n    }\r\n    else {\r\n        throw new Error('cursorStyleToString: Unknown cursorStyle');\r\n    }\r\n}\r\nfunction _cursorStyleFromString(cursorStyle, defaultValue) {\r\n    if (typeof cursorStyle !== 'string') {\r\n        return defaultValue;\r\n    }\r\n    if (cursorStyle === 'line') {\r\n        return TextEditorCursorStyle.Line;\r\n    }\r\n    else if (cursorStyle === 'block') {\r\n        return TextEditorCursorStyle.Block;\r\n    }\r\n    else if (cursorStyle === 'underline') {\r\n        return TextEditorCursorStyle.Underline;\r\n    }\r\n    else if (cursorStyle === 'line-thin') {\r\n        return TextEditorCursorStyle.LineThin;\r\n    }\r\n    else if (cursorStyle === 'block-outline') {\r\n        return TextEditorCursorStyle.BlockOutline;\r\n    }\r\n    else if (cursorStyle === 'underline-thin') {\r\n        return TextEditorCursorStyle.UnderlineThin;\r\n    }\r\n    return TextEditorCursorStyle.Line;\r\n}\r\n/**\r\n * Internal configuration options (transformed or computed) for the editor.\r\n */\r\nvar InternalEditorOptions = /** @class */ (function () {\r\n    /**\r\n     * @internal\r\n     */\r\n    function InternalEditorOptions(source) {\r\n        this.canUseLayerHinting = source.canUseLayerHinting;\r\n        this.pixelRatio = source.pixelRatio;\r\n        this.editorClassName = source.editorClassName;\r\n        this.lineHeight = source.lineHeight | 0;\r\n        this.readOnly = source.readOnly;\r\n        this.accessibilitySupport = source.accessibilitySupport;\r\n        this.multiCursorModifier = source.multiCursorModifier;\r\n        this.multiCursorMergeOverlapping = source.multiCursorMergeOverlapping;\r\n        this.wordSeparators = source.wordSeparators;\r\n        this.autoClosingBrackets = source.autoClosingBrackets;\r\n        this.autoClosingQuotes = source.autoClosingQuotes;\r\n        this.autoSurround = source.autoSurround;\r\n        this.autoIndent = source.autoIndent;\r\n        this.useTabStops = source.useTabStops;\r\n        this.tabFocusMode = source.tabFocusMode;\r\n        this.dragAndDrop = source.dragAndDrop;\r\n        this.emptySelectionClipboard = source.emptySelectionClipboard;\r\n        this.copyWithSyntaxHighlighting = source.copyWithSyntaxHighlighting;\r\n        this.layoutInfo = source.layoutInfo;\r\n        this.fontInfo = source.fontInfo;\r\n        this.viewInfo = source.viewInfo;\r\n        this.wrappingInfo = source.wrappingInfo;\r\n        this.contribInfo = source.contribInfo;\r\n        this.showUnused = source.showUnused;\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions.prototype.equals = function (other) {\r\n        return (this.canUseLayerHinting === other.canUseLayerHinting\r\n            && this.pixelRatio === other.pixelRatio\r\n            && this.editorClassName === other.editorClassName\r\n            && this.lineHeight === other.lineHeight\r\n            && this.readOnly === other.readOnly\r\n            && this.accessibilitySupport === other.accessibilitySupport\r\n            && this.multiCursorModifier === other.multiCursorModifier\r\n            && this.multiCursorMergeOverlapping === other.multiCursorMergeOverlapping\r\n            && this.wordSeparators === other.wordSeparators\r\n            && this.autoClosingBrackets === other.autoClosingBrackets\r\n            && this.autoClosingQuotes === other.autoClosingQuotes\r\n            && this.autoSurround === other.autoSurround\r\n            && this.autoIndent === other.autoIndent\r\n            && this.useTabStops === other.useTabStops\r\n            && this.tabFocusMode === other.tabFocusMode\r\n            && this.dragAndDrop === other.dragAndDrop\r\n            && this.showUnused === other.showUnused\r\n            && this.emptySelectionClipboard === other.emptySelectionClipboard\r\n            && this.copyWithSyntaxHighlighting === other.copyWithSyntaxHighlighting\r\n            && InternalEditorOptions._equalsLayoutInfo(this.layoutInfo, other.layoutInfo)\r\n            && this.fontInfo.equals(other.fontInfo)\r\n            && InternalEditorOptions._equalsViewOptions(this.viewInfo, other.viewInfo)\r\n            && InternalEditorOptions._equalsWrappingInfo(this.wrappingInfo, other.wrappingInfo)\r\n            && InternalEditorOptions._equalsContribOptions(this.contribInfo, other.contribInfo));\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions.prototype.createChangeEvent = function (newOpts) {\r\n        return {\r\n            canUseLayerHinting: (this.canUseLayerHinting !== newOpts.canUseLayerHinting),\r\n            pixelRatio: (this.pixelRatio !== newOpts.pixelRatio),\r\n            editorClassName: (this.editorClassName !== newOpts.editorClassName),\r\n            lineHeight: (this.lineHeight !== newOpts.lineHeight),\r\n            readOnly: (this.readOnly !== newOpts.readOnly),\r\n            accessibilitySupport: (this.accessibilitySupport !== newOpts.accessibilitySupport),\r\n            multiCursorModifier: (this.multiCursorModifier !== newOpts.multiCursorModifier),\r\n            multiCursorMergeOverlapping: (this.multiCursorMergeOverlapping !== newOpts.multiCursorMergeOverlapping),\r\n            wordSeparators: (this.wordSeparators !== newOpts.wordSeparators),\r\n            autoClosingBrackets: (this.autoClosingBrackets !== newOpts.autoClosingBrackets),\r\n            autoClosingQuotes: (this.autoClosingQuotes !== newOpts.autoClosingQuotes),\r\n            autoSurround: (this.autoSurround !== newOpts.autoSurround),\r\n            autoIndent: (this.autoIndent !== newOpts.autoIndent),\r\n            useTabStops: (this.useTabStops !== newOpts.useTabStops),\r\n            tabFocusMode: (this.tabFocusMode !== newOpts.tabFocusMode),\r\n            dragAndDrop: (this.dragAndDrop !== newOpts.dragAndDrop),\r\n            emptySelectionClipboard: (this.emptySelectionClipboard !== newOpts.emptySelectionClipboard),\r\n            copyWithSyntaxHighlighting: (this.copyWithSyntaxHighlighting !== newOpts.copyWithSyntaxHighlighting),\r\n            layoutInfo: (!InternalEditorOptions._equalsLayoutInfo(this.layoutInfo, newOpts.layoutInfo)),\r\n            fontInfo: (!this.fontInfo.equals(newOpts.fontInfo)),\r\n            viewInfo: (!InternalEditorOptions._equalsViewOptions(this.viewInfo, newOpts.viewInfo)),\r\n            wrappingInfo: (!InternalEditorOptions._equalsWrappingInfo(this.wrappingInfo, newOpts.wrappingInfo)),\r\n            contribInfo: (!InternalEditorOptions._equalsContribOptions(this.contribInfo, newOpts.contribInfo))\r\n        };\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions._equalsLayoutInfo = function (a, b) {\r\n        return (a.width === b.width\r\n            && a.height === b.height\r\n            && a.glyphMarginLeft === b.glyphMarginLeft\r\n            && a.glyphMarginWidth === b.glyphMarginWidth\r\n            && a.glyphMarginHeight === b.glyphMarginHeight\r\n            && a.lineNumbersLeft === b.lineNumbersLeft\r\n            && a.lineNumbersWidth === b.lineNumbersWidth\r\n            && a.lineNumbersHeight === b.lineNumbersHeight\r\n            && a.decorationsLeft === b.decorationsLeft\r\n            && a.decorationsWidth === b.decorationsWidth\r\n            && a.decorationsHeight === b.decorationsHeight\r\n            && a.contentLeft === b.contentLeft\r\n            && a.contentWidth === b.contentWidth\r\n            && a.contentHeight === b.contentHeight\r\n            && a.renderMinimap === b.renderMinimap\r\n            && a.minimapLeft === b.minimapLeft\r\n            && a.minimapWidth === b.minimapWidth\r\n            && a.viewportColumn === b.viewportColumn\r\n            && a.verticalScrollbarWidth === b.verticalScrollbarWidth\r\n            && a.horizontalScrollbarHeight === b.horizontalScrollbarHeight\r\n            && this._equalsOverviewRuler(a.overviewRuler, b.overviewRuler));\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions._equalsOverviewRuler = function (a, b) {\r\n        return (a.width === b.width\r\n            && a.height === b.height\r\n            && a.top === b.top\r\n            && a.right === b.right);\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions._equalsViewOptions = function (a, b) {\r\n        return (a.extraEditorClassName === b.extraEditorClassName\r\n            && a.disableMonospaceOptimizations === b.disableMonospaceOptimizations\r\n            && arrays.equals(a.rulers, b.rulers)\r\n            && a.ariaLabel === b.ariaLabel\r\n            && a.renderLineNumbers === b.renderLineNumbers\r\n            && a.renderCustomLineNumbers === b.renderCustomLineNumbers\r\n            && a.selectOnLineNumbers === b.selectOnLineNumbers\r\n            && a.glyphMargin === b.glyphMargin\r\n            && a.revealHorizontalRightPadding === b.revealHorizontalRightPadding\r\n            && a.roundedSelection === b.roundedSelection\r\n            && a.overviewRulerLanes === b.overviewRulerLanes\r\n            && a.overviewRulerBorder === b.overviewRulerBorder\r\n            && a.cursorBlinking === b.cursorBlinking\r\n            && a.mouseWheelZoom === b.mouseWheelZoom\r\n            && a.cursorStyle === b.cursorStyle\r\n            && a.cursorWidth === b.cursorWidth\r\n            && a.hideCursorInOverviewRuler === b.hideCursorInOverviewRuler\r\n            && a.scrollBeyondLastLine === b.scrollBeyondLastLine\r\n            && a.scrollBeyondLastColumn === b.scrollBeyondLastColumn\r\n            && a.smoothScrolling === b.smoothScrolling\r\n            && a.stopRenderingLineAfter === b.stopRenderingLineAfter\r\n            && a.renderWhitespace === b.renderWhitespace\r\n            && a.renderControlCharacters === b.renderControlCharacters\r\n            && a.fontLigatures === b.fontLigatures\r\n            && a.renderIndentGuides === b.renderIndentGuides\r\n            && a.highlightActiveIndentGuide === b.highlightActiveIndentGuide\r\n            && a.renderLineHighlight === b.renderLineHighlight\r\n            && this._equalsScrollbarOptions(a.scrollbar, b.scrollbar)\r\n            && this._equalsMinimapOptions(a.minimap, b.minimap)\r\n            && a.fixedOverflowWidgets === b.fixedOverflowWidgets);\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions._equalsScrollbarOptions = function (a, b) {\r\n        return (a.arrowSize === b.arrowSize\r\n            && a.vertical === b.vertical\r\n            && a.horizontal === b.horizontal\r\n            && a.useShadows === b.useShadows\r\n            && a.verticalHasArrows === b.verticalHasArrows\r\n            && a.horizontalHasArrows === b.horizontalHasArrows\r\n            && a.handleMouseWheel === b.handleMouseWheel\r\n            && a.horizontalScrollbarSize === b.horizontalScrollbarSize\r\n            && a.horizontalSliderSize === b.horizontalSliderSize\r\n            && a.verticalScrollbarSize === b.verticalScrollbarSize\r\n            && a.verticalSliderSize === b.verticalSliderSize\r\n            && a.mouseWheelScrollSensitivity === b.mouseWheelScrollSensitivity);\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions._equalsMinimapOptions = function (a, b) {\r\n        return (a.enabled === b.enabled\r\n            && a.side === b.side\r\n            && a.showSlider === b.showSlider\r\n            && a.renderCharacters === b.renderCharacters\r\n            && a.maxColumn === b.maxColumn);\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions._equalFindOptions = function (a, b) {\r\n        return (a.seedSearchStringFromSelection === b.seedSearchStringFromSelection\r\n            && a.autoFindInSelection === b.autoFindInSelection\r\n            && a.globalFindClipboard === b.globalFindClipboard);\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions._equalsParameterHintOptions = function (a, b) {\r\n        return (a.enabled === b.enabled\r\n            && a.cycle === b.cycle);\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions._equalsHoverOptions = function (a, b) {\r\n        return (a.enabled === b.enabled\r\n            && a.delay === b.delay\r\n            && a.sticky === b.sticky);\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions._equalsSuggestOptions = function (a, b) {\r\n        if (a === b) {\r\n            return true;\r\n        }\r\n        else if (!a || !b) {\r\n            return false;\r\n        }\r\n        else {\r\n            return a.filterGraceful === b.filterGraceful\r\n                && a.snippets === b.snippets\r\n                && a.snippetsPreventQuickSuggestions === b.snippetsPreventQuickSuggestions\r\n                && a.localityBonus === b.localityBonus;\r\n        }\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions._equalsWrappingInfo = function (a, b) {\r\n        return (a.inDiffEditor === b.inDiffEditor\r\n            && a.isDominatedByLongLines === b.isDominatedByLongLines\r\n            && a.isWordWrapMinified === b.isWordWrapMinified\r\n            && a.isViewportWrapping === b.isViewportWrapping\r\n            && a.wrappingColumn === b.wrappingColumn\r\n            && a.wrappingIndent === b.wrappingIndent\r\n            && a.wordWrapBreakBeforeCharacters === b.wordWrapBreakBeforeCharacters\r\n            && a.wordWrapBreakAfterCharacters === b.wordWrapBreakAfterCharacters\r\n            && a.wordWrapBreakObtrusiveCharacters === b.wordWrapBreakObtrusiveCharacters);\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    InternalEditorOptions._equalsContribOptions = function (a, b) {\r\n        return (a.selectionClipboard === b.selectionClipboard\r\n            && this._equalsHoverOptions(a.hover, b.hover)\r\n            && a.links === b.links\r\n            && a.contextmenu === b.contextmenu\r\n            && InternalEditorOptions._equalsQuickSuggestions(a.quickSuggestions, b.quickSuggestions)\r\n            && a.quickSuggestionsDelay === b.quickSuggestionsDelay\r\n            && this._equalsParameterHintOptions(a.parameterHints, b.parameterHints)\r\n            && a.iconsInSuggestions === b.iconsInSuggestions\r\n            && a.formatOnType === b.formatOnType\r\n            && a.formatOnPaste === b.formatOnPaste\r\n            && a.suggestOnTriggerCharacters === b.suggestOnTriggerCharacters\r\n            && a.acceptSuggestionOnEnter === b.acceptSuggestionOnEnter\r\n            && a.acceptSuggestionOnCommitCharacter === b.acceptSuggestionOnCommitCharacter\r\n            && a.wordBasedSuggestions === b.wordBasedSuggestions\r\n            && a.suggestSelection === b.suggestSelection\r\n            && a.suggestFontSize === b.suggestFontSize\r\n            && a.suggestLineHeight === b.suggestLineHeight\r\n            && a.tabCompletion === b.tabCompletion\r\n            && this._equalsSuggestOptions(a.suggest, b.suggest)\r\n            && a.selectionHighlight === b.selectionHighlight\r\n            && a.occurrencesHighlight === b.occurrencesHighlight\r\n            && a.codeLens === b.codeLens\r\n            && a.folding === b.folding\r\n            && a.foldingStrategy === b.foldingStrategy\r\n            && a.showFoldingControls === b.showFoldingControls\r\n            && a.matchBrackets === b.matchBrackets\r\n            && this._equalFindOptions(a.find, b.find)\r\n            && a.colorDecorators === b.colorDecorators\r\n            && objects.equals(a.codeActionsOnSave, b.codeActionsOnSave)\r\n            && a.codeActionsOnSaveTimeout === b.codeActionsOnSaveTimeout\r\n            && a.lightbulbEnabled === b.lightbulbEnabled);\r\n    };\r\n    InternalEditorOptions._equalsQuickSuggestions = function (a, b) {\r\n        if (typeof a === 'boolean') {\r\n            if (typeof b !== 'boolean') {\r\n                return false;\r\n            }\r\n            return a === b;\r\n        }\r\n        if (typeof b === 'boolean') {\r\n            return false;\r\n        }\r\n        return (a.comments === b.comments\r\n            && a.other === b.other\r\n            && a.strings === b.strings);\r\n    };\r\n    return InternalEditorOptions;\r\n}());\r\nexport { InternalEditorOptions };\r\nfunction _boolean(value, defaultValue) {\r\n    if (typeof value === 'undefined') {\r\n        return defaultValue;\r\n    }\r\n    if (value === 'false') {\r\n        // treat the string 'false' as false\r\n        return false;\r\n    }\r\n    return Boolean(value);\r\n}\r\nfunction _booleanMap(value, defaultValue) {\r\n    if (!value) {\r\n        return defaultValue;\r\n    }\r\n    var out = Object.create(null);\r\n    for (var _i = 0, _a = Object.keys(value); _i < _a.length; _i++) {\r\n        var k = _a[_i];\r\n        var v = value[k];\r\n        if (typeof v === 'boolean') {\r\n            out[k] = v;\r\n        }\r\n    }\r\n    return out;\r\n}\r\nfunction _string(value, defaultValue) {\r\n    if (typeof value !== 'string') {\r\n        return defaultValue;\r\n    }\r\n    return value;\r\n}\r\nfunction _stringSet(value, defaultValue, allowedValues) {\r\n    if (typeof value !== 'string') {\r\n        return defaultValue;\r\n    }\r\n    if (allowedValues.indexOf(value) === -1) {\r\n        return defaultValue;\r\n    }\r\n    return value;\r\n}\r\nfunction _clampedInt(value, defaultValue, minimum, maximum) {\r\n    var r;\r\n    if (typeof value === 'undefined') {\r\n        r = defaultValue;\r\n    }\r\n    else {\r\n        r = parseInt(value, 10);\r\n        if (isNaN(r)) {\r\n            r = defaultValue;\r\n        }\r\n    }\r\n    r = Math.max(minimum, r);\r\n    r = Math.min(maximum, r);\r\n    return r | 0;\r\n}\r\nfunction _float(value, defaultValue) {\r\n    var r = parseFloat(value);\r\n    if (isNaN(r)) {\r\n        r = defaultValue;\r\n    }\r\n    return r;\r\n}\r\nfunction _wrappingIndentFromString(wrappingIndent, defaultValue) {\r\n    if (typeof wrappingIndent !== 'string') {\r\n        return defaultValue;\r\n    }\r\n    if (wrappingIndent === 'same') {\r\n        return 1 /* Same */;\r\n    }\r\n    else if (wrappingIndent === 'indent') {\r\n        return 2 /* Indent */;\r\n    }\r\n    else if (wrappingIndent === 'deepIndent') {\r\n        return 3 /* DeepIndent */;\r\n    }\r\n    else {\r\n        return 0 /* None */;\r\n    }\r\n}\r\nfunction _cursorBlinkingStyleFromString(cursorBlinkingStyle, defaultValue) {\r\n    if (typeof cursorBlinkingStyle !== 'string') {\r\n        return defaultValue;\r\n    }\r\n    switch (cursorBlinkingStyle) {\r\n        case 'blink':\r\n            return 1 /* Blink */;\r\n        case 'smooth':\r\n            return 2 /* Smooth */;\r\n        case 'phase':\r\n            return 3 /* Phase */;\r\n        case 'expand':\r\n            return 4 /* Expand */;\r\n        case 'visible': // maintain compatibility\r\n        case 'solid':\r\n            return 5 /* Solid */;\r\n    }\r\n    return 1 /* Blink */;\r\n}\r\nfunction _scrollbarVisibilityFromString(visibility, defaultValue) {\r\n    if (typeof visibility !== 'string') {\r\n        return defaultValue;\r\n    }\r\n    switch (visibility) {\r\n        case 'hidden':\r\n            return 2 /* Hidden */;\r\n        case 'visible':\r\n            return 3 /* Visible */;\r\n        default:\r\n            return 1 /* Auto */;\r\n    }\r\n}\r\n/**\r\n * @internal\r\n */\r\nvar EditorOptionsValidator = /** @class */ (function () {\r\n    function EditorOptionsValidator() {\r\n    }\r\n    /**\r\n     * Validate raw editor options.\r\n     * i.e. since they can be defined by the user, they might be invalid.\r\n     */\r\n    EditorOptionsValidator.validate = function (opts, defaults) {\r\n        var wordWrap = opts.wordWrap;\r\n        {\r\n            // Compatibility with old true or false values\r\n            if (wordWrap === true) {\r\n                wordWrap = 'on';\r\n            }\r\n            else if (wordWrap === false) {\r\n                wordWrap = 'off';\r\n            }\r\n            wordWrap = _stringSet(wordWrap, defaults.wordWrap, ['off', 'on', 'wordWrapColumn', 'bounded']);\r\n        }\r\n        var viewInfo = this._sanitizeViewInfo(opts, defaults.viewInfo);\r\n        var contribInfo = this._sanitizeContribInfo(opts, defaults.contribInfo);\r\n        var configuredMulticursorModifier = undefined;\r\n        if (typeof opts.multiCursorModifier === 'string') {\r\n            if (opts.multiCursorModifier === 'ctrlCmd') {\r\n                configuredMulticursorModifier = platform.isMacintosh ? 'metaKey' : 'ctrlKey';\r\n            }\r\n            else {\r\n                configuredMulticursorModifier = 'altKey';\r\n            }\r\n        }\r\n        var multiCursorModifier = _stringSet(configuredMulticursorModifier, defaults.multiCursorModifier, ['altKey', 'metaKey', 'ctrlKey']);\r\n        var autoClosingBrackets;\r\n        var autoClosingQuotes;\r\n        var autoSurround;\r\n        if (typeof opts.autoClosingBrackets === 'boolean' && opts.autoClosingBrackets === false) {\r\n            // backwards compatibility: disable all on boolean false\r\n            autoClosingBrackets = 'never';\r\n            autoClosingQuotes = 'never';\r\n            autoSurround = 'never';\r\n        }\r\n        else {\r\n            autoClosingBrackets = _stringSet(opts.autoClosingBrackets, defaults.autoClosingBrackets, ['always', 'languageDefined', 'beforeWhitespace', 'never']);\r\n            autoClosingQuotes = _stringSet(opts.autoClosingQuotes, defaults.autoClosingQuotes, ['always', 'languageDefined', 'beforeWhitespace', 'never']);\r\n            autoSurround = _stringSet(opts.autoSurround, defaults.autoSurround, ['languageDefined', 'brackets', 'quotes', 'never']);\r\n        }\r\n        return {\r\n            inDiffEditor: _boolean(opts.inDiffEditor, defaults.inDiffEditor),\r\n            wordSeparators: _string(opts.wordSeparators, defaults.wordSeparators),\r\n            lineNumbersMinChars: _clampedInt(opts.lineNumbersMinChars, defaults.lineNumbersMinChars, 1, 10),\r\n            lineDecorationsWidth: (typeof opts.lineDecorationsWidth === 'undefined' ? defaults.lineDecorationsWidth : opts.lineDecorationsWidth),\r\n            readOnly: _boolean(opts.readOnly, defaults.readOnly),\r\n            mouseStyle: _stringSet(opts.mouseStyle, defaults.mouseStyle, ['text', 'default', 'copy']),\r\n            disableLayerHinting: _boolean(opts.disableLayerHinting, defaults.disableLayerHinting),\r\n            automaticLayout: _boolean(opts.automaticLayout, defaults.automaticLayout),\r\n            wordWrap: wordWrap,\r\n            wordWrapColumn: _clampedInt(opts.wordWrapColumn, defaults.wordWrapColumn, 1, 1073741824 /* MAX_SAFE_SMALL_INTEGER */),\r\n            wordWrapMinified: _boolean(opts.wordWrapMinified, defaults.wordWrapMinified),\r\n            wrappingIndent: _wrappingIndentFromString(opts.wrappingIndent, defaults.wrappingIndent),\r\n            wordWrapBreakBeforeCharacters: _string(opts.wordWrapBreakBeforeCharacters, defaults.wordWrapBreakBeforeCharacters),\r\n            wordWrapBreakAfterCharacters: _string(opts.wordWrapBreakAfterCharacters, defaults.wordWrapBreakAfterCharacters),\r\n            wordWrapBreakObtrusiveCharacters: _string(opts.wordWrapBreakObtrusiveCharacters, defaults.wordWrapBreakObtrusiveCharacters),\r\n            autoClosingBrackets: autoClosingBrackets,\r\n            autoClosingQuotes: autoClosingQuotes,\r\n            autoSurround: autoSurround,\r\n            autoIndent: _boolean(opts.autoIndent, defaults.autoIndent),\r\n            dragAndDrop: _boolean(opts.dragAndDrop, defaults.dragAndDrop),\r\n            emptySelectionClipboard: _boolean(opts.emptySelectionClipboard, defaults.emptySelectionClipboard),\r\n            copyWithSyntaxHighlighting: _boolean(opts.copyWithSyntaxHighlighting, defaults.copyWithSyntaxHighlighting),\r\n            useTabStops: _boolean(opts.useTabStops, defaults.useTabStops),\r\n            multiCursorModifier: multiCursorModifier,\r\n            multiCursorMergeOverlapping: _boolean(opts.multiCursorMergeOverlapping, defaults.multiCursorMergeOverlapping),\r\n            accessibilitySupport: _stringSet(opts.accessibilitySupport, defaults.accessibilitySupport, ['auto', 'on', 'off']),\r\n            showUnused: _boolean(opts.showUnused, defaults.showUnused),\r\n            viewInfo: viewInfo,\r\n            contribInfo: contribInfo,\r\n        };\r\n    };\r\n    EditorOptionsValidator._sanitizeScrollbarOpts = function (opts, defaults, mouseWheelScrollSensitivity) {\r\n        if (typeof opts !== 'object') {\r\n            return defaults;\r\n        }\r\n        var horizontalScrollbarSize = _clampedInt(opts.horizontalScrollbarSize, defaults.horizontalScrollbarSize, 0, 1000);\r\n        var verticalScrollbarSize = _clampedInt(opts.verticalScrollbarSize, defaults.verticalScrollbarSize, 0, 1000);\r\n        return {\r\n            vertical: _scrollbarVisibilityFromString(opts.vertical, defaults.vertical),\r\n            horizontal: _scrollbarVisibilityFromString(opts.horizontal, defaults.horizontal),\r\n            arrowSize: _clampedInt(opts.arrowSize, defaults.arrowSize, 0, 1000),\r\n            useShadows: _boolean(opts.useShadows, defaults.useShadows),\r\n            verticalHasArrows: _boolean(opts.verticalHasArrows, defaults.verticalHasArrows),\r\n            horizontalHasArrows: _boolean(opts.horizontalHasArrows, defaults.horizontalHasArrows),\r\n            horizontalScrollbarSize: horizontalScrollbarSize,\r\n            horizontalSliderSize: _clampedInt(opts.horizontalSliderSize, horizontalScrollbarSize, 0, 1000),\r\n            verticalScrollbarSize: verticalScrollbarSize,\r\n            verticalSliderSize: _clampedInt(opts.verticalSliderSize, verticalScrollbarSize, 0, 1000),\r\n            handleMouseWheel: _boolean(opts.handleMouseWheel, defaults.handleMouseWheel),\r\n            mouseWheelScrollSensitivity: mouseWheelScrollSensitivity\r\n        };\r\n    };\r\n    EditorOptionsValidator._sanitizeMinimapOpts = function (opts, defaults) {\r\n        if (typeof opts !== 'object') {\r\n            return defaults;\r\n        }\r\n        return {\r\n            enabled: _boolean(opts.enabled, defaults.enabled),\r\n            side: _stringSet(opts.side, defaults.side, ['right', 'left']),\r\n            showSlider: _stringSet(opts.showSlider, defaults.showSlider, ['always', 'mouseover']),\r\n            renderCharacters: _boolean(opts.renderCharacters, defaults.renderCharacters),\r\n            maxColumn: _clampedInt(opts.maxColumn, defaults.maxColumn, 1, 10000),\r\n        };\r\n    };\r\n    EditorOptionsValidator._santizeFindOpts = function (opts, defaults) {\r\n        if (typeof opts !== 'object') {\r\n            return defaults;\r\n        }\r\n        return {\r\n            seedSearchStringFromSelection: _boolean(opts.seedSearchStringFromSelection, defaults.seedSearchStringFromSelection),\r\n            autoFindInSelection: _boolean(opts.autoFindInSelection, defaults.autoFindInSelection),\r\n            globalFindClipboard: _boolean(opts.globalFindClipboard, defaults.globalFindClipboard)\r\n        };\r\n    };\r\n    EditorOptionsValidator._sanitizeParameterHintOpts = function (opts, defaults) {\r\n        if (typeof opts !== 'object') {\r\n            return defaults;\r\n        }\r\n        return {\r\n            enabled: _boolean(opts.enabled, defaults.enabled),\r\n            cycle: _boolean(opts.cycle, defaults.cycle)\r\n        };\r\n    };\r\n    EditorOptionsValidator._santizeHoverOpts = function (_opts, defaults) {\r\n        var opts;\r\n        if (typeof _opts === 'boolean') {\r\n            opts = {\r\n                enabled: _opts\r\n            };\r\n        }\r\n        else if (typeof _opts === 'object') {\r\n            opts = _opts;\r\n        }\r\n        else {\r\n            return defaults;\r\n        }\r\n        return {\r\n            enabled: _boolean(opts.enabled, defaults.enabled),\r\n            delay: _clampedInt(opts.delay, defaults.delay, 0, 10000),\r\n            sticky: _boolean(opts.sticky, defaults.sticky)\r\n        };\r\n    };\r\n    EditorOptionsValidator._sanitizeSuggestOpts = function (opts, defaults) {\r\n        var suggestOpts = opts.suggest || {};\r\n        return {\r\n            filterGraceful: _boolean(suggestOpts.filterGraceful, defaults.filterGraceful),\r\n            snippets: _stringSet(opts.snippetSuggestions, defaults.snippets, ['top', 'bottom', 'inline', 'none']),\r\n            snippetsPreventQuickSuggestions: _boolean(suggestOpts.snippetsPreventQuickSuggestions, defaults.filterGraceful),\r\n            localityBonus: _boolean(suggestOpts.localityBonus, defaults.localityBonus),\r\n        };\r\n    };\r\n    EditorOptionsValidator._sanitizeTabCompletionOpts = function (opts, defaults) {\r\n        if (opts === false) {\r\n            return 'off';\r\n        }\r\n        else if (opts === true) {\r\n            return 'onlySnippets';\r\n        }\r\n        else {\r\n            return _stringSet(opts, defaults, ['on', 'off', 'onlySnippets']);\r\n        }\r\n    };\r\n    EditorOptionsValidator._sanitizeViewInfo = function (opts, defaults) {\r\n        var rulers = [];\r\n        if (Array.isArray(opts.rulers)) {\r\n            for (var i = 0, len = opts.rulers.length; i < len; i++) {\r\n                rulers.push(_clampedInt(opts.rulers[i], 0, 0, 10000));\r\n            }\r\n            rulers.sort();\r\n        }\r\n        var renderLineNumbers = defaults.renderLineNumbers;\r\n        var renderCustomLineNumbers = defaults.renderCustomLineNumbers;\r\n        if (typeof opts.lineNumbers !== 'undefined') {\r\n            var lineNumbers = opts.lineNumbers;\r\n            // Compatibility with old true or false values\r\n            if (lineNumbers === true) {\r\n                lineNumbers = 'on';\r\n            }\r\n            else if (lineNumbers === false) {\r\n                lineNumbers = 'off';\r\n            }\r\n            if (typeof lineNumbers === 'function') {\r\n                renderLineNumbers = 4 /* Custom */;\r\n                renderCustomLineNumbers = lineNumbers;\r\n            }\r\n            else if (lineNumbers === 'interval') {\r\n                renderLineNumbers = 3 /* Interval */;\r\n            }\r\n            else if (lineNumbers === 'relative') {\r\n                renderLineNumbers = 2 /* Relative */;\r\n            }\r\n            else if (lineNumbers === 'on') {\r\n                renderLineNumbers = 1 /* On */;\r\n            }\r\n            else {\r\n                renderLineNumbers = 0 /* Off */;\r\n            }\r\n        }\r\n        var fontLigatures = _boolean(opts.fontLigatures, defaults.fontLigatures);\r\n        var disableMonospaceOptimizations = _boolean(opts.disableMonospaceOptimizations, defaults.disableMonospaceOptimizations) || fontLigatures;\r\n        var renderWhitespace = opts.renderWhitespace;\r\n        {\r\n            // Compatibility with old true or false values\r\n            if (renderWhitespace === true) {\r\n                renderWhitespace = 'boundary';\r\n            }\r\n            else if (renderWhitespace === false) {\r\n                renderWhitespace = 'none';\r\n            }\r\n            renderWhitespace = _stringSet(opts.renderWhitespace, defaults.renderWhitespace, ['none', 'boundary', 'all']);\r\n        }\r\n        var renderLineHighlight = opts.renderLineHighlight;\r\n        {\r\n            // Compatibility with old true or false values\r\n            if (renderLineHighlight === true) {\r\n                renderLineHighlight = 'line';\r\n            }\r\n            else if (renderLineHighlight === false) {\r\n                renderLineHighlight = 'none';\r\n            }\r\n            renderLineHighlight = _stringSet(opts.renderLineHighlight, defaults.renderLineHighlight, ['none', 'gutter', 'line', 'all']);\r\n        }\r\n        var mouseWheelScrollSensitivity = _float(opts.mouseWheelScrollSensitivity, defaults.scrollbar.mouseWheelScrollSensitivity);\r\n        if (mouseWheelScrollSensitivity === 0) {\r\n            // Disallow 0, as it would prevent/block scrolling\r\n            mouseWheelScrollSensitivity = 1;\r\n        }\r\n        var scrollbar = this._sanitizeScrollbarOpts(opts.scrollbar, defaults.scrollbar, mouseWheelScrollSensitivity);\r\n        var minimap = this._sanitizeMinimapOpts(opts.minimap, defaults.minimap);\r\n        return {\r\n            extraEditorClassName: _string(opts.extraEditorClassName, defaults.extraEditorClassName),\r\n            disableMonospaceOptimizations: disableMonospaceOptimizations,\r\n            rulers: rulers,\r\n            ariaLabel: _string(opts.ariaLabel, defaults.ariaLabel),\r\n            renderLineNumbers: renderLineNumbers,\r\n            renderCustomLineNumbers: renderCustomLineNumbers,\r\n            selectOnLineNumbers: _boolean(opts.selectOnLineNumbers, defaults.selectOnLineNumbers),\r\n            glyphMargin: _boolean(opts.glyphMargin, defaults.glyphMargin),\r\n            revealHorizontalRightPadding: _clampedInt(opts.revealHorizontalRightPadding, defaults.revealHorizontalRightPadding, 0, 1000),\r\n            roundedSelection: _boolean(opts.roundedSelection, defaults.roundedSelection),\r\n            overviewRulerLanes: _clampedInt(opts.overviewRulerLanes, defaults.overviewRulerLanes, 0, 3),\r\n            overviewRulerBorder: _boolean(opts.overviewRulerBorder, defaults.overviewRulerBorder),\r\n            cursorBlinking: _cursorBlinkingStyleFromString(opts.cursorBlinking, defaults.cursorBlinking),\r\n            mouseWheelZoom: _boolean(opts.mouseWheelZoom, defaults.mouseWheelZoom),\r\n            cursorStyle: _cursorStyleFromString(opts.cursorStyle, defaults.cursorStyle),\r\n            cursorWidth: _clampedInt(opts.cursorWidth, defaults.cursorWidth, 0, Number.MAX_VALUE),\r\n            hideCursorInOverviewRuler: _boolean(opts.hideCursorInOverviewRuler, defaults.hideCursorInOverviewRuler),\r\n            scrollBeyondLastLine: _boolean(opts.scrollBeyondLastLine, defaults.scrollBeyondLastLine),\r\n            scrollBeyondLastColumn: _clampedInt(opts.scrollBeyondLastColumn, defaults.scrollBeyondLastColumn, 0, 1073741824 /* MAX_SAFE_SMALL_INTEGER */),\r\n            smoothScrolling: _boolean(opts.smoothScrolling, defaults.smoothScrolling),\r\n            stopRenderingLineAfter: _clampedInt(opts.stopRenderingLineAfter, defaults.stopRenderingLineAfter, -1, 1073741824 /* MAX_SAFE_SMALL_INTEGER */),\r\n            renderWhitespace: renderWhitespace,\r\n            renderControlCharacters: _boolean(opts.renderControlCharacters, defaults.renderControlCharacters),\r\n            fontLigatures: fontLigatures,\r\n            renderIndentGuides: _boolean(opts.renderIndentGuides, defaults.renderIndentGuides),\r\n            highlightActiveIndentGuide: _boolean(opts.highlightActiveIndentGuide, defaults.highlightActiveIndentGuide),\r\n            renderLineHighlight: renderLineHighlight,\r\n            scrollbar: scrollbar,\r\n            minimap: minimap,\r\n            fixedOverflowWidgets: _boolean(opts.fixedOverflowWidgets, defaults.fixedOverflowWidgets),\r\n        };\r\n    };\r\n    EditorOptionsValidator._sanitizeContribInfo = function (opts, defaults) {\r\n        var quickSuggestions;\r\n        if (typeof opts.quickSuggestions === 'object') {\r\n            quickSuggestions = __assign({ other: true }, opts.quickSuggestions);\r\n        }\r\n        else {\r\n            quickSuggestions = _boolean(opts.quickSuggestions, defaults.quickSuggestions);\r\n        }\r\n        // Compatibility support for acceptSuggestionOnEnter\r\n        if (typeof opts.acceptSuggestionOnEnter === 'boolean') {\r\n            opts.acceptSuggestionOnEnter = opts.acceptSuggestionOnEnter ? 'on' : 'off';\r\n        }\r\n        var find = this._santizeFindOpts(opts.find, defaults.find);\r\n        return {\r\n            selectionClipboard: _boolean(opts.selectionClipboard, defaults.selectionClipboard),\r\n            hover: this._santizeHoverOpts(opts.hover, defaults.hover),\r\n            links: _boolean(opts.links, defaults.links),\r\n            contextmenu: _boolean(opts.contextmenu, defaults.contextmenu),\r\n            quickSuggestions: quickSuggestions,\r\n            quickSuggestionsDelay: _clampedInt(opts.quickSuggestionsDelay, defaults.quickSuggestionsDelay, -1073741824 /* MIN_SAFE_SMALL_INTEGER */, 1073741824 /* MAX_SAFE_SMALL_INTEGER */),\r\n            parameterHints: this._sanitizeParameterHintOpts(opts.parameterHints, defaults.parameterHints),\r\n            iconsInSuggestions: _boolean(opts.iconsInSuggestions, defaults.iconsInSuggestions),\r\n            formatOnType: _boolean(opts.formatOnType, defaults.formatOnType),\r\n            formatOnPaste: _boolean(opts.formatOnPaste, defaults.formatOnPaste),\r\n            suggestOnTriggerCharacters: _boolean(opts.suggestOnTriggerCharacters, defaults.suggestOnTriggerCharacters),\r\n            acceptSuggestionOnEnter: _stringSet(opts.acceptSuggestionOnEnter, defaults.acceptSuggestionOnEnter, ['on', 'smart', 'off']),\r\n            acceptSuggestionOnCommitCharacter: _boolean(opts.acceptSuggestionOnCommitCharacter, defaults.acceptSuggestionOnCommitCharacter),\r\n            wordBasedSuggestions: _boolean(opts.wordBasedSuggestions, defaults.wordBasedSuggestions),\r\n            suggestSelection: _stringSet(opts.suggestSelection, defaults.suggestSelection, ['first', 'recentlyUsed', 'recentlyUsedByPrefix']),\r\n            suggestFontSize: _clampedInt(opts.suggestFontSize, defaults.suggestFontSize, 0, 1000),\r\n            suggestLineHeight: _clampedInt(opts.suggestLineHeight, defaults.suggestLineHeight, 0, 1000),\r\n            tabCompletion: this._sanitizeTabCompletionOpts(opts.tabCompletion, defaults.tabCompletion),\r\n            suggest: this._sanitizeSuggestOpts(opts, defaults.suggest),\r\n            selectionHighlight: _boolean(opts.selectionHighlight, defaults.selectionHighlight),\r\n            occurrencesHighlight: _boolean(opts.occurrencesHighlight, defaults.occurrencesHighlight),\r\n            codeLens: _boolean(opts.codeLens, defaults.codeLens),\r\n            folding: _boolean(opts.folding, defaults.folding),\r\n            foldingStrategy: _stringSet(opts.foldingStrategy, defaults.foldingStrategy, ['auto', 'indentation']),\r\n            showFoldingControls: _stringSet(opts.showFoldingControls, defaults.showFoldingControls, ['always', 'mouseover']),\r\n            matchBrackets: _boolean(opts.matchBrackets, defaults.matchBrackets),\r\n            find: find,\r\n            colorDecorators: _boolean(opts.colorDecorators, defaults.colorDecorators),\r\n            lightbulbEnabled: _boolean(opts.lightbulb ? opts.lightbulb.enabled : false, defaults.lightbulbEnabled),\r\n            codeActionsOnSave: _booleanMap(opts.codeActionsOnSave, {}),\r\n            codeActionsOnSaveTimeout: _clampedInt(opts.codeActionsOnSaveTimeout, defaults.codeActionsOnSaveTimeout, 1, 10000)\r\n        };\r\n    };\r\n    return EditorOptionsValidator;\r\n}());\r\nexport { EditorOptionsValidator };\r\n/**\r\n * @internal\r\n */\r\nvar InternalEditorOptionsFactory = /** @class */ (function () {\r\n    function InternalEditorOptionsFactory() {\r\n    }\r\n    InternalEditorOptionsFactory._tweakValidatedOptions = function (opts, accessibilitySupport) {\r\n        var accessibilityIsOn = (accessibilitySupport === 2 /* Enabled */);\r\n        var accessibilityIsOff = (accessibilitySupport === 1 /* Disabled */);\r\n        return {\r\n            inDiffEditor: opts.inDiffEditor,\r\n            wordSeparators: opts.wordSeparators,\r\n            lineNumbersMinChars: opts.lineNumbersMinChars,\r\n            lineDecorationsWidth: opts.lineDecorationsWidth,\r\n            readOnly: opts.readOnly,\r\n            mouseStyle: opts.mouseStyle,\r\n            disableLayerHinting: opts.disableLayerHinting,\r\n            automaticLayout: opts.automaticLayout,\r\n            wordWrap: opts.wordWrap,\r\n            wordWrapColumn: opts.wordWrapColumn,\r\n            wordWrapMinified: opts.wordWrapMinified,\r\n            wrappingIndent: opts.wrappingIndent,\r\n            wordWrapBreakBeforeCharacters: opts.wordWrapBreakBeforeCharacters,\r\n            wordWrapBreakAfterCharacters: opts.wordWrapBreakAfterCharacters,\r\n            wordWrapBreakObtrusiveCharacters: opts.wordWrapBreakObtrusiveCharacters,\r\n            autoClosingBrackets: opts.autoClosingBrackets,\r\n            autoClosingQuotes: opts.autoClosingQuotes,\r\n            autoSurround: opts.autoSurround,\r\n            autoIndent: opts.autoIndent,\r\n            dragAndDrop: opts.dragAndDrop,\r\n            emptySelectionClipboard: opts.emptySelectionClipboard,\r\n            copyWithSyntaxHighlighting: opts.copyWithSyntaxHighlighting,\r\n            useTabStops: opts.useTabStops,\r\n            multiCursorModifier: opts.multiCursorModifier,\r\n            multiCursorMergeOverlapping: opts.multiCursorMergeOverlapping,\r\n            accessibilitySupport: opts.accessibilitySupport,\r\n            showUnused: opts.showUnused,\r\n            viewInfo: {\r\n                extraEditorClassName: opts.viewInfo.extraEditorClassName,\r\n                disableMonospaceOptimizations: opts.viewInfo.disableMonospaceOptimizations,\r\n                rulers: opts.viewInfo.rulers,\r\n                ariaLabel: (accessibilityIsOff ? nls.localize('accessibilityOffAriaLabel', \"The editor is not accessible at this time. Press Alt+F1 for options.\") : opts.viewInfo.ariaLabel),\r\n                renderLineNumbers: opts.viewInfo.renderLineNumbers,\r\n                renderCustomLineNumbers: opts.viewInfo.renderCustomLineNumbers,\r\n                selectOnLineNumbers: opts.viewInfo.selectOnLineNumbers,\r\n                glyphMargin: opts.viewInfo.glyphMargin,\r\n                revealHorizontalRightPadding: opts.viewInfo.revealHorizontalRightPadding,\r\n                roundedSelection: (accessibilityIsOn ? false : opts.viewInfo.roundedSelection),\r\n                overviewRulerLanes: opts.viewInfo.overviewRulerLanes,\r\n                overviewRulerBorder: opts.viewInfo.overviewRulerBorder,\r\n                cursorBlinking: opts.viewInfo.cursorBlinking,\r\n                mouseWheelZoom: opts.viewInfo.mouseWheelZoom,\r\n                cursorStyle: opts.viewInfo.cursorStyle,\r\n                cursorWidth: opts.viewInfo.cursorWidth,\r\n                hideCursorInOverviewRuler: opts.viewInfo.hideCursorInOverviewRuler,\r\n                scrollBeyondLastLine: opts.viewInfo.scrollBeyondLastLine,\r\n                scrollBeyondLastColumn: opts.viewInfo.scrollBeyondLastColumn,\r\n                smoothScrolling: opts.viewInfo.smoothScrolling,\r\n                stopRenderingLineAfter: opts.viewInfo.stopRenderingLineAfter,\r\n                renderWhitespace: (accessibilityIsOn ? 'none' : opts.viewInfo.renderWhitespace),\r\n                renderControlCharacters: (accessibilityIsOn ? false : opts.viewInfo.renderControlCharacters),\r\n                fontLigatures: (accessibilityIsOn ? false : opts.viewInfo.fontLigatures),\r\n                renderIndentGuides: (accessibilityIsOn ? false : opts.viewInfo.renderIndentGuides),\r\n                highlightActiveIndentGuide: opts.viewInfo.highlightActiveIndentGuide,\r\n                renderLineHighlight: opts.viewInfo.renderLineHighlight,\r\n                scrollbar: opts.viewInfo.scrollbar,\r\n                minimap: {\r\n                    enabled: (accessibilityIsOn ? false : opts.viewInfo.minimap.enabled),\r\n                    side: opts.viewInfo.minimap.side,\r\n                    renderCharacters: opts.viewInfo.minimap.renderCharacters,\r\n                    showSlider: opts.viewInfo.minimap.showSlider,\r\n                    maxColumn: opts.viewInfo.minimap.maxColumn\r\n                },\r\n                fixedOverflowWidgets: opts.viewInfo.fixedOverflowWidgets\r\n            },\r\n            contribInfo: {\r\n                selectionClipboard: opts.contribInfo.selectionClipboard,\r\n                hover: opts.contribInfo.hover,\r\n                links: (accessibilityIsOn ? false : opts.contribInfo.links),\r\n                contextmenu: opts.contribInfo.contextmenu,\r\n                quickSuggestions: opts.contribInfo.quickSuggestions,\r\n                quickSuggestionsDelay: opts.contribInfo.quickSuggestionsDelay,\r\n                parameterHints: opts.contribInfo.parameterHints,\r\n                iconsInSuggestions: opts.contribInfo.iconsInSuggestions,\r\n                formatOnType: opts.contribInfo.formatOnType,\r\n                formatOnPaste: opts.contribInfo.formatOnPaste,\r\n                suggestOnTriggerCharacters: opts.contribInfo.suggestOnTriggerCharacters,\r\n                acceptSuggestionOnEnter: opts.contribInfo.acceptSuggestionOnEnter,\r\n                acceptSuggestionOnCommitCharacter: opts.contribInfo.acceptSuggestionOnCommitCharacter,\r\n                wordBasedSuggestions: opts.contribInfo.wordBasedSuggestions,\r\n                suggestSelection: opts.contribInfo.suggestSelection,\r\n                suggestFontSize: opts.contribInfo.suggestFontSize,\r\n                suggestLineHeight: opts.contribInfo.suggestLineHeight,\r\n                tabCompletion: opts.contribInfo.tabCompletion,\r\n                suggest: opts.contribInfo.suggest,\r\n                selectionHighlight: (accessibilityIsOn ? false : opts.contribInfo.selectionHighlight),\r\n                occurrencesHighlight: (accessibilityIsOn ? false : opts.contribInfo.occurrencesHighlight),\r\n                codeLens: (accessibilityIsOn ? false : opts.contribInfo.codeLens),\r\n                folding: (accessibilityIsOn ? false : opts.contribInfo.folding),\r\n                foldingStrategy: opts.contribInfo.foldingStrategy,\r\n                showFoldingControls: opts.contribInfo.showFoldingControls,\r\n                matchBrackets: (accessibilityIsOn ? false : opts.contribInfo.matchBrackets),\r\n                find: opts.contribInfo.find,\r\n                colorDecorators: opts.contribInfo.colorDecorators,\r\n                lightbulbEnabled: opts.contribInfo.lightbulbEnabled,\r\n                codeActionsOnSave: opts.contribInfo.codeActionsOnSave,\r\n                codeActionsOnSaveTimeout: opts.contribInfo.codeActionsOnSaveTimeout\r\n            }\r\n        };\r\n    };\r\n    InternalEditorOptionsFactory.createInternalEditorOptions = function (env, _opts) {\r\n        var accessibilitySupport;\r\n        if (_opts.accessibilitySupport === 'auto') {\r\n            // The editor reads the `accessibilitySupport` from the environment\r\n            accessibilitySupport = env.accessibilitySupport;\r\n        }\r\n        else if (_opts.accessibilitySupport === 'on') {\r\n            accessibilitySupport = 2 /* Enabled */;\r\n        }\r\n        else {\r\n            accessibilitySupport = 1 /* Disabled */;\r\n        }\r\n        // Disable some non critical features to get as best performance as possible\r\n        // See https://github.com/Microsoft/vscode/issues/26730\r\n        var opts = this._tweakValidatedOptions(_opts, accessibilitySupport);\r\n        var lineDecorationsWidth;\r\n        if (typeof opts.lineDecorationsWidth === 'string' && /^\\d+(\\.\\d+)?ch$/.test(opts.lineDecorationsWidth)) {\r\n            var multiple = parseFloat(opts.lineDecorationsWidth.substr(0, opts.lineDecorationsWidth.length - 2));\r\n            lineDecorationsWidth = multiple * env.fontInfo.typicalHalfwidthCharacterWidth;\r\n        }\r\n        else {\r\n            lineDecorationsWidth = _clampedInt(opts.lineDecorationsWidth, 0, 0, 1000);\r\n        }\r\n        if (opts.contribInfo.folding) {\r\n            lineDecorationsWidth += 16;\r\n        }\r\n        var layoutInfo = EditorLayoutProvider.compute({\r\n            outerWidth: env.outerWidth,\r\n            outerHeight: env.outerHeight,\r\n            showGlyphMargin: opts.viewInfo.glyphMargin,\r\n            lineHeight: env.fontInfo.lineHeight,\r\n            showLineNumbers: (opts.viewInfo.renderLineNumbers !== 0 /* Off */),\r\n            lineNumbersMinChars: opts.lineNumbersMinChars,\r\n            lineNumbersDigitCount: env.lineNumbersDigitCount,\r\n            lineDecorationsWidth: lineDecorationsWidth,\r\n            typicalHalfwidthCharacterWidth: env.fontInfo.typicalHalfwidthCharacterWidth,\r\n            maxDigitWidth: env.fontInfo.maxDigitWidth,\r\n            verticalScrollbarWidth: opts.viewInfo.scrollbar.verticalScrollbarSize,\r\n            horizontalScrollbarHeight: opts.viewInfo.scrollbar.horizontalScrollbarSize,\r\n            scrollbarArrowSize: opts.viewInfo.scrollbar.arrowSize,\r\n            verticalScrollbarHasArrows: opts.viewInfo.scrollbar.verticalHasArrows,\r\n            minimap: opts.viewInfo.minimap.enabled,\r\n            minimapSide: opts.viewInfo.minimap.side,\r\n            minimapRenderCharacters: opts.viewInfo.minimap.renderCharacters,\r\n            minimapMaxColumn: opts.viewInfo.minimap.maxColumn,\r\n            pixelRatio: env.pixelRatio\r\n        });\r\n        var bareWrappingInfo = null;\r\n        {\r\n            var wordWrap = opts.wordWrap;\r\n            var wordWrapColumn = opts.wordWrapColumn;\r\n            var wordWrapMinified = opts.wordWrapMinified;\r\n            if (accessibilitySupport === 2 /* Enabled */) {\r\n                // See https://github.com/Microsoft/vscode/issues/27766\r\n                // Never enable wrapping when a screen reader is attached\r\n                // because arrow down etc. will not move the cursor in the way\r\n                // a screen reader expects.\r\n                bareWrappingInfo = {\r\n                    isWordWrapMinified: false,\r\n                    isViewportWrapping: false,\r\n                    wrappingColumn: -1\r\n                };\r\n            }\r\n            else if (wordWrapMinified && env.isDominatedByLongLines) {\r\n                // Force viewport width wrapping if model is dominated by long lines\r\n                bareWrappingInfo = {\r\n                    isWordWrapMinified: true,\r\n                    isViewportWrapping: true,\r\n                    wrappingColumn: Math.max(1, layoutInfo.viewportColumn)\r\n                };\r\n            }\r\n            else if (wordWrap === 'on') {\r\n                bareWrappingInfo = {\r\n                    isWordWrapMinified: false,\r\n                    isViewportWrapping: true,\r\n                    wrappingColumn: Math.max(1, layoutInfo.viewportColumn)\r\n                };\r\n            }\r\n            else if (wordWrap === 'bounded') {\r\n                bareWrappingInfo = {\r\n                    isWordWrapMinified: false,\r\n                    isViewportWrapping: true,\r\n                    wrappingColumn: Math.min(Math.max(1, layoutInfo.viewportColumn), wordWrapColumn)\r\n                };\r\n            }\r\n            else if (wordWrap === 'wordWrapColumn') {\r\n                bareWrappingInfo = {\r\n                    isWordWrapMinified: false,\r\n                    isViewportWrapping: false,\r\n                    wrappingColumn: wordWrapColumn\r\n                };\r\n            }\r\n            else {\r\n                bareWrappingInfo = {\r\n                    isWordWrapMinified: false,\r\n                    isViewportWrapping: false,\r\n                    wrappingColumn: -1\r\n                };\r\n            }\r\n        }\r\n        var wrappingInfo = {\r\n            inDiffEditor: opts.inDiffEditor,\r\n            isDominatedByLongLines: env.isDominatedByLongLines,\r\n            isWordWrapMinified: bareWrappingInfo.isWordWrapMinified,\r\n            isViewportWrapping: bareWrappingInfo.isViewportWrapping,\r\n            wrappingColumn: bareWrappingInfo.wrappingColumn,\r\n            wrappingIndent: opts.wrappingIndent,\r\n            wordWrapBreakBeforeCharacters: opts.wordWrapBreakBeforeCharacters,\r\n            wordWrapBreakAfterCharacters: opts.wordWrapBreakAfterCharacters,\r\n            wordWrapBreakObtrusiveCharacters: opts.wordWrapBreakObtrusiveCharacters,\r\n        };\r\n        var className = 'monaco-editor';\r\n        if (opts.viewInfo.extraEditorClassName) {\r\n            className += ' ' + opts.viewInfo.extraEditorClassName;\r\n        }\r\n        if (env.extraEditorClassName) {\r\n            className += ' ' + env.extraEditorClassName;\r\n        }\r\n        if (opts.viewInfo.fontLigatures) {\r\n            className += ' enable-ligatures';\r\n        }\r\n        if (opts.mouseStyle === 'default') {\r\n            className += ' mouse-default';\r\n        }\r\n        else if (opts.mouseStyle === 'copy') {\r\n            className += ' mouse-copy';\r\n        }\r\n        return new InternalEditorOptions({\r\n            canUseLayerHinting: opts.disableLayerHinting ? false : true,\r\n            pixelRatio: env.pixelRatio,\r\n            editorClassName: className,\r\n            lineHeight: env.fontInfo.lineHeight,\r\n            readOnly: opts.readOnly,\r\n            accessibilitySupport: accessibilitySupport,\r\n            multiCursorModifier: opts.multiCursorModifier,\r\n            multiCursorMergeOverlapping: opts.multiCursorMergeOverlapping,\r\n            wordSeparators: opts.wordSeparators,\r\n            autoClosingBrackets: opts.autoClosingBrackets,\r\n            autoClosingQuotes: opts.autoClosingQuotes,\r\n            autoSurround: opts.autoSurround,\r\n            autoIndent: opts.autoIndent,\r\n            useTabStops: opts.useTabStops,\r\n            tabFocusMode: opts.readOnly ? true : env.tabFocusMode,\r\n            dragAndDrop: opts.dragAndDrop,\r\n            emptySelectionClipboard: opts.emptySelectionClipboard && env.emptySelectionClipboard,\r\n            copyWithSyntaxHighlighting: opts.copyWithSyntaxHighlighting,\r\n            layoutInfo: layoutInfo,\r\n            fontInfo: env.fontInfo,\r\n            viewInfo: opts.viewInfo,\r\n            wrappingInfo: wrappingInfo,\r\n            contribInfo: opts.contribInfo,\r\n            showUnused: opts.showUnused,\r\n        });\r\n    };\r\n    return InternalEditorOptionsFactory;\r\n}());\r\nexport { InternalEditorOptionsFactory };\r\n/**\r\n * @internal\r\n */\r\nvar EditorLayoutProvider = /** @class */ (function () {\r\n    function EditorLayoutProvider() {\r\n    }\r\n    EditorLayoutProvider.compute = function (_opts) {\r\n        var outerWidth = _opts.outerWidth | 0;\r\n        var outerHeight = _opts.outerHeight | 0;\r\n        var showGlyphMargin = _opts.showGlyphMargin;\r\n        var lineHeight = _opts.lineHeight | 0;\r\n        var showLineNumbers = _opts.showLineNumbers;\r\n        var lineNumbersMinChars = _opts.lineNumbersMinChars | 0;\r\n        var lineNumbersDigitCount = _opts.lineNumbersDigitCount | 0;\r\n        var lineDecorationsWidth = _opts.lineDecorationsWidth | 0;\r\n        var typicalHalfwidthCharacterWidth = _opts.typicalHalfwidthCharacterWidth;\r\n        var maxDigitWidth = _opts.maxDigitWidth;\r\n        var verticalScrollbarWidth = _opts.verticalScrollbarWidth | 0;\r\n        var verticalScrollbarHasArrows = _opts.verticalScrollbarHasArrows;\r\n        var scrollbarArrowSize = _opts.scrollbarArrowSize | 0;\r\n        var horizontalScrollbarHeight = _opts.horizontalScrollbarHeight | 0;\r\n        var minimap = _opts.minimap;\r\n        var minimapSide = _opts.minimapSide;\r\n        var minimapRenderCharacters = _opts.minimapRenderCharacters;\r\n        var minimapMaxColumn = _opts.minimapMaxColumn | 0;\r\n        var pixelRatio = _opts.pixelRatio;\r\n        var lineNumbersWidth = 0;\r\n        if (showLineNumbers) {\r\n            var digitCount = Math.max(lineNumbersDigitCount, lineNumbersMinChars);\r\n            lineNumbersWidth = Math.round(digitCount * maxDigitWidth);\r\n        }\r\n        var glyphMarginWidth = 0;\r\n        if (showGlyphMargin) {\r\n            glyphMarginWidth = lineHeight;\r\n        }\r\n        var glyphMarginLeft = 0;\r\n        var lineNumbersLeft = glyphMarginLeft + glyphMarginWidth;\r\n        var decorationsLeft = lineNumbersLeft + lineNumbersWidth;\r\n        var contentLeft = decorationsLeft + lineDecorationsWidth;\r\n        var remainingWidth = outerWidth - glyphMarginWidth - lineNumbersWidth - lineDecorationsWidth;\r\n        var renderMinimap;\r\n        var minimapLeft;\r\n        var minimapWidth;\r\n        var contentWidth;\r\n        if (!minimap) {\r\n            minimapLeft = 0;\r\n            minimapWidth = 0;\r\n            renderMinimap = 0 /* None */;\r\n            contentWidth = remainingWidth;\r\n        }\r\n        else {\r\n            var minimapCharWidth = void 0;\r\n            if (pixelRatio >= 2) {\r\n                renderMinimap = minimapRenderCharacters ? 2 /* Large */ : 4 /* LargeBlocks */;\r\n                minimapCharWidth = 2 / pixelRatio;\r\n            }\r\n            else {\r\n                renderMinimap = minimapRenderCharacters ? 1 /* Small */ : 3 /* SmallBlocks */;\r\n                minimapCharWidth = 1 / pixelRatio;\r\n            }\r\n            // Given:\r\n            // (leaving 2px for the cursor to have space after the last character)\r\n            // viewportColumn = (contentWidth - verticalScrollbarWidth - 2) / typicalHalfwidthCharacterWidth\r\n            // minimapWidth = viewportColumn * minimapCharWidth\r\n            // contentWidth = remainingWidth - minimapWidth\r\n            // What are good values for contentWidth and minimapWidth ?\r\n            // minimapWidth = ((contentWidth - verticalScrollbarWidth - 2) / typicalHalfwidthCharacterWidth) * minimapCharWidth\r\n            // typicalHalfwidthCharacterWidth * minimapWidth = (contentWidth - verticalScrollbarWidth - 2) * minimapCharWidth\r\n            // typicalHalfwidthCharacterWidth * minimapWidth = (remainingWidth - minimapWidth - verticalScrollbarWidth - 2) * minimapCharWidth\r\n            // (typicalHalfwidthCharacterWidth + minimapCharWidth) * minimapWidth = (remainingWidth - verticalScrollbarWidth - 2) * minimapCharWidth\r\n            // minimapWidth = ((remainingWidth - verticalScrollbarWidth - 2) * minimapCharWidth) / (typicalHalfwidthCharacterWidth + minimapCharWidth)\r\n            minimapWidth = Math.max(0, Math.floor(((remainingWidth - verticalScrollbarWidth - 2) * minimapCharWidth) / (typicalHalfwidthCharacterWidth + minimapCharWidth)));\r\n            var minimapColumns = minimapWidth / minimapCharWidth;\r\n            if (minimapColumns > minimapMaxColumn) {\r\n                minimapWidth = Math.floor(minimapMaxColumn * minimapCharWidth);\r\n            }\r\n            contentWidth = remainingWidth - minimapWidth;\r\n            if (minimapSide === 'left') {\r\n                minimapLeft = 0;\r\n                glyphMarginLeft += minimapWidth;\r\n                lineNumbersLeft += minimapWidth;\r\n                decorationsLeft += minimapWidth;\r\n                contentLeft += minimapWidth;\r\n            }\r\n            else {\r\n                minimapLeft = outerWidth - minimapWidth - verticalScrollbarWidth;\r\n            }\r\n        }\r\n        // (leaving 2px for the cursor to have space after the last character)\r\n        var viewportColumn = Math.max(1, Math.floor((contentWidth - verticalScrollbarWidth - 2) / typicalHalfwidthCharacterWidth));\r\n        var verticalArrowSize = (verticalScrollbarHasArrows ? scrollbarArrowSize : 0);\r\n        return {\r\n            width: outerWidth,\r\n            height: outerHeight,\r\n            glyphMarginLeft: glyphMarginLeft,\r\n            glyphMarginWidth: glyphMarginWidth,\r\n            glyphMarginHeight: outerHeight,\r\n            lineNumbersLeft: lineNumbersLeft,\r\n            lineNumbersWidth: lineNumbersWidth,\r\n            lineNumbersHeight: outerHeight,\r\n            decorationsLeft: decorationsLeft,\r\n            decorationsWidth: lineDecorationsWidth,\r\n            decorationsHeight: outerHeight,\r\n            contentLeft: contentLeft,\r\n            contentWidth: contentWidth,\r\n            contentHeight: outerHeight,\r\n            renderMinimap: renderMinimap,\r\n            minimapLeft: minimapLeft,\r\n            minimapWidth: minimapWidth,\r\n            viewportColumn: viewportColumn,\r\n            verticalScrollbarWidth: verticalScrollbarWidth,\r\n            horizontalScrollbarHeight: horizontalScrollbarHeight,\r\n            overviewRuler: {\r\n                top: verticalArrowSize,\r\n                width: verticalScrollbarWidth,\r\n                height: (outerHeight - 2 * verticalArrowSize),\r\n                right: 0\r\n            }\r\n        };\r\n    };\r\n    return EditorLayoutProvider;\r\n}());\r\nexport { EditorLayoutProvider };\r\nvar DEFAULT_WINDOWS_FONT_FAMILY = 'Consolas, \\'Courier New\\', monospace';\r\nvar DEFAULT_MAC_FONT_FAMILY = 'Menlo, Monaco, \\'Courier New\\', monospace';\r\nvar DEFAULT_LINUX_FONT_FAMILY = '\\'Droid Sans Mono\\', \\'monospace\\', monospace, \\'Droid Sans Fallback\\'';\r\n/**\r\n * @internal\r\n */\r\nexport var EDITOR_FONT_DEFAULTS = {\r\n    fontFamily: (platform.isMacintosh ? DEFAULT_MAC_FONT_FAMILY : (platform.isLinux ? DEFAULT_LINUX_FONT_FAMILY : DEFAULT_WINDOWS_FONT_FAMILY)),\r\n    fontWeight: 'normal',\r\n    fontSize: (platform.isMacintosh ? 12 : 14),\r\n    lineHeight: 0,\r\n    letterSpacing: 0,\r\n};\r\n/**\r\n * @internal\r\n */\r\nexport var EDITOR_MODEL_DEFAULTS = {\r\n    tabSize: 4,\r\n    insertSpaces: true,\r\n    detectIndentation: true,\r\n    trimAutoWhitespace: true,\r\n    largeFileOptimizations: true\r\n};\r\n/**\r\n * @internal\r\n */\r\nexport var EDITOR_DEFAULTS = {\r\n    inDiffEditor: false,\r\n    wordSeparators: USUAL_WORD_SEPARATORS,\r\n    lineNumbersMinChars: 5,\r\n    lineDecorationsWidth: 10,\r\n    readOnly: false,\r\n    mouseStyle: 'text',\r\n    disableLayerHinting: false,\r\n    automaticLayout: false,\r\n    wordWrap: 'off',\r\n    wordWrapColumn: 80,\r\n    wordWrapMinified: true,\r\n    wrappingIndent: 1 /* Same */,\r\n    wordWrapBreakBeforeCharacters: '([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋',\r\n    wordWrapBreakAfterCharacters: ' \\t})]?|&,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣',\r\n    wordWrapBreakObtrusiveCharacters: '.',\r\n    autoClosingBrackets: 'languageDefined',\r\n    autoClosingQuotes: 'languageDefined',\r\n    autoSurround: 'languageDefined',\r\n    autoIndent: true,\r\n    dragAndDrop: true,\r\n    emptySelectionClipboard: true,\r\n    copyWithSyntaxHighlighting: true,\r\n    useTabStops: true,\r\n    multiCursorModifier: 'altKey',\r\n    multiCursorMergeOverlapping: true,\r\n    accessibilitySupport: 'auto',\r\n    showUnused: true,\r\n    viewInfo: {\r\n        extraEditorClassName: '',\r\n        disableMonospaceOptimizations: false,\r\n        rulers: [],\r\n        ariaLabel: nls.localize('editorViewAccessibleLabel', \"Editor content\"),\r\n        renderLineNumbers: 1 /* On */,\r\n        renderCustomLineNumbers: null,\r\n        selectOnLineNumbers: true,\r\n        glyphMargin: true,\r\n        revealHorizontalRightPadding: 30,\r\n        roundedSelection: true,\r\n        overviewRulerLanes: 2,\r\n        overviewRulerBorder: true,\r\n        cursorBlinking: 1 /* Blink */,\r\n        mouseWheelZoom: false,\r\n        cursorStyle: TextEditorCursorStyle.Line,\r\n        cursorWidth: 0,\r\n        hideCursorInOverviewRuler: false,\r\n        scrollBeyondLastLine: true,\r\n        scrollBeyondLastColumn: 5,\r\n        smoothScrolling: false,\r\n        stopRenderingLineAfter: 10000,\r\n        renderWhitespace: 'none',\r\n        renderControlCharacters: false,\r\n        fontLigatures: false,\r\n        renderIndentGuides: true,\r\n        highlightActiveIndentGuide: true,\r\n        renderLineHighlight: 'line',\r\n        scrollbar: {\r\n            vertical: 1 /* Auto */,\r\n            horizontal: 1 /* Auto */,\r\n            arrowSize: 11,\r\n            useShadows: true,\r\n            verticalHasArrows: false,\r\n            horizontalHasArrows: false,\r\n            horizontalScrollbarSize: 10,\r\n            horizontalSliderSize: 10,\r\n            verticalScrollbarSize: 14,\r\n            verticalSliderSize: 14,\r\n            handleMouseWheel: true,\r\n            mouseWheelScrollSensitivity: 1,\r\n        },\r\n        minimap: {\r\n            enabled: true,\r\n            side: 'right',\r\n            showSlider: 'mouseover',\r\n            renderCharacters: true,\r\n            maxColumn: 120\r\n        },\r\n        fixedOverflowWidgets: false,\r\n    },\r\n    contribInfo: {\r\n        selectionClipboard: true,\r\n        hover: {\r\n            enabled: true,\r\n            delay: 300,\r\n            sticky: true\r\n        },\r\n        links: true,\r\n        contextmenu: true,\r\n        quickSuggestions: { other: true, comments: false, strings: false },\r\n        quickSuggestionsDelay: 10,\r\n        parameterHints: {\r\n            enabled: true,\r\n            cycle: false\r\n        },\r\n        iconsInSuggestions: true,\r\n        formatOnType: false,\r\n        formatOnPaste: false,\r\n        suggestOnTriggerCharacters: true,\r\n        acceptSuggestionOnEnter: 'on',\r\n        acceptSuggestionOnCommitCharacter: true,\r\n        wordBasedSuggestions: true,\r\n        suggestSelection: 'recentlyUsed',\r\n        suggestFontSize: 0,\r\n        suggestLineHeight: 0,\r\n        tabCompletion: 'off',\r\n        suggest: {\r\n            filterGraceful: true,\r\n            snippets: 'inline',\r\n            snippetsPreventQuickSuggestions: true,\r\n            localityBonus: false\r\n        },\r\n        selectionHighlight: true,\r\n        occurrencesHighlight: true,\r\n        codeLens: true,\r\n        folding: true,\r\n        foldingStrategy: 'auto',\r\n        showFoldingControls: 'mouseover',\r\n        matchBrackets: true,\r\n        find: {\r\n            seedSearchStringFromSelection: true,\r\n            autoFindInSelection: false,\r\n            globalFindClipboard: false\r\n        },\r\n        colorDecorators: true,\r\n        lightbulbEnabled: true,\r\n        codeActionsOnSave: {},\r\n        codeActionsOnSaveTimeout: 750\r\n    },\r\n};\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar KeyCodeStrMap = /** @class */ (function () {\r\n    function KeyCodeStrMap() {\r\n        this._keyCodeToStr = [];\r\n        this._strToKeyCode = Object.create(null);\r\n    }\r\n    KeyCodeStrMap.prototype.define = function (keyCode, str) {\r\n        this._keyCodeToStr[keyCode] = str;\r\n        this._strToKeyCode[str.toLowerCase()] = keyCode;\r\n    };\r\n    KeyCodeStrMap.prototype.keyCodeToStr = function (keyCode) {\r\n        return this._keyCodeToStr[keyCode];\r\n    };\r\n    KeyCodeStrMap.prototype.strToKeyCode = function (str) {\r\n        return this._strToKeyCode[str.toLowerCase()] || 0 /* Unknown */;\r\n    };\r\n    return KeyCodeStrMap;\r\n}());\r\nvar uiMap = new KeyCodeStrMap();\r\nvar userSettingsUSMap = new KeyCodeStrMap();\r\nvar userSettingsGeneralMap = new KeyCodeStrMap();\r\n(function () {\r\n    function define(keyCode, uiLabel, usUserSettingsLabel, generalUserSettingsLabel) {\r\n        if (usUserSettingsLabel === void 0) { usUserSettingsLabel = uiLabel; }\r\n        if (generalUserSettingsLabel === void 0) { generalUserSettingsLabel = usUserSettingsLabel; }\r\n        uiMap.define(keyCode, uiLabel);\r\n        userSettingsUSMap.define(keyCode, usUserSettingsLabel);\r\n        userSettingsGeneralMap.define(keyCode, generalUserSettingsLabel);\r\n    }\r\n    define(0 /* Unknown */, 'unknown');\r\n    define(1 /* Backspace */, 'Backspace');\r\n    define(2 /* Tab */, 'Tab');\r\n    define(3 /* Enter */, 'Enter');\r\n    define(4 /* Shift */, 'Shift');\r\n    define(5 /* Ctrl */, 'Ctrl');\r\n    define(6 /* Alt */, 'Alt');\r\n    define(7 /* PauseBreak */, 'PauseBreak');\r\n    define(8 /* CapsLock */, 'CapsLock');\r\n    define(9 /* Escape */, 'Escape');\r\n    define(10 /* Space */, 'Space');\r\n    define(11 /* PageUp */, 'PageUp');\r\n    define(12 /* PageDown */, 'PageDown');\r\n    define(13 /* End */, 'End');\r\n    define(14 /* Home */, 'Home');\r\n    define(15 /* LeftArrow */, 'LeftArrow', 'Left');\r\n    define(16 /* UpArrow */, 'UpArrow', 'Up');\r\n    define(17 /* RightArrow */, 'RightArrow', 'Right');\r\n    define(18 /* DownArrow */, 'DownArrow', 'Down');\r\n    define(19 /* Insert */, 'Insert');\r\n    define(20 /* Delete */, 'Delete');\r\n    define(21 /* KEY_0 */, '0');\r\n    define(22 /* KEY_1 */, '1');\r\n    define(23 /* KEY_2 */, '2');\r\n    define(24 /* KEY_3 */, '3');\r\n    define(25 /* KEY_4 */, '4');\r\n    define(26 /* KEY_5 */, '5');\r\n    define(27 /* KEY_6 */, '6');\r\n    define(28 /* KEY_7 */, '7');\r\n    define(29 /* KEY_8 */, '8');\r\n    define(30 /* KEY_9 */, '9');\r\n    define(31 /* KEY_A */, 'A');\r\n    define(32 /* KEY_B */, 'B');\r\n    define(33 /* KEY_C */, 'C');\r\n    define(34 /* KEY_D */, 'D');\r\n    define(35 /* KEY_E */, 'E');\r\n    define(36 /* KEY_F */, 'F');\r\n    define(37 /* KEY_G */, 'G');\r\n    define(38 /* KEY_H */, 'H');\r\n    define(39 /* KEY_I */, 'I');\r\n    define(40 /* KEY_J */, 'J');\r\n    define(41 /* KEY_K */, 'K');\r\n    define(42 /* KEY_L */, 'L');\r\n    define(43 /* KEY_M */, 'M');\r\n    define(44 /* KEY_N */, 'N');\r\n    define(45 /* KEY_O */, 'O');\r\n    define(46 /* KEY_P */, 'P');\r\n    define(47 /* KEY_Q */, 'Q');\r\n    define(48 /* KEY_R */, 'R');\r\n    define(49 /* KEY_S */, 'S');\r\n    define(50 /* KEY_T */, 'T');\r\n    define(51 /* KEY_U */, 'U');\r\n    define(52 /* KEY_V */, 'V');\r\n    define(53 /* KEY_W */, 'W');\r\n    define(54 /* KEY_X */, 'X');\r\n    define(55 /* KEY_Y */, 'Y');\r\n    define(56 /* KEY_Z */, 'Z');\r\n    define(57 /* Meta */, 'Meta');\r\n    define(58 /* ContextMenu */, 'ContextMenu');\r\n    define(59 /* F1 */, 'F1');\r\n    define(60 /* F2 */, 'F2');\r\n    define(61 /* F3 */, 'F3');\r\n    define(62 /* F4 */, 'F4');\r\n    define(63 /* F5 */, 'F5');\r\n    define(64 /* F6 */, 'F6');\r\n    define(65 /* F7 */, 'F7');\r\n    define(66 /* F8 */, 'F8');\r\n    define(67 /* F9 */, 'F9');\r\n    define(68 /* F10 */, 'F10');\r\n    define(69 /* F11 */, 'F11');\r\n    define(70 /* F12 */, 'F12');\r\n    define(71 /* F13 */, 'F13');\r\n    define(72 /* F14 */, 'F14');\r\n    define(73 /* F15 */, 'F15');\r\n    define(74 /* F16 */, 'F16');\r\n    define(75 /* F17 */, 'F17');\r\n    define(76 /* F18 */, 'F18');\r\n    define(77 /* F19 */, 'F19');\r\n    define(78 /* NumLock */, 'NumLock');\r\n    define(79 /* ScrollLock */, 'ScrollLock');\r\n    define(80 /* US_SEMICOLON */, ';', ';', 'OEM_1');\r\n    define(81 /* US_EQUAL */, '=', '=', 'OEM_PLUS');\r\n    define(82 /* US_COMMA */, ',', ',', 'OEM_COMMA');\r\n    define(83 /* US_MINUS */, '-', '-', 'OEM_MINUS');\r\n    define(84 /* US_DOT */, '.', '.', 'OEM_PERIOD');\r\n    define(85 /* US_SLASH */, '/', '/', 'OEM_2');\r\n    define(86 /* US_BACKTICK */, '`', '`', 'OEM_3');\r\n    define(110 /* ABNT_C1 */, 'ABNT_C1');\r\n    define(111 /* ABNT_C2 */, 'ABNT_C2');\r\n    define(87 /* US_OPEN_SQUARE_BRACKET */, '[', '[', 'OEM_4');\r\n    define(88 /* US_BACKSLASH */, '\\\\', '\\\\', 'OEM_5');\r\n    define(89 /* US_CLOSE_SQUARE_BRACKET */, ']', ']', 'OEM_6');\r\n    define(90 /* US_QUOTE */, '\\'', '\\'', 'OEM_7');\r\n    define(91 /* OEM_8 */, 'OEM_8');\r\n    define(92 /* OEM_102 */, 'OEM_102');\r\n    define(93 /* NUMPAD_0 */, 'NumPad0');\r\n    define(94 /* NUMPAD_1 */, 'NumPad1');\r\n    define(95 /* NUMPAD_2 */, 'NumPad2');\r\n    define(96 /* NUMPAD_3 */, 'NumPad3');\r\n    define(97 /* NUMPAD_4 */, 'NumPad4');\r\n    define(98 /* NUMPAD_5 */, 'NumPad5');\r\n    define(99 /* NUMPAD_6 */, 'NumPad6');\r\n    define(100 /* NUMPAD_7 */, 'NumPad7');\r\n    define(101 /* NUMPAD_8 */, 'NumPad8');\r\n    define(102 /* NUMPAD_9 */, 'NumPad9');\r\n    define(103 /* NUMPAD_MULTIPLY */, 'NumPad_Multiply');\r\n    define(104 /* NUMPAD_ADD */, 'NumPad_Add');\r\n    define(105 /* NUMPAD_SEPARATOR */, 'NumPad_Separator');\r\n    define(106 /* NUMPAD_SUBTRACT */, 'NumPad_Subtract');\r\n    define(107 /* NUMPAD_DECIMAL */, 'NumPad_Decimal');\r\n    define(108 /* NUMPAD_DIVIDE */, 'NumPad_Divide');\r\n})();\r\nexport var KeyCodeUtils;\r\n(function (KeyCodeUtils) {\r\n    function toString(keyCode) {\r\n        return uiMap.keyCodeToStr(keyCode);\r\n    }\r\n    KeyCodeUtils.toString = toString;\r\n    function fromString(key) {\r\n        return uiMap.strToKeyCode(key);\r\n    }\r\n    KeyCodeUtils.fromString = fromString;\r\n    function toUserSettingsUS(keyCode) {\r\n        return userSettingsUSMap.keyCodeToStr(keyCode);\r\n    }\r\n    KeyCodeUtils.toUserSettingsUS = toUserSettingsUS;\r\n    function toUserSettingsGeneral(keyCode) {\r\n        return userSettingsGeneralMap.keyCodeToStr(keyCode);\r\n    }\r\n    KeyCodeUtils.toUserSettingsGeneral = toUserSettingsGeneral;\r\n    function fromUserSettings(key) {\r\n        return userSettingsUSMap.strToKeyCode(key) || userSettingsGeneralMap.strToKeyCode(key);\r\n    }\r\n    KeyCodeUtils.fromUserSettings = fromUserSettings;\r\n})(KeyCodeUtils || (KeyCodeUtils = {}));\r\nexport function KeyChord(firstPart, secondPart) {\r\n    var chordPart = ((secondPart & 0x0000ffff) << 16) >>> 0;\r\n    return (firstPart | chordPart) >>> 0;\r\n}\r\nexport function createKeybinding(keybinding, OS) {\r\n    if (keybinding === 0) {\r\n        return null;\r\n    }\r\n    var firstPart = (keybinding & 0x0000ffff) >>> 0;\r\n    var chordPart = (keybinding & 0xffff0000) >>> 16;\r\n    if (chordPart !== 0) {\r\n        return new ChordKeybinding(createSimpleKeybinding(firstPart, OS), createSimpleKeybinding(chordPart, OS));\r\n    }\r\n    return createSimpleKeybinding(firstPart, OS);\r\n}\r\nexport function createSimpleKeybinding(keybinding, OS) {\r\n    var ctrlCmd = (keybinding & 2048 /* CtrlCmd */ ? true : false);\r\n    var winCtrl = (keybinding & 256 /* WinCtrl */ ? true : false);\r\n    var ctrlKey = (OS === 2 /* Macintosh */ ? winCtrl : ctrlCmd);\r\n    var shiftKey = (keybinding & 1024 /* Shift */ ? true : false);\r\n    var altKey = (keybinding & 512 /* Alt */ ? true : false);\r\n    var metaKey = (OS === 2 /* Macintosh */ ? ctrlCmd : winCtrl);\r\n    var keyCode = (keybinding & 255 /* KeyCode */);\r\n    return new SimpleKeybinding(ctrlKey, shiftKey, altKey, metaKey, keyCode);\r\n}\r\nvar SimpleKeybinding = /** @class */ (function () {\r\n    function SimpleKeybinding(ctrlKey, shiftKey, altKey, metaKey, keyCode) {\r\n        this.type = 1 /* Simple */;\r\n        this.ctrlKey = ctrlKey;\r\n        this.shiftKey = shiftKey;\r\n        this.altKey = altKey;\r\n        this.metaKey = metaKey;\r\n        this.keyCode = keyCode;\r\n    }\r\n    SimpleKeybinding.prototype.equals = function (other) {\r\n        if (other.type !== 1 /* Simple */) {\r\n            return false;\r\n        }\r\n        return (this.ctrlKey === other.ctrlKey\r\n            && this.shiftKey === other.shiftKey\r\n            && this.altKey === other.altKey\r\n            && this.metaKey === other.metaKey\r\n            && this.keyCode === other.keyCode);\r\n    };\r\n    SimpleKeybinding.prototype.isModifierKey = function () {\r\n        return (this.keyCode === 0 /* Unknown */\r\n            || this.keyCode === 5 /* Ctrl */\r\n            || this.keyCode === 57 /* Meta */\r\n            || this.keyCode === 6 /* Alt */\r\n            || this.keyCode === 4 /* Shift */);\r\n    };\r\n    /**\r\n     * Does this keybinding refer to the key code of a modifier and it also has the modifier flag?\r\n     */\r\n    SimpleKeybinding.prototype.isDuplicateModifierCase = function () {\r\n        return ((this.ctrlKey && this.keyCode === 5 /* Ctrl */)\r\n            || (this.shiftKey && this.keyCode === 4 /* Shift */)\r\n            || (this.altKey && this.keyCode === 6 /* Alt */)\r\n            || (this.metaKey && this.keyCode === 57 /* Meta */));\r\n    };\r\n    return SimpleKeybinding;\r\n}());\r\nexport { SimpleKeybinding };\r\nvar ChordKeybinding = /** @class */ (function () {\r\n    function ChordKeybinding(firstPart, chordPart) {\r\n        this.type = 2 /* Chord */;\r\n        this.firstPart = firstPart;\r\n        this.chordPart = chordPart;\r\n    }\r\n    return ChordKeybinding;\r\n}());\r\nexport { ChordKeybinding };\r\nvar ResolvedKeybindingPart = /** @class */ (function () {\r\n    function ResolvedKeybindingPart(ctrlKey, shiftKey, altKey, metaKey, kbLabel, kbAriaLabel) {\r\n        this.ctrlKey = ctrlKey;\r\n        this.shiftKey = shiftKey;\r\n        this.altKey = altKey;\r\n        this.metaKey = metaKey;\r\n        this.keyLabel = kbLabel;\r\n        this.keyAriaLabel = kbAriaLabel;\r\n    }\r\n    return ResolvedKeybindingPart;\r\n}());\r\nexport { ResolvedKeybindingPart };\r\n/**\r\n * A resolved keybinding. Can be a simple keybinding or a chord keybinding.\r\n */\r\nvar ResolvedKeybinding = /** @class */ (function () {\r\n    function ResolvedKeybinding() {\r\n    }\r\n    return ResolvedKeybinding;\r\n}());\r\nexport { ResolvedKeybinding };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar _a;\r\nimport { isWindows } from './platform.js';\r\nvar _schemePattern = /^\\w[\\w\\d+.-]*$/;\r\nvar _singleSlashStart = /^\\//;\r\nvar _doubleSlashStart = /^\\/\\//;\r\nvar _throwOnMissingSchema = true;\r\nfunction _validateUri(ret) {\r\n    // scheme, must be set\r\n    if (!ret.scheme) {\r\n        if (_throwOnMissingSchema) {\r\n            throw new Error(\"[UriError]: Scheme is missing: {scheme: \\\"\\\", authority: \\\"\" + ret.authority + \"\\\", path: \\\"\" + ret.path + \"\\\", query: \\\"\" + ret.query + \"\\\", fragment: \\\"\" + ret.fragment + \"\\\"}\");\r\n        }\r\n        else {\r\n            console.warn(\"[UriError]: Scheme is missing: {scheme: \\\"\\\", authority: \\\"\" + ret.authority + \"\\\", path: \\\"\" + ret.path + \"\\\", query: \\\"\" + ret.query + \"\\\", fragment: \\\"\" + ret.fragment + \"\\\"}\");\r\n        }\r\n    }\r\n    // scheme, https://tools.ietf.org/html/rfc3986#section-3.1\r\n    // ALPHA *( ALPHA / DIGIT / \"+\" / \"-\" / \".\" )\r\n    if (ret.scheme && !_schemePattern.test(ret.scheme)) {\r\n        throw new Error('[UriError]: Scheme contains illegal characters.');\r\n    }\r\n    // path, http://tools.ietf.org/html/rfc3986#section-3.3\r\n    // If a URI contains an authority component, then the path component\r\n    // must either be empty or begin with a slash (\"/\") character.  If a URI\r\n    // does not contain an authority component, then the path cannot begin\r\n    // with two slash characters (\"//\").\r\n    if (ret.path) {\r\n        if (ret.authority) {\r\n            if (!_singleSlashStart.test(ret.path)) {\r\n                throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash (\"/\") character');\r\n            }\r\n        }\r\n        else {\r\n            if (_doubleSlashStart.test(ret.path)) {\r\n                throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters (\"//\")');\r\n            }\r\n        }\r\n    }\r\n}\r\n// implements a bit of https://tools.ietf.org/html/rfc3986#section-5\r\nfunction _referenceResolution(scheme, path) {\r\n    // the slash-character is our 'default base' as we don't\r\n    // support constructing URIs relative to other URIs. This\r\n    // also means that we alter and potentially break paths.\r\n    // see https://tools.ietf.org/html/rfc3986#section-5.1.4\r\n    switch (scheme) {\r\n        case 'https':\r\n        case 'http':\r\n        case 'file':\r\n            if (!path) {\r\n                path = _slash;\r\n            }\r\n            else if (path[0] !== _slash) {\r\n                path = _slash + path;\r\n            }\r\n            break;\r\n    }\r\n    return path;\r\n}\r\nvar _empty = '';\r\nvar _slash = '/';\r\nvar _regexp = /^(([^:/?#]+?):)?(\\/\\/([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?/;\r\n/**\r\n * Uniform Resource Identifier (URI) http://tools.ietf.org/html/rfc3986.\r\n * This class is a simple parser which creates the basic component parts\r\n * (http://tools.ietf.org/html/rfc3986#section-3) with minimal validation\r\n * and encoding.\r\n *\r\n *       foo://example.com:8042/over/there?name=ferret#nose\r\n *       \\_/   \\______________/\\_________/ \\_________/ \\__/\r\n *        |           |            |            |        |\r\n *     scheme     authority       path        query   fragment\r\n *        |   _____________________|__\r\n *       / \\ /                        \\\r\n *       urn:example:animal:ferret:nose\r\n */\r\nvar URI = /** @class */ (function () {\r\n    /**\r\n     * @internal\r\n     */\r\n    function URI(schemeOrData, authority, path, query, fragment) {\r\n        if (typeof schemeOrData === 'object') {\r\n            this.scheme = schemeOrData.scheme || _empty;\r\n            this.authority = schemeOrData.authority || _empty;\r\n            this.path = schemeOrData.path || _empty;\r\n            this.query = schemeOrData.query || _empty;\r\n            this.fragment = schemeOrData.fragment || _empty;\r\n            // no validation because it's this URI\r\n            // that creates uri components.\r\n            // _validateUri(this);\r\n        }\r\n        else {\r\n            this.scheme = schemeOrData || _empty;\r\n            this.authority = authority || _empty;\r\n            this.path = _referenceResolution(this.scheme, path || _empty);\r\n            this.query = query || _empty;\r\n            this.fragment = fragment || _empty;\r\n            _validateUri(this);\r\n        }\r\n    }\r\n    URI.isUri = function (thing) {\r\n        if (thing instanceof URI) {\r\n            return true;\r\n        }\r\n        if (!thing) {\r\n            return false;\r\n        }\r\n        return typeof thing.authority === 'string'\r\n            && typeof thing.fragment === 'string'\r\n            && typeof thing.path === 'string'\r\n            && typeof thing.query === 'string'\r\n            && typeof thing.scheme === 'string';\r\n    };\r\n    Object.defineProperty(URI.prototype, \"fsPath\", {\r\n        // ---- filesystem path -----------------------\r\n        /**\r\n         * Returns a string representing the corresponding file system path of this URI.\r\n         * Will handle UNC paths, normalizes windows drive letters to lower-case, and uses the\r\n         * platform specific path separator.\r\n         *\r\n         * * Will *not* validate the path for invalid characters and semantics.\r\n         * * Will *not* look at the scheme of this URI.\r\n         * * The result shall *not* be used for display purposes but for accessing a file on disk.\r\n         *\r\n         *\r\n         * The *difference* to `URI#path` is the use of the platform specific separator and the handling\r\n         * of UNC paths. See the below sample of a file-uri with an authority (UNC path).\r\n         *\r\n         * ```ts\r\n            const u = URI.parse('file://server/c$/folder/file.txt')\r\n            u.authority === 'server'\r\n            u.path === '/shares/c$/file.txt'\r\n            u.fsPath === '\\\\server\\c$\\folder\\file.txt'\r\n        ```\r\n         *\r\n         * Using `URI#path` to read a file (using fs-apis) would not be enough because parts of the path,\r\n         * namely the server name, would be missing. Therefore `URI#fsPath` exists - it's sugar to ease working\r\n         * with URIs that represent files on disk (`file` scheme).\r\n         */\r\n        get: function () {\r\n            // if (this.scheme !== 'file') {\r\n            // \tconsole.warn(`[UriError] calling fsPath with scheme ${this.scheme}`);\r\n            // }\r\n            return _makeFsPath(this);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // ---- modify to new -------------------------\r\n    URI.prototype.with = function (change) {\r\n        if (!change) {\r\n            return this;\r\n        }\r\n        var scheme = change.scheme, authority = change.authority, path = change.path, query = change.query, fragment = change.fragment;\r\n        if (scheme === void 0) {\r\n            scheme = this.scheme;\r\n        }\r\n        else if (scheme === null) {\r\n            scheme = _empty;\r\n        }\r\n        if (authority === void 0) {\r\n            authority = this.authority;\r\n        }\r\n        else if (authority === null) {\r\n            authority = _empty;\r\n        }\r\n        if (path === void 0) {\r\n            path = this.path;\r\n        }\r\n        else if (path === null) {\r\n            path = _empty;\r\n        }\r\n        if (query === void 0) {\r\n            query = this.query;\r\n        }\r\n        else if (query === null) {\r\n            query = _empty;\r\n        }\r\n        if (fragment === void 0) {\r\n            fragment = this.fragment;\r\n        }\r\n        else if (fragment === null) {\r\n            fragment = _empty;\r\n        }\r\n        if (scheme === this.scheme\r\n            && authority === this.authority\r\n            && path === this.path\r\n            && query === this.query\r\n            && fragment === this.fragment) {\r\n            return this;\r\n        }\r\n        return new _URI(scheme, authority, path, query, fragment);\r\n    };\r\n    // ---- parse & validate ------------------------\r\n    /**\r\n     * Creates a new URI from a string, e.g. `http://www.msft.com/some/path`,\r\n     * `file:///usr/home`, or `scheme:with/path`.\r\n     *\r\n     * @param value A string which represents an URI (see `URI#toString`).\r\n     */\r\n    URI.parse = function (value) {\r\n        var match = _regexp.exec(value);\r\n        if (!match) {\r\n            return new _URI(_empty, _empty, _empty, _empty, _empty);\r\n        }\r\n        return new _URI(match[2] || _empty, decodeURIComponent(match[4] || _empty), decodeURIComponent(match[5] || _empty), decodeURIComponent(match[7] || _empty), decodeURIComponent(match[9] || _empty));\r\n    };\r\n    /**\r\n     * Creates a new URI from a file system path, e.g. `c:\\my\\files`,\r\n     * `/usr/home`, or `\\\\server\\share\\some\\path`.\r\n     *\r\n     * The *difference* between `URI#parse` and `URI#file` is that the latter treats the argument\r\n     * as path, not as stringified-uri. E.g. `URI.file(path)` is **not the same as**\r\n     * `URI.parse('file://' + path)` because the path might contain characters that are\r\n     * interpreted (# and ?). See the following sample:\r\n     * ```ts\r\n    const good = URI.file('/coding/c#/project1');\r\n    good.scheme === 'file';\r\n    good.path === '/coding/c#/project1';\r\n    good.fragment === '';\r\n    const bad = URI.parse('file://' + '/coding/c#/project1');\r\n    bad.scheme === 'file';\r\n    bad.path === '/coding/c'; // path is now broken\r\n    bad.fragment === '/project1';\r\n    ```\r\n     *\r\n     * @param path A file system path (see `URI#fsPath`)\r\n     */\r\n    URI.file = function (path) {\r\n        var authority = _empty;\r\n        // normalize to fwd-slashes on windows,\r\n        // on other systems bwd-slashes are valid\r\n        // filename character, eg /f\\oo/ba\\r.txt\r\n        if (isWindows) {\r\n            path = path.replace(/\\\\/g, _slash);\r\n        }\r\n        // check for authority as used in UNC shares\r\n        // or use the path as given\r\n        if (path[0] === _slash && path[1] === _slash) {\r\n            var idx = path.indexOf(_slash, 2);\r\n            if (idx === -1) {\r\n                authority = path.substring(2);\r\n                path = _slash;\r\n            }\r\n            else {\r\n                authority = path.substring(2, idx);\r\n                path = path.substring(idx) || _slash;\r\n            }\r\n        }\r\n        return new _URI('file', authority, path, _empty, _empty);\r\n    };\r\n    URI.from = function (components) {\r\n        return new _URI(components.scheme, components.authority, components.path, components.query, components.fragment);\r\n    };\r\n    // ---- printing/externalize ---------------------------\r\n    /**\r\n     * Creates a string presentation for this URI. It's guaranteed that calling\r\n     * `URI.parse` with the result of this function creates an URI which is equal\r\n     * to this URI.\r\n     *\r\n     * * The result shall *not* be used for display purposes but for externalization or transport.\r\n     * * The result will be encoded using the percentage encoding and encoding happens mostly\r\n     * ignore the scheme-specific encoding rules.\r\n     *\r\n     * @param skipEncoding Do not encode the result, default is `false`\r\n     */\r\n    URI.prototype.toString = function (skipEncoding) {\r\n        if (skipEncoding === void 0) { skipEncoding = false; }\r\n        return _asFormatted(this, skipEncoding);\r\n    };\r\n    URI.prototype.toJSON = function () {\r\n        return this;\r\n    };\r\n    URI.revive = function (data) {\r\n        if (!data) {\r\n            return data;\r\n        }\r\n        else if (data instanceof URI) {\r\n            return data;\r\n        }\r\n        else {\r\n            var result = new _URI(data);\r\n            result._fsPath = data.fsPath;\r\n            result._formatted = data.external;\r\n            return result;\r\n        }\r\n    };\r\n    return URI;\r\n}());\r\nexport { URI };\r\n// tslint:disable-next-line:class-name\r\nvar _URI = /** @class */ (function (_super) {\r\n    __extends(_URI, _super);\r\n    function _URI() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._formatted = null;\r\n        _this._fsPath = null;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(_URI.prototype, \"fsPath\", {\r\n        get: function () {\r\n            if (!this._fsPath) {\r\n                this._fsPath = _makeFsPath(this);\r\n            }\r\n            return this._fsPath;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    _URI.prototype.toString = function (skipEncoding) {\r\n        if (skipEncoding === void 0) { skipEncoding = false; }\r\n        if (!skipEncoding) {\r\n            if (!this._formatted) {\r\n                this._formatted = _asFormatted(this, false);\r\n            }\r\n            return this._formatted;\r\n        }\r\n        else {\r\n            // we don't cache that\r\n            return _asFormatted(this, true);\r\n        }\r\n    };\r\n    _URI.prototype.toJSON = function () {\r\n        var res = {\r\n            $mid: 1\r\n        };\r\n        // cached state\r\n        if (this._fsPath) {\r\n            res.fsPath = this._fsPath;\r\n        }\r\n        if (this._formatted) {\r\n            res.external = this._formatted;\r\n        }\r\n        // uri components\r\n        if (this.path) {\r\n            res.path = this.path;\r\n        }\r\n        if (this.scheme) {\r\n            res.scheme = this.scheme;\r\n        }\r\n        if (this.authority) {\r\n            res.authority = this.authority;\r\n        }\r\n        if (this.query) {\r\n            res.query = this.query;\r\n        }\r\n        if (this.fragment) {\r\n            res.fragment = this.fragment;\r\n        }\r\n        return res;\r\n    };\r\n    return _URI;\r\n}(URI));\r\n// reserved characters: https://tools.ietf.org/html/rfc3986#section-2.2\r\nvar encodeTable = (_a = {},\r\n    _a[58 /* Colon */] = '%3A',\r\n    _a[47 /* Slash */] = '%2F',\r\n    _a[63 /* QuestionMark */] = '%3F',\r\n    _a[35 /* Hash */] = '%23',\r\n    _a[91 /* OpenSquareBracket */] = '%5B',\r\n    _a[93 /* CloseSquareBracket */] = '%5D',\r\n    _a[64 /* AtSign */] = '%40',\r\n    _a[33 /* ExclamationMark */] = '%21',\r\n    _a[36 /* DollarSign */] = '%24',\r\n    _a[38 /* Ampersand */] = '%26',\r\n    _a[39 /* SingleQuote */] = '%27',\r\n    _a[40 /* OpenParen */] = '%28',\r\n    _a[41 /* CloseParen */] = '%29',\r\n    _a[42 /* Asterisk */] = '%2A',\r\n    _a[43 /* Plus */] = '%2B',\r\n    _a[44 /* Comma */] = '%2C',\r\n    _a[59 /* Semicolon */] = '%3B',\r\n    _a[61 /* Equals */] = '%3D',\r\n    _a[32 /* Space */] = '%20',\r\n    _a);\r\nfunction encodeURIComponentFast(uriComponent, allowSlash) {\r\n    var res = undefined;\r\n    var nativeEncodePos = -1;\r\n    for (var pos = 0; pos < uriComponent.length; pos++) {\r\n        var code = uriComponent.charCodeAt(pos);\r\n        // unreserved characters: https://tools.ietf.org/html/rfc3986#section-2.3\r\n        if ((code >= 97 /* a */ && code <= 122 /* z */)\r\n            || (code >= 65 /* A */ && code <= 90 /* Z */)\r\n            || (code >= 48 /* Digit0 */ && code <= 57 /* Digit9 */)\r\n            || code === 45 /* Dash */\r\n            || code === 46 /* Period */\r\n            || code === 95 /* Underline */\r\n            || code === 126 /* Tilde */\r\n            || (allowSlash && code === 47 /* Slash */)) {\r\n            // check if we are delaying native encode\r\n            if (nativeEncodePos !== -1) {\r\n                res += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\r\n                nativeEncodePos = -1;\r\n            }\r\n            // check if we write into a new string (by default we try to return the param)\r\n            if (res !== undefined) {\r\n                res += uriComponent.charAt(pos);\r\n            }\r\n        }\r\n        else {\r\n            // encoding needed, we need to allocate a new string\r\n            if (res === undefined) {\r\n                res = uriComponent.substr(0, pos);\r\n            }\r\n            // check with default table first\r\n            var escaped = encodeTable[code];\r\n            if (escaped !== undefined) {\r\n                // check if we are delaying native encode\r\n                if (nativeEncodePos !== -1) {\r\n                    res += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\r\n                    nativeEncodePos = -1;\r\n                }\r\n                // append escaped variant to result\r\n                res += escaped;\r\n            }\r\n            else if (nativeEncodePos === -1) {\r\n                // use native encode only when needed\r\n                nativeEncodePos = pos;\r\n            }\r\n        }\r\n    }\r\n    if (nativeEncodePos !== -1) {\r\n        res += encodeURIComponent(uriComponent.substring(nativeEncodePos));\r\n    }\r\n    return res !== undefined ? res : uriComponent;\r\n}\r\nfunction encodeURIComponentMinimal(path) {\r\n    var res = undefined;\r\n    for (var pos = 0; pos < path.length; pos++) {\r\n        var code = path.charCodeAt(pos);\r\n        if (code === 35 /* Hash */ || code === 63 /* QuestionMark */) {\r\n            if (res === undefined) {\r\n                res = path.substr(0, pos);\r\n            }\r\n            res += encodeTable[code];\r\n        }\r\n        else {\r\n            if (res !== undefined) {\r\n                res += path[pos];\r\n            }\r\n        }\r\n    }\r\n    return res !== undefined ? res : path;\r\n}\r\n/**\r\n * Compute `fsPath` for the given uri\r\n * @param uri\r\n */\r\nfunction _makeFsPath(uri) {\r\n    var value;\r\n    if (uri.authority && uri.path.length > 1 && uri.scheme === 'file') {\r\n        // unc path: file://shares/c$/far/boo\r\n        value = \"//\" + uri.authority + uri.path;\r\n    }\r\n    else if (uri.path.charCodeAt(0) === 47 /* Slash */\r\n        && (uri.path.charCodeAt(1) >= 65 /* A */ && uri.path.charCodeAt(1) <= 90 /* Z */ || uri.path.charCodeAt(1) >= 97 /* a */ && uri.path.charCodeAt(1) <= 122 /* z */)\r\n        && uri.path.charCodeAt(2) === 58 /* Colon */) {\r\n        // windows drive letter: file:///c:/far/boo\r\n        value = uri.path[1].toLowerCase() + uri.path.substr(2);\r\n    }\r\n    else {\r\n        // other path\r\n        value = uri.path;\r\n    }\r\n    if (isWindows) {\r\n        value = value.replace(/\\//g, '\\\\');\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * Create the external version of a uri\r\n */\r\nfunction _asFormatted(uri, skipEncoding) {\r\n    var encoder = !skipEncoding\r\n        ? encodeURIComponentFast\r\n        : encodeURIComponentMinimal;\r\n    var res = '';\r\n    var scheme = uri.scheme, authority = uri.authority, path = uri.path, query = uri.query, fragment = uri.fragment;\r\n    if (scheme) {\r\n        res += scheme;\r\n        res += ':';\r\n    }\r\n    if (authority || scheme === 'file') {\r\n        res += _slash;\r\n        res += _slash;\r\n    }\r\n    if (authority) {\r\n        var idx = authority.indexOf('@');\r\n        if (idx !== -1) {\r\n            // <user>@<auth>\r\n            var userinfo = authority.substr(0, idx);\r\n            authority = authority.substr(idx + 1);\r\n            idx = userinfo.indexOf(':');\r\n            if (idx === -1) {\r\n                res += encoder(userinfo, false);\r\n            }\r\n            else {\r\n                // <user>:<pass>@<auth>\r\n                res += encoder(userinfo.substr(0, idx), false);\r\n                res += ':';\r\n                res += encoder(userinfo.substr(idx + 1), false);\r\n            }\r\n            res += '@';\r\n        }\r\n        authority = authority.toLowerCase();\r\n        idx = authority.indexOf(':');\r\n        if (idx === -1) {\r\n            res += encoder(authority, false);\r\n        }\r\n        else {\r\n            // <auth>:<port>\r\n            res += encoder(authority.substr(0, idx), false);\r\n            res += authority.substr(idx);\r\n        }\r\n    }\r\n    if (path) {\r\n        // lower-case windows drive letters in /C:/fff or C:/fff\r\n        if (path.length >= 3 && path.charCodeAt(0) === 47 /* Slash */ && path.charCodeAt(2) === 58 /* Colon */) {\r\n            var code = path.charCodeAt(1);\r\n            if (code >= 65 /* A */ && code <= 90 /* Z */) {\r\n                path = \"/\" + String.fromCharCode(code + 32) + \":\" + path.substr(3); // \"/c:\".length === 3\r\n            }\r\n        }\r\n        else if (path.length >= 2 && path.charCodeAt(1) === 58 /* Colon */) {\r\n            var code = path.charCodeAt(0);\r\n            if (code >= 65 /* A */ && code <= 90 /* Z */) {\r\n                path = String.fromCharCode(code + 32) + \":\" + path.substr(2); // \"/c:\".length === 3\r\n            }\r\n        }\r\n        // encode the rest of the path\r\n        res += encoder(path, true);\r\n    }\r\n    if (query) {\r\n        res += '?';\r\n        res += encoder(query, false);\r\n    }\r\n    if (fragment) {\r\n        res += '#';\r\n        res += !skipEncoding ? encodeURIComponentFast(fragment, false) : fragment;\r\n    }\r\n    return res;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/**\r\n * A position in the editor.\r\n */\r\nvar Position = /** @class */ (function () {\r\n    function Position(lineNumber, column) {\r\n        this.lineNumber = lineNumber;\r\n        this.column = column;\r\n    }\r\n    /**\r\n     * Create a new postion from this position.\r\n     *\r\n     * @param newLineNumber new line number\r\n     * @param newColumn new column\r\n     */\r\n    Position.prototype.with = function (newLineNumber, newColumn) {\r\n        if (newLineNumber === void 0) { newLineNumber = this.lineNumber; }\r\n        if (newColumn === void 0) { newColumn = this.column; }\r\n        if (newLineNumber === this.lineNumber && newColumn === this.column) {\r\n            return this;\r\n        }\r\n        else {\r\n            return new Position(newLineNumber, newColumn);\r\n        }\r\n    };\r\n    /**\r\n     * Derive a new position from this position.\r\n     *\r\n     * @param deltaLineNumber line number delta\r\n     * @param deltaColumn column delta\r\n     */\r\n    Position.prototype.delta = function (deltaLineNumber, deltaColumn) {\r\n        if (deltaLineNumber === void 0) { deltaLineNumber = 0; }\r\n        if (deltaColumn === void 0) { deltaColumn = 0; }\r\n        return this.with(this.lineNumber + deltaLineNumber, this.column + deltaColumn);\r\n    };\r\n    /**\r\n     * Test if this position equals other position\r\n     */\r\n    Position.prototype.equals = function (other) {\r\n        return Position.equals(this, other);\r\n    };\r\n    /**\r\n     * Test if position `a` equals position `b`\r\n     */\r\n    Position.equals = function (a, b) {\r\n        if (!a && !b) {\r\n            return true;\r\n        }\r\n        return (!!a &&\r\n            !!b &&\r\n            a.lineNumber === b.lineNumber &&\r\n            a.column === b.column);\r\n    };\r\n    /**\r\n     * Test if this position is before other position.\r\n     * If the two positions are equal, the result will be false.\r\n     */\r\n    Position.prototype.isBefore = function (other) {\r\n        return Position.isBefore(this, other);\r\n    };\r\n    /**\r\n     * Test if position `a` is before position `b`.\r\n     * If the two positions are equal, the result will be false.\r\n     */\r\n    Position.isBefore = function (a, b) {\r\n        if (a.lineNumber < b.lineNumber) {\r\n            return true;\r\n        }\r\n        if (b.lineNumber < a.lineNumber) {\r\n            return false;\r\n        }\r\n        return a.column < b.column;\r\n    };\r\n    /**\r\n     * Test if this position is before other position.\r\n     * If the two positions are equal, the result will be true.\r\n     */\r\n    Position.prototype.isBeforeOrEqual = function (other) {\r\n        return Position.isBeforeOrEqual(this, other);\r\n    };\r\n    /**\r\n     * Test if position `a` is before position `b`.\r\n     * If the two positions are equal, the result will be true.\r\n     */\r\n    Position.isBeforeOrEqual = function (a, b) {\r\n        if (a.lineNumber < b.lineNumber) {\r\n            return true;\r\n        }\r\n        if (b.lineNumber < a.lineNumber) {\r\n            return false;\r\n        }\r\n        return a.column <= b.column;\r\n    };\r\n    /**\r\n     * A function that compares positions, useful for sorting\r\n     */\r\n    Position.compare = function (a, b) {\r\n        var aLineNumber = a.lineNumber | 0;\r\n        var bLineNumber = b.lineNumber | 0;\r\n        if (aLineNumber === bLineNumber) {\r\n            var aColumn = a.column | 0;\r\n            var bColumn = b.column | 0;\r\n            return aColumn - bColumn;\r\n        }\r\n        return aLineNumber - bLineNumber;\r\n    };\r\n    /**\r\n     * Clone this position.\r\n     */\r\n    Position.prototype.clone = function () {\r\n        return new Position(this.lineNumber, this.column);\r\n    };\r\n    /**\r\n     * Convert to a human-readable representation.\r\n     */\r\n    Position.prototype.toString = function () {\r\n        return '(' + this.lineNumber + ',' + this.column + ')';\r\n    };\r\n    // ---\r\n    /**\r\n     * Create a `Position` from an `IPosition`.\r\n     */\r\n    Position.lift = function (pos) {\r\n        return new Position(pos.lineNumber, pos.column);\r\n    };\r\n    /**\r\n     * Test if `obj` is an `IPosition`.\r\n     */\r\n    Position.isIPosition = function (obj) {\r\n        return (obj\r\n            && (typeof obj.lineNumber === 'number')\r\n            && (typeof obj.column === 'number'));\r\n    };\r\n    return Position;\r\n}());\r\nexport { Position };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Position } from './position.js';\r\n/**\r\n * A range in the editor. (startLineNumber,startColumn) is <= (endLineNumber,endColumn)\r\n */\r\nvar Range = /** @class */ (function () {\r\n    function Range(startLineNumber, startColumn, endLineNumber, endColumn) {\r\n        if ((startLineNumber > endLineNumber) || (startLineNumber === endLineNumber && startColumn > endColumn)) {\r\n            this.startLineNumber = endLineNumber;\r\n            this.startColumn = endColumn;\r\n            this.endLineNumber = startLineNumber;\r\n            this.endColumn = startColumn;\r\n        }\r\n        else {\r\n            this.startLineNumber = startLineNumber;\r\n            this.startColumn = startColumn;\r\n            this.endLineNumber = endLineNumber;\r\n            this.endColumn = endColumn;\r\n        }\r\n    }\r\n    /**\r\n     * Test if this range is empty.\r\n     */\r\n    Range.prototype.isEmpty = function () {\r\n        return Range.isEmpty(this);\r\n    };\r\n    /**\r\n     * Test if `range` is empty.\r\n     */\r\n    Range.isEmpty = function (range) {\r\n        return (range.startLineNumber === range.endLineNumber && range.startColumn === range.endColumn);\r\n    };\r\n    /**\r\n     * Test if position is in this range. If the position is at the edges, will return true.\r\n     */\r\n    Range.prototype.containsPosition = function (position) {\r\n        return Range.containsPosition(this, position);\r\n    };\r\n    /**\r\n     * Test if `position` is in `range`. If the position is at the edges, will return true.\r\n     */\r\n    Range.containsPosition = function (range, position) {\r\n        if (position.lineNumber < range.startLineNumber || position.lineNumber > range.endLineNumber) {\r\n            return false;\r\n        }\r\n        if (position.lineNumber === range.startLineNumber && position.column < range.startColumn) {\r\n            return false;\r\n        }\r\n        if (position.lineNumber === range.endLineNumber && position.column > range.endColumn) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * Test if range is in this range. If the range is equal to this range, will return true.\r\n     */\r\n    Range.prototype.containsRange = function (range) {\r\n        return Range.containsRange(this, range);\r\n    };\r\n    /**\r\n     * Test if `otherRange` is in `range`. If the ranges are equal, will return true.\r\n     */\r\n    Range.containsRange = function (range, otherRange) {\r\n        if (otherRange.startLineNumber < range.startLineNumber || otherRange.endLineNumber < range.startLineNumber) {\r\n            return false;\r\n        }\r\n        if (otherRange.startLineNumber > range.endLineNumber || otherRange.endLineNumber > range.endLineNumber) {\r\n            return false;\r\n        }\r\n        if (otherRange.startLineNumber === range.startLineNumber && otherRange.startColumn < range.startColumn) {\r\n            return false;\r\n        }\r\n        if (otherRange.endLineNumber === range.endLineNumber && otherRange.endColumn > range.endColumn) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * A reunion of the two ranges.\r\n     * The smallest position will be used as the start point, and the largest one as the end point.\r\n     */\r\n    Range.prototype.plusRange = function (range) {\r\n        return Range.plusRange(this, range);\r\n    };\r\n    /**\r\n     * A reunion of the two ranges.\r\n     * The smallest position will be used as the start point, and the largest one as the end point.\r\n     */\r\n    Range.plusRange = function (a, b) {\r\n        var startLineNumber;\r\n        var startColumn;\r\n        var endLineNumber;\r\n        var endColumn;\r\n        if (b.startLineNumber < a.startLineNumber) {\r\n            startLineNumber = b.startLineNumber;\r\n            startColumn = b.startColumn;\r\n        }\r\n        else if (b.startLineNumber === a.startLineNumber) {\r\n            startLineNumber = b.startLineNumber;\r\n            startColumn = Math.min(b.startColumn, a.startColumn);\r\n        }\r\n        else {\r\n            startLineNumber = a.startLineNumber;\r\n            startColumn = a.startColumn;\r\n        }\r\n        if (b.endLineNumber > a.endLineNumber) {\r\n            endLineNumber = b.endLineNumber;\r\n            endColumn = b.endColumn;\r\n        }\r\n        else if (b.endLineNumber === a.endLineNumber) {\r\n            endLineNumber = b.endLineNumber;\r\n            endColumn = Math.max(b.endColumn, a.endColumn);\r\n        }\r\n        else {\r\n            endLineNumber = a.endLineNumber;\r\n            endColumn = a.endColumn;\r\n        }\r\n        return new Range(startLineNumber, startColumn, endLineNumber, endColumn);\r\n    };\r\n    /**\r\n     * A intersection of the two ranges.\r\n     */\r\n    Range.prototype.intersectRanges = function (range) {\r\n        return Range.intersectRanges(this, range);\r\n    };\r\n    /**\r\n     * A intersection of the two ranges.\r\n     */\r\n    Range.intersectRanges = function (a, b) {\r\n        var resultStartLineNumber = a.startLineNumber;\r\n        var resultStartColumn = a.startColumn;\r\n        var resultEndLineNumber = a.endLineNumber;\r\n        var resultEndColumn = a.endColumn;\r\n        var otherStartLineNumber = b.startLineNumber;\r\n        var otherStartColumn = b.startColumn;\r\n        var otherEndLineNumber = b.endLineNumber;\r\n        var otherEndColumn = b.endColumn;\r\n        if (resultStartLineNumber < otherStartLineNumber) {\r\n            resultStartLineNumber = otherStartLineNumber;\r\n            resultStartColumn = otherStartColumn;\r\n        }\r\n        else if (resultStartLineNumber === otherStartLineNumber) {\r\n            resultStartColumn = Math.max(resultStartColumn, otherStartColumn);\r\n        }\r\n        if (resultEndLineNumber > otherEndLineNumber) {\r\n            resultEndLineNumber = otherEndLineNumber;\r\n            resultEndColumn = otherEndColumn;\r\n        }\r\n        else if (resultEndLineNumber === otherEndLineNumber) {\r\n            resultEndColumn = Math.min(resultEndColumn, otherEndColumn);\r\n        }\r\n        // Check if selection is now empty\r\n        if (resultStartLineNumber > resultEndLineNumber) {\r\n            return null;\r\n        }\r\n        if (resultStartLineNumber === resultEndLineNumber && resultStartColumn > resultEndColumn) {\r\n            return null;\r\n        }\r\n        return new Range(resultStartLineNumber, resultStartColumn, resultEndLineNumber, resultEndColumn);\r\n    };\r\n    /**\r\n     * Test if this range equals other.\r\n     */\r\n    Range.prototype.equalsRange = function (other) {\r\n        return Range.equalsRange(this, other);\r\n    };\r\n    /**\r\n     * Test if range `a` equals `b`.\r\n     */\r\n    Range.equalsRange = function (a, b) {\r\n        return (!!a &&\r\n            !!b &&\r\n            a.startLineNumber === b.startLineNumber &&\r\n            a.startColumn === b.startColumn &&\r\n            a.endLineNumber === b.endLineNumber &&\r\n            a.endColumn === b.endColumn);\r\n    };\r\n    /**\r\n     * Return the end position (which will be after or equal to the start position)\r\n     */\r\n    Range.prototype.getEndPosition = function () {\r\n        return new Position(this.endLineNumber, this.endColumn);\r\n    };\r\n    /**\r\n     * Return the start position (which will be before or equal to the end position)\r\n     */\r\n    Range.prototype.getStartPosition = function () {\r\n        return new Position(this.startLineNumber, this.startColumn);\r\n    };\r\n    /**\r\n     * Transform to a user presentable string representation.\r\n     */\r\n    Range.prototype.toString = function () {\r\n        return '[' + this.startLineNumber + ',' + this.startColumn + ' -> ' + this.endLineNumber + ',' + this.endColumn + ']';\r\n    };\r\n    /**\r\n     * Create a new range using this range's start position, and using endLineNumber and endColumn as the end position.\r\n     */\r\n    Range.prototype.setEndPosition = function (endLineNumber, endColumn) {\r\n        return new Range(this.startLineNumber, this.startColumn, endLineNumber, endColumn);\r\n    };\r\n    /**\r\n     * Create a new range using this range's end position, and using startLineNumber and startColumn as the start position.\r\n     */\r\n    Range.prototype.setStartPosition = function (startLineNumber, startColumn) {\r\n        return new Range(startLineNumber, startColumn, this.endLineNumber, this.endColumn);\r\n    };\r\n    /**\r\n     * Create a new empty range using this range's start position.\r\n     */\r\n    Range.prototype.collapseToStart = function () {\r\n        return Range.collapseToStart(this);\r\n    };\r\n    /**\r\n     * Create a new empty range using this range's start position.\r\n     */\r\n    Range.collapseToStart = function (range) {\r\n        return new Range(range.startLineNumber, range.startColumn, range.startLineNumber, range.startColumn);\r\n    };\r\n    // ---\r\n    Range.fromPositions = function (start, end) {\r\n        if (end === void 0) { end = start; }\r\n        return new Range(start.lineNumber, start.column, end.lineNumber, end.column);\r\n    };\r\n    Range.lift = function (range) {\r\n        if (!range) {\r\n            return null;\r\n        }\r\n        return new Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\r\n    };\r\n    /**\r\n     * Test if `obj` is an `IRange`.\r\n     */\r\n    Range.isIRange = function (obj) {\r\n        return (obj\r\n            && (typeof obj.startLineNumber === 'number')\r\n            && (typeof obj.startColumn === 'number')\r\n            && (typeof obj.endLineNumber === 'number')\r\n            && (typeof obj.endColumn === 'number'));\r\n    };\r\n    /**\r\n     * Test if the two ranges are touching in any way.\r\n     */\r\n    Range.areIntersectingOrTouching = function (a, b) {\r\n        // Check if `a` is before `b`\r\n        if (a.endLineNumber < b.startLineNumber || (a.endLineNumber === b.startLineNumber && a.endColumn < b.startColumn)) {\r\n            return false;\r\n        }\r\n        // Check if `b` is before `a`\r\n        if (b.endLineNumber < a.startLineNumber || (b.endLineNumber === a.startLineNumber && b.endColumn < a.startColumn)) {\r\n            return false;\r\n        }\r\n        // These ranges must intersect\r\n        return true;\r\n    };\r\n    /**\r\n     * Test if the two ranges are intersecting. If the ranges are touching it returns true.\r\n     */\r\n    Range.areIntersecting = function (a, b) {\r\n        // Check if `a` is before `b`\r\n        if (a.endLineNumber < b.startLineNumber || (a.endLineNumber === b.startLineNumber && a.endColumn <= b.startColumn)) {\r\n            return false;\r\n        }\r\n        // Check if `b` is before `a`\r\n        if (b.endLineNumber < a.startLineNumber || (b.endLineNumber === a.startLineNumber && b.endColumn <= a.startColumn)) {\r\n            return false;\r\n        }\r\n        // These ranges must intersect\r\n        return true;\r\n    };\r\n    /**\r\n     * A function that compares ranges, useful for sorting ranges\r\n     * It will first compare ranges on the startPosition and then on the endPosition\r\n     */\r\n    Range.compareRangesUsingStarts = function (a, b) {\r\n        if (a && b) {\r\n            var aStartLineNumber = a.startLineNumber | 0;\r\n            var bStartLineNumber = b.startLineNumber | 0;\r\n            if (aStartLineNumber === bStartLineNumber) {\r\n                var aStartColumn = a.startColumn | 0;\r\n                var bStartColumn = b.startColumn | 0;\r\n                if (aStartColumn === bStartColumn) {\r\n                    var aEndLineNumber = a.endLineNumber | 0;\r\n                    var bEndLineNumber = b.endLineNumber | 0;\r\n                    if (aEndLineNumber === bEndLineNumber) {\r\n                        var aEndColumn = a.endColumn | 0;\r\n                        var bEndColumn = b.endColumn | 0;\r\n                        return aEndColumn - bEndColumn;\r\n                    }\r\n                    return aEndLineNumber - bEndLineNumber;\r\n                }\r\n                return aStartColumn - bStartColumn;\r\n            }\r\n            return aStartLineNumber - bStartLineNumber;\r\n        }\r\n        var aExists = (a ? 1 : 0);\r\n        var bExists = (b ? 1 : 0);\r\n        return aExists - bExists;\r\n    };\r\n    /**\r\n     * A function that compares ranges, useful for sorting ranges\r\n     * It will first compare ranges on the endPosition and then on the startPosition\r\n     */\r\n    Range.compareRangesUsingEnds = function (a, b) {\r\n        if (a.endLineNumber === b.endLineNumber) {\r\n            if (a.endColumn === b.endColumn) {\r\n                if (a.startLineNumber === b.startLineNumber) {\r\n                    return a.startColumn - b.startColumn;\r\n                }\r\n                return a.startLineNumber - b.startLineNumber;\r\n            }\r\n            return a.endColumn - b.endColumn;\r\n        }\r\n        return a.endLineNumber - b.endLineNumber;\r\n    };\r\n    /**\r\n     * Test if the range spans multiple lines.\r\n     */\r\n    Range.spansMultipleLines = function (range) {\r\n        return range.endLineNumber > range.startLineNumber;\r\n    };\r\n    return Range;\r\n}());\r\nexport { Range };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Position } from './position.js';\r\nimport { Range } from './range.js';\r\n/**\r\n * A selection in the editor.\r\n * The selection is a range that has an orientation.\r\n */\r\nvar Selection = /** @class */ (function (_super) {\r\n    __extends(Selection, _super);\r\n    function Selection(selectionStartLineNumber, selectionStartColumn, positionLineNumber, positionColumn) {\r\n        var _this = _super.call(this, selectionStartLineNumber, selectionStartColumn, positionLineNumber, positionColumn) || this;\r\n        _this.selectionStartLineNumber = selectionStartLineNumber;\r\n        _this.selectionStartColumn = selectionStartColumn;\r\n        _this.positionLineNumber = positionLineNumber;\r\n        _this.positionColumn = positionColumn;\r\n        return _this;\r\n    }\r\n    /**\r\n     * Clone this selection.\r\n     */\r\n    Selection.prototype.clone = function () {\r\n        return new Selection(this.selectionStartLineNumber, this.selectionStartColumn, this.positionLineNumber, this.positionColumn);\r\n    };\r\n    /**\r\n     * Transform to a human-readable representation.\r\n     */\r\n    Selection.prototype.toString = function () {\r\n        return '[' + this.selectionStartLineNumber + ',' + this.selectionStartColumn + ' -> ' + this.positionLineNumber + ',' + this.positionColumn + ']';\r\n    };\r\n    /**\r\n     * Test if equals other selection.\r\n     */\r\n    Selection.prototype.equalsSelection = function (other) {\r\n        return (Selection.selectionsEqual(this, other));\r\n    };\r\n    /**\r\n     * Test if the two selections are equal.\r\n     */\r\n    Selection.selectionsEqual = function (a, b) {\r\n        return (a.selectionStartLineNumber === b.selectionStartLineNumber &&\r\n            a.selectionStartColumn === b.selectionStartColumn &&\r\n            a.positionLineNumber === b.positionLineNumber &&\r\n            a.positionColumn === b.positionColumn);\r\n    };\r\n    /**\r\n     * Get directions (LTR or RTL).\r\n     */\r\n    Selection.prototype.getDirection = function () {\r\n        if (this.selectionStartLineNumber === this.startLineNumber && this.selectionStartColumn === this.startColumn) {\r\n            return 0 /* LTR */;\r\n        }\r\n        return 1 /* RTL */;\r\n    };\r\n    /**\r\n     * Create a new selection with a different `positionLineNumber` and `positionColumn`.\r\n     */\r\n    Selection.prototype.setEndPosition = function (endLineNumber, endColumn) {\r\n        if (this.getDirection() === 0 /* LTR */) {\r\n            return new Selection(this.startLineNumber, this.startColumn, endLineNumber, endColumn);\r\n        }\r\n        return new Selection(endLineNumber, endColumn, this.startLineNumber, this.startColumn);\r\n    };\r\n    /**\r\n     * Get the position at `positionLineNumber` and `positionColumn`.\r\n     */\r\n    Selection.prototype.getPosition = function () {\r\n        return new Position(this.positionLineNumber, this.positionColumn);\r\n    };\r\n    /**\r\n     * Create a new selection with a different `selectionStartLineNumber` and `selectionStartColumn`.\r\n     */\r\n    Selection.prototype.setStartPosition = function (startLineNumber, startColumn) {\r\n        if (this.getDirection() === 0 /* LTR */) {\r\n            return new Selection(startLineNumber, startColumn, this.endLineNumber, this.endColumn);\r\n        }\r\n        return new Selection(this.endLineNumber, this.endColumn, startLineNumber, startColumn);\r\n    };\r\n    // ----\r\n    /**\r\n     * Create a `Selection` from one or two positions\r\n     */\r\n    Selection.fromPositions = function (start, end) {\r\n        if (end === void 0) { end = start; }\r\n        return new Selection(start.lineNumber, start.column, end.lineNumber, end.column);\r\n    };\r\n    /**\r\n     * Create a `Selection` from an `ISelection`.\r\n     */\r\n    Selection.liftSelection = function (sel) {\r\n        return new Selection(sel.selectionStartLineNumber, sel.selectionStartColumn, sel.positionLineNumber, sel.positionColumn);\r\n    };\r\n    /**\r\n     * `a` equals `b`.\r\n     */\r\n    Selection.selectionsArrEqual = function (a, b) {\r\n        if (a && !b || !a && b) {\r\n            return false;\r\n        }\r\n        if (!a && !b) {\r\n            return true;\r\n        }\r\n        if (a.length !== b.length) {\r\n            return false;\r\n        }\r\n        for (var i = 0, len = a.length; i < len; i++) {\r\n            if (!this.selectionsEqual(a[i], b[i])) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * Test if `obj` is an `ISelection`.\r\n     */\r\n    Selection.isISelection = function (obj) {\r\n        return (obj\r\n            && (typeof obj.selectionStartLineNumber === 'number')\r\n            && (typeof obj.selectionStartColumn === 'number')\r\n            && (typeof obj.positionLineNumber === 'number')\r\n            && (typeof obj.positionColumn === 'number'));\r\n    };\r\n    /**\r\n     * Create with a direction.\r\n     */\r\n    Selection.createWithDirection = function (startLineNumber, startColumn, endLineNumber, endColumn, direction) {\r\n        if (direction === 0 /* LTR */) {\r\n            return new Selection(startLineNumber, startColumn, endLineNumber, endColumn);\r\n        }\r\n        return new Selection(endLineNumber, endColumn, startLineNumber, startColumn);\r\n    };\r\n    return Selection;\r\n}(Range));\r\nexport { Selection };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar Token = /** @class */ (function () {\r\n    function Token(offset, type, language) {\r\n        this.offset = offset | 0; // @perf\r\n        this.type = type;\r\n        this.language = language;\r\n    }\r\n    Token.prototype.toString = function () {\r\n        return '(' + this.offset + ', ' + this.type + ')';\r\n    };\r\n    return Token;\r\n}());\r\nexport { Token };\r\nvar TokenizationResult = /** @class */ (function () {\r\n    function TokenizationResult(tokens, endState) {\r\n        this.tokens = tokens;\r\n        this.endState = endState;\r\n    }\r\n    return TokenizationResult;\r\n}());\r\nexport { TokenizationResult };\r\nvar TokenizationResult2 = /** @class */ (function () {\r\n    function TokenizationResult2(tokens, endState) {\r\n        this.tokens = tokens;\r\n        this.endState = endState;\r\n    }\r\n    return TokenizationResult2;\r\n}());\r\nexport { TokenizationResult2 };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n// THIS IS A GENERATED FILE. DO NOT EDIT DIRECTLY.\r\nexport var MarkerTag;\r\n(function (MarkerTag) {\r\n    MarkerTag[MarkerTag[\"Unnecessary\"] = 1] = \"Unnecessary\";\r\n})(MarkerTag || (MarkerTag = {}));\r\nexport var MarkerSeverity;\r\n(function (MarkerSeverity) {\r\n    MarkerSeverity[MarkerSeverity[\"Hint\"] = 1] = \"Hint\";\r\n    MarkerSeverity[MarkerSeverity[\"Info\"] = 2] = \"Info\";\r\n    MarkerSeverity[MarkerSeverity[\"Warning\"] = 4] = \"Warning\";\r\n    MarkerSeverity[MarkerSeverity[\"Error\"] = 8] = \"Error\";\r\n})(MarkerSeverity || (MarkerSeverity = {}));\r\n/**\r\n * Virtual Key Codes, the value does not hold any inherent meaning.\r\n * Inspired somewhat from https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx\r\n * But these are \"more general\", as they should work across browsers & OS`s.\r\n */\r\nexport var KeyCode;\r\n(function (KeyCode) {\r\n    /**\r\n     * Placed first to cover the 0 value of the enum.\r\n     */\r\n    KeyCode[KeyCode[\"Unknown\"] = 0] = \"Unknown\";\r\n    KeyCode[KeyCode[\"Backspace\"] = 1] = \"Backspace\";\r\n    KeyCode[KeyCode[\"Tab\"] = 2] = \"Tab\";\r\n    KeyCode[KeyCode[\"Enter\"] = 3] = \"Enter\";\r\n    KeyCode[KeyCode[\"Shift\"] = 4] = \"Shift\";\r\n    KeyCode[KeyCode[\"Ctrl\"] = 5] = \"Ctrl\";\r\n    KeyCode[KeyCode[\"Alt\"] = 6] = \"Alt\";\r\n    KeyCode[KeyCode[\"PauseBreak\"] = 7] = \"PauseBreak\";\r\n    KeyCode[KeyCode[\"CapsLock\"] = 8] = \"CapsLock\";\r\n    KeyCode[KeyCode[\"Escape\"] = 9] = \"Escape\";\r\n    KeyCode[KeyCode[\"Space\"] = 10] = \"Space\";\r\n    KeyCode[KeyCode[\"PageUp\"] = 11] = \"PageUp\";\r\n    KeyCode[KeyCode[\"PageDown\"] = 12] = \"PageDown\";\r\n    KeyCode[KeyCode[\"End\"] = 13] = \"End\";\r\n    KeyCode[KeyCode[\"Home\"] = 14] = \"Home\";\r\n    KeyCode[KeyCode[\"LeftArrow\"] = 15] = \"LeftArrow\";\r\n    KeyCode[KeyCode[\"UpArrow\"] = 16] = \"UpArrow\";\r\n    KeyCode[KeyCode[\"RightArrow\"] = 17] = \"RightArrow\";\r\n    KeyCode[KeyCode[\"DownArrow\"] = 18] = \"DownArrow\";\r\n    KeyCode[KeyCode[\"Insert\"] = 19] = \"Insert\";\r\n    KeyCode[KeyCode[\"Delete\"] = 20] = \"Delete\";\r\n    KeyCode[KeyCode[\"KEY_0\"] = 21] = \"KEY_0\";\r\n    KeyCode[KeyCode[\"KEY_1\"] = 22] = \"KEY_1\";\r\n    KeyCode[KeyCode[\"KEY_2\"] = 23] = \"KEY_2\";\r\n    KeyCode[KeyCode[\"KEY_3\"] = 24] = \"KEY_3\";\r\n    KeyCode[KeyCode[\"KEY_4\"] = 25] = \"KEY_4\";\r\n    KeyCode[KeyCode[\"KEY_5\"] = 26] = \"KEY_5\";\r\n    KeyCode[KeyCode[\"KEY_6\"] = 27] = \"KEY_6\";\r\n    KeyCode[KeyCode[\"KEY_7\"] = 28] = \"KEY_7\";\r\n    KeyCode[KeyCode[\"KEY_8\"] = 29] = \"KEY_8\";\r\n    KeyCode[KeyCode[\"KEY_9\"] = 30] = \"KEY_9\";\r\n    KeyCode[KeyCode[\"KEY_A\"] = 31] = \"KEY_A\";\r\n    KeyCode[KeyCode[\"KEY_B\"] = 32] = \"KEY_B\";\r\n    KeyCode[KeyCode[\"KEY_C\"] = 33] = \"KEY_C\";\r\n    KeyCode[KeyCode[\"KEY_D\"] = 34] = \"KEY_D\";\r\n    KeyCode[KeyCode[\"KEY_E\"] = 35] = \"KEY_E\";\r\n    KeyCode[KeyCode[\"KEY_F\"] = 36] = \"KEY_F\";\r\n    KeyCode[KeyCode[\"KEY_G\"] = 37] = \"KEY_G\";\r\n    KeyCode[KeyCode[\"KEY_H\"] = 38] = \"KEY_H\";\r\n    KeyCode[KeyCode[\"KEY_I\"] = 39] = \"KEY_I\";\r\n    KeyCode[KeyCode[\"KEY_J\"] = 40] = \"KEY_J\";\r\n    KeyCode[KeyCode[\"KEY_K\"] = 41] = \"KEY_K\";\r\n    KeyCode[KeyCode[\"KEY_L\"] = 42] = \"KEY_L\";\r\n    KeyCode[KeyCode[\"KEY_M\"] = 43] = \"KEY_M\";\r\n    KeyCode[KeyCode[\"KEY_N\"] = 44] = \"KEY_N\";\r\n    KeyCode[KeyCode[\"KEY_O\"] = 45] = \"KEY_O\";\r\n    KeyCode[KeyCode[\"KEY_P\"] = 46] = \"KEY_P\";\r\n    KeyCode[KeyCode[\"KEY_Q\"] = 47] = \"KEY_Q\";\r\n    KeyCode[KeyCode[\"KEY_R\"] = 48] = \"KEY_R\";\r\n    KeyCode[KeyCode[\"KEY_S\"] = 49] = \"KEY_S\";\r\n    KeyCode[KeyCode[\"KEY_T\"] = 50] = \"KEY_T\";\r\n    KeyCode[KeyCode[\"KEY_U\"] = 51] = \"KEY_U\";\r\n    KeyCode[KeyCode[\"KEY_V\"] = 52] = \"KEY_V\";\r\n    KeyCode[KeyCode[\"KEY_W\"] = 53] = \"KEY_W\";\r\n    KeyCode[KeyCode[\"KEY_X\"] = 54] = \"KEY_X\";\r\n    KeyCode[KeyCode[\"KEY_Y\"] = 55] = \"KEY_Y\";\r\n    KeyCode[KeyCode[\"KEY_Z\"] = 56] = \"KEY_Z\";\r\n    KeyCode[KeyCode[\"Meta\"] = 57] = \"Meta\";\r\n    KeyCode[KeyCode[\"ContextMenu\"] = 58] = \"ContextMenu\";\r\n    KeyCode[KeyCode[\"F1\"] = 59] = \"F1\";\r\n    KeyCode[KeyCode[\"F2\"] = 60] = \"F2\";\r\n    KeyCode[KeyCode[\"F3\"] = 61] = \"F3\";\r\n    KeyCode[KeyCode[\"F4\"] = 62] = \"F4\";\r\n    KeyCode[KeyCode[\"F5\"] = 63] = \"F5\";\r\n    KeyCode[KeyCode[\"F6\"] = 64] = \"F6\";\r\n    KeyCode[KeyCode[\"F7\"] = 65] = \"F7\";\r\n    KeyCode[KeyCode[\"F8\"] = 66] = \"F8\";\r\n    KeyCode[KeyCode[\"F9\"] = 67] = \"F9\";\r\n    KeyCode[KeyCode[\"F10\"] = 68] = \"F10\";\r\n    KeyCode[KeyCode[\"F11\"] = 69] = \"F11\";\r\n    KeyCode[KeyCode[\"F12\"] = 70] = \"F12\";\r\n    KeyCode[KeyCode[\"F13\"] = 71] = \"F13\";\r\n    KeyCode[KeyCode[\"F14\"] = 72] = \"F14\";\r\n    KeyCode[KeyCode[\"F15\"] = 73] = \"F15\";\r\n    KeyCode[KeyCode[\"F16\"] = 74] = \"F16\";\r\n    KeyCode[KeyCode[\"F17\"] = 75] = \"F17\";\r\n    KeyCode[KeyCode[\"F18\"] = 76] = \"F18\";\r\n    KeyCode[KeyCode[\"F19\"] = 77] = \"F19\";\r\n    KeyCode[KeyCode[\"NumLock\"] = 78] = \"NumLock\";\r\n    KeyCode[KeyCode[\"ScrollLock\"] = 79] = \"ScrollLock\";\r\n    /**\r\n     * Used for miscellaneous characters; it can vary by keyboard.\r\n     * For the US standard keyboard, the ';:' key\r\n     */\r\n    KeyCode[KeyCode[\"US_SEMICOLON\"] = 80] = \"US_SEMICOLON\";\r\n    /**\r\n     * For any country/region, the '+' key\r\n     * For the US standard keyboard, the '=+' key\r\n     */\r\n    KeyCode[KeyCode[\"US_EQUAL\"] = 81] = \"US_EQUAL\";\r\n    /**\r\n     * For any country/region, the ',' key\r\n     * For the US standard keyboard, the ',<' key\r\n     */\r\n    KeyCode[KeyCode[\"US_COMMA\"] = 82] = \"US_COMMA\";\r\n    /**\r\n     * For any country/region, the '-' key\r\n     * For the US standard keyboard, the '-_' key\r\n     */\r\n    KeyCode[KeyCode[\"US_MINUS\"] = 83] = \"US_MINUS\";\r\n    /**\r\n     * For any country/region, the '.' key\r\n     * For the US standard keyboard, the '.>' key\r\n     */\r\n    KeyCode[KeyCode[\"US_DOT\"] = 84] = \"US_DOT\";\r\n    /**\r\n     * Used for miscellaneous characters; it can vary by keyboard.\r\n     * For the US standard keyboard, the '/?' key\r\n     */\r\n    KeyCode[KeyCode[\"US_SLASH\"] = 85] = \"US_SLASH\";\r\n    /**\r\n     * Used for miscellaneous characters; it can vary by keyboard.\r\n     * For the US standard keyboard, the '`~' key\r\n     */\r\n    KeyCode[KeyCode[\"US_BACKTICK\"] = 86] = \"US_BACKTICK\";\r\n    /**\r\n     * Used for miscellaneous characters; it can vary by keyboard.\r\n     * For the US standard keyboard, the '[{' key\r\n     */\r\n    KeyCode[KeyCode[\"US_OPEN_SQUARE_BRACKET\"] = 87] = \"US_OPEN_SQUARE_BRACKET\";\r\n    /**\r\n     * Used for miscellaneous characters; it can vary by keyboard.\r\n     * For the US standard keyboard, the '\\|' key\r\n     */\r\n    KeyCode[KeyCode[\"US_BACKSLASH\"] = 88] = \"US_BACKSLASH\";\r\n    /**\r\n     * Used for miscellaneous characters; it can vary by keyboard.\r\n     * For the US standard keyboard, the ']}' key\r\n     */\r\n    KeyCode[KeyCode[\"US_CLOSE_SQUARE_BRACKET\"] = 89] = \"US_CLOSE_SQUARE_BRACKET\";\r\n    /**\r\n     * Used for miscellaneous characters; it can vary by keyboard.\r\n     * For the US standard keyboard, the ''\"' key\r\n     */\r\n    KeyCode[KeyCode[\"US_QUOTE\"] = 90] = \"US_QUOTE\";\r\n    /**\r\n     * Used for miscellaneous characters; it can vary by keyboard.\r\n     */\r\n    KeyCode[KeyCode[\"OEM_8\"] = 91] = \"OEM_8\";\r\n    /**\r\n     * Either the angle bracket key or the backslash key on the RT 102-key keyboard.\r\n     */\r\n    KeyCode[KeyCode[\"OEM_102\"] = 92] = \"OEM_102\";\r\n    KeyCode[KeyCode[\"NUMPAD_0\"] = 93] = \"NUMPAD_0\";\r\n    KeyCode[KeyCode[\"NUMPAD_1\"] = 94] = \"NUMPAD_1\";\r\n    KeyCode[KeyCode[\"NUMPAD_2\"] = 95] = \"NUMPAD_2\";\r\n    KeyCode[KeyCode[\"NUMPAD_3\"] = 96] = \"NUMPAD_3\";\r\n    KeyCode[KeyCode[\"NUMPAD_4\"] = 97] = \"NUMPAD_4\";\r\n    KeyCode[KeyCode[\"NUMPAD_5\"] = 98] = \"NUMPAD_5\";\r\n    KeyCode[KeyCode[\"NUMPAD_6\"] = 99] = \"NUMPAD_6\";\r\n    KeyCode[KeyCode[\"NUMPAD_7\"] = 100] = \"NUMPAD_7\";\r\n    KeyCode[KeyCode[\"NUMPAD_8\"] = 101] = \"NUMPAD_8\";\r\n    KeyCode[KeyCode[\"NUMPAD_9\"] = 102] = \"NUMPAD_9\";\r\n    KeyCode[KeyCode[\"NUMPAD_MULTIPLY\"] = 103] = \"NUMPAD_MULTIPLY\";\r\n    KeyCode[KeyCode[\"NUMPAD_ADD\"] = 104] = \"NUMPAD_ADD\";\r\n    KeyCode[KeyCode[\"NUMPAD_SEPARATOR\"] = 105] = \"NUMPAD_SEPARATOR\";\r\n    KeyCode[KeyCode[\"NUMPAD_SUBTRACT\"] = 106] = \"NUMPAD_SUBTRACT\";\r\n    KeyCode[KeyCode[\"NUMPAD_DECIMAL\"] = 107] = \"NUMPAD_DECIMAL\";\r\n    KeyCode[KeyCode[\"NUMPAD_DIVIDE\"] = 108] = \"NUMPAD_DIVIDE\";\r\n    /**\r\n     * Cover all key codes when IME is processing input.\r\n     */\r\n    KeyCode[KeyCode[\"KEY_IN_COMPOSITION\"] = 109] = \"KEY_IN_COMPOSITION\";\r\n    KeyCode[KeyCode[\"ABNT_C1\"] = 110] = \"ABNT_C1\";\r\n    KeyCode[KeyCode[\"ABNT_C2\"] = 111] = \"ABNT_C2\";\r\n    /**\r\n     * Placed last to cover the length of the enum.\r\n     * Please do not depend on this value!\r\n     */\r\n    KeyCode[KeyCode[\"MAX_VALUE\"] = 112] = \"MAX_VALUE\";\r\n})(KeyCode || (KeyCode = {}));\r\n/**\r\n * The direction of a selection.\r\n */\r\nexport var SelectionDirection;\r\n(function (SelectionDirection) {\r\n    /**\r\n     * The selection starts above where it ends.\r\n     */\r\n    SelectionDirection[SelectionDirection[\"LTR\"] = 0] = \"LTR\";\r\n    /**\r\n     * The selection starts below where it ends.\r\n     */\r\n    SelectionDirection[SelectionDirection[\"RTL\"] = 1] = \"RTL\";\r\n})(SelectionDirection || (SelectionDirection = {}));\r\nexport var ScrollbarVisibility;\r\n(function (ScrollbarVisibility) {\r\n    ScrollbarVisibility[ScrollbarVisibility[\"Auto\"] = 1] = \"Auto\";\r\n    ScrollbarVisibility[ScrollbarVisibility[\"Hidden\"] = 2] = \"Hidden\";\r\n    ScrollbarVisibility[ScrollbarVisibility[\"Visible\"] = 3] = \"Visible\";\r\n})(ScrollbarVisibility || (ScrollbarVisibility = {}));\r\n/**\r\n * Vertical Lane in the overview ruler of the editor.\r\n */\r\nexport var OverviewRulerLane;\r\n(function (OverviewRulerLane) {\r\n    OverviewRulerLane[OverviewRulerLane[\"Left\"] = 1] = \"Left\";\r\n    OverviewRulerLane[OverviewRulerLane[\"Center\"] = 2] = \"Center\";\r\n    OverviewRulerLane[OverviewRulerLane[\"Right\"] = 4] = \"Right\";\r\n    OverviewRulerLane[OverviewRulerLane[\"Full\"] = 7] = \"Full\";\r\n})(OverviewRulerLane || (OverviewRulerLane = {}));\r\n/**\r\n * End of line character preference.\r\n */\r\nexport var EndOfLinePreference;\r\n(function (EndOfLinePreference) {\r\n    /**\r\n     * Use the end of line character identified in the text buffer.\r\n     */\r\n    EndOfLinePreference[EndOfLinePreference[\"TextDefined\"] = 0] = \"TextDefined\";\r\n    /**\r\n     * Use line feed (\\n) as the end of line character.\r\n     */\r\n    EndOfLinePreference[EndOfLinePreference[\"LF\"] = 1] = \"LF\";\r\n    /**\r\n     * Use carriage return and line feed (\\r\\n) as the end of line character.\r\n     */\r\n    EndOfLinePreference[EndOfLinePreference[\"CRLF\"] = 2] = \"CRLF\";\r\n})(EndOfLinePreference || (EndOfLinePreference = {}));\r\n/**\r\n * The default end of line to use when instantiating models.\r\n */\r\nexport var DefaultEndOfLine;\r\n(function (DefaultEndOfLine) {\r\n    /**\r\n     * Use line feed (\\n) as the end of line character.\r\n     */\r\n    DefaultEndOfLine[DefaultEndOfLine[\"LF\"] = 1] = \"LF\";\r\n    /**\r\n     * Use carriage return and line feed (\\r\\n) as the end of line character.\r\n     */\r\n    DefaultEndOfLine[DefaultEndOfLine[\"CRLF\"] = 2] = \"CRLF\";\r\n})(DefaultEndOfLine || (DefaultEndOfLine = {}));\r\n/**\r\n * End of line character preference.\r\n */\r\nexport var EndOfLineSequence;\r\n(function (EndOfLineSequence) {\r\n    /**\r\n     * Use line feed (\\n) as the end of line character.\r\n     */\r\n    EndOfLineSequence[EndOfLineSequence[\"LF\"] = 0] = \"LF\";\r\n    /**\r\n     * Use carriage return and line feed (\\r\\n) as the end of line character.\r\n     */\r\n    EndOfLineSequence[EndOfLineSequence[\"CRLF\"] = 1] = \"CRLF\";\r\n})(EndOfLineSequence || (EndOfLineSequence = {}));\r\n/**\r\n * Describes the behavior of decorations when typing/editing near their edges.\r\n * Note: Please do not edit the values, as they very carefully match `DecorationRangeBehavior`\r\n */\r\nexport var TrackedRangeStickiness;\r\n(function (TrackedRangeStickiness) {\r\n    TrackedRangeStickiness[TrackedRangeStickiness[\"AlwaysGrowsWhenTypingAtEdges\"] = 0] = \"AlwaysGrowsWhenTypingAtEdges\";\r\n    TrackedRangeStickiness[TrackedRangeStickiness[\"NeverGrowsWhenTypingAtEdges\"] = 1] = \"NeverGrowsWhenTypingAtEdges\";\r\n    TrackedRangeStickiness[TrackedRangeStickiness[\"GrowsOnlyWhenTypingBefore\"] = 2] = \"GrowsOnlyWhenTypingBefore\";\r\n    TrackedRangeStickiness[TrackedRangeStickiness[\"GrowsOnlyWhenTypingAfter\"] = 3] = \"GrowsOnlyWhenTypingAfter\";\r\n})(TrackedRangeStickiness || (TrackedRangeStickiness = {}));\r\nexport var ScrollType;\r\n(function (ScrollType) {\r\n    ScrollType[ScrollType[\"Smooth\"] = 0] = \"Smooth\";\r\n    ScrollType[ScrollType[\"Immediate\"] = 1] = \"Immediate\";\r\n})(ScrollType || (ScrollType = {}));\r\n/**\r\n * Describes the reason the cursor has changed its position.\r\n */\r\nexport var CursorChangeReason;\r\n(function (CursorChangeReason) {\r\n    /**\r\n     * Unknown or not set.\r\n     */\r\n    CursorChangeReason[CursorChangeReason[\"NotSet\"] = 0] = \"NotSet\";\r\n    /**\r\n     * A `model.setValue()` was called.\r\n     */\r\n    CursorChangeReason[CursorChangeReason[\"ContentFlush\"] = 1] = \"ContentFlush\";\r\n    /**\r\n     * The `model` has been changed outside of this cursor and the cursor recovers its position from associated markers.\r\n     */\r\n    CursorChangeReason[CursorChangeReason[\"RecoverFromMarkers\"] = 2] = \"RecoverFromMarkers\";\r\n    /**\r\n     * There was an explicit user gesture.\r\n     */\r\n    CursorChangeReason[CursorChangeReason[\"Explicit\"] = 3] = \"Explicit\";\r\n    /**\r\n     * There was a Paste.\r\n     */\r\n    CursorChangeReason[CursorChangeReason[\"Paste\"] = 4] = \"Paste\";\r\n    /**\r\n     * There was an Undo.\r\n     */\r\n    CursorChangeReason[CursorChangeReason[\"Undo\"] = 5] = \"Undo\";\r\n    /**\r\n     * There was a Redo.\r\n     */\r\n    CursorChangeReason[CursorChangeReason[\"Redo\"] = 6] = \"Redo\";\r\n})(CursorChangeReason || (CursorChangeReason = {}));\r\nexport var RenderMinimap;\r\n(function (RenderMinimap) {\r\n    RenderMinimap[RenderMinimap[\"None\"] = 0] = \"None\";\r\n    RenderMinimap[RenderMinimap[\"Small\"] = 1] = \"Small\";\r\n    RenderMinimap[RenderMinimap[\"Large\"] = 2] = \"Large\";\r\n    RenderMinimap[RenderMinimap[\"SmallBlocks\"] = 3] = \"SmallBlocks\";\r\n    RenderMinimap[RenderMinimap[\"LargeBlocks\"] = 4] = \"LargeBlocks\";\r\n})(RenderMinimap || (RenderMinimap = {}));\r\n/**\r\n * Describes how to indent wrapped lines.\r\n */\r\nexport var WrappingIndent;\r\n(function (WrappingIndent) {\r\n    /**\r\n     * No indentation => wrapped lines begin at column 1.\r\n     */\r\n    WrappingIndent[WrappingIndent[\"None\"] = 0] = \"None\";\r\n    /**\r\n     * Same => wrapped lines get the same indentation as the parent.\r\n     */\r\n    WrappingIndent[WrappingIndent[\"Same\"] = 1] = \"Same\";\r\n    /**\r\n     * Indent => wrapped lines get +1 indentation toward the parent.\r\n     */\r\n    WrappingIndent[WrappingIndent[\"Indent\"] = 2] = \"Indent\";\r\n    /**\r\n     * DeepIndent => wrapped lines get +2 indentation toward the parent.\r\n     */\r\n    WrappingIndent[WrappingIndent[\"DeepIndent\"] = 3] = \"DeepIndent\";\r\n})(WrappingIndent || (WrappingIndent = {}));\r\n/**\r\n * The kind of animation in which the editor's cursor should be rendered.\r\n */\r\nexport var TextEditorCursorBlinkingStyle;\r\n(function (TextEditorCursorBlinkingStyle) {\r\n    /**\r\n     * Hidden\r\n     */\r\n    TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle[\"Hidden\"] = 0] = \"Hidden\";\r\n    /**\r\n     * Blinking\r\n     */\r\n    TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle[\"Blink\"] = 1] = \"Blink\";\r\n    /**\r\n     * Blinking with smooth fading\r\n     */\r\n    TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle[\"Smooth\"] = 2] = \"Smooth\";\r\n    /**\r\n     * Blinking with prolonged filled state and smooth fading\r\n     */\r\n    TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle[\"Phase\"] = 3] = \"Phase\";\r\n    /**\r\n     * Expand collapse animation on the y axis\r\n     */\r\n    TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle[\"Expand\"] = 4] = \"Expand\";\r\n    /**\r\n     * No-Blinking\r\n     */\r\n    TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle[\"Solid\"] = 5] = \"Solid\";\r\n})(TextEditorCursorBlinkingStyle || (TextEditorCursorBlinkingStyle = {}));\r\n/**\r\n * The style in which the editor's cursor should be rendered.\r\n */\r\nexport var TextEditorCursorStyle;\r\n(function (TextEditorCursorStyle) {\r\n    /**\r\n     * As a vertical line (sitting between two characters).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"Line\"] = 1] = \"Line\";\r\n    /**\r\n     * As a block (sitting on top of a character).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"Block\"] = 2] = \"Block\";\r\n    /**\r\n     * As a horizontal line (sitting under a character).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"Underline\"] = 3] = \"Underline\";\r\n    /**\r\n     * As a thin vertical line (sitting between two characters).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"LineThin\"] = 4] = \"LineThin\";\r\n    /**\r\n     * As an outlined block (sitting on top of a character).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"BlockOutline\"] = 5] = \"BlockOutline\";\r\n    /**\r\n     * As a thin horizontal line (sitting under a character).\r\n     */\r\n    TextEditorCursorStyle[TextEditorCursorStyle[\"UnderlineThin\"] = 6] = \"UnderlineThin\";\r\n})(TextEditorCursorStyle || (TextEditorCursorStyle = {}));\r\nexport var RenderLineNumbersType;\r\n(function (RenderLineNumbersType) {\r\n    RenderLineNumbersType[RenderLineNumbersType[\"Off\"] = 0] = \"Off\";\r\n    RenderLineNumbersType[RenderLineNumbersType[\"On\"] = 1] = \"On\";\r\n    RenderLineNumbersType[RenderLineNumbersType[\"Relative\"] = 2] = \"Relative\";\r\n    RenderLineNumbersType[RenderLineNumbersType[\"Interval\"] = 3] = \"Interval\";\r\n    RenderLineNumbersType[RenderLineNumbersType[\"Custom\"] = 4] = \"Custom\";\r\n})(RenderLineNumbersType || (RenderLineNumbersType = {}));\r\n/**\r\n * A positioning preference for rendering content widgets.\r\n */\r\nexport var ContentWidgetPositionPreference;\r\n(function (ContentWidgetPositionPreference) {\r\n    /**\r\n     * Place the content widget exactly at a position\r\n     */\r\n    ContentWidgetPositionPreference[ContentWidgetPositionPreference[\"EXACT\"] = 0] = \"EXACT\";\r\n    /**\r\n     * Place the content widget above a position\r\n     */\r\n    ContentWidgetPositionPreference[ContentWidgetPositionPreference[\"ABOVE\"] = 1] = \"ABOVE\";\r\n    /**\r\n     * Place the content widget below a position\r\n     */\r\n    ContentWidgetPositionPreference[ContentWidgetPositionPreference[\"BELOW\"] = 2] = \"BELOW\";\r\n})(ContentWidgetPositionPreference || (ContentWidgetPositionPreference = {}));\r\n/**\r\n * A positioning preference for rendering overlay widgets.\r\n */\r\nexport var OverlayWidgetPositionPreference;\r\n(function (OverlayWidgetPositionPreference) {\r\n    /**\r\n     * Position the overlay widget in the top right corner\r\n     */\r\n    OverlayWidgetPositionPreference[OverlayWidgetPositionPreference[\"TOP_RIGHT_CORNER\"] = 0] = \"TOP_RIGHT_CORNER\";\r\n    /**\r\n     * Position the overlay widget in the bottom right corner\r\n     */\r\n    OverlayWidgetPositionPreference[OverlayWidgetPositionPreference[\"BOTTOM_RIGHT_CORNER\"] = 1] = \"BOTTOM_RIGHT_CORNER\";\r\n    /**\r\n     * Position the overlay widget in the top center\r\n     */\r\n    OverlayWidgetPositionPreference[OverlayWidgetPositionPreference[\"TOP_CENTER\"] = 2] = \"TOP_CENTER\";\r\n})(OverlayWidgetPositionPreference || (OverlayWidgetPositionPreference = {}));\r\n/**\r\n * Type of hit element with the mouse in the editor.\r\n */\r\nexport var MouseTargetType;\r\n(function (MouseTargetType) {\r\n    /**\r\n     * Mouse is on top of an unknown element.\r\n     */\r\n    MouseTargetType[MouseTargetType[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\r\n    /**\r\n     * Mouse is on top of the textarea used for input.\r\n     */\r\n    MouseTargetType[MouseTargetType[\"TEXTAREA\"] = 1] = \"TEXTAREA\";\r\n    /**\r\n     * Mouse is on top of the glyph margin\r\n     */\r\n    MouseTargetType[MouseTargetType[\"GUTTER_GLYPH_MARGIN\"] = 2] = \"GUTTER_GLYPH_MARGIN\";\r\n    /**\r\n     * Mouse is on top of the line numbers\r\n     */\r\n    MouseTargetType[MouseTargetType[\"GUTTER_LINE_NUMBERS\"] = 3] = \"GUTTER_LINE_NUMBERS\";\r\n    /**\r\n     * Mouse is on top of the line decorations\r\n     */\r\n    MouseTargetType[MouseTargetType[\"GUTTER_LINE_DECORATIONS\"] = 4] = \"GUTTER_LINE_DECORATIONS\";\r\n    /**\r\n     * Mouse is on top of the whitespace left in the gutter by a view zone.\r\n     */\r\n    MouseTargetType[MouseTargetType[\"GUTTER_VIEW_ZONE\"] = 5] = \"GUTTER_VIEW_ZONE\";\r\n    /**\r\n     * Mouse is on top of text in the content.\r\n     */\r\n    MouseTargetType[MouseTargetType[\"CONTENT_TEXT\"] = 6] = \"CONTENT_TEXT\";\r\n    /**\r\n     * Mouse is on top of empty space in the content (e.g. after line text or below last line)\r\n     */\r\n    MouseTargetType[MouseTargetType[\"CONTENT_EMPTY\"] = 7] = \"CONTENT_EMPTY\";\r\n    /**\r\n     * Mouse is on top of a view zone in the content.\r\n     */\r\n    MouseTargetType[MouseTargetType[\"CONTENT_VIEW_ZONE\"] = 8] = \"CONTENT_VIEW_ZONE\";\r\n    /**\r\n     * Mouse is on top of a content widget.\r\n     */\r\n    MouseTargetType[MouseTargetType[\"CONTENT_WIDGET\"] = 9] = \"CONTENT_WIDGET\";\r\n    /**\r\n     * Mouse is on top of the decorations overview ruler.\r\n     */\r\n    MouseTargetType[MouseTargetType[\"OVERVIEW_RULER\"] = 10] = \"OVERVIEW_RULER\";\r\n    /**\r\n     * Mouse is on top of a scrollbar.\r\n     */\r\n    MouseTargetType[MouseTargetType[\"SCROLLBAR\"] = 11] = \"SCROLLBAR\";\r\n    /**\r\n     * Mouse is on top of an overlay widget.\r\n     */\r\n    MouseTargetType[MouseTargetType[\"OVERLAY_WIDGET\"] = 12] = \"OVERLAY_WIDGET\";\r\n    /**\r\n     * Mouse is outside of the editor.\r\n     */\r\n    MouseTargetType[MouseTargetType[\"OUTSIDE_EDITOR\"] = 13] = \"OUTSIDE_EDITOR\";\r\n})(MouseTargetType || (MouseTargetType = {}));\r\n/**\r\n * Describes what to do with the indentation when pressing Enter.\r\n */\r\nexport var IndentAction;\r\n(function (IndentAction) {\r\n    /**\r\n     * Insert new line and copy the previous line's indentation.\r\n     */\r\n    IndentAction[IndentAction[\"None\"] = 0] = \"None\";\r\n    /**\r\n     * Insert new line and indent once (relative to the previous line's indentation).\r\n     */\r\n    IndentAction[IndentAction[\"Indent\"] = 1] = \"Indent\";\r\n    /**\r\n     * Insert two new lines:\r\n     *  - the first one indented which will hold the cursor\r\n     *  - the second one at the same indentation level\r\n     */\r\n    IndentAction[IndentAction[\"IndentOutdent\"] = 2] = \"IndentOutdent\";\r\n    /**\r\n     * Insert new line and outdent once (relative to the previous line's indentation).\r\n     */\r\n    IndentAction[IndentAction[\"Outdent\"] = 3] = \"Outdent\";\r\n})(IndentAction || (IndentAction = {}));\r\nexport var CompletionItemKind;\r\n(function (CompletionItemKind) {\r\n    CompletionItemKind[CompletionItemKind[\"Method\"] = 0] = \"Method\";\r\n    CompletionItemKind[CompletionItemKind[\"Function\"] = 1] = \"Function\";\r\n    CompletionItemKind[CompletionItemKind[\"Constructor\"] = 2] = \"Constructor\";\r\n    CompletionItemKind[CompletionItemKind[\"Field\"] = 3] = \"Field\";\r\n    CompletionItemKind[CompletionItemKind[\"Variable\"] = 4] = \"Variable\";\r\n    CompletionItemKind[CompletionItemKind[\"Class\"] = 5] = \"Class\";\r\n    CompletionItemKind[CompletionItemKind[\"Struct\"] = 6] = \"Struct\";\r\n    CompletionItemKind[CompletionItemKind[\"Interface\"] = 7] = \"Interface\";\r\n    CompletionItemKind[CompletionItemKind[\"Module\"] = 8] = \"Module\";\r\n    CompletionItemKind[CompletionItemKind[\"Property\"] = 9] = \"Property\";\r\n    CompletionItemKind[CompletionItemKind[\"Event\"] = 10] = \"Event\";\r\n    CompletionItemKind[CompletionItemKind[\"Operator\"] = 11] = \"Operator\";\r\n    CompletionItemKind[CompletionItemKind[\"Unit\"] = 12] = \"Unit\";\r\n    CompletionItemKind[CompletionItemKind[\"Value\"] = 13] = \"Value\";\r\n    CompletionItemKind[CompletionItemKind[\"Constant\"] = 14] = \"Constant\";\r\n    CompletionItemKind[CompletionItemKind[\"Enum\"] = 15] = \"Enum\";\r\n    CompletionItemKind[CompletionItemKind[\"EnumMember\"] = 16] = \"EnumMember\";\r\n    CompletionItemKind[CompletionItemKind[\"Keyword\"] = 17] = \"Keyword\";\r\n    CompletionItemKind[CompletionItemKind[\"Text\"] = 18] = \"Text\";\r\n    CompletionItemKind[CompletionItemKind[\"Color\"] = 19] = \"Color\";\r\n    CompletionItemKind[CompletionItemKind[\"File\"] = 20] = \"File\";\r\n    CompletionItemKind[CompletionItemKind[\"Reference\"] = 21] = \"Reference\";\r\n    CompletionItemKind[CompletionItemKind[\"Customcolor\"] = 22] = \"Customcolor\";\r\n    CompletionItemKind[CompletionItemKind[\"Folder\"] = 23] = \"Folder\";\r\n    CompletionItemKind[CompletionItemKind[\"TypeParameter\"] = 24] = \"TypeParameter\";\r\n    CompletionItemKind[CompletionItemKind[\"Snippet\"] = 25] = \"Snippet\";\r\n})(CompletionItemKind || (CompletionItemKind = {}));\r\nexport var CompletionItemInsertTextRule;\r\n(function (CompletionItemInsertTextRule) {\r\n    /**\r\n     * Adjust whitespace/indentation of multiline insert texts to\r\n     * match the current line indentation.\r\n     */\r\n    CompletionItemInsertTextRule[CompletionItemInsertTextRule[\"KeepWhitespace\"] = 1] = \"KeepWhitespace\";\r\n    /**\r\n     * `insertText` is a snippet.\r\n     */\r\n    CompletionItemInsertTextRule[CompletionItemInsertTextRule[\"InsertAsSnippet\"] = 4] = \"InsertAsSnippet\";\r\n})(CompletionItemInsertTextRule || (CompletionItemInsertTextRule = {}));\r\n/**\r\n * How a suggest provider was triggered.\r\n */\r\nexport var CompletionTriggerKind;\r\n(function (CompletionTriggerKind) {\r\n    CompletionTriggerKind[CompletionTriggerKind[\"Invoke\"] = 0] = \"Invoke\";\r\n    CompletionTriggerKind[CompletionTriggerKind[\"TriggerCharacter\"] = 1] = \"TriggerCharacter\";\r\n    CompletionTriggerKind[CompletionTriggerKind[\"TriggerForIncompleteCompletions\"] = 2] = \"TriggerForIncompleteCompletions\";\r\n})(CompletionTriggerKind || (CompletionTriggerKind = {}));\r\nexport var SignatureHelpTriggerReason;\r\n(function (SignatureHelpTriggerReason) {\r\n    SignatureHelpTriggerReason[SignatureHelpTriggerReason[\"Invoke\"] = 1] = \"Invoke\";\r\n    SignatureHelpTriggerReason[SignatureHelpTriggerReason[\"TriggerCharacter\"] = 2] = \"TriggerCharacter\";\r\n    SignatureHelpTriggerReason[SignatureHelpTriggerReason[\"ContentChange\"] = 3] = \"ContentChange\";\r\n})(SignatureHelpTriggerReason || (SignatureHelpTriggerReason = {}));\r\n/**\r\n * A document highlight kind.\r\n */\r\nexport var DocumentHighlightKind;\r\n(function (DocumentHighlightKind) {\r\n    /**\r\n     * A textual occurrence.\r\n     */\r\n    DocumentHighlightKind[DocumentHighlightKind[\"Text\"] = 0] = \"Text\";\r\n    /**\r\n     * Read-access of a symbol, like reading a variable.\r\n     */\r\n    DocumentHighlightKind[DocumentHighlightKind[\"Read\"] = 1] = \"Read\";\r\n    /**\r\n     * Write-access of a symbol, like writing to a variable.\r\n     */\r\n    DocumentHighlightKind[DocumentHighlightKind[\"Write\"] = 2] = \"Write\";\r\n})(DocumentHighlightKind || (DocumentHighlightKind = {}));\r\n/**\r\n * A symbol kind.\r\n */\r\nexport var SymbolKind;\r\n(function (SymbolKind) {\r\n    SymbolKind[SymbolKind[\"File\"] = 0] = \"File\";\r\n    SymbolKind[SymbolKind[\"Module\"] = 1] = \"Module\";\r\n    SymbolKind[SymbolKind[\"Namespace\"] = 2] = \"Namespace\";\r\n    SymbolKind[SymbolKind[\"Package\"] = 3] = \"Package\";\r\n    SymbolKind[SymbolKind[\"Class\"] = 4] = \"Class\";\r\n    SymbolKind[SymbolKind[\"Method\"] = 5] = \"Method\";\r\n    SymbolKind[SymbolKind[\"Property\"] = 6] = \"Property\";\r\n    SymbolKind[SymbolKind[\"Field\"] = 7] = \"Field\";\r\n    SymbolKind[SymbolKind[\"Constructor\"] = 8] = \"Constructor\";\r\n    SymbolKind[SymbolKind[\"Enum\"] = 9] = \"Enum\";\r\n    SymbolKind[SymbolKind[\"Interface\"] = 10] = \"Interface\";\r\n    SymbolKind[SymbolKind[\"Function\"] = 11] = \"Function\";\r\n    SymbolKind[SymbolKind[\"Variable\"] = 12] = \"Variable\";\r\n    SymbolKind[SymbolKind[\"Constant\"] = 13] = \"Constant\";\r\n    SymbolKind[SymbolKind[\"String\"] = 14] = \"String\";\r\n    SymbolKind[SymbolKind[\"Number\"] = 15] = \"Number\";\r\n    SymbolKind[SymbolKind[\"Boolean\"] = 16] = \"Boolean\";\r\n    SymbolKind[SymbolKind[\"Array\"] = 17] = \"Array\";\r\n    SymbolKind[SymbolKind[\"Object\"] = 18] = \"Object\";\r\n    SymbolKind[SymbolKind[\"Key\"] = 19] = \"Key\";\r\n    SymbolKind[SymbolKind[\"Null\"] = 20] = \"Null\";\r\n    SymbolKind[SymbolKind[\"EnumMember\"] = 21] = \"EnumMember\";\r\n    SymbolKind[SymbolKind[\"Struct\"] = 22] = \"Struct\";\r\n    SymbolKind[SymbolKind[\"Event\"] = 23] = \"Event\";\r\n    SymbolKind[SymbolKind[\"Operator\"] = 24] = \"Operator\";\r\n    SymbolKind[SymbolKind[\"TypeParameter\"] = 25] = \"TypeParameter\";\r\n})(SymbolKind || (SymbolKind = {}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { TPromise } from '../../../base/common/winjs.base.js';\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nimport { Selection } from '../core/selection.js';\r\nimport { Token } from '../core/token.js';\r\nimport * as standaloneEnums from './standaloneEnums.js';\r\nvar KeyMod = /** @class */ (function () {\r\n    function KeyMod() {\r\n    }\r\n    KeyMod.chord = function (firstPart, secondPart) {\r\n        return KeyChord(firstPart, secondPart);\r\n    };\r\n    KeyMod.CtrlCmd = 2048 /* CtrlCmd */;\r\n    KeyMod.Shift = 1024 /* Shift */;\r\n    KeyMod.Alt = 512 /* Alt */;\r\n    KeyMod.WinCtrl = 256 /* WinCtrl */;\r\n    return KeyMod;\r\n}());\r\nexport { KeyMod };\r\nexport function createMonacoBaseAPI() {\r\n    return {\r\n        editor: undefined,\r\n        languages: undefined,\r\n        CancellationTokenSource: CancellationTokenSource,\r\n        Emitter: Emitter,\r\n        KeyCode: standaloneEnums.KeyCode,\r\n        KeyMod: KeyMod,\r\n        Position: Position,\r\n        Range: Range,\r\n        Selection: Selection,\r\n        SelectionDirection: standaloneEnums.SelectionDirection,\r\n        MarkerSeverity: standaloneEnums.MarkerSeverity,\r\n        MarkerTag: standaloneEnums.MarkerTag,\r\n        Promise: TPromise,\r\n        Uri: URI,\r\n        Token: Token\r\n    };\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n// ------ internal util\r\nexport var _util;\r\n(function (_util) {\r\n    _util.serviceIds = new Map();\r\n    _util.DI_TARGET = '$di$target';\r\n    _util.DI_DEPENDENCIES = '$di$dependencies';\r\n    function getServiceDependencies(ctor) {\r\n        return ctor[_util.DI_DEPENDENCIES] || [];\r\n    }\r\n    _util.getServiceDependencies = getServiceDependencies;\r\n})(_util || (_util = {}));\r\nexport var IInstantiationService = createDecorator('instantiationService');\r\nfunction storeServiceDependency(id, target, index, optional) {\r\n    if (target[_util.DI_TARGET] === target) {\r\n        target[_util.DI_DEPENDENCIES].push({ id: id, index: index, optional: optional });\r\n    }\r\n    else {\r\n        target[_util.DI_DEPENDENCIES] = [{ id: id, index: index, optional: optional }];\r\n        target[_util.DI_TARGET] = target;\r\n    }\r\n}\r\n/**\r\n * A *only* valid way to create a {{ServiceIdentifier}}.\r\n */\r\nexport function createDecorator(serviceId) {\r\n    if (_util.serviceIds.has(serviceId)) {\r\n        return _util.serviceIds.get(serviceId);\r\n    }\r\n    var id = function (target, key, index) {\r\n        if (arguments.length !== 3) {\r\n            throw new Error('@IServiceName-decorator can only be used to decorate a parameter');\r\n        }\r\n        storeServiceDependency(id, target, index, false);\r\n    };\r\n    id.toString = function () { return serviceId; };\r\n    _util.serviceIds.set(serviceId, id);\r\n    return id;\r\n}\r\n/**\r\n * Mark a service dependency as optional.\r\n */\r\nexport function optional(serviceIdentifier) {\r\n    return function (target, key, index) {\r\n        if (arguments.length !== 3) {\r\n            throw new Error('@optional-decorator can only be used to decorate a parameter');\r\n        }\r\n        storeServiceDependency(serviceIdentifier, target, index, true);\r\n    };\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nexport var ICodeEditorService = createDecorator('codeEditorService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../common/event.js';\r\nvar WindowManager = /** @class */ (function () {\r\n    function WindowManager() {\r\n        // --- Zoom Level\r\n        this._zoomLevel = 0;\r\n        this._lastZoomLevelChangeTime = 0;\r\n        this._onDidChangeZoomLevel = new Emitter();\r\n        this.onDidChangeZoomLevel = this._onDidChangeZoomLevel.event;\r\n        // --- Accessibility\r\n        this._accessibilitySupport = 0 /* Unknown */;\r\n        this._onDidChangeAccessibilitySupport = new Emitter();\r\n        this.onDidChangeAccessibilitySupport = this._onDidChangeAccessibilitySupport.event;\r\n    }\r\n    WindowManager.prototype.getZoomLevel = function () {\r\n        return this._zoomLevel;\r\n    };\r\n    WindowManager.prototype.getTimeSinceLastZoomLevelChanged = function () {\r\n        return Date.now() - this._lastZoomLevelChangeTime;\r\n    };\r\n    // --- Pixel Ratio\r\n    WindowManager.prototype.getPixelRatio = function () {\r\n        var ctx = document.createElement('canvas').getContext('2d');\r\n        var dpr = window.devicePixelRatio || 1;\r\n        var bsr = ctx.webkitBackingStorePixelRatio ||\r\n            ctx.mozBackingStorePixelRatio ||\r\n            ctx.msBackingStorePixelRatio ||\r\n            ctx.oBackingStorePixelRatio ||\r\n            ctx.backingStorePixelRatio || 1;\r\n        return dpr / bsr;\r\n    };\r\n    WindowManager.prototype.getAccessibilitySupport = function () {\r\n        return this._accessibilitySupport;\r\n    };\r\n    WindowManager.INSTANCE = new WindowManager();\r\n    return WindowManager;\r\n}());\r\nexport function getZoomLevel() {\r\n    return WindowManager.INSTANCE.getZoomLevel();\r\n}\r\n/** Returns the time (in ms) since the zoom level was changed */\r\nexport function getTimeSinceLastZoomLevelChanged() {\r\n    return WindowManager.INSTANCE.getTimeSinceLastZoomLevelChanged();\r\n}\r\nexport function onDidChangeZoomLevel(callback) {\r\n    return WindowManager.INSTANCE.onDidChangeZoomLevel(callback);\r\n}\r\nexport function getPixelRatio() {\r\n    return WindowManager.INSTANCE.getPixelRatio();\r\n}\r\nexport function getAccessibilitySupport() {\r\n    return WindowManager.INSTANCE.getAccessibilitySupport();\r\n}\r\nexport function onDidChangeAccessibilitySupport(callback) {\r\n    return WindowManager.INSTANCE.onDidChangeAccessibilitySupport(callback);\r\n}\r\nvar userAgent = navigator.userAgent;\r\nexport var isIE = (userAgent.indexOf('Trident') >= 0);\r\nexport var isEdge = (userAgent.indexOf('Edge/') >= 0);\r\nexport var isEdgeOrIE = isIE || isEdge;\r\nexport var isFirefox = (userAgent.indexOf('Firefox') >= 0);\r\nexport var isWebKit = (userAgent.indexOf('AppleWebKit') >= 0);\r\nexport var isChrome = (userAgent.indexOf('Chrome') >= 0);\r\nexport var isSafari = (userAgent.indexOf('Chrome') === -1) && (userAgent.indexOf('Safari') >= 0);\r\nexport var isIPad = (userAgent.indexOf('iPad') >= 0);\r\nexport var isEdgeWebView = isEdge && (userAgent.indexOf('WebView/') >= 0);\r\nexport function hasClipboardSupport() {\r\n    if (isIE) {\r\n        return false;\r\n    }\r\n    if (isEdge) {\r\n        var index = userAgent.indexOf('Edge/');\r\n        var version = parseInt(userAgent.substring(index + 5, userAgent.indexOf('.', index)), 10);\r\n        if (!version || (version >= 12 && version <= 16)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter, mapEvent } from '../common/event.js';\r\nexport var domEvent = function (element, type, useCapture) {\r\n    var fn = function (e) { return emitter.fire(e); };\r\n    var emitter = new Emitter({\r\n        onFirstListenerAdd: function () {\r\n            element.addEventListener(type, fn, useCapture);\r\n        },\r\n        onLastListenerRemove: function () {\r\n            element.removeEventListener(type, fn, useCapture);\r\n        }\r\n    });\r\n    return emitter.event;\r\n};\r\nexport function stop(event) {\r\n    return mapEvent(event, function (e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        return e;\r\n    });\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as browser from './browser.js';\r\nimport { KeyCodeUtils, SimpleKeybinding } from '../common/keyCodes.js';\r\nimport * as platform from '../common/platform.js';\r\nvar KEY_CODE_MAP = new Array(230);\r\nvar INVERSE_KEY_CODE_MAP = new Array(112 /* MAX_VALUE */);\r\n(function () {\r\n    for (var i = 0; i < INVERSE_KEY_CODE_MAP.length; i++) {\r\n        INVERSE_KEY_CODE_MAP[i] = -1;\r\n    }\r\n    function define(code, keyCode) {\r\n        KEY_CODE_MAP[code] = keyCode;\r\n        INVERSE_KEY_CODE_MAP[keyCode] = code;\r\n    }\r\n    define(3, 7 /* PauseBreak */); // VK_CANCEL 0x03 Control-break processing\r\n    define(8, 1 /* Backspace */);\r\n    define(9, 2 /* Tab */);\r\n    define(13, 3 /* Enter */);\r\n    define(16, 4 /* Shift */);\r\n    define(17, 5 /* Ctrl */);\r\n    define(18, 6 /* Alt */);\r\n    define(19, 7 /* PauseBreak */);\r\n    define(20, 8 /* CapsLock */);\r\n    define(27, 9 /* Escape */);\r\n    define(32, 10 /* Space */);\r\n    define(33, 11 /* PageUp */);\r\n    define(34, 12 /* PageDown */);\r\n    define(35, 13 /* End */);\r\n    define(36, 14 /* Home */);\r\n    define(37, 15 /* LeftArrow */);\r\n    define(38, 16 /* UpArrow */);\r\n    define(39, 17 /* RightArrow */);\r\n    define(40, 18 /* DownArrow */);\r\n    define(45, 19 /* Insert */);\r\n    define(46, 20 /* Delete */);\r\n    define(48, 21 /* KEY_0 */);\r\n    define(49, 22 /* KEY_1 */);\r\n    define(50, 23 /* KEY_2 */);\r\n    define(51, 24 /* KEY_3 */);\r\n    define(52, 25 /* KEY_4 */);\r\n    define(53, 26 /* KEY_5 */);\r\n    define(54, 27 /* KEY_6 */);\r\n    define(55, 28 /* KEY_7 */);\r\n    define(56, 29 /* KEY_8 */);\r\n    define(57, 30 /* KEY_9 */);\r\n    define(65, 31 /* KEY_A */);\r\n    define(66, 32 /* KEY_B */);\r\n    define(67, 33 /* KEY_C */);\r\n    define(68, 34 /* KEY_D */);\r\n    define(69, 35 /* KEY_E */);\r\n    define(70, 36 /* KEY_F */);\r\n    define(71, 37 /* KEY_G */);\r\n    define(72, 38 /* KEY_H */);\r\n    define(73, 39 /* KEY_I */);\r\n    define(74, 40 /* KEY_J */);\r\n    define(75, 41 /* KEY_K */);\r\n    define(76, 42 /* KEY_L */);\r\n    define(77, 43 /* KEY_M */);\r\n    define(78, 44 /* KEY_N */);\r\n    define(79, 45 /* KEY_O */);\r\n    define(80, 46 /* KEY_P */);\r\n    define(81, 47 /* KEY_Q */);\r\n    define(82, 48 /* KEY_R */);\r\n    define(83, 49 /* KEY_S */);\r\n    define(84, 50 /* KEY_T */);\r\n    define(85, 51 /* KEY_U */);\r\n    define(86, 52 /* KEY_V */);\r\n    define(87, 53 /* KEY_W */);\r\n    define(88, 54 /* KEY_X */);\r\n    define(89, 55 /* KEY_Y */);\r\n    define(90, 56 /* KEY_Z */);\r\n    define(93, 58 /* ContextMenu */);\r\n    define(96, 93 /* NUMPAD_0 */);\r\n    define(97, 94 /* NUMPAD_1 */);\r\n    define(98, 95 /* NUMPAD_2 */);\r\n    define(99, 96 /* NUMPAD_3 */);\r\n    define(100, 97 /* NUMPAD_4 */);\r\n    define(101, 98 /* NUMPAD_5 */);\r\n    define(102, 99 /* NUMPAD_6 */);\r\n    define(103, 100 /* NUMPAD_7 */);\r\n    define(104, 101 /* NUMPAD_8 */);\r\n    define(105, 102 /* NUMPAD_9 */);\r\n    define(106, 103 /* NUMPAD_MULTIPLY */);\r\n    define(107, 104 /* NUMPAD_ADD */);\r\n    define(108, 105 /* NUMPAD_SEPARATOR */);\r\n    define(109, 106 /* NUMPAD_SUBTRACT */);\r\n    define(110, 107 /* NUMPAD_DECIMAL */);\r\n    define(111, 108 /* NUMPAD_DIVIDE */);\r\n    define(112, 59 /* F1 */);\r\n    define(113, 60 /* F2 */);\r\n    define(114, 61 /* F3 */);\r\n    define(115, 62 /* F4 */);\r\n    define(116, 63 /* F5 */);\r\n    define(117, 64 /* F6 */);\r\n    define(118, 65 /* F7 */);\r\n    define(119, 66 /* F8 */);\r\n    define(120, 67 /* F9 */);\r\n    define(121, 68 /* F10 */);\r\n    define(122, 69 /* F11 */);\r\n    define(123, 70 /* F12 */);\r\n    define(124, 71 /* F13 */);\r\n    define(125, 72 /* F14 */);\r\n    define(126, 73 /* F15 */);\r\n    define(127, 74 /* F16 */);\r\n    define(128, 75 /* F17 */);\r\n    define(129, 76 /* F18 */);\r\n    define(130, 77 /* F19 */);\r\n    define(144, 78 /* NumLock */);\r\n    define(145, 79 /* ScrollLock */);\r\n    define(186, 80 /* US_SEMICOLON */);\r\n    define(187, 81 /* US_EQUAL */);\r\n    define(188, 82 /* US_COMMA */);\r\n    define(189, 83 /* US_MINUS */);\r\n    define(190, 84 /* US_DOT */);\r\n    define(191, 85 /* US_SLASH */);\r\n    define(192, 86 /* US_BACKTICK */);\r\n    define(193, 110 /* ABNT_C1 */);\r\n    define(194, 111 /* ABNT_C2 */);\r\n    define(219, 87 /* US_OPEN_SQUARE_BRACKET */);\r\n    define(220, 88 /* US_BACKSLASH */);\r\n    define(221, 89 /* US_CLOSE_SQUARE_BRACKET */);\r\n    define(222, 90 /* US_QUOTE */);\r\n    define(223, 91 /* OEM_8 */);\r\n    define(226, 92 /* OEM_102 */);\r\n    /**\r\n     * https://lists.w3.org/Archives/Public/www-dom/2010JulSep/att-0182/keyCode-spec.html\r\n     * If an Input Method Editor is processing key input and the event is keydown, return 229.\r\n     */\r\n    define(229, 109 /* KEY_IN_COMPOSITION */);\r\n    if (browser.isIE) {\r\n        define(91, 57 /* Meta */);\r\n    }\r\n    else if (browser.isFirefox) {\r\n        define(59, 80 /* US_SEMICOLON */);\r\n        define(107, 81 /* US_EQUAL */);\r\n        define(109, 83 /* US_MINUS */);\r\n        if (platform.isMacintosh) {\r\n            define(224, 57 /* Meta */);\r\n        }\r\n    }\r\n    else if (browser.isWebKit) {\r\n        define(91, 57 /* Meta */);\r\n        if (platform.isMacintosh) {\r\n            // the two meta keys in the Mac have different key codes (91 and 93)\r\n            define(93, 57 /* Meta */);\r\n        }\r\n        else {\r\n            define(92, 57 /* Meta */);\r\n        }\r\n    }\r\n})();\r\nfunction extractKeyCode(e) {\r\n    if (e.charCode) {\r\n        // \"keypress\" events mostly\r\n        var char = String.fromCharCode(e.charCode).toUpperCase();\r\n        return KeyCodeUtils.fromString(char);\r\n    }\r\n    return KEY_CODE_MAP[e.keyCode] || 0 /* Unknown */;\r\n}\r\nvar ctrlKeyMod = (platform.isMacintosh ? 256 /* WinCtrl */ : 2048 /* CtrlCmd */);\r\nvar altKeyMod = 512 /* Alt */;\r\nvar shiftKeyMod = 1024 /* Shift */;\r\nvar metaKeyMod = (platform.isMacintosh ? 2048 /* CtrlCmd */ : 256 /* WinCtrl */);\r\nvar StandardKeyboardEvent = /** @class */ (function () {\r\n    function StandardKeyboardEvent(source) {\r\n        var e = source;\r\n        this.browserEvent = e;\r\n        this.target = e.target;\r\n        this.ctrlKey = e.ctrlKey;\r\n        this.shiftKey = e.shiftKey;\r\n        this.altKey = e.altKey;\r\n        this.metaKey = e.metaKey;\r\n        this.keyCode = extractKeyCode(e);\r\n        this.code = e.code;\r\n        // console.info(e.type + \": keyCode: \" + e.keyCode + \", which: \" + e.which + \", charCode: \" + e.charCode + \", detail: \" + e.detail + \" ====> \" + this.keyCode + ' -- ' + KeyCode[this.keyCode]);\r\n        this.ctrlKey = this.ctrlKey || this.keyCode === 5 /* Ctrl */;\r\n        this.altKey = this.altKey || this.keyCode === 6 /* Alt */;\r\n        this.shiftKey = this.shiftKey || this.keyCode === 4 /* Shift */;\r\n        this.metaKey = this.metaKey || this.keyCode === 57 /* Meta */;\r\n        this._asKeybinding = this._computeKeybinding();\r\n        this._asRuntimeKeybinding = this._computeRuntimeKeybinding();\r\n        // console.log(`code: ${e.code}, keyCode: ${e.keyCode}, key: ${e.key}`);\r\n    }\r\n    StandardKeyboardEvent.prototype.preventDefault = function () {\r\n        if (this.browserEvent && this.browserEvent.preventDefault) {\r\n            this.browserEvent.preventDefault();\r\n        }\r\n    };\r\n    StandardKeyboardEvent.prototype.stopPropagation = function () {\r\n        if (this.browserEvent && this.browserEvent.stopPropagation) {\r\n            this.browserEvent.stopPropagation();\r\n        }\r\n    };\r\n    StandardKeyboardEvent.prototype.toKeybinding = function () {\r\n        return this._asRuntimeKeybinding;\r\n    };\r\n    StandardKeyboardEvent.prototype.equals = function (other) {\r\n        return this._asKeybinding === other;\r\n    };\r\n    StandardKeyboardEvent.prototype._computeKeybinding = function () {\r\n        var key = 0 /* Unknown */;\r\n        if (this.keyCode !== 5 /* Ctrl */ && this.keyCode !== 4 /* Shift */ && this.keyCode !== 6 /* Alt */ && this.keyCode !== 57 /* Meta */) {\r\n            key = this.keyCode;\r\n        }\r\n        var result = 0;\r\n        if (this.ctrlKey) {\r\n            result |= ctrlKeyMod;\r\n        }\r\n        if (this.altKey) {\r\n            result |= altKeyMod;\r\n        }\r\n        if (this.shiftKey) {\r\n            result |= shiftKeyMod;\r\n        }\r\n        if (this.metaKey) {\r\n            result |= metaKeyMod;\r\n        }\r\n        result |= key;\r\n        return result;\r\n    };\r\n    StandardKeyboardEvent.prototype._computeRuntimeKeybinding = function () {\r\n        var key = 0 /* Unknown */;\r\n        if (this.keyCode !== 5 /* Ctrl */ && this.keyCode !== 4 /* Shift */ && this.keyCode !== 6 /* Alt */ && this.keyCode !== 57 /* Meta */) {\r\n            key = this.keyCode;\r\n        }\r\n        return new SimpleKeybinding(this.ctrlKey, this.shiftKey, this.altKey, this.metaKey, key);\r\n    };\r\n    return StandardKeyboardEvent;\r\n}());\r\nexport { StandardKeyboardEvent };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar hasDifferentOriginAncestorFlag = false;\r\nvar sameOriginWindowChainCache = null;\r\nfunction getParentWindowIfSameOrigin(w) {\r\n    if (!w.parent || w.parent === w) {\r\n        return null;\r\n    }\r\n    // Cannot really tell if we have access to the parent window unless we try to access something in it\r\n    try {\r\n        var location_1 = w.location;\r\n        var parentLocation = w.parent.location;\r\n        if (location_1.protocol !== parentLocation.protocol || location_1.hostname !== parentLocation.hostname || location_1.port !== parentLocation.port) {\r\n            hasDifferentOriginAncestorFlag = true;\r\n            return null;\r\n        }\r\n    }\r\n    catch (e) {\r\n        hasDifferentOriginAncestorFlag = true;\r\n        return null;\r\n    }\r\n    return w.parent;\r\n}\r\nfunction findIframeElementInParentWindow(parentWindow, childWindow) {\r\n    var parentWindowIframes = parentWindow.document.getElementsByTagName('iframe');\r\n    var iframe;\r\n    for (var i = 0, len = parentWindowIframes.length; i < len; i++) {\r\n        iframe = parentWindowIframes[i];\r\n        if (iframe.contentWindow === childWindow) {\r\n            return iframe;\r\n        }\r\n    }\r\n    return null;\r\n}\r\nvar IframeUtils = /** @class */ (function () {\r\n    function IframeUtils() {\r\n    }\r\n    /**\r\n     * Returns a chain of embedded windows with the same origin (which can be accessed programmatically).\r\n     * Having a chain of length 1 might mean that the current execution environment is running outside of an iframe or inside an iframe embedded in a window with a different origin.\r\n     * To distinguish if at one point the current execution environment is running inside a window with a different origin, see hasDifferentOriginAncestor()\r\n     */\r\n    IframeUtils.getSameOriginWindowChain = function () {\r\n        if (!sameOriginWindowChainCache) {\r\n            sameOriginWindowChainCache = [];\r\n            var w = window;\r\n            var parent_1;\r\n            do {\r\n                parent_1 = getParentWindowIfSameOrigin(w);\r\n                if (parent_1) {\r\n                    sameOriginWindowChainCache.push({\r\n                        window: w,\r\n                        iframeElement: findIframeElementInParentWindow(parent_1, w)\r\n                    });\r\n                }\r\n                else {\r\n                    sameOriginWindowChainCache.push({\r\n                        window: w,\r\n                        iframeElement: null\r\n                    });\r\n                }\r\n                w = parent_1;\r\n            } while (w);\r\n        }\r\n        return sameOriginWindowChainCache.slice(0);\r\n    };\r\n    /**\r\n     * Returns true if the current execution environment is chained in a list of iframes which at one point ends in a window with a different origin.\r\n     * Returns false if the current execution environment is not running inside an iframe or if the entire chain of iframes have the same origin.\r\n     */\r\n    IframeUtils.hasDifferentOriginAncestor = function () {\r\n        if (!sameOriginWindowChainCache) {\r\n            this.getSameOriginWindowChain();\r\n        }\r\n        return hasDifferentOriginAncestorFlag;\r\n    };\r\n    /**\r\n     * Returns the position of `childWindow` relative to `ancestorWindow`\r\n     */\r\n    IframeUtils.getPositionOfChildWindowRelativeToAncestorWindow = function (childWindow, ancestorWindow) {\r\n        if (!ancestorWindow || childWindow === ancestorWindow) {\r\n            return {\r\n                top: 0,\r\n                left: 0\r\n            };\r\n        }\r\n        var top = 0, left = 0;\r\n        var windowChain = this.getSameOriginWindowChain();\r\n        for (var i = 0; i < windowChain.length; i++) {\r\n            var windowChainEl = windowChain[i];\r\n            if (windowChainEl.window === ancestorWindow) {\r\n                break;\r\n            }\r\n            if (!windowChainEl.iframeElement) {\r\n                break;\r\n            }\r\n            var boundingRect = windowChainEl.iframeElement.getBoundingClientRect();\r\n            top += boundingRect.top;\r\n            left += boundingRect.left;\r\n        }\r\n        return {\r\n            top: top,\r\n            left: left\r\n        };\r\n    };\r\n    return IframeUtils;\r\n}());\r\nexport { IframeUtils };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from './browser.js';\r\nimport { IframeUtils } from './iframe.js';\r\nimport * as platform from '../common/platform.js';\r\nvar StandardMouseEvent = /** @class */ (function () {\r\n    function StandardMouseEvent(e) {\r\n        this.timestamp = Date.now();\r\n        this.browserEvent = e;\r\n        this.leftButton = e.button === 0;\r\n        this.middleButton = e.button === 1;\r\n        this.rightButton = e.button === 2;\r\n        this.target = e.target;\r\n        this.detail = e.detail || 1;\r\n        if (e.type === 'dblclick') {\r\n            this.detail = 2;\r\n        }\r\n        this.ctrlKey = e.ctrlKey;\r\n        this.shiftKey = e.shiftKey;\r\n        this.altKey = e.altKey;\r\n        this.metaKey = e.metaKey;\r\n        if (typeof e.pageX === 'number') {\r\n            this.posx = e.pageX;\r\n            this.posy = e.pageY;\r\n        }\r\n        else {\r\n            // Probably hit by MSGestureEvent\r\n            this.posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n            this.posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n        }\r\n        // Find the position of the iframe this code is executing in relative to the iframe where the event was captured.\r\n        var iframeOffsets = IframeUtils.getPositionOfChildWindowRelativeToAncestorWindow(self, e.view);\r\n        this.posx -= iframeOffsets.left;\r\n        this.posy -= iframeOffsets.top;\r\n    }\r\n    StandardMouseEvent.prototype.preventDefault = function () {\r\n        if (this.browserEvent.preventDefault) {\r\n            this.browserEvent.preventDefault();\r\n        }\r\n    };\r\n    StandardMouseEvent.prototype.stopPropagation = function () {\r\n        if (this.browserEvent.stopPropagation) {\r\n            this.browserEvent.stopPropagation();\r\n        }\r\n    };\r\n    return StandardMouseEvent;\r\n}());\r\nexport { StandardMouseEvent };\r\nvar DragMouseEvent = /** @class */ (function (_super) {\r\n    __extends(DragMouseEvent, _super);\r\n    function DragMouseEvent(e) {\r\n        var _this = _super.call(this, e) || this;\r\n        _this.dataTransfer = e.dataTransfer;\r\n        return _this;\r\n    }\r\n    return DragMouseEvent;\r\n}(StandardMouseEvent));\r\nexport { DragMouseEvent };\r\nvar StandardMouseWheelEvent = /** @class */ (function () {\r\n    function StandardMouseWheelEvent(e, deltaX, deltaY) {\r\n        if (deltaX === void 0) { deltaX = 0; }\r\n        if (deltaY === void 0) { deltaY = 0; }\r\n        this.browserEvent = e || null;\r\n        this.target = e ? (e.target || e.targetNode || e.srcElement) : null;\r\n        this.deltaY = deltaY;\r\n        this.deltaX = deltaX;\r\n        if (e) {\r\n            var e1 = e;\r\n            var e2 = e;\r\n            // vertical delta scroll\r\n            if (typeof e1.wheelDeltaY !== 'undefined') {\r\n                this.deltaY = e1.wheelDeltaY / 120;\r\n            }\r\n            else if (typeof e2.VERTICAL_AXIS !== 'undefined' && e2.axis === e2.VERTICAL_AXIS) {\r\n                this.deltaY = -e2.detail / 3;\r\n            }\r\n            // horizontal delta scroll\r\n            if (typeof e1.wheelDeltaX !== 'undefined') {\r\n                if (browser.isSafari && platform.isWindows) {\r\n                    this.deltaX = -(e1.wheelDeltaX / 120);\r\n                }\r\n                else {\r\n                    this.deltaX = e1.wheelDeltaX / 120;\r\n                }\r\n            }\r\n            else if (typeof e2.HORIZONTAL_AXIS !== 'undefined' && e2.axis === e2.HORIZONTAL_AXIS) {\r\n                this.deltaX = -e.detail / 3;\r\n            }\r\n            // Assume a vertical scroll if nothing else worked\r\n            if (this.deltaY === 0 && this.deltaX === 0 && e.wheelDelta) {\r\n                this.deltaY = e.wheelDelta / 120;\r\n            }\r\n        }\r\n    }\r\n    StandardMouseWheelEvent.prototype.preventDefault = function () {\r\n        if (this.browserEvent) {\r\n            if (this.browserEvent.preventDefault) {\r\n                this.browserEvent.preventDefault();\r\n            }\r\n        }\r\n    };\r\n    StandardMouseWheelEvent.prototype.stopPropagation = function () {\r\n        if (this.browserEvent) {\r\n            if (this.browserEvent.stopPropagation) {\r\n                this.browserEvent.stopPropagation();\r\n            }\r\n        }\r\n    };\r\n    return StandardMouseWheelEvent;\r\n}());\r\nexport { StandardMouseWheelEvent };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from './browser.js';\r\nimport { domEvent } from './event.js';\r\nimport { StandardKeyboardEvent } from './keyboardEvent.js';\r\nimport { StandardMouseEvent } from './mouseEvent.js';\r\nimport { TimeoutTimer } from '../common/async.js';\r\nimport { onUnexpectedError } from '../common/errors.js';\r\nimport { Emitter } from '../common/event.js';\r\nimport { Disposable, dispose } from '../common/lifecycle.js';\r\nimport * as platform from '../common/platform.js';\r\nexport function clearNode(node) {\r\n    while (node.firstChild) {\r\n        node.removeChild(node.firstChild);\r\n    }\r\n}\r\nexport function removeNode(node) {\r\n    if (node.parentNode) {\r\n        node.parentNode.removeChild(node);\r\n    }\r\n}\r\nexport function isInDOM(node) {\r\n    while (node) {\r\n        if (node === document.body) {\r\n            return true;\r\n        }\r\n        node = node.parentNode;\r\n    }\r\n    return false;\r\n}\r\nvar _manualClassList = new /** @class */ (function () {\r\n    function class_1() {\r\n    }\r\n    class_1.prototype._findClassName = function (node, className) {\r\n        var classes = node.className;\r\n        if (!classes) {\r\n            this._lastStart = -1;\r\n            return;\r\n        }\r\n        className = className.trim();\r\n        var classesLen = classes.length, classLen = className.length;\r\n        if (classLen === 0) {\r\n            this._lastStart = -1;\r\n            return;\r\n        }\r\n        if (classesLen < classLen) {\r\n            this._lastStart = -1;\r\n            return;\r\n        }\r\n        if (classes === className) {\r\n            this._lastStart = 0;\r\n            this._lastEnd = classesLen;\r\n            return;\r\n        }\r\n        var idx = -1, idxEnd;\r\n        while ((idx = classes.indexOf(className, idx + 1)) >= 0) {\r\n            idxEnd = idx + classLen;\r\n            // a class that is followed by another class\r\n            if ((idx === 0 || classes.charCodeAt(idx - 1) === 32 /* Space */) && classes.charCodeAt(idxEnd) === 32 /* Space */) {\r\n                this._lastStart = idx;\r\n                this._lastEnd = idxEnd + 1;\r\n                return;\r\n            }\r\n            // last class\r\n            if (idx > 0 && classes.charCodeAt(idx - 1) === 32 /* Space */ && idxEnd === classesLen) {\r\n                this._lastStart = idx - 1;\r\n                this._lastEnd = idxEnd;\r\n                return;\r\n            }\r\n            // equal - duplicate of cmp above\r\n            if (idx === 0 && idxEnd === classesLen) {\r\n                this._lastStart = 0;\r\n                this._lastEnd = idxEnd;\r\n                return;\r\n            }\r\n        }\r\n        this._lastStart = -1;\r\n    };\r\n    class_1.prototype.hasClass = function (node, className) {\r\n        this._findClassName(node, className);\r\n        return this._lastStart !== -1;\r\n    };\r\n    class_1.prototype.addClasses = function (node) {\r\n        var _this = this;\r\n        var classNames = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            classNames[_i - 1] = arguments[_i];\r\n        }\r\n        classNames.forEach(function (nameValue) { return nameValue.split(' ').forEach(function (name) { return _this.addClass(node, name); }); });\r\n    };\r\n    class_1.prototype.addClass = function (node, className) {\r\n        if (!node.className) { // doesn't have it for sure\r\n            node.className = className;\r\n        }\r\n        else {\r\n            this._findClassName(node, className); // see if it's already there\r\n            if (this._lastStart === -1) {\r\n                node.className = node.className + ' ' + className;\r\n            }\r\n        }\r\n    };\r\n    class_1.prototype.removeClass = function (node, className) {\r\n        this._findClassName(node, className);\r\n        if (this._lastStart === -1) {\r\n            return; // Prevent styles invalidation if not necessary\r\n        }\r\n        else {\r\n            node.className = node.className.substring(0, this._lastStart) + node.className.substring(this._lastEnd);\r\n        }\r\n    };\r\n    class_1.prototype.removeClasses = function (node) {\r\n        var _this = this;\r\n        var classNames = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            classNames[_i - 1] = arguments[_i];\r\n        }\r\n        classNames.forEach(function (nameValue) { return nameValue.split(' ').forEach(function (name) { return _this.removeClass(node, name); }); });\r\n    };\r\n    class_1.prototype.toggleClass = function (node, className, shouldHaveIt) {\r\n        this._findClassName(node, className);\r\n        if (this._lastStart !== -1 && (shouldHaveIt === void 0 || !shouldHaveIt)) {\r\n            this.removeClass(node, className);\r\n        }\r\n        if (this._lastStart === -1 && (shouldHaveIt === void 0 || shouldHaveIt)) {\r\n            this.addClass(node, className);\r\n        }\r\n    };\r\n    return class_1;\r\n}());\r\nvar _nativeClassList = new /** @class */ (function () {\r\n    function class_2() {\r\n    }\r\n    class_2.prototype.hasClass = function (node, className) {\r\n        return Boolean(className) && node.classList && node.classList.contains(className);\r\n    };\r\n    class_2.prototype.addClasses = function (node) {\r\n        var _this = this;\r\n        var classNames = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            classNames[_i - 1] = arguments[_i];\r\n        }\r\n        classNames.forEach(function (nameValue) { return nameValue.split(' ').forEach(function (name) { return _this.addClass(node, name); }); });\r\n    };\r\n    class_2.prototype.addClass = function (node, className) {\r\n        if (className && node.classList) {\r\n            node.classList.add(className);\r\n        }\r\n    };\r\n    class_2.prototype.removeClass = function (node, className) {\r\n        if (className && node.classList) {\r\n            node.classList.remove(className);\r\n        }\r\n    };\r\n    class_2.prototype.removeClasses = function (node) {\r\n        var _this = this;\r\n        var classNames = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            classNames[_i - 1] = arguments[_i];\r\n        }\r\n        classNames.forEach(function (nameValue) { return nameValue.split(' ').forEach(function (name) { return _this.removeClass(node, name); }); });\r\n    };\r\n    class_2.prototype.toggleClass = function (node, className, shouldHaveIt) {\r\n        if (node.classList) {\r\n            node.classList.toggle(className, shouldHaveIt);\r\n        }\r\n    };\r\n    return class_2;\r\n}());\r\n// In IE11 there is only partial support for `classList` which makes us keep our\r\n// custom implementation. Otherwise use the native implementation, see: http://caniuse.com/#search=classlist\r\nvar _classList = browser.isIE ? _manualClassList : _nativeClassList;\r\nexport var hasClass = _classList.hasClass.bind(_classList);\r\nexport var addClass = _classList.addClass.bind(_classList);\r\nexport var addClasses = _classList.addClasses.bind(_classList);\r\nexport var removeClass = _classList.removeClass.bind(_classList);\r\nexport var removeClasses = _classList.removeClasses.bind(_classList);\r\nexport var toggleClass = _classList.toggleClass.bind(_classList);\r\nvar DomListener = /** @class */ (function () {\r\n    function DomListener(node, type, handler, useCapture) {\r\n        this._node = node;\r\n        this._type = type;\r\n        this._handler = handler;\r\n        this._useCapture = (useCapture || false);\r\n        this._node.addEventListener(this._type, this._handler, this._useCapture);\r\n    }\r\n    DomListener.prototype.dispose = function () {\r\n        if (!this._handler) {\r\n            // Already disposed\r\n            return;\r\n        }\r\n        this._node.removeEventListener(this._type, this._handler, this._useCapture);\r\n        // Prevent leakers from holding on to the dom or handler func\r\n        this._node = null;\r\n        this._handler = null;\r\n    };\r\n    return DomListener;\r\n}());\r\nexport function addDisposableListener(node, type, handler, useCapture) {\r\n    return new DomListener(node, type, handler, useCapture);\r\n}\r\nfunction _wrapAsStandardMouseEvent(handler) {\r\n    return function (e) {\r\n        return handler(new StandardMouseEvent(e));\r\n    };\r\n}\r\nfunction _wrapAsStandardKeyboardEvent(handler) {\r\n    return function (e) {\r\n        return handler(new StandardKeyboardEvent(e));\r\n    };\r\n}\r\nexport var addStandardDisposableListener = function addStandardDisposableListener(node, type, handler, useCapture) {\r\n    var wrapHandler = handler;\r\n    if (type === 'click' || type === 'mousedown') {\r\n        wrapHandler = _wrapAsStandardMouseEvent(handler);\r\n    }\r\n    else if (type === 'keydown' || type === 'keypress' || type === 'keyup') {\r\n        wrapHandler = _wrapAsStandardKeyboardEvent(handler);\r\n    }\r\n    return addDisposableListener(node, type, wrapHandler, useCapture);\r\n};\r\nexport function addDisposableNonBubblingMouseOutListener(node, handler) {\r\n    return addDisposableListener(node, 'mouseout', function (e) {\r\n        // Mouse out bubbles, so this is an attempt to ignore faux mouse outs coming from children elements\r\n        var toElement = (e.relatedTarget || e.toElement);\r\n        while (toElement && toElement !== node) {\r\n            toElement = toElement.parentNode;\r\n        }\r\n        if (toElement === node) {\r\n            return;\r\n        }\r\n        handler(e);\r\n    });\r\n}\r\nvar _animationFrame = null;\r\nfunction doRequestAnimationFrame(callback) {\r\n    if (!_animationFrame) {\r\n        var emulatedRequestAnimationFrame = function (callback) {\r\n            return setTimeout(function () { return callback(new Date().getTime()); }, 0);\r\n        };\r\n        _animationFrame = (self.requestAnimationFrame\r\n            || self.msRequestAnimationFrame\r\n            || self.webkitRequestAnimationFrame\r\n            || self.mozRequestAnimationFrame\r\n            || self.oRequestAnimationFrame\r\n            || emulatedRequestAnimationFrame);\r\n    }\r\n    return _animationFrame.call(self, callback);\r\n}\r\n/**\r\n * Schedule a callback to be run at the next animation frame.\r\n * This allows multiple parties to register callbacks that should run at the next animation frame.\r\n * If currently in an animation frame, `runner` will be executed immediately.\r\n * @return token that can be used to cancel the scheduled runner (only if `runner` was not executed immediately).\r\n */\r\nexport var runAtThisOrScheduleAtNextAnimationFrame;\r\n/**\r\n * Schedule a callback to be run at the next animation frame.\r\n * This allows multiple parties to register callbacks that should run at the next animation frame.\r\n * If currently in an animation frame, `runner` will be executed at the next animation frame.\r\n * @return token that can be used to cancel the scheduled runner.\r\n */\r\nexport var scheduleAtNextAnimationFrame;\r\nvar AnimationFrameQueueItem = /** @class */ (function () {\r\n    function AnimationFrameQueueItem(runner, priority) {\r\n        if (priority === void 0) { priority = 0; }\r\n        this._runner = runner;\r\n        this.priority = priority;\r\n        this._canceled = false;\r\n    }\r\n    AnimationFrameQueueItem.prototype.dispose = function () {\r\n        this._canceled = true;\r\n    };\r\n    AnimationFrameQueueItem.prototype.execute = function () {\r\n        if (this._canceled) {\r\n            return;\r\n        }\r\n        try {\r\n            this._runner();\r\n        }\r\n        catch (e) {\r\n            onUnexpectedError(e);\r\n        }\r\n    };\r\n    // Sort by priority (largest to lowest)\r\n    AnimationFrameQueueItem.sort = function (a, b) {\r\n        return b.priority - a.priority;\r\n    };\r\n    return AnimationFrameQueueItem;\r\n}());\r\n(function () {\r\n    /**\r\n     * The runners scheduled at the next animation frame\r\n     */\r\n    var NEXT_QUEUE = [];\r\n    /**\r\n     * The runners scheduled at the current animation frame\r\n     */\r\n    var CURRENT_QUEUE = null;\r\n    /**\r\n     * A flag to keep track if the native requestAnimationFrame was already called\r\n     */\r\n    var animFrameRequested = false;\r\n    /**\r\n     * A flag to indicate if currently handling a native requestAnimationFrame callback\r\n     */\r\n    var inAnimationFrameRunner = false;\r\n    var animationFrameRunner = function () {\r\n        animFrameRequested = false;\r\n        CURRENT_QUEUE = NEXT_QUEUE;\r\n        NEXT_QUEUE = [];\r\n        inAnimationFrameRunner = true;\r\n        while (CURRENT_QUEUE.length > 0) {\r\n            CURRENT_QUEUE.sort(AnimationFrameQueueItem.sort);\r\n            var top_1 = CURRENT_QUEUE.shift();\r\n            top_1.execute();\r\n        }\r\n        inAnimationFrameRunner = false;\r\n    };\r\n    scheduleAtNextAnimationFrame = function (runner, priority) {\r\n        if (priority === void 0) { priority = 0; }\r\n        var item = new AnimationFrameQueueItem(runner, priority);\r\n        NEXT_QUEUE.push(item);\r\n        if (!animFrameRequested) {\r\n            animFrameRequested = true;\r\n            doRequestAnimationFrame(animationFrameRunner);\r\n        }\r\n        return item;\r\n    };\r\n    runAtThisOrScheduleAtNextAnimationFrame = function (runner, priority) {\r\n        if (inAnimationFrameRunner) {\r\n            var item = new AnimationFrameQueueItem(runner, priority);\r\n            CURRENT_QUEUE.push(item);\r\n            return item;\r\n        }\r\n        else {\r\n            return scheduleAtNextAnimationFrame(runner, priority);\r\n        }\r\n    };\r\n})();\r\nvar MINIMUM_TIME_MS = 16;\r\nvar DEFAULT_EVENT_MERGER = function (lastEvent, currentEvent) {\r\n    return currentEvent;\r\n};\r\nvar TimeoutThrottledDomListener = /** @class */ (function (_super) {\r\n    __extends(TimeoutThrottledDomListener, _super);\r\n    function TimeoutThrottledDomListener(node, type, handler, eventMerger, minimumTimeMs) {\r\n        if (eventMerger === void 0) { eventMerger = DEFAULT_EVENT_MERGER; }\r\n        if (minimumTimeMs === void 0) { minimumTimeMs = MINIMUM_TIME_MS; }\r\n        var _this = _super.call(this) || this;\r\n        var lastEvent = null;\r\n        var lastHandlerTime = 0;\r\n        var timeout = _this._register(new TimeoutTimer());\r\n        var invokeHandler = function () {\r\n            lastHandlerTime = (new Date()).getTime();\r\n            handler(lastEvent);\r\n            lastEvent = null;\r\n        };\r\n        _this._register(addDisposableListener(node, type, function (e) {\r\n            lastEvent = eventMerger(lastEvent, e);\r\n            var elapsedTime = (new Date()).getTime() - lastHandlerTime;\r\n            if (elapsedTime >= minimumTimeMs) {\r\n                timeout.cancel();\r\n                invokeHandler();\r\n            }\r\n            else {\r\n                timeout.setIfNotSet(invokeHandler, minimumTimeMs - elapsedTime);\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    return TimeoutThrottledDomListener;\r\n}(Disposable));\r\nexport function addDisposableThrottledListener(node, type, handler, eventMerger, minimumTimeMs) {\r\n    return new TimeoutThrottledDomListener(node, type, handler, eventMerger, minimumTimeMs);\r\n}\r\nexport function getComputedStyle(el) {\r\n    return document.defaultView.getComputedStyle(el, null);\r\n}\r\n// Adapted from WinJS\r\n// Converts a CSS positioning string for the specified element to pixels.\r\nvar convertToPixels = (function () {\r\n    return function (element, value) {\r\n        return parseFloat(value) || 0;\r\n    };\r\n})();\r\nfunction getDimension(element, cssPropertyName, jsPropertyName) {\r\n    var computedStyle = getComputedStyle(element);\r\n    var value = '0';\r\n    if (computedStyle) {\r\n        if (computedStyle.getPropertyValue) {\r\n            value = computedStyle.getPropertyValue(cssPropertyName);\r\n        }\r\n        else {\r\n            // IE8\r\n            value = computedStyle.getAttribute(jsPropertyName);\r\n        }\r\n    }\r\n    return convertToPixels(element, value);\r\n}\r\nexport function getClientArea(element) {\r\n    // Try with DOM clientWidth / clientHeight\r\n    if (element !== document.body) {\r\n        return new Dimension(element.clientWidth, element.clientHeight);\r\n    }\r\n    // Try innerWidth / innerHeight\r\n    if (window.innerWidth && window.innerHeight) {\r\n        return new Dimension(window.innerWidth, window.innerHeight);\r\n    }\r\n    // Try with document.body.clientWidth / document.body.clientHeight\r\n    if (document.body && document.body.clientWidth && document.body.clientHeight) {\r\n        return new Dimension(document.body.clientWidth, document.body.clientHeight);\r\n    }\r\n    // Try with document.documentElement.clientWidth / document.documentElement.clientHeight\r\n    if (document.documentElement && document.documentElement.clientWidth && document.documentElement.clientHeight) {\r\n        return new Dimension(document.documentElement.clientWidth, document.documentElement.clientHeight);\r\n    }\r\n    throw new Error('Unable to figure out browser width and height');\r\n}\r\nvar sizeUtils = {\r\n    getBorderLeftWidth: function (element) {\r\n        return getDimension(element, 'border-left-width', 'borderLeftWidth');\r\n    },\r\n    getBorderRightWidth: function (element) {\r\n        return getDimension(element, 'border-right-width', 'borderRightWidth');\r\n    },\r\n    getBorderTopWidth: function (element) {\r\n        return getDimension(element, 'border-top-width', 'borderTopWidth');\r\n    },\r\n    getBorderBottomWidth: function (element) {\r\n        return getDimension(element, 'border-bottom-width', 'borderBottomWidth');\r\n    },\r\n    getPaddingLeft: function (element) {\r\n        return getDimension(element, 'padding-left', 'paddingLeft');\r\n    },\r\n    getPaddingRight: function (element) {\r\n        return getDimension(element, 'padding-right', 'paddingRight');\r\n    },\r\n    getPaddingTop: function (element) {\r\n        return getDimension(element, 'padding-top', 'paddingTop');\r\n    },\r\n    getPaddingBottom: function (element) {\r\n        return getDimension(element, 'padding-bottom', 'paddingBottom');\r\n    },\r\n    getMarginLeft: function (element) {\r\n        return getDimension(element, 'margin-left', 'marginLeft');\r\n    },\r\n    getMarginTop: function (element) {\r\n        return getDimension(element, 'margin-top', 'marginTop');\r\n    },\r\n    getMarginRight: function (element) {\r\n        return getDimension(element, 'margin-right', 'marginRight');\r\n    },\r\n    getMarginBottom: function (element) {\r\n        return getDimension(element, 'margin-bottom', 'marginBottom');\r\n    },\r\n    __commaSentinel: false\r\n};\r\n// ----------------------------------------------------------------------------------------\r\n// Position & Dimension\r\nvar Dimension = /** @class */ (function () {\r\n    function Dimension(width, height) {\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n    return Dimension;\r\n}());\r\nexport { Dimension };\r\nexport function getTopLeftOffset(element) {\r\n    // Adapted from WinJS.Utilities.getPosition\r\n    // and added borders to the mix\r\n    var offsetParent = element.offsetParent, top = element.offsetTop, left = element.offsetLeft;\r\n    while ((element = element.parentNode) !== null && element !== document.body && element !== document.documentElement) {\r\n        top -= element.scrollTop;\r\n        var c = getComputedStyle(element);\r\n        if (c) {\r\n            left -= c.direction !== 'rtl' ? element.scrollLeft : -element.scrollLeft;\r\n        }\r\n        if (element === offsetParent) {\r\n            left += sizeUtils.getBorderLeftWidth(element);\r\n            top += sizeUtils.getBorderTopWidth(element);\r\n            top += element.offsetTop;\r\n            left += element.offsetLeft;\r\n            offsetParent = element.offsetParent;\r\n        }\r\n    }\r\n    return {\r\n        left: left,\r\n        top: top\r\n    };\r\n}\r\n/**\r\n * Returns the position of a dom node relative to the entire page.\r\n */\r\nexport function getDomNodePagePosition(domNode) {\r\n    var bb = domNode.getBoundingClientRect();\r\n    return {\r\n        left: bb.left + StandardWindow.scrollX,\r\n        top: bb.top + StandardWindow.scrollY,\r\n        width: bb.width,\r\n        height: bb.height\r\n    };\r\n}\r\nexport var StandardWindow = new /** @class */ (function () {\r\n    function class_3() {\r\n    }\r\n    Object.defineProperty(class_3.prototype, \"scrollX\", {\r\n        get: function () {\r\n            if (typeof window.scrollX === 'number') {\r\n                // modern browsers\r\n                return window.scrollX;\r\n            }\r\n            else {\r\n                return document.body.scrollLeft + document.documentElement.scrollLeft;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(class_3.prototype, \"scrollY\", {\r\n        get: function () {\r\n            if (typeof window.scrollY === 'number') {\r\n                // modern browsers\r\n                return window.scrollY;\r\n            }\r\n            else {\r\n                return document.body.scrollTop + document.documentElement.scrollTop;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return class_3;\r\n}());\r\n// Adapted from WinJS\r\n// Gets the width of the element, including margins.\r\nexport function getTotalWidth(element) {\r\n    var margin = sizeUtils.getMarginLeft(element) + sizeUtils.getMarginRight(element);\r\n    return element.offsetWidth + margin;\r\n}\r\nexport function getContentWidth(element) {\r\n    var border = sizeUtils.getBorderLeftWidth(element) + sizeUtils.getBorderRightWidth(element);\r\n    var padding = sizeUtils.getPaddingLeft(element) + sizeUtils.getPaddingRight(element);\r\n    return element.offsetWidth - border - padding;\r\n}\r\n// Adapted from WinJS\r\n// Gets the height of the content of the specified element. The content height does not include borders or padding.\r\nexport function getContentHeight(element) {\r\n    var border = sizeUtils.getBorderTopWidth(element) + sizeUtils.getBorderBottomWidth(element);\r\n    var padding = sizeUtils.getPaddingTop(element) + sizeUtils.getPaddingBottom(element);\r\n    return element.offsetHeight - border - padding;\r\n}\r\n// Adapted from WinJS\r\n// Gets the height of the element, including its margins.\r\nexport function getTotalHeight(element) {\r\n    var margin = sizeUtils.getMarginTop(element) + sizeUtils.getMarginBottom(element);\r\n    return element.offsetHeight + margin;\r\n}\r\n// ----------------------------------------------------------------------------------------\r\nexport function isAncestor(testChild, testAncestor) {\r\n    while (testChild) {\r\n        if (testChild === testAncestor) {\r\n            return true;\r\n        }\r\n        testChild = testChild.parentNode;\r\n    }\r\n    return false;\r\n}\r\nexport function findParentWithClass(node, clazz, stopAtClazzOrNode) {\r\n    while (node) {\r\n        if (hasClass(node, clazz)) {\r\n            return node;\r\n        }\r\n        if (stopAtClazzOrNode) {\r\n            if (typeof stopAtClazzOrNode === 'string') {\r\n                if (hasClass(node, stopAtClazzOrNode)) {\r\n                    return null;\r\n                }\r\n            }\r\n            else {\r\n                if (node === stopAtClazzOrNode) {\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n        node = node.parentNode;\r\n    }\r\n    return null;\r\n}\r\nexport function createStyleSheet(container) {\r\n    if (container === void 0) { container = document.getElementsByTagName('head')[0]; }\r\n    var style = document.createElement('style');\r\n    style.type = 'text/css';\r\n    style.media = 'screen';\r\n    container.appendChild(style);\r\n    return style;\r\n}\r\nvar _sharedStyleSheet = null;\r\nfunction getSharedStyleSheet() {\r\n    if (!_sharedStyleSheet) {\r\n        _sharedStyleSheet = createStyleSheet();\r\n    }\r\n    return _sharedStyleSheet;\r\n}\r\nfunction getDynamicStyleSheetRules(style) {\r\n    if (style && style.sheet && style.sheet.rules) {\r\n        // Chrome, IE\r\n        return style.sheet.rules;\r\n    }\r\n    if (style && style.sheet && style.sheet.cssRules) {\r\n        // FF\r\n        return style.sheet.cssRules;\r\n    }\r\n    return [];\r\n}\r\nexport function createCSSRule(selector, cssText, style) {\r\n    if (style === void 0) { style = getSharedStyleSheet(); }\r\n    if (!style || !cssText) {\r\n        return;\r\n    }\r\n    style.sheet.insertRule(selector + '{' + cssText + '}', 0);\r\n}\r\nexport function removeCSSRulesContainingSelector(ruleName, style) {\r\n    if (style === void 0) { style = getSharedStyleSheet(); }\r\n    if (!style) {\r\n        return;\r\n    }\r\n    var rules = getDynamicStyleSheetRules(style);\r\n    var toDelete = [];\r\n    for (var i = 0; i < rules.length; i++) {\r\n        var rule = rules[i];\r\n        if (rule.selectorText.indexOf(ruleName) !== -1) {\r\n            toDelete.push(i);\r\n        }\r\n    }\r\n    for (var i = toDelete.length - 1; i >= 0; i--) {\r\n        style.sheet.deleteRule(toDelete[i]);\r\n    }\r\n}\r\nexport function isHTMLElement(o) {\r\n    if (typeof HTMLElement === 'object') {\r\n        return o instanceof HTMLElement;\r\n    }\r\n    return o && typeof o === 'object' && o.nodeType === 1 && typeof o.nodeName === 'string';\r\n}\r\nexport var EventType = {\r\n    // Mouse\r\n    CLICK: 'click',\r\n    DBLCLICK: 'dblclick',\r\n    MOUSE_UP: 'mouseup',\r\n    MOUSE_DOWN: 'mousedown',\r\n    MOUSE_OVER: 'mouseover',\r\n    MOUSE_MOVE: 'mousemove',\r\n    MOUSE_OUT: 'mouseout',\r\n    MOUSE_ENTER: 'mouseenter',\r\n    MOUSE_LEAVE: 'mouseleave',\r\n    CONTEXT_MENU: 'contextmenu',\r\n    WHEEL: 'wheel',\r\n    // Keyboard\r\n    KEY_DOWN: 'keydown',\r\n    KEY_PRESS: 'keypress',\r\n    KEY_UP: 'keyup',\r\n    // HTML Document\r\n    LOAD: 'load',\r\n    UNLOAD: 'unload',\r\n    ABORT: 'abort',\r\n    ERROR: 'error',\r\n    RESIZE: 'resize',\r\n    SCROLL: 'scroll',\r\n    // Form\r\n    SELECT: 'select',\r\n    CHANGE: 'change',\r\n    SUBMIT: 'submit',\r\n    RESET: 'reset',\r\n    FOCUS: 'focus',\r\n    FOCUS_IN: 'focusin',\r\n    FOCUS_OUT: 'focusout',\r\n    BLUR: 'blur',\r\n    INPUT: 'input',\r\n    // Local Storage\r\n    STORAGE: 'storage',\r\n    // Drag\r\n    DRAG_START: 'dragstart',\r\n    DRAG: 'drag',\r\n    DRAG_ENTER: 'dragenter',\r\n    DRAG_LEAVE: 'dragleave',\r\n    DRAG_OVER: 'dragover',\r\n    DROP: 'drop',\r\n    DRAG_END: 'dragend',\r\n    // Animation\r\n    ANIMATION_START: browser.isWebKit ? 'webkitAnimationStart' : 'animationstart',\r\n    ANIMATION_END: browser.isWebKit ? 'webkitAnimationEnd' : 'animationend',\r\n    ANIMATION_ITERATION: browser.isWebKit ? 'webkitAnimationIteration' : 'animationiteration'\r\n};\r\nexport var EventHelper = {\r\n    stop: function (e, cancelBubble) {\r\n        if (e.preventDefault) {\r\n            e.preventDefault();\r\n        }\r\n        else {\r\n            // IE8\r\n            e.returnValue = false;\r\n        }\r\n        if (cancelBubble) {\r\n            if (e.stopPropagation) {\r\n                e.stopPropagation();\r\n            }\r\n            else {\r\n                // IE8\r\n                e.cancelBubble = true;\r\n            }\r\n        }\r\n    }\r\n};\r\nexport function saveParentsScrollTop(node) {\r\n    var r = [];\r\n    for (var i = 0; node && node.nodeType === node.ELEMENT_NODE; i++) {\r\n        r[i] = node.scrollTop;\r\n        node = node.parentNode;\r\n    }\r\n    return r;\r\n}\r\nexport function restoreParentsScrollTop(node, state) {\r\n    for (var i = 0; node && node.nodeType === node.ELEMENT_NODE; i++) {\r\n        if (node.scrollTop !== state[i]) {\r\n            node.scrollTop = state[i];\r\n        }\r\n        node = node.parentNode;\r\n    }\r\n}\r\nvar FocusTracker = /** @class */ (function () {\r\n    function FocusTracker(element) {\r\n        var _this = this;\r\n        this._onDidFocus = new Emitter();\r\n        this.onDidFocus = this._onDidFocus.event;\r\n        this._onDidBlur = new Emitter();\r\n        this.onDidBlur = this._onDidBlur.event;\r\n        this.disposables = [];\r\n        var hasFocus = isAncestor(document.activeElement, element);\r\n        var loosingFocus = false;\r\n        var onFocus = function () {\r\n            loosingFocus = false;\r\n            if (!hasFocus) {\r\n                hasFocus = true;\r\n                _this._onDidFocus.fire();\r\n            }\r\n        };\r\n        var onBlur = function () {\r\n            if (hasFocus) {\r\n                loosingFocus = true;\r\n                window.setTimeout(function () {\r\n                    if (loosingFocus) {\r\n                        loosingFocus = false;\r\n                        hasFocus = false;\r\n                        _this._onDidBlur.fire();\r\n                    }\r\n                }, 0);\r\n            }\r\n        };\r\n        domEvent(element, EventType.FOCUS, true)(onFocus, null, this.disposables);\r\n        domEvent(element, EventType.BLUR, true)(onBlur, null, this.disposables);\r\n    }\r\n    FocusTracker.prototype.dispose = function () {\r\n        this.disposables = dispose(this.disposables);\r\n        this._onDidFocus.dispose();\r\n        this._onDidBlur.dispose();\r\n    };\r\n    return FocusTracker;\r\n}());\r\nexport function trackFocus(element) {\r\n    return new FocusTracker(element);\r\n}\r\nexport function append(parent) {\r\n    var children = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        children[_i - 1] = arguments[_i];\r\n    }\r\n    children.forEach(function (child) { return parent.appendChild(child); });\r\n    return children[children.length - 1];\r\n}\r\nvar SELECTOR_REGEX = /([\\w\\-]+)?(#([\\w\\-]+))?((.([\\w\\-]+))*)/;\r\nexport function $(description, attrs) {\r\n    var children = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        children[_i - 2] = arguments[_i];\r\n    }\r\n    var match = SELECTOR_REGEX.exec(description);\r\n    if (!match) {\r\n        throw new Error('Bad use of emmet');\r\n    }\r\n    var result = document.createElement(match[1] || 'div');\r\n    if (match[3]) {\r\n        result.id = match[3];\r\n    }\r\n    if (match[4]) {\r\n        result.className = match[4].replace(/\\./g, ' ').trim();\r\n    }\r\n    attrs = attrs || {};\r\n    Object.keys(attrs).forEach(function (name) {\r\n        var value = attrs[name];\r\n        if (/^on\\w+$/.test(name)) {\r\n            result[name] = value;\r\n        }\r\n        else if (name === 'selected') {\r\n            if (value) {\r\n                result.setAttribute(name, 'true');\r\n            }\r\n        }\r\n        else {\r\n            result.setAttribute(name, value);\r\n        }\r\n    });\r\n    children\r\n        .filter(function (child) { return !!child; })\r\n        .forEach(function (child) {\r\n        if (child instanceof Node) {\r\n            result.appendChild(child);\r\n        }\r\n        else {\r\n            result.appendChild(document.createTextNode(child));\r\n        }\r\n    });\r\n    return result;\r\n}\r\nexport function show() {\r\n    var elements = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        elements[_i] = arguments[_i];\r\n    }\r\n    for (var _a = 0, elements_1 = elements; _a < elements_1.length; _a++) {\r\n        var element = elements_1[_a];\r\n        element.style.display = '';\r\n        element.removeAttribute('aria-hidden');\r\n    }\r\n}\r\nexport function hide() {\r\n    var elements = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        elements[_i] = arguments[_i];\r\n    }\r\n    for (var _a = 0, elements_2 = elements; _a < elements_2.length; _a++) {\r\n        var element = elements_2[_a];\r\n        element.style.display = 'none';\r\n        element.setAttribute('aria-hidden', 'true');\r\n    }\r\n}\r\nfunction findParentWithAttribute(node, attribute) {\r\n    while (node) {\r\n        if (node instanceof HTMLElement && node.hasAttribute(attribute)) {\r\n            return node;\r\n        }\r\n        node = node.parentNode;\r\n    }\r\n    return null;\r\n}\r\nexport function removeTabIndexAndUpdateFocus(node) {\r\n    if (!node || !node.hasAttribute('tabIndex')) {\r\n        return;\r\n    }\r\n    // If we are the currently focused element and tabIndex is removed,\r\n    // standard DOM behavior is to move focus to the <body> element. We\r\n    // typically never want that, rather put focus to the closest element\r\n    // in the hierarchy of the parent DOM nodes.\r\n    if (document.activeElement === node) {\r\n        var parentFocusable = findParentWithAttribute(node.parentElement, 'tabIndex');\r\n        if (parentFocusable) {\r\n            parentFocusable.focus();\r\n        }\r\n    }\r\n    node.removeAttribute('tabindex');\r\n}\r\nexport function getElementsByTagName(tag) {\r\n    return Array.prototype.slice.call(document.getElementsByTagName(tag), 0);\r\n}\r\n/**\r\n * Find a value usable for a dom node size such that the likelihood that it would be\r\n * displayed with constant screen pixels size is as high as possible.\r\n *\r\n * e.g. We would desire for the cursors to be 2px (CSS px) wide. Under a devicePixelRatio\r\n * of 1.25, the cursor will be 2.5 screen pixels wide. Depending on how the dom node aligns/\"snaps\"\r\n * with the screen pixels, it will sometimes be rendered with 2 screen pixels, and sometimes with 3 screen pixels.\r\n */\r\nexport function computeScreenAwareSize(cssPx) {\r\n    var screenPx = window.devicePixelRatio * cssPx;\r\n    return Math.max(1, Math.floor(screenPx)) / window.devicePixelRatio;\r\n}\r\n/**\r\n * See https://github.com/Microsoft/monaco-editor/issues/601\r\n * To protect against malicious code in the linked site, particularly phishing attempts,\r\n * the window.opener should be set to null to prevent the linked site from having access\r\n * to change the location of the current page.\r\n * See https://mathiasbynens.github.io/rel-noopener/\r\n */\r\nexport function windowOpenNoOpener(url) {\r\n    if (platform.isNative || browser.isEdgeWebView) {\r\n        // In VSCode, window.open() always returns null...\r\n        // The same is true for a WebView (see https://github.com/Microsoft/monaco-editor/issues/628)\r\n        window.open(url);\r\n    }\r\n    else {\r\n        var newTab = window.open();\r\n        if (newTab) {\r\n            newTab.opener = null;\r\n            newTab.location.href = url;\r\n        }\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { URI } from './uri.js';\r\nexport function parse(text) {\r\n    var data = JSON.parse(text);\r\n    data = revive(data, 0);\r\n    return data;\r\n}\r\nexport function revive(obj, depth) {\r\n    if (!obj || depth > 200) {\r\n        return obj;\r\n    }\r\n    if (typeof obj === 'object') {\r\n        switch (obj.$mid) {\r\n            case 1: return URI.revive(obj);\r\n            case 2: return new RegExp(obj.source, obj.flags);\r\n        }\r\n        // walk object (or array)\r\n        for (var key in obj) {\r\n            if (Object.hasOwnProperty.call(obj, key)) {\r\n                obj[key] = revive(obj[key], depth + 1);\r\n            }\r\n        }\r\n    }\r\n    return obj;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport var Schemas;\r\n(function (Schemas) {\r\n    /**\r\n     * A schema that is used for models that exist in memory\r\n     * only and that have no correspondence on a server or such.\r\n     */\r\n    Schemas.inMemory = 'inmemory';\r\n    /**\r\n     * A schema that is used for setting files\r\n     */\r\n    Schemas.vscode = 'vscode';\r\n    /**\r\n     * A schema that is used for internal private files\r\n     */\r\n    Schemas.internal = 'private';\r\n    /**\r\n     * A walk-through document.\r\n     */\r\n    Schemas.walkThrough = 'walkThrough';\r\n    /**\r\n     * An embedded code snippet.\r\n     */\r\n    Schemas.walkThroughSnippet = 'walkThroughSnippet';\r\n    Schemas.http = 'http';\r\n    Schemas.https = 'https';\r\n    Schemas.file = 'file';\r\n    Schemas.mailto = 'mailto';\r\n    Schemas.untitled = 'untitled';\r\n    Schemas.data = 'data';\r\n})(Schemas || (Schemas = {}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/**\r\n * The empty string.\r\n */\r\nexport var empty = '';\r\nexport function isFalsyOrWhitespace(str) {\r\n    if (!str || typeof str !== 'string') {\r\n        return true;\r\n    }\r\n    return str.trim().length === 0;\r\n}\r\n/**\r\n * @returns the provided number with the given number of preceding zeros.\r\n */\r\nexport function pad(n, l, char) {\r\n    if (char === void 0) { char = '0'; }\r\n    var str = '' + n;\r\n    var r = [str];\r\n    for (var i = str.length; i < l; i++) {\r\n        r.push(char);\r\n    }\r\n    return r.reverse().join('');\r\n}\r\nvar _formatRegexp = /{(\\d+)}/g;\r\n/**\r\n * Helper to produce a string with a variable number of arguments. Insert variable segments\r\n * into the string using the {n} notation where N is the index of the argument following the string.\r\n * @param value string to which formatting is applied\r\n * @param args replacements for {n}-entries\r\n */\r\nexport function format(value) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    if (args.length === 0) {\r\n        return value;\r\n    }\r\n    return value.replace(_formatRegexp, function (match, group) {\r\n        var idx = parseInt(group, 10);\r\n        return isNaN(idx) || idx < 0 || idx >= args.length ?\r\n            match :\r\n            args[idx];\r\n    });\r\n}\r\n/**\r\n * Converts HTML characters inside the string to use entities instead. Makes the string safe from\r\n * being used e.g. in HTMLElement.innerHTML.\r\n */\r\nexport function escape(html) {\r\n    return html.replace(/[<|>|&]/g, function (match) {\r\n        switch (match) {\r\n            case '<': return '&lt;';\r\n            case '>': return '&gt;';\r\n            case '&': return '&amp;';\r\n            default: return match;\r\n        }\r\n    });\r\n}\r\n/**\r\n * Escapes regular expression characters in a given string\r\n */\r\nexport function escapeRegExpCharacters(value) {\r\n    return value.replace(/[\\-\\\\\\{\\}\\*\\+\\?\\|\\^\\$\\.\\[\\]\\(\\)\\#]/g, '\\\\$&');\r\n}\r\n/**\r\n * Removes all occurrences of needle from the beginning and end of haystack.\r\n * @param haystack string to trim\r\n * @param needle the thing to trim (default is a blank)\r\n */\r\nexport function trim(haystack, needle) {\r\n    if (needle === void 0) { needle = ' '; }\r\n    var trimmed = ltrim(haystack, needle);\r\n    return rtrim(trimmed, needle);\r\n}\r\n/**\r\n * Removes all occurrences of needle from the beginning of haystack.\r\n * @param haystack string to trim\r\n * @param needle the thing to trim\r\n */\r\nexport function ltrim(haystack, needle) {\r\n    if (!haystack || !needle) {\r\n        return haystack;\r\n    }\r\n    var needleLen = needle.length;\r\n    if (needleLen === 0 || haystack.length === 0) {\r\n        return haystack;\r\n    }\r\n    var offset = 0;\r\n    while (haystack.indexOf(needle, offset) === offset) {\r\n        offset = offset + needleLen;\r\n    }\r\n    return haystack.substring(offset);\r\n}\r\n/**\r\n * Removes all occurrences of needle from the end of haystack.\r\n * @param haystack string to trim\r\n * @param needle the thing to trim\r\n */\r\nexport function rtrim(haystack, needle) {\r\n    if (!haystack || !needle) {\r\n        return haystack;\r\n    }\r\n    var needleLen = needle.length, haystackLen = haystack.length;\r\n    if (needleLen === 0 || haystackLen === 0) {\r\n        return haystack;\r\n    }\r\n    var offset = haystackLen, idx = -1;\r\n    while (true) {\r\n        idx = haystack.lastIndexOf(needle, offset - 1);\r\n        if (idx === -1 || idx + needleLen !== offset) {\r\n            break;\r\n        }\r\n        if (idx === 0) {\r\n            return '';\r\n        }\r\n        offset = idx;\r\n    }\r\n    return haystack.substring(0, offset);\r\n}\r\nexport function convertSimple2RegExpPattern(pattern) {\r\n    return pattern.replace(/[\\-\\\\\\{\\}\\+\\?\\|\\^\\$\\.\\,\\[\\]\\(\\)\\#\\s]/g, '\\\\$&').replace(/[\\*]/g, '.*');\r\n}\r\n/**\r\n * Determines if haystack starts with needle.\r\n */\r\nexport function startsWith(haystack, needle) {\r\n    if (haystack.length < needle.length) {\r\n        return false;\r\n    }\r\n    if (haystack === needle) {\r\n        return true;\r\n    }\r\n    for (var i = 0; i < needle.length; i++) {\r\n        if (haystack[i] !== needle[i]) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * Determines if haystack ends with needle.\r\n */\r\nexport function endsWith(haystack, needle) {\r\n    var diff = haystack.length - needle.length;\r\n    if (diff > 0) {\r\n        return haystack.indexOf(needle, diff) === diff;\r\n    }\r\n    else if (diff === 0) {\r\n        return haystack === needle;\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\nexport function createRegExp(searchString, isRegex, options) {\r\n    if (options === void 0) { options = {}; }\r\n    if (!searchString) {\r\n        throw new Error('Cannot create regex from empty string');\r\n    }\r\n    if (!isRegex) {\r\n        searchString = escapeRegExpCharacters(searchString);\r\n    }\r\n    if (options.wholeWord) {\r\n        if (!/\\B/.test(searchString.charAt(0))) {\r\n            searchString = '\\\\b' + searchString;\r\n        }\r\n        if (!/\\B/.test(searchString.charAt(searchString.length - 1))) {\r\n            searchString = searchString + '\\\\b';\r\n        }\r\n    }\r\n    var modifiers = '';\r\n    if (options.global) {\r\n        modifiers += 'g';\r\n    }\r\n    if (!options.matchCase) {\r\n        modifiers += 'i';\r\n    }\r\n    if (options.multiline) {\r\n        modifiers += 'm';\r\n    }\r\n    return new RegExp(searchString, modifiers);\r\n}\r\nexport function regExpLeadsToEndlessLoop(regexp) {\r\n    // Exit early if it's one of these special cases which are meant to match\r\n    // against an empty string\r\n    if (regexp.source === '^' || regexp.source === '^$' || regexp.source === '$' || regexp.source === '^\\\\s*$') {\r\n        return false;\r\n    }\r\n    // We check against an empty string. If the regular expression doesn't advance\r\n    // (e.g. ends in an endless loop) it will match an empty string.\r\n    var match = regexp.exec('');\r\n    return !!(match && regexp.lastIndex === 0);\r\n}\r\n/**\r\n * Returns first index of the string that is not whitespace.\r\n * If string is empty or contains only whitespaces, returns -1\r\n */\r\nexport function firstNonWhitespaceIndex(str) {\r\n    for (var i = 0, len = str.length; i < len; i++) {\r\n        var chCode = str.charCodeAt(i);\r\n        if (chCode !== 32 /* Space */ && chCode !== 9 /* Tab */) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n/**\r\n * Returns the leading whitespace of the string.\r\n * If the string contains only whitespaces, returns entire string\r\n */\r\nexport function getLeadingWhitespace(str, start, end) {\r\n    if (start === void 0) { start = 0; }\r\n    if (end === void 0) { end = str.length; }\r\n    for (var i = start; i < end; i++) {\r\n        var chCode = str.charCodeAt(i);\r\n        if (chCode !== 32 /* Space */ && chCode !== 9 /* Tab */) {\r\n            return str.substring(start, i);\r\n        }\r\n    }\r\n    return str.substring(start, end);\r\n}\r\n/**\r\n * Returns last index of the string that is not whitespace.\r\n * If string is empty or contains only whitespaces, returns -1\r\n */\r\nexport function lastNonWhitespaceIndex(str, startIndex) {\r\n    if (startIndex === void 0) { startIndex = str.length - 1; }\r\n    for (var i = startIndex; i >= 0; i--) {\r\n        var chCode = str.charCodeAt(i);\r\n        if (chCode !== 32 /* Space */ && chCode !== 9 /* Tab */) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\nexport function compare(a, b) {\r\n    if (a < b) {\r\n        return -1;\r\n    }\r\n    else if (a > b) {\r\n        return 1;\r\n    }\r\n    else {\r\n        return 0;\r\n    }\r\n}\r\nexport function isLowerAsciiLetter(code) {\r\n    return code >= 97 /* a */ && code <= 122 /* z */;\r\n}\r\nexport function isUpperAsciiLetter(code) {\r\n    return code >= 65 /* A */ && code <= 90 /* Z */;\r\n}\r\nfunction isAsciiLetter(code) {\r\n    return isLowerAsciiLetter(code) || isUpperAsciiLetter(code);\r\n}\r\nexport function equalsIgnoreCase(a, b) {\r\n    var len1 = a ? a.length : 0;\r\n    var len2 = b ? b.length : 0;\r\n    if (len1 !== len2) {\r\n        return false;\r\n    }\r\n    return doEqualsIgnoreCase(a, b);\r\n}\r\nfunction doEqualsIgnoreCase(a, b, stopAt) {\r\n    if (stopAt === void 0) { stopAt = a.length; }\r\n    if (typeof a !== 'string' || typeof b !== 'string') {\r\n        return false;\r\n    }\r\n    for (var i = 0; i < stopAt; i++) {\r\n        var codeA = a.charCodeAt(i);\r\n        var codeB = b.charCodeAt(i);\r\n        if (codeA === codeB) {\r\n            continue;\r\n        }\r\n        // a-z A-Z\r\n        if (isAsciiLetter(codeA) && isAsciiLetter(codeB)) {\r\n            var diff = Math.abs(codeA - codeB);\r\n            if (diff !== 0 && diff !== 32) {\r\n                return false;\r\n            }\r\n        }\r\n        // Any other charcode\r\n        else {\r\n            if (String.fromCharCode(codeA).toLowerCase() !== String.fromCharCode(codeB).toLowerCase()) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\nexport function startsWithIgnoreCase(str, candidate) {\r\n    var candidateLength = candidate.length;\r\n    if (candidate.length > str.length) {\r\n        return false;\r\n    }\r\n    return doEqualsIgnoreCase(str, candidate, candidateLength);\r\n}\r\n/**\r\n * @returns the length of the common prefix of the two strings.\r\n */\r\nexport function commonPrefixLength(a, b) {\r\n    var i, len = Math.min(a.length, b.length);\r\n    for (i = 0; i < len; i++) {\r\n        if (a.charCodeAt(i) !== b.charCodeAt(i)) {\r\n            return i;\r\n        }\r\n    }\r\n    return len;\r\n}\r\n/**\r\n * @returns the length of the common suffix of the two strings.\r\n */\r\nexport function commonSuffixLength(a, b) {\r\n    var i, len = Math.min(a.length, b.length);\r\n    var aLastIndex = a.length - 1;\r\n    var bLastIndex = b.length - 1;\r\n    for (i = 0; i < len; i++) {\r\n        if (a.charCodeAt(aLastIndex - i) !== b.charCodeAt(bLastIndex - i)) {\r\n            return i;\r\n        }\r\n    }\r\n    return len;\r\n}\r\n// --- unicode\r\n// http://en.wikipedia.org/wiki/Surrogate_pair\r\n// Returns the code point starting at a specified index in a string\r\n// Code points U+0000 to U+D7FF and U+E000 to U+FFFF are represented on a single character\r\n// Code points U+10000 to U+10FFFF are represented on two consecutive characters\r\n//export function getUnicodePoint(str:string, index:number, len:number):number {\r\n//\tlet chrCode = str.charCodeAt(index);\r\n//\tif (0xD800 <= chrCode && chrCode <= 0xDBFF && index + 1 < len) {\r\n//\t\tlet nextChrCode = str.charCodeAt(index + 1);\r\n//\t\tif (0xDC00 <= nextChrCode && nextChrCode <= 0xDFFF) {\r\n//\t\t\treturn (chrCode - 0xD800) << 10 + (nextChrCode - 0xDC00) + 0x10000;\r\n//\t\t}\r\n//\t}\r\n//\treturn chrCode;\r\n//}\r\nexport function isHighSurrogate(charCode) {\r\n    return (0xD800 <= charCode && charCode <= 0xDBFF);\r\n}\r\nexport function isLowSurrogate(charCode) {\r\n    return (0xDC00 <= charCode && charCode <= 0xDFFF);\r\n}\r\n/**\r\n * Generated using https://github.com/alexandrudima/unicode-utils/blob/master/generate-rtl-test.js\r\n */\r\nvar CONTAINS_RTL = /(?:[\\u05BE\\u05C0\\u05C3\\u05C6\\u05D0-\\u05F4\\u0608\\u060B\\u060D\\u061B-\\u064A\\u066D-\\u066F\\u0671-\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1-\\u07EA\\u07F4\\u07F5\\u07FA-\\u0815\\u081A\\u0824\\u0828\\u0830-\\u0858\\u085E-\\u08BD\\u200F\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFD3D\\uFD50-\\uFDFC\\uFE70-\\uFEFC]|\\uD802[\\uDC00-\\uDD1B\\uDD20-\\uDE00\\uDE10-\\uDE33\\uDE40-\\uDEE4\\uDEEB-\\uDF35\\uDF40-\\uDFFF]|\\uD803[\\uDC00-\\uDCFF]|\\uD83A[\\uDC00-\\uDCCF\\uDD00-\\uDD43\\uDD50-\\uDFFF]|\\uD83B[\\uDC00-\\uDEBB])/;\r\n/**\r\n * Returns true if `str` contains any Unicode character that is classified as \"R\" or \"AL\".\r\n */\r\nexport function containsRTL(str) {\r\n    return CONTAINS_RTL.test(str);\r\n}\r\n/**\r\n * Generated using https://github.com/alexandrudima/unicode-utils/blob/master/generate-emoji-test.js\r\n */\r\nvar CONTAINS_EMOJI = /(?:[\\u231A\\u231B\\u23F0\\u23F3\\u2600-\\u27BF\\u2B50\\u2B55]|\\uD83C[\\uDDE6-\\uDDFF\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDE4F\\uDE80-\\uDEF8]|\\uD83E[\\uDD00-\\uDDE6])/;\r\nexport function containsEmoji(str) {\r\n    return CONTAINS_EMOJI.test(str);\r\n}\r\nvar IS_BASIC_ASCII = /^[\\t\\n\\r\\x20-\\x7E]*$/;\r\n/**\r\n * Returns true if `str` contains only basic ASCII characters in the range 32 - 126 (including 32 and 126) or \\n, \\r, \\t\r\n */\r\nexport function isBasicASCII(str) {\r\n    return IS_BASIC_ASCII.test(str);\r\n}\r\nexport function containsFullWidthCharacter(str) {\r\n    for (var i = 0, len = str.length; i < len; i++) {\r\n        if (isFullWidthCharacter(str.charCodeAt(i))) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function isFullWidthCharacter(charCode) {\r\n    // Do a cheap trick to better support wrapping of wide characters, treat them as 2 columns\r\n    // http://jrgraphix.net/research/unicode_blocks.php\r\n    //          2E80 — 2EFF   CJK Radicals Supplement\r\n    //          2F00 — 2FDF   Kangxi Radicals\r\n    //          2FF0 — 2FFF   Ideographic Description Characters\r\n    //          3000 — 303F   CJK Symbols and Punctuation\r\n    //          3040 — 309F   Hiragana\r\n    //          30A0 — 30FF   Katakana\r\n    //          3100 — 312F   Bopomofo\r\n    //          3130 — 318F   Hangul Compatibility Jamo\r\n    //          3190 — 319F   Kanbun\r\n    //          31A0 — 31BF   Bopomofo Extended\r\n    //          31F0 — 31FF   Katakana Phonetic Extensions\r\n    //          3200 — 32FF   Enclosed CJK Letters and Months\r\n    //          3300 — 33FF   CJK Compatibility\r\n    //          3400 — 4DBF   CJK Unified Ideographs Extension A\r\n    //          4DC0 — 4DFF   Yijing Hexagram Symbols\r\n    //          4E00 — 9FFF   CJK Unified Ideographs\r\n    //          A000 — A48F   Yi Syllables\r\n    //          A490 — A4CF   Yi Radicals\r\n    //          AC00 — D7AF   Hangul Syllables\r\n    // [IGNORE] D800 — DB7F   High Surrogates\r\n    // [IGNORE] DB80 — DBFF   High Private Use Surrogates\r\n    // [IGNORE] DC00 — DFFF   Low Surrogates\r\n    // [IGNORE] E000 — F8FF   Private Use Area\r\n    //          F900 — FAFF   CJK Compatibility Ideographs\r\n    // [IGNORE] FB00 — FB4F   Alphabetic Presentation Forms\r\n    // [IGNORE] FB50 — FDFF   Arabic Presentation Forms-A\r\n    // [IGNORE] FE00 — FE0F   Variation Selectors\r\n    // [IGNORE] FE20 — FE2F   Combining Half Marks\r\n    // [IGNORE] FE30 — FE4F   CJK Compatibility Forms\r\n    // [IGNORE] FE50 — FE6F   Small Form Variants\r\n    // [IGNORE] FE70 — FEFF   Arabic Presentation Forms-B\r\n    //          FF00 — FFEF   Halfwidth and Fullwidth Forms\r\n    //               [https://en.wikipedia.org/wiki/Halfwidth_and_fullwidth_forms]\r\n    //               of which FF01 - FF5E fullwidth ASCII of 21 to 7E\r\n    // [IGNORE]    and FF65 - FFDC halfwidth of Katakana and Hangul\r\n    // [IGNORE] FFF0 — FFFF   Specials\r\n    charCode = +charCode; // @perf\r\n    return ((charCode >= 0x2E80 && charCode <= 0xD7AF)\r\n        || (charCode >= 0xF900 && charCode <= 0xFAFF)\r\n        || (charCode >= 0xFF01 && charCode <= 0xFF5E));\r\n}\r\n// -- UTF-8 BOM\r\nexport var UTF8_BOM_CHARACTER = String.fromCharCode(65279 /* UTF8_BOM */);\r\nexport function startsWithUTF8BOM(str) {\r\n    return !!(str && str.length > 0 && str.charCodeAt(0) === 65279 /* UTF8_BOM */);\r\n}\r\nexport function safeBtoa(str) {\r\n    return btoa(encodeURIComponent(str)); // we use encodeURIComponent because btoa fails for non Latin 1 values\r\n}\r\nexport function repeat(s, count) {\r\n    var result = '';\r\n    for (var i = 0; i < count; i++) {\r\n        result += s;\r\n    }\r\n    return result;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isWindows } from './platform.js';\r\nimport { startsWithIgnoreCase } from './strings.js';\r\n/**\r\n * The forward slash path separator.\r\n */\r\nexport var sep = '/';\r\n/**\r\n * The native path separator depending on the OS.\r\n */\r\nexport var nativeSep = isWindows ? '\\\\' : '/';\r\n/**\r\n * @param path the path to get the dirname from\r\n * @param separator the separator to use\r\n * @returns the directory name of a path.\r\n *\r\n */\r\nexport function dirname(path, separator) {\r\n    if (separator === void 0) { separator = nativeSep; }\r\n    var idx = ~path.lastIndexOf('/') || ~path.lastIndexOf('\\\\');\r\n    if (idx === 0) {\r\n        return '.';\r\n    }\r\n    else if (~idx === 0) {\r\n        return path[0];\r\n    }\r\n    else if (~idx === path.length - 1) {\r\n        return dirname(path.substring(0, path.length - 1));\r\n    }\r\n    else {\r\n        var res = path.substring(0, ~idx);\r\n        if (isWindows && res[res.length - 1] === ':') {\r\n            res += separator; // make sure drive letters end with backslash\r\n        }\r\n        return res;\r\n    }\r\n}\r\n/**\r\n * @returns the base name of a path.\r\n */\r\nexport function basename(path) {\r\n    var idx = ~path.lastIndexOf('/') || ~path.lastIndexOf('\\\\');\r\n    if (idx === 0) {\r\n        return path;\r\n    }\r\n    else if (~idx === path.length - 1) {\r\n        return basename(path.substring(0, path.length - 1));\r\n    }\r\n    else {\r\n        return path.substr(~idx + 1);\r\n    }\r\n}\r\n/**\r\n * @returns `.far` from `boo.far` or the empty string.\r\n */\r\nexport function extname(path) {\r\n    path = basename(path);\r\n    var idx = ~path.lastIndexOf('.');\r\n    return idx ? path.substring(~idx) : '';\r\n}\r\nvar _posixBadPath = /(\\/\\.\\.?\\/)|(\\/\\.\\.?)$|^(\\.\\.?\\/)|(\\/\\/+)|(\\\\)/;\r\nvar _winBadPath = /(\\\\\\.\\.?\\\\)|(\\\\\\.\\.?)$|^(\\.\\.?\\\\)|(\\\\\\\\+)|(\\/)/;\r\nfunction _isNormal(path, win) {\r\n    return win\r\n        ? !_winBadPath.test(path)\r\n        : !_posixBadPath.test(path);\r\n}\r\nexport function normalize(path, toOSPath) {\r\n    if (path === null || path === void 0) {\r\n        return path;\r\n    }\r\n    var len = path.length;\r\n    if (len === 0) {\r\n        return '.';\r\n    }\r\n    var wantsBackslash = !!(isWindows && toOSPath);\r\n    if (_isNormal(path, wantsBackslash)) {\r\n        return path;\r\n    }\r\n    var sep = wantsBackslash ? '\\\\' : '/';\r\n    var root = getRoot(path, sep);\r\n    // skip the root-portion of the path\r\n    var start = root.length;\r\n    var skip = false;\r\n    var res = '';\r\n    for (var end = root.length; end <= len; end++) {\r\n        // either at the end or at a path-separator character\r\n        if (end === len || path.charCodeAt(end) === 47 /* Slash */ || path.charCodeAt(end) === 92 /* Backslash */) {\r\n            if (streql(path, start, end, '..')) {\r\n                // skip current and remove parent (if there is already something)\r\n                var prev_start = res.lastIndexOf(sep);\r\n                var prev_part = res.slice(prev_start + 1);\r\n                if ((root || prev_part.length > 0) && prev_part !== '..') {\r\n                    res = prev_start === -1 ? '' : res.slice(0, prev_start);\r\n                    skip = true;\r\n                }\r\n            }\r\n            else if (streql(path, start, end, '.') && (root || res || end < len - 1)) {\r\n                // skip current (if there is already something or if there is more to come)\r\n                skip = true;\r\n            }\r\n            if (!skip) {\r\n                var part = path.slice(start, end);\r\n                if (res !== '' && res[res.length - 1] !== sep) {\r\n                    res += sep;\r\n                }\r\n                res += part;\r\n            }\r\n            start = end + 1;\r\n            skip = false;\r\n        }\r\n    }\r\n    return root + res;\r\n}\r\nfunction streql(value, start, end, other) {\r\n    return start + other.length === end && value.indexOf(other, start) === start;\r\n}\r\n/**\r\n * Computes the _root_ this path, like `getRoot('c:\\files') === c:\\`,\r\n * `getRoot('files:///files/path') === files:///`,\r\n * or `getRoot('\\\\server\\shares\\path') === \\\\server\\shares\\`\r\n */\r\nexport function getRoot(path, sep) {\r\n    if (sep === void 0) { sep = '/'; }\r\n    if (!path) {\r\n        return '';\r\n    }\r\n    var len = path.length;\r\n    var code = path.charCodeAt(0);\r\n    if (code === 47 /* Slash */ || code === 92 /* Backslash */) {\r\n        code = path.charCodeAt(1);\r\n        if (code === 47 /* Slash */ || code === 92 /* Backslash */) {\r\n            // UNC candidate \\\\localhost\\shares\\ddd\r\n            //               ^^^^^^^^^^^^^^^^^^^\r\n            code = path.charCodeAt(2);\r\n            if (code !== 47 /* Slash */ && code !== 92 /* Backslash */) {\r\n                var pos_1 = 3;\r\n                var start = pos_1;\r\n                for (; pos_1 < len; pos_1++) {\r\n                    code = path.charCodeAt(pos_1);\r\n                    if (code === 47 /* Slash */ || code === 92 /* Backslash */) {\r\n                        break;\r\n                    }\r\n                }\r\n                code = path.charCodeAt(pos_1 + 1);\r\n                if (start !== pos_1 && code !== 47 /* Slash */ && code !== 92 /* Backslash */) {\r\n                    pos_1 += 1;\r\n                    for (; pos_1 < len; pos_1++) {\r\n                        code = path.charCodeAt(pos_1);\r\n                        if (code === 47 /* Slash */ || code === 92 /* Backslash */) {\r\n                            return path.slice(0, pos_1 + 1) // consume this separator\r\n                                .replace(/[\\\\/]/g, sep);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // /user/far\r\n        // ^\r\n        return sep;\r\n    }\r\n    else if ((code >= 65 /* A */ && code <= 90 /* Z */) || (code >= 97 /* a */ && code <= 122 /* z */)) {\r\n        // check for windows drive letter c:\\ or c:\r\n        if (path.charCodeAt(1) === 58 /* Colon */) {\r\n            code = path.charCodeAt(2);\r\n            if (code === 47 /* Slash */ || code === 92 /* Backslash */) {\r\n                // C:\\fff\r\n                // ^^^\r\n                return path.slice(0, 2) + sep;\r\n            }\r\n            else {\r\n                // C:\r\n                // ^^\r\n                return path.slice(0, 2);\r\n            }\r\n        }\r\n    }\r\n    // check for URI\r\n    // scheme://authority/path\r\n    // ^^^^^^^^^^^^^^^^^^^\r\n    var pos = path.indexOf('://');\r\n    if (pos !== -1) {\r\n        pos += 3; // 3 -> \"://\".length\r\n        for (; pos < len; pos++) {\r\n            code = path.charCodeAt(pos);\r\n            if (code === 47 /* Slash */ || code === 92 /* Backslash */) {\r\n                return path.slice(0, pos + 1); // consume this separator\r\n            }\r\n        }\r\n    }\r\n    return '';\r\n}\r\nexport var join = function () {\r\n    // Not using a function with var-args because of how TS compiles\r\n    // them to JS - it would result in 2*n runtime cost instead\r\n    // of 1*n, where n is parts.length.\r\n    var value = '';\r\n    for (var i = 0; i < arguments.length; i++) {\r\n        var part = arguments[i];\r\n        if (i > 0) {\r\n            // add the separater between two parts unless\r\n            // there already is one\r\n            var last = value.charCodeAt(value.length - 1);\r\n            if (last !== 47 /* Slash */ && last !== 92 /* Backslash */) {\r\n                var next = part.charCodeAt(0);\r\n                if (next !== 47 /* Slash */ && next !== 92 /* Backslash */) {\r\n                    value += sep;\r\n                }\r\n            }\r\n        }\r\n        value += part;\r\n    }\r\n    return normalize(value);\r\n};\r\nexport function isEqualOrParent(path, candidate, ignoreCase, separator) {\r\n    if (separator === void 0) { separator = nativeSep; }\r\n    if (path === candidate) {\r\n        return true;\r\n    }\r\n    if (!path || !candidate) {\r\n        return false;\r\n    }\r\n    if (candidate.length > path.length) {\r\n        return false;\r\n    }\r\n    if (ignoreCase) {\r\n        var beginsWith = startsWithIgnoreCase(path, candidate);\r\n        if (!beginsWith) {\r\n            return false;\r\n        }\r\n        if (candidate.length === path.length) {\r\n            return true; // same path, different casing\r\n        }\r\n        var sepOffset = candidate.length;\r\n        if (candidate.charAt(candidate.length - 1) === separator) {\r\n            sepOffset--; // adjust the expected sep offset in case our candidate already ends in separator character\r\n        }\r\n        return path.charAt(sepOffset) === separator;\r\n    }\r\n    if (candidate.charAt(candidate.length - 1) !== separator) {\r\n        candidate += separator;\r\n    }\r\n    return path.indexOf(candidate) === 0;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as paths from './paths.js';\r\nimport { URI } from './uri.js';\r\nimport { equalsIgnoreCase } from './strings.js';\r\nimport { Schemas } from './network.js';\r\nimport { isLinux, isWindows } from './platform.js';\r\nexport function hasToIgnoreCase(resource) {\r\n    // A file scheme resource is in the same platform as code, so ignore case for non linux platforms\r\n    // Resource can be from another platform. Lowering the case as an hack. Should come from File system provider\r\n    return resource && resource.scheme === Schemas.file ? !isLinux : true;\r\n}\r\nexport function basenameOrAuthority(resource) {\r\n    return basename(resource) || resource.authority;\r\n}\r\nexport function isEqual(first, second, ignoreCase) {\r\n    if (ignoreCase === void 0) { ignoreCase = hasToIgnoreCase(first); }\r\n    var identityEquals = (first === second);\r\n    if (identityEquals) {\r\n        return true;\r\n    }\r\n    if (!first || !second) {\r\n        return false;\r\n    }\r\n    if (ignoreCase) {\r\n        return equalsIgnoreCase(first.toString(), second.toString());\r\n    }\r\n    return first.toString() === second.toString();\r\n}\r\nexport function basename(resource) {\r\n    return paths.basename(resource.path);\r\n}\r\n/**\r\n * Return a URI representing the directory of a URI path.\r\n *\r\n * @param resource The input URI.\r\n * @returns The URI representing the directory of the input URI.\r\n */\r\nexport function dirname(resource) {\r\n    if (resource.scheme === Schemas.file) {\r\n        return URI.file(paths.dirname(fsPath(resource)));\r\n    }\r\n    var dirname = paths.dirname(resource.path, '/');\r\n    if (resource.authority && dirname.length && dirname.charCodeAt(0) !== 47 /* Slash */) {\r\n        return null; // If a URI contains an authority component, then the path component must either be empty or begin with a CharCode.Slash (\"/\") character\r\n    }\r\n    return resource.with({\r\n        path: dirname\r\n    });\r\n}\r\n/**\r\n * Join a URI path with a path fragment and normalizes the resulting path.\r\n *\r\n * @param resource The input URI.\r\n * @param pathFragment The path fragment to add to the URI path.\r\n * @returns The resulting URI.\r\n */\r\nexport function joinPath(resource, pathFragment) {\r\n    var joinedPath;\r\n    if (resource.scheme === Schemas.file) {\r\n        joinedPath = URI.file(paths.join(fsPath(resource), pathFragment)).path;\r\n    }\r\n    else {\r\n        joinedPath = paths.join(resource.path, pathFragment);\r\n    }\r\n    return resource.with({\r\n        path: joinedPath\r\n    });\r\n}\r\n/**\r\n * Normalizes the path part of a URI: Resolves `.` and `..` elements with directory names.\r\n *\r\n * @param resource The URI to normalize the path.\r\n * @returns The URI with the normalized path.\r\n */\r\nexport function normalizePath(resource) {\r\n    var normalizedPath;\r\n    if (resource.scheme === Schemas.file) {\r\n        normalizedPath = URI.file(paths.normalize(fsPath(resource))).path;\r\n    }\r\n    else {\r\n        normalizedPath = paths.normalize(resource.path);\r\n    }\r\n    return resource.with({\r\n        path: normalizedPath\r\n    });\r\n}\r\n/**\r\n * Returns the fsPath of an URI where the drive letter is not normalized.\r\n * See #56403.\r\n */\r\nexport function fsPath(uri) {\r\n    var value;\r\n    if (uri.authority && uri.path.length > 1 && uri.scheme === 'file') {\r\n        // unc path: file://shares/c$/far/boo\r\n        value = \"//\" + uri.authority + uri.path;\r\n    }\r\n    else if (isWindows\r\n        && uri.path.charCodeAt(0) === 47 /* Slash */\r\n        && (uri.path.charCodeAt(1) >= 65 /* A */ && uri.path.charCodeAt(1) <= 90 /* Z */ || uri.path.charCodeAt(1) >= 97 /* a */ && uri.path.charCodeAt(1) <= 122 /* z */)\r\n        && uri.path.charCodeAt(2) === 58 /* Colon */) {\r\n        value = uri.path.substr(1);\r\n    }\r\n    else {\r\n        // other path\r\n        value = uri.path;\r\n    }\r\n    if (isWindows) {\r\n        value = value.replace(/\\//g, '\\\\');\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * Data URI related helpers.\r\n */\r\nexport var DataUri;\r\n(function (DataUri) {\r\n    DataUri.META_DATA_LABEL = 'label';\r\n    DataUri.META_DATA_DESCRIPTION = 'description';\r\n    DataUri.META_DATA_SIZE = 'size';\r\n    DataUri.META_DATA_MIME = 'mime';\r\n    function parseMetaData(dataUri) {\r\n        var metadata = new Map();\r\n        // Given a URI of:  data:image/png;size:2313;label:SomeLabel;description:SomeDescription;base64,77+9UE5...\r\n        // the metadata is: size:2313;label:SomeLabel;description:SomeDescription\r\n        var meta = dataUri.path.substring(dataUri.path.indexOf(';') + 1, dataUri.path.lastIndexOf(';'));\r\n        meta.split(';').forEach(function (property) {\r\n            var _a = property.split(':'), key = _a[0], value = _a[1];\r\n            if (key && value) {\r\n                metadata.set(key, value);\r\n            }\r\n        });\r\n        // Given a URI of:  data:image/png;size:2313;label:SomeLabel;description:SomeDescription;base64,77+9UE5...\r\n        // the mime is: image/png\r\n        var mime = dataUri.path.substring(0, dataUri.path.indexOf(';'));\r\n        if (mime) {\r\n            metadata.set(DataUri.META_DATA_MIME, mime);\r\n        }\r\n        return metadata;\r\n    }\r\n    DataUri.parseMetaData = parseMetaData;\r\n})(DataUri || (DataUri = {}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { toDisposable } from '../../../base/common/lifecycle.js';\r\nimport { validateConstraints } from '../../../base/common/types.js';\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nexport var ICommandService = createDecorator('commandService');\r\nexport var CommandsRegistry = new /** @class */ (function () {\r\n    function class_1() {\r\n        this._commands = new Map();\r\n    }\r\n    class_1.prototype.registerCommand = function (idOrCommand, handler) {\r\n        var _this = this;\r\n        if (!idOrCommand) {\r\n            throw new Error(\"invalid command\");\r\n        }\r\n        if (typeof idOrCommand === 'string') {\r\n            if (!handler) {\r\n                throw new Error(\"invalid command\");\r\n            }\r\n            return this.registerCommand({ id: idOrCommand, handler: handler });\r\n        }\r\n        // add argument validation if rich command metadata is provided\r\n        if (idOrCommand.description) {\r\n            var constraints_1 = [];\r\n            for (var _i = 0, _a = idOrCommand.description.args; _i < _a.length; _i++) {\r\n                var arg = _a[_i];\r\n                constraints_1.push(arg.constraint);\r\n            }\r\n            var actualHandler_1 = idOrCommand.handler;\r\n            idOrCommand.handler = function (accessor) {\r\n                var args = [];\r\n                for (var _i = 1; _i < arguments.length; _i++) {\r\n                    args[_i - 1] = arguments[_i];\r\n                }\r\n                validateConstraints(args, constraints_1);\r\n                return actualHandler_1.apply(void 0, [accessor].concat(args));\r\n            };\r\n        }\r\n        // find a place to store the command\r\n        var id = idOrCommand.id;\r\n        var commands = this._commands.get(id);\r\n        if (!commands) {\r\n            commands = new LinkedList();\r\n            this._commands.set(id, commands);\r\n        }\r\n        var removeFn = commands.unshift(idOrCommand);\r\n        return toDisposable(function () {\r\n            removeFn();\r\n            if (_this._commands.get(id).isEmpty()) {\r\n                _this._commands.delete(id);\r\n            }\r\n        });\r\n    };\r\n    class_1.prototype.registerCommandAlias = function (oldId, newId) {\r\n        return CommandsRegistry.registerCommand(oldId, function (accessor) {\r\n            var args = [];\r\n            for (var _i = 1; _i < arguments.length; _i++) {\r\n                args[_i - 1] = arguments[_i];\r\n            }\r\n            var _a;\r\n            (_a = accessor.get(ICommandService)).executeCommand.apply(_a, [newId].concat(args));\r\n        });\r\n    };\r\n    class_1.prototype.getCommand = function (id) {\r\n        var list = this._commands.get(id);\r\n        if (!list || list.isEmpty()) {\r\n            return undefined;\r\n        }\r\n        return list.iterator().next().value;\r\n    };\r\n    class_1.prototype.getCommands = function () {\r\n        var _this = this;\r\n        var result = Object.create(null);\r\n        this._commands.forEach(function (value, key) {\r\n            result[key] = _this.getCommand(key);\r\n        });\r\n        return result;\r\n    };\r\n    return class_1;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nexport var ITelemetryService = createDecorator('telemetryService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { TPromise } from '../../../base/common/winjs.base.js';\r\nexport var NullTelemetryService = new /** @class */ (function () {\r\n    function class_1() {\r\n    }\r\n    class_1.prototype.publicLog = function (eventName, data) {\r\n        return TPromise.wrap(void 0);\r\n    };\r\n    class_1.prototype.getTelemetryInfo = function () {\r\n        return TPromise.wrap({\r\n            instanceId: 'someValue.instanceId',\r\n            sessionId: 'someValue.sessionId',\r\n            machineId: 'someValue.machineId'\r\n        });\r\n    };\r\n    return class_1;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { parse } from '../../../base/common/marshalling.js';\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport * as resources from '../../../base/common/resources.js';\r\nimport { ICodeEditorService } from './codeEditorService.js';\r\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { optional } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { ITelemetryService } from '../../../platform/telemetry/common/telemetry.js';\r\nimport { NullTelemetryService } from '../../../platform/telemetry/common/telemetryUtils.js';\r\nvar OpenerService = /** @class */ (function () {\r\n    function OpenerService(_editorService, _commandService, _telemetryService) {\r\n        if (_telemetryService === void 0) { _telemetryService = NullTelemetryService; }\r\n        this._editorService = _editorService;\r\n        this._commandService = _commandService;\r\n        this._telemetryService = _telemetryService;\r\n        //\r\n    }\r\n    OpenerService.prototype.open = function (resource, options) {\r\n        var _a;\r\n        if (this._telemetryService) {\r\n            /* __GDPR__\r\n                \"openerService\" : {\r\n                    \"scheme\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\r\n                }\r\n            */\r\n            this._telemetryService.publicLog('openerService', { scheme: resource.scheme });\r\n        }\r\n        var scheme = resource.scheme, path = resource.path, query = resource.query, fragment = resource.fragment;\r\n        var promise = undefined;\r\n        if (scheme === Schemas.http || scheme === Schemas.https || scheme === Schemas.mailto) {\r\n            // open http or default mail application\r\n            dom.windowOpenNoOpener(resource.toString(true));\r\n        }\r\n        else if (scheme === 'command' && CommandsRegistry.getCommand(path)) {\r\n            // execute as command\r\n            var args = [];\r\n            try {\r\n                args = parse(query);\r\n                if (!Array.isArray(args)) {\r\n                    args = [args];\r\n                }\r\n            }\r\n            catch (e) {\r\n                //\r\n            }\r\n            promise = (_a = this._commandService).executeCommand.apply(_a, [path].concat(args));\r\n        }\r\n        else {\r\n            var selection = undefined;\r\n            var match = /^L?(\\d+)(?:,(\\d+))?/.exec(fragment);\r\n            if (match) {\r\n                // support file:///some/file.js#73,84\r\n                // support file:///some/file.js#L73\r\n                selection = {\r\n                    startLineNumber: parseInt(match[1]),\r\n                    startColumn: match[2] ? parseInt(match[2]) : 1\r\n                };\r\n                // remove fragment\r\n                resource = resource.with({ fragment: '' });\r\n            }\r\n            if (!resource.scheme) {\r\n                // we cannot handle those\r\n                return Promise.resolve(undefined);\r\n            }\r\n            else if (resource.scheme === Schemas.file) {\r\n                resource = resources.normalizePath(resource); // workaround for non-normalized paths (https://github.com/Microsoft/vscode/issues/12954)\r\n            }\r\n            promise = this._editorService.openCodeEditor({ resource: resource, options: { selection: selection, } }, this._editorService.getFocusedCodeEditor(), options && options.openToSide);\r\n        }\r\n        return Promise.resolve(promise);\r\n    };\r\n    OpenerService = __decorate([\r\n        __param(0, ICodeEditorService),\r\n        __param(1, ICommandService),\r\n        __param(2, optional(ITelemetryService))\r\n    ], OpenerService);\r\n    return OpenerService;\r\n}());\r\nexport { OpenerService };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/**\r\n * Throws an error with the provided message if the provided value does not evaluate to a true Javascript value.\r\n */\r\nexport function ok(value, message) {\r\n    if (!value || value === null) {\r\n        throw new Error(message ? 'Assertion failed (' + message + ')' : 'Assertion Failed');\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as assert from '../../../base/common/assert.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { dispose } from '../../../base/common/lifecycle.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar defaultOptions = {\r\n    followsCaret: true,\r\n    ignoreCharChanges: true,\r\n    alwaysRevealFirst: true\r\n};\r\n/**\r\n * Create a new diff navigator for the provided diff editor.\r\n */\r\nvar DiffNavigator = /** @class */ (function () {\r\n    function DiffNavigator(editor, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = this;\r\n        this._onDidUpdate = new Emitter();\r\n        this._editor = editor;\r\n        this._options = objects.mixin(options, defaultOptions, false);\r\n        this.disposed = false;\r\n        this._disposables = [];\r\n        this.nextIdx = -1;\r\n        this.ranges = [];\r\n        this.ignoreSelectionChange = false;\r\n        this.revealFirst = Boolean(this._options.alwaysRevealFirst);\r\n        // hook up to diff editor for diff, disposal, and caret move\r\n        this._disposables.push(this._editor.onDidDispose(function () { return _this.dispose(); }));\r\n        this._disposables.push(this._editor.onDidUpdateDiff(function () { return _this._onDiffUpdated(); }));\r\n        if (this._options.followsCaret) {\r\n            this._disposables.push(this._editor.getModifiedEditor().onDidChangeCursorPosition(function (e) {\r\n                if (_this.ignoreSelectionChange) {\r\n                    return;\r\n                }\r\n                _this.nextIdx = -1;\r\n            }));\r\n        }\r\n        if (this._options.alwaysRevealFirst) {\r\n            this._disposables.push(this._editor.getModifiedEditor().onDidChangeModel(function (e) {\r\n                _this.revealFirst = true;\r\n            }));\r\n        }\r\n        // init things\r\n        this._init();\r\n    }\r\n    DiffNavigator.prototype._init = function () {\r\n        var changes = this._editor.getLineChanges();\r\n        if (!changes) {\r\n            return;\r\n        }\r\n    };\r\n    DiffNavigator.prototype._onDiffUpdated = function () {\r\n        this._init();\r\n        this._compute(this._editor.getLineChanges());\r\n        if (this.revealFirst) {\r\n            // Only reveal first on first non-null changes\r\n            if (this._editor.getLineChanges() !== null) {\r\n                this.revealFirst = false;\r\n                this.nextIdx = -1;\r\n                this.next(1 /* Immediate */);\r\n            }\r\n        }\r\n    };\r\n    DiffNavigator.prototype._compute = function (lineChanges) {\r\n        var _this = this;\r\n        // new ranges\r\n        this.ranges = [];\r\n        if (lineChanges) {\r\n            // create ranges from changes\r\n            lineChanges.forEach(function (lineChange) {\r\n                if (!_this._options.ignoreCharChanges && lineChange.charChanges) {\r\n                    lineChange.charChanges.forEach(function (charChange) {\r\n                        _this.ranges.push({\r\n                            rhs: true,\r\n                            range: new Range(charChange.modifiedStartLineNumber, charChange.modifiedStartColumn, charChange.modifiedEndLineNumber, charChange.modifiedEndColumn)\r\n                        });\r\n                    });\r\n                }\r\n                else {\r\n                    _this.ranges.push({\r\n                        rhs: true,\r\n                        range: new Range(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedStartLineNumber, 1)\r\n                    });\r\n                }\r\n            });\r\n        }\r\n        // sort\r\n        this.ranges.sort(function (left, right) {\r\n            if (left.range.getStartPosition().isBeforeOrEqual(right.range.getStartPosition())) {\r\n                return -1;\r\n            }\r\n            else if (right.range.getStartPosition().isBeforeOrEqual(left.range.getStartPosition())) {\r\n                return 1;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        });\r\n        this._onDidUpdate.fire(this);\r\n    };\r\n    DiffNavigator.prototype._initIdx = function (fwd) {\r\n        var found = false;\r\n        var position = this._editor.getPosition();\r\n        if (!position) {\r\n            this.nextIdx = 0;\r\n            return;\r\n        }\r\n        for (var i = 0, len = this.ranges.length; i < len && !found; i++) {\r\n            var range = this.ranges[i].range;\r\n            if (position.isBeforeOrEqual(range.getStartPosition())) {\r\n                this.nextIdx = i + (fwd ? 0 : -1);\r\n                found = true;\r\n            }\r\n        }\r\n        if (!found) {\r\n            // after the last change\r\n            this.nextIdx = fwd ? 0 : this.ranges.length - 1;\r\n        }\r\n        if (this.nextIdx < 0) {\r\n            this.nextIdx = this.ranges.length - 1;\r\n        }\r\n    };\r\n    DiffNavigator.prototype._move = function (fwd, scrollType) {\r\n        assert.ok(!this.disposed, 'Illegal State - diff navigator has been disposed');\r\n        if (!this.canNavigate()) {\r\n            return;\r\n        }\r\n        if (this.nextIdx === -1) {\r\n            this._initIdx(fwd);\r\n        }\r\n        else if (fwd) {\r\n            this.nextIdx += 1;\r\n            if (this.nextIdx >= this.ranges.length) {\r\n                this.nextIdx = 0;\r\n            }\r\n        }\r\n        else {\r\n            this.nextIdx -= 1;\r\n            if (this.nextIdx < 0) {\r\n                this.nextIdx = this.ranges.length - 1;\r\n            }\r\n        }\r\n        var info = this.ranges[this.nextIdx];\r\n        this.ignoreSelectionChange = true;\r\n        try {\r\n            var pos = info.range.getStartPosition();\r\n            this._editor.setPosition(pos);\r\n            this._editor.revealPositionInCenter(pos, scrollType);\r\n        }\r\n        finally {\r\n            this.ignoreSelectionChange = false;\r\n        }\r\n    };\r\n    DiffNavigator.prototype.canNavigate = function () {\r\n        return this.ranges && this.ranges.length > 0;\r\n    };\r\n    DiffNavigator.prototype.next = function (scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._move(true, scrollType);\r\n    };\r\n    DiffNavigator.prototype.previous = function (scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._move(false, scrollType);\r\n    };\r\n    DiffNavigator.prototype.dispose = function () {\r\n        dispose(this._disposables);\r\n        this._disposables.length = 0;\r\n        this._onDidUpdate.dispose();\r\n        this.ranges = [];\r\n        this.disposed = true;\r\n    };\r\n    return DiffNavigator;\r\n}());\r\nexport { DiffNavigator };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nexport var EditorZoom = new /** @class */ (function () {\r\n    function class_1() {\r\n        this._zoomLevel = 0;\r\n        this._onDidChangeZoomLevel = new Emitter();\r\n        this.onDidChangeZoomLevel = this._onDidChangeZoomLevel.event;\r\n    }\r\n    class_1.prototype.getZoomLevel = function () {\r\n        return this._zoomLevel;\r\n    };\r\n    class_1.prototype.setZoomLevel = function (zoomLevel) {\r\n        zoomLevel = Math.min(Math.max(-5, zoomLevel), 20);\r\n        if (this._zoomLevel === zoomLevel) {\r\n            return;\r\n        }\r\n        this._zoomLevel = zoomLevel;\r\n        this._onDidChangeZoomLevel.fire(this._zoomLevel);\r\n    };\r\n    return class_1;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { EDITOR_FONT_DEFAULTS } from './editorOptions.js';\r\nimport { EditorZoom } from './editorZoom.js';\r\n/**\r\n * Determined from empirical observations.\r\n * @internal\r\n */\r\nvar GOLDEN_LINE_HEIGHT_RATIO = platform.isMacintosh ? 1.5 : 1.35;\r\n/**\r\n * Font settings maximum and minimum limits\r\n */\r\nvar MINIMUM_FONT_SIZE = 8;\r\nvar MAXIMUM_FONT_SIZE = 100;\r\nvar MINIMUM_LINE_HEIGHT = 8;\r\nvar MAXIMUM_LINE_HEIGHT = 150;\r\nvar MINIMUM_LETTER_SPACING = -5;\r\nvar MAXIMUM_LETTER_SPACING = 20;\r\nfunction safeParseFloat(n, defaultValue) {\r\n    if (typeof n === 'number') {\r\n        return n;\r\n    }\r\n    if (typeof n === 'undefined') {\r\n        return defaultValue;\r\n    }\r\n    var r = parseFloat(n);\r\n    if (isNaN(r)) {\r\n        return defaultValue;\r\n    }\r\n    return r;\r\n}\r\nfunction safeParseInt(n, defaultValue) {\r\n    if (typeof n === 'number') {\r\n        return Math.round(n);\r\n    }\r\n    if (typeof n === 'undefined') {\r\n        return defaultValue;\r\n    }\r\n    var r = parseInt(n);\r\n    if (isNaN(r)) {\r\n        return defaultValue;\r\n    }\r\n    return r;\r\n}\r\nfunction clamp(n, min, max) {\r\n    if (n < min) {\r\n        return min;\r\n    }\r\n    if (n > max) {\r\n        return max;\r\n    }\r\n    return n;\r\n}\r\nfunction _string(value, defaultValue) {\r\n    if (typeof value !== 'string') {\r\n        return defaultValue;\r\n    }\r\n    return value;\r\n}\r\nvar BareFontInfo = /** @class */ (function () {\r\n    /**\r\n     * @internal\r\n     */\r\n    function BareFontInfo(opts) {\r\n        this.zoomLevel = opts.zoomLevel;\r\n        this.fontFamily = String(opts.fontFamily);\r\n        this.fontWeight = String(opts.fontWeight);\r\n        this.fontSize = opts.fontSize;\r\n        this.lineHeight = opts.lineHeight | 0;\r\n        this.letterSpacing = opts.letterSpacing;\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    BareFontInfo.createFromRawSettings = function (opts, zoomLevel) {\r\n        var fontFamily = _string(opts.fontFamily, EDITOR_FONT_DEFAULTS.fontFamily);\r\n        var fontWeight = _string(opts.fontWeight, EDITOR_FONT_DEFAULTS.fontWeight);\r\n        var fontSize = safeParseFloat(opts.fontSize, EDITOR_FONT_DEFAULTS.fontSize);\r\n        fontSize = clamp(fontSize, 0, MAXIMUM_FONT_SIZE);\r\n        if (fontSize === 0) {\r\n            fontSize = EDITOR_FONT_DEFAULTS.fontSize;\r\n        }\r\n        else if (fontSize < MINIMUM_FONT_SIZE) {\r\n            fontSize = MINIMUM_FONT_SIZE;\r\n        }\r\n        var lineHeight = safeParseInt(opts.lineHeight, 0);\r\n        lineHeight = clamp(lineHeight, 0, MAXIMUM_LINE_HEIGHT);\r\n        if (lineHeight === 0) {\r\n            lineHeight = Math.round(GOLDEN_LINE_HEIGHT_RATIO * fontSize);\r\n        }\r\n        else if (lineHeight < MINIMUM_LINE_HEIGHT) {\r\n            lineHeight = MINIMUM_LINE_HEIGHT;\r\n        }\r\n        var letterSpacing = safeParseFloat(opts.letterSpacing, 0);\r\n        letterSpacing = clamp(letterSpacing, MINIMUM_LETTER_SPACING, MAXIMUM_LETTER_SPACING);\r\n        var editorZoomLevelMultiplier = 1 + (EditorZoom.getZoomLevel() * 0.1);\r\n        fontSize *= editorZoomLevelMultiplier;\r\n        lineHeight *= editorZoomLevelMultiplier;\r\n        return new BareFontInfo({\r\n            zoomLevel: zoomLevel,\r\n            fontFamily: fontFamily,\r\n            fontWeight: fontWeight,\r\n            fontSize: fontSize,\r\n            lineHeight: lineHeight,\r\n            letterSpacing: letterSpacing\r\n        });\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    BareFontInfo.prototype.getId = function () {\r\n        return this.zoomLevel + '-' + this.fontFamily + '-' + this.fontWeight + '-' + this.fontSize + '-' + this.lineHeight + '-' + this.letterSpacing;\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    BareFontInfo.prototype.getMassagedFontFamily = function () {\r\n        if (/[,\"']/.test(this.fontFamily)) {\r\n            // Looks like the font family might be already escaped\r\n            return this.fontFamily;\r\n        }\r\n        if (/[+ ]/.test(this.fontFamily)) {\r\n            // Wrap a font family using + or <space> with quotes\r\n            return \"\\\"\" + this.fontFamily + \"\\\"\";\r\n        }\r\n        return this.fontFamily;\r\n    };\r\n    return BareFontInfo;\r\n}());\r\nexport { BareFontInfo };\r\nvar FontInfo = /** @class */ (function (_super) {\r\n    __extends(FontInfo, _super);\r\n    /**\r\n     * @internal\r\n     */\r\n    function FontInfo(opts, isTrusted) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.isTrusted = isTrusted;\r\n        _this.isMonospace = opts.isMonospace;\r\n        _this.typicalHalfwidthCharacterWidth = opts.typicalHalfwidthCharacterWidth;\r\n        _this.typicalFullwidthCharacterWidth = opts.typicalFullwidthCharacterWidth;\r\n        _this.canUseHalfwidthRightwardsArrow = opts.canUseHalfwidthRightwardsArrow;\r\n        _this.spaceWidth = opts.spaceWidth;\r\n        _this.maxDigitWidth = opts.maxDigitWidth;\r\n        return _this;\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    FontInfo.prototype.equals = function (other) {\r\n        return (this.fontFamily === other.fontFamily\r\n            && this.fontWeight === other.fontWeight\r\n            && this.fontSize === other.fontSize\r\n            && this.lineHeight === other.lineHeight\r\n            && this.letterSpacing === other.letterSpacing\r\n            && this.typicalHalfwidthCharacterWidth === other.typicalHalfwidthCharacterWidth\r\n            && this.typicalFullwidthCharacterWidth === other.typicalFullwidthCharacterWidth\r\n            && this.canUseHalfwidthRightwardsArrow === other.canUseHalfwidthRightwardsArrow\r\n            && this.spaceWidth === other.spaceWidth\r\n            && this.maxDigitWidth === other.maxDigitWidth);\r\n    };\r\n    return FontInfo;\r\n}(BareFontInfo));\r\nexport { FontInfo };\r\n","/**\r\n * @internal\r\n */\r\nexport function isThemeColor(o) {\r\n    return o && typeof o.id === 'string';\r\n}\r\n/**\r\n * The type of the `IEditor`.\r\n */\r\nexport var EditorType = {\r\n    ICodeEditor: 'vs.editor.ICodeEditor',\r\n    IDiffEditor: 'vs.editor.IDiffEditor'\r\n};\r\n/**\r\n * Built-in commands.\r\n * @internal\r\n */\r\nexport var Handler = {\r\n    ExecuteCommand: 'executeCommand',\r\n    ExecuteCommands: 'executeCommands',\r\n    Type: 'type',\r\n    ReplacePreviousChar: 'replacePreviousChar',\r\n    CompositionStart: 'compositionStart',\r\n    CompositionEnd: 'compositionEnd',\r\n    Paste: 'paste',\r\n    Cut: 'cut',\r\n    Undo: 'undo',\r\n    Redo: 'redo',\r\n};\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/**\r\n * Vertical Lane in the overview ruler of the editor.\r\n */\r\nexport var OverviewRulerLane;\r\n(function (OverviewRulerLane) {\r\n    OverviewRulerLane[OverviewRulerLane[\"Left\"] = 1] = \"Left\";\r\n    OverviewRulerLane[OverviewRulerLane[\"Center\"] = 2] = \"Center\";\r\n    OverviewRulerLane[OverviewRulerLane[\"Right\"] = 4] = \"Right\";\r\n    OverviewRulerLane[OverviewRulerLane[\"Full\"] = 7] = \"Full\";\r\n})(OverviewRulerLane || (OverviewRulerLane = {}));\r\nvar TextModelResolvedOptions = /** @class */ (function () {\r\n    /**\r\n     * @internal\r\n     */\r\n    function TextModelResolvedOptions(src) {\r\n        this.tabSize = src.tabSize | 0;\r\n        this.insertSpaces = Boolean(src.insertSpaces);\r\n        this.defaultEOL = src.defaultEOL | 0;\r\n        this.trimAutoWhitespace = Boolean(src.trimAutoWhitespace);\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    TextModelResolvedOptions.prototype.equals = function (other) {\r\n        return (this.tabSize === other.tabSize\r\n            && this.insertSpaces === other.insertSpaces\r\n            && this.defaultEOL === other.defaultEOL\r\n            && this.trimAutoWhitespace === other.trimAutoWhitespace);\r\n    };\r\n    /**\r\n     * @internal\r\n     */\r\n    TextModelResolvedOptions.prototype.createChangeEvent = function (newOpts) {\r\n        return {\r\n            tabSize: this.tabSize !== newOpts.tabSize,\r\n            insertSpaces: this.insertSpaces !== newOpts.insertSpaces,\r\n            trimAutoWhitespace: this.trimAutoWhitespace !== newOpts.trimAutoWhitespace,\r\n        };\r\n    };\r\n    return TextModelResolvedOptions;\r\n}());\r\nexport { TextModelResolvedOptions };\r\nvar FindMatch = /** @class */ (function () {\r\n    /**\r\n     * @internal\r\n     */\r\n    function FindMatch(range, matches) {\r\n        this.range = range;\r\n        this.matches = matches;\r\n    }\r\n    return FindMatch;\r\n}());\r\nexport { FindMatch };\r\n/**\r\n * @internal\r\n */\r\nvar ApplyEditsResult = /** @class */ (function () {\r\n    function ApplyEditsResult(reverseEdits, changes, trimAutoWhitespaceLineNumbers) {\r\n        this.reverseEdits = reverseEdits;\r\n        this.changes = changes;\r\n        this.trimAutoWhitespaceLineNumbers = trimAutoWhitespaceLineNumbers;\r\n    }\r\n    return ApplyEditsResult;\r\n}());\r\nexport { ApplyEditsResult };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nexport function values(forEachable) {\r\n    var result = [];\r\n    forEachable.forEach(function (value) { return result.push(value); });\r\n    return result;\r\n}\r\nexport function keys(map) {\r\n    var result = [];\r\n    map.forEach(function (value, key) { return result.push(key); });\r\n    return result;\r\n}\r\nvar StringIterator = /** @class */ (function () {\r\n    function StringIterator() {\r\n        this._value = '';\r\n        this._pos = 0;\r\n    }\r\n    StringIterator.prototype.reset = function (key) {\r\n        this._value = key;\r\n        this._pos = 0;\r\n        return this;\r\n    };\r\n    StringIterator.prototype.next = function () {\r\n        this._pos += 1;\r\n        return this;\r\n    };\r\n    StringIterator.prototype.hasNext = function () {\r\n        return this._pos < this._value.length - 1;\r\n    };\r\n    StringIterator.prototype.cmp = function (a) {\r\n        var aCode = a.charCodeAt(0);\r\n        var thisCode = this._value.charCodeAt(this._pos);\r\n        return aCode - thisCode;\r\n    };\r\n    StringIterator.prototype.value = function () {\r\n        return this._value[this._pos];\r\n    };\r\n    return StringIterator;\r\n}());\r\nexport { StringIterator };\r\nvar PathIterator = /** @class */ (function () {\r\n    function PathIterator() {\r\n    }\r\n    PathIterator.prototype.reset = function (key) {\r\n        this._value = key.replace(/\\\\$|\\/$/, '');\r\n        this._from = 0;\r\n        this._to = 0;\r\n        return this.next();\r\n    };\r\n    PathIterator.prototype.hasNext = function () {\r\n        return this._to < this._value.length;\r\n    };\r\n    PathIterator.prototype.next = function () {\r\n        // this._data = key.split(/[\\\\/]/).filter(s => !!s);\r\n        this._from = this._to;\r\n        var justSeps = true;\r\n        for (; this._to < this._value.length; this._to++) {\r\n            var ch = this._value.charCodeAt(this._to);\r\n            if (ch === 47 /* Slash */ || ch === 92 /* Backslash */) {\r\n                if (justSeps) {\r\n                    this._from++;\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n            else {\r\n                justSeps = false;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    PathIterator.prototype.cmp = function (a) {\r\n        var aPos = 0;\r\n        var aLen = a.length;\r\n        var thisPos = this._from;\r\n        while (aPos < aLen && thisPos < this._to) {\r\n            var cmp = a.charCodeAt(aPos) - this._value.charCodeAt(thisPos);\r\n            if (cmp !== 0) {\r\n                return cmp;\r\n            }\r\n            aPos += 1;\r\n            thisPos += 1;\r\n        }\r\n        if (aLen === this._to - this._from) {\r\n            return 0;\r\n        }\r\n        else if (aPos < aLen) {\r\n            return -1;\r\n        }\r\n        else {\r\n            return 1;\r\n        }\r\n    };\r\n    PathIterator.prototype.value = function () {\r\n        return this._value.substring(this._from, this._to);\r\n    };\r\n    return PathIterator;\r\n}());\r\nexport { PathIterator };\r\nvar TernarySearchTreeNode = /** @class */ (function () {\r\n    function TernarySearchTreeNode() {\r\n    }\r\n    return TernarySearchTreeNode;\r\n}());\r\nvar TernarySearchTree = /** @class */ (function () {\r\n    function TernarySearchTree(segments) {\r\n        this._iter = segments;\r\n    }\r\n    TernarySearchTree.forPaths = function () {\r\n        return new TernarySearchTree(new PathIterator());\r\n    };\r\n    TernarySearchTree.forStrings = function () {\r\n        return new TernarySearchTree(new StringIterator());\r\n    };\r\n    TernarySearchTree.prototype.clear = function () {\r\n        this._root = undefined;\r\n    };\r\n    TernarySearchTree.prototype.set = function (key, element) {\r\n        var iter = this._iter.reset(key);\r\n        var node;\r\n        if (!this._root) {\r\n            this._root = new TernarySearchTreeNode();\r\n            this._root.segment = iter.value();\r\n        }\r\n        node = this._root;\r\n        while (true) {\r\n            var val = iter.cmp(node.segment);\r\n            if (val > 0) {\r\n                // left\r\n                if (!node.left) {\r\n                    node.left = new TernarySearchTreeNode();\r\n                    node.left.segment = iter.value();\r\n                }\r\n                node = node.left;\r\n            }\r\n            else if (val < 0) {\r\n                // right\r\n                if (!node.right) {\r\n                    node.right = new TernarySearchTreeNode();\r\n                    node.right.segment = iter.value();\r\n                }\r\n                node = node.right;\r\n            }\r\n            else if (iter.hasNext()) {\r\n                // mid\r\n                iter.next();\r\n                if (!node.mid) {\r\n                    node.mid = new TernarySearchTreeNode();\r\n                    node.mid.segment = iter.value();\r\n                }\r\n                node = node.mid;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        var oldElement = node.value;\r\n        node.value = element;\r\n        node.key = key;\r\n        return oldElement;\r\n    };\r\n    TernarySearchTree.prototype.get = function (key) {\r\n        var iter = this._iter.reset(key);\r\n        var node = this._root;\r\n        while (node) {\r\n            var val = iter.cmp(node.segment);\r\n            if (val > 0) {\r\n                // left\r\n                node = node.left;\r\n            }\r\n            else if (val < 0) {\r\n                // right\r\n                node = node.right;\r\n            }\r\n            else if (iter.hasNext()) {\r\n                // mid\r\n                iter.next();\r\n                node = node.mid;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        return node ? node.value : undefined;\r\n    };\r\n    TernarySearchTree.prototype.findSubstr = function (key) {\r\n        var iter = this._iter.reset(key);\r\n        var node = this._root;\r\n        var candidate = undefined;\r\n        while (node) {\r\n            var val = iter.cmp(node.segment);\r\n            if (val > 0) {\r\n                // left\r\n                node = node.left;\r\n            }\r\n            else if (val < 0) {\r\n                // right\r\n                node = node.right;\r\n            }\r\n            else if (iter.hasNext()) {\r\n                // mid\r\n                iter.next();\r\n                candidate = node.value || candidate;\r\n                node = node.mid;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        return node && node.value || candidate;\r\n    };\r\n    TernarySearchTree.prototype.forEach = function (callback) {\r\n        this._forEach(this._root, callback);\r\n    };\r\n    TernarySearchTree.prototype._forEach = function (node, callback) {\r\n        if (node) {\r\n            // left\r\n            this._forEach(node.left, callback);\r\n            // node\r\n            if (node.value) {\r\n                // callback(node.value, this._iter.join(parts));\r\n                callback(node.value, node.key);\r\n            }\r\n            // mid\r\n            this._forEach(node.mid, callback);\r\n            // right\r\n            this._forEach(node.right, callback);\r\n        }\r\n    };\r\n    return TernarySearchTree;\r\n}());\r\nexport { TernarySearchTree };\r\nvar ResourceMap = /** @class */ (function () {\r\n    function ResourceMap() {\r\n        this.map = new Map();\r\n        this.ignoreCase = false; // in the future this should be an uri-comparator\r\n    }\r\n    ResourceMap.prototype.set = function (resource, value) {\r\n        this.map.set(this.toKey(resource), value);\r\n    };\r\n    ResourceMap.prototype.get = function (resource) {\r\n        return this.map.get(this.toKey(resource));\r\n    };\r\n    ResourceMap.prototype.toKey = function (resource) {\r\n        var key = resource.toString();\r\n        if (this.ignoreCase) {\r\n            key = key.toLowerCase();\r\n        }\r\n        return key;\r\n    };\r\n    return ResourceMap;\r\n}());\r\nexport { ResourceMap };\r\nvar LinkedMap = /** @class */ (function () {\r\n    function LinkedMap() {\r\n        this._map = new Map();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    }\r\n    LinkedMap.prototype.clear = function () {\r\n        this._map.clear();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    };\r\n    Object.defineProperty(LinkedMap.prototype, \"size\", {\r\n        get: function () {\r\n            return this._size;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LinkedMap.prototype.get = function (key, touch) {\r\n        if (touch === void 0) { touch = 0 /* None */; }\r\n        var item = this._map.get(key);\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        if (touch !== 0 /* None */) {\r\n            this.touch(item, touch);\r\n        }\r\n        return item.value;\r\n    };\r\n    LinkedMap.prototype.set = function (key, value, touch) {\r\n        if (touch === void 0) { touch = 0 /* None */; }\r\n        var item = this._map.get(key);\r\n        if (item) {\r\n            item.value = value;\r\n            if (touch !== 0 /* None */) {\r\n                this.touch(item, touch);\r\n            }\r\n        }\r\n        else {\r\n            item = { key: key, value: value, next: undefined, previous: undefined };\r\n            switch (touch) {\r\n                case 0 /* None */:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                case 1 /* AsOld */:\r\n                    this.addItemFirst(item);\r\n                    break;\r\n                case 2 /* AsNew */:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                default:\r\n                    this.addItemLast(item);\r\n                    break;\r\n            }\r\n            this._map.set(key, item);\r\n            this._size++;\r\n        }\r\n    };\r\n    LinkedMap.prototype.forEach = function (callbackfn, thisArg) {\r\n        var current = this._head;\r\n        while (current) {\r\n            if (thisArg) {\r\n                callbackfn.bind(thisArg)(current.value, current.key, this);\r\n            }\r\n            else {\r\n                callbackfn(current.value, current.key, this);\r\n            }\r\n            current = current.next;\r\n        }\r\n    };\r\n    /* VS Code / Monaco editor runs on es5 which has no Symbol.iterator\r\n    public keys(): IterableIterator<K> {\r\n        let current = this._head;\r\n        let iterator: IterableIterator<K> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<K> {\r\n                if (current) {\r\n                    let result = { value: current.key, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n\r\n    public values(): IterableIterator<V> {\r\n        let current = this._head;\r\n        let iterator: IterableIterator<V> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<V> {\r\n                if (current) {\r\n                    let result = { value: current.value, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n    */\r\n    LinkedMap.prototype.trimOld = function (newSize) {\r\n        if (newSize >= this.size) {\r\n            return;\r\n        }\r\n        if (newSize === 0) {\r\n            this.clear();\r\n            return;\r\n        }\r\n        var current = this._head;\r\n        var currentSize = this.size;\r\n        while (current && currentSize > newSize) {\r\n            this._map.delete(current.key);\r\n            current = current.next;\r\n            currentSize--;\r\n        }\r\n        this._head = current;\r\n        this._size = currentSize;\r\n        if (current) {\r\n            current.previous = void 0;\r\n        }\r\n    };\r\n    LinkedMap.prototype.addItemFirst = function (item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._tail = item;\r\n        }\r\n        else if (!this._head) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n        }\r\n        this._head = item;\r\n    };\r\n    LinkedMap.prototype.addItemLast = function (item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._head = item;\r\n        }\r\n        else if (!this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n        }\r\n        this._tail = item;\r\n    };\r\n    LinkedMap.prototype.touch = function (item, touch) {\r\n        if (!this._head || !this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        if ((touch !== 1 /* AsOld */ && touch !== 2 /* AsNew */)) {\r\n            return;\r\n        }\r\n        if (touch === 1 /* AsOld */) {\r\n            if (item === this._head) {\r\n                return;\r\n            }\r\n            var next = item.next;\r\n            var previous = item.previous;\r\n            // Unlink the item\r\n            if (item === this._tail) {\r\n                // previous must be defined since item was not head but is tail\r\n                // So there are more than on item in the map\r\n                previous.next = void 0;\r\n                this._tail = previous;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            // Insert the node at head\r\n            item.previous = void 0;\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n            this._head = item;\r\n        }\r\n        else if (touch === 2 /* AsNew */) {\r\n            if (item === this._tail) {\r\n                return;\r\n            }\r\n            var next = item.next;\r\n            var previous = item.previous;\r\n            // Unlink the item.\r\n            if (item === this._head) {\r\n                // next must be defined since item was not tail but is head\r\n                // So there are more than on item in the map\r\n                next.previous = void 0;\r\n                this._head = next;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            item.next = void 0;\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n            this._tail = item;\r\n        }\r\n    };\r\n    LinkedMap.prototype.toJSON = function () {\r\n        var data = [];\r\n        this.forEach(function (value, key) {\r\n            data.push([key, value]);\r\n        });\r\n        return data;\r\n    };\r\n    return LinkedMap;\r\n}());\r\nexport { LinkedMap };\r\nvar LRUCache = /** @class */ (function (_super) {\r\n    __extends(LRUCache, _super);\r\n    function LRUCache(limit, ratio) {\r\n        if (ratio === void 0) { ratio = 1; }\r\n        var _this = _super.call(this) || this;\r\n        _this._limit = limit;\r\n        _this._ratio = Math.min(Math.max(0, ratio), 1);\r\n        return _this;\r\n    }\r\n    LRUCache.prototype.get = function (key) {\r\n        return _super.prototype.get.call(this, key, 2 /* AsNew */);\r\n    };\r\n    LRUCache.prototype.set = function (key, value) {\r\n        _super.prototype.set.call(this, key, value, 2 /* AsNew */);\r\n        this.checkTrim();\r\n    };\r\n    LRUCache.prototype.checkTrim = function () {\r\n        if (this.size > this._limit) {\r\n            this.trimOld(Math.round(this._limit * this._ratio));\r\n        }\r\n    };\r\n    return LRUCache;\r\n}(LinkedMap));\r\nexport { LRUCache };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as arrays from './arrays.js';\r\nimport * as strings from './strings.js';\r\nimport * as paths from './paths.js';\r\nimport { LRUCache } from './map.js';\r\nimport { isThenable } from './async.js';\r\nvar GLOBSTAR = '**';\r\nvar GLOB_SPLIT = '/';\r\nvar PATH_REGEX = '[/\\\\\\\\]'; // any slash or backslash\r\nvar NO_PATH_REGEX = '[^/\\\\\\\\]'; // any non-slash and non-backslash\r\nvar ALL_FORWARD_SLASHES = /\\//g;\r\nfunction starsToRegExp(starCount) {\r\n    switch (starCount) {\r\n        case 0:\r\n            return '';\r\n        case 1:\r\n            return NO_PATH_REGEX + \"*?\"; // 1 star matches any number of characters except path separator (/ and \\) - non greedy (?)\r\n        default:\r\n            // Matches:  (Path Sep OR Path Val followed by Path Sep OR Path Sep followed by Path Val) 0-many times\r\n            // Group is non capturing because we don't need to capture at all (?:...)\r\n            // Overall we use non-greedy matching because it could be that we match too much\r\n            return \"(?:\" + PATH_REGEX + \"|\" + NO_PATH_REGEX + \"+\" + PATH_REGEX + \"|\" + PATH_REGEX + NO_PATH_REGEX + \"+)*?\";\r\n    }\r\n}\r\nexport function splitGlobAware(pattern, splitChar) {\r\n    if (!pattern) {\r\n        return [];\r\n    }\r\n    var segments = [];\r\n    var inBraces = false;\r\n    var inBrackets = false;\r\n    var char;\r\n    var curVal = '';\r\n    for (var i = 0; i < pattern.length; i++) {\r\n        char = pattern[i];\r\n        switch (char) {\r\n            case splitChar:\r\n                if (!inBraces && !inBrackets) {\r\n                    segments.push(curVal);\r\n                    curVal = '';\r\n                    continue;\r\n                }\r\n                break;\r\n            case '{':\r\n                inBraces = true;\r\n                break;\r\n            case '}':\r\n                inBraces = false;\r\n                break;\r\n            case '[':\r\n                inBrackets = true;\r\n                break;\r\n            case ']':\r\n                inBrackets = false;\r\n                break;\r\n        }\r\n        curVal += char;\r\n    }\r\n    // Tail\r\n    if (curVal) {\r\n        segments.push(curVal);\r\n    }\r\n    return segments;\r\n}\r\nfunction parseRegExp(pattern) {\r\n    if (!pattern) {\r\n        return '';\r\n    }\r\n    var regEx = '';\r\n    // Split up into segments for each slash found\r\n    var segments = splitGlobAware(pattern, GLOB_SPLIT);\r\n    // Special case where we only have globstars\r\n    if (segments.every(function (s) { return s === GLOBSTAR; })) {\r\n        regEx = '.*';\r\n    }\r\n    // Build regex over segments\r\n    else {\r\n        var previousSegmentWasGlobStar_1 = false;\r\n        segments.forEach(function (segment, index) {\r\n            // Globstar is special\r\n            if (segment === GLOBSTAR) {\r\n                // if we have more than one globstar after another, just ignore it\r\n                if (!previousSegmentWasGlobStar_1) {\r\n                    regEx += starsToRegExp(2);\r\n                    previousSegmentWasGlobStar_1 = true;\r\n                }\r\n                return;\r\n            }\r\n            // States\r\n            var inBraces = false;\r\n            var braceVal = '';\r\n            var inBrackets = false;\r\n            var bracketVal = '';\r\n            var char;\r\n            for (var i = 0; i < segment.length; i++) {\r\n                char = segment[i];\r\n                // Support brace expansion\r\n                if (char !== '}' && inBraces) {\r\n                    braceVal += char;\r\n                    continue;\r\n                }\r\n                // Support brackets\r\n                if (inBrackets && (char !== ']' || !bracketVal) /* ] is literally only allowed as first character in brackets to match it */) {\r\n                    var res = void 0;\r\n                    // range operator\r\n                    if (char === '-') {\r\n                        res = char;\r\n                    }\r\n                    // negation operator (only valid on first index in bracket)\r\n                    else if ((char === '^' || char === '!') && !bracketVal) {\r\n                        res = '^';\r\n                    }\r\n                    // glob split matching is not allowed within character ranges\r\n                    // see http://man7.org/linux/man-pages/man7/glob.7.html\r\n                    else if (char === GLOB_SPLIT) {\r\n                        res = '';\r\n                    }\r\n                    // anything else gets escaped\r\n                    else {\r\n                        res = strings.escapeRegExpCharacters(char);\r\n                    }\r\n                    bracketVal += res;\r\n                    continue;\r\n                }\r\n                switch (char) {\r\n                    case '{':\r\n                        inBraces = true;\r\n                        continue;\r\n                    case '[':\r\n                        inBrackets = true;\r\n                        continue;\r\n                    case '}':\r\n                        var choices = splitGlobAware(braceVal, ',');\r\n                        // Converts {foo,bar} => [foo|bar]\r\n                        var braceRegExp = \"(?:\" + choices.map(function (c) { return parseRegExp(c); }).join('|') + \")\";\r\n                        regEx += braceRegExp;\r\n                        inBraces = false;\r\n                        braceVal = '';\r\n                        break;\r\n                    case ']':\r\n                        regEx += ('[' + bracketVal + ']');\r\n                        inBrackets = false;\r\n                        bracketVal = '';\r\n                        break;\r\n                    case '?':\r\n                        regEx += NO_PATH_REGEX; // 1 ? matches any single character except path separator (/ and \\)\r\n                        continue;\r\n                    case '*':\r\n                        regEx += starsToRegExp(1);\r\n                        continue;\r\n                    default:\r\n                        regEx += strings.escapeRegExpCharacters(char);\r\n                }\r\n            }\r\n            // Tail: Add the slash we had split on if there is more to come and the remaining pattern is not a globstar\r\n            // For example if pattern: some/**/*.js we want the \"/\" after some to be included in the RegEx to prevent\r\n            // a folder called \"something\" to match as well.\r\n            // However, if pattern: some/**, we tolerate that we also match on \"something\" because our globstar behaviour\r\n            // is to match 0-N segments.\r\n            if (index < segments.length - 1 && (segments[index + 1] !== GLOBSTAR || index + 2 < segments.length)) {\r\n                regEx += PATH_REGEX;\r\n            }\r\n            // reset state\r\n            previousSegmentWasGlobStar_1 = false;\r\n        });\r\n    }\r\n    return regEx;\r\n}\r\n// regexes to check for trival glob patterns that just check for String#endsWith\r\nvar T1 = /^\\*\\*\\/\\*\\.[\\w\\.-]+$/; // **/*.something\r\nvar T2 = /^\\*\\*\\/([\\w\\.-]+)\\/?$/; // **/something\r\nvar T3 = /^{\\*\\*\\/[\\*\\.]?[\\w\\.-]+\\/?(,\\*\\*\\/[\\*\\.]?[\\w\\.-]+\\/?)*}$/; // {**/*.something,**/*.else} or {**/package.json,**/project.json}\r\nvar T3_2 = /^{\\*\\*\\/[\\*\\.]?[\\w\\.-]+(\\/(\\*\\*)?)?(,\\*\\*\\/[\\*\\.]?[\\w\\.-]+(\\/(\\*\\*)?)?)*}$/; // Like T3, with optional trailing /**\r\nvar T4 = /^\\*\\*((\\/[\\w\\.-]+)+)\\/?$/; // **/something/else\r\nvar T5 = /^([\\w\\.-]+(\\/[\\w\\.-]+)*)\\/?$/; // something/else\r\nvar CACHE = new LRUCache(10000); // bounded to 10000 elements\r\nvar FALSE = function () {\r\n    return false;\r\n};\r\nvar NULL = function () {\r\n    return null;\r\n};\r\nfunction parsePattern(arg1, options) {\r\n    if (!arg1) {\r\n        return NULL;\r\n    }\r\n    // Handle IRelativePattern\r\n    var pattern;\r\n    if (typeof arg1 !== 'string') {\r\n        pattern = arg1.pattern;\r\n    }\r\n    else {\r\n        pattern = arg1;\r\n    }\r\n    // Whitespace trimming\r\n    pattern = pattern.trim();\r\n    // Check cache\r\n    var patternKey = pattern + \"_\" + !!options.trimForExclusions;\r\n    var parsedPattern = CACHE.get(patternKey);\r\n    if (parsedPattern) {\r\n        return wrapRelativePattern(parsedPattern, arg1);\r\n    }\r\n    // Check for Trivias\r\n    var match;\r\n    if (T1.test(pattern)) { // common pattern: **/*.txt just need endsWith check\r\n        var base_1 = pattern.substr(4); // '**/*'.length === 4\r\n        parsedPattern = function (path, basename) {\r\n            return path && strings.endsWith(path, base_1) ? pattern : null;\r\n        };\r\n    }\r\n    else if (match = T2.exec(trimForExclusions(pattern, options))) { // common pattern: **/some.txt just need basename check\r\n        parsedPattern = trivia2(match[1], pattern);\r\n    }\r\n    else if ((options.trimForExclusions ? T3_2 : T3).test(pattern)) { // repetition of common patterns (see above) {**/*.txt,**/*.png}\r\n        parsedPattern = trivia3(pattern, options);\r\n    }\r\n    else if (match = T4.exec(trimForExclusions(pattern, options))) { // common pattern: **/something/else just need endsWith check\r\n        parsedPattern = trivia4and5(match[1].substr(1), pattern, true);\r\n    }\r\n    else if (match = T5.exec(trimForExclusions(pattern, options))) { // common pattern: something/else just need equals check\r\n        parsedPattern = trivia4and5(match[1], pattern, false);\r\n    }\r\n    // Otherwise convert to pattern\r\n    else {\r\n        parsedPattern = toRegExp(pattern);\r\n    }\r\n    // Cache\r\n    CACHE.set(patternKey, parsedPattern);\r\n    return wrapRelativePattern(parsedPattern, arg1);\r\n}\r\nfunction wrapRelativePattern(parsedPattern, arg2) {\r\n    if (typeof arg2 === 'string') {\r\n        return parsedPattern;\r\n    }\r\n    return function (path, basename) {\r\n        if (!paths.isEqualOrParent(path, arg2.base)) {\r\n            return null;\r\n        }\r\n        return parsedPattern(arg2.pathToRelative(arg2.base, path), basename);\r\n    };\r\n}\r\nfunction trimForExclusions(pattern, options) {\r\n    return options.trimForExclusions && strings.endsWith(pattern, '/**') ? pattern.substr(0, pattern.length - 2) : pattern; // dropping **, tailing / is dropped later\r\n}\r\n// common pattern: **/some.txt just need basename check\r\nfunction trivia2(base, originalPattern) {\r\n    var slashBase = \"/\" + base;\r\n    var backslashBase = \"\\\\\" + base;\r\n    var parsedPattern = function (path, basename) {\r\n        if (!path) {\r\n            return null;\r\n        }\r\n        if (basename) {\r\n            return basename === base ? originalPattern : null;\r\n        }\r\n        return path === base || strings.endsWith(path, slashBase) || strings.endsWith(path, backslashBase) ? originalPattern : null;\r\n    };\r\n    var basenames = [base];\r\n    parsedPattern.basenames = basenames;\r\n    parsedPattern.patterns = [originalPattern];\r\n    parsedPattern.allBasenames = basenames;\r\n    return parsedPattern;\r\n}\r\n// repetition of common patterns (see above) {**/*.txt,**/*.png}\r\nfunction trivia3(pattern, options) {\r\n    var parsedPatterns = aggregateBasenameMatches(pattern.slice(1, -1).split(',')\r\n        .map(function (pattern) { return parsePattern(pattern, options); })\r\n        .filter(function (pattern) { return pattern !== NULL; }), pattern);\r\n    var n = parsedPatterns.length;\r\n    if (!n) {\r\n        return NULL;\r\n    }\r\n    if (n === 1) {\r\n        return parsedPatterns[0];\r\n    }\r\n    var parsedPattern = function (path, basename) {\r\n        for (var i = 0, n_1 = parsedPatterns.length; i < n_1; i++) {\r\n            if (parsedPatterns[i](path, basename)) {\r\n                return pattern;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    var withBasenames = arrays.first(parsedPatterns, function (pattern) { return !!pattern.allBasenames; });\r\n    if (withBasenames) {\r\n        parsedPattern.allBasenames = withBasenames.allBasenames;\r\n    }\r\n    var allPaths = parsedPatterns.reduce(function (all, current) { return current.allPaths ? all.concat(current.allPaths) : all; }, []);\r\n    if (allPaths.length) {\r\n        parsedPattern.allPaths = allPaths;\r\n    }\r\n    return parsedPattern;\r\n}\r\n// common patterns: **/something/else just need endsWith check, something/else just needs and equals check\r\nfunction trivia4and5(path, pattern, matchPathEnds) {\r\n    var nativePath = paths.nativeSep !== paths.sep ? path.replace(ALL_FORWARD_SLASHES, paths.nativeSep) : path;\r\n    var nativePathEnd = paths.nativeSep + nativePath;\r\n    var parsedPattern = matchPathEnds ? function (path, basename) {\r\n        return path && (path === nativePath || strings.endsWith(path, nativePathEnd)) ? pattern : null;\r\n    } : function (path, basename) {\r\n        return path && path === nativePath ? pattern : null;\r\n    };\r\n    parsedPattern.allPaths = [(matchPathEnds ? '*/' : './') + path];\r\n    return parsedPattern;\r\n}\r\nfunction toRegExp(pattern) {\r\n    try {\r\n        var regExp_1 = new RegExp(\"^\" + parseRegExp(pattern) + \"$\");\r\n        return function (path, basename) {\r\n            regExp_1.lastIndex = 0; // reset RegExp to its initial state to reuse it!\r\n            return path && regExp_1.test(path) ? pattern : null;\r\n        };\r\n    }\r\n    catch (error) {\r\n        return NULL;\r\n    }\r\n}\r\nexport function match(arg1, path, hasSibling) {\r\n    if (!arg1 || !path) {\r\n        return false;\r\n    }\r\n    return parse(arg1)(path, undefined, hasSibling);\r\n}\r\nexport function parse(arg1, options) {\r\n    if (options === void 0) { options = {}; }\r\n    if (!arg1) {\r\n        return FALSE;\r\n    }\r\n    // Glob with String\r\n    if (typeof arg1 === 'string' || isRelativePattern(arg1)) {\r\n        var parsedPattern_1 = parsePattern(arg1, options);\r\n        if (parsedPattern_1 === NULL) {\r\n            return FALSE;\r\n        }\r\n        var resultPattern = function (path, basename) {\r\n            return !!parsedPattern_1(path, basename);\r\n        };\r\n        if (parsedPattern_1.allBasenames) {\r\n            resultPattern.allBasenames = parsedPattern_1.allBasenames;\r\n        }\r\n        if (parsedPattern_1.allPaths) {\r\n            resultPattern.allPaths = parsedPattern_1.allPaths;\r\n        }\r\n        return resultPattern;\r\n    }\r\n    // Glob with Expression\r\n    return parsedExpression(arg1, options);\r\n}\r\nexport function isRelativePattern(obj) {\r\n    var rp = obj;\r\n    return rp && typeof rp.base === 'string' && typeof rp.pattern === 'string' && typeof rp.pathToRelative === 'function';\r\n}\r\nfunction parsedExpression(expression, options) {\r\n    var parsedPatterns = aggregateBasenameMatches(Object.getOwnPropertyNames(expression)\r\n        .map(function (pattern) { return parseExpressionPattern(pattern, expression[pattern], options); })\r\n        .filter(function (pattern) { return pattern !== NULL; }));\r\n    var n = parsedPatterns.length;\r\n    if (!n) {\r\n        return NULL;\r\n    }\r\n    if (!parsedPatterns.some(function (parsedPattern) { return !!parsedPattern.requiresSiblings; })) {\r\n        if (n === 1) {\r\n            return parsedPatterns[0];\r\n        }\r\n        var resultExpression_1 = function (path, basename) {\r\n            for (var i = 0, n_2 = parsedPatterns.length; i < n_2; i++) {\r\n                // Pattern matches path\r\n                var result = parsedPatterns[i](path, basename);\r\n                if (result) {\r\n                    return result;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        var withBasenames_1 = arrays.first(parsedPatterns, function (pattern) { return !!pattern.allBasenames; });\r\n        if (withBasenames_1) {\r\n            resultExpression_1.allBasenames = withBasenames_1.allBasenames;\r\n        }\r\n        var allPaths_1 = parsedPatterns.reduce(function (all, current) { return current.allPaths ? all.concat(current.allPaths) : all; }, []);\r\n        if (allPaths_1.length) {\r\n            resultExpression_1.allPaths = allPaths_1;\r\n        }\r\n        return resultExpression_1;\r\n    }\r\n    var resultExpression = function (path, basename, hasSibling) {\r\n        var name = undefined;\r\n        for (var i = 0, n_3 = parsedPatterns.length; i < n_3; i++) {\r\n            // Pattern matches path\r\n            var parsedPattern = parsedPatterns[i];\r\n            if (parsedPattern.requiresSiblings && hasSibling) {\r\n                if (!basename) {\r\n                    basename = paths.basename(path);\r\n                }\r\n                if (!name) {\r\n                    name = basename.substr(0, basename.length - paths.extname(path).length);\r\n                }\r\n            }\r\n            var result = parsedPattern(path, basename, name, hasSibling);\r\n            if (result) {\r\n                return result;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    var withBasenames = arrays.first(parsedPatterns, function (pattern) { return !!pattern.allBasenames; });\r\n    if (withBasenames) {\r\n        resultExpression.allBasenames = withBasenames.allBasenames;\r\n    }\r\n    var allPaths = parsedPatterns.reduce(function (all, current) { return current.allPaths ? all.concat(current.allPaths) : all; }, []);\r\n    if (allPaths.length) {\r\n        resultExpression.allPaths = allPaths;\r\n    }\r\n    return resultExpression;\r\n}\r\nfunction parseExpressionPattern(pattern, value, options) {\r\n    if (value === false) {\r\n        return NULL; // pattern is disabled\r\n    }\r\n    var parsedPattern = parsePattern(pattern, options);\r\n    if (parsedPattern === NULL) {\r\n        return NULL;\r\n    }\r\n    // Expression Pattern is <boolean>\r\n    if (typeof value === 'boolean') {\r\n        return parsedPattern;\r\n    }\r\n    // Expression Pattern is <SiblingClause>\r\n    if (value) {\r\n        var when_1 = value.when;\r\n        if (typeof when_1 === 'string') {\r\n            var result = function (path, basename, name, hasSibling) {\r\n                if (!hasSibling || !parsedPattern(path, basename)) {\r\n                    return null;\r\n                }\r\n                var clausePattern = when_1.replace('$(basename)', name);\r\n                var matched = hasSibling(clausePattern);\r\n                return isThenable(matched) ?\r\n                    matched.then(function (m) { return m ? pattern : null; }) :\r\n                    matched ? pattern : null;\r\n            };\r\n            result.requiresSiblings = true;\r\n            return result;\r\n        }\r\n    }\r\n    // Expression is Anything\r\n    return parsedPattern;\r\n}\r\nfunction aggregateBasenameMatches(parsedPatterns, result) {\r\n    var basenamePatterns = parsedPatterns.filter(function (parsedPattern) { return !!parsedPattern.basenames; });\r\n    if (basenamePatterns.length < 2) {\r\n        return parsedPatterns;\r\n    }\r\n    var basenames = basenamePatterns.reduce(function (all, current) {\r\n        var basenames = current.basenames;\r\n        return basenames ? all.concat(basenames) : all;\r\n    }, []);\r\n    var patterns;\r\n    if (result) {\r\n        patterns = [];\r\n        for (var i = 0, n = basenames.length; i < n; i++) {\r\n            patterns.push(result);\r\n        }\r\n    }\r\n    else {\r\n        patterns = basenamePatterns.reduce(function (all, current) {\r\n            var patterns = current.patterns;\r\n            return patterns ? all.concat(patterns) : all;\r\n        }, []);\r\n    }\r\n    var aggregate = function (path, basename) {\r\n        if (!path) {\r\n            return null;\r\n        }\r\n        if (!basename) {\r\n            var i = void 0;\r\n            for (i = path.length; i > 0; i--) {\r\n                var ch = path.charCodeAt(i - 1);\r\n                if (ch === 47 /* Slash */ || ch === 92 /* Backslash */) {\r\n                    break;\r\n                }\r\n            }\r\n            basename = path.substr(i);\r\n        }\r\n        var index = basenames.indexOf(basename);\r\n        return index !== -1 ? patterns[index] : null;\r\n    };\r\n    aggregate.basenames = basenames;\r\n    aggregate.patterns = patterns;\r\n    aggregate.allBasenames = basenames;\r\n    var aggregatedPatterns = parsedPatterns.filter(function (parsedPattern) { return !parsedPattern.basenames; });\r\n    aggregatedPatterns.push(aggregate);\r\n    return aggregatedPatterns;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { match as matchGlobPattern } from '../../../base/common/glob.js';\r\nexport function score(selector, candidateUri, candidateLanguage, candidateIsSynchronized) {\r\n    if (Array.isArray(selector)) {\r\n        // array -> take max individual value\r\n        var ret = 0;\r\n        for (var _i = 0, selector_1 = selector; _i < selector_1.length; _i++) {\r\n            var filter = selector_1[_i];\r\n            var value = score(filter, candidateUri, candidateLanguage, candidateIsSynchronized);\r\n            if (value === 10) {\r\n                return value; // already at the highest\r\n            }\r\n            if (value > ret) {\r\n                ret = value;\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    else if (typeof selector === 'string') {\r\n        if (!candidateIsSynchronized) {\r\n            return 0;\r\n        }\r\n        // short-hand notion, desugars to\r\n        // 'fooLang' -> { language: 'fooLang'}\r\n        // '*' -> { language: '*' }\r\n        if (selector === '*') {\r\n            return 5;\r\n        }\r\n        else if (selector === candidateLanguage) {\r\n            return 10;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    }\r\n    else if (selector) {\r\n        // filter -> select accordingly, use defaults for scheme\r\n        var language = selector.language, pattern = selector.pattern, scheme = selector.scheme, hasAccessToAllModels = selector.hasAccessToAllModels;\r\n        if (!candidateIsSynchronized && !hasAccessToAllModels) {\r\n            return 0;\r\n        }\r\n        var ret = 0;\r\n        if (scheme) {\r\n            if (scheme === candidateUri.scheme) {\r\n                ret = 10;\r\n            }\r\n            else if (scheme === '*') {\r\n                ret = 5;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        }\r\n        if (language) {\r\n            if (language === candidateLanguage) {\r\n                ret = 10;\r\n            }\r\n            else if (language === '*') {\r\n                ret = Math.max(ret, 5);\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        }\r\n        if (pattern) {\r\n            if (pattern === candidateUri.fsPath || matchGlobPattern(pattern, candidateUri.fsPath)) {\r\n                ret = 10;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    else {\r\n        return 0;\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nexport var IModelService = createDecorator('modelService');\r\nexport function shouldSynchronizeModel(model) {\r\n    return (!model.isTooLargeForSyncing() && !model.isForSimpleWidget);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { toDisposable } from '../../../base/common/lifecycle.js';\r\nimport { score } from './languageSelector.js';\r\nimport { shouldSynchronizeModel } from '../services/modelService.js';\r\nfunction isExclusive(selector) {\r\n    if (typeof selector === 'string') {\r\n        return false;\r\n    }\r\n    else if (Array.isArray(selector)) {\r\n        return selector.every(isExclusive);\r\n    }\r\n    else {\r\n        return !!selector.exclusive;\r\n    }\r\n}\r\nvar LanguageFeatureRegistry = /** @class */ (function () {\r\n    function LanguageFeatureRegistry() {\r\n        this._clock = 0;\r\n        this._entries = [];\r\n        this._onDidChange = new Emitter();\r\n    }\r\n    Object.defineProperty(LanguageFeatureRegistry.prototype, \"onDidChange\", {\r\n        get: function () {\r\n            return this._onDidChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LanguageFeatureRegistry.prototype.register = function (selector, provider) {\r\n        var _this = this;\r\n        var entry = {\r\n            selector: selector,\r\n            provider: provider,\r\n            _score: -1,\r\n            _time: this._clock++\r\n        };\r\n        this._entries.push(entry);\r\n        this._lastCandidate = undefined;\r\n        this._onDidChange.fire(this._entries.length);\r\n        return toDisposable(function () {\r\n            if (entry) {\r\n                var idx = _this._entries.indexOf(entry);\r\n                if (idx >= 0) {\r\n                    _this._entries.splice(idx, 1);\r\n                    _this._lastCandidate = undefined;\r\n                    _this._onDidChange.fire(_this._entries.length);\r\n                    entry = undefined;\r\n                }\r\n            }\r\n        });\r\n    };\r\n    LanguageFeatureRegistry.prototype.has = function (model) {\r\n        return this.all(model).length > 0;\r\n    };\r\n    LanguageFeatureRegistry.prototype.all = function (model) {\r\n        if (!model) {\r\n            return [];\r\n        }\r\n        this._updateScores(model);\r\n        var result = [];\r\n        // from registry\r\n        for (var _i = 0, _a = this._entries; _i < _a.length; _i++) {\r\n            var entry = _a[_i];\r\n            if (entry._score > 0) {\r\n                result.push(entry.provider);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    LanguageFeatureRegistry.prototype.ordered = function (model) {\r\n        var result = [];\r\n        this._orderedForEach(model, function (entry) { return result.push(entry.provider); });\r\n        return result;\r\n    };\r\n    LanguageFeatureRegistry.prototype.orderedGroups = function (model) {\r\n        var result = [];\r\n        var lastBucket;\r\n        var lastBucketScore;\r\n        this._orderedForEach(model, function (entry) {\r\n            if (lastBucket && lastBucketScore === entry._score) {\r\n                lastBucket.push(entry.provider);\r\n            }\r\n            else {\r\n                lastBucketScore = entry._score;\r\n                lastBucket = [entry.provider];\r\n                result.push(lastBucket);\r\n            }\r\n        });\r\n        return result;\r\n    };\r\n    LanguageFeatureRegistry.prototype._orderedForEach = function (model, callback) {\r\n        if (!model) {\r\n            return;\r\n        }\r\n        this._updateScores(model);\r\n        for (var from = 0; from < this._entries.length; from++) {\r\n            var entry = this._entries[from];\r\n            if (entry._score > 0) {\r\n                callback(entry);\r\n            }\r\n        }\r\n    };\r\n    LanguageFeatureRegistry.prototype._updateScores = function (model) {\r\n        var candidate = {\r\n            uri: model.uri.toString(),\r\n            language: model.getLanguageIdentifier().language\r\n        };\r\n        if (this._lastCandidate\r\n            && this._lastCandidate.language === candidate.language\r\n            && this._lastCandidate.uri === candidate.uri) {\r\n            // nothing has changed\r\n            return;\r\n        }\r\n        this._lastCandidate = candidate;\r\n        for (var _i = 0, _a = this._entries; _i < _a.length; _i++) {\r\n            var entry = _a[_i];\r\n            entry._score = score(entry.selector, model.uri, model.getLanguageIdentifier().language, shouldSynchronizeModel(model));\r\n            if (isExclusive(entry.selector) && entry._score > 0) {\r\n                // support for one exclusive selector that overwrites\r\n                // any other selector\r\n                for (var _b = 0, _c = this._entries; _b < _c.length; _b++) {\r\n                    var entry_1 = _c[_b];\r\n                    entry_1._score = 0;\r\n                }\r\n                entry._score = 1000;\r\n                break;\r\n            }\r\n        }\r\n        // needs sorting\r\n        this._entries.sort(LanguageFeatureRegistry._compareByScoreAndTime);\r\n    };\r\n    LanguageFeatureRegistry._compareByScoreAndTime = function (a, b) {\r\n        if (a._score < b._score) {\r\n            return 1;\r\n        }\r\n        else if (a._score > b._score) {\r\n            return -1;\r\n        }\r\n        else if (a._time < b._time) {\r\n            return 1;\r\n        }\r\n        else if (a._time > b._time) {\r\n            return -1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    };\r\n    return LanguageFeatureRegistry;\r\n}());\r\nexport { LanguageFeatureRegistry };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { toDisposable } from '../../../base/common/lifecycle.js';\r\nvar TokenizationRegistryImpl = /** @class */ (function () {\r\n    function TokenizationRegistryImpl() {\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._map = Object.create(null);\r\n        this._promises = Object.create(null);\r\n        this._colorMap = null;\r\n    }\r\n    TokenizationRegistryImpl.prototype.fire = function (languages) {\r\n        this._onDidChange.fire({\r\n            changedLanguages: languages,\r\n            changedColorMap: false\r\n        });\r\n    };\r\n    TokenizationRegistryImpl.prototype.register = function (language, support) {\r\n        var _this = this;\r\n        this._map[language] = support;\r\n        this.fire([language]);\r\n        return toDisposable(function () {\r\n            if (_this._map[language] !== support) {\r\n                return;\r\n            }\r\n            delete _this._map[language];\r\n            _this.fire([language]);\r\n        });\r\n    };\r\n    TokenizationRegistryImpl.prototype.getPromise = function (language) {\r\n        var _this = this;\r\n        var support = this.get(language);\r\n        if (support) {\r\n            return Promise.resolve(support);\r\n        }\r\n        var promise = this._promises[language];\r\n        if (promise) {\r\n            return promise.then(function (_) { return _this.get(language); });\r\n        }\r\n        return null;\r\n    };\r\n    TokenizationRegistryImpl.prototype.get = function (language) {\r\n        return (this._map[language] || null);\r\n    };\r\n    TokenizationRegistryImpl.prototype.setColorMap = function (colorMap) {\r\n        this._colorMap = colorMap;\r\n        this._onDidChange.fire({\r\n            changedLanguages: Object.keys(this._map),\r\n            changedColorMap: true\r\n        });\r\n    };\r\n    TokenizationRegistryImpl.prototype.getColorMap = function () {\r\n        return this._colorMap;\r\n    };\r\n    TokenizationRegistryImpl.prototype.getDefaultBackground = function () {\r\n        if (this._colorMap && this._colorMap.length > 2 /* DefaultBackground */) {\r\n            return this._colorMap[2 /* DefaultBackground */];\r\n        }\r\n        return null;\r\n    };\r\n    return TokenizationRegistryImpl;\r\n}());\r\nexport { TokenizationRegistryImpl };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isObject } from '../../base/common/types.js';\r\nimport { LanguageFeatureRegistry } from './modes/languageFeatureRegistry.js';\r\nimport { TokenizationRegistryImpl } from './modes/tokenizationRegistry.js';\r\n/**\r\n * @internal\r\n */\r\nvar LanguageIdentifier = /** @class */ (function () {\r\n    function LanguageIdentifier(language, id) {\r\n        this.language = language;\r\n        this.id = id;\r\n    }\r\n    return LanguageIdentifier;\r\n}());\r\nexport { LanguageIdentifier };\r\n/**\r\n * @internal\r\n */\r\nvar TokenMetadata = /** @class */ (function () {\r\n    function TokenMetadata() {\r\n    }\r\n    TokenMetadata.getLanguageId = function (metadata) {\r\n        return (metadata & 255 /* LANGUAGEID_MASK */) >>> 0 /* LANGUAGEID_OFFSET */;\r\n    };\r\n    TokenMetadata.getTokenType = function (metadata) {\r\n        return (metadata & 1792 /* TOKEN_TYPE_MASK */) >>> 8 /* TOKEN_TYPE_OFFSET */;\r\n    };\r\n    TokenMetadata.getFontStyle = function (metadata) {\r\n        return (metadata & 14336 /* FONT_STYLE_MASK */) >>> 11 /* FONT_STYLE_OFFSET */;\r\n    };\r\n    TokenMetadata.getForeground = function (metadata) {\r\n        return (metadata & 8372224 /* FOREGROUND_MASK */) >>> 14 /* FOREGROUND_OFFSET */;\r\n    };\r\n    TokenMetadata.getBackground = function (metadata) {\r\n        return (metadata & 4286578688 /* BACKGROUND_MASK */) >>> 23 /* BACKGROUND_OFFSET */;\r\n    };\r\n    TokenMetadata.getClassNameFromMetadata = function (metadata) {\r\n        var foreground = this.getForeground(metadata);\r\n        var className = 'mtk' + foreground;\r\n        var fontStyle = this.getFontStyle(metadata);\r\n        if (fontStyle & 1 /* Italic */) {\r\n            className += ' mtki';\r\n        }\r\n        if (fontStyle & 2 /* Bold */) {\r\n            className += ' mtkb';\r\n        }\r\n        if (fontStyle & 4 /* Underline */) {\r\n            className += ' mtku';\r\n        }\r\n        return className;\r\n    };\r\n    TokenMetadata.getInlineStyleFromMetadata = function (metadata, colorMap) {\r\n        var foreground = this.getForeground(metadata);\r\n        var fontStyle = this.getFontStyle(metadata);\r\n        var result = \"color: \" + colorMap[foreground] + \";\";\r\n        if (fontStyle & 1 /* Italic */) {\r\n            result += 'font-style: italic;';\r\n        }\r\n        if (fontStyle & 2 /* Bold */) {\r\n            result += 'font-weight: bold;';\r\n        }\r\n        if (fontStyle & 4 /* Underline */) {\r\n            result += 'text-decoration: underline;';\r\n        }\r\n        return result;\r\n    };\r\n    return TokenMetadata;\r\n}());\r\nexport { TokenMetadata };\r\n/**\r\n * @internal\r\n */\r\nexport var completionKindToCssClass = (function () {\r\n    var data = Object.create(null);\r\n    data[0 /* Method */] = 'method';\r\n    data[1 /* Function */] = 'function';\r\n    data[2 /* Constructor */] = 'constructor';\r\n    data[3 /* Field */] = 'field';\r\n    data[4 /* Variable */] = 'variable';\r\n    data[5 /* Class */] = 'class';\r\n    data[6 /* Struct */] = 'struct';\r\n    data[7 /* Interface */] = 'interface';\r\n    data[8 /* Module */] = 'module';\r\n    data[9 /* Property */] = 'property';\r\n    data[10 /* Event */] = 'event';\r\n    data[11 /* Operator */] = 'operator';\r\n    data[12 /* Unit */] = 'unit';\r\n    data[13 /* Value */] = 'value';\r\n    data[14 /* Constant */] = 'constant';\r\n    data[15 /* Enum */] = 'enum';\r\n    data[16 /* EnumMember */] = 'enum-member';\r\n    data[17 /* Keyword */] = 'keyword';\r\n    data[25 /* Snippet */] = 'snippet';\r\n    data[18 /* Text */] = 'text';\r\n    data[19 /* Color */] = 'color';\r\n    data[20 /* File */] = 'file';\r\n    data[21 /* Reference */] = 'reference';\r\n    data[22 /* Customcolor */] = 'customcolor';\r\n    data[23 /* Folder */] = 'folder';\r\n    data[24 /* TypeParameter */] = 'type-parameter';\r\n    return function (kind) {\r\n        return data[kind] || 'property';\r\n    };\r\n})();\r\n/**\r\n * @internal\r\n */\r\nexport var completionKindFromLegacyString = (function () {\r\n    var data = Object.create(null);\r\n    data['method'] = 0 /* Method */;\r\n    data['function'] = 1 /* Function */;\r\n    data['constructor'] = 2 /* Constructor */;\r\n    data['field'] = 3 /* Field */;\r\n    data['variable'] = 4 /* Variable */;\r\n    data['class'] = 5 /* Class */;\r\n    data['struct'] = 6 /* Struct */;\r\n    data['interface'] = 7 /* Interface */;\r\n    data['module'] = 8 /* Module */;\r\n    data['property'] = 9 /* Property */;\r\n    data['event'] = 10 /* Event */;\r\n    data['operator'] = 11 /* Operator */;\r\n    data['unit'] = 12 /* Unit */;\r\n    data['value'] = 13 /* Value */;\r\n    data['constant'] = 14 /* Constant */;\r\n    data['enum'] = 15 /* Enum */;\r\n    data['enum-member'] = 16 /* EnumMember */;\r\n    data['keyword'] = 17 /* Keyword */;\r\n    data['snippet'] = 25 /* Snippet */;\r\n    data['text'] = 18 /* Text */;\r\n    data['color'] = 19 /* Color */;\r\n    data['file'] = 20 /* File */;\r\n    data['reference'] = 21 /* Reference */;\r\n    data['customcolor'] = 22 /* Customcolor */;\r\n    data['folder'] = 23 /* Folder */;\r\n    data['type-parameter'] = 24 /* TypeParameter */;\r\n    return function (value) {\r\n        return data[value] || 'property';\r\n    };\r\n})();\r\nexport var SignatureHelpTriggerReason;\r\n(function (SignatureHelpTriggerReason) {\r\n    SignatureHelpTriggerReason[SignatureHelpTriggerReason[\"Invoke\"] = 1] = \"Invoke\";\r\n    SignatureHelpTriggerReason[SignatureHelpTriggerReason[\"TriggerCharacter\"] = 2] = \"TriggerCharacter\";\r\n    SignatureHelpTriggerReason[SignatureHelpTriggerReason[\"ContentChange\"] = 3] = \"ContentChange\";\r\n})(SignatureHelpTriggerReason || (SignatureHelpTriggerReason = {}));\r\n/**\r\n * A document highlight kind.\r\n */\r\nexport var DocumentHighlightKind;\r\n(function (DocumentHighlightKind) {\r\n    /**\r\n     * A textual occurrence.\r\n     */\r\n    DocumentHighlightKind[DocumentHighlightKind[\"Text\"] = 0] = \"Text\";\r\n    /**\r\n     * Read-access of a symbol, like reading a variable.\r\n     */\r\n    DocumentHighlightKind[DocumentHighlightKind[\"Read\"] = 1] = \"Read\";\r\n    /**\r\n     * Write-access of a symbol, like writing to a variable.\r\n     */\r\n    DocumentHighlightKind[DocumentHighlightKind[\"Write\"] = 2] = \"Write\";\r\n})(DocumentHighlightKind || (DocumentHighlightKind = {}));\r\n/**\r\n * @internal\r\n */\r\nexport var symbolKindToCssClass = (function () {\r\n    var _fromMapping = Object.create(null);\r\n    _fromMapping[0 /* File */] = 'file';\r\n    _fromMapping[1 /* Module */] = 'module';\r\n    _fromMapping[2 /* Namespace */] = 'namespace';\r\n    _fromMapping[3 /* Package */] = 'package';\r\n    _fromMapping[4 /* Class */] = 'class';\r\n    _fromMapping[5 /* Method */] = 'method';\r\n    _fromMapping[6 /* Property */] = 'property';\r\n    _fromMapping[7 /* Field */] = 'field';\r\n    _fromMapping[8 /* Constructor */] = 'constructor';\r\n    _fromMapping[9 /* Enum */] = 'enum';\r\n    _fromMapping[10 /* Interface */] = 'interface';\r\n    _fromMapping[11 /* Function */] = 'function';\r\n    _fromMapping[12 /* Variable */] = 'variable';\r\n    _fromMapping[13 /* Constant */] = 'constant';\r\n    _fromMapping[14 /* String */] = 'string';\r\n    _fromMapping[15 /* Number */] = 'number';\r\n    _fromMapping[16 /* Boolean */] = 'boolean';\r\n    _fromMapping[17 /* Array */] = 'array';\r\n    _fromMapping[18 /* Object */] = 'object';\r\n    _fromMapping[19 /* Key */] = 'key';\r\n    _fromMapping[20 /* Null */] = 'null';\r\n    _fromMapping[21 /* EnumMember */] = 'enum-member';\r\n    _fromMapping[22 /* Struct */] = 'struct';\r\n    _fromMapping[23 /* Event */] = 'event';\r\n    _fromMapping[24 /* Operator */] = 'operator';\r\n    _fromMapping[25 /* TypeParameter */] = 'type-parameter';\r\n    return function toCssClassName(kind) {\r\n        return \"symbol-icon \" + (_fromMapping[kind] || 'property');\r\n    };\r\n})();\r\nvar FoldingRangeKind = /** @class */ (function () {\r\n    /**\r\n     * Creates a new [FoldingRangeKind](#FoldingRangeKind).\r\n     *\r\n     * @param value of the kind.\r\n     */\r\n    function FoldingRangeKind(value) {\r\n        this.value = value;\r\n    }\r\n    /**\r\n     * Kind for folding range representing a comment. The value of the kind is 'comment'.\r\n     */\r\n    FoldingRangeKind.Comment = new FoldingRangeKind('comment');\r\n    /**\r\n     * Kind for folding range representing a import. The value of the kind is 'imports'.\r\n     */\r\n    FoldingRangeKind.Imports = new FoldingRangeKind('imports');\r\n    /**\r\n     * Kind for folding range representing regions (for example marked by `#region`, `#endregion`).\r\n     * The value of the kind is 'region'.\r\n     */\r\n    FoldingRangeKind.Region = new FoldingRangeKind('region');\r\n    return FoldingRangeKind;\r\n}());\r\nexport { FoldingRangeKind };\r\n/**\r\n * @internal\r\n */\r\nexport function isResourceTextEdit(thing) {\r\n    return isObject(thing) && thing.resource && Array.isArray(thing.edits);\r\n}\r\n// --- feature registries ------\r\n/**\r\n * @internal\r\n */\r\nexport var ReferenceProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var RenameProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var CompletionProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var SignatureHelpProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var HoverProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var DocumentSymbolProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var DocumentHighlightProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var DefinitionProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var ImplementationProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var TypeDefinitionProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var CodeLensProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var CodeActionProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var DocumentFormattingEditProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var DocumentRangeFormattingEditProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var OnTypeFormattingEditProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var LinkProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var ColorProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var FoldingRangeProviderRegistry = new LanguageFeatureRegistry();\r\n/**\r\n * @internal\r\n */\r\nexport var TokenizationRegistry = new TokenizationRegistryImpl();\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Token, TokenizationResult, TokenizationResult2 } from '../core/token.js';\r\nimport { LanguageIdentifier } from '../modes.js';\r\nvar NullStateImpl = /** @class */ (function () {\r\n    function NullStateImpl() {\r\n    }\r\n    NullStateImpl.prototype.clone = function () {\r\n        return this;\r\n    };\r\n    NullStateImpl.prototype.equals = function (other) {\r\n        return (this === other);\r\n    };\r\n    return NullStateImpl;\r\n}());\r\nexport var NULL_STATE = new NullStateImpl();\r\nexport var NULL_MODE_ID = 'vs.editor.nullMode';\r\nexport var NULL_LANGUAGE_IDENTIFIER = new LanguageIdentifier(NULL_MODE_ID, 0 /* Null */);\r\nexport function nullTokenize(modeId, buffer, state, deltaOffset) {\r\n    return new TokenizationResult([new Token(deltaOffset, '', modeId)], state);\r\n}\r\nexport function nullTokenize2(languageId, buffer, state, deltaOffset) {\r\n    var tokens = new Uint32Array(2);\r\n    tokens[0] = deltaOffset;\r\n    tokens[1] = ((languageId << 0 /* LANGUAGEID_OFFSET */)\r\n        | (0 /* Other */ << 8 /* TOKEN_TYPE_OFFSET */)\r\n        | (0 /* None */ << 11 /* FONT_STYLE_OFFSET */)\r\n        | (1 /* DefaultForeground */ << 14 /* FOREGROUND_OFFSET */)\r\n        | (2 /* DefaultBackground */ << 23 /* BACKGROUND_OFFSET */)) >>> 0;\r\n    return new TokenizationResult2(tokens, state === null ? NULL_STATE : state);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nexport var ID_EDITOR_WORKER_SERVICE = 'editorWorkerService';\r\nexport var IEditorWorkerService = createDecorator(ID_EDITOR_WORKER_SERVICE);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nexport var ITextModelService = createDecorator('textModelService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { transformErrorForSerialization } from '../errors.js';\r\nimport { Disposable } from '../lifecycle.js';\r\nimport { isWeb } from '../platform.js';\r\nimport { PolyfillPromise } from '../winjs.polyfill.promise.js';\r\nvar global = self;\r\n// When missing, polyfill the native promise\r\n// with our winjs-based polyfill\r\nif (typeof global.Promise === 'undefined') {\r\n    global.Promise = PolyfillPromise;\r\n}\r\nvar INITIALIZE = '$initialize';\r\nvar webWorkerWarningLogged = false;\r\nexport function logOnceWebWorkerWarning(err) {\r\n    if (!isWeb) {\r\n        // running tests\r\n        return;\r\n    }\r\n    if (!webWorkerWarningLogged) {\r\n        webWorkerWarningLogged = true;\r\n        console.warn('Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/Microsoft/monaco-editor#faq');\r\n    }\r\n    console.warn(err.message);\r\n}\r\nvar SimpleWorkerProtocol = /** @class */ (function () {\r\n    function SimpleWorkerProtocol(handler) {\r\n        this._workerId = -1;\r\n        this._handler = handler;\r\n        this._lastSentReq = 0;\r\n        this._pendingReplies = Object.create(null);\r\n    }\r\n    SimpleWorkerProtocol.prototype.setWorkerId = function (workerId) {\r\n        this._workerId = workerId;\r\n    };\r\n    SimpleWorkerProtocol.prototype.sendMessage = function (method, args) {\r\n        var _this = this;\r\n        var req = String(++this._lastSentReq);\r\n        return new Promise(function (resolve, reject) {\r\n            _this._pendingReplies[req] = {\r\n                resolve: resolve,\r\n                reject: reject\r\n            };\r\n            _this._send({\r\n                vsWorker: _this._workerId,\r\n                req: req,\r\n                method: method,\r\n                args: args\r\n            });\r\n        });\r\n    };\r\n    SimpleWorkerProtocol.prototype.handleMessage = function (serializedMessage) {\r\n        var message;\r\n        try {\r\n            message = JSON.parse(serializedMessage);\r\n        }\r\n        catch (e) {\r\n            // nothing\r\n            return;\r\n        }\r\n        if (!message || !message.vsWorker) {\r\n            return;\r\n        }\r\n        if (this._workerId !== -1 && message.vsWorker !== this._workerId) {\r\n            return;\r\n        }\r\n        this._handleMessage(message);\r\n    };\r\n    SimpleWorkerProtocol.prototype._handleMessage = function (msg) {\r\n        var _this = this;\r\n        if (msg.seq) {\r\n            var replyMessage = msg;\r\n            if (!this._pendingReplies[replyMessage.seq]) {\r\n                console.warn('Got reply to unknown seq');\r\n                return;\r\n            }\r\n            var reply = this._pendingReplies[replyMessage.seq];\r\n            delete this._pendingReplies[replyMessage.seq];\r\n            if (replyMessage.err) {\r\n                var err = replyMessage.err;\r\n                if (replyMessage.err.$isError) {\r\n                    err = new Error();\r\n                    err.name = replyMessage.err.name;\r\n                    err.message = replyMessage.err.message;\r\n                    err.stack = replyMessage.err.stack;\r\n                }\r\n                reply.reject(err);\r\n                return;\r\n            }\r\n            reply.resolve(replyMessage.res);\r\n            return;\r\n        }\r\n        var requestMessage = msg;\r\n        var req = requestMessage.req;\r\n        var result = this._handler.handleMessage(requestMessage.method, requestMessage.args);\r\n        result.then(function (r) {\r\n            _this._send({\r\n                vsWorker: _this._workerId,\r\n                seq: req,\r\n                res: r,\r\n                err: undefined\r\n            });\r\n        }, function (e) {\r\n            if (e.detail instanceof Error) {\r\n                // Loading errors have a detail property that points to the actual error\r\n                e.detail = transformErrorForSerialization(e.detail);\r\n            }\r\n            _this._send({\r\n                vsWorker: _this._workerId,\r\n                seq: req,\r\n                res: undefined,\r\n                err: transformErrorForSerialization(e)\r\n            });\r\n        });\r\n    };\r\n    SimpleWorkerProtocol.prototype._send = function (msg) {\r\n        var strMsg = JSON.stringify(msg);\r\n        // console.log('SENDING: ' + strMsg);\r\n        this._handler.sendMessage(strMsg);\r\n    };\r\n    return SimpleWorkerProtocol;\r\n}());\r\n/**\r\n * Main thread side\r\n */\r\nvar SimpleWorkerClient = /** @class */ (function (_super) {\r\n    __extends(SimpleWorkerClient, _super);\r\n    function SimpleWorkerClient(workerFactory, moduleId) {\r\n        var _this = _super.call(this) || this;\r\n        var lazyProxyReject = null;\r\n        _this._worker = _this._register(workerFactory.create('vs/base/common/worker/simpleWorker', function (msg) {\r\n            _this._protocol.handleMessage(msg);\r\n        }, function (err) {\r\n            // in Firefox, web workers fail lazily :(\r\n            // we will reject the proxy\r\n            if (lazyProxyReject) {\r\n                lazyProxyReject(err);\r\n            }\r\n        }));\r\n        _this._protocol = new SimpleWorkerProtocol({\r\n            sendMessage: function (msg) {\r\n                _this._worker.postMessage(msg);\r\n            },\r\n            handleMessage: function (method, args) {\r\n                // Intentionally not supporting worker -> main requests\r\n                return Promise.resolve(null);\r\n            }\r\n        });\r\n        _this._protocol.setWorkerId(_this._worker.getId());\r\n        // Gather loader configuration\r\n        var loaderConfiguration = null;\r\n        if (typeof self.require !== 'undefined' && typeof self.require.getConfig === 'function') {\r\n            // Get the configuration from the Monaco AMD Loader\r\n            loaderConfiguration = self.require.getConfig();\r\n        }\r\n        else if (typeof self.requirejs !== 'undefined') {\r\n            // Get the configuration from requirejs\r\n            loaderConfiguration = self.requirejs.s.contexts._.config;\r\n        }\r\n        // Send initialize message\r\n        _this._onModuleLoaded = _this._protocol.sendMessage(INITIALIZE, [\r\n            _this._worker.getId(),\r\n            moduleId,\r\n            loaderConfiguration\r\n        ]);\r\n        _this._lazyProxy = new Promise(function (resolve, reject) {\r\n            lazyProxyReject = reject;\r\n            _this._onModuleLoaded.then(function (availableMethods) {\r\n                var proxy = {};\r\n                for (var i = 0; i < availableMethods.length; i++) {\r\n                    proxy[availableMethods[i]] = createProxyMethod(availableMethods[i], proxyMethodRequest);\r\n                }\r\n                resolve(proxy);\r\n            }, function (e) {\r\n                reject(e);\r\n                _this._onError('Worker failed to load ' + moduleId, e);\r\n            });\r\n        });\r\n        // Create proxy to loaded code\r\n        var proxyMethodRequest = function (method, args) {\r\n            return _this._request(method, args);\r\n        };\r\n        var createProxyMethod = function (method, proxyMethodRequest) {\r\n            return function () {\r\n                var args = Array.prototype.slice.call(arguments, 0);\r\n                return proxyMethodRequest(method, args);\r\n            };\r\n        };\r\n        return _this;\r\n    }\r\n    SimpleWorkerClient.prototype.getProxyObject = function () {\r\n        return this._lazyProxy;\r\n    };\r\n    SimpleWorkerClient.prototype._request = function (method, args) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._onModuleLoaded.then(function () {\r\n                _this._protocol.sendMessage(method, args).then(resolve, reject);\r\n            }, reject);\r\n        });\r\n    };\r\n    SimpleWorkerClient.prototype._onError = function (message, error) {\r\n        console.error(message);\r\n        console.info(error);\r\n    };\r\n    return SimpleWorkerClient;\r\n}(Disposable));\r\nexport { SimpleWorkerClient };\r\n/**\r\n * Worker side\r\n */\r\nvar SimpleWorkerServer = /** @class */ (function () {\r\n    function SimpleWorkerServer(postSerializedMessage, requestHandler) {\r\n        var _this = this;\r\n        this._requestHandler = requestHandler;\r\n        this._protocol = new SimpleWorkerProtocol({\r\n            sendMessage: function (msg) {\r\n                postSerializedMessage(msg);\r\n            },\r\n            handleMessage: function (method, args) { return _this._handleMessage(method, args); }\r\n        });\r\n    }\r\n    SimpleWorkerServer.prototype.onmessage = function (msg) {\r\n        this._protocol.handleMessage(msg);\r\n    };\r\n    SimpleWorkerServer.prototype._handleMessage = function (method, args) {\r\n        if (method === INITIALIZE) {\r\n            return this.initialize(args[0], args[1], args[2]);\r\n        }\r\n        if (!this._requestHandler || typeof this._requestHandler[method] !== 'function') {\r\n            return Promise.reject(new Error('Missing requestHandler or method: ' + method));\r\n        }\r\n        try {\r\n            return Promise.resolve(this._requestHandler[method].apply(this._requestHandler, args));\r\n        }\r\n        catch (e) {\r\n            return Promise.reject(e);\r\n        }\r\n    };\r\n    SimpleWorkerServer.prototype.initialize = function (workerId, moduleId, loaderConfig) {\r\n        var _this = this;\r\n        this._protocol.setWorkerId(workerId);\r\n        if (this._requestHandler) {\r\n            // static request handler\r\n            var methods = [];\r\n            for (var prop in this._requestHandler) {\r\n                if (typeof this._requestHandler[prop] === 'function') {\r\n                    methods.push(prop);\r\n                }\r\n            }\r\n            return Promise.resolve(methods);\r\n        }\r\n        if (loaderConfig) {\r\n            // Remove 'baseUrl', handling it is beyond scope for now\r\n            if (typeof loaderConfig.baseUrl !== 'undefined') {\r\n                delete loaderConfig['baseUrl'];\r\n            }\r\n            if (typeof loaderConfig.paths !== 'undefined') {\r\n                if (typeof loaderConfig.paths.vs !== 'undefined') {\r\n                    delete loaderConfig.paths['vs'];\r\n                }\r\n            }\r\n            // Since this is in a web worker, enable catching errors\r\n            loaderConfig.catchError = true;\r\n            self.require.config(loaderConfig);\r\n        }\r\n        return new Promise(function (resolve, reject) {\r\n            // Use the global require to be sure to get the global config\r\n            self.require([moduleId], function () {\r\n                var result = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    result[_i] = arguments[_i];\r\n                }\r\n                var handlerModule = result[0];\r\n                _this._requestHandler = handlerModule.create();\r\n                if (!_this._requestHandler) {\r\n                    reject(new Error(\"No RequestHandler!\"));\r\n                    return;\r\n                }\r\n                var methods = [];\r\n                for (var prop in _this._requestHandler) {\r\n                    if (typeof _this._requestHandler[prop] === 'function') {\r\n                        methods.push(prop);\r\n                    }\r\n                }\r\n                resolve(methods);\r\n            }, reject);\r\n        });\r\n    };\r\n    return SimpleWorkerServer;\r\n}());\r\nexport { SimpleWorkerServer };\r\n/**\r\n * Called on the worker side\r\n */\r\nexport function create(postMessage) {\r\n    return new SimpleWorkerServer(postMessage, null);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { globals } from '../common/platform.js';\r\nimport { logOnceWebWorkerWarning } from '../common/worker/simpleWorker.js';\r\nfunction getWorker(workerId, label) {\r\n    // Option for hosts to overwrite the worker script (used in the standalone editor)\r\n    if (globals.MonacoEnvironment) {\r\n        if (typeof globals.MonacoEnvironment.getWorker === 'function') {\r\n            return globals.MonacoEnvironment.getWorker(workerId, label);\r\n        }\r\n        if (typeof globals.MonacoEnvironment.getWorkerUrl === 'function') {\r\n            return new Worker(globals.MonacoEnvironment.getWorkerUrl(workerId, label));\r\n        }\r\n    }\r\n    // ESM-comment-begin\r\n    // \tif (typeof require === 'function') {\r\n    // \t\treturn new Worker(require.toUrl('./' + workerId) + '#' + label);\r\n    // \t}\r\n    // ESM-comment-end\r\n    throw new Error(\"You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker\");\r\n}\r\n/**\r\n * A worker that uses HTML5 web workers so that is has\r\n * its own global scope and its own thread.\r\n */\r\nvar WebWorker = /** @class */ (function () {\r\n    function WebWorker(moduleId, id, label, onMessageCallback, onErrorCallback) {\r\n        this.id = id;\r\n        this.worker = getWorker('workerMain.js', label);\r\n        this.postMessage(moduleId);\r\n        this.worker.onmessage = function (ev) {\r\n            onMessageCallback(ev.data);\r\n        };\r\n        if (typeof this.worker.addEventListener === 'function') {\r\n            this.worker.addEventListener('error', onErrorCallback);\r\n        }\r\n    }\r\n    WebWorker.prototype.getId = function () {\r\n        return this.id;\r\n    };\r\n    WebWorker.prototype.postMessage = function (msg) {\r\n        if (this.worker) {\r\n            this.worker.postMessage(msg);\r\n        }\r\n    };\r\n    WebWorker.prototype.dispose = function () {\r\n        if (this.worker) {\r\n            this.worker.terminate();\r\n        }\r\n        this.worker = null;\r\n    };\r\n    return WebWorker;\r\n}());\r\nvar DefaultWorkerFactory = /** @class */ (function () {\r\n    function DefaultWorkerFactory(label) {\r\n        this._label = label;\r\n        this._webWorkerFailedBeforeError = false;\r\n    }\r\n    DefaultWorkerFactory.prototype.create = function (moduleId, onMessageCallback, onErrorCallback) {\r\n        var _this = this;\r\n        var workerId = (++DefaultWorkerFactory.LAST_WORKER_ID);\r\n        if (this._webWorkerFailedBeforeError) {\r\n            throw this._webWorkerFailedBeforeError;\r\n        }\r\n        return new WebWorker(moduleId, workerId, this._label || 'anonymous' + workerId, onMessageCallback, function (err) {\r\n            logOnceWebWorkerWarning(err);\r\n            _this._webWorkerFailedBeforeError = err;\r\n            onErrorCallback(err);\r\n        });\r\n    };\r\n    DefaultWorkerFactory.LAST_WORKER_ID = 0;\r\n    return DefaultWorkerFactory;\r\n}());\r\nexport { DefaultWorkerFactory };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/**\r\n * Describes what to do with the indentation when pressing Enter.\r\n */\r\nexport var IndentAction;\r\n(function (IndentAction) {\r\n    /**\r\n     * Insert new line and copy the previous line's indentation.\r\n     */\r\n    IndentAction[IndentAction[\"None\"] = 0] = \"None\";\r\n    /**\r\n     * Insert new line and indent once (relative to the previous line's indentation).\r\n     */\r\n    IndentAction[IndentAction[\"Indent\"] = 1] = \"Indent\";\r\n    /**\r\n     * Insert two new lines:\r\n     *  - the first one indented which will hold the cursor\r\n     *  - the second one at the same indentation level\r\n     */\r\n    IndentAction[IndentAction[\"IndentOutdent\"] = 2] = \"IndentOutdent\";\r\n    /**\r\n     * Insert new line and outdent once (relative to the previous line's indentation).\r\n     */\r\n    IndentAction[IndentAction[\"Outdent\"] = 3] = \"Outdent\";\r\n})(IndentAction || (IndentAction = {}));\r\n/**\r\n * @internal\r\n */\r\nvar StandardAutoClosingPairConditional = /** @class */ (function () {\r\n    function StandardAutoClosingPairConditional(source) {\r\n        this.open = source.open;\r\n        this.close = source.close;\r\n        // initially allowed in all tokens\r\n        this._standardTokenMask = 0;\r\n        if (Array.isArray(source.notIn)) {\r\n            for (var i = 0, len = source.notIn.length; i < len; i++) {\r\n                var notIn = source.notIn[i];\r\n                switch (notIn) {\r\n                    case 'string':\r\n                        this._standardTokenMask |= 2 /* String */;\r\n                        break;\r\n                    case 'comment':\r\n                        this._standardTokenMask |= 1 /* Comment */;\r\n                        break;\r\n                    case 'regex':\r\n                        this._standardTokenMask |= 4 /* RegEx */;\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    StandardAutoClosingPairConditional.prototype.isOK = function (standardToken) {\r\n        return (this._standardTokenMask & standardToken) === 0;\r\n    };\r\n    return StandardAutoClosingPairConditional;\r\n}());\r\nexport { StandardAutoClosingPairConditional };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport function createScopedLineTokens(context, offset) {\r\n    var tokenCount = context.getCount();\r\n    var tokenIndex = context.findTokenIndexAtOffset(offset);\r\n    var desiredLanguageId = context.getLanguageId(tokenIndex);\r\n    var lastTokenIndex = tokenIndex;\r\n    while (lastTokenIndex + 1 < tokenCount && context.getLanguageId(lastTokenIndex + 1) === desiredLanguageId) {\r\n        lastTokenIndex++;\r\n    }\r\n    var firstTokenIndex = tokenIndex;\r\n    while (firstTokenIndex > 0 && context.getLanguageId(firstTokenIndex - 1) === desiredLanguageId) {\r\n        firstTokenIndex--;\r\n    }\r\n    return new ScopedLineTokens(context, desiredLanguageId, firstTokenIndex, lastTokenIndex + 1, context.getStartOffset(firstTokenIndex), context.getEndOffset(lastTokenIndex));\r\n}\r\nvar ScopedLineTokens = /** @class */ (function () {\r\n    function ScopedLineTokens(actual, languageId, firstTokenIndex, lastTokenIndex, firstCharOffset, lastCharOffset) {\r\n        this._actual = actual;\r\n        this.languageId = languageId;\r\n        this._firstTokenIndex = firstTokenIndex;\r\n        this._lastTokenIndex = lastTokenIndex;\r\n        this.firstCharOffset = firstCharOffset;\r\n        this._lastCharOffset = lastCharOffset;\r\n    }\r\n    ScopedLineTokens.prototype.getLineContent = function () {\r\n        var actualLineContent = this._actual.getLineContent();\r\n        return actualLineContent.substring(this.firstCharOffset, this._lastCharOffset);\r\n    };\r\n    ScopedLineTokens.prototype.getTokenCount = function () {\r\n        return this._lastTokenIndex - this._firstTokenIndex;\r\n    };\r\n    ScopedLineTokens.prototype.findTokenIndexAtOffset = function (offset) {\r\n        return this._actual.findTokenIndexAtOffset(offset + this.firstCharOffset) - this._firstTokenIndex;\r\n    };\r\n    ScopedLineTokens.prototype.getStandardTokenType = function (tokenIndex) {\r\n        return this._actual.getStandardTokenType(tokenIndex + this._firstTokenIndex);\r\n    };\r\n    return ScopedLineTokens;\r\n}());\r\nexport { ScopedLineTokens };\r\nexport function ignoreBracketsInToken(standardTokenType) {\r\n    return (standardTokenType & 7 /* value */) !== 0;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { StandardAutoClosingPairConditional } from '../languageConfiguration.js';\r\nvar CharacterPairSupport = /** @class */ (function () {\r\n    function CharacterPairSupport(config) {\r\n        if (config.autoClosingPairs) {\r\n            this._autoClosingPairs = config.autoClosingPairs.map(function (el) { return new StandardAutoClosingPairConditional(el); });\r\n        }\r\n        else if (config.brackets) {\r\n            this._autoClosingPairs = config.brackets.map(function (b) { return new StandardAutoClosingPairConditional({ open: b[0], close: b[1] }); });\r\n        }\r\n        else {\r\n            this._autoClosingPairs = [];\r\n        }\r\n        this._autoCloseBefore = typeof config.autoCloseBefore === 'string' ? config.autoCloseBefore : CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED;\r\n        this._surroundingPairs = config.surroundingPairs || this._autoClosingPairs;\r\n    }\r\n    CharacterPairSupport.prototype.getAutoClosingPairs = function () {\r\n        return this._autoClosingPairs;\r\n    };\r\n    CharacterPairSupport.prototype.getAutoCloseBeforeSet = function () {\r\n        return this._autoCloseBefore;\r\n    };\r\n    CharacterPairSupport.prototype.shouldAutoClosePair = function (character, context, column) {\r\n        // Always complete on empty line\r\n        if (context.getTokenCount() === 0) {\r\n            return true;\r\n        }\r\n        var tokenIndex = context.findTokenIndexAtOffset(column - 2);\r\n        var standardTokenType = context.getStandardTokenType(tokenIndex);\r\n        for (var i = 0; i < this._autoClosingPairs.length; ++i) {\r\n            var autoClosingPair = this._autoClosingPairs[i];\r\n            if (autoClosingPair.open === character) {\r\n                return autoClosingPair.isOK(standardTokenType);\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    CharacterPairSupport.prototype.getSurroundingPairs = function () {\r\n        return this._surroundingPairs;\r\n    };\r\n    CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED = ';:.,=}])> \\n\\t';\r\n    return CharacterPairSupport;\r\n}());\r\nexport { CharacterPairSupport };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { Range } from '../../core/range.js';\r\nvar RichEditBracket = /** @class */ (function () {\r\n    function RichEditBracket(languageIdentifier, open, close, forwardRegex, reversedRegex) {\r\n        this.languageIdentifier = languageIdentifier;\r\n        this.open = open;\r\n        this.close = close;\r\n        this.forwardRegex = forwardRegex;\r\n        this.reversedRegex = reversedRegex;\r\n    }\r\n    return RichEditBracket;\r\n}());\r\nexport { RichEditBracket };\r\nvar RichEditBrackets = /** @class */ (function () {\r\n    function RichEditBrackets(languageIdentifier, brackets) {\r\n        var _this = this;\r\n        this.brackets = brackets.map(function (b) {\r\n            return new RichEditBracket(languageIdentifier, b[0], b[1], getRegexForBracketPair({ open: b[0], close: b[1] }), getReversedRegexForBracketPair({ open: b[0], close: b[1] }));\r\n        });\r\n        this.forwardRegex = getRegexForBrackets(this.brackets);\r\n        this.reversedRegex = getReversedRegexForBrackets(this.brackets);\r\n        this.textIsBracket = {};\r\n        this.textIsOpenBracket = {};\r\n        var maxBracketLength = 0;\r\n        this.brackets.forEach(function (b) {\r\n            _this.textIsBracket[b.open.toLowerCase()] = b;\r\n            _this.textIsBracket[b.close.toLowerCase()] = b;\r\n            _this.textIsOpenBracket[b.open.toLowerCase()] = true;\r\n            _this.textIsOpenBracket[b.close.toLowerCase()] = false;\r\n            maxBracketLength = Math.max(maxBracketLength, b.open.length);\r\n            maxBracketLength = Math.max(maxBracketLength, b.close.length);\r\n        });\r\n        this.maxBracketLength = maxBracketLength;\r\n    }\r\n    return RichEditBrackets;\r\n}());\r\nexport { RichEditBrackets };\r\nfunction once(keyFn, computeFn) {\r\n    var cache = {};\r\n    return function (input) {\r\n        var key = keyFn(input);\r\n        if (!cache.hasOwnProperty(key)) {\r\n            cache[key] = computeFn(input);\r\n        }\r\n        return cache[key];\r\n    };\r\n}\r\nvar getRegexForBracketPair = once(function (input) { return input.open + \";\" + input.close; }, function (input) {\r\n    return createBracketOrRegExp([input.open, input.close]);\r\n});\r\nvar getReversedRegexForBracketPair = once(function (input) { return input.open + \";\" + input.close; }, function (input) {\r\n    return createBracketOrRegExp([toReversedString(input.open), toReversedString(input.close)]);\r\n});\r\nvar getRegexForBrackets = once(function (input) { return input.map(function (b) { return b.open + \";\" + b.close; }).join(';'); }, function (input) {\r\n    var pieces = [];\r\n    input.forEach(function (b) {\r\n        pieces.push(b.open);\r\n        pieces.push(b.close);\r\n    });\r\n    return createBracketOrRegExp(pieces);\r\n});\r\nvar getReversedRegexForBrackets = once(function (input) { return input.map(function (b) { return b.open + \";\" + b.close; }).join(';'); }, function (input) {\r\n    var pieces = [];\r\n    input.forEach(function (b) {\r\n        pieces.push(toReversedString(b.open));\r\n        pieces.push(toReversedString(b.close));\r\n    });\r\n    return createBracketOrRegExp(pieces);\r\n});\r\nfunction prepareBracketForRegExp(str) {\r\n    // This bracket pair uses letters like e.g. \"begin\" - \"end\"\r\n    var insertWordBoundaries = (/^[\\w]+$/.test(str));\r\n    str = strings.escapeRegExpCharacters(str);\r\n    return (insertWordBoundaries ? \"\\\\b\" + str + \"\\\\b\" : str);\r\n}\r\nfunction createBracketOrRegExp(pieces) {\r\n    var regexStr = \"(\" + pieces.map(prepareBracketForRegExp).join(')|(') + \")\";\r\n    return strings.createRegExp(regexStr, true);\r\n}\r\nvar toReversedString = (function () {\r\n    function reverse(str) {\r\n        var reversedStr = '';\r\n        for (var i = str.length - 1; i >= 0; i--) {\r\n            reversedStr += str.charAt(i);\r\n        }\r\n        return reversedStr;\r\n    }\r\n    var lastInput = null;\r\n    var lastOutput = null;\r\n    return function toReversedString(str) {\r\n        if (lastInput !== str) {\r\n            lastInput = str;\r\n            lastOutput = reverse(lastInput);\r\n        }\r\n        return lastOutput;\r\n    };\r\n})();\r\nvar BracketsUtils = /** @class */ (function () {\r\n    function BracketsUtils() {\r\n    }\r\n    BracketsUtils._findPrevBracketInText = function (reversedBracketRegex, lineNumber, reversedText, offset) {\r\n        var m = reversedText.match(reversedBracketRegex);\r\n        if (!m) {\r\n            return null;\r\n        }\r\n        var matchOffset = reversedText.length - (m.index || 0);\r\n        var matchLength = m[0].length;\r\n        var absoluteMatchOffset = offset + matchOffset;\r\n        return new Range(lineNumber, absoluteMatchOffset - matchLength + 1, lineNumber, absoluteMatchOffset + 1);\r\n    };\r\n    BracketsUtils.findPrevBracketInToken = function (reversedBracketRegex, lineNumber, lineText, currentTokenStart, currentTokenEnd) {\r\n        // Because JS does not support backwards regex search, we search forwards in a reversed string with a reversed regex ;)\r\n        var reversedLineText = toReversedString(lineText);\r\n        var reversedTokenText = reversedLineText.substring(lineText.length - currentTokenEnd, lineText.length - currentTokenStart);\r\n        return this._findPrevBracketInText(reversedBracketRegex, lineNumber, reversedTokenText, currentTokenStart);\r\n    };\r\n    BracketsUtils.findNextBracketInText = function (bracketRegex, lineNumber, text, offset) {\r\n        var m = text.match(bracketRegex);\r\n        if (!m) {\r\n            return null;\r\n        }\r\n        var matchOffset = m.index || 0;\r\n        var matchLength = m[0].length;\r\n        if (matchLength === 0) {\r\n            return null;\r\n        }\r\n        var absoluteMatchOffset = offset + matchOffset;\r\n        return new Range(lineNumber, absoluteMatchOffset + 1, lineNumber, absoluteMatchOffset + 1 + matchLength);\r\n    };\r\n    BracketsUtils.findNextBracketInToken = function (bracketRegex, lineNumber, lineText, currentTokenStart, currentTokenEnd) {\r\n        var currentTokenText = lineText.substring(currentTokenStart, currentTokenEnd);\r\n        return this.findNextBracketInText(bracketRegex, lineNumber, currentTokenText, currentTokenStart);\r\n    };\r\n    return BracketsUtils;\r\n}());\r\nexport { BracketsUtils };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { StandardAutoClosingPairConditional } from '../languageConfiguration.js';\r\nimport { ignoreBracketsInToken } from '../supports.js';\r\nimport { BracketsUtils } from './richEditBrackets.js';\r\nvar BracketElectricCharacterSupport = /** @class */ (function () {\r\n    function BracketElectricCharacterSupport(richEditBrackets, autoClosePairs, contribution) {\r\n        contribution = contribution || {};\r\n        this._richEditBrackets = richEditBrackets;\r\n        this._complexAutoClosePairs = autoClosePairs.filter(function (pair) { return pair.open.length > 1 && !!pair.close; }).map(function (el) { return new StandardAutoClosingPairConditional(el); });\r\n        if (contribution.docComment) {\r\n            // IDocComment is legacy, only partially supported\r\n            this._complexAutoClosePairs.push(new StandardAutoClosingPairConditional({ open: contribution.docComment.open, close: contribution.docComment.close }));\r\n        }\r\n    }\r\n    BracketElectricCharacterSupport.prototype.getElectricCharacters = function () {\r\n        var result = [];\r\n        if (this._richEditBrackets) {\r\n            for (var i = 0, len = this._richEditBrackets.brackets.length; i < len; i++) {\r\n                var bracketPair = this._richEditBrackets.brackets[i];\r\n                var lastChar = bracketPair.close.charAt(bracketPair.close.length - 1);\r\n                result.push(lastChar);\r\n            }\r\n        }\r\n        // auto close\r\n        for (var _i = 0, _a = this._complexAutoClosePairs; _i < _a.length; _i++) {\r\n            var pair = _a[_i];\r\n            result.push(pair.open.charAt(pair.open.length - 1));\r\n        }\r\n        // Filter duplicate entries\r\n        result = result.filter(function (item, pos, array) {\r\n            return array.indexOf(item) === pos;\r\n        });\r\n        return result;\r\n    };\r\n    BracketElectricCharacterSupport.prototype.onElectricCharacter = function (character, context, column) {\r\n        return (this._onElectricAutoClose(character, context, column) ||\r\n            this._onElectricAutoIndent(character, context, column));\r\n    };\r\n    BracketElectricCharacterSupport.prototype._onElectricAutoIndent = function (character, context, column) {\r\n        if (!this._richEditBrackets || this._richEditBrackets.brackets.length === 0) {\r\n            return null;\r\n        }\r\n        var tokenIndex = context.findTokenIndexAtOffset(column - 1);\r\n        if (ignoreBracketsInToken(context.getStandardTokenType(tokenIndex))) {\r\n            return null;\r\n        }\r\n        var reversedBracketRegex = this._richEditBrackets.reversedRegex;\r\n        var text = context.getLineContent().substring(0, column - 1) + character;\r\n        var r = BracketsUtils.findPrevBracketInToken(reversedBracketRegex, 1, text, 0, text.length);\r\n        if (!r) {\r\n            return null;\r\n        }\r\n        var bracketText = text.substring(r.startColumn - 1, r.endColumn - 1);\r\n        bracketText = bracketText.toLowerCase();\r\n        var isOpen = this._richEditBrackets.textIsOpenBracket[bracketText];\r\n        if (isOpen) {\r\n            return null;\r\n        }\r\n        var textBeforeBracket = text.substring(0, r.startColumn - 1);\r\n        if (!/^\\s*$/.test(textBeforeBracket)) {\r\n            // There is other text on the line before the bracket\r\n            return null;\r\n        }\r\n        return {\r\n            matchOpenBracket: bracketText\r\n        };\r\n    };\r\n    BracketElectricCharacterSupport.prototype._onElectricAutoClose = function (character, context, column) {\r\n        if (!this._complexAutoClosePairs.length) {\r\n            return null;\r\n        }\r\n        var line = context.getLineContent();\r\n        for (var i = 0, len = this._complexAutoClosePairs.length; i < len; i++) {\r\n            var pair = this._complexAutoClosePairs[i];\r\n            // See if the right electric character was pressed\r\n            if (character !== pair.open.charAt(pair.open.length - 1)) {\r\n                continue;\r\n            }\r\n            // check if the full open bracket matches\r\n            var start = column - pair.open.length + 1;\r\n            var actual = line.substring(start - 1, column - 1) + character;\r\n            if (actual !== pair.open) {\r\n                continue;\r\n            }\r\n            var lastTokenIndex = context.findTokenIndexAtOffset(column - 1);\r\n            var lastTokenStandardType = context.getStandardTokenType(lastTokenIndex);\r\n            // If we're in a scope listed in 'notIn', do nothing\r\n            if (!pair.isOK(lastTokenStandardType)) {\r\n                continue;\r\n            }\r\n            // If this line already contains the closing tag, do nothing.\r\n            if (line.indexOf(pair.close, column - 1) >= 0) {\r\n                continue;\r\n            }\r\n            return { appendText: pair.close };\r\n        }\r\n        return null;\r\n    };\r\n    return BracketElectricCharacterSupport;\r\n}());\r\nexport { BracketElectricCharacterSupport };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar IndentRulesSupport = /** @class */ (function () {\r\n    function IndentRulesSupport(indentationRules) {\r\n        this._indentationRules = indentationRules;\r\n    }\r\n    IndentRulesSupport.prototype.shouldIncrease = function (text) {\r\n        if (this._indentationRules) {\r\n            if (this._indentationRules.increaseIndentPattern && this._indentationRules.increaseIndentPattern.test(text)) {\r\n                return true;\r\n            }\r\n            // if (this._indentationRules.indentNextLinePattern && this._indentationRules.indentNextLinePattern.test(text)) {\r\n            // \treturn true;\r\n            // }\r\n        }\r\n        return false;\r\n    };\r\n    IndentRulesSupport.prototype.shouldDecrease = function (text) {\r\n        if (this._indentationRules && this._indentationRules.decreaseIndentPattern && this._indentationRules.decreaseIndentPattern.test(text)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    IndentRulesSupport.prototype.shouldIndentNextLine = function (text) {\r\n        if (this._indentationRules && this._indentationRules.indentNextLinePattern && this._indentationRules.indentNextLinePattern.test(text)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    IndentRulesSupport.prototype.shouldIgnore = function (text) {\r\n        // the text matches `unIndentedLinePattern`\r\n        if (this._indentationRules && this._indentationRules.unIndentedLinePattern && this._indentationRules.unIndentedLinePattern.test(text)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    IndentRulesSupport.prototype.getIndentMetadata = function (text) {\r\n        var ret = 0;\r\n        if (this.shouldIncrease(text)) {\r\n            ret += 1 /* INCREASE_MASK */;\r\n        }\r\n        if (this.shouldDecrease(text)) {\r\n            ret += 2 /* DECREASE_MASK */;\r\n        }\r\n        if (this.shouldIndentNextLine(text)) {\r\n            ret += 4 /* INDENT_NEXTLINE_MASK */;\r\n        }\r\n        if (this.shouldIgnore(text)) {\r\n            ret += 8 /* UNINDENT_MASK */;\r\n        }\r\n        return ret;\r\n    };\r\n    return IndentRulesSupport;\r\n}());\r\nexport { IndentRulesSupport };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { IndentAction } from '../languageConfiguration.js';\r\nvar OnEnterSupport = /** @class */ (function () {\r\n    function OnEnterSupport(opts) {\r\n        var _this = this;\r\n        opts = opts || {};\r\n        opts.brackets = opts.brackets || [\r\n            ['(', ')'],\r\n            ['{', '}'],\r\n            ['[', ']']\r\n        ];\r\n        this._brackets = [];\r\n        opts.brackets.forEach(function (bracket) {\r\n            var openRegExp = OnEnterSupport._createOpenBracketRegExp(bracket[0]);\r\n            var closeRegExp = OnEnterSupport._createCloseBracketRegExp(bracket[1]);\r\n            if (openRegExp && closeRegExp) {\r\n                _this._brackets.push({\r\n                    open: bracket[0],\r\n                    openRegExp: openRegExp,\r\n                    close: bracket[1],\r\n                    closeRegExp: closeRegExp,\r\n                });\r\n            }\r\n        });\r\n        this._regExpRules = opts.regExpRules || [];\r\n    }\r\n    OnEnterSupport.prototype.onEnter = function (oneLineAboveText, beforeEnterText, afterEnterText) {\r\n        // (1): `regExpRules`\r\n        for (var i = 0, len = this._regExpRules.length; i < len; i++) {\r\n            var rule = this._regExpRules[i];\r\n            var regResult = [{\r\n                    reg: rule.beforeText,\r\n                    text: beforeEnterText\r\n                }, {\r\n                    reg: rule.afterText,\r\n                    text: afterEnterText\r\n                }, {\r\n                    reg: rule.oneLineAboveText,\r\n                    text: oneLineAboveText\r\n                }].every(function (obj) {\r\n                return obj.reg ? obj.reg.test(obj.text) : true;\r\n            });\r\n            if (regResult) {\r\n                return rule.action;\r\n            }\r\n        }\r\n        // (2): Special indent-outdent\r\n        if (beforeEnterText.length > 0 && afterEnterText.length > 0) {\r\n            for (var i = 0, len = this._brackets.length; i < len; i++) {\r\n                var bracket = this._brackets[i];\r\n                if (bracket.openRegExp.test(beforeEnterText) && bracket.closeRegExp.test(afterEnterText)) {\r\n                    return { indentAction: IndentAction.IndentOutdent };\r\n                }\r\n            }\r\n        }\r\n        // (4): Open bracket based logic\r\n        if (beforeEnterText.length > 0) {\r\n            for (var i = 0, len = this._brackets.length; i < len; i++) {\r\n                var bracket = this._brackets[i];\r\n                if (bracket.openRegExp.test(beforeEnterText)) {\r\n                    return { indentAction: IndentAction.Indent };\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    OnEnterSupport._createOpenBracketRegExp = function (bracket) {\r\n        var str = strings.escapeRegExpCharacters(bracket);\r\n        if (!/\\B/.test(str.charAt(0))) {\r\n            str = '\\\\b' + str;\r\n        }\r\n        str += '\\\\s*$';\r\n        return OnEnterSupport._safeRegExp(str);\r\n    };\r\n    OnEnterSupport._createCloseBracketRegExp = function (bracket) {\r\n        var str = strings.escapeRegExpCharacters(bracket);\r\n        if (!/\\B/.test(str.charAt(str.length - 1))) {\r\n            str = str + '\\\\b';\r\n        }\r\n        str = '^\\\\s*' + str;\r\n        return OnEnterSupport._safeRegExp(str);\r\n    };\r\n    OnEnterSupport._safeRegExp = function (def) {\r\n        try {\r\n            return new RegExp(def);\r\n        }\r\n        catch (err) {\r\n            onUnexpectedError(err);\r\n            return null;\r\n        }\r\n    };\r\n    return OnEnterSupport;\r\n}());\r\nexport { OnEnterSupport };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { toDisposable } from '../../../base/common/lifecycle.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Range } from '../core/range.js';\r\nimport { DEFAULT_WORD_REGEXP, ensureValidWordDefinition } from '../model/wordHelper.js';\r\nimport { IndentAction } from './languageConfiguration.js';\r\nimport { createScopedLineTokens } from './supports.js';\r\nimport { CharacterPairSupport } from './supports/characterPair.js';\r\nimport { BracketElectricCharacterSupport } from './supports/electricCharacter.js';\r\nimport { IndentRulesSupport } from './supports/indentRules.js';\r\nimport { OnEnterSupport } from './supports/onEnter.js';\r\nimport { RichEditBrackets } from './supports/richEditBrackets.js';\r\nvar RichEditSupport = /** @class */ (function () {\r\n    function RichEditSupport(languageIdentifier, previous, rawConf) {\r\n        this._languageIdentifier = languageIdentifier;\r\n        this._brackets = null;\r\n        this._electricCharacter = null;\r\n        var prev = null;\r\n        if (previous) {\r\n            prev = previous._conf;\r\n        }\r\n        this._conf = RichEditSupport._mergeConf(prev, rawConf);\r\n        this.onEnter = RichEditSupport._handleOnEnter(this._conf);\r\n        this.comments = RichEditSupport._handleComments(this._conf);\r\n        this.characterPair = new CharacterPairSupport(this._conf);\r\n        this.wordDefinition = this._conf.wordPattern || DEFAULT_WORD_REGEXP;\r\n        this.indentationRules = this._conf.indentationRules;\r\n        if (this._conf.indentationRules) {\r\n            this.indentRulesSupport = new IndentRulesSupport(this._conf.indentationRules);\r\n        }\r\n        this.foldingRules = this._conf.folding || {};\r\n    }\r\n    Object.defineProperty(RichEditSupport.prototype, \"brackets\", {\r\n        get: function () {\r\n            if (!this._brackets && this._conf.brackets) {\r\n                this._brackets = new RichEditBrackets(this._languageIdentifier, this._conf.brackets);\r\n            }\r\n            return this._brackets;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RichEditSupport.prototype, \"electricCharacter\", {\r\n        get: function () {\r\n            if (!this._electricCharacter) {\r\n                var autoClosingPairs = [];\r\n                if (this._conf.autoClosingPairs) {\r\n                    autoClosingPairs = this._conf.autoClosingPairs;\r\n                }\r\n                else if (this._conf.brackets) {\r\n                    autoClosingPairs = this._conf.brackets.map(function (b) {\r\n                        return { open: b[0], close: b[1] };\r\n                    });\r\n                }\r\n                this._electricCharacter = new BracketElectricCharacterSupport(this.brackets, autoClosingPairs, this._conf.__electricCharacterSupport);\r\n            }\r\n            return this._electricCharacter;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    RichEditSupport._mergeConf = function (prev, current) {\r\n        return {\r\n            comments: (prev ? current.comments || prev.comments : current.comments),\r\n            brackets: (prev ? current.brackets || prev.brackets : current.brackets),\r\n            wordPattern: (prev ? current.wordPattern || prev.wordPattern : current.wordPattern),\r\n            indentationRules: (prev ? current.indentationRules || prev.indentationRules : current.indentationRules),\r\n            onEnterRules: (prev ? current.onEnterRules || prev.onEnterRules : current.onEnterRules),\r\n            autoClosingPairs: (prev ? current.autoClosingPairs || prev.autoClosingPairs : current.autoClosingPairs),\r\n            surroundingPairs: (prev ? current.surroundingPairs || prev.surroundingPairs : current.surroundingPairs),\r\n            autoCloseBefore: (prev ? current.autoCloseBefore || prev.autoCloseBefore : current.autoCloseBefore),\r\n            folding: (prev ? current.folding || prev.folding : current.folding),\r\n            __electricCharacterSupport: (prev ? current.__electricCharacterSupport || prev.__electricCharacterSupport : current.__electricCharacterSupport),\r\n        };\r\n    };\r\n    RichEditSupport._handleOnEnter = function (conf) {\r\n        // on enter\r\n        var onEnter = {};\r\n        var empty = true;\r\n        if (conf.brackets) {\r\n            empty = false;\r\n            onEnter.brackets = conf.brackets;\r\n        }\r\n        if (conf.indentationRules) {\r\n            empty = false;\r\n        }\r\n        if (conf.onEnterRules) {\r\n            empty = false;\r\n            onEnter.regExpRules = conf.onEnterRules;\r\n        }\r\n        if (!empty) {\r\n            return new OnEnterSupport(onEnter);\r\n        }\r\n        return null;\r\n    };\r\n    RichEditSupport._handleComments = function (conf) {\r\n        var commentRule = conf.comments;\r\n        if (!commentRule) {\r\n            return null;\r\n        }\r\n        // comment configuration\r\n        var comments = {};\r\n        if (commentRule.lineComment) {\r\n            comments.lineCommentToken = commentRule.lineComment;\r\n        }\r\n        if (commentRule.blockComment) {\r\n            var _a = commentRule.blockComment, blockStart = _a[0], blockEnd = _a[1];\r\n            comments.blockCommentStartToken = blockStart;\r\n            comments.blockCommentEndToken = blockEnd;\r\n        }\r\n        return comments;\r\n    };\r\n    return RichEditSupport;\r\n}());\r\nexport { RichEditSupport };\r\nvar LanguageConfigurationChangeEvent = /** @class */ (function () {\r\n    function LanguageConfigurationChangeEvent() {\r\n    }\r\n    return LanguageConfigurationChangeEvent;\r\n}());\r\nexport { LanguageConfigurationChangeEvent };\r\nvar LanguageConfigurationRegistryImpl = /** @class */ (function () {\r\n    function LanguageConfigurationRegistryImpl() {\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._entries = [];\r\n    }\r\n    LanguageConfigurationRegistryImpl.prototype.register = function (languageIdentifier, configuration) {\r\n        var _this = this;\r\n        var previous = this._getRichEditSupport(languageIdentifier.id);\r\n        var current = new RichEditSupport(languageIdentifier, previous, configuration);\r\n        this._entries[languageIdentifier.id] = current;\r\n        this._onDidChange.fire({ languageIdentifier: languageIdentifier });\r\n        return toDisposable(function () {\r\n            if (_this._entries[languageIdentifier.id] === current) {\r\n                _this._entries[languageIdentifier.id] = previous;\r\n                _this._onDidChange.fire({ languageIdentifier: languageIdentifier });\r\n            }\r\n        });\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype._getRichEditSupport = function (languageId) {\r\n        return this._entries[languageId] || null;\r\n    };\r\n    // begin electricCharacter\r\n    LanguageConfigurationRegistryImpl.prototype._getElectricCharacterSupport = function (languageId) {\r\n        var value = this._getRichEditSupport(languageId);\r\n        if (!value) {\r\n            return null;\r\n        }\r\n        return value.electricCharacter || null;\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getElectricCharacters = function (languageId) {\r\n        var electricCharacterSupport = this._getElectricCharacterSupport(languageId);\r\n        if (!electricCharacterSupport) {\r\n            return [];\r\n        }\r\n        return electricCharacterSupport.getElectricCharacters();\r\n    };\r\n    /**\r\n     * Should return opening bracket type to match indentation with\r\n     */\r\n    LanguageConfigurationRegistryImpl.prototype.onElectricCharacter = function (character, context, column) {\r\n        var scopedLineTokens = createScopedLineTokens(context, column - 1);\r\n        var electricCharacterSupport = this._getElectricCharacterSupport(scopedLineTokens.languageId);\r\n        if (!electricCharacterSupport) {\r\n            return null;\r\n        }\r\n        return electricCharacterSupport.onElectricCharacter(character, scopedLineTokens, column - scopedLineTokens.firstCharOffset);\r\n    };\r\n    // end electricCharacter\r\n    LanguageConfigurationRegistryImpl.prototype.getComments = function (languageId) {\r\n        var value = this._getRichEditSupport(languageId);\r\n        if (!value) {\r\n            return null;\r\n        }\r\n        return value.comments || null;\r\n    };\r\n    // begin characterPair\r\n    LanguageConfigurationRegistryImpl.prototype._getCharacterPairSupport = function (languageId) {\r\n        var value = this._getRichEditSupport(languageId);\r\n        if (!value) {\r\n            return null;\r\n        }\r\n        return value.characterPair || null;\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getAutoClosingPairs = function (languageId) {\r\n        var characterPairSupport = this._getCharacterPairSupport(languageId);\r\n        if (!characterPairSupport) {\r\n            return [];\r\n        }\r\n        return characterPairSupport.getAutoClosingPairs();\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getAutoCloseBeforeSet = function (languageId) {\r\n        var characterPairSupport = this._getCharacterPairSupport(languageId);\r\n        if (!characterPairSupport) {\r\n            return CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED;\r\n        }\r\n        return characterPairSupport.getAutoCloseBeforeSet();\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getSurroundingPairs = function (languageId) {\r\n        var characterPairSupport = this._getCharacterPairSupport(languageId);\r\n        if (!characterPairSupport) {\r\n            return [];\r\n        }\r\n        return characterPairSupport.getSurroundingPairs();\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.shouldAutoClosePair = function (character, context, column) {\r\n        var scopedLineTokens = createScopedLineTokens(context, column - 1);\r\n        var characterPairSupport = this._getCharacterPairSupport(scopedLineTokens.languageId);\r\n        if (!characterPairSupport) {\r\n            return false;\r\n        }\r\n        return characterPairSupport.shouldAutoClosePair(character, scopedLineTokens, column - scopedLineTokens.firstCharOffset);\r\n    };\r\n    // end characterPair\r\n    LanguageConfigurationRegistryImpl.prototype.getWordDefinition = function (languageId) {\r\n        var value = this._getRichEditSupport(languageId);\r\n        if (!value) {\r\n            return ensureValidWordDefinition(null);\r\n        }\r\n        return ensureValidWordDefinition(value.wordDefinition || null);\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getFoldingRules = function (languageId) {\r\n        var value = this._getRichEditSupport(languageId);\r\n        if (!value) {\r\n            return {};\r\n        }\r\n        return value.foldingRules;\r\n    };\r\n    // begin Indent Rules\r\n    LanguageConfigurationRegistryImpl.prototype.getIndentRulesSupport = function (languageId) {\r\n        var value = this._getRichEditSupport(languageId);\r\n        if (!value) {\r\n            return null;\r\n        }\r\n        return value.indentRulesSupport || null;\r\n    };\r\n    /**\r\n     * Get nearest preceiding line which doesn't match unIndentPattern or contains all whitespace.\r\n     * Result:\r\n     * -1: run into the boundary of embedded languages\r\n     * 0: every line above are invalid\r\n     * else: nearest preceding line of the same language\r\n     */\r\n    LanguageConfigurationRegistryImpl.prototype.getPrecedingValidLine = function (model, lineNumber, indentRulesSupport) {\r\n        var languageID = model.getLanguageIdAtPosition(lineNumber, 0);\r\n        if (lineNumber > 1) {\r\n            var lastLineNumber = lineNumber - 1;\r\n            var resultLineNumber = -1;\r\n            for (lastLineNumber = lineNumber - 1; lastLineNumber >= 1; lastLineNumber--) {\r\n                if (model.getLanguageIdAtPosition(lastLineNumber, 0) !== languageID) {\r\n                    return resultLineNumber;\r\n                }\r\n                var text = model.getLineContent(lastLineNumber);\r\n                if (indentRulesSupport.shouldIgnore(text) || /^\\s+$/.test(text) || text === '') {\r\n                    resultLineNumber = lastLineNumber;\r\n                    continue;\r\n                }\r\n                return lastLineNumber;\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n    /**\r\n     * Get inherited indentation from above lines.\r\n     * 1. Find the nearest preceding line which doesn't match unIndentedLinePattern.\r\n     * 2. If this line matches indentNextLinePattern or increaseIndentPattern, it means that the indent level of `lineNumber` should be 1 greater than this line.\r\n     * 3. If this line doesn't match any indent rules\r\n     *   a. check whether the line above it matches indentNextLinePattern\r\n     *   b. If not, the indent level of this line is the result\r\n     *   c. If so, it means the indent of this line is *temporary*, go upward utill we find a line whose indent is not temporary (the same workflow a -> b -> c).\r\n     * 4. Otherwise, we fail to get an inherited indent from aboves. Return null and we should not touch the indent of `lineNumber`\r\n     *\r\n     * This function only return the inherited indent based on above lines, it doesn't check whether current line should decrease or not.\r\n     */\r\n    LanguageConfigurationRegistryImpl.prototype.getInheritIndentForLine = function (model, lineNumber, honorIntentialIndent) {\r\n        if (honorIntentialIndent === void 0) { honorIntentialIndent = true; }\r\n        var indentRulesSupport = this.getIndentRulesSupport(model.getLanguageIdentifier().id);\r\n        if (!indentRulesSupport) {\r\n            return null;\r\n        }\r\n        if (lineNumber <= 1) {\r\n            return {\r\n                indentation: '',\r\n                action: null\r\n            };\r\n        }\r\n        var precedingUnIgnoredLine = this.getPrecedingValidLine(model, lineNumber, indentRulesSupport);\r\n        if (precedingUnIgnoredLine < 0) {\r\n            return null;\r\n        }\r\n        else if (precedingUnIgnoredLine < 1) {\r\n            return {\r\n                indentation: '',\r\n                action: null\r\n            };\r\n        }\r\n        var precedingUnIgnoredLineContent = model.getLineContent(precedingUnIgnoredLine);\r\n        if (indentRulesSupport.shouldIncrease(precedingUnIgnoredLineContent) || indentRulesSupport.shouldIndentNextLine(precedingUnIgnoredLineContent)) {\r\n            return {\r\n                indentation: strings.getLeadingWhitespace(precedingUnIgnoredLineContent),\r\n                action: IndentAction.Indent,\r\n                line: precedingUnIgnoredLine\r\n            };\r\n        }\r\n        else if (indentRulesSupport.shouldDecrease(precedingUnIgnoredLineContent)) {\r\n            return {\r\n                indentation: strings.getLeadingWhitespace(precedingUnIgnoredLineContent),\r\n                action: null,\r\n                line: precedingUnIgnoredLine\r\n            };\r\n        }\r\n        else {\r\n            // precedingUnIgnoredLine can not be ignored.\r\n            // it doesn't increase indent of following lines\r\n            // it doesn't increase just next line\r\n            // so current line is not affect by precedingUnIgnoredLine\r\n            // and then we should get a correct inheritted indentation from above lines\r\n            if (precedingUnIgnoredLine === 1) {\r\n                return {\r\n                    indentation: strings.getLeadingWhitespace(model.getLineContent(precedingUnIgnoredLine)),\r\n                    action: null,\r\n                    line: precedingUnIgnoredLine\r\n                };\r\n            }\r\n            var previousLine = precedingUnIgnoredLine - 1;\r\n            var previousLineIndentMetadata = indentRulesSupport.getIndentMetadata(model.getLineContent(previousLine));\r\n            if (!(previousLineIndentMetadata & (1 /* INCREASE_MASK */ | 2 /* DECREASE_MASK */)) &&\r\n                (previousLineIndentMetadata & 4 /* INDENT_NEXTLINE_MASK */)) {\r\n                var stopLine = 0;\r\n                for (var i = previousLine - 1; i > 0; i--) {\r\n                    if (indentRulesSupport.shouldIndentNextLine(model.getLineContent(i))) {\r\n                        continue;\r\n                    }\r\n                    stopLine = i;\r\n                    break;\r\n                }\r\n                return {\r\n                    indentation: strings.getLeadingWhitespace(model.getLineContent(stopLine + 1)),\r\n                    action: null,\r\n                    line: stopLine + 1\r\n                };\r\n            }\r\n            if (honorIntentialIndent) {\r\n                return {\r\n                    indentation: strings.getLeadingWhitespace(model.getLineContent(precedingUnIgnoredLine)),\r\n                    action: null,\r\n                    line: precedingUnIgnoredLine\r\n                };\r\n            }\r\n            else {\r\n                // search from precedingUnIgnoredLine until we find one whose indent is not temporary\r\n                for (var i = precedingUnIgnoredLine; i > 0; i--) {\r\n                    var lineContent = model.getLineContent(i);\r\n                    if (indentRulesSupport.shouldIncrease(lineContent)) {\r\n                        return {\r\n                            indentation: strings.getLeadingWhitespace(lineContent),\r\n                            action: IndentAction.Indent,\r\n                            line: i\r\n                        };\r\n                    }\r\n                    else if (indentRulesSupport.shouldIndentNextLine(lineContent)) {\r\n                        var stopLine = 0;\r\n                        for (var j = i - 1; j > 0; j--) {\r\n                            if (indentRulesSupport.shouldIndentNextLine(model.getLineContent(i))) {\r\n                                continue;\r\n                            }\r\n                            stopLine = j;\r\n                            break;\r\n                        }\r\n                        return {\r\n                            indentation: strings.getLeadingWhitespace(model.getLineContent(stopLine + 1)),\r\n                            action: null,\r\n                            line: stopLine + 1\r\n                        };\r\n                    }\r\n                    else if (indentRulesSupport.shouldDecrease(lineContent)) {\r\n                        return {\r\n                            indentation: strings.getLeadingWhitespace(lineContent),\r\n                            action: null,\r\n                            line: i\r\n                        };\r\n                    }\r\n                }\r\n                return {\r\n                    indentation: strings.getLeadingWhitespace(model.getLineContent(1)),\r\n                    action: null,\r\n                    line: 1\r\n                };\r\n            }\r\n        }\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getGoodIndentForLine = function (virtualModel, languageId, lineNumber, indentConverter) {\r\n        var indentRulesSupport = this.getIndentRulesSupport(languageId);\r\n        if (!indentRulesSupport) {\r\n            return null;\r\n        }\r\n        var indent = this.getInheritIndentForLine(virtualModel, lineNumber);\r\n        var lineContent = virtualModel.getLineContent(lineNumber);\r\n        if (indent) {\r\n            var inheritLine = indent.line;\r\n            if (inheritLine !== undefined) {\r\n                var onEnterSupport = this._getOnEnterSupport(languageId);\r\n                var enterResult = null;\r\n                try {\r\n                    if (onEnterSupport) {\r\n                        enterResult = onEnterSupport.onEnter('', virtualModel.getLineContent(inheritLine), '');\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    onUnexpectedError(e);\r\n                }\r\n                if (enterResult) {\r\n                    var indentation = strings.getLeadingWhitespace(virtualModel.getLineContent(inheritLine));\r\n                    if (enterResult.removeText) {\r\n                        indentation = indentation.substring(0, indentation.length - enterResult.removeText);\r\n                    }\r\n                    if ((enterResult.indentAction === IndentAction.Indent) ||\r\n                        (enterResult.indentAction === IndentAction.IndentOutdent)) {\r\n                        indentation = indentConverter.shiftIndent(indentation);\r\n                    }\r\n                    else if (enterResult.indentAction === IndentAction.Outdent) {\r\n                        indentation = indentConverter.unshiftIndent(indentation);\r\n                    }\r\n                    if (indentRulesSupport.shouldDecrease(lineContent)) {\r\n                        indentation = indentConverter.unshiftIndent(indentation);\r\n                    }\r\n                    if (enterResult.appendText) {\r\n                        indentation += enterResult.appendText;\r\n                    }\r\n                    return strings.getLeadingWhitespace(indentation);\r\n                }\r\n            }\r\n            if (indentRulesSupport.shouldDecrease(lineContent)) {\r\n                if (indent.action === IndentAction.Indent) {\r\n                    return indent.indentation;\r\n                }\r\n                else {\r\n                    return indentConverter.unshiftIndent(indent.indentation);\r\n                }\r\n            }\r\n            else {\r\n                if (indent.action === IndentAction.Indent) {\r\n                    return indentConverter.shiftIndent(indent.indentation);\r\n                }\r\n                else {\r\n                    return indent.indentation;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getIndentForEnter = function (model, range, indentConverter, autoIndent) {\r\n        model.forceTokenization(range.startLineNumber);\r\n        var lineTokens = model.getLineTokens(range.startLineNumber);\r\n        var beforeEnterText;\r\n        var afterEnterText;\r\n        var scopedLineTokens = createScopedLineTokens(lineTokens, range.startColumn - 1);\r\n        var scopedLineText = scopedLineTokens.getLineContent();\r\n        var embeddedLanguage = false;\r\n        if (scopedLineTokens.firstCharOffset > 0 && lineTokens.getLanguageId(0) !== scopedLineTokens.languageId) {\r\n            // we are in the embeded language content\r\n            embeddedLanguage = true; // if embeddedLanguage is true, then we don't touch the indentation of current line\r\n            beforeEnterText = scopedLineText.substr(0, range.startColumn - 1 - scopedLineTokens.firstCharOffset);\r\n        }\r\n        else {\r\n            beforeEnterText = lineTokens.getLineContent().substring(0, range.startColumn - 1);\r\n        }\r\n        if (range.isEmpty()) {\r\n            afterEnterText = scopedLineText.substr(range.startColumn - 1 - scopedLineTokens.firstCharOffset);\r\n        }\r\n        else {\r\n            var endScopedLineTokens = this.getScopedLineTokens(model, range.endLineNumber, range.endColumn);\r\n            afterEnterText = endScopedLineTokens.getLineContent().substr(range.endColumn - 1 - scopedLineTokens.firstCharOffset);\r\n        }\r\n        var indentRulesSupport = this.getIndentRulesSupport(scopedLineTokens.languageId);\r\n        if (!indentRulesSupport) {\r\n            return null;\r\n        }\r\n        var beforeEnterResult = beforeEnterText;\r\n        var beforeEnterIndent = strings.getLeadingWhitespace(beforeEnterText);\r\n        if (!autoIndent && !embeddedLanguage) {\r\n            var beforeEnterIndentAction = this.getInheritIndentForLine(model, range.startLineNumber);\r\n            if (indentRulesSupport.shouldDecrease(beforeEnterText)) {\r\n                if (beforeEnterIndentAction) {\r\n                    beforeEnterIndent = beforeEnterIndentAction.indentation;\r\n                    if (beforeEnterIndentAction.action !== IndentAction.Indent) {\r\n                        beforeEnterIndent = indentConverter.unshiftIndent(beforeEnterIndent);\r\n                    }\r\n                }\r\n            }\r\n            beforeEnterResult = beforeEnterIndent + strings.ltrim(strings.ltrim(beforeEnterText, ' '), '\\t');\r\n        }\r\n        var virtualModel = {\r\n            getLineTokens: function (lineNumber) {\r\n                return model.getLineTokens(lineNumber);\r\n            },\r\n            getLanguageIdentifier: function () {\r\n                return model.getLanguageIdentifier();\r\n            },\r\n            getLanguageIdAtPosition: function (lineNumber, column) {\r\n                return model.getLanguageIdAtPosition(lineNumber, column);\r\n            },\r\n            getLineContent: function (lineNumber) {\r\n                if (lineNumber === range.startLineNumber) {\r\n                    return beforeEnterResult;\r\n                }\r\n                else {\r\n                    return model.getLineContent(lineNumber);\r\n                }\r\n            }\r\n        };\r\n        var currentLineIndent = strings.getLeadingWhitespace(lineTokens.getLineContent());\r\n        var afterEnterAction = this.getInheritIndentForLine(virtualModel, range.startLineNumber + 1);\r\n        if (!afterEnterAction) {\r\n            var beforeEnter = embeddedLanguage ? currentLineIndent : beforeEnterIndent;\r\n            return {\r\n                beforeEnter: beforeEnter,\r\n                afterEnter: beforeEnter\r\n            };\r\n        }\r\n        var afterEnterIndent = embeddedLanguage ? currentLineIndent : afterEnterAction.indentation;\r\n        if (afterEnterAction.action === IndentAction.Indent) {\r\n            afterEnterIndent = indentConverter.shiftIndent(afterEnterIndent);\r\n        }\r\n        if (indentRulesSupport.shouldDecrease(afterEnterText)) {\r\n            afterEnterIndent = indentConverter.unshiftIndent(afterEnterIndent);\r\n        }\r\n        return {\r\n            beforeEnter: embeddedLanguage ? currentLineIndent : beforeEnterIndent,\r\n            afterEnter: afterEnterIndent\r\n        };\r\n    };\r\n    /**\r\n     * We should always allow intentional indentation. It means, if users change the indentation of `lineNumber` and the content of\r\n     * this line doesn't match decreaseIndentPattern, we should not adjust the indentation.\r\n     */\r\n    LanguageConfigurationRegistryImpl.prototype.getIndentActionForType = function (model, range, ch, indentConverter) {\r\n        var scopedLineTokens = this.getScopedLineTokens(model, range.startLineNumber, range.startColumn);\r\n        var indentRulesSupport = this.getIndentRulesSupport(scopedLineTokens.languageId);\r\n        if (!indentRulesSupport) {\r\n            return null;\r\n        }\r\n        var scopedLineText = scopedLineTokens.getLineContent();\r\n        var beforeTypeText = scopedLineText.substr(0, range.startColumn - 1 - scopedLineTokens.firstCharOffset);\r\n        var afterTypeText;\r\n        // selection support\r\n        if (range.isEmpty()) {\r\n            afterTypeText = scopedLineText.substr(range.startColumn - 1 - scopedLineTokens.firstCharOffset);\r\n        }\r\n        else {\r\n            var endScopedLineTokens = this.getScopedLineTokens(model, range.endLineNumber, range.endColumn);\r\n            afterTypeText = endScopedLineTokens.getLineContent().substr(range.endColumn - 1 - scopedLineTokens.firstCharOffset);\r\n        }\r\n        // If previous content already matches decreaseIndentPattern, it means indentation of this line should already be adjusted\r\n        // Users might change the indentation by purpose and we should honor that instead of readjusting.\r\n        if (!indentRulesSupport.shouldDecrease(beforeTypeText + afterTypeText) && indentRulesSupport.shouldDecrease(beforeTypeText + ch + afterTypeText)) {\r\n            // after typing `ch`, the content matches decreaseIndentPattern, we should adjust the indent to a good manner.\r\n            // 1. Get inherited indent action\r\n            var r = this.getInheritIndentForLine(model, range.startLineNumber, false);\r\n            if (!r) {\r\n                return null;\r\n            }\r\n            var indentation = r.indentation;\r\n            if (r.action !== IndentAction.Indent) {\r\n                indentation = indentConverter.unshiftIndent(indentation);\r\n            }\r\n            return indentation;\r\n        }\r\n        return null;\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getIndentMetadata = function (model, lineNumber) {\r\n        var indentRulesSupport = this.getIndentRulesSupport(model.getLanguageIdentifier().id);\r\n        if (!indentRulesSupport) {\r\n            return null;\r\n        }\r\n        if (lineNumber < 1 || lineNumber > model.getLineCount()) {\r\n            return null;\r\n        }\r\n        return indentRulesSupport.getIndentMetadata(model.getLineContent(lineNumber));\r\n    };\r\n    // end Indent Rules\r\n    // begin onEnter\r\n    LanguageConfigurationRegistryImpl.prototype._getOnEnterSupport = function (languageId) {\r\n        var value = this._getRichEditSupport(languageId);\r\n        if (!value) {\r\n            return null;\r\n        }\r\n        return value.onEnter || null;\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getRawEnterActionAtPosition = function (model, lineNumber, column) {\r\n        var r = this.getEnterAction(model, new Range(lineNumber, column, lineNumber, column));\r\n        return r ? r.enterAction : null;\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getEnterAction = function (model, range) {\r\n        var indentation = this.getIndentationAtPosition(model, range.startLineNumber, range.startColumn);\r\n        var scopedLineTokens = this.getScopedLineTokens(model, range.startLineNumber, range.startColumn);\r\n        var onEnterSupport = this._getOnEnterSupport(scopedLineTokens.languageId);\r\n        if (!onEnterSupport) {\r\n            return null;\r\n        }\r\n        var scopedLineText = scopedLineTokens.getLineContent();\r\n        var beforeEnterText = scopedLineText.substr(0, range.startColumn - 1 - scopedLineTokens.firstCharOffset);\r\n        var afterEnterText;\r\n        // selection support\r\n        if (range.isEmpty()) {\r\n            afterEnterText = scopedLineText.substr(range.startColumn - 1 - scopedLineTokens.firstCharOffset);\r\n        }\r\n        else {\r\n            var endScopedLineTokens = this.getScopedLineTokens(model, range.endLineNumber, range.endColumn);\r\n            afterEnterText = endScopedLineTokens.getLineContent().substr(range.endColumn - 1 - scopedLineTokens.firstCharOffset);\r\n        }\r\n        var lineNumber = range.startLineNumber;\r\n        var oneLineAboveText = '';\r\n        if (lineNumber > 1 && scopedLineTokens.firstCharOffset === 0) {\r\n            // This is not the first line and the entire line belongs to this mode\r\n            var oneLineAboveScopedLineTokens = this.getScopedLineTokens(model, lineNumber - 1);\r\n            if (oneLineAboveScopedLineTokens.languageId === scopedLineTokens.languageId) {\r\n                // The line above ends with text belonging to the same mode\r\n                oneLineAboveText = oneLineAboveScopedLineTokens.getLineContent();\r\n            }\r\n        }\r\n        var enterResult = null;\r\n        try {\r\n            enterResult = onEnterSupport.onEnter(oneLineAboveText, beforeEnterText, afterEnterText);\r\n        }\r\n        catch (e) {\r\n            onUnexpectedError(e);\r\n        }\r\n        if (!enterResult) {\r\n            return null;\r\n        }\r\n        else {\r\n            // Here we add `\\t` to appendText first because enterAction is leveraging appendText and removeText to change indentation.\r\n            if (!enterResult.appendText) {\r\n                if ((enterResult.indentAction === IndentAction.Indent) ||\r\n                    (enterResult.indentAction === IndentAction.IndentOutdent)) {\r\n                    enterResult.appendText = '\\t';\r\n                }\r\n                else {\r\n                    enterResult.appendText = '';\r\n                }\r\n            }\r\n        }\r\n        if (enterResult.removeText) {\r\n            indentation = indentation.substring(0, indentation.length - enterResult.removeText);\r\n        }\r\n        return {\r\n            enterAction: enterResult,\r\n            indentation: indentation,\r\n        };\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getIndentationAtPosition = function (model, lineNumber, column) {\r\n        var lineText = model.getLineContent(lineNumber);\r\n        var indentation = strings.getLeadingWhitespace(lineText);\r\n        if (indentation.length > column - 1) {\r\n            indentation = indentation.substring(0, column - 1);\r\n        }\r\n        return indentation;\r\n    };\r\n    LanguageConfigurationRegistryImpl.prototype.getScopedLineTokens = function (model, lineNumber, columnNumber) {\r\n        model.forceTokenization(lineNumber);\r\n        var lineTokens = model.getLineTokens(lineNumber);\r\n        var column = (typeof columnNumber === 'undefined' ? model.getLineMaxColumn(lineNumber) - 1 : columnNumber - 1);\r\n        var scopedLineTokens = createScopedLineTokens(lineTokens, column);\r\n        return scopedLineTokens;\r\n    };\r\n    // end onEnter\r\n    LanguageConfigurationRegistryImpl.prototype.getBracketsSupport = function (languageId) {\r\n        var value = this._getRichEditSupport(languageId);\r\n        if (!value) {\r\n            return null;\r\n        }\r\n        return value.brackets || null;\r\n    };\r\n    return LanguageConfigurationRegistryImpl;\r\n}());\r\nexport { LanguageConfigurationRegistryImpl };\r\nexport var LanguageConfigurationRegistry = new LanguageConfigurationRegistryImpl();\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/**\r\n * Represents information about a specific difference between two sequences.\r\n */\r\nvar DiffChange = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new DiffChange with the given sequence information\r\n     * and content.\r\n     */\r\n    function DiffChange(originalStart, originalLength, modifiedStart, modifiedLength) {\r\n        //Debug.Assert(originalLength > 0 || modifiedLength > 0, \"originalLength and modifiedLength cannot both be <= 0\");\r\n        this.originalStart = originalStart;\r\n        this.originalLength = originalLength;\r\n        this.modifiedStart = modifiedStart;\r\n        this.modifiedLength = modifiedLength;\r\n    }\r\n    /**\r\n     * The end point (exclusive) of the change in the original sequence.\r\n     */\r\n    DiffChange.prototype.getOriginalEnd = function () {\r\n        return this.originalStart + this.originalLength;\r\n    };\r\n    /**\r\n     * The end point (exclusive) of the change in the modified sequence.\r\n     */\r\n    DiffChange.prototype.getModifiedEnd = function () {\r\n        return this.modifiedStart + this.modifiedLength;\r\n    };\r\n    return DiffChange;\r\n}());\r\nexport { DiffChange };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { DiffChange } from './diffChange.js';\r\nfunction createStringSequence(a) {\r\n    return {\r\n        getLength: function () { return a.length; },\r\n        getElementAtIndex: function (pos) { return a.charCodeAt(pos); }\r\n    };\r\n}\r\nexport function stringDiff(original, modified, pretty) {\r\n    return new LcsDiff(createStringSequence(original), createStringSequence(modified)).ComputeDiff(pretty);\r\n}\r\n//\r\n// The code below has been ported from a C# implementation in VS\r\n//\r\nvar Debug = /** @class */ (function () {\r\n    function Debug() {\r\n    }\r\n    Debug.Assert = function (condition, message) {\r\n        if (!condition) {\r\n            throw new Error(message);\r\n        }\r\n    };\r\n    return Debug;\r\n}());\r\nexport { Debug };\r\nvar MyArray = /** @class */ (function () {\r\n    function MyArray() {\r\n    }\r\n    /**\r\n     * Copies a range of elements from an Array starting at the specified source index and pastes\r\n     * them to another Array starting at the specified destination index. The length and the indexes\r\n     * are specified as 64-bit integers.\r\n     * sourceArray:\r\n     *\t\tThe Array that contains the data to copy.\r\n     * sourceIndex:\r\n     *\t\tA 64-bit integer that represents the index in the sourceArray at which copying begins.\r\n     * destinationArray:\r\n     *\t\tThe Array that receives the data.\r\n     * destinationIndex:\r\n     *\t\tA 64-bit integer that represents the index in the destinationArray at which storing begins.\r\n     * length:\r\n     *\t\tA 64-bit integer that represents the number of elements to copy.\r\n     */\r\n    MyArray.Copy = function (sourceArray, sourceIndex, destinationArray, destinationIndex, length) {\r\n        for (var i = 0; i < length; i++) {\r\n            destinationArray[destinationIndex + i] = sourceArray[sourceIndex + i];\r\n        }\r\n    };\r\n    return MyArray;\r\n}());\r\nexport { MyArray };\r\n//*****************************************************************************\r\n// LcsDiff.cs\r\n//\r\n// An implementation of the difference algorithm described in\r\n// \"An O(ND) Difference Algorithm and its variations\" by Eugene W. Myers\r\n//\r\n// Copyright (C) 2008 Microsoft Corporation @minifier_do_not_preserve\r\n//*****************************************************************************\r\n// Our total memory usage for storing history is (worst-case):\r\n// 2 * [(MaxDifferencesHistory + 1) * (MaxDifferencesHistory + 1) - 1] * sizeof(int)\r\n// 2 * [1448*1448 - 1] * 4 = 16773624 = 16MB\r\nvar MaxDifferencesHistory = 1447;\r\n//let MaxDifferencesHistory = 100;\r\n/**\r\n * A utility class which helps to create the set of DiffChanges from\r\n * a difference operation. This class accepts original DiffElements and\r\n * modified DiffElements that are involved in a particular change. The\r\n * MarktNextChange() method can be called to mark the separation between\r\n * distinct changes. At the end, the Changes property can be called to retrieve\r\n * the constructed changes.\r\n */\r\nvar DiffChangeHelper = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new DiffChangeHelper for the given DiffSequences.\r\n     */\r\n    function DiffChangeHelper() {\r\n        this.m_changes = [];\r\n        this.m_originalStart = Number.MAX_VALUE;\r\n        this.m_modifiedStart = Number.MAX_VALUE;\r\n        this.m_originalCount = 0;\r\n        this.m_modifiedCount = 0;\r\n    }\r\n    /**\r\n     * Marks the beginning of the next change in the set of differences.\r\n     */\r\n    DiffChangeHelper.prototype.MarkNextChange = function () {\r\n        // Only add to the list if there is something to add\r\n        if (this.m_originalCount > 0 || this.m_modifiedCount > 0) {\r\n            // Add the new change to our list\r\n            this.m_changes.push(new DiffChange(this.m_originalStart, this.m_originalCount, this.m_modifiedStart, this.m_modifiedCount));\r\n        }\r\n        // Reset for the next change\r\n        this.m_originalCount = 0;\r\n        this.m_modifiedCount = 0;\r\n        this.m_originalStart = Number.MAX_VALUE;\r\n        this.m_modifiedStart = Number.MAX_VALUE;\r\n    };\r\n    /**\r\n     * Adds the original element at the given position to the elements\r\n     * affected by the current change. The modified index gives context\r\n     * to the change position with respect to the original sequence.\r\n     * @param originalIndex The index of the original element to add.\r\n     * @param modifiedIndex The index of the modified element that provides corresponding position in the modified sequence.\r\n     */\r\n    DiffChangeHelper.prototype.AddOriginalElement = function (originalIndex, modifiedIndex) {\r\n        // The 'true' start index is the smallest of the ones we've seen\r\n        this.m_originalStart = Math.min(this.m_originalStart, originalIndex);\r\n        this.m_modifiedStart = Math.min(this.m_modifiedStart, modifiedIndex);\r\n        this.m_originalCount++;\r\n    };\r\n    /**\r\n     * Adds the modified element at the given position to the elements\r\n     * affected by the current change. The original index gives context\r\n     * to the change position with respect to the modified sequence.\r\n     * @param originalIndex The index of the original element that provides corresponding position in the original sequence.\r\n     * @param modifiedIndex The index of the modified element to add.\r\n     */\r\n    DiffChangeHelper.prototype.AddModifiedElement = function (originalIndex, modifiedIndex) {\r\n        // The 'true' start index is the smallest of the ones we've seen\r\n        this.m_originalStart = Math.min(this.m_originalStart, originalIndex);\r\n        this.m_modifiedStart = Math.min(this.m_modifiedStart, modifiedIndex);\r\n        this.m_modifiedCount++;\r\n    };\r\n    /**\r\n     * Retrieves all of the changes marked by the class.\r\n     */\r\n    DiffChangeHelper.prototype.getChanges = function () {\r\n        if (this.m_originalCount > 0 || this.m_modifiedCount > 0) {\r\n            // Finish up on whatever is left\r\n            this.MarkNextChange();\r\n        }\r\n        return this.m_changes;\r\n    };\r\n    /**\r\n     * Retrieves all of the changes marked by the class in the reverse order\r\n     */\r\n    DiffChangeHelper.prototype.getReverseChanges = function () {\r\n        if (this.m_originalCount > 0 || this.m_modifiedCount > 0) {\r\n            // Finish up on whatever is left\r\n            this.MarkNextChange();\r\n        }\r\n        this.m_changes.reverse();\r\n        return this.m_changes;\r\n    };\r\n    return DiffChangeHelper;\r\n}());\r\n/**\r\n * An implementation of the difference algorithm described in\r\n * \"An O(ND) Difference Algorithm and its variations\" by Eugene W. Myers\r\n */\r\nvar LcsDiff = /** @class */ (function () {\r\n    /**\r\n     * Constructs the DiffFinder\r\n     */\r\n    function LcsDiff(originalSequence, newSequence, continueProcessingPredicate) {\r\n        if (continueProcessingPredicate === void 0) { continueProcessingPredicate = null; }\r\n        this.OriginalSequence = originalSequence;\r\n        this.ModifiedSequence = newSequence;\r\n        this.ContinueProcessingPredicate = continueProcessingPredicate;\r\n        this.m_forwardHistory = [];\r\n        this.m_reverseHistory = [];\r\n    }\r\n    LcsDiff.prototype.ElementsAreEqual = function (originalIndex, newIndex) {\r\n        return (this.OriginalSequence.getElementAtIndex(originalIndex) === this.ModifiedSequence.getElementAtIndex(newIndex));\r\n    };\r\n    LcsDiff.prototype.OriginalElementsAreEqual = function (index1, index2) {\r\n        return (this.OriginalSequence.getElementAtIndex(index1) === this.OriginalSequence.getElementAtIndex(index2));\r\n    };\r\n    LcsDiff.prototype.ModifiedElementsAreEqual = function (index1, index2) {\r\n        return (this.ModifiedSequence.getElementAtIndex(index1) === this.ModifiedSequence.getElementAtIndex(index2));\r\n    };\r\n    LcsDiff.prototype.ComputeDiff = function (pretty) {\r\n        return this._ComputeDiff(0, this.OriginalSequence.getLength() - 1, 0, this.ModifiedSequence.getLength() - 1, pretty);\r\n    };\r\n    /**\r\n     * Computes the differences between the original and modified input\r\n     * sequences on the bounded range.\r\n     * @returns An array of the differences between the two input sequences.\r\n     */\r\n    LcsDiff.prototype._ComputeDiff = function (originalStart, originalEnd, modifiedStart, modifiedEnd, pretty) {\r\n        var quitEarlyArr = [false];\r\n        var changes = this.ComputeDiffRecursive(originalStart, originalEnd, modifiedStart, modifiedEnd, quitEarlyArr);\r\n        if (pretty) {\r\n            // We have to clean up the computed diff to be more intuitive\r\n            // but it turns out this cannot be done correctly until the entire set\r\n            // of diffs have been computed\r\n            return this.PrettifyChanges(changes);\r\n        }\r\n        return changes;\r\n    };\r\n    /**\r\n     * Private helper method which computes the differences on the bounded range\r\n     * recursively.\r\n     * @returns An array of the differences between the two input sequences.\r\n     */\r\n    LcsDiff.prototype.ComputeDiffRecursive = function (originalStart, originalEnd, modifiedStart, modifiedEnd, quitEarlyArr) {\r\n        quitEarlyArr[0] = false;\r\n        // Find the start of the differences\r\n        while (originalStart <= originalEnd && modifiedStart <= modifiedEnd && this.ElementsAreEqual(originalStart, modifiedStart)) {\r\n            originalStart++;\r\n            modifiedStart++;\r\n        }\r\n        // Find the end of the differences\r\n        while (originalEnd >= originalStart && modifiedEnd >= modifiedStart && this.ElementsAreEqual(originalEnd, modifiedEnd)) {\r\n            originalEnd--;\r\n            modifiedEnd--;\r\n        }\r\n        // In the special case where we either have all insertions or all deletions or the sequences are identical\r\n        if (originalStart > originalEnd || modifiedStart > modifiedEnd) {\r\n            var changes = void 0;\r\n            if (modifiedStart <= modifiedEnd) {\r\n                Debug.Assert(originalStart === originalEnd + 1, 'originalStart should only be one more than originalEnd');\r\n                // All insertions\r\n                changes = [\r\n                    new DiffChange(originalStart, 0, modifiedStart, modifiedEnd - modifiedStart + 1)\r\n                ];\r\n            }\r\n            else if (originalStart <= originalEnd) {\r\n                Debug.Assert(modifiedStart === modifiedEnd + 1, 'modifiedStart should only be one more than modifiedEnd');\r\n                // All deletions\r\n                changes = [\r\n                    new DiffChange(originalStart, originalEnd - originalStart + 1, modifiedStart, 0)\r\n                ];\r\n            }\r\n            else {\r\n                Debug.Assert(originalStart === originalEnd + 1, 'originalStart should only be one more than originalEnd');\r\n                Debug.Assert(modifiedStart === modifiedEnd + 1, 'modifiedStart should only be one more than modifiedEnd');\r\n                // Identical sequences - No differences\r\n                changes = [];\r\n            }\r\n            return changes;\r\n        }\r\n        // This problem can be solved using the Divide-And-Conquer technique.\r\n        var midOriginalArr = [0], midModifiedArr = [0];\r\n        var result = this.ComputeRecursionPoint(originalStart, originalEnd, modifiedStart, modifiedEnd, midOriginalArr, midModifiedArr, quitEarlyArr);\r\n        var midOriginal = midOriginalArr[0];\r\n        var midModified = midModifiedArr[0];\r\n        if (result !== null) {\r\n            // Result is not-null when there was enough memory to compute the changes while\r\n            // searching for the recursion point\r\n            return result;\r\n        }\r\n        else if (!quitEarlyArr[0]) {\r\n            // We can break the problem down recursively by finding the changes in the\r\n            // First Half:   (originalStart, modifiedStart) to (midOriginal, midModified)\r\n            // Second Half:  (midOriginal + 1, minModified + 1) to (originalEnd, modifiedEnd)\r\n            // NOTE: ComputeDiff() is inclusive, therefore the second range starts on the next point\r\n            var leftChanges = this.ComputeDiffRecursive(originalStart, midOriginal, modifiedStart, midModified, quitEarlyArr);\r\n            var rightChanges = [];\r\n            if (!quitEarlyArr[0]) {\r\n                rightChanges = this.ComputeDiffRecursive(midOriginal + 1, originalEnd, midModified + 1, modifiedEnd, quitEarlyArr);\r\n            }\r\n            else {\r\n                // We did't have time to finish the first half, so we don't have time to compute this half.\r\n                // Consider the entire rest of the sequence different.\r\n                rightChanges = [\r\n                    new DiffChange(midOriginal + 1, originalEnd - (midOriginal + 1) + 1, midModified + 1, modifiedEnd - (midModified + 1) + 1)\r\n                ];\r\n            }\r\n            return this.ConcatenateChanges(leftChanges, rightChanges);\r\n        }\r\n        // If we hit here, we quit early, and so can't return anything meaningful\r\n        return [\r\n            new DiffChange(originalStart, originalEnd - originalStart + 1, modifiedStart, modifiedEnd - modifiedStart + 1)\r\n        ];\r\n    };\r\n    LcsDiff.prototype.WALKTRACE = function (diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset, diagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset, forwardPoints, reversePoints, originalIndex, originalEnd, midOriginalArr, modifiedIndex, modifiedEnd, midModifiedArr, deltaIsEven, quitEarlyArr) {\r\n        var forwardChanges = null, reverseChanges = null;\r\n        // First, walk backward through the forward diagonals history\r\n        var changeHelper = new DiffChangeHelper();\r\n        var diagonalMin = diagonalForwardStart;\r\n        var diagonalMax = diagonalForwardEnd;\r\n        var diagonalRelative = (midOriginalArr[0] - midModifiedArr[0]) - diagonalForwardOffset;\r\n        var lastOriginalIndex = Number.MIN_VALUE;\r\n        var historyIndex = this.m_forwardHistory.length - 1;\r\n        var diagonal;\r\n        do {\r\n            // Get the diagonal index from the relative diagonal number\r\n            diagonal = diagonalRelative + diagonalForwardBase;\r\n            // Figure out where we came from\r\n            if (diagonal === diagonalMin || (diagonal < diagonalMax && forwardPoints[diagonal - 1] < forwardPoints[diagonal + 1])) {\r\n                // Vertical line (the element is an insert)\r\n                originalIndex = forwardPoints[diagonal + 1];\r\n                modifiedIndex = originalIndex - diagonalRelative - diagonalForwardOffset;\r\n                if (originalIndex < lastOriginalIndex) {\r\n                    changeHelper.MarkNextChange();\r\n                }\r\n                lastOriginalIndex = originalIndex;\r\n                changeHelper.AddModifiedElement(originalIndex + 1, modifiedIndex);\r\n                diagonalRelative = (diagonal + 1) - diagonalForwardBase; //Setup for the next iteration\r\n            }\r\n            else {\r\n                // Horizontal line (the element is a deletion)\r\n                originalIndex = forwardPoints[diagonal - 1] + 1;\r\n                modifiedIndex = originalIndex - diagonalRelative - diagonalForwardOffset;\r\n                if (originalIndex < lastOriginalIndex) {\r\n                    changeHelper.MarkNextChange();\r\n                }\r\n                lastOriginalIndex = originalIndex - 1;\r\n                changeHelper.AddOriginalElement(originalIndex, modifiedIndex + 1);\r\n                diagonalRelative = (diagonal - 1) - diagonalForwardBase; //Setup for the next iteration\r\n            }\r\n            if (historyIndex >= 0) {\r\n                forwardPoints = this.m_forwardHistory[historyIndex];\r\n                diagonalForwardBase = forwardPoints[0]; //We stored this in the first spot\r\n                diagonalMin = 1;\r\n                diagonalMax = forwardPoints.length - 1;\r\n            }\r\n        } while (--historyIndex >= -1);\r\n        // Ironically, we get the forward changes as the reverse of the\r\n        // order we added them since we technically added them backwards\r\n        forwardChanges = changeHelper.getReverseChanges();\r\n        if (quitEarlyArr[0]) {\r\n            // TODO: Calculate a partial from the reverse diagonals.\r\n            //       For now, just assume everything after the midOriginal/midModified point is a diff\r\n            var originalStartPoint = midOriginalArr[0] + 1;\r\n            var modifiedStartPoint = midModifiedArr[0] + 1;\r\n            if (forwardChanges !== null && forwardChanges.length > 0) {\r\n                var lastForwardChange = forwardChanges[forwardChanges.length - 1];\r\n                originalStartPoint = Math.max(originalStartPoint, lastForwardChange.getOriginalEnd());\r\n                modifiedStartPoint = Math.max(modifiedStartPoint, lastForwardChange.getModifiedEnd());\r\n            }\r\n            reverseChanges = [\r\n                new DiffChange(originalStartPoint, originalEnd - originalStartPoint + 1, modifiedStartPoint, modifiedEnd - modifiedStartPoint + 1)\r\n            ];\r\n        }\r\n        else {\r\n            // Now walk backward through the reverse diagonals history\r\n            changeHelper = new DiffChangeHelper();\r\n            diagonalMin = diagonalReverseStart;\r\n            diagonalMax = diagonalReverseEnd;\r\n            diagonalRelative = (midOriginalArr[0] - midModifiedArr[0]) - diagonalReverseOffset;\r\n            lastOriginalIndex = Number.MAX_VALUE;\r\n            historyIndex = (deltaIsEven) ? this.m_reverseHistory.length - 1 : this.m_reverseHistory.length - 2;\r\n            do {\r\n                // Get the diagonal index from the relative diagonal number\r\n                diagonal = diagonalRelative + diagonalReverseBase;\r\n                // Figure out where we came from\r\n                if (diagonal === diagonalMin || (diagonal < diagonalMax && reversePoints[diagonal - 1] >= reversePoints[diagonal + 1])) {\r\n                    // Horizontal line (the element is a deletion))\r\n                    originalIndex = reversePoints[diagonal + 1] - 1;\r\n                    modifiedIndex = originalIndex - diagonalRelative - diagonalReverseOffset;\r\n                    if (originalIndex > lastOriginalIndex) {\r\n                        changeHelper.MarkNextChange();\r\n                    }\r\n                    lastOriginalIndex = originalIndex + 1;\r\n                    changeHelper.AddOriginalElement(originalIndex + 1, modifiedIndex + 1);\r\n                    diagonalRelative = (diagonal + 1) - diagonalReverseBase; //Setup for the next iteration\r\n                }\r\n                else {\r\n                    // Vertical line (the element is an insertion)\r\n                    originalIndex = reversePoints[diagonal - 1];\r\n                    modifiedIndex = originalIndex - diagonalRelative - diagonalReverseOffset;\r\n                    if (originalIndex > lastOriginalIndex) {\r\n                        changeHelper.MarkNextChange();\r\n                    }\r\n                    lastOriginalIndex = originalIndex;\r\n                    changeHelper.AddModifiedElement(originalIndex + 1, modifiedIndex + 1);\r\n                    diagonalRelative = (diagonal - 1) - diagonalReverseBase; //Setup for the next iteration\r\n                }\r\n                if (historyIndex >= 0) {\r\n                    reversePoints = this.m_reverseHistory[historyIndex];\r\n                    diagonalReverseBase = reversePoints[0]; //We stored this in the first spot\r\n                    diagonalMin = 1;\r\n                    diagonalMax = reversePoints.length - 1;\r\n                }\r\n            } while (--historyIndex >= -1);\r\n            // There are cases where the reverse history will find diffs that\r\n            // are correct, but not intuitive, so we need shift them.\r\n            reverseChanges = changeHelper.getChanges();\r\n        }\r\n        return this.ConcatenateChanges(forwardChanges, reverseChanges);\r\n    };\r\n    /**\r\n     * Given the range to compute the diff on, this method finds the point:\r\n     * (midOriginal, midModified)\r\n     * that exists in the middle of the LCS of the two sequences and\r\n     * is the point at which the LCS problem may be broken down recursively.\r\n     * This method will try to keep the LCS trace in memory. If the LCS recursion\r\n     * point is calculated and the full trace is available in memory, then this method\r\n     * will return the change list.\r\n     * @param originalStart The start bound of the original sequence range\r\n     * @param originalEnd The end bound of the original sequence range\r\n     * @param modifiedStart The start bound of the modified sequence range\r\n     * @param modifiedEnd The end bound of the modified sequence range\r\n     * @param midOriginal The middle point of the original sequence range\r\n     * @param midModified The middle point of the modified sequence range\r\n     * @returns The diff changes, if available, otherwise null\r\n     */\r\n    LcsDiff.prototype.ComputeRecursionPoint = function (originalStart, originalEnd, modifiedStart, modifiedEnd, midOriginalArr, midModifiedArr, quitEarlyArr) {\r\n        var originalIndex = 0, modifiedIndex = 0;\r\n        var diagonalForwardStart = 0, diagonalForwardEnd = 0;\r\n        var diagonalReverseStart = 0, diagonalReverseEnd = 0;\r\n        var numDifferences;\r\n        // To traverse the edit graph and produce the proper LCS, our actual\r\n        // start position is just outside the given boundary\r\n        originalStart--;\r\n        modifiedStart--;\r\n        // We set these up to make the compiler happy, but they will\r\n        // be replaced before we return with the actual recursion point\r\n        midOriginalArr[0] = 0;\r\n        midModifiedArr[0] = 0;\r\n        // Clear out the history\r\n        this.m_forwardHistory = [];\r\n        this.m_reverseHistory = [];\r\n        // Each cell in the two arrays corresponds to a diagonal in the edit graph.\r\n        // The integer value in the cell represents the originalIndex of the furthest\r\n        // reaching point found so far that ends in that diagonal.\r\n        // The modifiedIndex can be computed mathematically from the originalIndex and the diagonal number.\r\n        var maxDifferences = (originalEnd - originalStart) + (modifiedEnd - modifiedStart);\r\n        var numDiagonals = maxDifferences + 1;\r\n        var forwardPoints = new Array(numDiagonals);\r\n        var reversePoints = new Array(numDiagonals);\r\n        // diagonalForwardBase: Index into forwardPoints of the diagonal which passes through (originalStart, modifiedStart)\r\n        // diagonalReverseBase: Index into reversePoints of the diagonal which passes through (originalEnd, modifiedEnd)\r\n        var diagonalForwardBase = (modifiedEnd - modifiedStart);\r\n        var diagonalReverseBase = (originalEnd - originalStart);\r\n        // diagonalForwardOffset: Geometric offset which allows modifiedIndex to be computed from originalIndex and the\r\n        //    diagonal number (relative to diagonalForwardBase)\r\n        // diagonalReverseOffset: Geometric offset which allows modifiedIndex to be computed from originalIndex and the\r\n        //    diagonal number (relative to diagonalReverseBase)\r\n        var diagonalForwardOffset = (originalStart - modifiedStart);\r\n        var diagonalReverseOffset = (originalEnd - modifiedEnd);\r\n        // delta: The difference between the end diagonal and the start diagonal. This is used to relate diagonal numbers\r\n        //   relative to the start diagonal with diagonal numbers relative to the end diagonal.\r\n        // The Even/Oddn-ness of this delta is important for determining when we should check for overlap\r\n        var delta = diagonalReverseBase - diagonalForwardBase;\r\n        var deltaIsEven = (delta % 2 === 0);\r\n        // Here we set up the start and end points as the furthest points found so far\r\n        // in both the forward and reverse directions, respectively\r\n        forwardPoints[diagonalForwardBase] = originalStart;\r\n        reversePoints[diagonalReverseBase] = originalEnd;\r\n        // Remember if we quit early, and thus need to do a best-effort result instead of a real result.\r\n        quitEarlyArr[0] = false;\r\n        // A couple of points:\r\n        // --With this method, we iterate on the number of differences between the two sequences.\r\n        //   The more differences there actually are, the longer this will take.\r\n        // --Also, as the number of differences increases, we have to search on diagonals further\r\n        //   away from the reference diagonal (which is diagonalForwardBase for forward, diagonalReverseBase for reverse).\r\n        // --We extend on even diagonals (relative to the reference diagonal) only when numDifferences\r\n        //   is even and odd diagonals only when numDifferences is odd.\r\n        var diagonal, tempOriginalIndex;\r\n        for (numDifferences = 1; numDifferences <= (maxDifferences / 2) + 1; numDifferences++) {\r\n            var furthestOriginalIndex = 0;\r\n            var furthestModifiedIndex = 0;\r\n            // Run the algorithm in the forward direction\r\n            diagonalForwardStart = this.ClipDiagonalBound(diagonalForwardBase - numDifferences, numDifferences, diagonalForwardBase, numDiagonals);\r\n            diagonalForwardEnd = this.ClipDiagonalBound(diagonalForwardBase + numDifferences, numDifferences, diagonalForwardBase, numDiagonals);\r\n            for (diagonal = diagonalForwardStart; diagonal <= diagonalForwardEnd; diagonal += 2) {\r\n                // STEP 1: We extend the furthest reaching point in the present diagonal\r\n                // by looking at the diagonals above and below and picking the one whose point\r\n                // is further away from the start point (originalStart, modifiedStart)\r\n                if (diagonal === diagonalForwardStart || (diagonal < diagonalForwardEnd && forwardPoints[diagonal - 1] < forwardPoints[diagonal + 1])) {\r\n                    originalIndex = forwardPoints[diagonal + 1];\r\n                }\r\n                else {\r\n                    originalIndex = forwardPoints[diagonal - 1] + 1;\r\n                }\r\n                modifiedIndex = originalIndex - (diagonal - diagonalForwardBase) - diagonalForwardOffset;\r\n                // Save the current originalIndex so we can test for false overlap in step 3\r\n                tempOriginalIndex = originalIndex;\r\n                // STEP 2: We can continue to extend the furthest reaching point in the present diagonal\r\n                // so long as the elements are equal.\r\n                while (originalIndex < originalEnd && modifiedIndex < modifiedEnd && this.ElementsAreEqual(originalIndex + 1, modifiedIndex + 1)) {\r\n                    originalIndex++;\r\n                    modifiedIndex++;\r\n                }\r\n                forwardPoints[diagonal] = originalIndex;\r\n                if (originalIndex + modifiedIndex > furthestOriginalIndex + furthestModifiedIndex) {\r\n                    furthestOriginalIndex = originalIndex;\r\n                    furthestModifiedIndex = modifiedIndex;\r\n                }\r\n                // STEP 3: If delta is odd (overlap first happens on forward when delta is odd)\r\n                // and diagonal is in the range of reverse diagonals computed for numDifferences-1\r\n                // (the previous iteration; we haven't computed reverse diagonals for numDifferences yet)\r\n                // then check for overlap.\r\n                if (!deltaIsEven && Math.abs(diagonal - diagonalReverseBase) <= (numDifferences - 1)) {\r\n                    if (originalIndex >= reversePoints[diagonal]) {\r\n                        midOriginalArr[0] = originalIndex;\r\n                        midModifiedArr[0] = modifiedIndex;\r\n                        if (tempOriginalIndex <= reversePoints[diagonal] && MaxDifferencesHistory > 0 && numDifferences <= (MaxDifferencesHistory + 1)) {\r\n                            // BINGO! We overlapped, and we have the full trace in memory!\r\n                            return this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset, diagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset, forwardPoints, reversePoints, originalIndex, originalEnd, midOriginalArr, modifiedIndex, modifiedEnd, midModifiedArr, deltaIsEven, quitEarlyArr);\r\n                        }\r\n                        else {\r\n                            // Either false overlap, or we didn't have enough memory for the full trace\r\n                            // Just return the recursion point\r\n                            return null;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Check to see if we should be quitting early, before moving on to the next iteration.\r\n            var matchLengthOfLongest = ((furthestOriginalIndex - originalStart) + (furthestModifiedIndex - modifiedStart) - numDifferences) / 2;\r\n            if (this.ContinueProcessingPredicate !== null && !this.ContinueProcessingPredicate(furthestOriginalIndex, this.OriginalSequence, matchLengthOfLongest)) {\r\n                // We can't finish, so skip ahead to generating a result from what we have.\r\n                quitEarlyArr[0] = true;\r\n                // Use the furthest distance we got in the forward direction.\r\n                midOriginalArr[0] = furthestOriginalIndex;\r\n                midModifiedArr[0] = furthestModifiedIndex;\r\n                if (matchLengthOfLongest > 0 && MaxDifferencesHistory > 0 && numDifferences <= (MaxDifferencesHistory + 1)) {\r\n                    // Enough of the history is in memory to walk it backwards\r\n                    return this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset, diagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset, forwardPoints, reversePoints, originalIndex, originalEnd, midOriginalArr, modifiedIndex, modifiedEnd, midModifiedArr, deltaIsEven, quitEarlyArr);\r\n                }\r\n                else {\r\n                    // We didn't actually remember enough of the history.\r\n                    //Since we are quiting the diff early, we need to shift back the originalStart and modified start\r\n                    //back into the boundary limits since we decremented their value above beyond the boundary limit.\r\n                    originalStart++;\r\n                    modifiedStart++;\r\n                    return [\r\n                        new DiffChange(originalStart, originalEnd - originalStart + 1, modifiedStart, modifiedEnd - modifiedStart + 1)\r\n                    ];\r\n                }\r\n            }\r\n            // Run the algorithm in the reverse direction\r\n            diagonalReverseStart = this.ClipDiagonalBound(diagonalReverseBase - numDifferences, numDifferences, diagonalReverseBase, numDiagonals);\r\n            diagonalReverseEnd = this.ClipDiagonalBound(diagonalReverseBase + numDifferences, numDifferences, diagonalReverseBase, numDiagonals);\r\n            for (diagonal = diagonalReverseStart; diagonal <= diagonalReverseEnd; diagonal += 2) {\r\n                // STEP 1: We extend the furthest reaching point in the present diagonal\r\n                // by looking at the diagonals above and below and picking the one whose point\r\n                // is further away from the start point (originalEnd, modifiedEnd)\r\n                if (diagonal === diagonalReverseStart || (diagonal < diagonalReverseEnd && reversePoints[diagonal - 1] >= reversePoints[diagonal + 1])) {\r\n                    originalIndex = reversePoints[diagonal + 1] - 1;\r\n                }\r\n                else {\r\n                    originalIndex = reversePoints[diagonal - 1];\r\n                }\r\n                modifiedIndex = originalIndex - (diagonal - diagonalReverseBase) - diagonalReverseOffset;\r\n                // Save the current originalIndex so we can test for false overlap\r\n                tempOriginalIndex = originalIndex;\r\n                // STEP 2: We can continue to extend the furthest reaching point in the present diagonal\r\n                // as long as the elements are equal.\r\n                while (originalIndex > originalStart && modifiedIndex > modifiedStart && this.ElementsAreEqual(originalIndex, modifiedIndex)) {\r\n                    originalIndex--;\r\n                    modifiedIndex--;\r\n                }\r\n                reversePoints[diagonal] = originalIndex;\r\n                // STEP 4: If delta is even (overlap first happens on reverse when delta is even)\r\n                // and diagonal is in the range of forward diagonals computed for numDifferences\r\n                // then check for overlap.\r\n                if (deltaIsEven && Math.abs(diagonal - diagonalForwardBase) <= numDifferences) {\r\n                    if (originalIndex <= forwardPoints[diagonal]) {\r\n                        midOriginalArr[0] = originalIndex;\r\n                        midModifiedArr[0] = modifiedIndex;\r\n                        if (tempOriginalIndex >= forwardPoints[diagonal] && MaxDifferencesHistory > 0 && numDifferences <= (MaxDifferencesHistory + 1)) {\r\n                            // BINGO! We overlapped, and we have the full trace in memory!\r\n                            return this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset, diagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset, forwardPoints, reversePoints, originalIndex, originalEnd, midOriginalArr, modifiedIndex, modifiedEnd, midModifiedArr, deltaIsEven, quitEarlyArr);\r\n                        }\r\n                        else {\r\n                            // Either false overlap, or we didn't have enough memory for the full trace\r\n                            // Just return the recursion point\r\n                            return null;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Save current vectors to history before the next iteration\r\n            if (numDifferences <= MaxDifferencesHistory) {\r\n                // We are allocating space for one extra int, which we fill with\r\n                // the index of the diagonal base index\r\n                var temp = new Array(diagonalForwardEnd - diagonalForwardStart + 2);\r\n                temp[0] = diagonalForwardBase - diagonalForwardStart + 1;\r\n                MyArray.Copy(forwardPoints, diagonalForwardStart, temp, 1, diagonalForwardEnd - diagonalForwardStart + 1);\r\n                this.m_forwardHistory.push(temp);\r\n                temp = new Array(diagonalReverseEnd - diagonalReverseStart + 2);\r\n                temp[0] = diagonalReverseBase - diagonalReverseStart + 1;\r\n                MyArray.Copy(reversePoints, diagonalReverseStart, temp, 1, diagonalReverseEnd - diagonalReverseStart + 1);\r\n                this.m_reverseHistory.push(temp);\r\n            }\r\n        }\r\n        // If we got here, then we have the full trace in history. We just have to convert it to a change list\r\n        // NOTE: This part is a bit messy\r\n        return this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset, diagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset, forwardPoints, reversePoints, originalIndex, originalEnd, midOriginalArr, modifiedIndex, modifiedEnd, midModifiedArr, deltaIsEven, quitEarlyArr);\r\n    };\r\n    /**\r\n     * Shifts the given changes to provide a more intuitive diff.\r\n     * While the first element in a diff matches the first element after the diff,\r\n     * we shift the diff down.\r\n     *\r\n     * @param changes The list of changes to shift\r\n     * @returns The shifted changes\r\n     */\r\n    LcsDiff.prototype.PrettifyChanges = function (changes) {\r\n        // Shift all the changes down first\r\n        for (var i = 0; i < changes.length; i++) {\r\n            var change = changes[i];\r\n            var originalStop = (i < changes.length - 1) ? changes[i + 1].originalStart : this.OriginalSequence.getLength();\r\n            var modifiedStop = (i < changes.length - 1) ? changes[i + 1].modifiedStart : this.ModifiedSequence.getLength();\r\n            var checkOriginal = change.originalLength > 0;\r\n            var checkModified = change.modifiedLength > 0;\r\n            while (change.originalStart + change.originalLength < originalStop &&\r\n                change.modifiedStart + change.modifiedLength < modifiedStop &&\r\n                (!checkOriginal || this.OriginalElementsAreEqual(change.originalStart, change.originalStart + change.originalLength)) &&\r\n                (!checkModified || this.ModifiedElementsAreEqual(change.modifiedStart, change.modifiedStart + change.modifiedLength))) {\r\n                change.originalStart++;\r\n                change.modifiedStart++;\r\n            }\r\n            var mergedChangeArr = [null];\r\n            if (i < changes.length - 1 && this.ChangesOverlap(changes[i], changes[i + 1], mergedChangeArr)) {\r\n                changes[i] = mergedChangeArr[0];\r\n                changes.splice(i + 1, 1);\r\n                i--;\r\n                continue;\r\n            }\r\n        }\r\n        // Shift changes back up until we hit empty or whitespace-only lines\r\n        for (var i = changes.length - 1; i >= 0; i--) {\r\n            var change = changes[i];\r\n            var originalStop = 0;\r\n            var modifiedStop = 0;\r\n            if (i > 0) {\r\n                var prevChange = changes[i - 1];\r\n                if (prevChange.originalLength > 0) {\r\n                    originalStop = prevChange.originalStart + prevChange.originalLength;\r\n                }\r\n                if (prevChange.modifiedLength > 0) {\r\n                    modifiedStop = prevChange.modifiedStart + prevChange.modifiedLength;\r\n                }\r\n            }\r\n            var checkOriginal = change.originalLength > 0;\r\n            var checkModified = change.modifiedLength > 0;\r\n            var bestDelta = 0;\r\n            var bestScore = this._boundaryScore(change.originalStart, change.originalLength, change.modifiedStart, change.modifiedLength);\r\n            for (var delta = 1;; delta++) {\r\n                var originalStart = change.originalStart - delta;\r\n                var modifiedStart = change.modifiedStart - delta;\r\n                if (originalStart < originalStop || modifiedStart < modifiedStop) {\r\n                    break;\r\n                }\r\n                if (checkOriginal && !this.OriginalElementsAreEqual(originalStart, originalStart + change.originalLength)) {\r\n                    break;\r\n                }\r\n                if (checkModified && !this.ModifiedElementsAreEqual(modifiedStart, modifiedStart + change.modifiedLength)) {\r\n                    break;\r\n                }\r\n                var score = this._boundaryScore(originalStart, change.originalLength, modifiedStart, change.modifiedLength);\r\n                if (score > bestScore) {\r\n                    bestScore = score;\r\n                    bestDelta = delta;\r\n                }\r\n            }\r\n            change.originalStart -= bestDelta;\r\n            change.modifiedStart -= bestDelta;\r\n        }\r\n        return changes;\r\n    };\r\n    LcsDiff.prototype._OriginalIsBoundary = function (index) {\r\n        if (index <= 0 || index >= this.OriginalSequence.getLength() - 1) {\r\n            return true;\r\n        }\r\n        var element = this.OriginalSequence.getElementAtIndex(index);\r\n        return (typeof element === 'string' && /^\\s*$/.test(element));\r\n    };\r\n    LcsDiff.prototype._OriginalRegionIsBoundary = function (originalStart, originalLength) {\r\n        if (this._OriginalIsBoundary(originalStart) || this._OriginalIsBoundary(originalStart - 1)) {\r\n            return true;\r\n        }\r\n        if (originalLength > 0) {\r\n            var originalEnd = originalStart + originalLength;\r\n            if (this._OriginalIsBoundary(originalEnd - 1) || this._OriginalIsBoundary(originalEnd)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    LcsDiff.prototype._ModifiedIsBoundary = function (index) {\r\n        if (index <= 0 || index >= this.ModifiedSequence.getLength() - 1) {\r\n            return true;\r\n        }\r\n        var element = this.ModifiedSequence.getElementAtIndex(index);\r\n        return (typeof element === 'string' && /^\\s*$/.test(element));\r\n    };\r\n    LcsDiff.prototype._ModifiedRegionIsBoundary = function (modifiedStart, modifiedLength) {\r\n        if (this._ModifiedIsBoundary(modifiedStart) || this._ModifiedIsBoundary(modifiedStart - 1)) {\r\n            return true;\r\n        }\r\n        if (modifiedLength > 0) {\r\n            var modifiedEnd = modifiedStart + modifiedLength;\r\n            if (this._ModifiedIsBoundary(modifiedEnd - 1) || this._ModifiedIsBoundary(modifiedEnd)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    LcsDiff.prototype._boundaryScore = function (originalStart, originalLength, modifiedStart, modifiedLength) {\r\n        var originalScore = (this._OriginalRegionIsBoundary(originalStart, originalLength) ? 1 : 0);\r\n        var modifiedScore = (this._ModifiedRegionIsBoundary(modifiedStart, modifiedLength) ? 1 : 0);\r\n        return (originalScore + modifiedScore);\r\n    };\r\n    /**\r\n     * Concatenates the two input DiffChange lists and returns the resulting\r\n     * list.\r\n     * @param The left changes\r\n     * @param The right changes\r\n     * @returns The concatenated list\r\n     */\r\n    LcsDiff.prototype.ConcatenateChanges = function (left, right) {\r\n        var mergedChangeArr = [];\r\n        if (left.length === 0 || right.length === 0) {\r\n            return (right.length > 0) ? right : left;\r\n        }\r\n        else if (this.ChangesOverlap(left[left.length - 1], right[0], mergedChangeArr)) {\r\n            // Since we break the problem down recursively, it is possible that we\r\n            // might recurse in the middle of a change thereby splitting it into\r\n            // two changes. Here in the combining stage, we detect and fuse those\r\n            // changes back together\r\n            var result = new Array(left.length + right.length - 1);\r\n            MyArray.Copy(left, 0, result, 0, left.length - 1);\r\n            result[left.length - 1] = mergedChangeArr[0];\r\n            MyArray.Copy(right, 1, result, left.length, right.length - 1);\r\n            return result;\r\n        }\r\n        else {\r\n            var result = new Array(left.length + right.length);\r\n            MyArray.Copy(left, 0, result, 0, left.length);\r\n            MyArray.Copy(right, 0, result, left.length, right.length);\r\n            return result;\r\n        }\r\n    };\r\n    /**\r\n     * Returns true if the two changes overlap and can be merged into a single\r\n     * change\r\n     * @param left The left change\r\n     * @param right The right change\r\n     * @param mergedChange The merged change if the two overlap, null otherwise\r\n     * @returns True if the two changes overlap\r\n     */\r\n    LcsDiff.prototype.ChangesOverlap = function (left, right, mergedChangeArr) {\r\n        Debug.Assert(left.originalStart <= right.originalStart, 'Left change is not less than or equal to right change');\r\n        Debug.Assert(left.modifiedStart <= right.modifiedStart, 'Left change is not less than or equal to right change');\r\n        if (left.originalStart + left.originalLength >= right.originalStart || left.modifiedStart + left.modifiedLength >= right.modifiedStart) {\r\n            var originalStart = left.originalStart;\r\n            var originalLength = left.originalLength;\r\n            var modifiedStart = left.modifiedStart;\r\n            var modifiedLength = left.modifiedLength;\r\n            if (left.originalStart + left.originalLength >= right.originalStart) {\r\n                originalLength = right.originalStart + right.originalLength - left.originalStart;\r\n            }\r\n            if (left.modifiedStart + left.modifiedLength >= right.modifiedStart) {\r\n                modifiedLength = right.modifiedStart + right.modifiedLength - left.modifiedStart;\r\n            }\r\n            mergedChangeArr[0] = new DiffChange(originalStart, originalLength, modifiedStart, modifiedLength);\r\n            return true;\r\n        }\r\n        else {\r\n            mergedChangeArr[0] = null;\r\n            return false;\r\n        }\r\n    };\r\n    /**\r\n     * Helper method used to clip a diagonal index to the range of valid\r\n     * diagonals. This also decides whether or not the diagonal index,\r\n     * if it exceeds the boundary, should be clipped to the boundary or clipped\r\n     * one inside the boundary depending on the Even/Odd status of the boundary\r\n     * and numDifferences.\r\n     * @param diagonal The index of the diagonal to clip.\r\n     * @param numDifferences The current number of differences being iterated upon.\r\n     * @param diagonalBaseIndex The base reference diagonal.\r\n     * @param numDiagonals The total number of diagonals.\r\n     * @returns The clipped diagonal index.\r\n     */\r\n    LcsDiff.prototype.ClipDiagonalBound = function (diagonal, numDifferences, diagonalBaseIndex, numDiagonals) {\r\n        if (diagonal >= 0 && diagonal < numDiagonals) {\r\n            // Nothing to clip, its in range\r\n            return diagonal;\r\n        }\r\n        // diagonalsBelow: The number of diagonals below the reference diagonal\r\n        // diagonalsAbove: The number of diagonals above the reference diagonal\r\n        var diagonalsBelow = diagonalBaseIndex;\r\n        var diagonalsAbove = numDiagonals - diagonalBaseIndex - 1;\r\n        var diffEven = (numDifferences % 2 === 0);\r\n        if (diagonal < 0) {\r\n            var lowerBoundEven = (diagonalsBelow % 2 === 0);\r\n            return (diffEven === lowerBoundEven) ? 0 : 1;\r\n        }\r\n        else {\r\n            var upperBoundEven = (diagonalsAbove % 2 === 0);\r\n            return (diffEven === upperBoundEven) ? numDiagonals - 1 : numDiagonals - 2;\r\n        }\r\n    };\r\n    return LcsDiff;\r\n}());\r\nexport { LcsDiff };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { LcsDiff } from '../../../base/common/diff/diff.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nvar MAXIMUM_RUN_TIME = 5000; // 5 seconds\r\nvar MINIMUM_MATCHING_CHARACTER_LENGTH = 3;\r\nfunction computeDiff(originalSequence, modifiedSequence, continueProcessingPredicate, pretty) {\r\n    var diffAlgo = new LcsDiff(originalSequence, modifiedSequence, continueProcessingPredicate);\r\n    return diffAlgo.ComputeDiff(pretty);\r\n}\r\nvar LineMarkerSequence = /** @class */ (function () {\r\n    function LineMarkerSequence(lines) {\r\n        var startColumns = [];\r\n        var endColumns = [];\r\n        for (var i = 0, length_1 = lines.length; i < length_1; i++) {\r\n            startColumns[i] = LineMarkerSequence._getFirstNonBlankColumn(lines[i], 1);\r\n            endColumns[i] = LineMarkerSequence._getLastNonBlankColumn(lines[i], 1);\r\n        }\r\n        this._lines = lines;\r\n        this._startColumns = startColumns;\r\n        this._endColumns = endColumns;\r\n    }\r\n    LineMarkerSequence.prototype.getLength = function () {\r\n        return this._lines.length;\r\n    };\r\n    LineMarkerSequence.prototype.getElementAtIndex = function (i) {\r\n        return this._lines[i].substring(this._startColumns[i] - 1, this._endColumns[i] - 1);\r\n    };\r\n    LineMarkerSequence.prototype.getStartLineNumber = function (i) {\r\n        return i + 1;\r\n    };\r\n    LineMarkerSequence.prototype.getEndLineNumber = function (i) {\r\n        return i + 1;\r\n    };\r\n    LineMarkerSequence._getFirstNonBlankColumn = function (txt, defaultValue) {\r\n        var r = strings.firstNonWhitespaceIndex(txt);\r\n        if (r === -1) {\r\n            return defaultValue;\r\n        }\r\n        return r + 1;\r\n    };\r\n    LineMarkerSequence._getLastNonBlankColumn = function (txt, defaultValue) {\r\n        var r = strings.lastNonWhitespaceIndex(txt);\r\n        if (r === -1) {\r\n            return defaultValue;\r\n        }\r\n        return r + 2;\r\n    };\r\n    LineMarkerSequence.prototype.getCharSequence = function (shouldIgnoreTrimWhitespace, startIndex, endIndex) {\r\n        var charCodes = [];\r\n        var lineNumbers = [];\r\n        var columns = [];\r\n        var len = 0;\r\n        for (var index = startIndex; index <= endIndex; index++) {\r\n            var lineContent = this._lines[index];\r\n            var startColumn = (shouldIgnoreTrimWhitespace ? this._startColumns[index] : 1);\r\n            var endColumn = (shouldIgnoreTrimWhitespace ? this._endColumns[index] : lineContent.length + 1);\r\n            for (var col = startColumn; col < endColumn; col++) {\r\n                charCodes[len] = lineContent.charCodeAt(col - 1);\r\n                lineNumbers[len] = index + 1;\r\n                columns[len] = col;\r\n                len++;\r\n            }\r\n        }\r\n        return new CharSequence(charCodes, lineNumbers, columns);\r\n    };\r\n    return LineMarkerSequence;\r\n}());\r\nvar CharSequence = /** @class */ (function () {\r\n    function CharSequence(charCodes, lineNumbers, columns) {\r\n        this._charCodes = charCodes;\r\n        this._lineNumbers = lineNumbers;\r\n        this._columns = columns;\r\n    }\r\n    CharSequence.prototype.getLength = function () {\r\n        return this._charCodes.length;\r\n    };\r\n    CharSequence.prototype.getElementAtIndex = function (i) {\r\n        return this._charCodes[i];\r\n    };\r\n    CharSequence.prototype.getStartLineNumber = function (i) {\r\n        return this._lineNumbers[i];\r\n    };\r\n    CharSequence.prototype.getStartColumn = function (i) {\r\n        return this._columns[i];\r\n    };\r\n    CharSequence.prototype.getEndLineNumber = function (i) {\r\n        return this._lineNumbers[i];\r\n    };\r\n    CharSequence.prototype.getEndColumn = function (i) {\r\n        return this._columns[i] + 1;\r\n    };\r\n    return CharSequence;\r\n}());\r\nvar CharChange = /** @class */ (function () {\r\n    function CharChange(originalStartLineNumber, originalStartColumn, originalEndLineNumber, originalEndColumn, modifiedStartLineNumber, modifiedStartColumn, modifiedEndLineNumber, modifiedEndColumn) {\r\n        this.originalStartLineNumber = originalStartLineNumber;\r\n        this.originalStartColumn = originalStartColumn;\r\n        this.originalEndLineNumber = originalEndLineNumber;\r\n        this.originalEndColumn = originalEndColumn;\r\n        this.modifiedStartLineNumber = modifiedStartLineNumber;\r\n        this.modifiedStartColumn = modifiedStartColumn;\r\n        this.modifiedEndLineNumber = modifiedEndLineNumber;\r\n        this.modifiedEndColumn = modifiedEndColumn;\r\n    }\r\n    CharChange.createFromDiffChange = function (diffChange, originalCharSequence, modifiedCharSequence) {\r\n        var originalStartLineNumber;\r\n        var originalStartColumn;\r\n        var originalEndLineNumber;\r\n        var originalEndColumn;\r\n        var modifiedStartLineNumber;\r\n        var modifiedStartColumn;\r\n        var modifiedEndLineNumber;\r\n        var modifiedEndColumn;\r\n        if (diffChange.originalLength === 0) {\r\n            originalStartLineNumber = 0;\r\n            originalStartColumn = 0;\r\n            originalEndLineNumber = 0;\r\n            originalEndColumn = 0;\r\n        }\r\n        else {\r\n            originalStartLineNumber = originalCharSequence.getStartLineNumber(diffChange.originalStart);\r\n            originalStartColumn = originalCharSequence.getStartColumn(diffChange.originalStart);\r\n            originalEndLineNumber = originalCharSequence.getEndLineNumber(diffChange.originalStart + diffChange.originalLength - 1);\r\n            originalEndColumn = originalCharSequence.getEndColumn(diffChange.originalStart + diffChange.originalLength - 1);\r\n        }\r\n        if (diffChange.modifiedLength === 0) {\r\n            modifiedStartLineNumber = 0;\r\n            modifiedStartColumn = 0;\r\n            modifiedEndLineNumber = 0;\r\n            modifiedEndColumn = 0;\r\n        }\r\n        else {\r\n            modifiedStartLineNumber = modifiedCharSequence.getStartLineNumber(diffChange.modifiedStart);\r\n            modifiedStartColumn = modifiedCharSequence.getStartColumn(diffChange.modifiedStart);\r\n            modifiedEndLineNumber = modifiedCharSequence.getEndLineNumber(diffChange.modifiedStart + diffChange.modifiedLength - 1);\r\n            modifiedEndColumn = modifiedCharSequence.getEndColumn(diffChange.modifiedStart + diffChange.modifiedLength - 1);\r\n        }\r\n        return new CharChange(originalStartLineNumber, originalStartColumn, originalEndLineNumber, originalEndColumn, modifiedStartLineNumber, modifiedStartColumn, modifiedEndLineNumber, modifiedEndColumn);\r\n    };\r\n    return CharChange;\r\n}());\r\nfunction postProcessCharChanges(rawChanges) {\r\n    if (rawChanges.length <= 1) {\r\n        return rawChanges;\r\n    }\r\n    var result = [rawChanges[0]];\r\n    var prevChange = result[0];\r\n    for (var i = 1, len = rawChanges.length; i < len; i++) {\r\n        var currChange = rawChanges[i];\r\n        var originalMatchingLength = currChange.originalStart - (prevChange.originalStart + prevChange.originalLength);\r\n        var modifiedMatchingLength = currChange.modifiedStart - (prevChange.modifiedStart + prevChange.modifiedLength);\r\n        // Both of the above should be equal, but the continueProcessingPredicate may prevent this from being true\r\n        var matchingLength = Math.min(originalMatchingLength, modifiedMatchingLength);\r\n        if (matchingLength < MINIMUM_MATCHING_CHARACTER_LENGTH) {\r\n            // Merge the current change into the previous one\r\n            prevChange.originalLength = (currChange.originalStart + currChange.originalLength) - prevChange.originalStart;\r\n            prevChange.modifiedLength = (currChange.modifiedStart + currChange.modifiedLength) - prevChange.modifiedStart;\r\n        }\r\n        else {\r\n            // Add the current change\r\n            result.push(currChange);\r\n            prevChange = currChange;\r\n        }\r\n    }\r\n    return result;\r\n}\r\nvar LineChange = /** @class */ (function () {\r\n    function LineChange(originalStartLineNumber, originalEndLineNumber, modifiedStartLineNumber, modifiedEndLineNumber, charChanges) {\r\n        this.originalStartLineNumber = originalStartLineNumber;\r\n        this.originalEndLineNumber = originalEndLineNumber;\r\n        this.modifiedStartLineNumber = modifiedStartLineNumber;\r\n        this.modifiedEndLineNumber = modifiedEndLineNumber;\r\n        this.charChanges = charChanges;\r\n    }\r\n    LineChange.createFromDiffResult = function (shouldIgnoreTrimWhitespace, diffChange, originalLineSequence, modifiedLineSequence, continueProcessingPredicate, shouldComputeCharChanges, shouldPostProcessCharChanges) {\r\n        var originalStartLineNumber;\r\n        var originalEndLineNumber;\r\n        var modifiedStartLineNumber;\r\n        var modifiedEndLineNumber;\r\n        var charChanges = undefined;\r\n        if (diffChange.originalLength === 0) {\r\n            originalStartLineNumber = originalLineSequence.getStartLineNumber(diffChange.originalStart) - 1;\r\n            originalEndLineNumber = 0;\r\n        }\r\n        else {\r\n            originalStartLineNumber = originalLineSequence.getStartLineNumber(diffChange.originalStart);\r\n            originalEndLineNumber = originalLineSequence.getEndLineNumber(diffChange.originalStart + diffChange.originalLength - 1);\r\n        }\r\n        if (diffChange.modifiedLength === 0) {\r\n            modifiedStartLineNumber = modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart) - 1;\r\n            modifiedEndLineNumber = 0;\r\n        }\r\n        else {\r\n            modifiedStartLineNumber = modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart);\r\n            modifiedEndLineNumber = modifiedLineSequence.getEndLineNumber(diffChange.modifiedStart + diffChange.modifiedLength - 1);\r\n        }\r\n        if (shouldComputeCharChanges && diffChange.originalLength !== 0 && diffChange.modifiedLength !== 0 && continueProcessingPredicate()) {\r\n            var originalCharSequence = originalLineSequence.getCharSequence(shouldIgnoreTrimWhitespace, diffChange.originalStart, diffChange.originalStart + diffChange.originalLength - 1);\r\n            var modifiedCharSequence = modifiedLineSequence.getCharSequence(shouldIgnoreTrimWhitespace, diffChange.modifiedStart, diffChange.modifiedStart + diffChange.modifiedLength - 1);\r\n            var rawChanges = computeDiff(originalCharSequence, modifiedCharSequence, continueProcessingPredicate, true);\r\n            if (shouldPostProcessCharChanges) {\r\n                rawChanges = postProcessCharChanges(rawChanges);\r\n            }\r\n            charChanges = [];\r\n            for (var i = 0, length_2 = rawChanges.length; i < length_2; i++) {\r\n                charChanges.push(CharChange.createFromDiffChange(rawChanges[i], originalCharSequence, modifiedCharSequence));\r\n            }\r\n        }\r\n        return new LineChange(originalStartLineNumber, originalEndLineNumber, modifiedStartLineNumber, modifiedEndLineNumber, charChanges);\r\n    };\r\n    return LineChange;\r\n}());\r\nvar DiffComputer = /** @class */ (function () {\r\n    function DiffComputer(originalLines, modifiedLines, opts) {\r\n        this.shouldComputeCharChanges = opts.shouldComputeCharChanges;\r\n        this.shouldPostProcessCharChanges = opts.shouldPostProcessCharChanges;\r\n        this.shouldIgnoreTrimWhitespace = opts.shouldIgnoreTrimWhitespace;\r\n        this.shouldMakePrettyDiff = opts.shouldMakePrettyDiff;\r\n        this.maximumRunTimeMs = MAXIMUM_RUN_TIME;\r\n        this.originalLines = originalLines;\r\n        this.modifiedLines = modifiedLines;\r\n        this.original = new LineMarkerSequence(originalLines);\r\n        this.modified = new LineMarkerSequence(modifiedLines);\r\n    }\r\n    DiffComputer.prototype.computeDiff = function () {\r\n        if (this.original.getLength() === 1 && this.original.getElementAtIndex(0).length === 0) {\r\n            // empty original => fast path\r\n            return [{\r\n                    originalStartLineNumber: 1,\r\n                    originalEndLineNumber: 1,\r\n                    modifiedStartLineNumber: 1,\r\n                    modifiedEndLineNumber: this.modified.getLength(),\r\n                    charChanges: [{\r\n                            modifiedEndColumn: 0,\r\n                            modifiedEndLineNumber: 0,\r\n                            modifiedStartColumn: 0,\r\n                            modifiedStartLineNumber: 0,\r\n                            originalEndColumn: 0,\r\n                            originalEndLineNumber: 0,\r\n                            originalStartColumn: 0,\r\n                            originalStartLineNumber: 0\r\n                        }]\r\n                }];\r\n        }\r\n        if (this.modified.getLength() === 1 && this.modified.getElementAtIndex(0).length === 0) {\r\n            // empty modified => fast path\r\n            return [{\r\n                    originalStartLineNumber: 1,\r\n                    originalEndLineNumber: this.original.getLength(),\r\n                    modifiedStartLineNumber: 1,\r\n                    modifiedEndLineNumber: 1,\r\n                    charChanges: [{\r\n                            modifiedEndColumn: 0,\r\n                            modifiedEndLineNumber: 0,\r\n                            modifiedStartColumn: 0,\r\n                            modifiedStartLineNumber: 0,\r\n                            originalEndColumn: 0,\r\n                            originalEndLineNumber: 0,\r\n                            originalStartColumn: 0,\r\n                            originalStartLineNumber: 0\r\n                        }]\r\n                }];\r\n        }\r\n        this.computationStartTime = (new Date()).getTime();\r\n        var rawChanges = computeDiff(this.original, this.modified, this._continueProcessingPredicate.bind(this), this.shouldMakePrettyDiff);\r\n        // The diff is always computed with ignoring trim whitespace\r\n        // This ensures we get the prettiest diff\r\n        if (this.shouldIgnoreTrimWhitespace) {\r\n            var lineChanges = [];\r\n            for (var i = 0, length_3 = rawChanges.length; i < length_3; i++) {\r\n                lineChanges.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace, rawChanges[i], this.original, this.modified, this._continueProcessingPredicate.bind(this), this.shouldComputeCharChanges, this.shouldPostProcessCharChanges));\r\n            }\r\n            return lineChanges;\r\n        }\r\n        // Need to post-process and introduce changes where the trim whitespace is different\r\n        // Note that we are looping starting at -1 to also cover the lines before the first change\r\n        var result = [];\r\n        var originalLineIndex = 0;\r\n        var modifiedLineIndex = 0;\r\n        for (var i = -1 /* !!!! */, len = rawChanges.length; i < len; i++) {\r\n            var nextChange = (i + 1 < len ? rawChanges[i + 1] : null);\r\n            var originalStop = (nextChange ? nextChange.originalStart : this.originalLines.length);\r\n            var modifiedStop = (nextChange ? nextChange.modifiedStart : this.modifiedLines.length);\r\n            while (originalLineIndex < originalStop && modifiedLineIndex < modifiedStop) {\r\n                var originalLine = this.originalLines[originalLineIndex];\r\n                var modifiedLine = this.modifiedLines[modifiedLineIndex];\r\n                if (originalLine !== modifiedLine) {\r\n                    // These lines differ only in trim whitespace\r\n                    // Check the leading whitespace\r\n                    {\r\n                        var originalStartColumn = LineMarkerSequence._getFirstNonBlankColumn(originalLine, 1);\r\n                        var modifiedStartColumn = LineMarkerSequence._getFirstNonBlankColumn(modifiedLine, 1);\r\n                        while (originalStartColumn > 1 && modifiedStartColumn > 1) {\r\n                            var originalChar = originalLine.charCodeAt(originalStartColumn - 2);\r\n                            var modifiedChar = modifiedLine.charCodeAt(modifiedStartColumn - 2);\r\n                            if (originalChar !== modifiedChar) {\r\n                                break;\r\n                            }\r\n                            originalStartColumn--;\r\n                            modifiedStartColumn--;\r\n                        }\r\n                        if (originalStartColumn > 1 || modifiedStartColumn > 1) {\r\n                            this._pushTrimWhitespaceCharChange(result, originalLineIndex + 1, 1, originalStartColumn, modifiedLineIndex + 1, 1, modifiedStartColumn);\r\n                        }\r\n                    }\r\n                    // Check the trailing whitespace\r\n                    {\r\n                        var originalEndColumn = LineMarkerSequence._getLastNonBlankColumn(originalLine, 1);\r\n                        var modifiedEndColumn = LineMarkerSequence._getLastNonBlankColumn(modifiedLine, 1);\r\n                        var originalMaxColumn = originalLine.length + 1;\r\n                        var modifiedMaxColumn = modifiedLine.length + 1;\r\n                        while (originalEndColumn < originalMaxColumn && modifiedEndColumn < modifiedMaxColumn) {\r\n                            var originalChar = originalLine.charCodeAt(originalEndColumn - 1);\r\n                            var modifiedChar = originalLine.charCodeAt(modifiedEndColumn - 1);\r\n                            if (originalChar !== modifiedChar) {\r\n                                break;\r\n                            }\r\n                            originalEndColumn++;\r\n                            modifiedEndColumn++;\r\n                        }\r\n                        if (originalEndColumn < originalMaxColumn || modifiedEndColumn < modifiedMaxColumn) {\r\n                            this._pushTrimWhitespaceCharChange(result, originalLineIndex + 1, originalEndColumn, originalMaxColumn, modifiedLineIndex + 1, modifiedEndColumn, modifiedMaxColumn);\r\n                        }\r\n                    }\r\n                }\r\n                originalLineIndex++;\r\n                modifiedLineIndex++;\r\n            }\r\n            if (nextChange) {\r\n                // Emit the actual change\r\n                result.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace, nextChange, this.original, this.modified, this._continueProcessingPredicate.bind(this), this.shouldComputeCharChanges, this.shouldPostProcessCharChanges));\r\n                originalLineIndex += nextChange.originalLength;\r\n                modifiedLineIndex += nextChange.modifiedLength;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    DiffComputer.prototype._pushTrimWhitespaceCharChange = function (result, originalLineNumber, originalStartColumn, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedEndColumn) {\r\n        if (this._mergeTrimWhitespaceCharChange(result, originalLineNumber, originalStartColumn, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedEndColumn)) {\r\n            // Merged into previous\r\n            return;\r\n        }\r\n        var charChanges = undefined;\r\n        if (this.shouldComputeCharChanges) {\r\n            charChanges = [new CharChange(originalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn)];\r\n        }\r\n        result.push(new LineChange(originalLineNumber, originalLineNumber, modifiedLineNumber, modifiedLineNumber, charChanges));\r\n    };\r\n    DiffComputer.prototype._mergeTrimWhitespaceCharChange = function (result, originalLineNumber, originalStartColumn, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedEndColumn) {\r\n        var len = result.length;\r\n        if (len === 0) {\r\n            return false;\r\n        }\r\n        var prevChange = result[len - 1];\r\n        if (prevChange.originalEndLineNumber === 0 || prevChange.modifiedEndLineNumber === 0) {\r\n            // Don't merge with inserts/deletes\r\n            return false;\r\n        }\r\n        if (prevChange.originalEndLineNumber + 1 === originalLineNumber && prevChange.modifiedEndLineNumber + 1 === modifiedLineNumber) {\r\n            prevChange.originalEndLineNumber = originalLineNumber;\r\n            prevChange.modifiedEndLineNumber = modifiedLineNumber;\r\n            if (this.shouldComputeCharChanges) {\r\n                prevChange.charChanges.push(new CharChange(originalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn));\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    DiffComputer.prototype._continueProcessingPredicate = function () {\r\n        if (this.maximumRunTimeMs === 0) {\r\n            return true;\r\n        }\r\n        var now = (new Date()).getTime();\r\n        return now - this.computationStartTime < this.maximumRunTimeMs;\r\n    };\r\n    return DiffComputer;\r\n}());\r\nexport { DiffComputer };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar Uint8Matrix = /** @class */ (function () {\r\n    function Uint8Matrix(rows, cols, defaultValue) {\r\n        var data = new Uint8Array(rows * cols);\r\n        for (var i = 0, len = rows * cols; i < len; i++) {\r\n            data[i] = defaultValue;\r\n        }\r\n        this._data = data;\r\n        this.rows = rows;\r\n        this.cols = cols;\r\n    }\r\n    Uint8Matrix.prototype.get = function (row, col) {\r\n        return this._data[row * this.cols + col];\r\n    };\r\n    Uint8Matrix.prototype.set = function (row, col, value) {\r\n        this._data[row * this.cols + col] = value;\r\n    };\r\n    return Uint8Matrix;\r\n}());\r\nexport { Uint8Matrix };\r\nexport function toUint8(v) {\r\n    if (v < 0) {\r\n        return 0;\r\n    }\r\n    if (v > 255 /* MAX_UINT_8 */) {\r\n        return 255 /* MAX_UINT_8 */;\r\n    }\r\n    return v | 0;\r\n}\r\nexport function toUint32(v) {\r\n    if (v < 0) {\r\n        return 0;\r\n    }\r\n    if (v > 4294967295 /* MAX_UINT_32 */) {\r\n        return 4294967295 /* MAX_UINT_32 */;\r\n    }\r\n    return v | 0;\r\n}\r\nexport function toUint32Array(arr) {\r\n    var len = arr.length;\r\n    var r = new Uint32Array(len);\r\n    for (var i = 0; i < len; i++) {\r\n        r[i] = toUint32(arr[i]);\r\n    }\r\n    return r;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { toUint32 } from '../core/uint.js';\r\nvar PrefixSumIndexOfResult = /** @class */ (function () {\r\n    function PrefixSumIndexOfResult(index, remainder) {\r\n        this.index = index;\r\n        this.remainder = remainder;\r\n    }\r\n    return PrefixSumIndexOfResult;\r\n}());\r\nexport { PrefixSumIndexOfResult };\r\nvar PrefixSumComputer = /** @class */ (function () {\r\n    function PrefixSumComputer(values) {\r\n        this.values = values;\r\n        this.prefixSum = new Uint32Array(values.length);\r\n        this.prefixSumValidIndex = new Int32Array(1);\r\n        this.prefixSumValidIndex[0] = -1;\r\n    }\r\n    PrefixSumComputer.prototype.getCount = function () {\r\n        return this.values.length;\r\n    };\r\n    PrefixSumComputer.prototype.insertValues = function (insertIndex, insertValues) {\r\n        insertIndex = toUint32(insertIndex);\r\n        var oldValues = this.values;\r\n        var oldPrefixSum = this.prefixSum;\r\n        var insertValuesLen = insertValues.length;\r\n        if (insertValuesLen === 0) {\r\n            return false;\r\n        }\r\n        this.values = new Uint32Array(oldValues.length + insertValuesLen);\r\n        this.values.set(oldValues.subarray(0, insertIndex), 0);\r\n        this.values.set(oldValues.subarray(insertIndex), insertIndex + insertValuesLen);\r\n        this.values.set(insertValues, insertIndex);\r\n        if (insertIndex - 1 < this.prefixSumValidIndex[0]) {\r\n            this.prefixSumValidIndex[0] = insertIndex - 1;\r\n        }\r\n        this.prefixSum = new Uint32Array(this.values.length);\r\n        if (this.prefixSumValidIndex[0] >= 0) {\r\n            this.prefixSum.set(oldPrefixSum.subarray(0, this.prefixSumValidIndex[0] + 1));\r\n        }\r\n        return true;\r\n    };\r\n    PrefixSumComputer.prototype.changeValue = function (index, value) {\r\n        index = toUint32(index);\r\n        value = toUint32(value);\r\n        if (this.values[index] === value) {\r\n            return false;\r\n        }\r\n        this.values[index] = value;\r\n        if (index - 1 < this.prefixSumValidIndex[0]) {\r\n            this.prefixSumValidIndex[0] = index - 1;\r\n        }\r\n        return true;\r\n    };\r\n    PrefixSumComputer.prototype.removeValues = function (startIndex, cnt) {\r\n        startIndex = toUint32(startIndex);\r\n        cnt = toUint32(cnt);\r\n        var oldValues = this.values;\r\n        var oldPrefixSum = this.prefixSum;\r\n        if (startIndex >= oldValues.length) {\r\n            return false;\r\n        }\r\n        var maxCnt = oldValues.length - startIndex;\r\n        if (cnt >= maxCnt) {\r\n            cnt = maxCnt;\r\n        }\r\n        if (cnt === 0) {\r\n            return false;\r\n        }\r\n        this.values = new Uint32Array(oldValues.length - cnt);\r\n        this.values.set(oldValues.subarray(0, startIndex), 0);\r\n        this.values.set(oldValues.subarray(startIndex + cnt), startIndex);\r\n        this.prefixSum = new Uint32Array(this.values.length);\r\n        if (startIndex - 1 < this.prefixSumValidIndex[0]) {\r\n            this.prefixSumValidIndex[0] = startIndex - 1;\r\n        }\r\n        if (this.prefixSumValidIndex[0] >= 0) {\r\n            this.prefixSum.set(oldPrefixSum.subarray(0, this.prefixSumValidIndex[0] + 1));\r\n        }\r\n        return true;\r\n    };\r\n    PrefixSumComputer.prototype.getTotalValue = function () {\r\n        if (this.values.length === 0) {\r\n            return 0;\r\n        }\r\n        return this._getAccumulatedValue(this.values.length - 1);\r\n    };\r\n    PrefixSumComputer.prototype.getAccumulatedValue = function (index) {\r\n        if (index < 0) {\r\n            return 0;\r\n        }\r\n        index = toUint32(index);\r\n        return this._getAccumulatedValue(index);\r\n    };\r\n    PrefixSumComputer.prototype._getAccumulatedValue = function (index) {\r\n        if (index <= this.prefixSumValidIndex[0]) {\r\n            return this.prefixSum[index];\r\n        }\r\n        var startIndex = this.prefixSumValidIndex[0] + 1;\r\n        if (startIndex === 0) {\r\n            this.prefixSum[0] = this.values[0];\r\n            startIndex++;\r\n        }\r\n        if (index >= this.values.length) {\r\n            index = this.values.length - 1;\r\n        }\r\n        for (var i = startIndex; i <= index; i++) {\r\n            this.prefixSum[i] = this.prefixSum[i - 1] + this.values[i];\r\n        }\r\n        this.prefixSumValidIndex[0] = Math.max(this.prefixSumValidIndex[0], index);\r\n        return this.prefixSum[index];\r\n    };\r\n    PrefixSumComputer.prototype.getIndexOf = function (accumulatedValue) {\r\n        accumulatedValue = Math.floor(accumulatedValue); //@perf\r\n        // Compute all sums (to get a fully valid prefixSum)\r\n        this.getTotalValue();\r\n        var low = 0;\r\n        var high = this.values.length - 1;\r\n        var mid = 0;\r\n        var midStop = 0;\r\n        var midStart = 0;\r\n        while (low <= high) {\r\n            mid = low + ((high - low) / 2) | 0;\r\n            midStop = this.prefixSum[mid];\r\n            midStart = midStop - this.values[mid];\r\n            if (accumulatedValue < midStart) {\r\n                high = mid - 1;\r\n            }\r\n            else if (accumulatedValue >= midStop) {\r\n                low = mid + 1;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        return new PrefixSumIndexOfResult(mid, accumulatedValue - midStart);\r\n    };\r\n    return PrefixSumComputer;\r\n}());\r\nexport { PrefixSumComputer };\r\nvar PrefixSumComputerWithCache = /** @class */ (function () {\r\n    function PrefixSumComputerWithCache(values) {\r\n        this._cacheAccumulatedValueStart = 0;\r\n        this._cache = null;\r\n        this._actual = new PrefixSumComputer(values);\r\n        this._bustCache();\r\n    }\r\n    PrefixSumComputerWithCache.prototype._bustCache = function () {\r\n        this._cacheAccumulatedValueStart = 0;\r\n        this._cache = null;\r\n    };\r\n    PrefixSumComputerWithCache.prototype.insertValues = function (insertIndex, insertValues) {\r\n        if (this._actual.insertValues(insertIndex, insertValues)) {\r\n            this._bustCache();\r\n        }\r\n    };\r\n    PrefixSumComputerWithCache.prototype.changeValue = function (index, value) {\r\n        if (this._actual.changeValue(index, value)) {\r\n            this._bustCache();\r\n        }\r\n    };\r\n    PrefixSumComputerWithCache.prototype.removeValues = function (startIndex, cnt) {\r\n        if (this._actual.removeValues(startIndex, cnt)) {\r\n            this._bustCache();\r\n        }\r\n    };\r\n    PrefixSumComputerWithCache.prototype.getTotalValue = function () {\r\n        return this._actual.getTotalValue();\r\n    };\r\n    PrefixSumComputerWithCache.prototype.getAccumulatedValue = function (index) {\r\n        return this._actual.getAccumulatedValue(index);\r\n    };\r\n    PrefixSumComputerWithCache.prototype.getIndexOf = function (accumulatedValue) {\r\n        accumulatedValue = Math.floor(accumulatedValue); //@perf\r\n        if (this._cache !== null) {\r\n            var cacheIndex = accumulatedValue - this._cacheAccumulatedValueStart;\r\n            if (cacheIndex >= 0 && cacheIndex < this._cache.length) {\r\n                // Cache hit!\r\n                return this._cache[cacheIndex];\r\n            }\r\n        }\r\n        // Cache miss!\r\n        return this._actual.getIndexOf(accumulatedValue);\r\n    };\r\n    /**\r\n     * Gives a hint that a lot of requests are about to come in for these accumulated values.\r\n     */\r\n    PrefixSumComputerWithCache.prototype.warmUpCache = function (accumulatedValueStart, accumulatedValueEnd) {\r\n        var newCache = [];\r\n        for (var accumulatedValue = accumulatedValueStart; accumulatedValue <= accumulatedValueEnd; accumulatedValue++) {\r\n            newCache[accumulatedValue - accumulatedValueStart] = this.getIndexOf(accumulatedValue);\r\n        }\r\n        this._cache = newCache;\r\n        this._cacheAccumulatedValueStart = accumulatedValueStart;\r\n    };\r\n    return PrefixSumComputerWithCache;\r\n}());\r\nexport { PrefixSumComputerWithCache };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Position } from '../core/position.js';\r\nimport { PrefixSumComputer } from '../viewModel/prefixSumComputer.js';\r\nvar MirrorTextModel = /** @class */ (function () {\r\n    function MirrorTextModel(uri, lines, eol, versionId) {\r\n        this._uri = uri;\r\n        this._lines = lines;\r\n        this._eol = eol;\r\n        this._versionId = versionId;\r\n        this._lineStarts = null;\r\n    }\r\n    MirrorTextModel.prototype.dispose = function () {\r\n        this._lines.length = 0;\r\n    };\r\n    MirrorTextModel.prototype.getText = function () {\r\n        return this._lines.join(this._eol);\r\n    };\r\n    MirrorTextModel.prototype.onEvents = function (e) {\r\n        if (e.eol && e.eol !== this._eol) {\r\n            this._eol = e.eol;\r\n            this._lineStarts = null;\r\n        }\r\n        // Update my lines\r\n        var changes = e.changes;\r\n        for (var i = 0, len = changes.length; i < len; i++) {\r\n            var change = changes[i];\r\n            this._acceptDeleteRange(change.range);\r\n            this._acceptInsertText(new Position(change.range.startLineNumber, change.range.startColumn), change.text);\r\n        }\r\n        this._versionId = e.versionId;\r\n    };\r\n    MirrorTextModel.prototype._ensureLineStarts = function () {\r\n        if (!this._lineStarts) {\r\n            var eolLength = this._eol.length;\r\n            var linesLength = this._lines.length;\r\n            var lineStartValues = new Uint32Array(linesLength);\r\n            for (var i = 0; i < linesLength; i++) {\r\n                lineStartValues[i] = this._lines[i].length + eolLength;\r\n            }\r\n            this._lineStarts = new PrefixSumComputer(lineStartValues);\r\n        }\r\n    };\r\n    /**\r\n     * All changes to a line's text go through this method\r\n     */\r\n    MirrorTextModel.prototype._setLineText = function (lineIndex, newValue) {\r\n        this._lines[lineIndex] = newValue;\r\n        if (this._lineStarts) {\r\n            // update prefix sum\r\n            this._lineStarts.changeValue(lineIndex, this._lines[lineIndex].length + this._eol.length);\r\n        }\r\n    };\r\n    MirrorTextModel.prototype._acceptDeleteRange = function (range) {\r\n        if (range.startLineNumber === range.endLineNumber) {\r\n            if (range.startColumn === range.endColumn) {\r\n                // Nothing to delete\r\n                return;\r\n            }\r\n            // Delete text on the affected line\r\n            this._setLineText(range.startLineNumber - 1, this._lines[range.startLineNumber - 1].substring(0, range.startColumn - 1)\r\n                + this._lines[range.startLineNumber - 1].substring(range.endColumn - 1));\r\n            return;\r\n        }\r\n        // Take remaining text on last line and append it to remaining text on first line\r\n        this._setLineText(range.startLineNumber - 1, this._lines[range.startLineNumber - 1].substring(0, range.startColumn - 1)\r\n            + this._lines[range.endLineNumber - 1].substring(range.endColumn - 1));\r\n        // Delete middle lines\r\n        this._lines.splice(range.startLineNumber, range.endLineNumber - range.startLineNumber);\r\n        if (this._lineStarts) {\r\n            // update prefix sum\r\n            this._lineStarts.removeValues(range.startLineNumber, range.endLineNumber - range.startLineNumber);\r\n        }\r\n    };\r\n    MirrorTextModel.prototype._acceptInsertText = function (position, insertText) {\r\n        if (insertText.length === 0) {\r\n            // Nothing to insert\r\n            return;\r\n        }\r\n        var insertLines = insertText.split(/\\r\\n|\\r|\\n/);\r\n        if (insertLines.length === 1) {\r\n            // Inserting text on one line\r\n            this._setLineText(position.lineNumber - 1, this._lines[position.lineNumber - 1].substring(0, position.column - 1)\r\n                + insertLines[0]\r\n                + this._lines[position.lineNumber - 1].substring(position.column - 1));\r\n            return;\r\n        }\r\n        // Append overflowing text from first line to the end of text to insert\r\n        insertLines[insertLines.length - 1] += this._lines[position.lineNumber - 1].substring(position.column - 1);\r\n        // Delete overflowing text from first line and insert text on first line\r\n        this._setLineText(position.lineNumber - 1, this._lines[position.lineNumber - 1].substring(0, position.column - 1)\r\n            + insertLines[0]);\r\n        // Insert new lines & store lengths\r\n        var newLengths = new Uint32Array(insertLines.length - 1);\r\n        for (var i = 1; i < insertLines.length; i++) {\r\n            this._lines.splice(position.lineNumber + i - 1, 0, insertLines[i]);\r\n            newLengths[i - 1] = insertLines[i].length + this._eol.length;\r\n        }\r\n        if (this._lineStarts) {\r\n            // update prefix sum\r\n            this._lineStarts.insertValues(position.lineNumber, newLengths);\r\n        }\r\n    };\r\n    return MirrorTextModel;\r\n}());\r\nexport { MirrorTextModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { toUint8 } from './uint.js';\r\n/**\r\n * A fast character classifier that uses a compact array for ASCII values.\r\n */\r\nvar CharacterClassifier = /** @class */ (function () {\r\n    function CharacterClassifier(_defaultValue) {\r\n        var defaultValue = toUint8(_defaultValue);\r\n        this._defaultValue = defaultValue;\r\n        this._asciiMap = CharacterClassifier._createAsciiMap(defaultValue);\r\n        this._map = new Map();\r\n    }\r\n    CharacterClassifier._createAsciiMap = function (defaultValue) {\r\n        var asciiMap = new Uint8Array(256);\r\n        for (var i = 0; i < 256; i++) {\r\n            asciiMap[i] = defaultValue;\r\n        }\r\n        return asciiMap;\r\n    };\r\n    CharacterClassifier.prototype.set = function (charCode, _value) {\r\n        var value = toUint8(_value);\r\n        if (charCode >= 0 && charCode < 256) {\r\n            this._asciiMap[charCode] = value;\r\n        }\r\n        else {\r\n            this._map.set(charCode, value);\r\n        }\r\n    };\r\n    CharacterClassifier.prototype.get = function (charCode) {\r\n        if (charCode >= 0 && charCode < 256) {\r\n            return this._asciiMap[charCode];\r\n        }\r\n        else {\r\n            return (this._map.get(charCode) || this._defaultValue);\r\n        }\r\n    };\r\n    return CharacterClassifier;\r\n}());\r\nexport { CharacterClassifier };\r\nvar CharacterSet = /** @class */ (function () {\r\n    function CharacterSet() {\r\n        this._actual = new CharacterClassifier(0 /* False */);\r\n    }\r\n    CharacterSet.prototype.add = function (charCode) {\r\n        this._actual.set(charCode, 1 /* True */);\r\n    };\r\n    CharacterSet.prototype.has = function (charCode) {\r\n        return (this._actual.get(charCode) === 1 /* True */);\r\n    };\r\n    return CharacterSet;\r\n}());\r\nexport { CharacterSet };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { CharacterClassifier } from '../core/characterClassifier.js';\r\nimport { Uint8Matrix } from '../core/uint.js';\r\nvar StateMachine = /** @class */ (function () {\r\n    function StateMachine(edges) {\r\n        var maxCharCode = 0;\r\n        var maxState = 0 /* Invalid */;\r\n        for (var i = 0, len = edges.length; i < len; i++) {\r\n            var _a = edges[i], from = _a[0], chCode = _a[1], to = _a[2];\r\n            if (chCode > maxCharCode) {\r\n                maxCharCode = chCode;\r\n            }\r\n            if (from > maxState) {\r\n                maxState = from;\r\n            }\r\n            if (to > maxState) {\r\n                maxState = to;\r\n            }\r\n        }\r\n        maxCharCode++;\r\n        maxState++;\r\n        var states = new Uint8Matrix(maxState, maxCharCode, 0 /* Invalid */);\r\n        for (var i = 0, len = edges.length; i < len; i++) {\r\n            var _b = edges[i], from = _b[0], chCode = _b[1], to = _b[2];\r\n            states.set(from, chCode, to);\r\n        }\r\n        this._states = states;\r\n        this._maxCharCode = maxCharCode;\r\n    }\r\n    StateMachine.prototype.nextState = function (currentState, chCode) {\r\n        if (chCode < 0 || chCode >= this._maxCharCode) {\r\n            return 0 /* Invalid */;\r\n        }\r\n        return this._states.get(currentState, chCode);\r\n    };\r\n    return StateMachine;\r\n}());\r\n// State machine for http:// or https:// or file://\r\nvar _stateMachine = null;\r\nfunction getStateMachine() {\r\n    if (_stateMachine === null) {\r\n        _stateMachine = new StateMachine([\r\n            [1 /* Start */, 104 /* h */, 2 /* H */],\r\n            [1 /* Start */, 72 /* H */, 2 /* H */],\r\n            [1 /* Start */, 102 /* f */, 6 /* F */],\r\n            [1 /* Start */, 70 /* F */, 6 /* F */],\r\n            [2 /* H */, 116 /* t */, 3 /* HT */],\r\n            [2 /* H */, 84 /* T */, 3 /* HT */],\r\n            [3 /* HT */, 116 /* t */, 4 /* HTT */],\r\n            [3 /* HT */, 84 /* T */, 4 /* HTT */],\r\n            [4 /* HTT */, 112 /* p */, 5 /* HTTP */],\r\n            [4 /* HTT */, 80 /* P */, 5 /* HTTP */],\r\n            [5 /* HTTP */, 115 /* s */, 9 /* BeforeColon */],\r\n            [5 /* HTTP */, 83 /* S */, 9 /* BeforeColon */],\r\n            [5 /* HTTP */, 58 /* Colon */, 10 /* AfterColon */],\r\n            [6 /* F */, 105 /* i */, 7 /* FI */],\r\n            [6 /* F */, 73 /* I */, 7 /* FI */],\r\n            [7 /* FI */, 108 /* l */, 8 /* FIL */],\r\n            [7 /* FI */, 76 /* L */, 8 /* FIL */],\r\n            [8 /* FIL */, 101 /* e */, 9 /* BeforeColon */],\r\n            [8 /* FIL */, 69 /* E */, 9 /* BeforeColon */],\r\n            [9 /* BeforeColon */, 58 /* Colon */, 10 /* AfterColon */],\r\n            [10 /* AfterColon */, 47 /* Slash */, 11 /* AlmostThere */],\r\n            [11 /* AlmostThere */, 47 /* Slash */, 12 /* End */],\r\n        ]);\r\n    }\r\n    return _stateMachine;\r\n}\r\nvar _classifier = null;\r\nfunction getClassifier() {\r\n    if (_classifier === null) {\r\n        _classifier = new CharacterClassifier(0 /* None */);\r\n        var FORCE_TERMINATION_CHARACTERS = ' \\t<>\\'\\\"、。｡､，．：；？！＠＃＄％＆＊‘“〈《「『【〔（［｛｢｣｝］）〕】』」》〉”’｀～…';\r\n        for (var i = 0; i < FORCE_TERMINATION_CHARACTERS.length; i++) {\r\n            _classifier.set(FORCE_TERMINATION_CHARACTERS.charCodeAt(i), 1 /* ForceTermination */);\r\n        }\r\n        var CANNOT_END_WITH_CHARACTERS = '.,;';\r\n        for (var i = 0; i < CANNOT_END_WITH_CHARACTERS.length; i++) {\r\n            _classifier.set(CANNOT_END_WITH_CHARACTERS.charCodeAt(i), 2 /* CannotEndIn */);\r\n        }\r\n    }\r\n    return _classifier;\r\n}\r\nvar LinkComputer = /** @class */ (function () {\r\n    function LinkComputer() {\r\n    }\r\n    LinkComputer._createLink = function (classifier, line, lineNumber, linkBeginIndex, linkEndIndex) {\r\n        // Do not allow to end link in certain characters...\r\n        var lastIncludedCharIndex = linkEndIndex - 1;\r\n        do {\r\n            var chCode = line.charCodeAt(lastIncludedCharIndex);\r\n            var chClass = classifier.get(chCode);\r\n            if (chClass !== 2 /* CannotEndIn */) {\r\n                break;\r\n            }\r\n            lastIncludedCharIndex--;\r\n        } while (lastIncludedCharIndex > linkBeginIndex);\r\n        // Handle links enclosed in parens, square brackets and curlys.\r\n        if (linkBeginIndex > 0) {\r\n            var charCodeBeforeLink = line.charCodeAt(linkBeginIndex - 1);\r\n            var lastCharCodeInLink = line.charCodeAt(lastIncludedCharIndex);\r\n            if ((charCodeBeforeLink === 40 /* OpenParen */ && lastCharCodeInLink === 41 /* CloseParen */)\r\n                || (charCodeBeforeLink === 91 /* OpenSquareBracket */ && lastCharCodeInLink === 93 /* CloseSquareBracket */)\r\n                || (charCodeBeforeLink === 123 /* OpenCurlyBrace */ && lastCharCodeInLink === 125 /* CloseCurlyBrace */)) {\r\n                // Do not end in ) if ( is before the link start\r\n                // Do not end in ] if [ is before the link start\r\n                // Do not end in } if { is before the link start\r\n                lastIncludedCharIndex--;\r\n            }\r\n        }\r\n        return {\r\n            range: {\r\n                startLineNumber: lineNumber,\r\n                startColumn: linkBeginIndex + 1,\r\n                endLineNumber: lineNumber,\r\n                endColumn: lastIncludedCharIndex + 2\r\n            },\r\n            url: line.substring(linkBeginIndex, lastIncludedCharIndex + 1)\r\n        };\r\n    };\r\n    LinkComputer.computeLinks = function (model) {\r\n        var stateMachine = getStateMachine();\r\n        var classifier = getClassifier();\r\n        var result = [];\r\n        for (var i = 1, lineCount = model.getLineCount(); i <= lineCount; i++) {\r\n            var line = model.getLineContent(i);\r\n            var len = line.length;\r\n            var j = 0;\r\n            var linkBeginIndex = 0;\r\n            var linkBeginChCode = 0;\r\n            var state = 1 /* Start */;\r\n            var hasOpenParens = false;\r\n            var hasOpenSquareBracket = false;\r\n            var hasOpenCurlyBracket = false;\r\n            while (j < len) {\r\n                var resetStateMachine = false;\r\n                var chCode = line.charCodeAt(j);\r\n                if (state === 13 /* Accept */) {\r\n                    var chClass = void 0;\r\n                    switch (chCode) {\r\n                        case 40 /* OpenParen */:\r\n                            hasOpenParens = true;\r\n                            chClass = 0 /* None */;\r\n                            break;\r\n                        case 41 /* CloseParen */:\r\n                            chClass = (hasOpenParens ? 0 /* None */ : 1 /* ForceTermination */);\r\n                            break;\r\n                        case 91 /* OpenSquareBracket */:\r\n                            hasOpenSquareBracket = true;\r\n                            chClass = 0 /* None */;\r\n                            break;\r\n                        case 93 /* CloseSquareBracket */:\r\n                            chClass = (hasOpenSquareBracket ? 0 /* None */ : 1 /* ForceTermination */);\r\n                            break;\r\n                        case 123 /* OpenCurlyBrace */:\r\n                            hasOpenCurlyBracket = true;\r\n                            chClass = 0 /* None */;\r\n                            break;\r\n                        case 125 /* CloseCurlyBrace */:\r\n                            chClass = (hasOpenCurlyBracket ? 0 /* None */ : 1 /* ForceTermination */);\r\n                            break;\r\n                        /* The following three rules make it that ' or \" or ` are allowed inside links if the link began with a different one */\r\n                        case 39 /* SingleQuote */:\r\n                            chClass = (linkBeginChCode === 34 /* DoubleQuote */ || linkBeginChCode === 96 /* BackTick */) ? 0 /* None */ : 1 /* ForceTermination */;\r\n                            break;\r\n                        case 34 /* DoubleQuote */:\r\n                            chClass = (linkBeginChCode === 39 /* SingleQuote */ || linkBeginChCode === 96 /* BackTick */) ? 0 /* None */ : 1 /* ForceTermination */;\r\n                            break;\r\n                        case 96 /* BackTick */:\r\n                            chClass = (linkBeginChCode === 39 /* SingleQuote */ || linkBeginChCode === 34 /* DoubleQuote */) ? 0 /* None */ : 1 /* ForceTermination */;\r\n                            break;\r\n                        default:\r\n                            chClass = classifier.get(chCode);\r\n                    }\r\n                    // Check if character terminates link\r\n                    if (chClass === 1 /* ForceTermination */) {\r\n                        result.push(LinkComputer._createLink(classifier, line, i, linkBeginIndex, j));\r\n                        resetStateMachine = true;\r\n                    }\r\n                }\r\n                else if (state === 12 /* End */) {\r\n                    var chClass = classifier.get(chCode);\r\n                    // Check if character terminates link\r\n                    if (chClass === 1 /* ForceTermination */) {\r\n                        resetStateMachine = true;\r\n                    }\r\n                    else {\r\n                        state = 13 /* Accept */;\r\n                    }\r\n                }\r\n                else {\r\n                    state = stateMachine.nextState(state, chCode);\r\n                    if (state === 0 /* Invalid */) {\r\n                        resetStateMachine = true;\r\n                    }\r\n                }\r\n                if (resetStateMachine) {\r\n                    state = 1 /* Start */;\r\n                    hasOpenParens = false;\r\n                    hasOpenSquareBracket = false;\r\n                    hasOpenCurlyBracket = false;\r\n                    // Record where the link started\r\n                    linkBeginIndex = j + 1;\r\n                    linkBeginChCode = chCode;\r\n                }\r\n                j++;\r\n            }\r\n            if (state === 13 /* Accept */) {\r\n                result.push(LinkComputer._createLink(classifier, line, i, linkBeginIndex, len));\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    return LinkComputer;\r\n}());\r\n/**\r\n * Returns an array of all links contains in the provided\r\n * document. *Note* that this operation is computational\r\n * expensive and should not run in the UI thread.\r\n */\r\nexport function computeLinks(model) {\r\n    if (!model || typeof model.getLineCount !== 'function' || typeof model.getLineContent !== 'function') {\r\n        // Unknown caller!\r\n        return [];\r\n    }\r\n    return LinkComputer.computeLinks(model);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar BasicInplaceReplace = /** @class */ (function () {\r\n    function BasicInplaceReplace() {\r\n        this._defaultValueSet = [\r\n            ['true', 'false'],\r\n            ['True', 'False'],\r\n            ['Private', 'Public', 'Friend', 'ReadOnly', 'Partial', 'Protected', 'WriteOnly'],\r\n            ['public', 'protected', 'private'],\r\n        ];\r\n    }\r\n    BasicInplaceReplace.prototype.navigateValueSet = function (range1, text1, range2, text2, up) {\r\n        if (range1 && text1) {\r\n            var result = this.doNavigateValueSet(text1, up);\r\n            if (result) {\r\n                return {\r\n                    range: range1,\r\n                    value: result\r\n                };\r\n            }\r\n        }\r\n        if (range2 && text2) {\r\n            var result = this.doNavigateValueSet(text2, up);\r\n            if (result) {\r\n                return {\r\n                    range: range2,\r\n                    value: result\r\n                };\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    BasicInplaceReplace.prototype.doNavigateValueSet = function (text, up) {\r\n        var numberResult = this.numberReplace(text, up);\r\n        if (numberResult !== null) {\r\n            return numberResult;\r\n        }\r\n        return this.textReplace(text, up);\r\n    };\r\n    BasicInplaceReplace.prototype.numberReplace = function (value, up) {\r\n        var precision = Math.pow(10, value.length - (value.lastIndexOf('.') + 1));\r\n        var n1 = Number(value);\r\n        var n2 = parseFloat(value);\r\n        if (!isNaN(n1) && !isNaN(n2) && n1 === n2) {\r\n            if (n1 === 0 && !up) {\r\n                return null; // don't do negative\r\n                //\t\t\t} else if(n1 === 9 && up) {\r\n                //\t\t\t\treturn null; // don't insert 10 into a number\r\n            }\r\n            else {\r\n                n1 = Math.floor(n1 * precision);\r\n                n1 += up ? precision : -precision;\r\n                return String(n1 / precision);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    BasicInplaceReplace.prototype.textReplace = function (value, up) {\r\n        return this.valueSetsReplace(this._defaultValueSet, value, up);\r\n    };\r\n    BasicInplaceReplace.prototype.valueSetsReplace = function (valueSets, value, up) {\r\n        var result = null;\r\n        for (var i = 0, len = valueSets.length; result === null && i < len; i++) {\r\n            result = this.valueSetReplace(valueSets[i], value, up);\r\n        }\r\n        return result;\r\n    };\r\n    BasicInplaceReplace.prototype.valueSetReplace = function (valueSet, value, up) {\r\n        var idx = valueSet.indexOf(value);\r\n        if (idx >= 0) {\r\n            idx += up ? +1 : -1;\r\n            if (idx < 0) {\r\n                idx = valueSet.length - 1;\r\n            }\r\n            else {\r\n                idx %= valueSet.length;\r\n            }\r\n            return valueSet[idx];\r\n        }\r\n        return null;\r\n    };\r\n    BasicInplaceReplace.INSTANCE = new BasicInplaceReplace();\r\n    return BasicInplaceReplace;\r\n}());\r\nexport { BasicInplaceReplace };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { mergeSort } from '../../../base/common/arrays.js';\r\nimport { stringDiff } from '../../../base/common/diff/diff.js';\r\nimport { FIN } from '../../../base/common/iterator.js';\r\nimport { globals } from '../../../base/common/platform.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nimport { DiffComputer } from '../diff/diffComputer.js';\r\nimport { MirrorTextModel as BaseMirrorModel } from '../model/mirrorTextModel.js';\r\nimport { ensureValidWordDefinition, getWordAtText } from '../model/wordHelper.js';\r\nimport { computeLinks } from '../modes/linkComputer.js';\r\nimport { BasicInplaceReplace } from '../modes/supports/inplaceReplaceSupport.js';\r\nimport { createMonacoBaseAPI } from '../standalone/standaloneBase.js';\r\n/**\r\n * @internal\r\n */\r\nvar MirrorModel = /** @class */ (function (_super) {\r\n    __extends(MirrorModel, _super);\r\n    function MirrorModel() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Object.defineProperty(MirrorModel.prototype, \"uri\", {\r\n        get: function () {\r\n            return this._uri;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MirrorModel.prototype, \"version\", {\r\n        get: function () {\r\n            return this._versionId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MirrorModel.prototype, \"eol\", {\r\n        get: function () {\r\n            return this._eol;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MirrorModel.prototype.getValue = function () {\r\n        return this.getText();\r\n    };\r\n    MirrorModel.prototype.getLinesContent = function () {\r\n        return this._lines.slice(0);\r\n    };\r\n    MirrorModel.prototype.getLineCount = function () {\r\n        return this._lines.length;\r\n    };\r\n    MirrorModel.prototype.getLineContent = function (lineNumber) {\r\n        return this._lines[lineNumber - 1];\r\n    };\r\n    MirrorModel.prototype.getWordAtPosition = function (position, wordDefinition) {\r\n        var wordAtText = getWordAtText(position.column, ensureValidWordDefinition(wordDefinition), this._lines[position.lineNumber - 1], 0);\r\n        if (wordAtText) {\r\n            return new Range(position.lineNumber, wordAtText.startColumn, position.lineNumber, wordAtText.endColumn);\r\n        }\r\n        return null;\r\n    };\r\n    MirrorModel.prototype.getWordUntilPosition = function (position, wordDefinition) {\r\n        var wordAtPosition = this.getWordAtPosition(position, wordDefinition);\r\n        if (!wordAtPosition) {\r\n            return {\r\n                word: '',\r\n                startColumn: position.column,\r\n                endColumn: position.column\r\n            };\r\n        }\r\n        return {\r\n            word: this._lines[position.lineNumber - 1].substring(wordAtPosition.startColumn - 1, position.column - 1),\r\n            startColumn: wordAtPosition.startColumn,\r\n            endColumn: position.column\r\n        };\r\n    };\r\n    MirrorModel.prototype.createWordIterator = function (wordDefinition) {\r\n        var _this = this;\r\n        var obj;\r\n        var lineNumber = 0;\r\n        var lineText;\r\n        var wordRangesIdx = 0;\r\n        var wordRanges = [];\r\n        var next = function () {\r\n            if (wordRangesIdx < wordRanges.length) {\r\n                var value = lineText.substring(wordRanges[wordRangesIdx].start, wordRanges[wordRangesIdx].end);\r\n                wordRangesIdx += 1;\r\n                if (!obj) {\r\n                    obj = { done: false, value: value };\r\n                }\r\n                else {\r\n                    obj.value = value;\r\n                }\r\n                return obj;\r\n            }\r\n            else if (lineNumber >= _this._lines.length) {\r\n                return FIN;\r\n            }\r\n            else {\r\n                lineText = _this._lines[lineNumber];\r\n                wordRanges = _this._wordenize(lineText, wordDefinition);\r\n                wordRangesIdx = 0;\r\n                lineNumber += 1;\r\n                return next();\r\n            }\r\n        };\r\n        return { next: next };\r\n    };\r\n    MirrorModel.prototype.getLineWords = function (lineNumber, wordDefinition) {\r\n        var content = this._lines[lineNumber - 1];\r\n        var ranges = this._wordenize(content, wordDefinition);\r\n        var words = [];\r\n        for (var _i = 0, ranges_1 = ranges; _i < ranges_1.length; _i++) {\r\n            var range = ranges_1[_i];\r\n            words.push({\r\n                word: content.substring(range.start, range.end),\r\n                startColumn: range.start + 1,\r\n                endColumn: range.end + 1\r\n            });\r\n        }\r\n        return words;\r\n    };\r\n    MirrorModel.prototype._wordenize = function (content, wordDefinition) {\r\n        var result = [];\r\n        var match;\r\n        wordDefinition.lastIndex = 0; // reset lastIndex just to be sure\r\n        while (match = wordDefinition.exec(content)) {\r\n            if (match[0].length === 0) {\r\n                // it did match the empty string\r\n                break;\r\n            }\r\n            result.push({ start: match.index, end: match.index + match[0].length });\r\n        }\r\n        return result;\r\n    };\r\n    MirrorModel.prototype.getValueInRange = function (range) {\r\n        range = this._validateRange(range);\r\n        if (range.startLineNumber === range.endLineNumber) {\r\n            return this._lines[range.startLineNumber - 1].substring(range.startColumn - 1, range.endColumn - 1);\r\n        }\r\n        var lineEnding = this._eol;\r\n        var startLineIndex = range.startLineNumber - 1;\r\n        var endLineIndex = range.endLineNumber - 1;\r\n        var resultLines = [];\r\n        resultLines.push(this._lines[startLineIndex].substring(range.startColumn - 1));\r\n        for (var i = startLineIndex + 1; i < endLineIndex; i++) {\r\n            resultLines.push(this._lines[i]);\r\n        }\r\n        resultLines.push(this._lines[endLineIndex].substring(0, range.endColumn - 1));\r\n        return resultLines.join(lineEnding);\r\n    };\r\n    MirrorModel.prototype.offsetAt = function (position) {\r\n        position = this._validatePosition(position);\r\n        this._ensureLineStarts();\r\n        return this._lineStarts.getAccumulatedValue(position.lineNumber - 2) + (position.column - 1);\r\n    };\r\n    MirrorModel.prototype.positionAt = function (offset) {\r\n        offset = Math.floor(offset);\r\n        offset = Math.max(0, offset);\r\n        this._ensureLineStarts();\r\n        var out = this._lineStarts.getIndexOf(offset);\r\n        var lineLength = this._lines[out.index].length;\r\n        // Ensure we return a valid position\r\n        return {\r\n            lineNumber: 1 + out.index,\r\n            column: 1 + Math.min(out.remainder, lineLength)\r\n        };\r\n    };\r\n    MirrorModel.prototype._validateRange = function (range) {\r\n        var start = this._validatePosition({ lineNumber: range.startLineNumber, column: range.startColumn });\r\n        var end = this._validatePosition({ lineNumber: range.endLineNumber, column: range.endColumn });\r\n        if (start.lineNumber !== range.startLineNumber\r\n            || start.column !== range.startColumn\r\n            || end.lineNumber !== range.endLineNumber\r\n            || end.column !== range.endColumn) {\r\n            return {\r\n                startLineNumber: start.lineNumber,\r\n                startColumn: start.column,\r\n                endLineNumber: end.lineNumber,\r\n                endColumn: end.column\r\n            };\r\n        }\r\n        return range;\r\n    };\r\n    MirrorModel.prototype._validatePosition = function (position) {\r\n        if (!Position.isIPosition(position)) {\r\n            throw new Error('bad position');\r\n        }\r\n        var lineNumber = position.lineNumber, column = position.column;\r\n        var hasChanged = false;\r\n        if (lineNumber < 1) {\r\n            lineNumber = 1;\r\n            column = 1;\r\n            hasChanged = true;\r\n        }\r\n        else if (lineNumber > this._lines.length) {\r\n            lineNumber = this._lines.length;\r\n            column = this._lines[lineNumber - 1].length + 1;\r\n            hasChanged = true;\r\n        }\r\n        else {\r\n            var maxCharacter = this._lines[lineNumber - 1].length + 1;\r\n            if (column < 1) {\r\n                column = 1;\r\n                hasChanged = true;\r\n            }\r\n            else if (column > maxCharacter) {\r\n                column = maxCharacter;\r\n                hasChanged = true;\r\n            }\r\n        }\r\n        if (!hasChanged) {\r\n            return position;\r\n        }\r\n        else {\r\n            return { lineNumber: lineNumber, column: column };\r\n        }\r\n    };\r\n    return MirrorModel;\r\n}(BaseMirrorModel));\r\n/**\r\n * @internal\r\n */\r\nvar BaseEditorSimpleWorker = /** @class */ (function () {\r\n    function BaseEditorSimpleWorker(foreignModuleFactory) {\r\n        this._foreignModuleFactory = foreignModuleFactory;\r\n        this._foreignModule = null;\r\n    }\r\n    // ---- BEGIN diff --------------------------------------------------------------------------\r\n    BaseEditorSimpleWorker.prototype.computeDiff = function (originalUrl, modifiedUrl, ignoreTrimWhitespace) {\r\n        var original = this._getModel(originalUrl);\r\n        var modified = this._getModel(modifiedUrl);\r\n        if (!original || !modified) {\r\n            return Promise.resolve(null);\r\n        }\r\n        var originalLines = original.getLinesContent();\r\n        var modifiedLines = modified.getLinesContent();\r\n        var diffComputer = new DiffComputer(originalLines, modifiedLines, {\r\n            shouldComputeCharChanges: true,\r\n            shouldPostProcessCharChanges: true,\r\n            shouldIgnoreTrimWhitespace: ignoreTrimWhitespace,\r\n            shouldMakePrettyDiff: true\r\n        });\r\n        var changes = diffComputer.computeDiff();\r\n        var identical = (changes.length > 0 ? false : this._modelsAreIdentical(original, modified));\r\n        return Promise.resolve({\r\n            identical: identical,\r\n            changes: changes\r\n        });\r\n    };\r\n    BaseEditorSimpleWorker.prototype._modelsAreIdentical = function (original, modified) {\r\n        var originalLineCount = original.getLineCount();\r\n        var modifiedLineCount = modified.getLineCount();\r\n        if (originalLineCount !== modifiedLineCount) {\r\n            return false;\r\n        }\r\n        for (var line = 1; line <= originalLineCount; line++) {\r\n            var originalLine = original.getLineContent(line);\r\n            var modifiedLine = modified.getLineContent(line);\r\n            if (originalLine !== modifiedLine) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    BaseEditorSimpleWorker.prototype.computeMoreMinimalEdits = function (modelUrl, edits) {\r\n        var model = this._getModel(modelUrl);\r\n        if (!model) {\r\n            return Promise.resolve(edits);\r\n        }\r\n        var result = [];\r\n        var lastEol = undefined;\r\n        edits = mergeSort(edits, function (a, b) {\r\n            if (a.range && b.range) {\r\n                return Range.compareRangesUsingStarts(a.range, b.range);\r\n            }\r\n            // eol only changes should go to the end\r\n            var aRng = a.range ? 0 : 1;\r\n            var bRng = b.range ? 0 : 1;\r\n            return aRng - bRng;\r\n        });\r\n        for (var _i = 0, edits_1 = edits; _i < edits_1.length; _i++) {\r\n            var _a = edits_1[_i], range = _a.range, text = _a.text, eol = _a.eol;\r\n            if (typeof eol === 'number') {\r\n                lastEol = eol;\r\n            }\r\n            if (!range) {\r\n                // eol-change only\r\n                continue;\r\n            }\r\n            var original = model.getValueInRange(range);\r\n            text = text.replace(/\\r\\n|\\n|\\r/g, model.eol);\r\n            if (original === text) {\r\n                // noop\r\n                continue;\r\n            }\r\n            // make sure diff won't take too long\r\n            if (Math.max(text.length, original.length) > BaseEditorSimpleWorker._diffLimit) {\r\n                result.push({ range: range, text: text });\r\n                continue;\r\n            }\r\n            // compute diff between original and edit.text\r\n            var changes = stringDiff(original, text, false);\r\n            var editOffset = model.offsetAt(Range.lift(range).getStartPosition());\r\n            for (var _b = 0, changes_1 = changes; _b < changes_1.length; _b++) {\r\n                var change = changes_1[_b];\r\n                var start = model.positionAt(editOffset + change.originalStart);\r\n                var end = model.positionAt(editOffset + change.originalStart + change.originalLength);\r\n                var newEdit = {\r\n                    text: text.substr(change.modifiedStart, change.modifiedLength),\r\n                    range: { startLineNumber: start.lineNumber, startColumn: start.column, endLineNumber: end.lineNumber, endColumn: end.column }\r\n                };\r\n                if (model.getValueInRange(newEdit.range) !== newEdit.text) {\r\n                    result.push(newEdit);\r\n                }\r\n            }\r\n        }\r\n        if (typeof lastEol === 'number') {\r\n            result.push({ eol: lastEol, text: undefined, range: undefined });\r\n        }\r\n        return Promise.resolve(result);\r\n    };\r\n    // ---- END minimal edits ---------------------------------------------------------------\r\n    BaseEditorSimpleWorker.prototype.computeLinks = function (modelUrl) {\r\n        var model = this._getModel(modelUrl);\r\n        if (!model) {\r\n            return Promise.resolve(null);\r\n        }\r\n        return Promise.resolve(computeLinks(model));\r\n    };\r\n    BaseEditorSimpleWorker.prototype.textualSuggest = function (modelUrl, position, wordDef, wordDefFlags) {\r\n        var model = this._getModel(modelUrl);\r\n        if (!model) {\r\n            return Promise.resolve(null);\r\n        }\r\n        var suggestions = [];\r\n        var wordDefRegExp = new RegExp(wordDef, wordDefFlags);\r\n        var currentWord = model.getWordUntilPosition(position, wordDefRegExp);\r\n        var seen = Object.create(null);\r\n        seen[currentWord.word] = true;\r\n        for (var iter = model.createWordIterator(wordDefRegExp), e = iter.next(); !e.done && suggestions.length <= BaseEditorSimpleWorker._suggestionsLimit; e = iter.next()) {\r\n            var word = e.value;\r\n            if (seen[word]) {\r\n                continue;\r\n            }\r\n            seen[word] = true;\r\n            if (!isNaN(Number(word))) {\r\n                continue;\r\n            }\r\n            suggestions.push({\r\n                kind: 18 /* Text */,\r\n                label: word,\r\n                insertText: word,\r\n                range: { startLineNumber: position.lineNumber, startColumn: currentWord.startColumn, endLineNumber: position.lineNumber, endColumn: currentWord.endColumn }\r\n            });\r\n        }\r\n        return Promise.resolve({ suggestions: suggestions });\r\n    };\r\n    // ---- END suggest --------------------------------------------------------------------------\r\n    //#region -- word ranges --\r\n    BaseEditorSimpleWorker.prototype.computeWordRanges = function (modelUrl, range, wordDef, wordDefFlags) {\r\n        var model = this._getModel(modelUrl);\r\n        if (!model) {\r\n            return Promise.resolve(Object.create(null));\r\n        }\r\n        var wordDefRegExp = new RegExp(wordDef, wordDefFlags);\r\n        var result = Object.create(null);\r\n        for (var line = range.startLineNumber; line < range.endLineNumber; line++) {\r\n            var words = model.getLineWords(line, wordDefRegExp);\r\n            for (var _i = 0, words_1 = words; _i < words_1.length; _i++) {\r\n                var word = words_1[_i];\r\n                if (!isNaN(Number(word.word))) {\r\n                    continue;\r\n                }\r\n                var array = result[word.word];\r\n                if (!array) {\r\n                    array = [];\r\n                    result[word.word] = array;\r\n                }\r\n                array.push({\r\n                    startLineNumber: line,\r\n                    startColumn: word.startColumn,\r\n                    endLineNumber: line,\r\n                    endColumn: word.endColumn\r\n                });\r\n            }\r\n        }\r\n        return Promise.resolve(result);\r\n    };\r\n    //#endregion\r\n    BaseEditorSimpleWorker.prototype.navigateValueSet = function (modelUrl, range, up, wordDef, wordDefFlags) {\r\n        var model = this._getModel(modelUrl);\r\n        if (!model) {\r\n            return Promise.resolve(null);\r\n        }\r\n        var wordDefRegExp = new RegExp(wordDef, wordDefFlags);\r\n        if (range.startColumn === range.endColumn) {\r\n            range = {\r\n                startLineNumber: range.startLineNumber,\r\n                startColumn: range.startColumn,\r\n                endLineNumber: range.endLineNumber,\r\n                endColumn: range.endColumn + 1\r\n            };\r\n        }\r\n        var selectionText = model.getValueInRange(range);\r\n        var wordRange = model.getWordAtPosition({ lineNumber: range.startLineNumber, column: range.startColumn }, wordDefRegExp);\r\n        if (!wordRange) {\r\n            return Promise.resolve(null);\r\n        }\r\n        var word = model.getValueInRange(wordRange);\r\n        var result = BasicInplaceReplace.INSTANCE.navigateValueSet(range, selectionText, wordRange, word, up);\r\n        return Promise.resolve(result);\r\n    };\r\n    // ---- BEGIN foreign module support --------------------------------------------------------------------------\r\n    BaseEditorSimpleWorker.prototype.loadForeignModule = function (moduleId, createData) {\r\n        var _this = this;\r\n        var ctx = {\r\n            getMirrorModels: function () {\r\n                return _this._getModels();\r\n            }\r\n        };\r\n        if (this._foreignModuleFactory) {\r\n            this._foreignModule = this._foreignModuleFactory(ctx, createData);\r\n            // static foreing module\r\n            var methods = [];\r\n            for (var prop in this._foreignModule) {\r\n                if (typeof this._foreignModule[prop] === 'function') {\r\n                    methods.push(prop);\r\n                }\r\n            }\r\n            return Promise.resolve(methods);\r\n        }\r\n        // ESM-comment-begin\r\n        // \t\treturn new Promise<any>((resolve, reject) => {\r\n        // \t\t\trequire([moduleId], (foreignModule: { create: IForeignModuleFactory }) => {\r\n        // \t\t\t\tthis._foreignModule = foreignModule.create(ctx, createData);\r\n        // \r\n        // \t\t\t\tlet methods: string[] = [];\r\n        // \t\t\t\tfor (let prop in this._foreignModule) {\r\n        // \t\t\t\t\tif (typeof this._foreignModule[prop] === 'function') {\r\n        // \t\t\t\t\t\tmethods.push(prop);\r\n        // \t\t\t\t\t}\r\n        // \t\t\t\t}\r\n        // \r\n        // \t\t\t\tresolve(methods);\r\n        // \r\n        // \t\t\t}, reject);\r\n        // \t\t});\r\n        // ESM-comment-end\r\n        // ESM-uncomment-begin\r\n        return Promise.reject(new Error(\"Unexpected usage\"));\r\n        // ESM-uncomment-end\r\n    };\r\n    // foreign method request\r\n    BaseEditorSimpleWorker.prototype.fmr = function (method, args) {\r\n        if (!this._foreignModule || typeof this._foreignModule[method] !== 'function') {\r\n            return Promise.reject(new Error('Missing requestHandler or method: ' + method));\r\n        }\r\n        try {\r\n            return Promise.resolve(this._foreignModule[method].apply(this._foreignModule, args));\r\n        }\r\n        catch (e) {\r\n            return Promise.reject(e);\r\n        }\r\n    };\r\n    // ---- END diff --------------------------------------------------------------------------\r\n    // ---- BEGIN minimal edits ---------------------------------------------------------------\r\n    BaseEditorSimpleWorker._diffLimit = 10000;\r\n    // ---- BEGIN suggest --------------------------------------------------------------------------\r\n    BaseEditorSimpleWorker._suggestionsLimit = 10000;\r\n    return BaseEditorSimpleWorker;\r\n}());\r\nexport { BaseEditorSimpleWorker };\r\n/**\r\n * @internal\r\n */\r\nvar EditorSimpleWorkerImpl = /** @class */ (function (_super) {\r\n    __extends(EditorSimpleWorkerImpl, _super);\r\n    function EditorSimpleWorkerImpl(foreignModuleFactory) {\r\n        var _this = _super.call(this, foreignModuleFactory) || this;\r\n        _this._models = Object.create(null);\r\n        return _this;\r\n    }\r\n    EditorSimpleWorkerImpl.prototype.dispose = function () {\r\n        this._models = Object.create(null);\r\n    };\r\n    EditorSimpleWorkerImpl.prototype._getModel = function (uri) {\r\n        return this._models[uri];\r\n    };\r\n    EditorSimpleWorkerImpl.prototype._getModels = function () {\r\n        var _this = this;\r\n        var all = [];\r\n        Object.keys(this._models).forEach(function (key) { return all.push(_this._models[key]); });\r\n        return all;\r\n    };\r\n    EditorSimpleWorkerImpl.prototype.acceptNewModel = function (data) {\r\n        this._models[data.url] = new MirrorModel(URI.parse(data.url), data.lines, data.EOL, data.versionId);\r\n    };\r\n    EditorSimpleWorkerImpl.prototype.acceptModelChanged = function (strURL, e) {\r\n        if (!this._models[strURL]) {\r\n            return;\r\n        }\r\n        var model = this._models[strURL];\r\n        model.onEvents(e);\r\n    };\r\n    EditorSimpleWorkerImpl.prototype.acceptRemovedModel = function (strURL) {\r\n        if (!this._models[strURL]) {\r\n            return;\r\n        }\r\n        delete this._models[strURL];\r\n    };\r\n    return EditorSimpleWorkerImpl;\r\n}(BaseEditorSimpleWorker));\r\nexport { EditorSimpleWorkerImpl };\r\n/**\r\n * Called on the worker side\r\n * @internal\r\n */\r\nexport function create() {\r\n    return new EditorSimpleWorkerImpl(null);\r\n}\r\nif (typeof importScripts === 'function') {\r\n    // Running in a web worker\r\n    globals.monaco = createMonacoBaseAPI();\r\n}\r\n","import { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nexport var ITextResourceConfigurationService = createDecorator('textResourceConfigurationService');\r\nexport var ITextResourcePropertiesService = createDecorator('textResourcePropertiesService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { IntervalTimer } from '../../../base/common/async.js';\r\nimport { Disposable, dispose, toDisposable } from '../../../base/common/lifecycle.js';\r\nimport { SimpleWorkerClient, logOnceWebWorkerWarning } from '../../../base/common/worker/simpleWorker.js';\r\nimport { DefaultWorkerFactory } from '../../../base/worker/defaultWorkerFactory.js';\r\nimport * as modes from '../modes.js';\r\nimport { LanguageConfigurationRegistry } from '../modes/languageConfigurationRegistry.js';\r\nimport { EditorSimpleWorkerImpl } from './editorSimpleWorker.js';\r\nimport { IModelService } from './modelService.js';\r\nimport { ITextResourceConfigurationService } from './resourceConfiguration.js';\r\n/**\r\n * Stop syncing a model to the worker if it was not needed for 1 min.\r\n */\r\nvar STOP_SYNC_MODEL_DELTA_TIME_MS = 60 * 1000;\r\n/**\r\n * Stop the worker if it was not needed for 5 min.\r\n */\r\nvar STOP_WORKER_DELTA_TIME_MS = 5 * 60 * 1000;\r\nfunction canSyncModel(modelService, resource) {\r\n    var model = modelService.getModel(resource);\r\n    if (!model) {\r\n        return false;\r\n    }\r\n    if (model.isTooLargeForSyncing()) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nvar EditorWorkerServiceImpl = /** @class */ (function (_super) {\r\n    __extends(EditorWorkerServiceImpl, _super);\r\n    function EditorWorkerServiceImpl(modelService, configurationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._modelService = modelService;\r\n        _this._workerManager = _this._register(new WorkerManager(_this._modelService));\r\n        // todo@joh make sure this happens only once\r\n        _this._register(modes.LinkProviderRegistry.register('*', {\r\n            provideLinks: function (model, token) {\r\n                if (!canSyncModel(_this._modelService, model.uri)) {\r\n                    return Promise.resolve([]); // File too large\r\n                }\r\n                return _this._workerManager.withWorker().then(function (client) { return client.computeLinks(model.uri); });\r\n            }\r\n        }));\r\n        _this._register(modes.CompletionProviderRegistry.register('*', new WordBasedCompletionItemProvider(_this._workerManager, configurationService, _this._modelService)));\r\n        return _this;\r\n    }\r\n    EditorWorkerServiceImpl.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    EditorWorkerServiceImpl.prototype.canComputeDiff = function (original, modified) {\r\n        return (canSyncModel(this._modelService, original) && canSyncModel(this._modelService, modified));\r\n    };\r\n    EditorWorkerServiceImpl.prototype.computeDiff = function (original, modified, ignoreTrimWhitespace) {\r\n        return this._workerManager.withWorker().then(function (client) { return client.computeDiff(original, modified, ignoreTrimWhitespace); });\r\n    };\r\n    EditorWorkerServiceImpl.prototype.computeMoreMinimalEdits = function (resource, edits) {\r\n        if (!Array.isArray(edits) || edits.length === 0) {\r\n            return Promise.resolve(edits);\r\n        }\r\n        else {\r\n            if (!canSyncModel(this._modelService, resource)) {\r\n                return Promise.resolve(edits); // File too large\r\n            }\r\n            return this._workerManager.withWorker().then(function (client) { return client.computeMoreMinimalEdits(resource, edits); });\r\n        }\r\n    };\r\n    EditorWorkerServiceImpl.prototype.canNavigateValueSet = function (resource) {\r\n        return (canSyncModel(this._modelService, resource));\r\n    };\r\n    EditorWorkerServiceImpl.prototype.navigateValueSet = function (resource, range, up) {\r\n        return this._workerManager.withWorker().then(function (client) { return client.navigateValueSet(resource, range, up); });\r\n    };\r\n    EditorWorkerServiceImpl.prototype.canComputeWordRanges = function (resource) {\r\n        return canSyncModel(this._modelService, resource);\r\n    };\r\n    EditorWorkerServiceImpl.prototype.computeWordRanges = function (resource, range) {\r\n        return this._workerManager.withWorker().then(function (client) { return client.computeWordRanges(resource, range); });\r\n    };\r\n    EditorWorkerServiceImpl = __decorate([\r\n        __param(0, IModelService),\r\n        __param(1, ITextResourceConfigurationService)\r\n    ], EditorWorkerServiceImpl);\r\n    return EditorWorkerServiceImpl;\r\n}(Disposable));\r\nexport { EditorWorkerServiceImpl };\r\nvar WordBasedCompletionItemProvider = /** @class */ (function () {\r\n    function WordBasedCompletionItemProvider(workerManager, configurationService, modelService) {\r\n        this._workerManager = workerManager;\r\n        this._configurationService = configurationService;\r\n        this._modelService = modelService;\r\n    }\r\n    WordBasedCompletionItemProvider.prototype.provideCompletionItems = function (model, position) {\r\n        var wordBasedSuggestions = this._configurationService.getValue(model.uri, position, 'editor').wordBasedSuggestions;\r\n        if (!wordBasedSuggestions) {\r\n            return undefined;\r\n        }\r\n        if (!canSyncModel(this._modelService, model.uri)) {\r\n            return undefined; // File too large\r\n        }\r\n        return this._workerManager.withWorker().then(function (client) { return client.textualSuggest(model.uri, position); });\r\n    };\r\n    return WordBasedCompletionItemProvider;\r\n}());\r\nvar WorkerManager = /** @class */ (function (_super) {\r\n    __extends(WorkerManager, _super);\r\n    function WorkerManager(modelService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._modelService = modelService;\r\n        _this._editorWorkerClient = null;\r\n        var stopWorkerInterval = _this._register(new IntervalTimer());\r\n        stopWorkerInterval.cancelAndSet(function () { return _this._checkStopIdleWorker(); }, Math.round(STOP_WORKER_DELTA_TIME_MS / 2));\r\n        _this._register(_this._modelService.onModelRemoved(function (_) { return _this._checkStopEmptyWorker(); }));\r\n        return _this;\r\n    }\r\n    WorkerManager.prototype.dispose = function () {\r\n        if (this._editorWorkerClient) {\r\n            this._editorWorkerClient.dispose();\r\n            this._editorWorkerClient = null;\r\n        }\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    /**\r\n     * Check if the model service has no more models and stop the worker if that is the case.\r\n     */\r\n    WorkerManager.prototype._checkStopEmptyWorker = function () {\r\n        if (!this._editorWorkerClient) {\r\n            return;\r\n        }\r\n        var models = this._modelService.getModels();\r\n        if (models.length === 0) {\r\n            // There are no more models => nothing possible for me to do\r\n            this._editorWorkerClient.dispose();\r\n            this._editorWorkerClient = null;\r\n        }\r\n    };\r\n    /**\r\n     * Check if the worker has been idle for a while and then stop it.\r\n     */\r\n    WorkerManager.prototype._checkStopIdleWorker = function () {\r\n        if (!this._editorWorkerClient) {\r\n            return;\r\n        }\r\n        var timeSinceLastWorkerUsedTime = (new Date()).getTime() - this._lastWorkerUsedTime;\r\n        if (timeSinceLastWorkerUsedTime > STOP_WORKER_DELTA_TIME_MS) {\r\n            this._editorWorkerClient.dispose();\r\n            this._editorWorkerClient = null;\r\n        }\r\n    };\r\n    WorkerManager.prototype.withWorker = function () {\r\n        this._lastWorkerUsedTime = (new Date()).getTime();\r\n        if (!this._editorWorkerClient) {\r\n            this._editorWorkerClient = new EditorWorkerClient(this._modelService, 'editorWorkerService');\r\n        }\r\n        return Promise.resolve(this._editorWorkerClient);\r\n    };\r\n    return WorkerManager;\r\n}(Disposable));\r\nvar EditorModelManager = /** @class */ (function (_super) {\r\n    __extends(EditorModelManager, _super);\r\n    function EditorModelManager(proxy, modelService, keepIdleModels) {\r\n        var _this = _super.call(this) || this;\r\n        _this._syncedModels = Object.create(null);\r\n        _this._syncedModelsLastUsedTime = Object.create(null);\r\n        _this._proxy = proxy;\r\n        _this._modelService = modelService;\r\n        if (!keepIdleModels) {\r\n            var timer = new IntervalTimer();\r\n            timer.cancelAndSet(function () { return _this._checkStopModelSync(); }, Math.round(STOP_SYNC_MODEL_DELTA_TIME_MS / 2));\r\n            _this._register(timer);\r\n        }\r\n        return _this;\r\n    }\r\n    EditorModelManager.prototype.dispose = function () {\r\n        for (var modelUrl in this._syncedModels) {\r\n            dispose(this._syncedModels[modelUrl]);\r\n        }\r\n        this._syncedModels = Object.create(null);\r\n        this._syncedModelsLastUsedTime = Object.create(null);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    EditorModelManager.prototype.esureSyncedResources = function (resources) {\r\n        for (var i = 0; i < resources.length; i++) {\r\n            var resource = resources[i];\r\n            var resourceStr = resource.toString();\r\n            if (!this._syncedModels[resourceStr]) {\r\n                this._beginModelSync(resource);\r\n            }\r\n            if (this._syncedModels[resourceStr]) {\r\n                this._syncedModelsLastUsedTime[resourceStr] = (new Date()).getTime();\r\n            }\r\n        }\r\n    };\r\n    EditorModelManager.prototype._checkStopModelSync = function () {\r\n        var currentTime = (new Date()).getTime();\r\n        var toRemove = [];\r\n        for (var modelUrl in this._syncedModelsLastUsedTime) {\r\n            var elapsedTime = currentTime - this._syncedModelsLastUsedTime[modelUrl];\r\n            if (elapsedTime > STOP_SYNC_MODEL_DELTA_TIME_MS) {\r\n                toRemove.push(modelUrl);\r\n            }\r\n        }\r\n        for (var i = 0; i < toRemove.length; i++) {\r\n            this._stopModelSync(toRemove[i]);\r\n        }\r\n    };\r\n    EditorModelManager.prototype._beginModelSync = function (resource) {\r\n        var _this = this;\r\n        var model = this._modelService.getModel(resource);\r\n        if (!model) {\r\n            return;\r\n        }\r\n        if (model.isTooLargeForSyncing()) {\r\n            return;\r\n        }\r\n        var modelUrl = resource.toString();\r\n        this._proxy.acceptNewModel({\r\n            url: model.uri.toString(),\r\n            lines: model.getLinesContent(),\r\n            EOL: model.getEOL(),\r\n            versionId: model.getVersionId()\r\n        });\r\n        var toDispose = [];\r\n        toDispose.push(model.onDidChangeContent(function (e) {\r\n            _this._proxy.acceptModelChanged(modelUrl.toString(), e);\r\n        }));\r\n        toDispose.push(model.onWillDispose(function () {\r\n            _this._stopModelSync(modelUrl);\r\n        }));\r\n        toDispose.push(toDisposable(function () {\r\n            _this._proxy.acceptRemovedModel(modelUrl);\r\n        }));\r\n        this._syncedModels[modelUrl] = toDispose;\r\n    };\r\n    EditorModelManager.prototype._stopModelSync = function (modelUrl) {\r\n        var toDispose = this._syncedModels[modelUrl];\r\n        delete this._syncedModels[modelUrl];\r\n        delete this._syncedModelsLastUsedTime[modelUrl];\r\n        dispose(toDispose);\r\n    };\r\n    return EditorModelManager;\r\n}(Disposable));\r\nvar SynchronousWorkerClient = /** @class */ (function () {\r\n    function SynchronousWorkerClient(instance) {\r\n        this._instance = instance;\r\n        this._proxyObj = Promise.resolve(this._instance);\r\n    }\r\n    SynchronousWorkerClient.prototype.dispose = function () {\r\n        this._instance.dispose();\r\n    };\r\n    SynchronousWorkerClient.prototype.getProxyObject = function () {\r\n        return this._proxyObj;\r\n    };\r\n    return SynchronousWorkerClient;\r\n}());\r\nvar EditorWorkerClient = /** @class */ (function (_super) {\r\n    __extends(EditorWorkerClient, _super);\r\n    function EditorWorkerClient(modelService, label) {\r\n        var _this = _super.call(this) || this;\r\n        _this._modelService = modelService;\r\n        _this._workerFactory = new DefaultWorkerFactory(label);\r\n        _this._worker = null;\r\n        _this._modelManager = null;\r\n        return _this;\r\n    }\r\n    EditorWorkerClient.prototype._getOrCreateWorker = function () {\r\n        if (!this._worker) {\r\n            try {\r\n                this._worker = this._register(new SimpleWorkerClient(this._workerFactory, 'vs/editor/common/services/editorSimpleWorker'));\r\n            }\r\n            catch (err) {\r\n                logOnceWebWorkerWarning(err);\r\n                this._worker = new SynchronousWorkerClient(new EditorSimpleWorkerImpl(null));\r\n            }\r\n        }\r\n        return this._worker;\r\n    };\r\n    EditorWorkerClient.prototype._getProxy = function () {\r\n        var _this = this;\r\n        return this._getOrCreateWorker().getProxyObject().then(null, function (err) {\r\n            logOnceWebWorkerWarning(err);\r\n            _this._worker = new SynchronousWorkerClient(new EditorSimpleWorkerImpl(null));\r\n            return _this._getOrCreateWorker().getProxyObject();\r\n        });\r\n    };\r\n    EditorWorkerClient.prototype._getOrCreateModelManager = function (proxy) {\r\n        if (!this._modelManager) {\r\n            this._modelManager = this._register(new EditorModelManager(proxy, this._modelService, false));\r\n        }\r\n        return this._modelManager;\r\n    };\r\n    EditorWorkerClient.prototype._withSyncedResources = function (resources) {\r\n        var _this = this;\r\n        return this._getProxy().then(function (proxy) {\r\n            _this._getOrCreateModelManager(proxy).esureSyncedResources(resources);\r\n            return proxy;\r\n        });\r\n    };\r\n    EditorWorkerClient.prototype.computeDiff = function (original, modified, ignoreTrimWhitespace) {\r\n        return this._withSyncedResources([original, modified]).then(function (proxy) {\r\n            return proxy.computeDiff(original.toString(), modified.toString(), ignoreTrimWhitespace);\r\n        });\r\n    };\r\n    EditorWorkerClient.prototype.computeMoreMinimalEdits = function (resource, edits) {\r\n        return this._withSyncedResources([resource]).then(function (proxy) {\r\n            return proxy.computeMoreMinimalEdits(resource.toString(), edits);\r\n        });\r\n    };\r\n    EditorWorkerClient.prototype.computeLinks = function (resource) {\r\n        return this._withSyncedResources([resource]).then(function (proxy) {\r\n            return proxy.computeLinks(resource.toString());\r\n        });\r\n    };\r\n    EditorWorkerClient.prototype.textualSuggest = function (resource, position) {\r\n        var _this = this;\r\n        return this._withSyncedResources([resource]).then(function (proxy) {\r\n            var model = _this._modelService.getModel(resource);\r\n            if (!model) {\r\n                return null;\r\n            }\r\n            var wordDefRegExp = LanguageConfigurationRegistry.getWordDefinition(model.getLanguageIdentifier().id);\r\n            var wordDef = wordDefRegExp.source;\r\n            var wordDefFlags = (wordDefRegExp.global ? 'g' : '') + (wordDefRegExp.ignoreCase ? 'i' : '') + (wordDefRegExp.multiline ? 'm' : '');\r\n            return proxy.textualSuggest(resource.toString(), position, wordDef, wordDefFlags);\r\n        });\r\n    };\r\n    EditorWorkerClient.prototype.computeWordRanges = function (resource, range) {\r\n        var _this = this;\r\n        return this._withSyncedResources([resource]).then(function (proxy) {\r\n            var model = _this._modelService.getModel(resource);\r\n            if (!model) {\r\n                return Promise.resolve(null);\r\n            }\r\n            var wordDefRegExp = LanguageConfigurationRegistry.getWordDefinition(model.getLanguageIdentifier().id);\r\n            var wordDef = wordDefRegExp.source;\r\n            var wordDefFlags = (wordDefRegExp.global ? 'g' : '') + (wordDefRegExp.ignoreCase ? 'i' : '') + (wordDefRegExp.multiline ? 'm' : '');\r\n            return proxy.computeWordRanges(resource.toString(), range, wordDef, wordDefFlags);\r\n        });\r\n    };\r\n    EditorWorkerClient.prototype.navigateValueSet = function (resource, range, up) {\r\n        var _this = this;\r\n        return this._withSyncedResources([resource]).then(function (proxy) {\r\n            var model = _this._modelService.getModel(resource);\r\n            if (!model) {\r\n                return null;\r\n            }\r\n            var wordDefRegExp = LanguageConfigurationRegistry.getWordDefinition(model.getLanguageIdentifier().id);\r\n            var wordDef = wordDefRegExp.source;\r\n            var wordDefFlags = (wordDefRegExp.global ? 'g' : '') + (wordDefRegExp.ignoreCase ? 'i' : '') + (wordDefRegExp.multiline ? 'm' : '');\r\n            return proxy.navigateValueSet(resource.toString(), range, up, wordDef, wordDefFlags);\r\n        });\r\n    };\r\n    return EditorWorkerClient;\r\n}(Disposable));\r\nexport { EditorWorkerClient };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { EditorWorkerClient } from './editorWorkerServiceImpl.js';\r\n/**\r\n * Create a new web worker that has model syncing capabilities built in.\r\n * Specify an AMD module to load that will `create` an object that will be proxied.\r\n */\r\nexport function createWebWorker(modelService, opts) {\r\n    return new MonacoWebWorkerImpl(modelService, opts);\r\n}\r\nvar MonacoWebWorkerImpl = /** @class */ (function (_super) {\r\n    __extends(MonacoWebWorkerImpl, _super);\r\n    function MonacoWebWorkerImpl(modelService, opts) {\r\n        var _this = _super.call(this, modelService, opts.label) || this;\r\n        _this._foreignModuleId = opts.moduleId;\r\n        _this._foreignModuleCreateData = opts.createData || null;\r\n        _this._foreignProxy = null;\r\n        return _this;\r\n    }\r\n    MonacoWebWorkerImpl.prototype._getForeignProxy = function () {\r\n        var _this = this;\r\n        if (!this._foreignProxy) {\r\n            this._foreignProxy = this._getProxy().then(function (proxy) {\r\n                return proxy.loadForeignModule(_this._foreignModuleId, _this._foreignModuleCreateData).then(function (foreignMethods) {\r\n                    _this._foreignModuleCreateData = null;\r\n                    var proxyMethodRequest = function (method, args) {\r\n                        return proxy.fmr(method, args);\r\n                    };\r\n                    var createProxyMethod = function (method, proxyMethodRequest) {\r\n                        return function () {\r\n                            var args = Array.prototype.slice.call(arguments, 0);\r\n                            return proxyMethodRequest(method, args);\r\n                        };\r\n                    };\r\n                    var foreignProxy = {};\r\n                    for (var i = 0; i < foreignMethods.length; i++) {\r\n                        foreignProxy[foreignMethods[i]] = createProxyMethod(foreignMethods[i], proxyMethodRequest);\r\n                    }\r\n                    return foreignProxy;\r\n                });\r\n            });\r\n        }\r\n        return this._foreignProxy;\r\n    };\r\n    MonacoWebWorkerImpl.prototype.getProxy = function () {\r\n        return this._getForeignProxy();\r\n    };\r\n    MonacoWebWorkerImpl.prototype.withSyncedResources = function (resources) {\r\n        var _this = this;\r\n        return this._withSyncedResources(resources).then(function (_) { return _this.getProxy(); });\r\n    };\r\n    return MonacoWebWorkerImpl;\r\n}(EditorWorkerClient));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { TokenMetadata } from '../modes.js';\r\nvar LineTokens = /** @class */ (function () {\r\n    function LineTokens(tokens, text) {\r\n        this._tokens = tokens;\r\n        this._tokensCount = (this._tokens.length >>> 1);\r\n        this._text = text;\r\n    }\r\n    LineTokens.prototype.equals = function (other) {\r\n        if (other instanceof LineTokens) {\r\n            return this.slicedEquals(other, 0, this._tokensCount);\r\n        }\r\n        return false;\r\n    };\r\n    LineTokens.prototype.slicedEquals = function (other, sliceFromTokenIndex, sliceTokenCount) {\r\n        if (this._text !== other._text) {\r\n            return false;\r\n        }\r\n        if (this._tokensCount !== other._tokensCount) {\r\n            return false;\r\n        }\r\n        var from = (sliceFromTokenIndex << 1);\r\n        var to = from + (sliceTokenCount << 1);\r\n        for (var i = from; i < to; i++) {\r\n            if (this._tokens[i] !== other._tokens[i]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    LineTokens.prototype.getLineContent = function () {\r\n        return this._text;\r\n    };\r\n    LineTokens.prototype.getCount = function () {\r\n        return this._tokensCount;\r\n    };\r\n    LineTokens.prototype.getStartOffset = function (tokenIndex) {\r\n        if (tokenIndex > 0) {\r\n            return this._tokens[(tokenIndex - 1) << 1];\r\n        }\r\n        return 0;\r\n    };\r\n    LineTokens.prototype.getLanguageId = function (tokenIndex) {\r\n        var metadata = this._tokens[(tokenIndex << 1) + 1];\r\n        return TokenMetadata.getLanguageId(metadata);\r\n    };\r\n    LineTokens.prototype.getStandardTokenType = function (tokenIndex) {\r\n        var metadata = this._tokens[(tokenIndex << 1) + 1];\r\n        return TokenMetadata.getTokenType(metadata);\r\n    };\r\n    LineTokens.prototype.getForeground = function (tokenIndex) {\r\n        var metadata = this._tokens[(tokenIndex << 1) + 1];\r\n        return TokenMetadata.getForeground(metadata);\r\n    };\r\n    LineTokens.prototype.getClassName = function (tokenIndex) {\r\n        var metadata = this._tokens[(tokenIndex << 1) + 1];\r\n        return TokenMetadata.getClassNameFromMetadata(metadata);\r\n    };\r\n    LineTokens.prototype.getInlineStyle = function (tokenIndex, colorMap) {\r\n        var metadata = this._tokens[(tokenIndex << 1) + 1];\r\n        return TokenMetadata.getInlineStyleFromMetadata(metadata, colorMap);\r\n    };\r\n    LineTokens.prototype.getEndOffset = function (tokenIndex) {\r\n        return this._tokens[tokenIndex << 1];\r\n    };\r\n    /**\r\n     * Find the token containing offset `offset`.\r\n     * @param offset The search offset\r\n     * @return The index of the token containing the offset.\r\n     */\r\n    LineTokens.prototype.findTokenIndexAtOffset = function (offset) {\r\n        return LineTokens.findIndexInTokensArray(this._tokens, offset);\r\n    };\r\n    LineTokens.prototype.inflate = function () {\r\n        return this;\r\n    };\r\n    LineTokens.prototype.sliceAndInflate = function (startOffset, endOffset, deltaOffset) {\r\n        return new SlicedLineTokens(this, startOffset, endOffset, deltaOffset);\r\n    };\r\n    LineTokens.convertToEndOffset = function (tokens, lineTextLength) {\r\n        var tokenCount = (tokens.length >>> 1);\r\n        var lastTokenIndex = tokenCount - 1;\r\n        for (var tokenIndex = 0; tokenIndex < lastTokenIndex; tokenIndex++) {\r\n            tokens[tokenIndex << 1] = tokens[(tokenIndex + 1) << 1];\r\n        }\r\n        tokens[lastTokenIndex << 1] = lineTextLength;\r\n    };\r\n    LineTokens.findIndexInTokensArray = function (tokens, desiredIndex) {\r\n        if (tokens.length <= 2) {\r\n            return 0;\r\n        }\r\n        var low = 0;\r\n        var high = (tokens.length >>> 1) - 1;\r\n        while (low < high) {\r\n            var mid = low + Math.floor((high - low) / 2);\r\n            var endOffset = tokens[(mid << 1)];\r\n            if (endOffset === desiredIndex) {\r\n                return mid + 1;\r\n            }\r\n            else if (endOffset < desiredIndex) {\r\n                low = mid + 1;\r\n            }\r\n            else if (endOffset > desiredIndex) {\r\n                high = mid;\r\n            }\r\n        }\r\n        return low;\r\n    };\r\n    return LineTokens;\r\n}());\r\nexport { LineTokens };\r\nvar SlicedLineTokens = /** @class */ (function () {\r\n    function SlicedLineTokens(source, startOffset, endOffset, deltaOffset) {\r\n        this._source = source;\r\n        this._startOffset = startOffset;\r\n        this._endOffset = endOffset;\r\n        this._deltaOffset = deltaOffset;\r\n        this._firstTokenIndex = source.findTokenIndexAtOffset(startOffset);\r\n        this._tokensCount = 0;\r\n        for (var i = this._firstTokenIndex, len = source.getCount(); i < len; i++) {\r\n            var tokenStartOffset = source.getStartOffset(i);\r\n            if (tokenStartOffset >= endOffset) {\r\n                break;\r\n            }\r\n            this._tokensCount++;\r\n        }\r\n    }\r\n    SlicedLineTokens.prototype.equals = function (other) {\r\n        if (other instanceof SlicedLineTokens) {\r\n            return (this._startOffset === other._startOffset\r\n                && this._endOffset === other._endOffset\r\n                && this._deltaOffset === other._deltaOffset\r\n                && this._source.slicedEquals(other._source, this._firstTokenIndex, this._tokensCount));\r\n        }\r\n        return false;\r\n    };\r\n    SlicedLineTokens.prototype.getCount = function () {\r\n        return this._tokensCount;\r\n    };\r\n    SlicedLineTokens.prototype.getForeground = function (tokenIndex) {\r\n        return this._source.getForeground(this._firstTokenIndex + tokenIndex);\r\n    };\r\n    SlicedLineTokens.prototype.getEndOffset = function (tokenIndex) {\r\n        var tokenEndOffset = this._source.getEndOffset(this._firstTokenIndex + tokenIndex);\r\n        return Math.min(this._endOffset, tokenEndOffset) - this._startOffset + this._deltaOffset;\r\n    };\r\n    SlicedLineTokens.prototype.getClassName = function (tokenIndex) {\r\n        return this._source.getClassName(this._firstTokenIndex + tokenIndex);\r\n    };\r\n    SlicedLineTokens.prototype.getInlineStyle = function (tokenIndex, colorMap) {\r\n        return this._source.getInlineStyle(this._firstTokenIndex + tokenIndex, colorMap);\r\n    };\r\n    SlicedLineTokens.prototype.findTokenIndexAtOffset = function (offset) {\r\n        return this._source.findTokenIndexAtOffset(offset + this._startOffset - this._deltaOffset) - this._firstTokenIndex;\r\n    };\r\n    return SlicedLineTokens;\r\n}());\r\nexport { SlicedLineTokens };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nexport var createStringBuilder;\r\nif (typeof TextDecoder !== 'undefined') {\r\n    createStringBuilder = function (capacity) { return new StringBuilder(capacity); };\r\n}\r\nelse {\r\n    createStringBuilder = function (capacity) { return new CompatStringBuilder(); };\r\n}\r\nvar StringBuilder = /** @class */ (function () {\r\n    function StringBuilder(capacity) {\r\n        this._decoder = new TextDecoder('UTF-16LE');\r\n        this._capacity = capacity | 0;\r\n        this._buffer = new Uint16Array(this._capacity);\r\n        this._completedStrings = null;\r\n        this._bufferLength = 0;\r\n    }\r\n    StringBuilder.prototype.reset = function () {\r\n        this._completedStrings = null;\r\n        this._bufferLength = 0;\r\n    };\r\n    StringBuilder.prototype.build = function () {\r\n        if (this._completedStrings !== null) {\r\n            this._flushBuffer();\r\n            return this._completedStrings.join('');\r\n        }\r\n        return this._buildBuffer();\r\n    };\r\n    StringBuilder.prototype._buildBuffer = function () {\r\n        if (this._bufferLength === 0) {\r\n            return '';\r\n        }\r\n        var view = new Uint16Array(this._buffer.buffer, 0, this._bufferLength);\r\n        return this._decoder.decode(view);\r\n    };\r\n    StringBuilder.prototype._flushBuffer = function () {\r\n        var bufferString = this._buildBuffer();\r\n        this._bufferLength = 0;\r\n        if (this._completedStrings === null) {\r\n            this._completedStrings = [bufferString];\r\n        }\r\n        else {\r\n            this._completedStrings[this._completedStrings.length] = bufferString;\r\n        }\r\n    };\r\n    StringBuilder.prototype.write1 = function (charCode) {\r\n        var remainingSpace = this._capacity - this._bufferLength;\r\n        if (remainingSpace <= 1) {\r\n            if (remainingSpace === 0 || strings.isHighSurrogate(charCode)) {\r\n                this._flushBuffer();\r\n            }\r\n        }\r\n        this._buffer[this._bufferLength++] = charCode;\r\n    };\r\n    StringBuilder.prototype.appendASCII = function (charCode) {\r\n        if (this._bufferLength === this._capacity) {\r\n            // buffer is full\r\n            this._flushBuffer();\r\n        }\r\n        this._buffer[this._bufferLength++] = charCode;\r\n    };\r\n    StringBuilder.prototype.appendASCIIString = function (str) {\r\n        var strLen = str.length;\r\n        if (this._bufferLength + strLen >= this._capacity) {\r\n            // This string does not fit in the remaining buffer space\r\n            this._flushBuffer();\r\n            this._completedStrings[this._completedStrings.length] = str;\r\n            return;\r\n        }\r\n        for (var i = 0; i < strLen; i++) {\r\n            this._buffer[this._bufferLength++] = str.charCodeAt(i);\r\n        }\r\n    };\r\n    return StringBuilder;\r\n}());\r\nvar CompatStringBuilder = /** @class */ (function () {\r\n    function CompatStringBuilder() {\r\n        this._pieces = [];\r\n        this._piecesLen = 0;\r\n    }\r\n    CompatStringBuilder.prototype.reset = function () {\r\n        this._pieces = [];\r\n        this._piecesLen = 0;\r\n    };\r\n    CompatStringBuilder.prototype.build = function () {\r\n        return this._pieces.join('');\r\n    };\r\n    CompatStringBuilder.prototype.write1 = function (charCode) {\r\n        this._pieces[this._piecesLen++] = String.fromCharCode(charCode);\r\n    };\r\n    CompatStringBuilder.prototype.appendASCII = function (charCode) {\r\n        this._pieces[this._piecesLen++] = String.fromCharCode(charCode);\r\n    };\r\n    CompatStringBuilder.prototype.appendASCIIString = function (str) {\r\n        this._pieces[this._piecesLen++] = str;\r\n    };\r\n    return CompatStringBuilder;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nvar LineDecoration = /** @class */ (function () {\r\n    function LineDecoration(startColumn, endColumn, className, type) {\r\n        this.startColumn = startColumn;\r\n        this.endColumn = endColumn;\r\n        this.className = className;\r\n        this.type = type;\r\n    }\r\n    LineDecoration._equals = function (a, b) {\r\n        return (a.startColumn === b.startColumn\r\n            && a.endColumn === b.endColumn\r\n            && a.className === b.className\r\n            && a.type === b.type);\r\n    };\r\n    LineDecoration.equalsArr = function (a, b) {\r\n        var aLen = a.length;\r\n        var bLen = b.length;\r\n        if (aLen !== bLen) {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < aLen; i++) {\r\n            if (!LineDecoration._equals(a[i], b[i])) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    LineDecoration.filter = function (lineDecorations, lineNumber, minLineColumn, maxLineColumn) {\r\n        if (lineDecorations.length === 0) {\r\n            return [];\r\n        }\r\n        var result = [], resultLen = 0;\r\n        for (var i = 0, len = lineDecorations.length; i < len; i++) {\r\n            var d = lineDecorations[i];\r\n            var range = d.range;\r\n            if (range.endLineNumber < lineNumber || range.startLineNumber > lineNumber) {\r\n                // Ignore decorations that sit outside this line\r\n                continue;\r\n            }\r\n            if (range.isEmpty() && (d.type === 0 /* Regular */ || d.type === 3 /* RegularAffectingLetterSpacing */)) {\r\n                // Ignore empty range decorations\r\n                continue;\r\n            }\r\n            var startColumn = (range.startLineNumber === lineNumber ? range.startColumn : minLineColumn);\r\n            var endColumn = (range.endLineNumber === lineNumber ? range.endColumn : maxLineColumn);\r\n            result[resultLen++] = new LineDecoration(startColumn, endColumn, d.inlineClassName, d.type);\r\n        }\r\n        return result;\r\n    };\r\n    LineDecoration.compare = function (a, b) {\r\n        if (a.startColumn === b.startColumn) {\r\n            if (a.endColumn === b.endColumn) {\r\n                if (a.className < b.className) {\r\n                    return -1;\r\n                }\r\n                if (a.className > b.className) {\r\n                    return 1;\r\n                }\r\n                return 0;\r\n            }\r\n            return a.endColumn - b.endColumn;\r\n        }\r\n        return a.startColumn - b.startColumn;\r\n    };\r\n    return LineDecoration;\r\n}());\r\nexport { LineDecoration };\r\nvar DecorationSegment = /** @class */ (function () {\r\n    function DecorationSegment(startOffset, endOffset, className) {\r\n        this.startOffset = startOffset;\r\n        this.endOffset = endOffset;\r\n        this.className = className;\r\n    }\r\n    return DecorationSegment;\r\n}());\r\nexport { DecorationSegment };\r\nvar Stack = /** @class */ (function () {\r\n    function Stack() {\r\n        this.stopOffsets = [];\r\n        this.classNames = [];\r\n        this.count = 0;\r\n    }\r\n    Stack.prototype.consumeLowerThan = function (maxStopOffset, nextStartOffset, result) {\r\n        while (this.count > 0 && this.stopOffsets[0] < maxStopOffset) {\r\n            var i = 0;\r\n            // Take all equal stopping offsets\r\n            while (i + 1 < this.count && this.stopOffsets[i] === this.stopOffsets[i + 1]) {\r\n                i++;\r\n            }\r\n            // Basically we are consuming the first i + 1 elements of the stack\r\n            result.push(new DecorationSegment(nextStartOffset, this.stopOffsets[i], this.classNames.join(' ')));\r\n            nextStartOffset = this.stopOffsets[i] + 1;\r\n            // Consume them\r\n            this.stopOffsets.splice(0, i + 1);\r\n            this.classNames.splice(0, i + 1);\r\n            this.count -= (i + 1);\r\n        }\r\n        if (this.count > 0 && nextStartOffset < maxStopOffset) {\r\n            result.push(new DecorationSegment(nextStartOffset, maxStopOffset - 1, this.classNames.join(' ')));\r\n            nextStartOffset = maxStopOffset;\r\n        }\r\n        return nextStartOffset;\r\n    };\r\n    Stack.prototype.insert = function (stopOffset, className) {\r\n        if (this.count === 0 || this.stopOffsets[this.count - 1] <= stopOffset) {\r\n            // Insert at the end\r\n            this.stopOffsets.push(stopOffset);\r\n            this.classNames.push(className);\r\n        }\r\n        else {\r\n            // Find the insertion position for `stopOffset`\r\n            for (var i = 0; i < this.count; i++) {\r\n                if (this.stopOffsets[i] >= stopOffset) {\r\n                    this.stopOffsets.splice(i, 0, stopOffset);\r\n                    this.classNames.splice(i, 0, className);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        this.count++;\r\n        return;\r\n    };\r\n    return Stack;\r\n}());\r\nvar LineDecorationsNormalizer = /** @class */ (function () {\r\n    function LineDecorationsNormalizer() {\r\n    }\r\n    /**\r\n     * Normalize line decorations. Overlapping decorations will generate multiple segments\r\n     */\r\n    LineDecorationsNormalizer.normalize = function (lineContent, lineDecorations) {\r\n        if (lineDecorations.length === 0) {\r\n            return [];\r\n        }\r\n        var result = [];\r\n        var stack = new Stack();\r\n        var nextStartOffset = 0;\r\n        for (var i = 0, len = lineDecorations.length; i < len; i++) {\r\n            var d = lineDecorations[i];\r\n            var startColumn = d.startColumn;\r\n            var endColumn = d.endColumn;\r\n            var className = d.className;\r\n            // If the position would end up in the middle of a high-low surrogate pair, we move it to before the pair\r\n            if (startColumn > 1) {\r\n                var charCodeBefore = lineContent.charCodeAt(startColumn - 2);\r\n                if (strings.isHighSurrogate(charCodeBefore)) {\r\n                    startColumn--;\r\n                }\r\n            }\r\n            if (endColumn > 1) {\r\n                var charCodeBefore = lineContent.charCodeAt(endColumn - 2);\r\n                if (strings.isHighSurrogate(charCodeBefore)) {\r\n                    endColumn--;\r\n                }\r\n            }\r\n            var currentStartOffset = startColumn - 1;\r\n            var currentEndOffset = endColumn - 2;\r\n            nextStartOffset = stack.consumeLowerThan(currentStartOffset, nextStartOffset, result);\r\n            if (stack.count === 0) {\r\n                nextStartOffset = currentStartOffset;\r\n            }\r\n            stack.insert(currentEndOffset, className);\r\n        }\r\n        stack.consumeLowerThan(1073741824 /* MAX_SAFE_SMALL_INTEGER */, nextStartOffset, result);\r\n        return result;\r\n    };\r\n    return LineDecorationsNormalizer;\r\n}());\r\nexport { LineDecorationsNormalizer };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { createStringBuilder } from '../core/stringBuilder.js';\r\nimport { LineDecoration, LineDecorationsNormalizer } from './lineDecorations.js';\r\nvar LinePart = /** @class */ (function () {\r\n    function LinePart(endIndex, type) {\r\n        this.endIndex = endIndex;\r\n        this.type = type;\r\n    }\r\n    return LinePart;\r\n}());\r\nvar RenderLineInput = /** @class */ (function () {\r\n    function RenderLineInput(useMonospaceOptimizations, canUseHalfwidthRightwardsArrow, lineContent, continuesWithWrappedLine, isBasicASCII, containsRTL, fauxIndentLength, lineTokens, lineDecorations, tabSize, spaceWidth, stopRenderingLineAfter, renderWhitespace, renderControlCharacters, fontLigatures) {\r\n        this.useMonospaceOptimizations = useMonospaceOptimizations;\r\n        this.canUseHalfwidthRightwardsArrow = canUseHalfwidthRightwardsArrow;\r\n        this.lineContent = lineContent;\r\n        this.continuesWithWrappedLine = continuesWithWrappedLine;\r\n        this.isBasicASCII = isBasicASCII;\r\n        this.containsRTL = containsRTL;\r\n        this.fauxIndentLength = fauxIndentLength;\r\n        this.lineTokens = lineTokens;\r\n        this.lineDecorations = lineDecorations;\r\n        this.tabSize = tabSize;\r\n        this.spaceWidth = spaceWidth;\r\n        this.stopRenderingLineAfter = stopRenderingLineAfter;\r\n        this.renderWhitespace = (renderWhitespace === 'all'\r\n            ? 2 /* All */\r\n            : renderWhitespace === 'boundary'\r\n                ? 1 /* Boundary */\r\n                : 0 /* None */);\r\n        this.renderControlCharacters = renderControlCharacters;\r\n        this.fontLigatures = fontLigatures;\r\n    }\r\n    RenderLineInput.prototype.equals = function (other) {\r\n        return (this.useMonospaceOptimizations === other.useMonospaceOptimizations\r\n            && this.canUseHalfwidthRightwardsArrow === other.canUseHalfwidthRightwardsArrow\r\n            && this.lineContent === other.lineContent\r\n            && this.continuesWithWrappedLine === other.continuesWithWrappedLine\r\n            && this.isBasicASCII === other.isBasicASCII\r\n            && this.containsRTL === other.containsRTL\r\n            && this.fauxIndentLength === other.fauxIndentLength\r\n            && this.tabSize === other.tabSize\r\n            && this.spaceWidth === other.spaceWidth\r\n            && this.stopRenderingLineAfter === other.stopRenderingLineAfter\r\n            && this.renderWhitespace === other.renderWhitespace\r\n            && this.renderControlCharacters === other.renderControlCharacters\r\n            && this.fontLigatures === other.fontLigatures\r\n            && LineDecoration.equalsArr(this.lineDecorations, other.lineDecorations)\r\n            && this.lineTokens.equals(other.lineTokens));\r\n    };\r\n    return RenderLineInput;\r\n}());\r\nexport { RenderLineInput };\r\n/**\r\n * Provides a both direction mapping between a line's character and its rendered position.\r\n */\r\nvar CharacterMapping = /** @class */ (function () {\r\n    function CharacterMapping(length, partCount) {\r\n        this.length = length;\r\n        this._data = new Uint32Array(this.length);\r\n        this._absoluteOffsets = new Uint32Array(this.length);\r\n    }\r\n    CharacterMapping.getPartIndex = function (partData) {\r\n        return (partData & 4294901760 /* PART_INDEX_MASK */) >>> 16 /* PART_INDEX_OFFSET */;\r\n    };\r\n    CharacterMapping.getCharIndex = function (partData) {\r\n        return (partData & 65535 /* CHAR_INDEX_MASK */) >>> 0 /* CHAR_INDEX_OFFSET */;\r\n    };\r\n    CharacterMapping.prototype.setPartData = function (charOffset, partIndex, charIndex, partAbsoluteOffset) {\r\n        var partData = ((partIndex << 16 /* PART_INDEX_OFFSET */)\r\n            | (charIndex << 0 /* CHAR_INDEX_OFFSET */)) >>> 0;\r\n        this._data[charOffset] = partData;\r\n        this._absoluteOffsets[charOffset] = partAbsoluteOffset + charIndex;\r\n    };\r\n    CharacterMapping.prototype.getAbsoluteOffsets = function () {\r\n        return this._absoluteOffsets;\r\n    };\r\n    CharacterMapping.prototype.charOffsetToPartData = function (charOffset) {\r\n        if (this.length === 0) {\r\n            return 0;\r\n        }\r\n        if (charOffset < 0) {\r\n            return this._data[0];\r\n        }\r\n        if (charOffset >= this.length) {\r\n            return this._data[this.length - 1];\r\n        }\r\n        return this._data[charOffset];\r\n    };\r\n    CharacterMapping.prototype.partDataToCharOffset = function (partIndex, partLength, charIndex) {\r\n        if (this.length === 0) {\r\n            return 0;\r\n        }\r\n        var searchEntry = ((partIndex << 16 /* PART_INDEX_OFFSET */)\r\n            | (charIndex << 0 /* CHAR_INDEX_OFFSET */)) >>> 0;\r\n        var min = 0;\r\n        var max = this.length - 1;\r\n        while (min + 1 < max) {\r\n            var mid = ((min + max) >>> 1);\r\n            var midEntry = this._data[mid];\r\n            if (midEntry === searchEntry) {\r\n                return mid;\r\n            }\r\n            else if (midEntry > searchEntry) {\r\n                max = mid;\r\n            }\r\n            else {\r\n                min = mid;\r\n            }\r\n        }\r\n        if (min === max) {\r\n            return min;\r\n        }\r\n        var minEntry = this._data[min];\r\n        var maxEntry = this._data[max];\r\n        if (minEntry === searchEntry) {\r\n            return min;\r\n        }\r\n        if (maxEntry === searchEntry) {\r\n            return max;\r\n        }\r\n        var minPartIndex = CharacterMapping.getPartIndex(minEntry);\r\n        var minCharIndex = CharacterMapping.getCharIndex(minEntry);\r\n        var maxPartIndex = CharacterMapping.getPartIndex(maxEntry);\r\n        var maxCharIndex;\r\n        if (minPartIndex !== maxPartIndex) {\r\n            // sitting between parts\r\n            maxCharIndex = partLength;\r\n        }\r\n        else {\r\n            maxCharIndex = CharacterMapping.getCharIndex(maxEntry);\r\n        }\r\n        var minEntryDistance = charIndex - minCharIndex;\r\n        var maxEntryDistance = maxCharIndex - charIndex;\r\n        if (minEntryDistance <= maxEntryDistance) {\r\n            return min;\r\n        }\r\n        return max;\r\n    };\r\n    return CharacterMapping;\r\n}());\r\nexport { CharacterMapping };\r\nvar RenderLineOutput = /** @class */ (function () {\r\n    function RenderLineOutput(characterMapping, containsRTL, containsForeignElements) {\r\n        this.characterMapping = characterMapping;\r\n        this.containsRTL = containsRTL;\r\n        this.containsForeignElements = containsForeignElements;\r\n    }\r\n    return RenderLineOutput;\r\n}());\r\nexport { RenderLineOutput };\r\nexport function renderViewLine(input, sb) {\r\n    if (input.lineContent.length === 0) {\r\n        var containsForeignElements = 0 /* None */;\r\n        // This is basically for IE's hit test to work\r\n        var content = '<span><span>\\u00a0</span></span>';\r\n        if (input.lineDecorations.length > 0) {\r\n            // This line is empty, but it contains inline decorations\r\n            var classNames = [];\r\n            for (var i = 0, len = input.lineDecorations.length; i < len; i++) {\r\n                var lineDecoration = input.lineDecorations[i];\r\n                if (lineDecoration.type === 1 /* Before */) {\r\n                    classNames.push(input.lineDecorations[i].className);\r\n                    containsForeignElements |= 1 /* Before */;\r\n                }\r\n                if (lineDecoration.type === 2 /* After */) {\r\n                    classNames.push(input.lineDecorations[i].className);\r\n                    containsForeignElements |= 2 /* After */;\r\n                }\r\n            }\r\n            if (containsForeignElements !== 0 /* None */) {\r\n                content = \"<span><span class=\\\"\" + classNames.join(' ') + \"\\\"></span></span>\";\r\n            }\r\n        }\r\n        sb.appendASCIIString(content);\r\n        return new RenderLineOutput(new CharacterMapping(0, 0), false, containsForeignElements);\r\n    }\r\n    return _renderLine(resolveRenderLineInput(input), sb);\r\n}\r\nvar RenderLineOutput2 = /** @class */ (function () {\r\n    function RenderLineOutput2(characterMapping, html, containsRTL, containsForeignElements) {\r\n        this.characterMapping = characterMapping;\r\n        this.html = html;\r\n        this.containsRTL = containsRTL;\r\n        this.containsForeignElements = containsForeignElements;\r\n    }\r\n    return RenderLineOutput2;\r\n}());\r\nexport { RenderLineOutput2 };\r\nexport function renderViewLine2(input) {\r\n    var sb = createStringBuilder(10000);\r\n    var out = renderViewLine(input, sb);\r\n    return new RenderLineOutput2(out.characterMapping, sb.build(), out.containsRTL, out.containsForeignElements);\r\n}\r\nvar ResolvedRenderLineInput = /** @class */ (function () {\r\n    function ResolvedRenderLineInput(fontIsMonospace, canUseHalfwidthRightwardsArrow, lineContent, len, isOverflowing, parts, containsForeignElements, tabSize, containsRTL, spaceWidth, renderWhitespace, renderControlCharacters) {\r\n        this.fontIsMonospace = fontIsMonospace;\r\n        this.canUseHalfwidthRightwardsArrow = canUseHalfwidthRightwardsArrow;\r\n        this.lineContent = lineContent;\r\n        this.len = len;\r\n        this.isOverflowing = isOverflowing;\r\n        this.parts = parts;\r\n        this.containsForeignElements = containsForeignElements;\r\n        this.tabSize = tabSize;\r\n        this.containsRTL = containsRTL;\r\n        this.spaceWidth = spaceWidth;\r\n        this.renderWhitespace = renderWhitespace;\r\n        this.renderControlCharacters = renderControlCharacters;\r\n        //\r\n    }\r\n    return ResolvedRenderLineInput;\r\n}());\r\nfunction resolveRenderLineInput(input) {\r\n    var useMonospaceOptimizations = input.useMonospaceOptimizations;\r\n    var lineContent = input.lineContent;\r\n    var isOverflowing;\r\n    var len;\r\n    if (input.stopRenderingLineAfter !== -1 && input.stopRenderingLineAfter < lineContent.length) {\r\n        isOverflowing = true;\r\n        len = input.stopRenderingLineAfter;\r\n    }\r\n    else {\r\n        isOverflowing = false;\r\n        len = lineContent.length;\r\n    }\r\n    var tokens = transformAndRemoveOverflowing(input.lineTokens, input.fauxIndentLength, len);\r\n    if (input.renderWhitespace === 2 /* All */ || input.renderWhitespace === 1 /* Boundary */) {\r\n        tokens = _applyRenderWhitespace(lineContent, len, input.continuesWithWrappedLine, tokens, input.fauxIndentLength, input.tabSize, useMonospaceOptimizations, input.renderWhitespace === 1 /* Boundary */);\r\n    }\r\n    var containsForeignElements = 0 /* None */;\r\n    if (input.lineDecorations.length > 0) {\r\n        for (var i = 0, len_1 = input.lineDecorations.length; i < len_1; i++) {\r\n            var lineDecoration = input.lineDecorations[i];\r\n            if (lineDecoration.type === 3 /* RegularAffectingLetterSpacing */) {\r\n                // Pretend there are foreign elements... although not 100% accurate.\r\n                containsForeignElements |= 1 /* Before */;\r\n            }\r\n            else if (lineDecoration.type === 1 /* Before */) {\r\n                containsForeignElements |= 1 /* Before */;\r\n            }\r\n            else if (lineDecoration.type === 2 /* After */) {\r\n                containsForeignElements |= 2 /* After */;\r\n            }\r\n        }\r\n        tokens = _applyInlineDecorations(lineContent, len, tokens, input.lineDecorations);\r\n    }\r\n    if (!input.containsRTL) {\r\n        // We can never split RTL text, as it ruins the rendering\r\n        tokens = splitLargeTokens(lineContent, tokens, !input.isBasicASCII || input.fontLigatures);\r\n    }\r\n    return new ResolvedRenderLineInput(useMonospaceOptimizations, input.canUseHalfwidthRightwardsArrow, lineContent, len, isOverflowing, tokens, containsForeignElements, input.tabSize, input.containsRTL, input.spaceWidth, input.renderWhitespace, input.renderControlCharacters);\r\n}\r\n/**\r\n * In the rendering phase, characters are always looped until token.endIndex.\r\n * Ensure that all tokens end before `len` and the last one ends precisely at `len`.\r\n */\r\nfunction transformAndRemoveOverflowing(tokens, fauxIndentLength, len) {\r\n    var result = [], resultLen = 0;\r\n    // The faux indent part of the line should have no token type\r\n    if (fauxIndentLength > 0) {\r\n        result[resultLen++] = new LinePart(fauxIndentLength, '');\r\n    }\r\n    for (var tokenIndex = 0, tokensLen = tokens.getCount(); tokenIndex < tokensLen; tokenIndex++) {\r\n        var endIndex = tokens.getEndOffset(tokenIndex);\r\n        if (endIndex <= fauxIndentLength) {\r\n            // The faux indent part of the line should have no token type\r\n            continue;\r\n        }\r\n        var type = tokens.getClassName(tokenIndex);\r\n        if (endIndex >= len) {\r\n            result[resultLen++] = new LinePart(len, type);\r\n            break;\r\n        }\r\n        result[resultLen++] = new LinePart(endIndex, type);\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * See https://github.com/Microsoft/vscode/issues/6885.\r\n * It appears that having very large spans causes very slow reading of character positions.\r\n * So here we try to avoid that.\r\n */\r\nfunction splitLargeTokens(lineContent, tokens, onlyAtSpaces) {\r\n    var lastTokenEndIndex = 0;\r\n    var result = [], resultLen = 0;\r\n    if (onlyAtSpaces) {\r\n        // Split only at spaces => we need to walk each character\r\n        for (var i = 0, len = tokens.length; i < len; i++) {\r\n            var token = tokens[i];\r\n            var tokenEndIndex = token.endIndex;\r\n            if (lastTokenEndIndex + 50 /* LongToken */ < tokenEndIndex) {\r\n                var tokenType = token.type;\r\n                var lastSpaceOffset = -1;\r\n                var currTokenStart = lastTokenEndIndex;\r\n                for (var j = lastTokenEndIndex; j < tokenEndIndex; j++) {\r\n                    if (lineContent.charCodeAt(j) === 32 /* Space */) {\r\n                        lastSpaceOffset = j;\r\n                    }\r\n                    if (lastSpaceOffset !== -1 && j - currTokenStart >= 50 /* LongToken */) {\r\n                        // Split at `lastSpaceOffset` + 1\r\n                        result[resultLen++] = new LinePart(lastSpaceOffset + 1, tokenType);\r\n                        currTokenStart = lastSpaceOffset + 1;\r\n                        lastSpaceOffset = -1;\r\n                    }\r\n                }\r\n                if (currTokenStart !== tokenEndIndex) {\r\n                    result[resultLen++] = new LinePart(tokenEndIndex, tokenType);\r\n                }\r\n            }\r\n            else {\r\n                result[resultLen++] = token;\r\n            }\r\n            lastTokenEndIndex = tokenEndIndex;\r\n        }\r\n    }\r\n    else {\r\n        // Split anywhere => we don't need to walk each character\r\n        for (var i = 0, len = tokens.length; i < len; i++) {\r\n            var token = tokens[i];\r\n            var tokenEndIndex = token.endIndex;\r\n            var diff = (tokenEndIndex - lastTokenEndIndex);\r\n            if (diff > 50 /* LongToken */) {\r\n                var tokenType = token.type;\r\n                var piecesCount = Math.ceil(diff / 50 /* LongToken */);\r\n                for (var j = 1; j < piecesCount; j++) {\r\n                    var pieceEndIndex = lastTokenEndIndex + (j * 50 /* LongToken */);\r\n                    result[resultLen++] = new LinePart(pieceEndIndex, tokenType);\r\n                }\r\n                result[resultLen++] = new LinePart(tokenEndIndex, tokenType);\r\n            }\r\n            else {\r\n                result[resultLen++] = token;\r\n            }\r\n            lastTokenEndIndex = tokenEndIndex;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Whitespace is rendered by \"replacing\" tokens with a special-purpose `vs-whitespace` type that is later recognized in the rendering phase.\r\n * Moreover, a token is created for every visual indent because on some fonts the glyphs used for rendering whitespace (&rarr; or &middot;) do not have the same width as &nbsp;.\r\n * The rendering phase will generate `style=\"width:...\"` for these tokens.\r\n */\r\nfunction _applyRenderWhitespace(lineContent, len, continuesWithWrappedLine, tokens, fauxIndentLength, tabSize, useMonospaceOptimizations, onlyBoundary) {\r\n    var result = [], resultLen = 0;\r\n    var tokenIndex = 0;\r\n    var tokenType = tokens[tokenIndex].type;\r\n    var tokenEndIndex = tokens[tokenIndex].endIndex;\r\n    var tokensLength = tokens.length;\r\n    var firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\r\n    var lastNonWhitespaceIndex;\r\n    if (firstNonWhitespaceIndex === -1) {\r\n        // The entire line is whitespace\r\n        firstNonWhitespaceIndex = len;\r\n        lastNonWhitespaceIndex = len;\r\n    }\r\n    else {\r\n        lastNonWhitespaceIndex = strings.lastNonWhitespaceIndex(lineContent);\r\n    }\r\n    var tmpIndent = 0;\r\n    for (var charIndex = 0; charIndex < fauxIndentLength; charIndex++) {\r\n        var chCode = lineContent.charCodeAt(charIndex);\r\n        if (chCode === 9 /* Tab */) {\r\n            tmpIndent = tabSize;\r\n        }\r\n        else if (strings.isFullWidthCharacter(chCode)) {\r\n            tmpIndent += 2;\r\n        }\r\n        else {\r\n            tmpIndent++;\r\n        }\r\n    }\r\n    tmpIndent = tmpIndent % tabSize;\r\n    var wasInWhitespace = false;\r\n    for (var charIndex = fauxIndentLength; charIndex < len; charIndex++) {\r\n        var chCode = lineContent.charCodeAt(charIndex);\r\n        var isInWhitespace = void 0;\r\n        if (charIndex < firstNonWhitespaceIndex || charIndex > lastNonWhitespaceIndex) {\r\n            // in leading or trailing whitespace\r\n            isInWhitespace = true;\r\n        }\r\n        else if (chCode === 9 /* Tab */) {\r\n            // a tab character is rendered both in all and boundary cases\r\n            isInWhitespace = true;\r\n        }\r\n        else if (chCode === 32 /* Space */) {\r\n            // hit a space character\r\n            if (onlyBoundary) {\r\n                // rendering only boundary whitespace\r\n                if (wasInWhitespace) {\r\n                    isInWhitespace = true;\r\n                }\r\n                else {\r\n                    var nextChCode = (charIndex + 1 < len ? lineContent.charCodeAt(charIndex + 1) : 0 /* Null */);\r\n                    isInWhitespace = (nextChCode === 32 /* Space */ || nextChCode === 9 /* Tab */);\r\n                }\r\n            }\r\n            else {\r\n                isInWhitespace = true;\r\n            }\r\n        }\r\n        else {\r\n            isInWhitespace = false;\r\n        }\r\n        if (wasInWhitespace) {\r\n            // was in whitespace token\r\n            if (!isInWhitespace || (!useMonospaceOptimizations && tmpIndent >= tabSize)) {\r\n                // leaving whitespace token or entering a new indent\r\n                result[resultLen++] = new LinePart(charIndex, 'vs-whitespace');\r\n                tmpIndent = tmpIndent % tabSize;\r\n            }\r\n        }\r\n        else {\r\n            // was in regular token\r\n            if (charIndex === tokenEndIndex || (isInWhitespace && charIndex > fauxIndentLength)) {\r\n                result[resultLen++] = new LinePart(charIndex, tokenType);\r\n                tmpIndent = tmpIndent % tabSize;\r\n            }\r\n        }\r\n        if (chCode === 9 /* Tab */) {\r\n            tmpIndent = tabSize;\r\n        }\r\n        else if (strings.isFullWidthCharacter(chCode)) {\r\n            tmpIndent += 2;\r\n        }\r\n        else {\r\n            tmpIndent++;\r\n        }\r\n        wasInWhitespace = isInWhitespace;\r\n        if (charIndex === tokenEndIndex) {\r\n            tokenIndex++;\r\n            if (tokenIndex < tokensLength) {\r\n                tokenType = tokens[tokenIndex].type;\r\n                tokenEndIndex = tokens[tokenIndex].endIndex;\r\n            }\r\n        }\r\n    }\r\n    var generateWhitespace = false;\r\n    if (wasInWhitespace) {\r\n        // was in whitespace token\r\n        if (continuesWithWrappedLine && onlyBoundary) {\r\n            var lastCharCode = (len > 0 ? lineContent.charCodeAt(len - 1) : 0 /* Null */);\r\n            var prevCharCode = (len > 1 ? lineContent.charCodeAt(len - 2) : 0 /* Null */);\r\n            var isSingleTrailingSpace = (lastCharCode === 32 /* Space */ && (prevCharCode !== 32 /* Space */ && prevCharCode !== 9 /* Tab */));\r\n            if (!isSingleTrailingSpace) {\r\n                generateWhitespace = true;\r\n            }\r\n        }\r\n        else {\r\n            generateWhitespace = true;\r\n        }\r\n    }\r\n    result[resultLen++] = new LinePart(len, generateWhitespace ? 'vs-whitespace' : tokenType);\r\n    return result;\r\n}\r\n/**\r\n * Inline decorations are \"merged\" on top of tokens.\r\n * Special care must be taken when multiple inline decorations are at play and they overlap.\r\n */\r\nfunction _applyInlineDecorations(lineContent, len, tokens, _lineDecorations) {\r\n    _lineDecorations.sort(LineDecoration.compare);\r\n    var lineDecorations = LineDecorationsNormalizer.normalize(lineContent, _lineDecorations);\r\n    var lineDecorationsLen = lineDecorations.length;\r\n    var lineDecorationIndex = 0;\r\n    var result = [], resultLen = 0, lastResultEndIndex = 0;\r\n    for (var tokenIndex = 0, len_2 = tokens.length; tokenIndex < len_2; tokenIndex++) {\r\n        var token = tokens[tokenIndex];\r\n        var tokenEndIndex = token.endIndex;\r\n        var tokenType = token.type;\r\n        while (lineDecorationIndex < lineDecorationsLen && lineDecorations[lineDecorationIndex].startOffset < tokenEndIndex) {\r\n            var lineDecoration = lineDecorations[lineDecorationIndex];\r\n            if (lineDecoration.startOffset > lastResultEndIndex) {\r\n                lastResultEndIndex = lineDecoration.startOffset;\r\n                result[resultLen++] = new LinePart(lastResultEndIndex, tokenType);\r\n            }\r\n            if (lineDecoration.endOffset + 1 <= tokenEndIndex) {\r\n                // This line decoration ends before this token ends\r\n                lastResultEndIndex = lineDecoration.endOffset + 1;\r\n                result[resultLen++] = new LinePart(lastResultEndIndex, tokenType + ' ' + lineDecoration.className);\r\n                lineDecorationIndex++;\r\n            }\r\n            else {\r\n                // This line decoration continues on to the next token\r\n                lastResultEndIndex = tokenEndIndex;\r\n                result[resultLen++] = new LinePart(lastResultEndIndex, tokenType + ' ' + lineDecoration.className);\r\n                break;\r\n            }\r\n        }\r\n        if (tokenEndIndex > lastResultEndIndex) {\r\n            lastResultEndIndex = tokenEndIndex;\r\n            result[resultLen++] = new LinePart(lastResultEndIndex, tokenType);\r\n        }\r\n    }\r\n    var lastTokenEndIndex = tokens[tokens.length - 1].endIndex;\r\n    if (lineDecorationIndex < lineDecorationsLen && lineDecorations[lineDecorationIndex].startOffset === lastTokenEndIndex) {\r\n        var classNames = [];\r\n        while (lineDecorationIndex < lineDecorationsLen && lineDecorations[lineDecorationIndex].startOffset === lastTokenEndIndex) {\r\n            classNames.push(lineDecorations[lineDecorationIndex].className);\r\n            lineDecorationIndex++;\r\n        }\r\n        result[resultLen++] = new LinePart(lastResultEndIndex, classNames.join(' '));\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * This function is on purpose not split up into multiple functions to allow runtime type inference (i.e. performance reasons).\r\n * Notice how all the needed data is fully resolved and passed in (i.e. no other calls).\r\n */\r\nfunction _renderLine(input, sb) {\r\n    var fontIsMonospace = input.fontIsMonospace;\r\n    var canUseHalfwidthRightwardsArrow = input.canUseHalfwidthRightwardsArrow;\r\n    var containsForeignElements = input.containsForeignElements;\r\n    var lineContent = input.lineContent;\r\n    var len = input.len;\r\n    var isOverflowing = input.isOverflowing;\r\n    var parts = input.parts;\r\n    var tabSize = input.tabSize;\r\n    var containsRTL = input.containsRTL;\r\n    var spaceWidth = input.spaceWidth;\r\n    var renderWhitespace = input.renderWhitespace;\r\n    var renderControlCharacters = input.renderControlCharacters;\r\n    var characterMapping = new CharacterMapping(len + 1, parts.length);\r\n    var charIndex = 0;\r\n    var tabsCharDelta = 0;\r\n    var charOffsetInPart = 0;\r\n    var prevPartContentCnt = 0;\r\n    var partAbsoluteOffset = 0;\r\n    sb.appendASCIIString('<span>');\r\n    for (var partIndex = 0, tokensLen = parts.length; partIndex < tokensLen; partIndex++) {\r\n        partAbsoluteOffset += prevPartContentCnt;\r\n        var part = parts[partIndex];\r\n        var partEndIndex = part.endIndex;\r\n        var partType = part.type;\r\n        var partRendersWhitespace = (renderWhitespace !== 0 /* None */ && (partType.indexOf('vs-whitespace') >= 0));\r\n        charOffsetInPart = 0;\r\n        sb.appendASCIIString('<span class=\"');\r\n        sb.appendASCIIString(partType);\r\n        sb.appendASCII(34 /* DoubleQuote */);\r\n        if (partRendersWhitespace) {\r\n            var partContentCnt = 0;\r\n            {\r\n                var _charIndex = charIndex;\r\n                var _tabsCharDelta = tabsCharDelta;\r\n                for (; _charIndex < partEndIndex; _charIndex++) {\r\n                    var charCode = lineContent.charCodeAt(_charIndex);\r\n                    if (charCode === 9 /* Tab */) {\r\n                        var insertSpacesCount = tabSize - (_charIndex + _tabsCharDelta) % tabSize;\r\n                        _tabsCharDelta += insertSpacesCount - 1;\r\n                        partContentCnt += insertSpacesCount;\r\n                    }\r\n                    else {\r\n                        // must be CharCode.Space\r\n                        partContentCnt++;\r\n                    }\r\n                }\r\n            }\r\n            if (!fontIsMonospace) {\r\n                var partIsOnlyWhitespace = (partType === 'vs-whitespace');\r\n                if (partIsOnlyWhitespace || !containsForeignElements) {\r\n                    sb.appendASCIIString(' style=\"width:');\r\n                    sb.appendASCIIString(String(spaceWidth * partContentCnt));\r\n                    sb.appendASCIIString('px\"');\r\n                }\r\n            }\r\n            sb.appendASCII(62 /* GreaterThan */);\r\n            for (; charIndex < partEndIndex; charIndex++) {\r\n                characterMapping.setPartData(charIndex, partIndex, charOffsetInPart, partAbsoluteOffset);\r\n                var charCode = lineContent.charCodeAt(charIndex);\r\n                if (charCode === 9 /* Tab */) {\r\n                    var insertSpacesCount = tabSize - (charIndex + tabsCharDelta) % tabSize;\r\n                    tabsCharDelta += insertSpacesCount - 1;\r\n                    charOffsetInPart += insertSpacesCount - 1;\r\n                    if (insertSpacesCount > 0) {\r\n                        if (!canUseHalfwidthRightwardsArrow || insertSpacesCount > 1) {\r\n                            sb.write1(0x2192); // RIGHTWARDS ARROW\r\n                        }\r\n                        else {\r\n                            sb.write1(0xffeb); // HALFWIDTH RIGHTWARDS ARROW\r\n                        }\r\n                        insertSpacesCount--;\r\n                    }\r\n                    while (insertSpacesCount > 0) {\r\n                        sb.write1(0xA0); // &nbsp;\r\n                        insertSpacesCount--;\r\n                    }\r\n                }\r\n                else {\r\n                    // must be CharCode.Space\r\n                    sb.write1(0xb7); // &middot;\r\n                }\r\n                charOffsetInPart++;\r\n            }\r\n            prevPartContentCnt = partContentCnt;\r\n        }\r\n        else {\r\n            var partContentCnt = 0;\r\n            if (containsRTL) {\r\n                sb.appendASCIIString(' dir=\"ltr\"');\r\n            }\r\n            sb.appendASCII(62 /* GreaterThan */);\r\n            for (; charIndex < partEndIndex; charIndex++) {\r\n                characterMapping.setPartData(charIndex, partIndex, charOffsetInPart, partAbsoluteOffset);\r\n                var charCode = lineContent.charCodeAt(charIndex);\r\n                switch (charCode) {\r\n                    case 9 /* Tab */:\r\n                        var insertSpacesCount = tabSize - (charIndex + tabsCharDelta) % tabSize;\r\n                        tabsCharDelta += insertSpacesCount - 1;\r\n                        charOffsetInPart += insertSpacesCount - 1;\r\n                        while (insertSpacesCount > 0) {\r\n                            sb.write1(0xA0); // &nbsp;\r\n                            partContentCnt++;\r\n                            insertSpacesCount--;\r\n                        }\r\n                        break;\r\n                    case 32 /* Space */:\r\n                        sb.write1(0xA0); // &nbsp;\r\n                        partContentCnt++;\r\n                        break;\r\n                    case 60 /* LessThan */:\r\n                        sb.appendASCIIString('&lt;');\r\n                        partContentCnt++;\r\n                        break;\r\n                    case 62 /* GreaterThan */:\r\n                        sb.appendASCIIString('&gt;');\r\n                        partContentCnt++;\r\n                        break;\r\n                    case 38 /* Ampersand */:\r\n                        sb.appendASCIIString('&amp;');\r\n                        partContentCnt++;\r\n                        break;\r\n                    case 0 /* Null */:\r\n                        sb.appendASCIIString('&#00;');\r\n                        partContentCnt++;\r\n                        break;\r\n                    case 65279 /* UTF8_BOM */:\r\n                    case 8232 /* LINE_SEPARATOR_2028 */:\r\n                        sb.write1(0xfffd);\r\n                        partContentCnt++;\r\n                        break;\r\n                    default:\r\n                        if (strings.isFullWidthCharacter(charCode)) {\r\n                            tabsCharDelta++;\r\n                        }\r\n                        if (renderControlCharacters && charCode < 32) {\r\n                            sb.write1(9216 + charCode);\r\n                            partContentCnt++;\r\n                        }\r\n                        else {\r\n                            sb.write1(charCode);\r\n                            partContentCnt++;\r\n                        }\r\n                }\r\n                charOffsetInPart++;\r\n            }\r\n            prevPartContentCnt = partContentCnt;\r\n        }\r\n        sb.appendASCIIString('</span>');\r\n    }\r\n    // When getting client rects for the last character, we will position the\r\n    // text range at the end of the span, insteaf of at the beginning of next span\r\n    characterMapping.setPartData(len, parts.length - 1, charOffsetInPart, partAbsoluteOffset);\r\n    if (isOverflowing) {\r\n        sb.appendASCIIString('<span>&hellip;</span>');\r\n    }\r\n    sb.appendASCIIString('</span>');\r\n    return new RenderLineOutput(characterMapping, containsRTL, containsForeignElements);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nvar Viewport = /** @class */ (function () {\r\n    function Viewport(top, left, width, height) {\r\n        this.top = top | 0;\r\n        this.left = left | 0;\r\n        this.width = width | 0;\r\n        this.height = height | 0;\r\n    }\r\n    return Viewport;\r\n}());\r\nexport { Viewport };\r\nvar MinimapLinesRenderingData = /** @class */ (function () {\r\n    function MinimapLinesRenderingData(tabSize, data) {\r\n        this.tabSize = tabSize;\r\n        this.data = data;\r\n    }\r\n    return MinimapLinesRenderingData;\r\n}());\r\nexport { MinimapLinesRenderingData };\r\nvar ViewLineData = /** @class */ (function () {\r\n    function ViewLineData(content, continuesWithWrappedLine, minColumn, maxColumn, tokens) {\r\n        this.content = content;\r\n        this.continuesWithWrappedLine = continuesWithWrappedLine;\r\n        this.minColumn = minColumn;\r\n        this.maxColumn = maxColumn;\r\n        this.tokens = tokens;\r\n    }\r\n    return ViewLineData;\r\n}());\r\nexport { ViewLineData };\r\nvar ViewLineRenderingData = /** @class */ (function () {\r\n    function ViewLineRenderingData(minColumn, maxColumn, content, continuesWithWrappedLine, mightContainRTL, mightContainNonBasicASCII, tokens, inlineDecorations, tabSize) {\r\n        this.minColumn = minColumn;\r\n        this.maxColumn = maxColumn;\r\n        this.content = content;\r\n        this.continuesWithWrappedLine = continuesWithWrappedLine;\r\n        this.isBasicASCII = ViewLineRenderingData.isBasicASCII(content, mightContainNonBasicASCII);\r\n        this.containsRTL = ViewLineRenderingData.containsRTL(content, this.isBasicASCII, mightContainRTL);\r\n        this.tokens = tokens;\r\n        this.inlineDecorations = inlineDecorations;\r\n        this.tabSize = tabSize;\r\n    }\r\n    ViewLineRenderingData.isBasicASCII = function (lineContent, mightContainNonBasicASCII) {\r\n        if (mightContainNonBasicASCII) {\r\n            return strings.isBasicASCII(lineContent);\r\n        }\r\n        return true;\r\n    };\r\n    ViewLineRenderingData.containsRTL = function (lineContent, isBasicASCII, mightContainRTL) {\r\n        if (!isBasicASCII && mightContainRTL) {\r\n            return strings.containsRTL(lineContent);\r\n        }\r\n        return false;\r\n    };\r\n    return ViewLineRenderingData;\r\n}());\r\nexport { ViewLineRenderingData };\r\nvar InlineDecoration = /** @class */ (function () {\r\n    function InlineDecoration(range, inlineClassName, type) {\r\n        this.range = range;\r\n        this.inlineClassName = inlineClassName;\r\n        this.type = type;\r\n    }\r\n    return InlineDecoration;\r\n}());\r\nexport { InlineDecoration };\r\nvar ViewModelDecoration = /** @class */ (function () {\r\n    function ViewModelDecoration(range, options) {\r\n        this.range = range;\r\n        this.options = options;\r\n    }\r\n    return ViewModelDecoration;\r\n}());\r\nexport { ViewModelDecoration };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { TimeoutTimer } from '../../../base/common/async.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { LineTokens } from '../../common/core/lineTokens.js';\r\nimport { TokenizationRegistry } from '../../common/modes.js';\r\nimport { RenderLineInput, renderViewLine2 as renderViewLine } from '../../common/viewLayout/viewLineRenderer.js';\r\nimport { ViewLineRenderingData } from '../../common/viewModel/viewModel.js';\r\nvar Colorizer = /** @class */ (function () {\r\n    function Colorizer() {\r\n    }\r\n    Colorizer.colorizeElement = function (themeService, modeService, domNode, options) {\r\n        options = options || {};\r\n        var theme = options.theme || 'vs';\r\n        var mimeType = options.mimeType || domNode.getAttribute('lang') || domNode.getAttribute('data-lang');\r\n        if (!mimeType) {\r\n            console.error('Mode not detected');\r\n            return Promise.resolve();\r\n        }\r\n        themeService.setTheme(theme);\r\n        var text = domNode.firstChild ? domNode.firstChild.nodeValue : '';\r\n        domNode.className += ' ' + theme;\r\n        var render = function (str) {\r\n            domNode.innerHTML = str;\r\n        };\r\n        return this.colorize(modeService, text || '', mimeType, options).then(render, function (err) { return console.error(err); });\r\n    };\r\n    Colorizer.colorize = function (modeService, text, mimeType, options) {\r\n        var tabSize = 4;\r\n        if (options && typeof options.tabSize === 'number') {\r\n            tabSize = options.tabSize;\r\n        }\r\n        if (strings.startsWithUTF8BOM(text)) {\r\n            text = text.substr(1);\r\n        }\r\n        var lines = text.split(/\\r\\n|\\r|\\n/);\r\n        var language = modeService.getModeId(mimeType);\r\n        if (!language) {\r\n            return Promise.resolve(_fakeColorize(lines, tabSize));\r\n        }\r\n        // Send out the event to create the mode\r\n        modeService.triggerMode(language);\r\n        var tokenizationSupport = TokenizationRegistry.get(language);\r\n        if (tokenizationSupport) {\r\n            return Promise.resolve(_colorize(lines, tabSize, tokenizationSupport));\r\n        }\r\n        return new Promise(function (resolve, reject) {\r\n            var listener = null;\r\n            var timeout = null;\r\n            var execute = function () {\r\n                if (listener) {\r\n                    listener.dispose();\r\n                    listener = null;\r\n                }\r\n                if (timeout) {\r\n                    timeout.dispose();\r\n                    timeout = null;\r\n                }\r\n                var tokenizationSupport = TokenizationRegistry.get(language);\r\n                if (tokenizationSupport) {\r\n                    return resolve(_colorize(lines, tabSize, tokenizationSupport));\r\n                }\r\n                return resolve(_fakeColorize(lines, tabSize));\r\n            };\r\n            // wait 500ms for mode to load, then give up\r\n            timeout = new TimeoutTimer();\r\n            timeout.cancelAndSet(execute, 500);\r\n            listener = TokenizationRegistry.onDidChange(function (e) {\r\n                if (e.changedLanguages.indexOf(language) >= 0) {\r\n                    execute();\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Colorizer.colorizeLine = function (line, mightContainNonBasicASCII, mightContainRTL, tokens, tabSize) {\r\n        if (tabSize === void 0) { tabSize = 4; }\r\n        var isBasicASCII = ViewLineRenderingData.isBasicASCII(line, mightContainNonBasicASCII);\r\n        var containsRTL = ViewLineRenderingData.containsRTL(line, isBasicASCII, mightContainRTL);\r\n        var renderResult = renderViewLine(new RenderLineInput(false, true, line, false, isBasicASCII, containsRTL, 0, tokens, [], tabSize, 0, -1, 'none', false, false));\r\n        return renderResult.html;\r\n    };\r\n    Colorizer.colorizeModelLine = function (model, lineNumber, tabSize) {\r\n        if (tabSize === void 0) { tabSize = 4; }\r\n        var content = model.getLineContent(lineNumber);\r\n        model.forceTokenization(lineNumber);\r\n        var tokens = model.getLineTokens(lineNumber);\r\n        var inflatedTokens = tokens.inflate();\r\n        return this.colorizeLine(content, model.mightContainNonBasicASCII(), model.mightContainRTL(), inflatedTokens, tabSize);\r\n    };\r\n    return Colorizer;\r\n}());\r\nexport { Colorizer };\r\nfunction _colorize(lines, tabSize, tokenizationSupport) {\r\n    return _actualColorize(lines, tabSize, tokenizationSupport);\r\n}\r\nfunction _fakeColorize(lines, tabSize) {\r\n    var html = [];\r\n    var defaultMetadata = ((0 /* None */ << 11 /* FONT_STYLE_OFFSET */)\r\n        | (1 /* DefaultForeground */ << 14 /* FOREGROUND_OFFSET */)\r\n        | (2 /* DefaultBackground */ << 23 /* BACKGROUND_OFFSET */)) >>> 0;\r\n    var tokens = new Uint32Array(2);\r\n    tokens[0] = 0;\r\n    tokens[1] = defaultMetadata;\r\n    for (var i = 0, length_1 = lines.length; i < length_1; i++) {\r\n        var line = lines[i];\r\n        tokens[0] = line.length;\r\n        var lineTokens = new LineTokens(tokens, line);\r\n        var isBasicASCII = ViewLineRenderingData.isBasicASCII(line, /* check for basic ASCII */ true);\r\n        var containsRTL = ViewLineRenderingData.containsRTL(line, isBasicASCII, /* check for RTL */ true);\r\n        var renderResult = renderViewLine(new RenderLineInput(false, true, line, false, isBasicASCII, containsRTL, 0, lineTokens, [], tabSize, 0, -1, 'none', false, false));\r\n        html = html.concat(renderResult.html);\r\n        html.push('<br/>');\r\n    }\r\n    return html.join('');\r\n}\r\nfunction _actualColorize(lines, tabSize, tokenizationSupport) {\r\n    var html = [];\r\n    var state = tokenizationSupport.getInitialState();\r\n    for (var i = 0, length_2 = lines.length; i < length_2; i++) {\r\n        var line = lines[i];\r\n        var tokenizeResult = tokenizationSupport.tokenize2(line, state, 0);\r\n        LineTokens.convertToEndOffset(tokenizeResult.tokens, line.length);\r\n        var lineTokens = new LineTokens(tokenizeResult.tokens, line);\r\n        var isBasicASCII = ViewLineRenderingData.isBasicASCII(line, /* check for basic ASCII */ true);\r\n        var containsRTL = ViewLineRenderingData.containsRTL(line, isBasicASCII, /* check for RTL */ true);\r\n        var renderResult = renderViewLine(new RenderLineInput(false, true, line, false, isBasicASCII, containsRTL, 0, lineTokens.inflate(), [], tabSize, 0, -1, 'none', false, false));\r\n        html = html.concat(renderResult.html);\r\n        html.push('<br/>');\r\n        state = tokenizeResult.endState;\r\n    }\r\n    return html.join('');\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../nls.js';\r\nimport * as strings from './strings.js';\r\nvar Severity;\r\n(function (Severity) {\r\n    Severity[Severity[\"Ignore\"] = 0] = \"Ignore\";\r\n    Severity[Severity[\"Info\"] = 1] = \"Info\";\r\n    Severity[Severity[\"Warning\"] = 2] = \"Warning\";\r\n    Severity[Severity[\"Error\"] = 3] = \"Error\";\r\n})(Severity || (Severity = {}));\r\n(function (Severity) {\r\n    var _error = 'error';\r\n    var _warning = 'warning';\r\n    var _warn = 'warn';\r\n    var _info = 'info';\r\n    var _displayStrings = Object.create(null);\r\n    _displayStrings[Severity.Error] = nls.localize('sev.error', \"Error\");\r\n    _displayStrings[Severity.Warning] = nls.localize('sev.warning', \"Warning\");\r\n    _displayStrings[Severity.Info] = nls.localize('sev.info', \"Info\");\r\n    /**\r\n     * Parses 'error', 'warning', 'warn', 'info' in call casings\r\n     * and falls back to ignore.\r\n     */\r\n    function fromValue(value) {\r\n        if (!value) {\r\n            return Severity.Ignore;\r\n        }\r\n        if (strings.equalsIgnoreCase(_error, value)) {\r\n            return Severity.Error;\r\n        }\r\n        if (strings.equalsIgnoreCase(_warning, value) || strings.equalsIgnoreCase(_warn, value)) {\r\n            return Severity.Warning;\r\n        }\r\n        if (strings.equalsIgnoreCase(_info, value)) {\r\n            return Severity.Info;\r\n        }\r\n        return Severity.Ignore;\r\n    }\r\n    Severity.fromValue = fromValue;\r\n})(Severity || (Severity = {}));\r\nexport default Severity;\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as editorCommon from '../common/editorCommon.js';\r\n/**\r\n *@internal\r\n */\r\nexport function isCodeEditor(thing) {\r\n    if (thing && typeof thing.getEditorType === 'function') {\r\n        return thing.getEditorType() === editorCommon.EditorType.ICodeEditor;\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as Types from '../../../base/common/types.js';\r\nimport * as Assert from '../../../base/common/assert.js';\r\nvar RegistryImpl = /** @class */ (function () {\r\n    function RegistryImpl() {\r\n        this.data = {};\r\n    }\r\n    RegistryImpl.prototype.add = function (id, data) {\r\n        Assert.ok(Types.isString(id));\r\n        Assert.ok(Types.isObject(data));\r\n        Assert.ok(!this.data.hasOwnProperty(id), 'There is already an extension with this id');\r\n        this.data[id] = data;\r\n    };\r\n    RegistryImpl.prototype.as = function (id) {\r\n        return this.data[id] || null;\r\n    };\r\n    return RegistryImpl;\r\n}());\r\nexport var Registry = new RegistryImpl();\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as platform from '../../registry/common/platform.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nexport var Extensions = {\r\n    JSONContribution: 'base.contributions.json'\r\n};\r\nfunction normalizeId(id) {\r\n    if (id.length > 0 && id.charAt(id.length - 1) === '#') {\r\n        return id.substring(0, id.length - 1);\r\n    }\r\n    return id;\r\n}\r\nvar JSONContributionRegistry = /** @class */ (function () {\r\n    function JSONContributionRegistry() {\r\n        this._onDidChangeSchema = new Emitter();\r\n        this.schemasById = {};\r\n    }\r\n    JSONContributionRegistry.prototype.registerSchema = function (uri, unresolvedSchemaContent) {\r\n        this.schemasById[normalizeId(uri)] = unresolvedSchemaContent;\r\n        this._onDidChangeSchema.fire(uri);\r\n    };\r\n    return JSONContributionRegistry;\r\n}());\r\nvar jsonContributionRegistry = new JSONContributionRegistry();\r\nplatform.Registry.add(Extensions.JSONContribution, jsonContributionRegistry);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Registry } from '../../registry/common/platform.js';\r\nimport * as types from '../../../base/common/types.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Extensions as JSONExtensions } from '../../jsonschemas/common/jsonContributionRegistry.js';\r\nexport var Extensions = {\r\n    Configuration: 'base.contributions.configuration'\r\n};\r\nexport var allSettings = { properties: {}, patternProperties: {} };\r\nexport var applicationSettings = { properties: {}, patternProperties: {} };\r\nexport var windowSettings = { properties: {}, patternProperties: {} };\r\nexport var resourceSettings = { properties: {}, patternProperties: {} };\r\nexport var editorConfigurationSchemaId = 'vscode://schemas/settings/editor';\r\nvar contributionRegistry = Registry.as(JSONExtensions.JSONContribution);\r\nvar ConfigurationRegistry = /** @class */ (function () {\r\n    function ConfigurationRegistry() {\r\n        this.overrideIdentifiers = [];\r\n        this._onDidSchemaChange = new Emitter();\r\n        this._onDidRegisterConfiguration = new Emitter();\r\n        this.configurationContributors = [];\r\n        this.editorConfigurationSchema = { properties: {}, patternProperties: {}, additionalProperties: false, errorMessage: 'Unknown editor configuration setting' };\r\n        this.configurationProperties = {};\r\n        this.excludedConfigurationProperties = {};\r\n        this.computeOverridePropertyPattern();\r\n        contributionRegistry.registerSchema(editorConfigurationSchemaId, this.editorConfigurationSchema);\r\n    }\r\n    ConfigurationRegistry.prototype.registerConfiguration = function (configuration, validate) {\r\n        if (validate === void 0) { validate = true; }\r\n        this.registerConfigurations([configuration], [], validate);\r\n    };\r\n    ConfigurationRegistry.prototype.registerConfigurations = function (configurations, defaultConfigurations, validate) {\r\n        var _this = this;\r\n        if (validate === void 0) { validate = true; }\r\n        var configurationNode = this.toConfiguration(defaultConfigurations);\r\n        if (configurationNode) {\r\n            configurations.push(configurationNode);\r\n        }\r\n        var properties = [];\r\n        configurations.forEach(function (configuration) {\r\n            properties.push.apply(properties, _this.validateAndRegisterProperties(configuration, validate)); // fills in defaults\r\n            _this.configurationContributors.push(configuration);\r\n            _this.registerJSONConfiguration(configuration);\r\n            _this.updateSchemaForOverrideSettingsConfiguration(configuration);\r\n        });\r\n        this._onDidRegisterConfiguration.fire(properties);\r\n    };\r\n    ConfigurationRegistry.prototype.registerOverrideIdentifiers = function (overrideIdentifiers) {\r\n        var _a;\r\n        (_a = this.overrideIdentifiers).push.apply(_a, overrideIdentifiers);\r\n        this.updateOverridePropertyPatternKey();\r\n    };\r\n    ConfigurationRegistry.prototype.toConfiguration = function (defaultConfigurations) {\r\n        var configurationNode = {\r\n            id: 'defaultOverrides',\r\n            title: nls.localize('defaultConfigurations.title', \"Default Configuration Overrides\"),\r\n            properties: {}\r\n        };\r\n        for (var _i = 0, defaultConfigurations_1 = defaultConfigurations; _i < defaultConfigurations_1.length; _i++) {\r\n            var defaultConfiguration = defaultConfigurations_1[_i];\r\n            for (var key in defaultConfiguration.defaults) {\r\n                var defaultValue = defaultConfiguration.defaults[key];\r\n                if (OVERRIDE_PROPERTY_PATTERN.test(key) && typeof defaultValue === 'object') {\r\n                    configurationNode.properties[key] = {\r\n                        type: 'object',\r\n                        default: defaultValue,\r\n                        description: nls.localize('overrideSettings.description', \"Configure editor settings to be overridden for {0} language.\", key),\r\n                        $ref: editorConfigurationSchemaId\r\n                    };\r\n                }\r\n            }\r\n        }\r\n        return Object.keys(configurationNode.properties).length ? configurationNode : null;\r\n    };\r\n    ConfigurationRegistry.prototype.validateAndRegisterProperties = function (configuration, validate, scope, overridable) {\r\n        if (validate === void 0) { validate = true; }\r\n        if (scope === void 0) { scope = 2 /* WINDOW */; }\r\n        if (overridable === void 0) { overridable = false; }\r\n        scope = types.isUndefinedOrNull(configuration.scope) ? scope : configuration.scope;\r\n        overridable = configuration.overridable || overridable;\r\n        var propertyKeys = [];\r\n        var properties = configuration.properties;\r\n        if (properties) {\r\n            for (var key in properties) {\r\n                var message = void 0;\r\n                if (validate && (message = validateProperty(key))) {\r\n                    console.warn(message);\r\n                    delete properties[key];\r\n                    continue;\r\n                }\r\n                // fill in default values\r\n                var property = properties[key];\r\n                var defaultValue = property.default;\r\n                if (types.isUndefined(defaultValue)) {\r\n                    property.default = getDefaultValue(property.type);\r\n                }\r\n                // Inherit overridable property from parent\r\n                if (overridable) {\r\n                    property.overridable = true;\r\n                }\r\n                if (OVERRIDE_PROPERTY_PATTERN.test(key)) {\r\n                    property.scope = void 0; // No scope for overridable properties `[${identifier}]`\r\n                }\r\n                else {\r\n                    property.scope = types.isUndefinedOrNull(property.scope) ? scope : property.scope;\r\n                }\r\n                // Add to properties maps\r\n                // Property is included by default if 'included' is unspecified\r\n                if (properties[key].hasOwnProperty('included') && !properties[key].included) {\r\n                    this.excludedConfigurationProperties[key] = properties[key];\r\n                    delete properties[key];\r\n                    continue;\r\n                }\r\n                else {\r\n                    this.configurationProperties[key] = properties[key];\r\n                }\r\n                propertyKeys.push(key);\r\n            }\r\n        }\r\n        var subNodes = configuration.allOf;\r\n        if (subNodes) {\r\n            for (var _i = 0, subNodes_1 = subNodes; _i < subNodes_1.length; _i++) {\r\n                var node = subNodes_1[_i];\r\n                propertyKeys.push.apply(propertyKeys, this.validateAndRegisterProperties(node, validate, scope, overridable));\r\n            }\r\n        }\r\n        return propertyKeys;\r\n    };\r\n    ConfigurationRegistry.prototype.getConfigurationProperties = function () {\r\n        return this.configurationProperties;\r\n    };\r\n    ConfigurationRegistry.prototype.registerJSONConfiguration = function (configuration) {\r\n        function register(configuration) {\r\n            var properties = configuration.properties;\r\n            if (properties) {\r\n                for (var key in properties) {\r\n                    allSettings.properties[key] = properties[key];\r\n                    switch (properties[key].scope) {\r\n                        case 1 /* APPLICATION */:\r\n                            applicationSettings.properties[key] = properties[key];\r\n                            break;\r\n                        case 2 /* WINDOW */:\r\n                            windowSettings.properties[key] = properties[key];\r\n                            break;\r\n                        case 3 /* RESOURCE */:\r\n                            resourceSettings.properties[key] = properties[key];\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n            var subNodes = configuration.allOf;\r\n            if (subNodes) {\r\n                subNodes.forEach(register);\r\n            }\r\n        }\r\n        register(configuration);\r\n        this._onDidSchemaChange.fire();\r\n    };\r\n    ConfigurationRegistry.prototype.updateSchemaForOverrideSettingsConfiguration = function (configuration) {\r\n        if (configuration.id !== SETTINGS_OVERRRIDE_NODE_ID) {\r\n            this.update(configuration);\r\n            contributionRegistry.registerSchema(editorConfigurationSchemaId, this.editorConfigurationSchema);\r\n        }\r\n    };\r\n    ConfigurationRegistry.prototype.updateOverridePropertyPatternKey = function () {\r\n        var patternProperties = allSettings.patternProperties[this.overridePropertyPattern];\r\n        if (!patternProperties) {\r\n            patternProperties = {\r\n                type: 'object',\r\n                description: nls.localize('overrideSettings.defaultDescription', \"Configure editor settings to be overridden for a language.\"),\r\n                errorMessage: 'Unknown Identifier. Use language identifiers',\r\n                $ref: editorConfigurationSchemaId\r\n            };\r\n        }\r\n        delete allSettings.patternProperties[this.overridePropertyPattern];\r\n        delete applicationSettings.patternProperties[this.overridePropertyPattern];\r\n        delete windowSettings.patternProperties[this.overridePropertyPattern];\r\n        delete resourceSettings.patternProperties[this.overridePropertyPattern];\r\n        this.computeOverridePropertyPattern();\r\n        allSettings.patternProperties[this.overridePropertyPattern] = patternProperties;\r\n        applicationSettings.patternProperties[this.overridePropertyPattern] = patternProperties;\r\n        windowSettings.patternProperties[this.overridePropertyPattern] = patternProperties;\r\n        resourceSettings.patternProperties[this.overridePropertyPattern] = patternProperties;\r\n        this._onDidSchemaChange.fire();\r\n    };\r\n    ConfigurationRegistry.prototype.update = function (configuration) {\r\n        var _this = this;\r\n        var properties = configuration.properties;\r\n        if (properties) {\r\n            for (var key in properties) {\r\n                if (properties[key].overridable) {\r\n                    this.editorConfigurationSchema.properties[key] = this.getConfigurationProperties()[key];\r\n                }\r\n            }\r\n        }\r\n        var subNodes = configuration.allOf;\r\n        if (subNodes) {\r\n            subNodes.forEach(function (subNode) { return _this.update(subNode); });\r\n        }\r\n    };\r\n    ConfigurationRegistry.prototype.computeOverridePropertyPattern = function () {\r\n        this.overridePropertyPattern = this.overrideIdentifiers.length ? OVERRIDE_PATTERN_WITH_SUBSTITUTION.replace('${0}', this.overrideIdentifiers.map(function (identifier) { return strings.createRegExp(identifier, false).source; }).join('|')) : OVERRIDE_PROPERTY;\r\n    };\r\n    return ConfigurationRegistry;\r\n}());\r\nvar SETTINGS_OVERRRIDE_NODE_ID = 'override';\r\nvar OVERRIDE_PROPERTY = '\\\\[.*\\\\]$';\r\nvar OVERRIDE_PATTERN_WITH_SUBSTITUTION = '\\\\[(${0})\\\\]$';\r\nexport var OVERRIDE_PROPERTY_PATTERN = new RegExp(OVERRIDE_PROPERTY);\r\nfunction getDefaultValue(type) {\r\n    var t = Array.isArray(type) ? type[0] : type;\r\n    switch (t) {\r\n        case 'boolean':\r\n            return false;\r\n        case 'integer':\r\n        case 'number':\r\n            return 0;\r\n        case 'string':\r\n            return '';\r\n        case 'array':\r\n            return [];\r\n        case 'object':\r\n            return {};\r\n        default:\r\n            return null;\r\n    }\r\n}\r\nvar configurationRegistry = new ConfigurationRegistry();\r\nRegistry.add(Extensions.Configuration, configurationRegistry);\r\nexport function validateProperty(property) {\r\n    if (OVERRIDE_PROPERTY_PATTERN.test(property)) {\r\n        return nls.localize('config.property.languageDefault', \"Cannot register '{0}'. This matches property pattern '\\\\\\\\[.*\\\\\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.\", property);\r\n    }\r\n    if (configurationRegistry.getConfigurationProperties()[property] !== void 0) {\r\n        return nls.localize('config.property.duplicate', \"Cannot register '{0}'. This property is already registered.\", property);\r\n    }\r\n    return null;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport * as editorOptions from './editorOptions.js';\r\nimport { EditorZoom } from './editorZoom.js';\r\nimport { BareFontInfo } from './fontInfo.js';\r\nimport { Extensions } from '../../../platform/configuration/common/configurationRegistry.js';\r\nimport { Registry } from '../../../platform/registry/common/platform.js';\r\nvar EDITOR_DEFAULTS = editorOptions.EDITOR_DEFAULTS;\r\nvar EDITOR_FONT_DEFAULTS = editorOptions.EDITOR_FONT_DEFAULTS;\r\nvar EDITOR_MODEL_DEFAULTS = editorOptions.EDITOR_MODEL_DEFAULTS;\r\nexport var TabFocus = new /** @class */ (function () {\r\n    function class_1() {\r\n        this._tabFocus = false;\r\n        this._onDidChangeTabFocus = new Emitter();\r\n        this.onDidChangeTabFocus = this._onDidChangeTabFocus.event;\r\n    }\r\n    class_1.prototype.getTabFocusMode = function () {\r\n        return this._tabFocus;\r\n    };\r\n    class_1.prototype.setTabFocusMode = function (tabFocusMode) {\r\n        if (this._tabFocus === tabFocusMode) {\r\n            return;\r\n        }\r\n        this._tabFocus = tabFocusMode;\r\n        this._onDidChangeTabFocus.fire(this._tabFocus);\r\n    };\r\n    return class_1;\r\n}());\r\nvar hasOwnProperty = Object.hasOwnProperty;\r\nvar CommonEditorConfiguration = /** @class */ (function (_super) {\r\n    __extends(CommonEditorConfiguration, _super);\r\n    function CommonEditorConfiguration(options) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onDidChange = _this._register(new Emitter());\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        // Do a \"deep clone of sorts\" on the incoming options\r\n        _this._rawOptions = objects.mixin({}, options || {});\r\n        _this._rawOptions.scrollbar = objects.mixin({}, _this._rawOptions.scrollbar || {});\r\n        _this._rawOptions.minimap = objects.mixin({}, _this._rawOptions.minimap || {});\r\n        _this._rawOptions.find = objects.mixin({}, _this._rawOptions.find || {});\r\n        _this._rawOptions.hover = objects.mixin({}, _this._rawOptions.hover || {});\r\n        _this._rawOptions.parameterHints = objects.mixin({}, _this._rawOptions.parameterHints || {});\r\n        _this._validatedOptions = editorOptions.EditorOptionsValidator.validate(_this._rawOptions, EDITOR_DEFAULTS);\r\n        _this._isDominatedByLongLines = false;\r\n        _this._lineNumbersDigitCount = 1;\r\n        _this._register(EditorZoom.onDidChangeZoomLevel(function (_) { return _this._recomputeOptions(); }));\r\n        _this._register(TabFocus.onDidChangeTabFocus(function (_) { return _this._recomputeOptions(); }));\r\n        return _this;\r\n    }\r\n    CommonEditorConfiguration.prototype.observeReferenceElement = function (dimension) {\r\n    };\r\n    CommonEditorConfiguration.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    CommonEditorConfiguration.prototype._recomputeOptions = function () {\r\n        var oldOptions = this.editor;\r\n        var newOptions = this._computeInternalOptions();\r\n        if (oldOptions && oldOptions.equals(newOptions)) {\r\n            return;\r\n        }\r\n        this.editor = newOptions;\r\n        if (oldOptions) {\r\n            this._onDidChange.fire(oldOptions.createChangeEvent(newOptions));\r\n        }\r\n    };\r\n    CommonEditorConfiguration.prototype.getRawOptions = function () {\r\n        return this._rawOptions;\r\n    };\r\n    CommonEditorConfiguration.prototype._computeInternalOptions = function () {\r\n        var opts = this._validatedOptions;\r\n        var partialEnv = this._getEnvConfiguration();\r\n        var bareFontInfo = BareFontInfo.createFromRawSettings(this._rawOptions, partialEnv.zoomLevel);\r\n        var env = {\r\n            outerWidth: partialEnv.outerWidth,\r\n            outerHeight: partialEnv.outerHeight,\r\n            fontInfo: this.readConfiguration(bareFontInfo),\r\n            extraEditorClassName: partialEnv.extraEditorClassName,\r\n            isDominatedByLongLines: this._isDominatedByLongLines,\r\n            lineNumbersDigitCount: this._lineNumbersDigitCount,\r\n            emptySelectionClipboard: partialEnv.emptySelectionClipboard,\r\n            pixelRatio: partialEnv.pixelRatio,\r\n            tabFocusMode: TabFocus.getTabFocusMode(),\r\n            accessibilitySupport: partialEnv.accessibilitySupport\r\n        };\r\n        return editorOptions.InternalEditorOptionsFactory.createInternalEditorOptions(env, opts);\r\n    };\r\n    CommonEditorConfiguration._primitiveArrayEquals = function (a, b) {\r\n        if (a.length !== b.length) {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < a.length; i++) {\r\n            if (a[i] !== b[i]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    CommonEditorConfiguration._subsetEquals = function (base, subset) {\r\n        for (var key in subset) {\r\n            if (hasOwnProperty.call(subset, key)) {\r\n                var subsetValue = subset[key];\r\n                var baseValue = base[key];\r\n                if (baseValue === subsetValue) {\r\n                    continue;\r\n                }\r\n                if (Array.isArray(baseValue) && Array.isArray(subsetValue)) {\r\n                    if (!this._primitiveArrayEquals(baseValue, subsetValue)) {\r\n                        return false;\r\n                    }\r\n                    continue;\r\n                }\r\n                if (typeof baseValue === 'object' && typeof subsetValue === 'object') {\r\n                    if (!this._subsetEquals(baseValue, subsetValue)) {\r\n                        return false;\r\n                    }\r\n                    continue;\r\n                }\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    CommonEditorConfiguration.prototype.updateOptions = function (newOptions) {\r\n        if (typeof newOptions === 'undefined') {\r\n            return;\r\n        }\r\n        if (CommonEditorConfiguration._subsetEquals(this._rawOptions, newOptions)) {\r\n            return;\r\n        }\r\n        this._rawOptions = objects.mixin(this._rawOptions, newOptions || {});\r\n        this._validatedOptions = editorOptions.EditorOptionsValidator.validate(this._rawOptions, EDITOR_DEFAULTS);\r\n        this._recomputeOptions();\r\n    };\r\n    CommonEditorConfiguration.prototype.setIsDominatedByLongLines = function (isDominatedByLongLines) {\r\n        this._isDominatedByLongLines = isDominatedByLongLines;\r\n        this._recomputeOptions();\r\n    };\r\n    CommonEditorConfiguration.prototype.setMaxLineNumber = function (maxLineNumber) {\r\n        var digitCount = CommonEditorConfiguration._digitCount(maxLineNumber);\r\n        if (this._lineNumbersDigitCount === digitCount) {\r\n            return;\r\n        }\r\n        this._lineNumbersDigitCount = digitCount;\r\n        this._recomputeOptions();\r\n    };\r\n    CommonEditorConfiguration._digitCount = function (n) {\r\n        var r = 0;\r\n        while (n) {\r\n            n = Math.floor(n / 10);\r\n            r++;\r\n        }\r\n        return r ? r : 1;\r\n    };\r\n    return CommonEditorConfiguration;\r\n}(Disposable));\r\nexport { CommonEditorConfiguration };\r\nvar configurationRegistry = Registry.as(Extensions.Configuration);\r\nvar editorConfiguration = {\r\n    'id': 'editor',\r\n    'order': 5,\r\n    'type': 'object',\r\n    'title': nls.localize('editorConfigurationTitle', \"Editor\"),\r\n    'overridable': true,\r\n    'scope': 3 /* RESOURCE */,\r\n    'properties': {\r\n        'editor.fontFamily': {\r\n            'type': 'string',\r\n            'default': EDITOR_FONT_DEFAULTS.fontFamily,\r\n            'description': nls.localize('fontFamily', \"Controls the font family.\")\r\n        },\r\n        'editor.fontWeight': {\r\n            'type': 'string',\r\n            'enum': ['normal', 'bold', '100', '200', '300', '400', '500', '600', '700', '800', '900'],\r\n            'default': EDITOR_FONT_DEFAULTS.fontWeight,\r\n            'description': nls.localize('fontWeight', \"Controls the font weight.\")\r\n        },\r\n        'editor.fontSize': {\r\n            'type': 'number',\r\n            'default': EDITOR_FONT_DEFAULTS.fontSize,\r\n            'description': nls.localize('fontSize', \"Controls the font size in pixels.\")\r\n        },\r\n        'editor.lineHeight': {\r\n            'type': 'number',\r\n            'default': EDITOR_FONT_DEFAULTS.lineHeight,\r\n            'description': nls.localize('lineHeight', \"Controls the line height. Use 0 to compute the line height from the font size.\")\r\n        },\r\n        'editor.letterSpacing': {\r\n            'type': 'number',\r\n            'default': EDITOR_FONT_DEFAULTS.letterSpacing,\r\n            'description': nls.localize('letterSpacing', \"Controls the letter spacing in pixels.\")\r\n        },\r\n        'editor.lineNumbers': {\r\n            'type': 'string',\r\n            'enum': ['off', 'on', 'relative', 'interval'],\r\n            'enumDescriptions': [\r\n                nls.localize('lineNumbers.off', \"Line numbers are not rendered.\"),\r\n                nls.localize('lineNumbers.on', \"Line numbers are rendered as absolute number.\"),\r\n                nls.localize('lineNumbers.relative', \"Line numbers are rendered as distance in lines to cursor position.\"),\r\n                nls.localize('lineNumbers.interval', \"Line numbers are rendered every 10 lines.\")\r\n            ],\r\n            'default': 'on',\r\n            'description': nls.localize('lineNumbers', \"Controls the display of line numbers.\")\r\n        },\r\n        'editor.rulers': {\r\n            'type': 'array',\r\n            'items': {\r\n                'type': 'number'\r\n            },\r\n            'default': EDITOR_DEFAULTS.viewInfo.rulers,\r\n            'description': nls.localize('rulers', \"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.\")\r\n        },\r\n        'editor.wordSeparators': {\r\n            'type': 'string',\r\n            'default': EDITOR_DEFAULTS.wordSeparators,\r\n            'description': nls.localize('wordSeparators', \"Characters that will be used as word separators when doing word related navigations or operations.\")\r\n        },\r\n        'editor.tabSize': {\r\n            'type': 'number',\r\n            'default': EDITOR_MODEL_DEFAULTS.tabSize,\r\n            'minimum': 1,\r\n            'markdownDescription': nls.localize('tabSize', \"The number of spaces a tab is equal to. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.\")\r\n        },\r\n        'editor.insertSpaces': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_MODEL_DEFAULTS.insertSpaces,\r\n            'markdownDescription': nls.localize('insertSpaces', \"Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.\")\r\n        },\r\n        'editor.detectIndentation': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_MODEL_DEFAULTS.detectIndentation,\r\n            'markdownDescription': nls.localize('detectIndentation', \"Controls whether `#editor.tabSize#` and `#editor.insertSpaces#` will be automatically detected when a file is opened based on the file contents.\")\r\n        },\r\n        'editor.roundedSelection': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.viewInfo.roundedSelection,\r\n            'description': nls.localize('roundedSelection', \"Controls whether selections should have rounded corners.\")\r\n        },\r\n        'editor.scrollBeyondLastLine': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.viewInfo.scrollBeyondLastLine,\r\n            'description': nls.localize('scrollBeyondLastLine', \"Controls whether the editor will scroll beyond the last line.\")\r\n        },\r\n        'editor.scrollBeyondLastColumn': {\r\n            'type': 'number',\r\n            'default': EDITOR_DEFAULTS.viewInfo.scrollBeyondLastColumn,\r\n            'description': nls.localize('scrollBeyondLastColumn', \"Controls the number of extra characters beyond which the editor will scroll horizontally.\")\r\n        },\r\n        'editor.smoothScrolling': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.viewInfo.smoothScrolling,\r\n            'description': nls.localize('smoothScrolling', \"Controls whether the editor will scroll using an animation.\")\r\n        },\r\n        'editor.minimap.enabled': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.viewInfo.minimap.enabled,\r\n            'description': nls.localize('minimap.enabled', \"Controls whether the minimap is shown.\")\r\n        },\r\n        'editor.minimap.side': {\r\n            'type': 'string',\r\n            'enum': ['left', 'right'],\r\n            'default': EDITOR_DEFAULTS.viewInfo.minimap.side,\r\n            'description': nls.localize('minimap.side', \"Controls the side where to render the minimap.\")\r\n        },\r\n        'editor.minimap.showSlider': {\r\n            'type': 'string',\r\n            'enum': ['always', 'mouseover'],\r\n            'default': EDITOR_DEFAULTS.viewInfo.minimap.showSlider,\r\n            'description': nls.localize('minimap.showSlider', \"Controls whether the minimap slider is automatically hidden.\")\r\n        },\r\n        'editor.minimap.renderCharacters': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.viewInfo.minimap.renderCharacters,\r\n            'description': nls.localize('minimap.renderCharacters', \"Render the actual characters on a line as opposed to color blocks.\")\r\n        },\r\n        'editor.minimap.maxColumn': {\r\n            'type': 'number',\r\n            'default': EDITOR_DEFAULTS.viewInfo.minimap.maxColumn,\r\n            'description': nls.localize('minimap.maxColumn', \"Limit the width of the minimap to render at most a certain number of columns.\")\r\n        },\r\n        'editor.hover.enabled': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.hover.enabled,\r\n            'description': nls.localize('hover.enabled', \"Controls whether the hover is shown.\")\r\n        },\r\n        'editor.hover.delay': {\r\n            'type': 'number',\r\n            'default': EDITOR_DEFAULTS.contribInfo.hover.delay,\r\n            'description': nls.localize('hover.delay', \"Controls the delay in milliseconds after which the hover is shown.\")\r\n        },\r\n        'editor.hover.sticky': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.hover.sticky,\r\n            'description': nls.localize('hover.sticky', \"Controls whether the hover should remain visible when mouse is moved over it.\")\r\n        },\r\n        'editor.find.seedSearchStringFromSelection': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.find.seedSearchStringFromSelection,\r\n            'description': nls.localize('find.seedSearchStringFromSelection', \"Controls whether the search string in the Find Widget is seeded from the editor selection.\")\r\n        },\r\n        'editor.find.autoFindInSelection': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.find.autoFindInSelection,\r\n            'description': nls.localize('find.autoFindInSelection', \"Controls whether the find operation is carried out on selected text or the entire file in the editor.\")\r\n        },\r\n        'editor.find.globalFindClipboard': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.find.globalFindClipboard,\r\n            'description': nls.localize('find.globalFindClipboard', \"Controls whether the Find Widget should read or modify the shared find clipboard on macOS.\"),\r\n            'included': platform.isMacintosh\r\n        },\r\n        'editor.wordWrap': {\r\n            'type': 'string',\r\n            'enum': ['off', 'on', 'wordWrapColumn', 'bounded'],\r\n            'markdownEnumDescriptions': [\r\n                nls.localize('wordWrap.off', \"Lines will never wrap.\"),\r\n                nls.localize('wordWrap.on', \"Lines will wrap at the viewport width.\"),\r\n                nls.localize({\r\n                    key: 'wordWrap.wordWrapColumn',\r\n                    comment: [\r\n                        '- `editor.wordWrapColumn` refers to a different setting and should not be localized.'\r\n                    ]\r\n                }, \"Lines will wrap at `#editor.wordWrapColumn#`.\"),\r\n                nls.localize({\r\n                    key: 'wordWrap.bounded',\r\n                    comment: [\r\n                        '- viewport means the edge of the visible window size.',\r\n                        '- `editor.wordWrapColumn` refers to a different setting and should not be localized.'\r\n                    ]\r\n                }, \"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.\"),\r\n            ],\r\n            'default': EDITOR_DEFAULTS.wordWrap,\r\n            'description': nls.localize({\r\n                key: 'wordWrap',\r\n                comment: [\r\n                    '- \\'off\\', \\'on\\', \\'wordWrapColumn\\' and \\'bounded\\' refer to values the setting can take and should not be localized.',\r\n                    '- `editor.wordWrapColumn` refers to a different setting and should not be localized.'\r\n                ]\r\n            }, \"Controls how lines should wrap.\")\r\n        },\r\n        'editor.wordWrapColumn': {\r\n            'type': 'integer',\r\n            'default': EDITOR_DEFAULTS.wordWrapColumn,\r\n            'minimum': 1,\r\n            'markdownDescription': nls.localize({\r\n                key: 'wordWrapColumn',\r\n                comment: [\r\n                    '- `editor.wordWrap` refers to a different setting and should not be localized.',\r\n                    '- \\'wordWrapColumn\\' and \\'bounded\\' refer to values the different setting can take and should not be localized.'\r\n                ]\r\n            }, \"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.\")\r\n        },\r\n        'editor.wrappingIndent': {\r\n            'type': 'string',\r\n            'enum': ['none', 'same', 'indent', 'deepIndent'],\r\n            enumDescriptions: [\r\n                nls.localize('wrappingIndent.none', \"No indentation. Wrapped lines begin at column 1.\"),\r\n                nls.localize('wrappingIndent.same', \"Wrapped lines get the same indentation as the parent.\"),\r\n                nls.localize('wrappingIndent.indent', \"Wrapped lines get +1 indentation toward the parent.\"),\r\n                nls.localize('wrappingIndent.deepIndent', \"Wrapped lines get +2 indentation toward the parent.\"),\r\n            ],\r\n            'default': 'same',\r\n            'description': nls.localize('wrappingIndent', \"Controls the indentation of wrapped lines.\"),\r\n        },\r\n        'editor.mouseWheelScrollSensitivity': {\r\n            'type': 'number',\r\n            'default': EDITOR_DEFAULTS.viewInfo.scrollbar.mouseWheelScrollSensitivity,\r\n            'markdownDescription': nls.localize('mouseWheelScrollSensitivity', \"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.\")\r\n        },\r\n        'editor.multiCursorModifier': {\r\n            'type': 'string',\r\n            'enum': ['ctrlCmd', 'alt'],\r\n            'markdownEnumDescriptions': [\r\n                nls.localize('multiCursorModifier.ctrlCmd', \"Maps to `Control` on Windows and Linux and to `Command` on macOS.\"),\r\n                nls.localize('multiCursorModifier.alt', \"Maps to `Alt` on Windows and Linux and to `Option` on macOS.\")\r\n            ],\r\n            'default': 'alt',\r\n            'markdownDescription': nls.localize({\r\n                key: 'multiCursorModifier',\r\n                comment: [\r\n                    '- `ctrlCmd` refers to a value the setting can take and should not be localized.',\r\n                    '- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized.'\r\n                ]\r\n            }, \"The modifier to be used to add multiple cursors with the mouse. The Go To Definition and Open Link mouse gestures will adapt such that they do not conflict with the multicursor modifier. [Read more](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).\")\r\n        },\r\n        'editor.multiCursorMergeOverlapping': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.multiCursorMergeOverlapping,\r\n            'description': nls.localize('multiCursorMergeOverlapping', \"Merge multiple cursors when they are overlapping.\")\r\n        },\r\n        'editor.quickSuggestions': {\r\n            'anyOf': [\r\n                {\r\n                    type: 'boolean',\r\n                },\r\n                {\r\n                    type: 'object',\r\n                    properties: {\r\n                        strings: {\r\n                            type: 'boolean',\r\n                            default: false,\r\n                            description: nls.localize('quickSuggestions.strings', \"Enable quick suggestions inside strings.\")\r\n                        },\r\n                        comments: {\r\n                            type: 'boolean',\r\n                            default: false,\r\n                            description: nls.localize('quickSuggestions.comments', \"Enable quick suggestions inside comments.\")\r\n                        },\r\n                        other: {\r\n                            type: 'boolean',\r\n                            default: true,\r\n                            description: nls.localize('quickSuggestions.other', \"Enable quick suggestions outside of strings and comments.\")\r\n                        },\r\n                    }\r\n                }\r\n            ],\r\n            'default': EDITOR_DEFAULTS.contribInfo.quickSuggestions,\r\n            'description': nls.localize('quickSuggestions', \"Controls whether suggestions should automatically show up while typing.\")\r\n        },\r\n        'editor.quickSuggestionsDelay': {\r\n            'type': 'integer',\r\n            'default': EDITOR_DEFAULTS.contribInfo.quickSuggestionsDelay,\r\n            'minimum': 0,\r\n            'description': nls.localize('quickSuggestionsDelay', \"Controls the delay in milliseconds after which quick suggestions will show up.\")\r\n        },\r\n        'editor.parameterHints.enabled': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.parameterHints.enabled,\r\n            'description': nls.localize('parameterHints.enabled', \"Enables a pop-up that shows parameter documentation and type information as you type.\")\r\n        },\r\n        'editor.parameterHints.cycle': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.parameterHints.cycle,\r\n            'description': nls.localize('parameterHints.cycle', \"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.\")\r\n        },\r\n        'editor.autoClosingBrackets': {\r\n            type: 'string',\r\n            enum: ['always', 'languageDefined', 'beforeWhitespace', 'never'],\r\n            enumDescriptions: [\r\n                '',\r\n                nls.localize('editor.autoClosingBrackets.languageDefined', \"Use language configurations to determine when to autoclose brackets.\"),\r\n                nls.localize('editor.autoClosingBrackets.beforeWhitespace', \"Autoclose brackets only when the cursor is to the left of whitespace.\"),\r\n                '',\r\n            ],\r\n            'default': EDITOR_DEFAULTS.autoClosingBrackets,\r\n            'description': nls.localize('autoClosingBrackets', \"Controls whether the editor should automatically close brackets after the user adds an opening bracket.\")\r\n        },\r\n        'editor.autoClosingQuotes': {\r\n            type: 'string',\r\n            enum: ['always', 'languageDefined', 'beforeWhitespace', 'never'],\r\n            enumDescriptions: [\r\n                '',\r\n                nls.localize('editor.autoClosingQuotes.languageDefined', \"Use language configurations to determine when to autoclose quotes.\"),\r\n                nls.localize('editor.autoClosingQuotes.beforeWhitespace', \"Autoclose quotes only when the cursor is to the left of whitespace.\"),\r\n                '',\r\n            ],\r\n            'default': EDITOR_DEFAULTS.autoClosingQuotes,\r\n            'description': nls.localize('autoClosingQuotes', \"Controls whether the editor should automatically close quotes after the user adds an opening quote.\")\r\n        },\r\n        'editor.autoSurround': {\r\n            type: 'string',\r\n            enum: ['languageDefined', 'brackets', 'quotes', 'never'],\r\n            enumDescriptions: [\r\n                nls.localize('editor.autoSurround.languageDefined', \"Use language configurations to determine when to automatically surround selections.\"),\r\n                nls.localize('editor.autoSurround.brackets', \"Surround with brackets but not quotes.\"),\r\n                nls.localize('editor.autoSurround.quotes', \"Surround with quotes but not brackets.\"),\r\n                ''\r\n            ],\r\n            'default': EDITOR_DEFAULTS.autoSurround,\r\n            'description': nls.localize('autoSurround', \"Controls whether the editor should automatically surround selections.\")\r\n        },\r\n        'editor.formatOnType': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.formatOnType,\r\n            'description': nls.localize('formatOnType', \"Controls whether the editor should automatically format the line after typing.\")\r\n        },\r\n        'editor.formatOnPaste': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.formatOnPaste,\r\n            'description': nls.localize('formatOnPaste', \"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.\")\r\n        },\r\n        'editor.autoIndent': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.autoIndent,\r\n            'description': nls.localize('autoIndent', \"Controls whether the editor should automatically adjust the indentation when users type, paste or move lines. Extensions with indentation rules of the language must be available.\")\r\n        },\r\n        'editor.suggestOnTriggerCharacters': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.suggestOnTriggerCharacters,\r\n            'description': nls.localize('suggestOnTriggerCharacters', \"Controls whether suggestions should automatically show up when typing trigger characters.\")\r\n        },\r\n        'editor.acceptSuggestionOnEnter': {\r\n            'type': 'string',\r\n            'enum': ['on', 'smart', 'off'],\r\n            'default': EDITOR_DEFAULTS.contribInfo.acceptSuggestionOnEnter,\r\n            'markdownEnumDescriptions': [\r\n                '',\r\n                nls.localize('acceptSuggestionOnEnterSmart', \"Only accept a suggestion with `Enter` when it makes a textual change.\"),\r\n                ''\r\n            ],\r\n            'markdownDescription': nls.localize('acceptSuggestionOnEnter', \"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.\")\r\n        },\r\n        'editor.acceptSuggestionOnCommitCharacter': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.acceptSuggestionOnCommitCharacter,\r\n            'markdownDescription': nls.localize('acceptSuggestionOnCommitCharacter', \"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.\")\r\n        },\r\n        'editor.snippetSuggestions': {\r\n            'type': 'string',\r\n            'enum': ['top', 'bottom', 'inline', 'none'],\r\n            'enumDescriptions': [\r\n                nls.localize('snippetSuggestions.top', \"Show snippet suggestions on top of other suggestions.\"),\r\n                nls.localize('snippetSuggestions.bottom', \"Show snippet suggestions below other suggestions.\"),\r\n                nls.localize('snippetSuggestions.inline', \"Show snippets suggestions with other suggestions.\"),\r\n                nls.localize('snippetSuggestions.none', \"Do not show snippet suggestions.\"),\r\n            ],\r\n            'default': EDITOR_DEFAULTS.contribInfo.suggest.snippets,\r\n            'description': nls.localize('snippetSuggestions', \"Controls whether snippets are shown with other suggestions and how they are sorted.\")\r\n        },\r\n        'editor.emptySelectionClipboard': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.emptySelectionClipboard,\r\n            'description': nls.localize('emptySelectionClipboard', \"Controls whether copying without a selection copies the current line.\")\r\n        },\r\n        'editor.copyWithSyntaxHighlighting': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.copyWithSyntaxHighlighting,\r\n            'description': nls.localize('copyWithSyntaxHighlighting', \"Controls whether syntax highlighting should be copied into the clipboard.\")\r\n        },\r\n        'editor.wordBasedSuggestions': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.wordBasedSuggestions,\r\n            'description': nls.localize('wordBasedSuggestions', \"Controls whether completions should be computed based on words in the document.\")\r\n        },\r\n        'editor.suggestSelection': {\r\n            'type': 'string',\r\n            'enum': ['first', 'recentlyUsed', 'recentlyUsedByPrefix'],\r\n            'markdownEnumDescriptions': [\r\n                nls.localize('suggestSelection.first', \"Always select the first suggestion.\"),\r\n                nls.localize('suggestSelection.recentlyUsed', \"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently.\"),\r\n                nls.localize('suggestSelection.recentlyUsedByPrefix', \"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.\"),\r\n            ],\r\n            'default': 'recentlyUsed',\r\n            'description': nls.localize('suggestSelection', \"Controls how suggestions are pre-selected when showing the suggest list.\")\r\n        },\r\n        'editor.suggestFontSize': {\r\n            'type': 'integer',\r\n            'default': 0,\r\n            'minimum': 0,\r\n            'markdownDescription': nls.localize('suggestFontSize', \"Font size for the suggest widget. When set to `0`, the value of `#editor.fontSize#` is used.\")\r\n        },\r\n        'editor.suggestLineHeight': {\r\n            'type': 'integer',\r\n            'default': 0,\r\n            'minimum': 0,\r\n            'markdownDescription': nls.localize('suggestLineHeight', \"Line height for the suggest widget. When set to `0`, the value of `#editor.lineHeight#` is used.\")\r\n        },\r\n        'editor.tabCompletion': {\r\n            type: 'string',\r\n            default: 'off',\r\n            enum: ['on', 'off', 'onlySnippets'],\r\n            enumDescriptions: [\r\n                nls.localize('tabCompletion.on', \"Tab complete will insert the best matching suggestion when pressing tab.\"),\r\n                nls.localize('tabCompletion.off', \"Disable tab completions.\"),\r\n                nls.localize('tabCompletion.onlySnippets', \"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.\"),\r\n            ],\r\n            description: nls.localize('tabCompletion', \"Enables tab completions.\")\r\n        },\r\n        'editor.suggest.filterGraceful': {\r\n            type: 'boolean',\r\n            default: true,\r\n            description: nls.localize('suggest.filterGraceful', \"Controls whether filtering and sorting suggestions accounts for small typos.\")\r\n        },\r\n        'editor.suggest.localityBonus': {\r\n            type: 'boolean',\r\n            default: false,\r\n            description: nls.localize('suggest.localityBonus', \"Controls whether sorting favours words that appear close to the cursor.\")\r\n        },\r\n        'editor.suggest.snippetsPreventQuickSuggestions': {\r\n            type: 'boolean',\r\n            default: true,\r\n            description: nls.localize('suggest.snippetsPreventQuickSuggestions', \"Control whether an active snippet prevents quick suggestions.\")\r\n        },\r\n        'editor.selectionHighlight': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.selectionHighlight,\r\n            'description': nls.localize('selectionHighlight', \"Controls whether the editor should highlight matches similar to the selection\")\r\n        },\r\n        'editor.occurrencesHighlight': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.occurrencesHighlight,\r\n            'description': nls.localize('occurrencesHighlight', \"Controls whether the editor should highlight semantic symbol occurrences.\")\r\n        },\r\n        'editor.overviewRulerLanes': {\r\n            'type': 'integer',\r\n            'default': 3,\r\n            'description': nls.localize('overviewRulerLanes', \"Controls the number of decorations that can show up at the same position in the overview ruler.\")\r\n        },\r\n        'editor.overviewRulerBorder': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.viewInfo.overviewRulerBorder,\r\n            'description': nls.localize('overviewRulerBorder', \"Controls whether a border should be drawn around the overview ruler.\")\r\n        },\r\n        'editor.cursorBlinking': {\r\n            'type': 'string',\r\n            'enum': ['blink', 'smooth', 'phase', 'expand', 'solid'],\r\n            'default': editorOptions.blinkingStyleToString(EDITOR_DEFAULTS.viewInfo.cursorBlinking),\r\n            'description': nls.localize('cursorBlinking', \"Control the cursor animation style.\")\r\n        },\r\n        'editor.mouseWheelZoom': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.viewInfo.mouseWheelZoom,\r\n            'markdownDescription': nls.localize('mouseWheelZoom', \"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.\")\r\n        },\r\n        'editor.cursorStyle': {\r\n            'type': 'string',\r\n            'enum': ['block', 'block-outline', 'line', 'line-thin', 'underline', 'underline-thin'],\r\n            'default': editorOptions.cursorStyleToString(EDITOR_DEFAULTS.viewInfo.cursorStyle),\r\n            'description': nls.localize('cursorStyle', \"Controls the cursor style.\")\r\n        },\r\n        'editor.cursorWidth': {\r\n            'type': 'integer',\r\n            'default': EDITOR_DEFAULTS.viewInfo.cursorWidth,\r\n            'markdownDescription': nls.localize('cursorWidth', \"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.\")\r\n        },\r\n        'editor.fontLigatures': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.viewInfo.fontLigatures,\r\n            'description': nls.localize('fontLigatures', \"Enables/Disables font ligatures.\")\r\n        },\r\n        'editor.hideCursorInOverviewRuler': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.viewInfo.hideCursorInOverviewRuler,\r\n            'description': nls.localize('hideCursorInOverviewRuler', \"Controls whether the cursor should be hidden in the overview ruler.\")\r\n        },\r\n        'editor.renderWhitespace': {\r\n            'type': 'string',\r\n            'enum': ['none', 'boundary', 'all'],\r\n            'enumDescriptions': [\r\n                '',\r\n                nls.localize('renderWhiteSpace.boundary', \"Render whitespace characters except for single spaces between words.\"),\r\n                ''\r\n            ],\r\n            default: EDITOR_DEFAULTS.viewInfo.renderWhitespace,\r\n            description: nls.localize('renderWhitespace', \"Controls how the editor should render whitespace characters.\")\r\n        },\r\n        'editor.renderControlCharacters': {\r\n            'type': 'boolean',\r\n            default: EDITOR_DEFAULTS.viewInfo.renderControlCharacters,\r\n            description: nls.localize('renderControlCharacters', \"Controls whether the editor should render control characters.\")\r\n        },\r\n        'editor.renderIndentGuides': {\r\n            'type': 'boolean',\r\n            default: EDITOR_DEFAULTS.viewInfo.renderIndentGuides,\r\n            description: nls.localize('renderIndentGuides', \"Controls whether the editor should render indent guides.\")\r\n        },\r\n        'editor.highlightActiveIndentGuide': {\r\n            'type': 'boolean',\r\n            default: EDITOR_DEFAULTS.viewInfo.highlightActiveIndentGuide,\r\n            description: nls.localize('highlightActiveIndentGuide', \"Controls whether the editor should highlight the active indent guide.\")\r\n        },\r\n        'editor.renderLineHighlight': {\r\n            'type': 'string',\r\n            'enum': ['none', 'gutter', 'line', 'all'],\r\n            'enumDescriptions': [\r\n                '',\r\n                '',\r\n                '',\r\n                nls.localize('renderLineHighlight.all', \"Highlights both the gutter and the current line.\"),\r\n            ],\r\n            default: EDITOR_DEFAULTS.viewInfo.renderLineHighlight,\r\n            description: nls.localize('renderLineHighlight', \"Controls how the editor should render the current line highlight.\")\r\n        },\r\n        'editor.codeLens': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.codeLens,\r\n            'description': nls.localize('codeLens', \"Controls whether the editor shows CodeLens\")\r\n        },\r\n        'editor.folding': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.folding,\r\n            'description': nls.localize('folding', \"Controls whether the editor has code folding enabled\")\r\n        },\r\n        'editor.foldingStrategy': {\r\n            'type': 'string',\r\n            'enum': ['auto', 'indentation'],\r\n            'default': EDITOR_DEFAULTS.contribInfo.foldingStrategy,\r\n            'markdownDescription': nls.localize('foldingStrategy', \"Controls the strategy for computing folding ranges. `auto` uses a language specific folding strategy, if available. `indentation` uses the indentation based folding strategy.\")\r\n        },\r\n        'editor.showFoldingControls': {\r\n            'type': 'string',\r\n            'enum': ['always', 'mouseover'],\r\n            'default': EDITOR_DEFAULTS.contribInfo.showFoldingControls,\r\n            'description': nls.localize('showFoldingControls', \"Controls whether the fold controls on the gutter are automatically hidden.\")\r\n        },\r\n        'editor.matchBrackets': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.matchBrackets,\r\n            'description': nls.localize('matchBrackets', \"Highlight matching brackets when one of them is selected.\")\r\n        },\r\n        'editor.glyphMargin': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.viewInfo.glyphMargin,\r\n            'description': nls.localize('glyphMargin', \"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.\")\r\n        },\r\n        'editor.useTabStops': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.useTabStops,\r\n            'description': nls.localize('useTabStops', \"Inserting and deleting whitespace follows tab stops.\")\r\n        },\r\n        'editor.trimAutoWhitespace': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_MODEL_DEFAULTS.trimAutoWhitespace,\r\n            'description': nls.localize('trimAutoWhitespace', \"Remove trailing auto inserted whitespace.\")\r\n        },\r\n        'editor.stablePeek': {\r\n            'type': 'boolean',\r\n            'default': false,\r\n            'markdownDescription': nls.localize('stablePeek', \"Keep peek editors open even when double clicking their content or when hitting `Escape`.\")\r\n        },\r\n        'editor.dragAndDrop': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.dragAndDrop,\r\n            'description': nls.localize('dragAndDrop', \"Controls whether the editor should allow moving selections via drag and drop.\")\r\n        },\r\n        'editor.accessibilitySupport': {\r\n            'type': 'string',\r\n            'enum': ['auto', 'on', 'off'],\r\n            'enumDescriptions': [\r\n                nls.localize('accessibilitySupport.auto', \"The editor will use platform APIs to detect when a Screen Reader is attached.\"),\r\n                nls.localize('accessibilitySupport.on', \"The editor will be permanently optimized for usage with a Screen Reader.\"),\r\n                nls.localize('accessibilitySupport.off', \"The editor will never be optimized for usage with a Screen Reader.\"),\r\n            ],\r\n            'default': EDITOR_DEFAULTS.accessibilitySupport,\r\n            'description': nls.localize('accessibilitySupport', \"Controls whether the editor should run in a mode where it is optimized for screen readers.\")\r\n        },\r\n        'editor.showUnused': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.showUnused,\r\n            'description': nls.localize('showUnused', \"Controls fading out of unused code.\")\r\n        },\r\n        'editor.links': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.links,\r\n            'description': nls.localize('links', \"Controls whether the editor should detect links and make them clickable.\")\r\n        },\r\n        'editor.colorDecorators': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.colorDecorators,\r\n            'description': nls.localize('colorDecorators', \"Controls whether the editor should render the inline color decorators and color picker.\")\r\n        },\r\n        'editor.lightbulb.enabled': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.lightbulbEnabled,\r\n            'description': nls.localize('codeActions', \"Enables the code action lightbulb in the editor.\")\r\n        },\r\n        'editor.codeActionsOnSave': {\r\n            'type': 'object',\r\n            'properties': {\r\n                'source.organizeImports': {\r\n                    'type': 'boolean',\r\n                    'description': nls.localize('codeActionsOnSave.organizeImports', \"Controls whether organize imports action should be run on file save.\")\r\n                }\r\n            },\r\n            'additionalProperties': {\r\n                'type': 'boolean'\r\n            },\r\n            'default': EDITOR_DEFAULTS.contribInfo.codeActionsOnSave,\r\n            'description': nls.localize('codeActionsOnSave', \"Code action kinds to be run on save.\")\r\n        },\r\n        'editor.codeActionsOnSaveTimeout': {\r\n            'type': 'number',\r\n            'default': EDITOR_DEFAULTS.contribInfo.codeActionsOnSaveTimeout,\r\n            'description': nls.localize('codeActionsOnSaveTimeout', \"Timeout in milliseconds after which the code actions that are run on save are cancelled.\")\r\n        },\r\n        'editor.selectionClipboard': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_DEFAULTS.contribInfo.selectionClipboard,\r\n            'description': nls.localize('selectionClipboard', \"Controls whether the Linux primary clipboard should be supported.\"),\r\n            'included': platform.isLinux\r\n        },\r\n        'diffEditor.renderSideBySide': {\r\n            'type': 'boolean',\r\n            'default': true,\r\n            'description': nls.localize('sideBySide', \"Controls whether the diff editor shows the diff side by side or inline.\")\r\n        },\r\n        'diffEditor.ignoreTrimWhitespace': {\r\n            'type': 'boolean',\r\n            'default': true,\r\n            'description': nls.localize('ignoreTrimWhitespace', \"Controls whether the diff editor shows changes in leading or trailing whitespace as diffs.\")\r\n        },\r\n        'editor.largeFileOptimizations': {\r\n            'type': 'boolean',\r\n            'default': EDITOR_MODEL_DEFAULTS.largeFileOptimizations,\r\n            'description': nls.localize('largeFileOptimizations', \"Special handling for large files to disable certain memory intensive features.\")\r\n        },\r\n        'diffEditor.renderIndicators': {\r\n            'type': 'boolean',\r\n            'default': true,\r\n            'description': nls.localize('renderIndicators', \"Controls whether the diff editor shows +/- indicators for added/removed changes.\")\r\n        }\r\n    }\r\n};\r\nvar cachedEditorConfigurationKeys = null;\r\nfunction getEditorConfigurationKeys() {\r\n    if (cachedEditorConfigurationKeys === null) {\r\n        cachedEditorConfigurationKeys = Object.create(null);\r\n        Object.keys(editorConfiguration.properties).forEach(function (prop) {\r\n            cachedEditorConfigurationKeys[prop] = true;\r\n        });\r\n    }\r\n    return cachedEditorConfigurationKeys;\r\n}\r\nexport function isEditorConfigurationKey(key) {\r\n    var editorConfigurationKeys = getEditorConfigurationKeys();\r\n    return (editorConfigurationKeys[\"editor.\" + key] || false);\r\n}\r\nexport function isDiffEditorConfigurationKey(key) {\r\n    var editorConfigurationKeys = getEditorConfigurationKeys();\r\n    return (editorConfigurationKeys[\"diffEditor.\" + key] || false);\r\n}\r\nconfigurationRegistry.registerConfiguration(editorConfiguration);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from './range.js';\r\nvar EditOperation = /** @class */ (function () {\r\n    function EditOperation() {\r\n    }\r\n    EditOperation.insert = function (position, text) {\r\n        return {\r\n            range: new Range(position.lineNumber, position.column, position.lineNumber, position.column),\r\n            text: text,\r\n            forceMoveMarkers: true\r\n        };\r\n    };\r\n    EditOperation.delete = function (range) {\r\n        return {\r\n            range: range,\r\n            text: null\r\n        };\r\n    };\r\n    EditOperation.replace = function (range, text) {\r\n        return {\r\n            range: range,\r\n            text: text\r\n        };\r\n    };\r\n    EditOperation.replaceMove = function (range, text) {\r\n        return {\r\n            range: range,\r\n            text: text,\r\n            forceMoveMarkers: true\r\n        };\r\n    };\r\n    return EditOperation;\r\n}());\r\nexport { EditOperation };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { isFalsyOrWhitespace } from '../../../base/common/strings.js';\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nvar ContextKeyExpr = /** @class */ (function () {\r\n    function ContextKeyExpr() {\r\n    }\r\n    ContextKeyExpr.has = function (key) {\r\n        return new ContextKeyDefinedExpr(key);\r\n    };\r\n    ContextKeyExpr.equals = function (key, value) {\r\n        return new ContextKeyEqualsExpr(key, value);\r\n    };\r\n    ContextKeyExpr.regex = function (key, value) {\r\n        return new ContextKeyRegexExpr(key, value);\r\n    };\r\n    ContextKeyExpr.not = function (key) {\r\n        return new ContextKeyNotExpr(key);\r\n    };\r\n    ContextKeyExpr.and = function () {\r\n        var expr = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            expr[_i] = arguments[_i];\r\n        }\r\n        return new ContextKeyAndExpr(expr);\r\n    };\r\n    ContextKeyExpr.deserialize = function (serialized) {\r\n        var _this = this;\r\n        if (!serialized) {\r\n            return null;\r\n        }\r\n        var pieces = serialized.split('&&');\r\n        var result = new ContextKeyAndExpr(pieces.map(function (p) { return _this._deserializeOne(p); }));\r\n        return result.normalize();\r\n    };\r\n    ContextKeyExpr._deserializeOne = function (serializedOne) {\r\n        serializedOne = serializedOne.trim();\r\n        if (serializedOne.indexOf('!=') >= 0) {\r\n            var pieces = serializedOne.split('!=');\r\n            return new ContextKeyNotEqualsExpr(pieces[0].trim(), this._deserializeValue(pieces[1]));\r\n        }\r\n        if (serializedOne.indexOf('==') >= 0) {\r\n            var pieces = serializedOne.split('==');\r\n            return new ContextKeyEqualsExpr(pieces[0].trim(), this._deserializeValue(pieces[1]));\r\n        }\r\n        if (serializedOne.indexOf('=~') >= 0) {\r\n            var pieces = serializedOne.split('=~');\r\n            return new ContextKeyRegexExpr(pieces[0].trim(), this._deserializeRegexValue(pieces[1]));\r\n        }\r\n        if (/^\\!\\s*/.test(serializedOne)) {\r\n            return new ContextKeyNotExpr(serializedOne.substr(1).trim());\r\n        }\r\n        return new ContextKeyDefinedExpr(serializedOne);\r\n    };\r\n    ContextKeyExpr._deserializeValue = function (serializedValue) {\r\n        serializedValue = serializedValue.trim();\r\n        if (serializedValue === 'true') {\r\n            return true;\r\n        }\r\n        if (serializedValue === 'false') {\r\n            return false;\r\n        }\r\n        var m = /^'([^']*)'$/.exec(serializedValue);\r\n        if (m) {\r\n            return m[1].trim();\r\n        }\r\n        return serializedValue;\r\n    };\r\n    ContextKeyExpr._deserializeRegexValue = function (serializedValue) {\r\n        if (isFalsyOrWhitespace(serializedValue)) {\r\n            console.warn('missing regexp-value for =~-expression');\r\n            return null;\r\n        }\r\n        var start = serializedValue.indexOf('/');\r\n        var end = serializedValue.lastIndexOf('/');\r\n        if (start === end || start < 0 /* || to < 0 */) {\r\n            console.warn(\"bad regexp-value '\" + serializedValue + \"', missing /-enclosure\");\r\n            return null;\r\n        }\r\n        var value = serializedValue.slice(start + 1, end);\r\n        var caseIgnoreFlag = serializedValue[end + 1] === 'i' ? 'i' : '';\r\n        try {\r\n            return new RegExp(value, caseIgnoreFlag);\r\n        }\r\n        catch (e) {\r\n            console.warn(\"bad regexp-value '\" + serializedValue + \"', parse error: \" + e);\r\n            return null;\r\n        }\r\n    };\r\n    return ContextKeyExpr;\r\n}());\r\nexport { ContextKeyExpr };\r\nfunction cmp(a, b) {\r\n    var aType = a.getType();\r\n    var bType = b.getType();\r\n    if (aType !== bType) {\r\n        return aType - bType;\r\n    }\r\n    switch (aType) {\r\n        case 1 /* Defined */:\r\n            return a.cmp(b);\r\n        case 2 /* Not */:\r\n            return a.cmp(b);\r\n        case 3 /* Equals */:\r\n            return a.cmp(b);\r\n        case 4 /* NotEquals */:\r\n            return a.cmp(b);\r\n        case 6 /* Regex */:\r\n            return a.cmp(b);\r\n        default:\r\n            throw new Error('Unknown ContextKeyExpr!');\r\n    }\r\n}\r\nvar ContextKeyDefinedExpr = /** @class */ (function () {\r\n    function ContextKeyDefinedExpr(key) {\r\n        this.key = key;\r\n    }\r\n    ContextKeyDefinedExpr.prototype.getType = function () {\r\n        return 1 /* Defined */;\r\n    };\r\n    ContextKeyDefinedExpr.prototype.cmp = function (other) {\r\n        if (this.key < other.key) {\r\n            return -1;\r\n        }\r\n        if (this.key > other.key) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    ContextKeyDefinedExpr.prototype.equals = function (other) {\r\n        if (other instanceof ContextKeyDefinedExpr) {\r\n            return (this.key === other.key);\r\n        }\r\n        return false;\r\n    };\r\n    ContextKeyDefinedExpr.prototype.evaluate = function (context) {\r\n        return (!!context.getValue(this.key));\r\n    };\r\n    ContextKeyDefinedExpr.prototype.normalize = function () {\r\n        return this;\r\n    };\r\n    ContextKeyDefinedExpr.prototype.keys = function () {\r\n        return [this.key];\r\n    };\r\n    return ContextKeyDefinedExpr;\r\n}());\r\nexport { ContextKeyDefinedExpr };\r\nvar ContextKeyEqualsExpr = /** @class */ (function () {\r\n    function ContextKeyEqualsExpr(key, value) {\r\n        this.key = key;\r\n        this.value = value;\r\n    }\r\n    ContextKeyEqualsExpr.prototype.getType = function () {\r\n        return 3 /* Equals */;\r\n    };\r\n    ContextKeyEqualsExpr.prototype.cmp = function (other) {\r\n        if (this.key < other.key) {\r\n            return -1;\r\n        }\r\n        if (this.key > other.key) {\r\n            return 1;\r\n        }\r\n        if (this.value < other.value) {\r\n            return -1;\r\n        }\r\n        if (this.value > other.value) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    ContextKeyEqualsExpr.prototype.equals = function (other) {\r\n        if (other instanceof ContextKeyEqualsExpr) {\r\n            return (this.key === other.key && this.value === other.value);\r\n        }\r\n        return false;\r\n    };\r\n    ContextKeyEqualsExpr.prototype.evaluate = function (context) {\r\n        /* tslint:disable:triple-equals */\r\n        // Intentional ==\r\n        return (context.getValue(this.key) == this.value);\r\n        /* tslint:enable:triple-equals */\r\n    };\r\n    ContextKeyEqualsExpr.prototype.normalize = function () {\r\n        if (typeof this.value === 'boolean') {\r\n            if (this.value) {\r\n                return new ContextKeyDefinedExpr(this.key);\r\n            }\r\n            return new ContextKeyNotExpr(this.key);\r\n        }\r\n        return this;\r\n    };\r\n    ContextKeyEqualsExpr.prototype.keys = function () {\r\n        return [this.key];\r\n    };\r\n    return ContextKeyEqualsExpr;\r\n}());\r\nexport { ContextKeyEqualsExpr };\r\nvar ContextKeyNotEqualsExpr = /** @class */ (function () {\r\n    function ContextKeyNotEqualsExpr(key, value) {\r\n        this.key = key;\r\n        this.value = value;\r\n    }\r\n    ContextKeyNotEqualsExpr.prototype.getType = function () {\r\n        return 4 /* NotEquals */;\r\n    };\r\n    ContextKeyNotEqualsExpr.prototype.cmp = function (other) {\r\n        if (this.key < other.key) {\r\n            return -1;\r\n        }\r\n        if (this.key > other.key) {\r\n            return 1;\r\n        }\r\n        if (this.value < other.value) {\r\n            return -1;\r\n        }\r\n        if (this.value > other.value) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    ContextKeyNotEqualsExpr.prototype.equals = function (other) {\r\n        if (other instanceof ContextKeyNotEqualsExpr) {\r\n            return (this.key === other.key && this.value === other.value);\r\n        }\r\n        return false;\r\n    };\r\n    ContextKeyNotEqualsExpr.prototype.evaluate = function (context) {\r\n        /* tslint:disable:triple-equals */\r\n        // Intentional !=\r\n        return (context.getValue(this.key) != this.value);\r\n        /* tslint:enable:triple-equals */\r\n    };\r\n    ContextKeyNotEqualsExpr.prototype.normalize = function () {\r\n        if (typeof this.value === 'boolean') {\r\n            if (this.value) {\r\n                return new ContextKeyNotExpr(this.key);\r\n            }\r\n            return new ContextKeyDefinedExpr(this.key);\r\n        }\r\n        return this;\r\n    };\r\n    ContextKeyNotEqualsExpr.prototype.keys = function () {\r\n        return [this.key];\r\n    };\r\n    return ContextKeyNotEqualsExpr;\r\n}());\r\nexport { ContextKeyNotEqualsExpr };\r\nvar ContextKeyNotExpr = /** @class */ (function () {\r\n    function ContextKeyNotExpr(key) {\r\n        this.key = key;\r\n    }\r\n    ContextKeyNotExpr.prototype.getType = function () {\r\n        return 2 /* Not */;\r\n    };\r\n    ContextKeyNotExpr.prototype.cmp = function (other) {\r\n        if (this.key < other.key) {\r\n            return -1;\r\n        }\r\n        if (this.key > other.key) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    ContextKeyNotExpr.prototype.equals = function (other) {\r\n        if (other instanceof ContextKeyNotExpr) {\r\n            return (this.key === other.key);\r\n        }\r\n        return false;\r\n    };\r\n    ContextKeyNotExpr.prototype.evaluate = function (context) {\r\n        return (!context.getValue(this.key));\r\n    };\r\n    ContextKeyNotExpr.prototype.normalize = function () {\r\n        return this;\r\n    };\r\n    ContextKeyNotExpr.prototype.keys = function () {\r\n        return [this.key];\r\n    };\r\n    return ContextKeyNotExpr;\r\n}());\r\nexport { ContextKeyNotExpr };\r\nvar ContextKeyRegexExpr = /** @class */ (function () {\r\n    function ContextKeyRegexExpr(key, regexp) {\r\n        this.key = key;\r\n        this.regexp = regexp;\r\n        //\r\n    }\r\n    ContextKeyRegexExpr.prototype.getType = function () {\r\n        return 6 /* Regex */;\r\n    };\r\n    ContextKeyRegexExpr.prototype.cmp = function (other) {\r\n        if (this.key < other.key) {\r\n            return -1;\r\n        }\r\n        if (this.key > other.key) {\r\n            return 1;\r\n        }\r\n        var thisSource = this.regexp ? this.regexp.source : '';\r\n        var otherSource = other.regexp ? other.regexp.source : '';\r\n        if (thisSource < otherSource) {\r\n            return -1;\r\n        }\r\n        if (thisSource > otherSource) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    ContextKeyRegexExpr.prototype.equals = function (other) {\r\n        if (other instanceof ContextKeyRegexExpr) {\r\n            var thisSource = this.regexp ? this.regexp.source : '';\r\n            var otherSource = other.regexp ? other.regexp.source : '';\r\n            return (this.key === other.key && thisSource === otherSource);\r\n        }\r\n        return false;\r\n    };\r\n    ContextKeyRegexExpr.prototype.evaluate = function (context) {\r\n        var value = context.getValue(this.key);\r\n        return this.regexp ? this.regexp.test(value) : false;\r\n    };\r\n    ContextKeyRegexExpr.prototype.normalize = function () {\r\n        return this;\r\n    };\r\n    ContextKeyRegexExpr.prototype.keys = function () {\r\n        return [this.key];\r\n    };\r\n    return ContextKeyRegexExpr;\r\n}());\r\nexport { ContextKeyRegexExpr };\r\nvar ContextKeyAndExpr = /** @class */ (function () {\r\n    function ContextKeyAndExpr(expr) {\r\n        this.expr = ContextKeyAndExpr._normalizeArr(expr);\r\n    }\r\n    ContextKeyAndExpr.prototype.getType = function () {\r\n        return 5 /* And */;\r\n    };\r\n    ContextKeyAndExpr.prototype.equals = function (other) {\r\n        if (other instanceof ContextKeyAndExpr) {\r\n            if (this.expr.length !== other.expr.length) {\r\n                return false;\r\n            }\r\n            for (var i = 0, len = this.expr.length; i < len; i++) {\r\n                if (!this.expr[i].equals(other.expr[i])) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ContextKeyAndExpr.prototype.evaluate = function (context) {\r\n        for (var i = 0, len = this.expr.length; i < len; i++) {\r\n            if (!this.expr[i].evaluate(context)) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    ContextKeyAndExpr._normalizeArr = function (arr) {\r\n        var expr = [];\r\n        if (arr) {\r\n            for (var i = 0, len = arr.length; i < len; i++) {\r\n                var e = arr[i];\r\n                if (!e) {\r\n                    continue;\r\n                }\r\n                e = e.normalize();\r\n                if (!e) {\r\n                    continue;\r\n                }\r\n                if (e instanceof ContextKeyAndExpr) {\r\n                    expr = expr.concat(e.expr);\r\n                    continue;\r\n                }\r\n                expr.push(e);\r\n            }\r\n            expr.sort(cmp);\r\n        }\r\n        return expr;\r\n    };\r\n    ContextKeyAndExpr.prototype.normalize = function () {\r\n        if (this.expr.length === 0) {\r\n            return null;\r\n        }\r\n        if (this.expr.length === 1) {\r\n            return this.expr[0];\r\n        }\r\n        return this;\r\n    };\r\n    ContextKeyAndExpr.prototype.keys = function () {\r\n        var result = [];\r\n        for (var _i = 0, _a = this.expr; _i < _a.length; _i++) {\r\n            var expr = _a[_i];\r\n            result.push.apply(result, expr.keys());\r\n        }\r\n        return result;\r\n    };\r\n    return ContextKeyAndExpr;\r\n}());\r\nexport { ContextKeyAndExpr };\r\nvar RawContextKey = /** @class */ (function (_super) {\r\n    __extends(RawContextKey, _super);\r\n    function RawContextKey(key, defaultValue) {\r\n        var _this = _super.call(this, key) || this;\r\n        _this._defaultValue = defaultValue;\r\n        return _this;\r\n    }\r\n    RawContextKey.prototype.bindTo = function (target) {\r\n        return target.createKey(this.key, this._defaultValue);\r\n    };\r\n    RawContextKey.prototype.getValue = function (target) {\r\n        return target.getContextKeyValue(this.key);\r\n    };\r\n    RawContextKey.prototype.toNegated = function () {\r\n        return ContextKeyExpr.not(this.key);\r\n    };\r\n    return RawContextKey;\r\n}(ContextKeyDefinedExpr));\r\nexport { RawContextKey };\r\nexport var IContextKeyService = createDecorator('contextKeyService');\r\nexport var SET_CONTEXT_COMMAND_ID = 'setContext';\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Disposable } from './lifecycle.js';\r\nimport { Emitter } from './event.js';\r\nvar Action = /** @class */ (function () {\r\n    function Action(id, label, cssClass, enabled, actionCallback) {\r\n        if (label === void 0) { label = ''; }\r\n        if (cssClass === void 0) { cssClass = ''; }\r\n        if (enabled === void 0) { enabled = true; }\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._id = id;\r\n        this._label = label;\r\n        this._cssClass = cssClass;\r\n        this._enabled = enabled;\r\n        this._actionCallback = actionCallback;\r\n    }\r\n    Object.defineProperty(Action.prototype, \"id\", {\r\n        get: function () {\r\n            return this._id;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Action.prototype, \"label\", {\r\n        get: function () {\r\n            return this._label;\r\n        },\r\n        set: function (value) {\r\n            this._setLabel(value);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Action.prototype._setLabel = function (value) {\r\n        if (this._label !== value) {\r\n            this._label = value;\r\n            this._onDidChange.fire({ label: value });\r\n        }\r\n    };\r\n    Object.defineProperty(Action.prototype, \"tooltip\", {\r\n        get: function () {\r\n            return this._tooltip;\r\n        },\r\n        set: function (value) {\r\n            this._setTooltip(value);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Action.prototype._setTooltip = function (value) {\r\n        if (this._tooltip !== value) {\r\n            this._tooltip = value;\r\n            this._onDidChange.fire({ tooltip: value });\r\n        }\r\n    };\r\n    Object.defineProperty(Action.prototype, \"class\", {\r\n        get: function () {\r\n            return this._cssClass;\r\n        },\r\n        set: function (value) {\r\n            this._setClass(value);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Action.prototype._setClass = function (value) {\r\n        if (this._cssClass !== value) {\r\n            this._cssClass = value;\r\n            this._onDidChange.fire({ class: value });\r\n        }\r\n    };\r\n    Object.defineProperty(Action.prototype, \"enabled\", {\r\n        get: function () {\r\n            return this._enabled;\r\n        },\r\n        set: function (value) {\r\n            this._setEnabled(value);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Action.prototype._setEnabled = function (value) {\r\n        if (this._enabled !== value) {\r\n            this._enabled = value;\r\n            this._onDidChange.fire({ enabled: value });\r\n        }\r\n    };\r\n    Object.defineProperty(Action.prototype, \"checked\", {\r\n        get: function () {\r\n            return this._checked;\r\n        },\r\n        set: function (value) {\r\n            this._setChecked(value);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Action.prototype, \"radio\", {\r\n        get: function () {\r\n            return this._radio;\r\n        },\r\n        set: function (value) {\r\n            this._setRadio(value);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Action.prototype._setChecked = function (value) {\r\n        if (this._checked !== value) {\r\n            this._checked = value;\r\n            this._onDidChange.fire({ checked: value });\r\n        }\r\n    };\r\n    Action.prototype._setRadio = function (value) {\r\n        if (this._radio !== value) {\r\n            this._radio = value;\r\n            this._onDidChange.fire({ radio: value });\r\n        }\r\n    };\r\n    Action.prototype.run = function (event, _data) {\r\n        if (this._actionCallback) {\r\n            return this._actionCallback(event);\r\n        }\r\n        return Promise.resolve(true);\r\n    };\r\n    Action.prototype.dispose = function () {\r\n        this._onDidChange.dispose();\r\n    };\r\n    return Action;\r\n}());\r\nexport { Action };\r\nvar ActionRunner = /** @class */ (function (_super) {\r\n    __extends(ActionRunner, _super);\r\n    function ActionRunner() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._onDidBeforeRun = _this._register(new Emitter());\r\n        _this.onDidBeforeRun = _this._onDidBeforeRun.event;\r\n        _this._onDidRun = _this._register(new Emitter());\r\n        _this.onDidRun = _this._onDidRun.event;\r\n        return _this;\r\n    }\r\n    ActionRunner.prototype.run = function (action, context) {\r\n        var _this = this;\r\n        if (!action.enabled) {\r\n            return Promise.resolve(null);\r\n        }\r\n        this._onDidBeforeRun.fire({ action: action });\r\n        return this.runAction(action, context).then(function (result) {\r\n            _this._onDidRun.fire({ action: action, result: result });\r\n        }, function (error) {\r\n            _this._onDidRun.fire({ action: action, error: error });\r\n        });\r\n    };\r\n    ActionRunner.prototype.runAction = function (action, context) {\r\n        var res = context ? action.run(context) : action.run();\r\n        return Promise.resolve(res);\r\n    };\r\n    return ActionRunner;\r\n}(Disposable));\r\nexport { ActionRunner };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nimport { IContextKeyService } from '../../contextkey/common/contextkey.js';\r\nimport { ICommandService } from '../../commands/common/commands.js';\r\nexport function isIMenuItem(item) {\r\n    return item.command !== undefined;\r\n}\r\nvar MenuId = /** @class */ (function () {\r\n    function MenuId() {\r\n        this.id = String(MenuId.ID++);\r\n    }\r\n    MenuId.ID = 1;\r\n    MenuId.EditorContext = new MenuId();\r\n    MenuId.CommandPalette = new MenuId();\r\n    MenuId.MenubarEditMenu = new MenuId();\r\n    MenuId.MenubarSelectionMenu = new MenuId();\r\n    MenuId.MenubarGoMenu = new MenuId();\r\n    return MenuId;\r\n}());\r\nexport { MenuId };\r\nexport var IMenuService = createDecorator('menuService');\r\nexport var MenuRegistry = new /** @class */ (function () {\r\n    function class_1() {\r\n        this._commands = Object.create(null);\r\n        this._menuItems = Object.create(null);\r\n    }\r\n    class_1.prototype.addCommand = function (command) {\r\n        var old = this._commands[command.id];\r\n        this._commands[command.id] = command;\r\n        return old !== void 0;\r\n    };\r\n    class_1.prototype.getCommand = function (id) {\r\n        return this._commands[id];\r\n    };\r\n    class_1.prototype.getCommands = function () {\r\n        var result = Object.create(null);\r\n        for (var key in this._commands) {\r\n            result[key] = this.getCommand(key);\r\n        }\r\n        return result;\r\n    };\r\n    class_1.prototype.appendMenuItem = function (_a, item) {\r\n        var id = _a.id;\r\n        var array = this._menuItems[id];\r\n        if (!array) {\r\n            this._menuItems[id] = array = [item];\r\n        }\r\n        else {\r\n            array.push(item);\r\n        }\r\n        return {\r\n            dispose: function () {\r\n                var idx = array.indexOf(item);\r\n                if (idx >= 0) {\r\n                    array.splice(idx, 1);\r\n                }\r\n            }\r\n        };\r\n    };\r\n    class_1.prototype.getMenuItems = function (_a) {\r\n        var id = _a.id;\r\n        var result = this._menuItems[id] || [];\r\n        if (id === MenuId.CommandPalette.id) {\r\n            // CommandPalette is special because it shows\r\n            // all commands by default\r\n            this._appendImplicitItems(result);\r\n        }\r\n        return result;\r\n    };\r\n    class_1.prototype._appendImplicitItems = function (result) {\r\n        var set = new Set();\r\n        var temp = result.filter(function (item) { return isIMenuItem(item); });\r\n        for (var _i = 0, temp_1 = temp; _i < temp_1.length; _i++) {\r\n            var _a = temp_1[_i], command = _a.command, alt = _a.alt;\r\n            set.add(command.id);\r\n            if (alt) {\r\n                set.add(alt.id);\r\n            }\r\n        }\r\n        for (var id in this._commands) {\r\n            if (!set.has(id)) {\r\n                result.push({ command: this._commands[id] });\r\n            }\r\n        }\r\n    };\r\n    return class_1;\r\n}());\r\nvar ExecuteCommandAction = /** @class */ (function (_super) {\r\n    __extends(ExecuteCommandAction, _super);\r\n    function ExecuteCommandAction(id, label, _commandService) {\r\n        var _this = _super.call(this, id, label) || this;\r\n        _this._commandService = _commandService;\r\n        return _this;\r\n    }\r\n    ExecuteCommandAction.prototype.run = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var _a;\r\n        return (_a = this._commandService).executeCommand.apply(_a, [this.id].concat(args));\r\n    };\r\n    ExecuteCommandAction = __decorate([\r\n        __param(2, ICommandService)\r\n    ], ExecuteCommandAction);\r\n    return ExecuteCommandAction;\r\n}(Action));\r\nexport { ExecuteCommandAction };\r\nvar SubmenuItemAction = /** @class */ (function (_super) {\r\n    __extends(SubmenuItemAction, _super);\r\n    function SubmenuItemAction(item) {\r\n        var _this = this;\r\n        typeof item.title === 'string' ? _this = _super.call(this, '', item.title, 'submenu') || this : _this = _super.call(this, '', item.title.value, 'submenu') || this;\r\n        _this.item = item;\r\n        return _this;\r\n    }\r\n    return SubmenuItemAction;\r\n}(Action));\r\nexport { SubmenuItemAction };\r\nvar MenuItemAction = /** @class */ (function (_super) {\r\n    __extends(MenuItemAction, _super);\r\n    function MenuItemAction(item, alt, options, contextKeyService, commandService) {\r\n        var _this = this;\r\n        typeof item.title === 'string' ? _this = _super.call(this, item.id, item.title, commandService) || this : _this = _super.call(this, item.id, item.title.value, commandService) || this;\r\n        _this._cssClass = undefined;\r\n        _this._enabled = !item.precondition || contextKeyService.contextMatchesRules(item.precondition);\r\n        _this._checked = Boolean(item.toggled && contextKeyService.contextMatchesRules(item.toggled));\r\n        _this._options = options || {};\r\n        _this.item = item;\r\n        _this.alt = alt ? new MenuItemAction(alt, undefined, _this._options, contextKeyService, commandService) : undefined;\r\n        return _this;\r\n    }\r\n    MenuItemAction.prototype.run = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var runArgs = [];\r\n        if (this._options.arg) {\r\n            runArgs = runArgs.concat([this._options.arg]);\r\n        }\r\n        if (this._options.shouldForwardArgs) {\r\n            runArgs = runArgs.concat(args);\r\n        }\r\n        return _super.prototype.run.apply(this, runArgs);\r\n    };\r\n    MenuItemAction = __decorate([\r\n        __param(3, IContextKeyService),\r\n        __param(4, ICommandService)\r\n    ], MenuItemAction);\r\n    return MenuItemAction;\r\n}(ExecuteCommandAction));\r\nexport { MenuItemAction };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { dispose } from '../../../base/common/lifecycle.js';\r\nimport { IContextKeyService } from '../../contextkey/common/contextkey.js';\r\nimport { MenuRegistry, MenuItemAction, SubmenuItemAction, isIMenuItem } from './actions.js';\r\nimport { ICommandService } from '../../commands/common/commands.js';\r\nvar Menu = /** @class */ (function () {\r\n    function Menu(id, startupSignal, _commandService, _contextKeyService) {\r\n        var _this = this;\r\n        this._commandService = _commandService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._menuGroups = [];\r\n        this._disposables = [];\r\n        this._onDidChange = new Emitter();\r\n        startupSignal.then(function (_) {\r\n            var menuItems = MenuRegistry.getMenuItems(id);\r\n            var keysFilter = new Set();\r\n            var group;\r\n            menuItems.sort(Menu._compareMenuItems);\r\n            for (var _i = 0, menuItems_1 = menuItems; _i < menuItems_1.length; _i++) {\r\n                var item = menuItems_1[_i];\r\n                // group by groupId\r\n                var groupName = item.group;\r\n                if (!group || group[0] !== groupName) {\r\n                    group = [groupName || '', []];\r\n                    _this._menuGroups.push(group);\r\n                }\r\n                group[1].push(item);\r\n                // keep keys for eventing\r\n                Menu._fillInKbExprKeys(item.when, keysFilter);\r\n                // keep precondition keys for event if applicable\r\n                if (isIMenuItem(item) && item.command.precondition) {\r\n                    Menu._fillInKbExprKeys(item.command.precondition, keysFilter);\r\n                }\r\n                // keep toggled keys for event if applicable\r\n                if (isIMenuItem(item) && item.command.toggled) {\r\n                    Menu._fillInKbExprKeys(item.command.toggled, keysFilter);\r\n                }\r\n            }\r\n            // subscribe to context changes\r\n            _this._disposables.push(_this._contextKeyService.onDidChangeContext(function (event) {\r\n                if (event.affectsSome(keysFilter)) {\r\n                    _this._onDidChange.fire();\r\n                }\r\n            }));\r\n            _this._onDidChange.fire(_this);\r\n        });\r\n    }\r\n    Menu.prototype.dispose = function () {\r\n        this._disposables = dispose(this._disposables);\r\n        this._onDidChange.dispose();\r\n    };\r\n    Menu.prototype.getActions = function (options) {\r\n        var result = [];\r\n        for (var _i = 0, _a = this._menuGroups; _i < _a.length; _i++) {\r\n            var group = _a[_i];\r\n            var id = group[0], items = group[1];\r\n            var activeActions = [];\r\n            for (var _b = 0, items_1 = items; _b < items_1.length; _b++) {\r\n                var item = items_1[_b];\r\n                if (this._contextKeyService.contextMatchesRules(item.when || null)) {\r\n                    var action = isIMenuItem(item) ? new MenuItemAction(item.command, item.alt, options, this._contextKeyService, this._commandService) : new SubmenuItemAction(item);\r\n                    activeActions.push(action);\r\n                }\r\n            }\r\n            if (activeActions.length > 0) {\r\n                result.push([id, activeActions]);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    Menu._fillInKbExprKeys = function (exp, set) {\r\n        if (exp) {\r\n            for (var _i = 0, _a = exp.keys(); _i < _a.length; _i++) {\r\n                var key = _a[_i];\r\n                set.add(key);\r\n            }\r\n        }\r\n    };\r\n    Menu._compareMenuItems = function (a, b) {\r\n        var aGroup = a.group;\r\n        var bGroup = b.group;\r\n        if (aGroup !== bGroup) {\r\n            // Falsy groups come last\r\n            if (!aGroup) {\r\n                return 1;\r\n            }\r\n            else if (!bGroup) {\r\n                return -1;\r\n            }\r\n            // 'navigation' group comes first\r\n            if (aGroup === 'navigation') {\r\n                return -1;\r\n            }\r\n            else if (bGroup === 'navigation') {\r\n                return 1;\r\n            }\r\n            // lexical sort for groups\r\n            var value = aGroup.localeCompare(bGroup);\r\n            if (value !== 0) {\r\n                return value;\r\n            }\r\n        }\r\n        // sort on priority - default is 0\r\n        var aPrio = a.order || 0;\r\n        var bPrio = b.order || 0;\r\n        if (aPrio < bPrio) {\r\n            return -1;\r\n        }\r\n        else if (aPrio > bPrio) {\r\n            return 1;\r\n        }\r\n        // sort on titles\r\n        var aTitle = typeof a.command.title === 'string' ? a.command.title : a.command.title.value;\r\n        var bTitle = typeof b.command.title === 'string' ? b.command.title : b.command.title.value;\r\n        return aTitle.localeCompare(bTitle);\r\n    };\r\n    Menu = __decorate([\r\n        __param(2, ICommandService),\r\n        __param(3, IContextKeyService)\r\n    ], Menu);\r\n    return Menu;\r\n}());\r\nexport { Menu };\r\n","import { Registry } from '../../registry/common/platform.js';\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nimport { Extensions } from './configurationRegistry.js';\r\nexport var IConfigurationService = createDecorator('configurationService');\r\nexport function toValuesTree(properties, conflictReporter) {\r\n    var root = Object.create(null);\r\n    for (var key in properties) {\r\n        addToValueTree(root, key, properties[key], conflictReporter);\r\n    }\r\n    return root;\r\n}\r\nexport function addToValueTree(settingsTreeRoot, key, value, conflictReporter) {\r\n    var segments = key.split('.');\r\n    var last = segments.pop();\r\n    var curr = settingsTreeRoot;\r\n    for (var i = 0; i < segments.length; i++) {\r\n        var s = segments[i];\r\n        var obj = curr[s];\r\n        switch (typeof obj) {\r\n            case 'undefined':\r\n                obj = curr[s] = Object.create(null);\r\n                break;\r\n            case 'object':\r\n                break;\r\n            default:\r\n                conflictReporter(\"Ignoring \" + key + \" as \" + segments.slice(0, i + 1).join('.') + \" is \" + JSON.stringify(obj));\r\n                return;\r\n        }\r\n        curr = obj;\r\n    }\r\n    if (typeof curr === 'object') {\r\n        curr[last] = value; // workaround https://github.com/Microsoft/vscode/issues/13606\r\n    }\r\n    else {\r\n        conflictReporter(\"Ignoring \" + key + \" as \" + segments.join('.') + \" is \" + JSON.stringify(curr));\r\n    }\r\n}\r\nexport function removeFromValueTree(valueTree, key) {\r\n    var segments = key.split('.');\r\n    doRemoveFromValueTree(valueTree, segments);\r\n}\r\nfunction doRemoveFromValueTree(valueTree, segments) {\r\n    var first = segments.shift();\r\n    if (segments.length === 0) {\r\n        // Reached last segment\r\n        delete valueTree[first];\r\n        return;\r\n    }\r\n    if (Object.keys(valueTree).indexOf(first) !== -1) {\r\n        var value = valueTree[first];\r\n        if (typeof value === 'object' && !Array.isArray(value)) {\r\n            doRemoveFromValueTree(value, segments);\r\n            if (Object.keys(value).length === 0) {\r\n                delete valueTree[first];\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * A helper function to get the configuration value with a specific settings path (e.g. config.some.setting)\r\n */\r\nexport function getConfigurationValue(config, settingPath, defaultValue) {\r\n    function accessSetting(config, path) {\r\n        var current = config;\r\n        for (var i = 0; i < path.length; i++) {\r\n            if (typeof current !== 'object' || current === null) {\r\n                return undefined;\r\n            }\r\n            current = current[path[i]];\r\n        }\r\n        return current;\r\n    }\r\n    var path = settingPath.split('.');\r\n    var result = accessSetting(config, path);\r\n    return typeof result === 'undefined' ? defaultValue : result;\r\n}\r\nexport function getConfigurationKeys() {\r\n    var properties = Registry.as(Extensions.Configuration).getConfigurationProperties();\r\n    return Object.keys(properties);\r\n}\r\nexport function getDefaultValues() {\r\n    var valueTreeRoot = Object.create(null);\r\n    var properties = Registry.as(Extensions.Configuration).getConfigurationProperties();\r\n    for (var key in properties) {\r\n        var value = properties[key].default;\r\n        addToValueTree(valueTreeRoot, key, value, function (message) { return console.error(\"Conflict in default settings: \" + message); });\r\n    }\r\n    return valueTreeRoot;\r\n}\r\nexport function overrideIdentifierFromKey(key) {\r\n    return key.substring(1, key.length - 1);\r\n}\r\n","var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { ResourceMap } from '../../../base/common/map.js';\r\nimport * as arrays from '../../../base/common/arrays.js';\r\nimport * as types from '../../../base/common/types.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport { OVERRIDE_PROPERTY_PATTERN } from './configurationRegistry.js';\r\nimport { overrideIdentifierFromKey, addToValueTree, toValuesTree, getConfigurationValue, getDefaultValues, getConfigurationKeys, removeFromValueTree } from './configuration.js';\r\nvar ConfigurationModel = /** @class */ (function () {\r\n    function ConfigurationModel(_contents, _keys, _overrides) {\r\n        if (_contents === void 0) { _contents = {}; }\r\n        if (_keys === void 0) { _keys = []; }\r\n        if (_overrides === void 0) { _overrides = []; }\r\n        this._contents = _contents;\r\n        this._keys = _keys;\r\n        this._overrides = _overrides;\r\n        this.isFrozen = false;\r\n    }\r\n    Object.defineProperty(ConfigurationModel.prototype, \"contents\", {\r\n        get: function () {\r\n            return this.checkAndFreeze(this._contents);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ConfigurationModel.prototype, \"overrides\", {\r\n        get: function () {\r\n            return this.checkAndFreeze(this._overrides);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ConfigurationModel.prototype, \"keys\", {\r\n        get: function () {\r\n            return this.checkAndFreeze(this._keys);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ConfigurationModel.prototype.getValue = function (section) {\r\n        return section ? getConfigurationValue(this.contents, section) : this.contents;\r\n    };\r\n    ConfigurationModel.prototype.override = function (identifier) {\r\n        var overrideContents = this.getContentsForOverrideIdentifer(identifier);\r\n        if (!overrideContents || typeof overrideContents !== 'object' || !Object.keys(overrideContents).length) {\r\n            // If there are no valid overrides, return self\r\n            return this;\r\n        }\r\n        var contents = {};\r\n        for (var _i = 0, _a = arrays.distinct(Object.keys(this.contents).concat(Object.keys(overrideContents))); _i < _a.length; _i++) {\r\n            var key = _a[_i];\r\n            var contentsForKey = this.contents[key];\r\n            var overrideContentsForKey = overrideContents[key];\r\n            // If there are override contents for the key, clone and merge otherwise use base contents\r\n            if (overrideContentsForKey) {\r\n                // Clone and merge only if base contents and override contents are of type object otherwise just override\r\n                if (typeof contentsForKey === 'object' && typeof overrideContentsForKey === 'object') {\r\n                    contentsForKey = objects.deepClone(contentsForKey);\r\n                    this.mergeContents(contentsForKey, overrideContentsForKey);\r\n                }\r\n                else {\r\n                    contentsForKey = overrideContentsForKey;\r\n                }\r\n            }\r\n            contents[key] = contentsForKey;\r\n        }\r\n        return new ConfigurationModel(contents);\r\n    };\r\n    ConfigurationModel.prototype.merge = function () {\r\n        var others = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            others[_i] = arguments[_i];\r\n        }\r\n        var contents = objects.deepClone(this.contents);\r\n        var overrides = objects.deepClone(this.overrides);\r\n        var keys = this.keys.slice();\r\n        for (var _a = 0, others_1 = others; _a < others_1.length; _a++) {\r\n            var other = others_1[_a];\r\n            this.mergeContents(contents, other.contents);\r\n            var _loop_1 = function (otherOverride) {\r\n                var override = overrides.filter(function (o) { return arrays.equals(o.identifiers, otherOverride.identifiers); })[0];\r\n                if (override) {\r\n                    this_1.mergeContents(override.contents, otherOverride.contents);\r\n                }\r\n                else {\r\n                    overrides.push(objects.deepClone(otherOverride));\r\n                }\r\n            };\r\n            var this_1 = this;\r\n            for (var _b = 0, _c = other.overrides; _b < _c.length; _b++) {\r\n                var otherOverride = _c[_b];\r\n                _loop_1(otherOverride);\r\n            }\r\n            for (var _d = 0, _e = other.keys; _d < _e.length; _d++) {\r\n                var key = _e[_d];\r\n                if (keys.indexOf(key) === -1) {\r\n                    keys.push(key);\r\n                }\r\n            }\r\n        }\r\n        return new ConfigurationModel(contents, keys, overrides);\r\n    };\r\n    ConfigurationModel.prototype.freeze = function () {\r\n        this.isFrozen = true;\r\n        return this;\r\n    };\r\n    ConfigurationModel.prototype.mergeContents = function (source, target) {\r\n        for (var _i = 0, _a = Object.keys(target); _i < _a.length; _i++) {\r\n            var key = _a[_i];\r\n            if (key in source) {\r\n                if (types.isObject(source[key]) && types.isObject(target[key])) {\r\n                    this.mergeContents(source[key], target[key]);\r\n                    continue;\r\n                }\r\n            }\r\n            source[key] = objects.deepClone(target[key]);\r\n        }\r\n    };\r\n    ConfigurationModel.prototype.checkAndFreeze = function (data) {\r\n        if (this.isFrozen && !Object.isFrozen(data)) {\r\n            return objects.deepFreeze(data);\r\n        }\r\n        return data;\r\n    };\r\n    ConfigurationModel.prototype.getContentsForOverrideIdentifer = function (identifier) {\r\n        for (var _i = 0, _a = this.overrides; _i < _a.length; _i++) {\r\n            var override = _a[_i];\r\n            if (override.identifiers.indexOf(identifier) !== -1) {\r\n                return override.contents;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    ConfigurationModel.prototype.toJSON = function () {\r\n        return {\r\n            contents: this.contents,\r\n            overrides: this.overrides,\r\n            keys: this.keys\r\n        };\r\n    };\r\n    // Update methods\r\n    ConfigurationModel.prototype.setValue = function (key, value) {\r\n        this.addKey(key);\r\n        addToValueTree(this.contents, key, value, function (e) { throw new Error(e); });\r\n    };\r\n    ConfigurationModel.prototype.removeValue = function (key) {\r\n        if (this.removeKey(key)) {\r\n            removeFromValueTree(this.contents, key);\r\n        }\r\n    };\r\n    ConfigurationModel.prototype.addKey = function (key) {\r\n        var index = this.keys.length;\r\n        for (var i = 0; i < index; i++) {\r\n            if (key.indexOf(this.keys[i]) === 0) {\r\n                index = i;\r\n            }\r\n        }\r\n        this.keys.splice(index, 1, key);\r\n    };\r\n    ConfigurationModel.prototype.removeKey = function (key) {\r\n        var index = this.keys.indexOf(key);\r\n        if (index !== -1) {\r\n            this.keys.splice(index, 1);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return ConfigurationModel;\r\n}());\r\nexport { ConfigurationModel };\r\nvar DefaultConfigurationModel = /** @class */ (function (_super) {\r\n    __extends(DefaultConfigurationModel, _super);\r\n    function DefaultConfigurationModel() {\r\n        var _this = this;\r\n        var contents = getDefaultValues();\r\n        var keys = getConfigurationKeys();\r\n        var overrides = [];\r\n        for (var _i = 0, _a = Object.keys(contents); _i < _a.length; _i++) {\r\n            var key = _a[_i];\r\n            if (OVERRIDE_PROPERTY_PATTERN.test(key)) {\r\n                overrides.push({\r\n                    identifiers: [overrideIdentifierFromKey(key).trim()],\r\n                    contents: toValuesTree(contents[key], function (message) { return console.error(\"Conflict in default settings file: \" + message); })\r\n                });\r\n            }\r\n        }\r\n        _this = _super.call(this, contents, keys, overrides) || this;\r\n        return _this;\r\n    }\r\n    return DefaultConfigurationModel;\r\n}(ConfigurationModel));\r\nexport { DefaultConfigurationModel };\r\nvar Configuration = /** @class */ (function () {\r\n    function Configuration(_defaultConfiguration, _userConfiguration, _workspaceConfiguration, _folderConfigurations, _memoryConfiguration, _memoryConfigurationByResource, _freeze) {\r\n        if (_workspaceConfiguration === void 0) { _workspaceConfiguration = new ConfigurationModel(); }\r\n        if (_folderConfigurations === void 0) { _folderConfigurations = new ResourceMap(); }\r\n        if (_memoryConfiguration === void 0) { _memoryConfiguration = new ConfigurationModel(); }\r\n        if (_memoryConfigurationByResource === void 0) { _memoryConfigurationByResource = new ResourceMap(); }\r\n        if (_freeze === void 0) { _freeze = true; }\r\n        this._defaultConfiguration = _defaultConfiguration;\r\n        this._userConfiguration = _userConfiguration;\r\n        this._workspaceConfiguration = _workspaceConfiguration;\r\n        this._folderConfigurations = _folderConfigurations;\r\n        this._memoryConfiguration = _memoryConfiguration;\r\n        this._memoryConfigurationByResource = _memoryConfigurationByResource;\r\n        this._freeze = _freeze;\r\n        this._workspaceConsolidatedConfiguration = null;\r\n        this._foldersConsolidatedConfigurations = new ResourceMap();\r\n    }\r\n    Configuration.prototype.getValue = function (section, overrides, workspace) {\r\n        var consolidateConfigurationModel = this.getConsolidateConfigurationModel(overrides, workspace);\r\n        return consolidateConfigurationModel.getValue(section);\r\n    };\r\n    Configuration.prototype.updateValue = function (key, value, overrides) {\r\n        if (overrides === void 0) { overrides = {}; }\r\n        var memoryConfiguration;\r\n        if (overrides.resource) {\r\n            memoryConfiguration = this._memoryConfigurationByResource.get(overrides.resource);\r\n            if (!memoryConfiguration) {\r\n                memoryConfiguration = new ConfigurationModel();\r\n                this._memoryConfigurationByResource.set(overrides.resource, memoryConfiguration);\r\n            }\r\n        }\r\n        else {\r\n            memoryConfiguration = this._memoryConfiguration;\r\n        }\r\n        if (value === void 0) {\r\n            memoryConfiguration.removeValue(key);\r\n        }\r\n        else {\r\n            memoryConfiguration.setValue(key, value);\r\n        }\r\n        if (!overrides.resource) {\r\n            this._workspaceConsolidatedConfiguration = null;\r\n        }\r\n    };\r\n    Configuration.prototype.getConsolidateConfigurationModel = function (overrides, workspace) {\r\n        var configurationModel = this.getConsolidatedConfigurationModelForResource(overrides, workspace);\r\n        return overrides.overrideIdentifier ? configurationModel.override(overrides.overrideIdentifier) : configurationModel;\r\n    };\r\n    Configuration.prototype.getConsolidatedConfigurationModelForResource = function (_a, workspace) {\r\n        var resource = _a.resource;\r\n        var consolidateConfiguration = this.getWorkspaceConsolidatedConfiguration();\r\n        if (workspace && resource) {\r\n            var root = workspace.getFolder(resource);\r\n            if (root) {\r\n                consolidateConfiguration = this.getFolderConsolidatedConfiguration(root.uri) || consolidateConfiguration;\r\n            }\r\n            var memoryConfigurationForResource = this._memoryConfigurationByResource.get(resource);\r\n            if (memoryConfigurationForResource) {\r\n                consolidateConfiguration = consolidateConfiguration.merge(memoryConfigurationForResource);\r\n            }\r\n        }\r\n        return consolidateConfiguration;\r\n    };\r\n    Configuration.prototype.getWorkspaceConsolidatedConfiguration = function () {\r\n        if (!this._workspaceConsolidatedConfiguration) {\r\n            this._workspaceConsolidatedConfiguration = this._defaultConfiguration.merge(this._userConfiguration, this._workspaceConfiguration, this._memoryConfiguration);\r\n            if (this._freeze) {\r\n                this._workspaceConfiguration = this._workspaceConfiguration.freeze();\r\n            }\r\n        }\r\n        return this._workspaceConsolidatedConfiguration;\r\n    };\r\n    Configuration.prototype.getFolderConsolidatedConfiguration = function (folder) {\r\n        var folderConsolidatedConfiguration = this._foldersConsolidatedConfigurations.get(folder);\r\n        if (!folderConsolidatedConfiguration) {\r\n            var workspaceConsolidateConfiguration = this.getWorkspaceConsolidatedConfiguration();\r\n            var folderConfiguration = this._folderConfigurations.get(folder);\r\n            if (folderConfiguration) {\r\n                folderConsolidatedConfiguration = workspaceConsolidateConfiguration.merge(folderConfiguration);\r\n                if (this._freeze) {\r\n                    folderConsolidatedConfiguration = folderConsolidatedConfiguration.freeze();\r\n                }\r\n                this._foldersConsolidatedConfigurations.set(folder, folderConsolidatedConfiguration);\r\n            }\r\n            else {\r\n                folderConsolidatedConfiguration = workspaceConsolidateConfiguration;\r\n            }\r\n        }\r\n        return folderConsolidatedConfiguration;\r\n    };\r\n    return Configuration;\r\n}());\r\nexport { Configuration };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { IntervalTimer } from '../../../base/common/async.js';\r\nimport { Emitter, Event } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nvar AbstractKeybindingService = /** @class */ (function (_super) {\r\n    __extends(AbstractKeybindingService, _super);\r\n    function AbstractKeybindingService(contextKeyService, commandService, telemetryService, notificationService, statusService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._contextKeyService = contextKeyService;\r\n        _this._commandService = commandService;\r\n        _this._telemetryService = telemetryService;\r\n        _this._statusService = statusService;\r\n        _this._notificationService = notificationService;\r\n        _this._currentChord = null;\r\n        _this._currentChordChecker = new IntervalTimer();\r\n        _this._currentChordStatusMessage = null;\r\n        _this._onDidUpdateKeybindings = _this._register(new Emitter());\r\n        return _this;\r\n    }\r\n    AbstractKeybindingService.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    Object.defineProperty(AbstractKeybindingService.prototype, \"onDidUpdateKeybindings\", {\r\n        get: function () {\r\n            return this._onDidUpdateKeybindings ? this._onDidUpdateKeybindings.event : Event.None; // Sinon stubbing walks properties on prototype\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AbstractKeybindingService.prototype.lookupKeybinding = function (commandId) {\r\n        var result = this._getResolver().lookupPrimaryKeybinding(commandId);\r\n        if (!result) {\r\n            return null;\r\n        }\r\n        return result.resolvedKeybinding;\r\n    };\r\n    AbstractKeybindingService.prototype._enterChordMode = function (firstPart, keypressLabel) {\r\n        var _this = this;\r\n        this._currentChord = {\r\n            keypress: firstPart,\r\n            label: keypressLabel\r\n        };\r\n        if (this._statusService) {\r\n            this._currentChordStatusMessage = this._statusService.setStatusMessage(nls.localize('first.chord', \"({0}) was pressed. Waiting for second key of chord...\", keypressLabel));\r\n        }\r\n        var chordEnterTime = Date.now();\r\n        this._currentChordChecker.cancelAndSet(function () {\r\n            if (!_this._documentHasFocus()) {\r\n                // Focus has been lost => leave chord mode\r\n                _this._leaveChordMode();\r\n                return;\r\n            }\r\n            if (Date.now() - chordEnterTime > 5000) {\r\n                // 5 seconds elapsed => leave chord mode\r\n                _this._leaveChordMode();\r\n            }\r\n        }, 500);\r\n    };\r\n    AbstractKeybindingService.prototype._leaveChordMode = function () {\r\n        if (this._currentChordStatusMessage) {\r\n            this._currentChordStatusMessage.dispose();\r\n            this._currentChordStatusMessage = null;\r\n        }\r\n        this._currentChordChecker.cancel();\r\n        this._currentChord = null;\r\n    };\r\n    AbstractKeybindingService.prototype._dispatch = function (e, target) {\r\n        var _this = this;\r\n        var shouldPreventDefault = false;\r\n        var keybinding = this.resolveKeyboardEvent(e);\r\n        if (keybinding.isChord()) {\r\n            console.warn('Unexpected keyboard event mapped to a chord');\r\n            return false;\r\n        }\r\n        var firstPart = keybinding.getDispatchParts()[0];\r\n        if (firstPart === null) {\r\n            // cannot be dispatched, probably only modifier keys\r\n            return shouldPreventDefault;\r\n        }\r\n        var contextValue = this._contextKeyService.getContext(target);\r\n        var currentChord = this._currentChord ? this._currentChord.keypress : null;\r\n        var keypressLabel = keybinding.getLabel();\r\n        var resolveResult = this._getResolver().resolve(contextValue, currentChord, firstPart);\r\n        if (resolveResult && resolveResult.enterChord) {\r\n            shouldPreventDefault = true;\r\n            this._enterChordMode(firstPart, keypressLabel);\r\n            return shouldPreventDefault;\r\n        }\r\n        if (this._statusService && this._currentChord) {\r\n            if (!resolveResult || !resolveResult.commandId) {\r\n                this._statusService.setStatusMessage(nls.localize('missing.chord', \"The key combination ({0}, {1}) is not a command.\", this._currentChord.label, keypressLabel), 10 * 1000 /* 10s */);\r\n                shouldPreventDefault = true;\r\n            }\r\n        }\r\n        this._leaveChordMode();\r\n        if (resolveResult && resolveResult.commandId) {\r\n            if (!resolveResult.bubble) {\r\n                shouldPreventDefault = true;\r\n            }\r\n            if (typeof resolveResult.commandArgs === 'undefined') {\r\n                this._commandService.executeCommand(resolveResult.commandId).then(undefined, function (err) { return _this._notificationService.warn(err); });\r\n            }\r\n            else {\r\n                this._commandService.executeCommand(resolveResult.commandId, resolveResult.commandArgs).then(undefined, function (err) { return _this._notificationService.warn(err); });\r\n            }\r\n            /* __GDPR__\r\n                \"workbenchActionExecuted\" : {\r\n                    \"id\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\r\n                    \"from\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\r\n                }\r\n            */\r\n            this._telemetryService.publicLog('workbenchActionExecuted', { id: resolveResult.commandId, from: 'keybinding' });\r\n        }\r\n        return shouldPreventDefault;\r\n    };\r\n    return AbstractKeybindingService;\r\n}(Disposable));\r\nexport { AbstractKeybindingService };\r\n","import { ContextKeyAndExpr } from '../../contextkey/common/contextkey.js';\r\nvar KeybindingResolver = /** @class */ (function () {\r\n    function KeybindingResolver(defaultKeybindings, overrides) {\r\n        this._defaultKeybindings = defaultKeybindings;\r\n        this._defaultBoundCommands = new Map();\r\n        for (var i = 0, len = defaultKeybindings.length; i < len; i++) {\r\n            var command = defaultKeybindings[i].command;\r\n            if (command) {\r\n                this._defaultBoundCommands.set(command, true);\r\n            }\r\n        }\r\n        this._map = new Map();\r\n        this._lookupMap = new Map();\r\n        this._keybindings = KeybindingResolver.combine(defaultKeybindings, overrides);\r\n        for (var i = 0, len = this._keybindings.length; i < len; i++) {\r\n            var k = this._keybindings[i];\r\n            if (k.keypressFirstPart === null) {\r\n                // unbound\r\n                continue;\r\n            }\r\n            this._addKeyPress(k.keypressFirstPart, k);\r\n        }\r\n    }\r\n    KeybindingResolver._isTargetedForRemoval = function (defaultKb, keypressFirstPart, keypressChordPart, command, when) {\r\n        if (defaultKb.command !== command) {\r\n            return false;\r\n        }\r\n        if (keypressFirstPart && defaultKb.keypressFirstPart !== keypressFirstPart) {\r\n            return false;\r\n        }\r\n        if (keypressChordPart && defaultKb.keypressChordPart !== keypressChordPart) {\r\n            return false;\r\n        }\r\n        if (when) {\r\n            if (!defaultKb.when) {\r\n                return false;\r\n            }\r\n            if (!when.equals(defaultKb.when)) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * Looks for rules containing -command in `overrides` and removes them directly from `defaults`.\r\n     */\r\n    KeybindingResolver.combine = function (defaults, rawOverrides) {\r\n        defaults = defaults.slice(0);\r\n        var overrides = [];\r\n        for (var i = 0, len = rawOverrides.length; i < len; i++) {\r\n            var override = rawOverrides[i];\r\n            if (!override.command || override.command.length === 0 || override.command.charAt(0) !== '-') {\r\n                overrides.push(override);\r\n                continue;\r\n            }\r\n            var command = override.command.substr(1);\r\n            var keypressFirstPart = override.keypressFirstPart;\r\n            var keypressChordPart = override.keypressChordPart;\r\n            var when = override.when;\r\n            for (var j = defaults.length - 1; j >= 0; j--) {\r\n                if (this._isTargetedForRemoval(defaults[j], keypressFirstPart, keypressChordPart, command, when)) {\r\n                    defaults.splice(j, 1);\r\n                }\r\n            }\r\n        }\r\n        return defaults.concat(overrides);\r\n    };\r\n    KeybindingResolver.prototype._addKeyPress = function (keypress, item) {\r\n        var conflicts = this._map.get(keypress);\r\n        if (typeof conflicts === 'undefined') {\r\n            // There is no conflict so far\r\n            this._map.set(keypress, [item]);\r\n            this._addToLookupMap(item);\r\n            return;\r\n        }\r\n        for (var i = conflicts.length - 1; i >= 0; i--) {\r\n            var conflict = conflicts[i];\r\n            if (conflict.command === item.command) {\r\n                continue;\r\n            }\r\n            var conflictIsChord = (conflict.keypressChordPart !== null);\r\n            var itemIsChord = (item.keypressChordPart !== null);\r\n            if (conflictIsChord && itemIsChord && conflict.keypressChordPart !== item.keypressChordPart) {\r\n                // The conflict only shares the chord start with this command\r\n                continue;\r\n            }\r\n            if (KeybindingResolver.whenIsEntirelyIncluded(conflict.when, item.when)) {\r\n                // `item` completely overwrites `conflict`\r\n                // Remove conflict from the lookupMap\r\n                this._removeFromLookupMap(conflict);\r\n            }\r\n        }\r\n        conflicts.push(item);\r\n        this._addToLookupMap(item);\r\n    };\r\n    KeybindingResolver.prototype._addToLookupMap = function (item) {\r\n        if (!item.command) {\r\n            return;\r\n        }\r\n        var arr = this._lookupMap.get(item.command);\r\n        if (typeof arr === 'undefined') {\r\n            arr = [item];\r\n            this._lookupMap.set(item.command, arr);\r\n        }\r\n        else {\r\n            arr.push(item);\r\n        }\r\n    };\r\n    KeybindingResolver.prototype._removeFromLookupMap = function (item) {\r\n        if (!item.command) {\r\n            return;\r\n        }\r\n        var arr = this._lookupMap.get(item.command);\r\n        if (typeof arr === 'undefined') {\r\n            return;\r\n        }\r\n        for (var i = 0, len = arr.length; i < len; i++) {\r\n            if (arr[i] === item) {\r\n                arr.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Returns true if it is provable `a` implies `b`.\r\n     * **Precondition**: Assumes `a` and `b` are normalized!\r\n     */\r\n    KeybindingResolver.whenIsEntirelyIncluded = function (a, b) {\r\n        if (!b) {\r\n            return true;\r\n        }\r\n        if (!a) {\r\n            return false;\r\n        }\r\n        var aExpressions = ((a instanceof ContextKeyAndExpr) ? a.expr : [a]);\r\n        var bExpressions = ((b instanceof ContextKeyAndExpr) ? b.expr : [b]);\r\n        var aIndex = 0;\r\n        for (var bIndex = 0; bIndex < bExpressions.length; bIndex++) {\r\n            var bExpr = bExpressions[bIndex];\r\n            var bExprMatched = false;\r\n            while (!bExprMatched && aIndex < aExpressions.length) {\r\n                var aExpr = aExpressions[aIndex];\r\n                if (aExpr.equals(bExpr)) {\r\n                    bExprMatched = true;\r\n                }\r\n                aIndex++;\r\n            }\r\n            if (!bExprMatched) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    KeybindingResolver.prototype.lookupPrimaryKeybinding = function (commandId) {\r\n        var items = this._lookupMap.get(commandId);\r\n        if (typeof items === 'undefined' || items.length === 0) {\r\n            return null;\r\n        }\r\n        return items[items.length - 1];\r\n    };\r\n    KeybindingResolver.prototype.resolve = function (context, currentChord, keypress) {\r\n        var lookupMap = null;\r\n        if (currentChord !== null) {\r\n            // Fetch all chord bindings for `currentChord`\r\n            var candidates = this._map.get(currentChord);\r\n            if (typeof candidates === 'undefined') {\r\n                // No chords starting with `currentChord`\r\n                return null;\r\n            }\r\n            lookupMap = [];\r\n            for (var i = 0, len = candidates.length; i < len; i++) {\r\n                var candidate = candidates[i];\r\n                if (candidate.keypressChordPart === keypress) {\r\n                    lookupMap.push(candidate);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            var candidates = this._map.get(keypress);\r\n            if (typeof candidates === 'undefined') {\r\n                // No bindings with `keypress`\r\n                return null;\r\n            }\r\n            lookupMap = candidates;\r\n        }\r\n        var result = this._findCommand(context, lookupMap);\r\n        if (!result) {\r\n            return null;\r\n        }\r\n        if (currentChord === null && result.keypressChordPart !== null) {\r\n            return {\r\n                enterChord: true,\r\n                commandId: null,\r\n                commandArgs: null,\r\n                bubble: false\r\n            };\r\n        }\r\n        return {\r\n            enterChord: false,\r\n            commandId: result.command,\r\n            commandArgs: result.commandArgs,\r\n            bubble: result.bubble\r\n        };\r\n    };\r\n    KeybindingResolver.prototype._findCommand = function (context, matches) {\r\n        for (var i = matches.length - 1; i >= 0; i--) {\r\n            var k = matches[i];\r\n            if (!KeybindingResolver.contextMatchesRules(context, k.when)) {\r\n                continue;\r\n            }\r\n            return k;\r\n        }\r\n        return null;\r\n    };\r\n    KeybindingResolver.contextMatchesRules = function (context, rules) {\r\n        if (!rules) {\r\n            return true;\r\n        }\r\n        return rules.evaluate(context);\r\n    };\r\n    return KeybindingResolver;\r\n}());\r\nexport { KeybindingResolver };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createKeybinding } from '../../../base/common/keyCodes.js';\r\nimport { OS } from '../../../base/common/platform.js';\r\nimport { CommandsRegistry } from '../../commands/common/commands.js';\r\nimport { Registry } from '../../registry/common/platform.js';\r\nvar KeybindingsRegistryImpl = /** @class */ (function () {\r\n    function KeybindingsRegistryImpl() {\r\n        this._keybindings = [];\r\n        this._keybindingsSorted = true;\r\n    }\r\n    /**\r\n     * Take current platform into account and reduce to primary & secondary.\r\n     */\r\n    KeybindingsRegistryImpl.bindToCurrentPlatform = function (kb) {\r\n        if (OS === 1 /* Windows */) {\r\n            if (kb && kb.win) {\r\n                return kb.win;\r\n            }\r\n        }\r\n        else if (OS === 2 /* Macintosh */) {\r\n            if (kb && kb.mac) {\r\n                return kb.mac;\r\n            }\r\n        }\r\n        else {\r\n            if (kb && kb.linux) {\r\n                return kb.linux;\r\n            }\r\n        }\r\n        return kb;\r\n    };\r\n    KeybindingsRegistryImpl.prototype.registerKeybindingRule = function (rule, source) {\r\n        if (source === void 0) { source = 0 /* Core */; }\r\n        var actualKb = KeybindingsRegistryImpl.bindToCurrentPlatform(rule);\r\n        if (actualKb && actualKb.primary) {\r\n            var kk = createKeybinding(actualKb.primary, OS);\r\n            if (kk) {\r\n                this._registerDefaultKeybinding(kk, rule.id, rule.weight, 0, rule.when, source);\r\n            }\r\n        }\r\n        if (actualKb && Array.isArray(actualKb.secondary)) {\r\n            for (var i = 0, len = actualKb.secondary.length; i < len; i++) {\r\n                var k = actualKb.secondary[i];\r\n                var kk = createKeybinding(k, OS);\r\n                if (kk) {\r\n                    this._registerDefaultKeybinding(kk, rule.id, rule.weight, -i - 1, rule.when, source);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    KeybindingsRegistryImpl.prototype.registerCommandAndKeybindingRule = function (desc, source) {\r\n        if (source === void 0) { source = 0 /* Core */; }\r\n        this.registerKeybindingRule(desc, source);\r\n        CommandsRegistry.registerCommand(desc);\r\n    };\r\n    KeybindingsRegistryImpl._mightProduceChar = function (keyCode) {\r\n        if (keyCode >= 21 /* KEY_0 */ && keyCode <= 30 /* KEY_9 */) {\r\n            return true;\r\n        }\r\n        if (keyCode >= 31 /* KEY_A */ && keyCode <= 56 /* KEY_Z */) {\r\n            return true;\r\n        }\r\n        return (keyCode === 80 /* US_SEMICOLON */\r\n            || keyCode === 81 /* US_EQUAL */\r\n            || keyCode === 82 /* US_COMMA */\r\n            || keyCode === 83 /* US_MINUS */\r\n            || keyCode === 84 /* US_DOT */\r\n            || keyCode === 85 /* US_SLASH */\r\n            || keyCode === 86 /* US_BACKTICK */\r\n            || keyCode === 110 /* ABNT_C1 */\r\n            || keyCode === 111 /* ABNT_C2 */\r\n            || keyCode === 87 /* US_OPEN_SQUARE_BRACKET */\r\n            || keyCode === 88 /* US_BACKSLASH */\r\n            || keyCode === 89 /* US_CLOSE_SQUARE_BRACKET */\r\n            || keyCode === 90 /* US_QUOTE */\r\n            || keyCode === 91 /* OEM_8 */\r\n            || keyCode === 92 /* OEM_102 */);\r\n    };\r\n    KeybindingsRegistryImpl.prototype._assertNoCtrlAlt = function (keybinding, commandId) {\r\n        if (keybinding.ctrlKey && keybinding.altKey && !keybinding.metaKey) {\r\n            if (KeybindingsRegistryImpl._mightProduceChar(keybinding.keyCode)) {\r\n                console.warn('Ctrl+Alt+ keybindings should not be used by default under Windows. Offender: ', keybinding, ' for ', commandId);\r\n            }\r\n        }\r\n    };\r\n    KeybindingsRegistryImpl.prototype._registerDefaultKeybinding = function (keybinding, commandId, weight1, weight2, when, source) {\r\n        if (source === 0 /* Core */ && OS === 1 /* Windows */) {\r\n            if (keybinding.type === 2 /* Chord */) {\r\n                this._assertNoCtrlAlt(keybinding.firstPart, commandId);\r\n            }\r\n            else {\r\n                this._assertNoCtrlAlt(keybinding, commandId);\r\n            }\r\n        }\r\n        this._keybindings.push({\r\n            keybinding: keybinding,\r\n            command: commandId,\r\n            commandArgs: undefined,\r\n            when: when,\r\n            weight1: weight1,\r\n            weight2: weight2\r\n        });\r\n        this._keybindingsSorted = false;\r\n    };\r\n    KeybindingsRegistryImpl.prototype.getDefaultKeybindings = function () {\r\n        if (!this._keybindingsSorted) {\r\n            this._keybindings.sort(sorter);\r\n            this._keybindingsSorted = true;\r\n        }\r\n        return this._keybindings.slice(0);\r\n    };\r\n    return KeybindingsRegistryImpl;\r\n}());\r\nexport var KeybindingsRegistry = new KeybindingsRegistryImpl();\r\n// Define extension point ids\r\nexport var Extensions = {\r\n    EditorModes: 'platform.keybindingsRegistry'\r\n};\r\nRegistry.add(Extensions.EditorModes, KeybindingsRegistry);\r\nfunction sorter(a, b) {\r\n    if (a.weight1 !== b.weight1) {\r\n        return a.weight1 - b.weight1;\r\n    }\r\n    if (a.command < b.command) {\r\n        return -1;\r\n    }\r\n    if (a.command > b.command) {\r\n        return 1;\r\n    }\r\n    return a.weight2 - b.weight2;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar ResolvedKeybindingItem = /** @class */ (function () {\r\n    function ResolvedKeybindingItem(resolvedKeybinding, command, commandArgs, when, isDefault) {\r\n        this.resolvedKeybinding = resolvedKeybinding;\r\n        if (resolvedKeybinding) {\r\n            var _a = resolvedKeybinding.getDispatchParts(), keypressFirstPart = _a[0], keypressChordPart = _a[1];\r\n            this.keypressFirstPart = keypressFirstPart;\r\n            this.keypressChordPart = keypressChordPart;\r\n        }\r\n        else {\r\n            this.keypressFirstPart = null;\r\n            this.keypressChordPart = null;\r\n        }\r\n        this.bubble = (command ? command.charCodeAt(0) === 94 /* Caret */ : false);\r\n        this.command = this.bubble ? command.substr(1) : command;\r\n        this.commandArgs = commandArgs;\r\n        this.when = when;\r\n        this.isDefault = isDefault;\r\n    }\r\n    return ResolvedKeybindingItem;\r\n}());\r\nexport { ResolvedKeybindingItem };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../nls.js';\r\nvar ModifierLabelProvider = /** @class */ (function () {\r\n    function ModifierLabelProvider(mac, windows, linux) {\r\n        if (linux === void 0) { linux = windows; }\r\n        this.modifierLabels = [null]; // index 0 will never me accessed.\r\n        this.modifierLabels[2 /* Macintosh */] = mac;\r\n        this.modifierLabels[1 /* Windows */] = windows;\r\n        this.modifierLabels[3 /* Linux */] = linux;\r\n    }\r\n    ModifierLabelProvider.prototype.toLabel = function (firstPartMod, firstPartKey, chordPartMod, chordPartKey, OS) {\r\n        if (firstPartMod === null || firstPartKey === null) {\r\n            return null;\r\n        }\r\n        return _asString(firstPartMod, firstPartKey, chordPartMod, chordPartKey, this.modifierLabels[OS]);\r\n    };\r\n    return ModifierLabelProvider;\r\n}());\r\nexport { ModifierLabelProvider };\r\n/**\r\n * A label provider that prints modifiers in a suitable format for displaying in the UI.\r\n */\r\nexport var UILabelProvider = new ModifierLabelProvider({\r\n    ctrlKey: '⌃',\r\n    shiftKey: '⇧',\r\n    altKey: '⌥',\r\n    metaKey: '⌘',\r\n    separator: '',\r\n}, {\r\n    ctrlKey: nls.localize({ key: 'ctrlKey', comment: ['This is the short form for the Control key on the keyboard'] }, \"Ctrl\"),\r\n    shiftKey: nls.localize({ key: 'shiftKey', comment: ['This is the short form for the Shift key on the keyboard'] }, \"Shift\"),\r\n    altKey: nls.localize({ key: 'altKey', comment: ['This is the short form for the Alt key on the keyboard'] }, \"Alt\"),\r\n    metaKey: nls.localize({ key: 'windowsKey', comment: ['This is the short form for the Windows key on the keyboard'] }, \"Windows\"),\r\n    separator: '+',\r\n}, {\r\n    ctrlKey: nls.localize({ key: 'ctrlKey', comment: ['This is the short form for the Control key on the keyboard'] }, \"Ctrl\"),\r\n    shiftKey: nls.localize({ key: 'shiftKey', comment: ['This is the short form for the Shift key on the keyboard'] }, \"Shift\"),\r\n    altKey: nls.localize({ key: 'altKey', comment: ['This is the short form for the Alt key on the keyboard'] }, \"Alt\"),\r\n    metaKey: nls.localize({ key: 'superKey', comment: ['This is the short form for the Super key on the keyboard'] }, \"Super\"),\r\n    separator: '+',\r\n});\r\n/**\r\n * A label provider that prints modifiers in a suitable format for ARIA.\r\n */\r\nexport var AriaLabelProvider = new ModifierLabelProvider({\r\n    ctrlKey: nls.localize({ key: 'ctrlKey.long', comment: ['This is the long form for the Control key on the keyboard'] }, \"Control\"),\r\n    shiftKey: nls.localize({ key: 'shiftKey.long', comment: ['This is the long form for the Shift key on the keyboard'] }, \"Shift\"),\r\n    altKey: nls.localize({ key: 'altKey.long', comment: ['This is the long form for the Alt key on the keyboard'] }, \"Alt\"),\r\n    metaKey: nls.localize({ key: 'cmdKey.long', comment: ['This is the long form for the Command key on the keyboard'] }, \"Command\"),\r\n    separator: '+',\r\n}, {\r\n    ctrlKey: nls.localize({ key: 'ctrlKey.long', comment: ['This is the long form for the Control key on the keyboard'] }, \"Control\"),\r\n    shiftKey: nls.localize({ key: 'shiftKey.long', comment: ['This is the long form for the Shift key on the keyboard'] }, \"Shift\"),\r\n    altKey: nls.localize({ key: 'altKey.long', comment: ['This is the long form for the Alt key on the keyboard'] }, \"Alt\"),\r\n    metaKey: nls.localize({ key: 'windowsKey.long', comment: ['This is the long form for the Windows key on the keyboard'] }, \"Windows\"),\r\n    separator: '+',\r\n}, {\r\n    ctrlKey: nls.localize({ key: 'ctrlKey.long', comment: ['This is the long form for the Control key on the keyboard'] }, \"Control\"),\r\n    shiftKey: nls.localize({ key: 'shiftKey.long', comment: ['This is the long form for the Shift key on the keyboard'] }, \"Shift\"),\r\n    altKey: nls.localize({ key: 'altKey.long', comment: ['This is the long form for the Alt key on the keyboard'] }, \"Alt\"),\r\n    metaKey: nls.localize({ key: 'superKey.long', comment: ['This is the long form for the Super key on the keyboard'] }, \"Super\"),\r\n    separator: '+',\r\n});\r\nfunction _simpleAsString(modifiers, key, labels) {\r\n    if (key === null) {\r\n        return '';\r\n    }\r\n    var result = [];\r\n    // translate modifier keys: Ctrl-Shift-Alt-Meta\r\n    if (modifiers.ctrlKey) {\r\n        result.push(labels.ctrlKey);\r\n    }\r\n    if (modifiers.shiftKey) {\r\n        result.push(labels.shiftKey);\r\n    }\r\n    if (modifiers.altKey) {\r\n        result.push(labels.altKey);\r\n    }\r\n    if (modifiers.metaKey) {\r\n        result.push(labels.metaKey);\r\n    }\r\n    // the actual key\r\n    result.push(key);\r\n    return result.join(labels.separator);\r\n}\r\nfunction _asString(firstPartMod, firstPartKey, chordPartMod, chordPartKey, labels) {\r\n    var result = _simpleAsString(firstPartMod, firstPartKey, labels);\r\n    if (chordPartMod !== null && chordPartKey !== null) {\r\n        result += ' ';\r\n        result += _simpleAsString(chordPartMod, chordPartKey, labels);\r\n    }\r\n    return result;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { KeyCodeUtils, ResolvedKeybinding, ResolvedKeybindingPart } from '../../../base/common/keyCodes.js';\r\nimport { AriaLabelProvider, UILabelProvider } from '../../../base/common/keybindingLabels.js';\r\n/**\r\n * Do not instantiate. Use KeybindingService to get a ResolvedKeybinding seeded with information about the current kb layout.\r\n */\r\nvar USLayoutResolvedKeybinding = /** @class */ (function (_super) {\r\n    __extends(USLayoutResolvedKeybinding, _super);\r\n    function USLayoutResolvedKeybinding(actual, OS) {\r\n        var _this = _super.call(this) || this;\r\n        _this._os = OS;\r\n        if (!actual) {\r\n            throw new Error(\"Invalid USLayoutResolvedKeybinding\");\r\n        }\r\n        else if (actual.type === 2 /* Chord */) {\r\n            _this._firstPart = actual.firstPart;\r\n            _this._chordPart = actual.chordPart;\r\n        }\r\n        else {\r\n            _this._firstPart = actual;\r\n            _this._chordPart = null;\r\n        }\r\n        return _this;\r\n    }\r\n    USLayoutResolvedKeybinding.prototype._keyCodeToUILabel = function (keyCode) {\r\n        if (this._os === 2 /* Macintosh */) {\r\n            switch (keyCode) {\r\n                case 15 /* LeftArrow */:\r\n                    return '←';\r\n                case 16 /* UpArrow */:\r\n                    return '↑';\r\n                case 17 /* RightArrow */:\r\n                    return '→';\r\n                case 18 /* DownArrow */:\r\n                    return '↓';\r\n            }\r\n        }\r\n        return KeyCodeUtils.toString(keyCode);\r\n    };\r\n    USLayoutResolvedKeybinding.prototype._getUILabelForKeybinding = function (keybinding) {\r\n        if (!keybinding) {\r\n            return null;\r\n        }\r\n        if (keybinding.isDuplicateModifierCase()) {\r\n            return '';\r\n        }\r\n        return this._keyCodeToUILabel(keybinding.keyCode);\r\n    };\r\n    USLayoutResolvedKeybinding.prototype.getLabel = function () {\r\n        var firstPart = this._getUILabelForKeybinding(this._firstPart);\r\n        var chordPart = this._getUILabelForKeybinding(this._chordPart);\r\n        return UILabelProvider.toLabel(this._firstPart, firstPart, this._chordPart, chordPart, this._os);\r\n    };\r\n    USLayoutResolvedKeybinding.prototype._getAriaLabelForKeybinding = function (keybinding) {\r\n        if (!keybinding) {\r\n            return null;\r\n        }\r\n        if (keybinding.isDuplicateModifierCase()) {\r\n            return '';\r\n        }\r\n        return KeyCodeUtils.toString(keybinding.keyCode);\r\n    };\r\n    USLayoutResolvedKeybinding.prototype.getAriaLabel = function () {\r\n        var firstPart = this._getAriaLabelForKeybinding(this._firstPart);\r\n        var chordPart = this._getAriaLabelForKeybinding(this._chordPart);\r\n        return AriaLabelProvider.toLabel(this._firstPart, firstPart, this._chordPart, chordPart, this._os);\r\n    };\r\n    USLayoutResolvedKeybinding.prototype.isChord = function () {\r\n        return (this._chordPart ? true : false);\r\n    };\r\n    USLayoutResolvedKeybinding.prototype.getParts = function () {\r\n        return [\r\n            this._toResolvedKeybindingPart(this._firstPart),\r\n            this._chordPart ? this._toResolvedKeybindingPart(this._chordPart) : null\r\n        ];\r\n    };\r\n    USLayoutResolvedKeybinding.prototype._toResolvedKeybindingPart = function (keybinding) {\r\n        return new ResolvedKeybindingPart(keybinding.ctrlKey, keybinding.shiftKey, keybinding.altKey, keybinding.metaKey, this._getUILabelForKeybinding(keybinding), this._getAriaLabelForKeybinding(keybinding));\r\n    };\r\n    USLayoutResolvedKeybinding.prototype.getDispatchParts = function () {\r\n        var firstPart = this._firstPart ? USLayoutResolvedKeybinding.getDispatchStr(this._firstPart) : null;\r\n        var chordPart = this._chordPart ? USLayoutResolvedKeybinding.getDispatchStr(this._chordPart) : null;\r\n        return [firstPart, chordPart];\r\n    };\r\n    USLayoutResolvedKeybinding.getDispatchStr = function (keybinding) {\r\n        if (keybinding.isModifierKey()) {\r\n            return null;\r\n        }\r\n        var result = '';\r\n        if (keybinding.ctrlKey) {\r\n            result += 'ctrl+';\r\n        }\r\n        if (keybinding.shiftKey) {\r\n            result += 'shift+';\r\n        }\r\n        if (keybinding.altKey) {\r\n            result += 'alt+';\r\n        }\r\n        if (keybinding.metaKey) {\r\n            result += 'meta+';\r\n        }\r\n        result += KeyCodeUtils.toString(keybinding.keyCode);\r\n        return result;\r\n    };\r\n    return USLayoutResolvedKeybinding;\r\n}(ResolvedKeybinding));\r\nexport { USLayoutResolvedKeybinding };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport BaseSeverity from '../../../base/common/severity.js';\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nexport var Severity = BaseSeverity;\r\nexport var INotificationService = createDecorator('notificationService');\r\nvar NoOpNotification = /** @class */ (function () {\r\n    function NoOpNotification() {\r\n    }\r\n    return NoOpNotification;\r\n}());\r\nexport { NoOpNotification };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport * as resources from '../../../base/common/resources.js';\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nimport { TernarySearchTree } from '../../../base/common/map.js';\r\nexport var IWorkspaceContextService = createDecorator('contextService');\r\nexport var IWorkspace;\r\n(function (IWorkspace) {\r\n    function isIWorkspace(thing) {\r\n        return thing && typeof thing === 'object'\r\n            && typeof thing.id === 'string'\r\n            && Array.isArray(thing.folders);\r\n    }\r\n    IWorkspace.isIWorkspace = isIWorkspace;\r\n})(IWorkspace || (IWorkspace = {}));\r\nexport var IWorkspaceFolder;\r\n(function (IWorkspaceFolder) {\r\n    function isIWorkspaceFolder(thing) {\r\n        return thing && typeof thing === 'object'\r\n            && URI.isUri(thing.uri)\r\n            && typeof thing.name === 'string'\r\n            && typeof thing.toResource === 'function';\r\n    }\r\n    IWorkspaceFolder.isIWorkspaceFolder = isIWorkspaceFolder;\r\n})(IWorkspaceFolder || (IWorkspaceFolder = {}));\r\nvar Workspace = /** @class */ (function () {\r\n    function Workspace(_id, folders, _configuration) {\r\n        if (folders === void 0) { folders = []; }\r\n        if (_configuration === void 0) { _configuration = null; }\r\n        this._id = _id;\r\n        this._configuration = _configuration;\r\n        this._foldersMap = TernarySearchTree.forPaths();\r\n        this.folders = folders;\r\n    }\r\n    Object.defineProperty(Workspace.prototype, \"folders\", {\r\n        get: function () {\r\n            return this._folders;\r\n        },\r\n        set: function (folders) {\r\n            this._folders = folders;\r\n            this.updateFoldersMap();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Workspace.prototype, \"id\", {\r\n        get: function () {\r\n            return this._id;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Workspace.prototype, \"configuration\", {\r\n        get: function () {\r\n            return this._configuration;\r\n        },\r\n        set: function (configuration) {\r\n            this._configuration = configuration;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Workspace.prototype.getFolder = function (resource) {\r\n        if (!resource) {\r\n            return null;\r\n        }\r\n        return this._foldersMap.findSubstr(resource.toString());\r\n    };\r\n    Workspace.prototype.updateFoldersMap = function () {\r\n        this._foldersMap = TernarySearchTree.forPaths();\r\n        for (var _i = 0, _a = this.folders; _i < _a.length; _i++) {\r\n            var folder = _a[_i];\r\n            this._foldersMap.set(folder.uri.toString(), folder);\r\n        }\r\n    };\r\n    Workspace.prototype.toJSON = function () {\r\n        return { id: this.id, folders: this.folders, configuration: this.configuration };\r\n    };\r\n    return Workspace;\r\n}());\r\nexport { Workspace };\r\nvar WorkspaceFolder = /** @class */ (function () {\r\n    function WorkspaceFolder(data, raw) {\r\n        this.raw = raw;\r\n        this.uri = data.uri;\r\n        this.index = data.index;\r\n        this.name = data.name;\r\n    }\r\n    WorkspaceFolder.prototype.toResource = function (relativePath) {\r\n        return resources.joinPath(this.uri, relativePath);\r\n    };\r\n    WorkspaceFolder.prototype.toJSON = function () {\r\n        return { uri: this.uri, name: this.name, index: this.index };\r\n    };\r\n    return WorkspaceFolder;\r\n}());\r\nexport { WorkspaceFolder };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { localize } from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { SimpleKeybinding, createKeybinding } from '../../../base/common/keyCodes.js';\r\nimport { ImmortalReference, combinedDisposable, toDisposable } from '../../../base/common/lifecycle.js';\r\nimport { OS, isLinux, isMacintosh } from '../../../base/common/platform.js';\r\nimport Severity from '../../../base/common/severity.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { TPromise } from '../../../base/common/winjs.base.js';\r\nimport { isCodeEditor } from '../../browser/editorBrowser.js';\r\nimport { isDiffEditorConfigurationKey, isEditorConfigurationKey } from '../../common/config/commonEditorConfig.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Position as Pos } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { isResourceTextEdit } from '../../common/modes.js';\r\nimport { Menu } from '../../../platform/actions/common/menu.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nimport { Configuration, ConfigurationModel, DefaultConfigurationModel } from '../../../platform/configuration/common/configurationModels.js';\r\nimport { AbstractKeybindingService } from '../../../platform/keybinding/common/abstractKeybindingService.js';\r\nimport { KeybindingResolver } from '../../../platform/keybinding/common/keybindingResolver.js';\r\nimport { KeybindingsRegistry } from '../../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { ResolvedKeybindingItem } from '../../../platform/keybinding/common/resolvedKeybindingItem.js';\r\nimport { USLayoutResolvedKeybinding } from '../../../platform/keybinding/common/usLayoutResolvedKeybinding.js';\r\nimport { NoOpNotification } from '../../../platform/notification/common/notification.js';\r\nimport { WorkspaceFolder } from '../../../platform/workspace/common/workspace.js';\r\nvar SimpleModel = /** @class */ (function () {\r\n    function SimpleModel(model) {\r\n        this.model = model;\r\n        this._onDispose = new Emitter();\r\n    }\r\n    Object.defineProperty(SimpleModel.prototype, \"textEditorModel\", {\r\n        get: function () {\r\n            return this.model;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SimpleModel.prototype.dispose = function () {\r\n        this._onDispose.fire();\r\n    };\r\n    return SimpleModel;\r\n}());\r\nexport { SimpleModel };\r\nfunction withTypedEditor(widget, codeEditorCallback, diffEditorCallback) {\r\n    if (isCodeEditor(widget)) {\r\n        // Single Editor\r\n        return codeEditorCallback(widget);\r\n    }\r\n    else {\r\n        // Diff Editor\r\n        return diffEditorCallback(widget);\r\n    }\r\n}\r\nvar SimpleEditorModelResolverService = /** @class */ (function () {\r\n    function SimpleEditorModelResolverService() {\r\n    }\r\n    SimpleEditorModelResolverService.prototype.setEditor = function (editor) {\r\n        this.editor = editor;\r\n    };\r\n    SimpleEditorModelResolverService.prototype.createModelReference = function (resource) {\r\n        var _this = this;\r\n        var model;\r\n        model = withTypedEditor(this.editor, function (editor) { return _this.findModel(editor, resource); }, function (diffEditor) { return _this.findModel(diffEditor.getOriginalEditor(), resource) || _this.findModel(diffEditor.getModifiedEditor(), resource); });\r\n        if (!model) {\r\n            return TPromise.as(new ImmortalReference(null));\r\n        }\r\n        return TPromise.as(new ImmortalReference(new SimpleModel(model)));\r\n    };\r\n    SimpleEditorModelResolverService.prototype.findModel = function (editor, resource) {\r\n        var model = editor.getModel();\r\n        if (model && model.uri.toString() !== resource.toString()) {\r\n            return null;\r\n        }\r\n        return model;\r\n    };\r\n    return SimpleEditorModelResolverService;\r\n}());\r\nexport { SimpleEditorModelResolverService };\r\nvar SimpleProgressService = /** @class */ (function () {\r\n    function SimpleProgressService() {\r\n    }\r\n    SimpleProgressService.prototype.showWhile = function (promise, delay) {\r\n        return null;\r\n    };\r\n    return SimpleProgressService;\r\n}());\r\nexport { SimpleProgressService };\r\nvar SimpleDialogService = /** @class */ (function () {\r\n    function SimpleDialogService() {\r\n    }\r\n    return SimpleDialogService;\r\n}());\r\nexport { SimpleDialogService };\r\nvar SimpleNotificationService = /** @class */ (function () {\r\n    function SimpleNotificationService() {\r\n    }\r\n    SimpleNotificationService.prototype.info = function (message) {\r\n        return this.notify({ severity: Severity.Info, message: message });\r\n    };\r\n    SimpleNotificationService.prototype.warn = function (message) {\r\n        return this.notify({ severity: Severity.Warning, message: message });\r\n    };\r\n    SimpleNotificationService.prototype.error = function (error) {\r\n        return this.notify({ severity: Severity.Error, message: error });\r\n    };\r\n    SimpleNotificationService.prototype.notify = function (notification) {\r\n        switch (notification.severity) {\r\n            case Severity.Error:\r\n                console.error(notification.message);\r\n                break;\r\n            case Severity.Warning:\r\n                console.warn(notification.message);\r\n                break;\r\n            default:\r\n                console.log(notification.message);\r\n                break;\r\n        }\r\n        return SimpleNotificationService.NO_OP;\r\n    };\r\n    SimpleNotificationService.NO_OP = new NoOpNotification();\r\n    return SimpleNotificationService;\r\n}());\r\nexport { SimpleNotificationService };\r\nvar StandaloneCommandService = /** @class */ (function () {\r\n    function StandaloneCommandService(instantiationService) {\r\n        this._onWillExecuteCommand = new Emitter();\r\n        this._instantiationService = instantiationService;\r\n        this._dynamicCommands = Object.create(null);\r\n    }\r\n    StandaloneCommandService.prototype.addCommand = function (command) {\r\n        var _this = this;\r\n        var id = command.id;\r\n        this._dynamicCommands[id] = command;\r\n        return toDisposable(function () {\r\n            delete _this._dynamicCommands[id];\r\n        });\r\n    };\r\n    StandaloneCommandService.prototype.executeCommand = function (id) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        var command = (CommandsRegistry.getCommand(id) || this._dynamicCommands[id]);\r\n        if (!command) {\r\n            return Promise.reject(new Error(\"command '\" + id + \"' not found\"));\r\n        }\r\n        try {\r\n            this._onWillExecuteCommand.fire({ commandId: id });\r\n            var result = this._instantiationService.invokeFunction.apply(this._instantiationService, [command.handler].concat(args));\r\n            return Promise.resolve(result);\r\n        }\r\n        catch (err) {\r\n            return Promise.reject(err);\r\n        }\r\n    };\r\n    return StandaloneCommandService;\r\n}());\r\nexport { StandaloneCommandService };\r\nvar StandaloneKeybindingService = /** @class */ (function (_super) {\r\n    __extends(StandaloneKeybindingService, _super);\r\n    function StandaloneKeybindingService(contextKeyService, commandService, telemetryService, notificationService, domNode) {\r\n        var _this = _super.call(this, contextKeyService, commandService, telemetryService, notificationService) || this;\r\n        _this._cachedResolver = null;\r\n        _this._dynamicKeybindings = [];\r\n        _this._register(dom.addDisposableListener(domNode, dom.EventType.KEY_DOWN, function (e) {\r\n            var keyEvent = new StandardKeyboardEvent(e);\r\n            var shouldPreventDefault = _this._dispatch(keyEvent, keyEvent.target);\r\n            if (shouldPreventDefault) {\r\n                keyEvent.preventDefault();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    StandaloneKeybindingService.prototype.addDynamicKeybinding = function (commandId, keybinding, handler, when) {\r\n        var _this = this;\r\n        var toDispose = [];\r\n        this._dynamicKeybindings.push({\r\n            keybinding: createKeybinding(keybinding, OS),\r\n            command: commandId,\r\n            when: when,\r\n            weight1: 1000,\r\n            weight2: 0\r\n        });\r\n        toDispose.push(toDisposable(function () {\r\n            for (var i = 0; i < _this._dynamicKeybindings.length; i++) {\r\n                var kb = _this._dynamicKeybindings[i];\r\n                if (kb.command === commandId) {\r\n                    _this._dynamicKeybindings.splice(i, 1);\r\n                    _this.updateResolver({ source: 1 /* Default */ });\r\n                    return;\r\n                }\r\n            }\r\n        }));\r\n        var commandService = this._commandService;\r\n        if (commandService instanceof StandaloneCommandService) {\r\n            toDispose.push(commandService.addCommand({\r\n                id: commandId,\r\n                handler: handler\r\n            }));\r\n        }\r\n        else {\r\n            throw new Error('Unknown command service!');\r\n        }\r\n        this.updateResolver({ source: 1 /* Default */ });\r\n        return combinedDisposable(toDispose);\r\n    };\r\n    StandaloneKeybindingService.prototype.updateResolver = function (event) {\r\n        this._cachedResolver = null;\r\n        this._onDidUpdateKeybindings.fire(event);\r\n    };\r\n    StandaloneKeybindingService.prototype._getResolver = function () {\r\n        if (!this._cachedResolver) {\r\n            var defaults = this._toNormalizedKeybindingItems(KeybindingsRegistry.getDefaultKeybindings(), true);\r\n            var overrides = this._toNormalizedKeybindingItems(this._dynamicKeybindings, false);\r\n            this._cachedResolver = new KeybindingResolver(defaults, overrides);\r\n        }\r\n        return this._cachedResolver;\r\n    };\r\n    StandaloneKeybindingService.prototype._documentHasFocus = function () {\r\n        return document.hasFocus();\r\n    };\r\n    StandaloneKeybindingService.prototype._toNormalizedKeybindingItems = function (items, isDefault) {\r\n        var result = [], resultLen = 0;\r\n        for (var i = 0, len = items.length; i < len; i++) {\r\n            var item = items[i];\r\n            var when = (item.when ? item.when.normalize() : null);\r\n            var keybinding = item.keybinding;\r\n            if (!keybinding) {\r\n                // This might be a removal keybinding item in user settings => accept it\r\n                result[resultLen++] = new ResolvedKeybindingItem(null, item.command, item.commandArgs, when, isDefault);\r\n            }\r\n            else {\r\n                var resolvedKeybindings = this.resolveKeybinding(keybinding);\r\n                for (var j = 0; j < resolvedKeybindings.length; j++) {\r\n                    result[resultLen++] = new ResolvedKeybindingItem(resolvedKeybindings[j], item.command, item.commandArgs, when, isDefault);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    StandaloneKeybindingService.prototype.resolveKeybinding = function (keybinding) {\r\n        return [new USLayoutResolvedKeybinding(keybinding, OS)];\r\n    };\r\n    StandaloneKeybindingService.prototype.resolveKeyboardEvent = function (keyboardEvent) {\r\n        var keybinding = new SimpleKeybinding(keyboardEvent.ctrlKey, keyboardEvent.shiftKey, keyboardEvent.altKey, keyboardEvent.metaKey, keyboardEvent.keyCode);\r\n        return new USLayoutResolvedKeybinding(keybinding, OS);\r\n    };\r\n    return StandaloneKeybindingService;\r\n}(AbstractKeybindingService));\r\nexport { StandaloneKeybindingService };\r\nfunction isConfigurationOverrides(thing) {\r\n    return thing\r\n        && typeof thing === 'object'\r\n        && (!thing.overrideIdentifier || typeof thing.overrideIdentifier === 'string')\r\n        && (!thing.resource || thing.resource instanceof URI);\r\n}\r\nvar SimpleConfigurationService = /** @class */ (function () {\r\n    function SimpleConfigurationService() {\r\n        this._onDidChangeConfiguration = new Emitter();\r\n        this.onDidChangeConfiguration = this._onDidChangeConfiguration.event;\r\n        this._configuration = new Configuration(new DefaultConfigurationModel(), new ConfigurationModel());\r\n    }\r\n    SimpleConfigurationService.prototype.configuration = function () {\r\n        return this._configuration;\r\n    };\r\n    SimpleConfigurationService.prototype.getValue = function (arg1, arg2) {\r\n        var section = typeof arg1 === 'string' ? arg1 : void 0;\r\n        var overrides = isConfigurationOverrides(arg1) ? arg1 : isConfigurationOverrides(arg2) ? arg2 : {};\r\n        return this.configuration().getValue(section, overrides, null);\r\n    };\r\n    SimpleConfigurationService.prototype.updateValue = function (key, value, arg3, arg4) {\r\n        this.configuration().updateValue(key, value);\r\n        return Promise.resolve();\r\n    };\r\n    return SimpleConfigurationService;\r\n}());\r\nexport { SimpleConfigurationService };\r\nvar SimpleResourceConfigurationService = /** @class */ (function () {\r\n    function SimpleResourceConfigurationService(configurationService) {\r\n        var _this = this;\r\n        this.configurationService = configurationService;\r\n        this._onDidChangeConfigurationEmitter = new Emitter();\r\n        this.configurationService.onDidChangeConfiguration(function (e) {\r\n            _this._onDidChangeConfigurationEmitter.fire(e);\r\n        });\r\n    }\r\n    SimpleResourceConfigurationService.prototype.getValue = function (resource, arg2, arg3) {\r\n        var position = Pos.isIPosition(arg2) ? arg2 : null;\r\n        var section = position ? (typeof arg3 === 'string' ? arg3 : void 0) : (typeof arg2 === 'string' ? arg2 : void 0);\r\n        return this.configurationService.getValue(section);\r\n    };\r\n    return SimpleResourceConfigurationService;\r\n}());\r\nexport { SimpleResourceConfigurationService };\r\nvar SimpleResourcePropertiesService = /** @class */ (function () {\r\n    function SimpleResourcePropertiesService(configurationService) {\r\n        this.configurationService = configurationService;\r\n    }\r\n    SimpleResourcePropertiesService.prototype.getEOL = function (resource) {\r\n        var filesConfiguration = this.configurationService.getValue('files');\r\n        if (filesConfiguration && filesConfiguration.eol) {\r\n            if (filesConfiguration.eol !== 'auto') {\r\n                return filesConfiguration.eol;\r\n            }\r\n        }\r\n        return (isLinux || isMacintosh) ? '\\n' : '\\r\\n';\r\n    };\r\n    SimpleResourcePropertiesService = __decorate([\r\n        __param(0, IConfigurationService)\r\n    ], SimpleResourcePropertiesService);\r\n    return SimpleResourcePropertiesService;\r\n}());\r\nexport { SimpleResourcePropertiesService };\r\nvar SimpleMenuService = /** @class */ (function () {\r\n    function SimpleMenuService(commandService) {\r\n        this._commandService = commandService;\r\n    }\r\n    SimpleMenuService.prototype.createMenu = function (id, contextKeyService) {\r\n        return new Menu(id, TPromise.as(true), this._commandService, contextKeyService);\r\n    };\r\n    return SimpleMenuService;\r\n}());\r\nexport { SimpleMenuService };\r\nvar StandaloneTelemetryService = /** @class */ (function () {\r\n    function StandaloneTelemetryService() {\r\n    }\r\n    StandaloneTelemetryService.prototype.publicLog = function (eventName, data) {\r\n        return TPromise.wrap(null);\r\n    };\r\n    return StandaloneTelemetryService;\r\n}());\r\nexport { StandaloneTelemetryService };\r\nvar SimpleWorkspaceContextService = /** @class */ (function () {\r\n    function SimpleWorkspaceContextService() {\r\n        var resource = URI.from({ scheme: SimpleWorkspaceContextService.SCHEME, authority: 'model', path: '/' });\r\n        this.workspace = { id: '4064f6ec-cb38-4ad0-af64-ee6467e63c82', folders: [new WorkspaceFolder({ uri: resource, name: '', index: 0 })] };\r\n    }\r\n    SimpleWorkspaceContextService.prototype.getWorkspace = function () {\r\n        return this.workspace;\r\n    };\r\n    SimpleWorkspaceContextService.prototype.getWorkspaceFolder = function (resource) {\r\n        return resource && resource.scheme === SimpleWorkspaceContextService.SCHEME ? this.workspace.folders[0] : void 0;\r\n    };\r\n    SimpleWorkspaceContextService.SCHEME = 'inmemory';\r\n    return SimpleWorkspaceContextService;\r\n}());\r\nexport { SimpleWorkspaceContextService };\r\nexport function applyConfigurationValues(configurationService, source, isDiffEditor) {\r\n    if (!source) {\r\n        return;\r\n    }\r\n    if (!(configurationService instanceof SimpleConfigurationService)) {\r\n        return;\r\n    }\r\n    Object.keys(source).forEach(function (key) {\r\n        if (isEditorConfigurationKey(key)) {\r\n            configurationService.updateValue(\"editor.\" + key, source[key]);\r\n        }\r\n        if (isDiffEditor && isDiffEditorConfigurationKey(key)) {\r\n            configurationService.updateValue(\"diffEditor.\" + key, source[key]);\r\n        }\r\n    });\r\n}\r\nvar SimpleBulkEditService = /** @class */ (function () {\r\n    function SimpleBulkEditService(_modelService) {\r\n        this._modelService = _modelService;\r\n        //\r\n    }\r\n    SimpleBulkEditService.prototype.apply = function (workspaceEdit, options) {\r\n        var edits = new Map();\r\n        for (var _i = 0, _a = workspaceEdit.edits; _i < _a.length; _i++) {\r\n            var edit = _a[_i];\r\n            if (!isResourceTextEdit(edit)) {\r\n                return Promise.reject(new Error('bad edit - only text edits are supported'));\r\n            }\r\n            var model = this._modelService.getModel(edit.resource);\r\n            if (!model) {\r\n                return Promise.reject(new Error('bad edit - model not found'));\r\n            }\r\n            var array = edits.get(model);\r\n            if (!array) {\r\n                array = [];\r\n            }\r\n            edits.set(model, array.concat(edit.edits));\r\n        }\r\n        var totalEdits = 0;\r\n        var totalFiles = 0;\r\n        edits.forEach(function (edits, model) {\r\n            model.applyEdits(edits.map(function (edit) { return EditOperation.replaceMove(Range.lift(edit.range), edit.text); }));\r\n            totalFiles += 1;\r\n            totalEdits += edits.length;\r\n        });\r\n        return Promise.resolve({\r\n            selection: undefined,\r\n            ariaSummary: localize('summary', 'Made {0} edits in {1} files', totalEdits, totalFiles)\r\n        });\r\n    };\r\n    return SimpleBulkEditService;\r\n}());\r\nexport { SimpleBulkEditService };\r\nvar SimpleUriLabelService = /** @class */ (function () {\r\n    function SimpleUriLabelService() {\r\n    }\r\n    SimpleUriLabelService.prototype.getUriLabel = function (resource, options) {\r\n        if (resource.scheme === 'file') {\r\n            return resource.fsPath;\r\n        }\r\n        return resource.path;\r\n    };\r\n    return SimpleUriLabelService;\r\n}());\r\nexport { SimpleUriLabelService };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './aria.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport { isMacintosh } from '../../../common/platform.js';\r\nimport * as dom from '../../dom.js';\r\nvar ariaContainer;\r\nvar alertContainer;\r\nvar statusContainer;\r\nexport function setARIAContainer(parent) {\r\n    ariaContainer = document.createElement('div');\r\n    ariaContainer.className = 'monaco-aria-container';\r\n    alertContainer = document.createElement('div');\r\n    alertContainer.className = 'monaco-alert';\r\n    alertContainer.setAttribute('role', 'alert');\r\n    alertContainer.setAttribute('aria-atomic', 'true');\r\n    ariaContainer.appendChild(alertContainer);\r\n    statusContainer = document.createElement('div');\r\n    statusContainer.className = 'monaco-status';\r\n    statusContainer.setAttribute('role', 'status');\r\n    statusContainer.setAttribute('aria-atomic', 'true');\r\n    ariaContainer.appendChild(statusContainer);\r\n    parent.appendChild(ariaContainer);\r\n}\r\n/**\r\n * Given the provided message, will make sure that it is read as alert to screen readers.\r\n */\r\nexport function alert(msg) {\r\n    insertMessage(alertContainer, msg);\r\n}\r\n/**\r\n * Given the provided message, will make sure that it is read as status to screen readers.\r\n */\r\nexport function status(msg) {\r\n    if (isMacintosh) {\r\n        alert(msg); // VoiceOver does not seem to support status role\r\n    }\r\n    else {\r\n        insertMessage(statusContainer, msg);\r\n    }\r\n}\r\nvar repeatedTimes = 0;\r\nvar prevText = undefined;\r\nfunction insertMessage(target, msg) {\r\n    if (!ariaContainer) {\r\n        // console.warn('ARIA support needs a container. Call setARIAContainer() first.');\r\n        return;\r\n    }\r\n    if (prevText === msg) {\r\n        repeatedTimes++;\r\n    }\r\n    else {\r\n        prevText = msg;\r\n        repeatedTimes = 0;\r\n    }\r\n    switch (repeatedTimes) {\r\n        case 0: break;\r\n        case 1:\r\n            msg = nls.localize('repeated', \"{0} (occurred again)\", msg);\r\n            break;\r\n        default:\r\n            msg = nls.localize('repeatedNtimes', \"{0} (occurred {1} times)\", msg, repeatedTimes);\r\n            break;\r\n    }\r\n    dom.clearNode(target);\r\n    target.textContent = msg;\r\n    // See https://www.paciellogroup.com/blog/2012/06/html5-accessibility-chops-aria-rolealert-browser-support/\r\n    target.style.visibility = 'hidden';\r\n    target.style.visibility = 'visible';\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar CharWidthRequest = /** @class */ (function () {\r\n    function CharWidthRequest(chr, type) {\r\n        this.chr = chr;\r\n        this.type = type;\r\n        this.width = 0;\r\n    }\r\n    CharWidthRequest.prototype.fulfill = function (width) {\r\n        this.width = width;\r\n    };\r\n    return CharWidthRequest;\r\n}());\r\nexport { CharWidthRequest };\r\nvar DomCharWidthReader = /** @class */ (function () {\r\n    function DomCharWidthReader(bareFontInfo, requests) {\r\n        this._bareFontInfo = bareFontInfo;\r\n        this._requests = requests;\r\n        this._container = null;\r\n        this._testElements = null;\r\n    }\r\n    DomCharWidthReader.prototype.read = function () {\r\n        // Create a test container with all these test elements\r\n        this._createDomElements();\r\n        // Add the container to the DOM\r\n        document.body.appendChild(this._container);\r\n        // Read character widths\r\n        this._readFromDomElements();\r\n        // Remove the container from the DOM\r\n        document.body.removeChild(this._container);\r\n        this._container = null;\r\n        this._testElements = null;\r\n    };\r\n    DomCharWidthReader.prototype._createDomElements = function () {\r\n        var container = document.createElement('div');\r\n        container.style.position = 'absolute';\r\n        container.style.top = '-50000px';\r\n        container.style.width = '50000px';\r\n        var regularDomNode = document.createElement('div');\r\n        regularDomNode.style.fontFamily = this._bareFontInfo.getMassagedFontFamily();\r\n        regularDomNode.style.fontWeight = this._bareFontInfo.fontWeight;\r\n        regularDomNode.style.fontSize = this._bareFontInfo.fontSize + 'px';\r\n        regularDomNode.style.lineHeight = this._bareFontInfo.lineHeight + 'px';\r\n        regularDomNode.style.letterSpacing = this._bareFontInfo.letterSpacing + 'px';\r\n        container.appendChild(regularDomNode);\r\n        var boldDomNode = document.createElement('div');\r\n        boldDomNode.style.fontFamily = this._bareFontInfo.getMassagedFontFamily();\r\n        boldDomNode.style.fontWeight = 'bold';\r\n        boldDomNode.style.fontSize = this._bareFontInfo.fontSize + 'px';\r\n        boldDomNode.style.lineHeight = this._bareFontInfo.lineHeight + 'px';\r\n        boldDomNode.style.letterSpacing = this._bareFontInfo.letterSpacing + 'px';\r\n        container.appendChild(boldDomNode);\r\n        var italicDomNode = document.createElement('div');\r\n        italicDomNode.style.fontFamily = this._bareFontInfo.getMassagedFontFamily();\r\n        italicDomNode.style.fontWeight = this._bareFontInfo.fontWeight;\r\n        italicDomNode.style.fontSize = this._bareFontInfo.fontSize + 'px';\r\n        italicDomNode.style.lineHeight = this._bareFontInfo.lineHeight + 'px';\r\n        italicDomNode.style.letterSpacing = this._bareFontInfo.letterSpacing + 'px';\r\n        italicDomNode.style.fontStyle = 'italic';\r\n        container.appendChild(italicDomNode);\r\n        var testElements = [];\r\n        for (var i = 0, len = this._requests.length; i < len; i++) {\r\n            var request = this._requests[i];\r\n            var parent_1 = void 0;\r\n            if (request.type === 0 /* Regular */) {\r\n                parent_1 = regularDomNode;\r\n            }\r\n            if (request.type === 2 /* Bold */) {\r\n                parent_1 = boldDomNode;\r\n            }\r\n            if (request.type === 1 /* Italic */) {\r\n                parent_1 = italicDomNode;\r\n            }\r\n            parent_1.appendChild(document.createElement('br'));\r\n            var testElement = document.createElement('span');\r\n            DomCharWidthReader._render(testElement, request);\r\n            parent_1.appendChild(testElement);\r\n            testElements[i] = testElement;\r\n        }\r\n        this._container = container;\r\n        this._testElements = testElements;\r\n    };\r\n    DomCharWidthReader._render = function (testElement, request) {\r\n        if (request.chr === ' ') {\r\n            var htmlString = '&nbsp;';\r\n            // Repeat character 256 (2^8) times\r\n            for (var i = 0; i < 8; i++) {\r\n                htmlString += htmlString;\r\n            }\r\n            testElement.innerHTML = htmlString;\r\n        }\r\n        else {\r\n            var testString = request.chr;\r\n            // Repeat character 256 (2^8) times\r\n            for (var i = 0; i < 8; i++) {\r\n                testString += testString;\r\n            }\r\n            testElement.textContent = testString;\r\n        }\r\n    };\r\n    DomCharWidthReader.prototype._readFromDomElements = function () {\r\n        for (var i = 0, len = this._requests.length; i < len; i++) {\r\n            var request = this._requests[i];\r\n            var testElement = this._testElements[i];\r\n            request.fulfill(testElement.offsetWidth / 256);\r\n        }\r\n    };\r\n    return DomCharWidthReader;\r\n}());\r\nexport function readCharWidths(bareFontInfo, requests) {\r\n    var reader = new DomCharWidthReader(bareFontInfo, requests);\r\n    reader.read();\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nvar ElementSizeObserver = /** @class */ (function (_super) {\r\n    __extends(ElementSizeObserver, _super);\r\n    function ElementSizeObserver(referenceDomElement, changeCallback) {\r\n        var _this = _super.call(this) || this;\r\n        _this.referenceDomElement = referenceDomElement;\r\n        _this.changeCallback = changeCallback;\r\n        _this.measureReferenceDomElementToken = -1;\r\n        _this.width = -1;\r\n        _this.height = -1;\r\n        _this.measureReferenceDomElement(false);\r\n        return _this;\r\n    }\r\n    ElementSizeObserver.prototype.dispose = function () {\r\n        this.stopObserving();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ElementSizeObserver.prototype.getWidth = function () {\r\n        return this.width;\r\n    };\r\n    ElementSizeObserver.prototype.getHeight = function () {\r\n        return this.height;\r\n    };\r\n    ElementSizeObserver.prototype.startObserving = function () {\r\n        var _this = this;\r\n        if (this.measureReferenceDomElementToken === -1) {\r\n            this.measureReferenceDomElementToken = setInterval(function () { return _this.measureReferenceDomElement(true); }, 100);\r\n        }\r\n    };\r\n    ElementSizeObserver.prototype.stopObserving = function () {\r\n        if (this.measureReferenceDomElementToken !== -1) {\r\n            clearInterval(this.measureReferenceDomElementToken);\r\n            this.measureReferenceDomElementToken = -1;\r\n        }\r\n    };\r\n    ElementSizeObserver.prototype.observe = function (dimension) {\r\n        this.measureReferenceDomElement(true, dimension);\r\n    };\r\n    ElementSizeObserver.prototype.measureReferenceDomElement = function (callChangeCallback, dimension) {\r\n        var observedWidth = 0;\r\n        var observedHeight = 0;\r\n        if (dimension) {\r\n            observedWidth = dimension.width;\r\n            observedHeight = dimension.height;\r\n        }\r\n        else if (this.referenceDomElement) {\r\n            observedWidth = this.referenceDomElement.clientWidth;\r\n            observedHeight = this.referenceDomElement.clientHeight;\r\n        }\r\n        observedWidth = Math.max(5, observedWidth);\r\n        observedHeight = Math.max(5, observedHeight);\r\n        if (this.width !== observedWidth || this.height !== observedHeight) {\r\n            this.width = observedWidth;\r\n            this.height = observedHeight;\r\n            if (callChangeCallback) {\r\n                this.changeCallback();\r\n            }\r\n        }\r\n    };\r\n    return ElementSizeObserver;\r\n}(Disposable));\r\nexport { ElementSizeObserver };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from '../../../base/browser/browser.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { CharWidthRequest, readCharWidths } from './charWidthReader.js';\r\nimport { ElementSizeObserver } from './elementSizeObserver.js';\r\nimport { CommonEditorConfiguration } from '../../common/config/commonEditorConfig.js';\r\nimport { FontInfo } from '../../common/config/fontInfo.js';\r\nvar CSSBasedConfigurationCache = /** @class */ (function () {\r\n    function CSSBasedConfigurationCache() {\r\n        this._keys = Object.create(null);\r\n        this._values = Object.create(null);\r\n    }\r\n    CSSBasedConfigurationCache.prototype.has = function (item) {\r\n        var itemId = item.getId();\r\n        return !!this._values[itemId];\r\n    };\r\n    CSSBasedConfigurationCache.prototype.get = function (item) {\r\n        var itemId = item.getId();\r\n        return this._values[itemId];\r\n    };\r\n    CSSBasedConfigurationCache.prototype.put = function (item, value) {\r\n        var itemId = item.getId();\r\n        this._keys[itemId] = item;\r\n        this._values[itemId] = value;\r\n    };\r\n    CSSBasedConfigurationCache.prototype.remove = function (item) {\r\n        var itemId = item.getId();\r\n        delete this._keys[itemId];\r\n        delete this._values[itemId];\r\n    };\r\n    CSSBasedConfigurationCache.prototype.getValues = function () {\r\n        var _this = this;\r\n        return Object.keys(this._keys).map(function (id) { return _this._values[id]; });\r\n    };\r\n    return CSSBasedConfigurationCache;\r\n}());\r\nvar CSSBasedConfiguration = /** @class */ (function (_super) {\r\n    __extends(CSSBasedConfiguration, _super);\r\n    function CSSBasedConfiguration() {\r\n        var _this = _super.call(this) || this;\r\n        _this._onDidChange = _this._register(new Emitter());\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        _this._cache = new CSSBasedConfigurationCache();\r\n        _this._evictUntrustedReadingsTimeout = -1;\r\n        return _this;\r\n    }\r\n    CSSBasedConfiguration.prototype.dispose = function () {\r\n        if (this._evictUntrustedReadingsTimeout !== -1) {\r\n            clearTimeout(this._evictUntrustedReadingsTimeout);\r\n            this._evictUntrustedReadingsTimeout = -1;\r\n        }\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    CSSBasedConfiguration.prototype._writeToCache = function (item, value) {\r\n        var _this = this;\r\n        this._cache.put(item, value);\r\n        if (!value.isTrusted && this._evictUntrustedReadingsTimeout === -1) {\r\n            // Try reading again after some time\r\n            this._evictUntrustedReadingsTimeout = setTimeout(function () {\r\n                _this._evictUntrustedReadingsTimeout = -1;\r\n                _this._evictUntrustedReadings();\r\n            }, 5000);\r\n        }\r\n    };\r\n    CSSBasedConfiguration.prototype._evictUntrustedReadings = function () {\r\n        var values = this._cache.getValues();\r\n        var somethingRemoved = false;\r\n        for (var i = 0, len = values.length; i < len; i++) {\r\n            var item = values[i];\r\n            if (!item.isTrusted) {\r\n                somethingRemoved = true;\r\n                this._cache.remove(item);\r\n            }\r\n        }\r\n        if (somethingRemoved) {\r\n            this._onDidChange.fire();\r\n        }\r\n    };\r\n    CSSBasedConfiguration.prototype.readConfiguration = function (bareFontInfo) {\r\n        if (!this._cache.has(bareFontInfo)) {\r\n            var readConfig = CSSBasedConfiguration._actualReadConfiguration(bareFontInfo);\r\n            if (readConfig.typicalHalfwidthCharacterWidth <= 2 || readConfig.typicalFullwidthCharacterWidth <= 2 || readConfig.spaceWidth <= 2 || readConfig.maxDigitWidth <= 2) {\r\n                // Hey, it's Bug 14341 ... we couldn't read\r\n                readConfig = new FontInfo({\r\n                    zoomLevel: browser.getZoomLevel(),\r\n                    fontFamily: readConfig.fontFamily,\r\n                    fontWeight: readConfig.fontWeight,\r\n                    fontSize: readConfig.fontSize,\r\n                    lineHeight: readConfig.lineHeight,\r\n                    letterSpacing: readConfig.letterSpacing,\r\n                    isMonospace: readConfig.isMonospace,\r\n                    typicalHalfwidthCharacterWidth: Math.max(readConfig.typicalHalfwidthCharacterWidth, 5),\r\n                    typicalFullwidthCharacterWidth: Math.max(readConfig.typicalFullwidthCharacterWidth, 5),\r\n                    canUseHalfwidthRightwardsArrow: readConfig.canUseHalfwidthRightwardsArrow,\r\n                    spaceWidth: Math.max(readConfig.spaceWidth, 5),\r\n                    maxDigitWidth: Math.max(readConfig.maxDigitWidth, 5),\r\n                }, false);\r\n            }\r\n            this._writeToCache(bareFontInfo, readConfig);\r\n        }\r\n        return this._cache.get(bareFontInfo);\r\n    };\r\n    CSSBasedConfiguration.createRequest = function (chr, type, all, monospace) {\r\n        var result = new CharWidthRequest(chr, type);\r\n        all.push(result);\r\n        if (monospace) {\r\n            monospace.push(result);\r\n        }\r\n        return result;\r\n    };\r\n    CSSBasedConfiguration._actualReadConfiguration = function (bareFontInfo) {\r\n        var all = [];\r\n        var monospace = [];\r\n        var typicalHalfwidthCharacter = this.createRequest('n', 0 /* Regular */, all, monospace);\r\n        var typicalFullwidthCharacter = this.createRequest('\\uff4d', 0 /* Regular */, all, null);\r\n        var space = this.createRequest(' ', 0 /* Regular */, all, monospace);\r\n        var digit0 = this.createRequest('0', 0 /* Regular */, all, monospace);\r\n        var digit1 = this.createRequest('1', 0 /* Regular */, all, monospace);\r\n        var digit2 = this.createRequest('2', 0 /* Regular */, all, monospace);\r\n        var digit3 = this.createRequest('3', 0 /* Regular */, all, monospace);\r\n        var digit4 = this.createRequest('4', 0 /* Regular */, all, monospace);\r\n        var digit5 = this.createRequest('5', 0 /* Regular */, all, monospace);\r\n        var digit6 = this.createRequest('6', 0 /* Regular */, all, monospace);\r\n        var digit7 = this.createRequest('7', 0 /* Regular */, all, monospace);\r\n        var digit8 = this.createRequest('8', 0 /* Regular */, all, monospace);\r\n        var digit9 = this.createRequest('9', 0 /* Regular */, all, monospace);\r\n        // monospace test: used for whitespace rendering\r\n        var rightwardsArrow = this.createRequest('→', 0 /* Regular */, all, monospace);\r\n        var halfwidthRightwardsArrow = this.createRequest('￫', 0 /* Regular */, all, null);\r\n        this.createRequest('·', 0 /* Regular */, all, monospace);\r\n        // monospace test: some characters\r\n        this.createRequest('|', 0 /* Regular */, all, monospace);\r\n        this.createRequest('/', 0 /* Regular */, all, monospace);\r\n        this.createRequest('-', 0 /* Regular */, all, monospace);\r\n        this.createRequest('_', 0 /* Regular */, all, monospace);\r\n        this.createRequest('i', 0 /* Regular */, all, monospace);\r\n        this.createRequest('l', 0 /* Regular */, all, monospace);\r\n        this.createRequest('m', 0 /* Regular */, all, monospace);\r\n        // monospace italic test\r\n        this.createRequest('|', 1 /* Italic */, all, monospace);\r\n        this.createRequest('_', 1 /* Italic */, all, monospace);\r\n        this.createRequest('i', 1 /* Italic */, all, monospace);\r\n        this.createRequest('l', 1 /* Italic */, all, monospace);\r\n        this.createRequest('m', 1 /* Italic */, all, monospace);\r\n        this.createRequest('n', 1 /* Italic */, all, monospace);\r\n        // monospace bold test\r\n        this.createRequest('|', 2 /* Bold */, all, monospace);\r\n        this.createRequest('_', 2 /* Bold */, all, monospace);\r\n        this.createRequest('i', 2 /* Bold */, all, monospace);\r\n        this.createRequest('l', 2 /* Bold */, all, monospace);\r\n        this.createRequest('m', 2 /* Bold */, all, monospace);\r\n        this.createRequest('n', 2 /* Bold */, all, monospace);\r\n        readCharWidths(bareFontInfo, all);\r\n        var maxDigitWidth = Math.max(digit0.width, digit1.width, digit2.width, digit3.width, digit4.width, digit5.width, digit6.width, digit7.width, digit8.width, digit9.width);\r\n        var isMonospace = true;\r\n        var referenceWidth = monospace[0].width;\r\n        for (var i = 1, len = monospace.length; i < len; i++) {\r\n            var diff = referenceWidth - monospace[i].width;\r\n            if (diff < -0.001 || diff > 0.001) {\r\n                isMonospace = false;\r\n                break;\r\n            }\r\n        }\r\n        var canUseHalfwidthRightwardsArrow = true;\r\n        if (isMonospace && halfwidthRightwardsArrow.width !== referenceWidth) {\r\n            // using a halfwidth rightwards arrow would break monospace...\r\n            canUseHalfwidthRightwardsArrow = false;\r\n        }\r\n        if (halfwidthRightwardsArrow.width > rightwardsArrow.width) {\r\n            // using a halfwidth rightwards arrow would paint a larger arrow than a regular rightwards arrow\r\n            canUseHalfwidthRightwardsArrow = false;\r\n        }\r\n        // let's trust the zoom level only 2s after it was changed.\r\n        var canTrustBrowserZoomLevel = (browser.getTimeSinceLastZoomLevelChanged() > 2000);\r\n        return new FontInfo({\r\n            zoomLevel: browser.getZoomLevel(),\r\n            fontFamily: bareFontInfo.fontFamily,\r\n            fontWeight: bareFontInfo.fontWeight,\r\n            fontSize: bareFontInfo.fontSize,\r\n            lineHeight: bareFontInfo.lineHeight,\r\n            letterSpacing: bareFontInfo.letterSpacing,\r\n            isMonospace: isMonospace,\r\n            typicalHalfwidthCharacterWidth: typicalHalfwidthCharacter.width,\r\n            typicalFullwidthCharacterWidth: typicalFullwidthCharacter.width,\r\n            canUseHalfwidthRightwardsArrow: canUseHalfwidthRightwardsArrow,\r\n            spaceWidth: space.width,\r\n            maxDigitWidth: maxDigitWidth\r\n        }, canTrustBrowserZoomLevel);\r\n    };\r\n    CSSBasedConfiguration.INSTANCE = new CSSBasedConfiguration();\r\n    return CSSBasedConfiguration;\r\n}(Disposable));\r\nvar Configuration = /** @class */ (function (_super) {\r\n    __extends(Configuration, _super);\r\n    function Configuration(options, referenceDomElement) {\r\n        if (referenceDomElement === void 0) { referenceDomElement = null; }\r\n        var _this = _super.call(this, options) || this;\r\n        _this._elementSizeObserver = _this._register(new ElementSizeObserver(referenceDomElement, function () { return _this._onReferenceDomElementSizeChanged(); }));\r\n        _this._register(CSSBasedConfiguration.INSTANCE.onDidChange(function () { return _this._onCSSBasedConfigurationChanged(); }));\r\n        if (_this._validatedOptions.automaticLayout) {\r\n            _this._elementSizeObserver.startObserving();\r\n        }\r\n        _this._register(browser.onDidChangeZoomLevel(function (_) { return _this._recomputeOptions(); }));\r\n        _this._register(browser.onDidChangeAccessibilitySupport(function () { return _this._recomputeOptions(); }));\r\n        _this._recomputeOptions();\r\n        return _this;\r\n    }\r\n    Configuration.applyFontInfoSlow = function (domNode, fontInfo) {\r\n        domNode.style.fontFamily = fontInfo.getMassagedFontFamily();\r\n        domNode.style.fontWeight = fontInfo.fontWeight;\r\n        domNode.style.fontSize = fontInfo.fontSize + 'px';\r\n        domNode.style.lineHeight = fontInfo.lineHeight + 'px';\r\n        domNode.style.letterSpacing = fontInfo.letterSpacing + 'px';\r\n    };\r\n    Configuration.applyFontInfo = function (domNode, fontInfo) {\r\n        domNode.setFontFamily(fontInfo.getMassagedFontFamily());\r\n        domNode.setFontWeight(fontInfo.fontWeight);\r\n        domNode.setFontSize(fontInfo.fontSize);\r\n        domNode.setLineHeight(fontInfo.lineHeight);\r\n        domNode.setLetterSpacing(fontInfo.letterSpacing);\r\n    };\r\n    Configuration.prototype._onReferenceDomElementSizeChanged = function () {\r\n        this._recomputeOptions();\r\n    };\r\n    Configuration.prototype._onCSSBasedConfigurationChanged = function () {\r\n        this._recomputeOptions();\r\n    };\r\n    Configuration.prototype.observeReferenceElement = function (dimension) {\r\n        this._elementSizeObserver.observe(dimension);\r\n    };\r\n    Configuration.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    Configuration.prototype._getExtraEditorClassName = function () {\r\n        var extra = '';\r\n        if (browser.isIE) {\r\n            extra += 'ie ';\r\n        }\r\n        else if (browser.isFirefox) {\r\n            extra += 'ff ';\r\n        }\r\n        else if (browser.isEdge) {\r\n            extra += 'edge ';\r\n        }\r\n        else if (browser.isSafari) {\r\n            extra += 'safari ';\r\n        }\r\n        if (platform.isMacintosh) {\r\n            extra += 'mac ';\r\n        }\r\n        return extra;\r\n    };\r\n    Configuration.prototype._getEnvConfiguration = function () {\r\n        return {\r\n            extraEditorClassName: this._getExtraEditorClassName(),\r\n            outerWidth: this._elementSizeObserver.getWidth(),\r\n            outerHeight: this._elementSizeObserver.getHeight(),\r\n            emptySelectionClipboard: browser.isWebKit || browser.isFirefox,\r\n            pixelRatio: browser.getPixelRatio(),\r\n            zoomLevel: browser.getZoomLevel(),\r\n            accessibilitySupport: browser.getAccessibilitySupport()\r\n        };\r\n    };\r\n    Configuration.prototype.readConfiguration = function (bareFontInfo) {\r\n        return CSSBasedConfiguration.INSTANCE.readConfiguration(bareFontInfo);\r\n    };\r\n    return Configuration;\r\n}(CommonEditorConfiguration));\r\nexport { Configuration };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { always } from '../../base/common/async.js';\r\nimport { illegalArgument } from '../../base/common/errors.js';\r\nimport { URI } from '../../base/common/uri.js';\r\nimport { ICodeEditorService } from './services/codeEditorService.js';\r\nimport { Position } from '../common/core/position.js';\r\nimport { IModelService } from '../common/services/modelService.js';\r\nimport { ITextModelService } from '../common/services/resolverService.js';\r\nimport { MenuId, MenuRegistry } from '../../platform/actions/common/actions.js';\r\nimport { CommandsRegistry } from '../../platform/commands/common/commands.js';\r\nimport { ContextKeyExpr, IContextKeyService } from '../../platform/contextkey/common/contextkey.js';\r\nimport { KeybindingsRegistry } from '../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { Registry } from '../../platform/registry/common/platform.js';\r\nimport { ITelemetryService } from '../../platform/telemetry/common/telemetry.js';\r\nvar Command = /** @class */ (function () {\r\n    function Command(opts) {\r\n        this.id = opts.id;\r\n        this.precondition = opts.precondition;\r\n        this._kbOpts = opts.kbOpts;\r\n        this._menubarOpts = opts.menubarOpts;\r\n        this._description = opts.description;\r\n    }\r\n    Command.prototype.register = function () {\r\n        var _this = this;\r\n        if (this._menubarOpts) {\r\n            MenuRegistry.appendMenuItem(this._menubarOpts.menuId, {\r\n                group: this._menubarOpts.group,\r\n                command: {\r\n                    id: this.id,\r\n                    title: this._menubarOpts.title,\r\n                },\r\n                when: this._menubarOpts.when,\r\n                order: this._menubarOpts.order\r\n            });\r\n        }\r\n        if (this._kbOpts) {\r\n            var kbWhen = this._kbOpts.kbExpr;\r\n            if (this.precondition) {\r\n                if (kbWhen) {\r\n                    kbWhen = ContextKeyExpr.and(kbWhen, this.precondition);\r\n                }\r\n                else {\r\n                    kbWhen = this.precondition;\r\n                }\r\n            }\r\n            KeybindingsRegistry.registerCommandAndKeybindingRule({\r\n                id: this.id,\r\n                handler: function (accessor, args) { return _this.runCommand(accessor, args); },\r\n                weight: this._kbOpts.weight,\r\n                when: kbWhen || null,\r\n                primary: this._kbOpts.primary,\r\n                secondary: this._kbOpts.secondary,\r\n                win: this._kbOpts.win,\r\n                linux: this._kbOpts.linux,\r\n                mac: this._kbOpts.mac,\r\n                description: this._description\r\n            });\r\n        }\r\n        else {\r\n            CommandsRegistry.registerCommand({\r\n                id: this.id,\r\n                handler: function (accessor, args) { return _this.runCommand(accessor, args); },\r\n                description: this._description\r\n            });\r\n        }\r\n    };\r\n    return Command;\r\n}());\r\nexport { Command };\r\nvar EditorCommand = /** @class */ (function (_super) {\r\n    __extends(EditorCommand, _super);\r\n    function EditorCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    /**\r\n     * Create a command class that is bound to a certain editor contribution.\r\n     */\r\n    EditorCommand.bindToContribution = function (controllerGetter) {\r\n        return /** @class */ (function (_super) {\r\n            __extends(EditorControllerCommandImpl, _super);\r\n            function EditorControllerCommandImpl(opts) {\r\n                var _this = _super.call(this, opts) || this;\r\n                _this._callback = opts.handler;\r\n                return _this;\r\n            }\r\n            EditorControllerCommandImpl.prototype.runEditorCommand = function (accessor, editor, args) {\r\n                var controller = controllerGetter(editor);\r\n                if (controller) {\r\n                    this._callback(controllerGetter(editor));\r\n                }\r\n            };\r\n            return EditorControllerCommandImpl;\r\n        }(EditorCommand));\r\n    };\r\n    EditorCommand.prototype.runCommand = function (accessor, args) {\r\n        var _this = this;\r\n        var codeEditorService = accessor.get(ICodeEditorService);\r\n        // Find the editor with text focus or active\r\n        var editor = codeEditorService.getFocusedCodeEditor() || codeEditorService.getActiveCodeEditor();\r\n        if (!editor) {\r\n            // well, at least we tried...\r\n            return;\r\n        }\r\n        return editor.invokeWithinContext(function (editorAccessor) {\r\n            var kbService = editorAccessor.get(IContextKeyService);\r\n            if (!kbService.contextMatchesRules(_this.precondition)) {\r\n                // precondition does not hold\r\n                return;\r\n            }\r\n            return _this.runEditorCommand(editorAccessor, editor, args);\r\n        });\r\n    };\r\n    return EditorCommand;\r\n}(Command));\r\nexport { EditorCommand };\r\nvar EditorAction = /** @class */ (function (_super) {\r\n    __extends(EditorAction, _super);\r\n    function EditorAction(opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.label = opts.label;\r\n        _this.alias = opts.alias;\r\n        _this.menuOpts = opts.menuOpts;\r\n        return _this;\r\n    }\r\n    EditorAction.prototype.register = function () {\r\n        if (this.menuOpts) {\r\n            MenuRegistry.appendMenuItem(MenuId.EditorContext, {\r\n                command: {\r\n                    id: this.id,\r\n                    title: this.label\r\n                },\r\n                when: ContextKeyExpr.and(this.precondition, this.menuOpts.when),\r\n                group: this.menuOpts.group,\r\n                order: this.menuOpts.order\r\n            });\r\n        }\r\n        _super.prototype.register.call(this);\r\n    };\r\n    EditorAction.prototype.runEditorCommand = function (accessor, editor, args) {\r\n        this.reportTelemetry(accessor, editor);\r\n        return this.run(accessor, editor, args || {});\r\n    };\r\n    EditorAction.prototype.reportTelemetry = function (accessor, editor) {\r\n        /* __GDPR__\r\n            \"editorActionInvoked\" : {\r\n                \"name\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\r\n                \"id\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\r\n                \"${include}\": [\r\n                    \"${EditorTelemetryData}\"\r\n                ]\r\n            }\r\n        */\r\n        accessor.get(ITelemetryService).publicLog('editorActionInvoked', __assign({ name: this.label, id: this.id }, editor.getTelemetryData()));\r\n    };\r\n    return EditorAction;\r\n}(EditorCommand));\r\nexport { EditorAction };\r\n//#endregion EditorAction\r\n// --- Registration of commands and actions\r\nexport function registerLanguageCommand(id, handler) {\r\n    CommandsRegistry.registerCommand(id, function (accessor, args) { return handler(accessor, args || {}); });\r\n}\r\nexport function registerDefaultLanguageCommand(id, handler) {\r\n    registerLanguageCommand(id, function (accessor, args) {\r\n        var resource = args.resource, position = args.position;\r\n        if (!(resource instanceof URI)) {\r\n            throw illegalArgument('resource');\r\n        }\r\n        if (!Position.isIPosition(position)) {\r\n            throw illegalArgument('position');\r\n        }\r\n        var model = accessor.get(IModelService).getModel(resource);\r\n        if (model) {\r\n            var editorPosition = Position.lift(position);\r\n            return handler(model, editorPosition, args);\r\n        }\r\n        return accessor.get(ITextModelService).createModelReference(resource).then(function (reference) {\r\n            return always(new Promise(function (resolve, reject) {\r\n                try {\r\n                    var result = handler(reference.object.textEditorModel, Position.lift(position), args);\r\n                    resolve(result);\r\n                }\r\n                catch (err) {\r\n                    reject(err);\r\n                }\r\n            }), function () {\r\n                reference.dispose();\r\n            });\r\n        });\r\n    });\r\n}\r\nexport function registerEditorCommand(editorCommand) {\r\n    EditorContributionRegistry.INSTANCE.registerEditorCommand(editorCommand);\r\n    return editorCommand;\r\n}\r\nexport function registerEditorAction(ctor) {\r\n    EditorContributionRegistry.INSTANCE.registerEditorAction(new ctor());\r\n}\r\nexport function registerInstantiatedEditorAction(editorAction) {\r\n    EditorContributionRegistry.INSTANCE.registerEditorAction(editorAction);\r\n}\r\nexport function registerEditorContribution(ctor) {\r\n    EditorContributionRegistry.INSTANCE.registerEditorContribution(ctor);\r\n}\r\nexport var EditorExtensionsRegistry;\r\n(function (EditorExtensionsRegistry) {\r\n    function getEditorCommand(commandId) {\r\n        return EditorContributionRegistry.INSTANCE.getEditorCommand(commandId);\r\n    }\r\n    EditorExtensionsRegistry.getEditorCommand = getEditorCommand;\r\n    function getEditorActions() {\r\n        return EditorContributionRegistry.INSTANCE.getEditorActions();\r\n    }\r\n    EditorExtensionsRegistry.getEditorActions = getEditorActions;\r\n    function getEditorContributions() {\r\n        return EditorContributionRegistry.INSTANCE.getEditorContributions();\r\n    }\r\n    EditorExtensionsRegistry.getEditorContributions = getEditorContributions;\r\n})(EditorExtensionsRegistry || (EditorExtensionsRegistry = {}));\r\n// Editor extension points\r\nvar Extensions = {\r\n    EditorCommonContributions: 'editor.contributions'\r\n};\r\nvar EditorContributionRegistry = /** @class */ (function () {\r\n    function EditorContributionRegistry() {\r\n        this.editorContributions = [];\r\n        this.editorActions = [];\r\n        this.editorCommands = Object.create(null);\r\n    }\r\n    EditorContributionRegistry.prototype.registerEditorContribution = function (ctor) {\r\n        this.editorContributions.push(ctor);\r\n    };\r\n    EditorContributionRegistry.prototype.registerEditorAction = function (action) {\r\n        action.register();\r\n        this.editorActions.push(action);\r\n    };\r\n    EditorContributionRegistry.prototype.getEditorContributions = function () {\r\n        return this.editorContributions.slice(0);\r\n    };\r\n    EditorContributionRegistry.prototype.getEditorActions = function () {\r\n        return this.editorActions.slice(0);\r\n    };\r\n    EditorContributionRegistry.prototype.registerEditorCommand = function (editorCommand) {\r\n        editorCommand.register();\r\n        this.editorCommands[editorCommand.id] = editorCommand;\r\n    };\r\n    EditorContributionRegistry.prototype.getEditorCommand = function (commandId) {\r\n        return (this.editorCommands[commandId] || null);\r\n    };\r\n    EditorContributionRegistry.INSTANCE = new EditorContributionRegistry();\r\n    return EditorContributionRegistry;\r\n}());\r\nRegistry.add(Extensions.EditorCommonContributions, EditorContributionRegistry.INSTANCE);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as dom from './dom.js';\r\nvar FastDomNode = /** @class */ (function () {\r\n    function FastDomNode(domNode) {\r\n        this.domNode = domNode;\r\n        this._maxWidth = -1;\r\n        this._width = -1;\r\n        this._height = -1;\r\n        this._top = -1;\r\n        this._left = -1;\r\n        this._bottom = -1;\r\n        this._right = -1;\r\n        this._fontFamily = '';\r\n        this._fontWeight = '';\r\n        this._fontSize = -1;\r\n        this._lineHeight = -1;\r\n        this._letterSpacing = -100;\r\n        this._className = '';\r\n        this._display = '';\r\n        this._position = '';\r\n        this._visibility = '';\r\n        this._layerHint = false;\r\n    }\r\n    FastDomNode.prototype.setMaxWidth = function (maxWidth) {\r\n        if (this._maxWidth === maxWidth) {\r\n            return;\r\n        }\r\n        this._maxWidth = maxWidth;\r\n        this.domNode.style.maxWidth = this._maxWidth + 'px';\r\n    };\r\n    FastDomNode.prototype.setWidth = function (width) {\r\n        if (this._width === width) {\r\n            return;\r\n        }\r\n        this._width = width;\r\n        this.domNode.style.width = this._width + 'px';\r\n    };\r\n    FastDomNode.prototype.setHeight = function (height) {\r\n        if (this._height === height) {\r\n            return;\r\n        }\r\n        this._height = height;\r\n        this.domNode.style.height = this._height + 'px';\r\n    };\r\n    FastDomNode.prototype.setTop = function (top) {\r\n        if (this._top === top) {\r\n            return;\r\n        }\r\n        this._top = top;\r\n        this.domNode.style.top = this._top + 'px';\r\n    };\r\n    FastDomNode.prototype.unsetTop = function () {\r\n        if (this._top === -1) {\r\n            return;\r\n        }\r\n        this._top = -1;\r\n        this.domNode.style.top = '';\r\n    };\r\n    FastDomNode.prototype.setLeft = function (left) {\r\n        if (this._left === left) {\r\n            return;\r\n        }\r\n        this._left = left;\r\n        this.domNode.style.left = this._left + 'px';\r\n    };\r\n    FastDomNode.prototype.setBottom = function (bottom) {\r\n        if (this._bottom === bottom) {\r\n            return;\r\n        }\r\n        this._bottom = bottom;\r\n        this.domNode.style.bottom = this._bottom + 'px';\r\n    };\r\n    FastDomNode.prototype.setRight = function (right) {\r\n        if (this._right === right) {\r\n            return;\r\n        }\r\n        this._right = right;\r\n        this.domNode.style.right = this._right + 'px';\r\n    };\r\n    FastDomNode.prototype.setFontFamily = function (fontFamily) {\r\n        if (this._fontFamily === fontFamily) {\r\n            return;\r\n        }\r\n        this._fontFamily = fontFamily;\r\n        this.domNode.style.fontFamily = this._fontFamily;\r\n    };\r\n    FastDomNode.prototype.setFontWeight = function (fontWeight) {\r\n        if (this._fontWeight === fontWeight) {\r\n            return;\r\n        }\r\n        this._fontWeight = fontWeight;\r\n        this.domNode.style.fontWeight = this._fontWeight;\r\n    };\r\n    FastDomNode.prototype.setFontSize = function (fontSize) {\r\n        if (this._fontSize === fontSize) {\r\n            return;\r\n        }\r\n        this._fontSize = fontSize;\r\n        this.domNode.style.fontSize = this._fontSize + 'px';\r\n    };\r\n    FastDomNode.prototype.setLineHeight = function (lineHeight) {\r\n        if (this._lineHeight === lineHeight) {\r\n            return;\r\n        }\r\n        this._lineHeight = lineHeight;\r\n        this.domNode.style.lineHeight = this._lineHeight + 'px';\r\n    };\r\n    FastDomNode.prototype.setLetterSpacing = function (letterSpacing) {\r\n        if (this._letterSpacing === letterSpacing) {\r\n            return;\r\n        }\r\n        this._letterSpacing = letterSpacing;\r\n        this.domNode.style.letterSpacing = this._letterSpacing + 'px';\r\n    };\r\n    FastDomNode.prototype.setClassName = function (className) {\r\n        if (this._className === className) {\r\n            return;\r\n        }\r\n        this._className = className;\r\n        this.domNode.className = this._className;\r\n    };\r\n    FastDomNode.prototype.toggleClassName = function (className, shouldHaveIt) {\r\n        dom.toggleClass(this.domNode, className, shouldHaveIt);\r\n        this._className = this.domNode.className;\r\n    };\r\n    FastDomNode.prototype.setDisplay = function (display) {\r\n        if (this._display === display) {\r\n            return;\r\n        }\r\n        this._display = display;\r\n        this.domNode.style.display = this._display;\r\n    };\r\n    FastDomNode.prototype.setPosition = function (position) {\r\n        if (this._position === position) {\r\n            return;\r\n        }\r\n        this._position = position;\r\n        this.domNode.style.position = this._position;\r\n    };\r\n    FastDomNode.prototype.setVisibility = function (visibility) {\r\n        if (this._visibility === visibility) {\r\n            return;\r\n        }\r\n        this._visibility = visibility;\r\n        this.domNode.style.visibility = this._visibility;\r\n    };\r\n    FastDomNode.prototype.setLayerHinting = function (layerHint) {\r\n        if (this._layerHint === layerHint) {\r\n            return;\r\n        }\r\n        this._layerHint = layerHint;\r\n        this.domNode.style.willChange = this._layerHint ? 'transform' : 'auto';\r\n    };\r\n    FastDomNode.prototype.setAttribute = function (name, value) {\r\n        this.domNode.setAttribute(name, value);\r\n    };\r\n    FastDomNode.prototype.removeAttribute = function (name) {\r\n        this.domNode.removeAttribute(name);\r\n    };\r\n    FastDomNode.prototype.appendChild = function (child) {\r\n        this.domNode.appendChild(child.domNode);\r\n    };\r\n    FastDomNode.prototype.removeChild = function (child) {\r\n        this.domNode.removeChild(child.domNode);\r\n    };\r\n    return FastDomNode;\r\n}());\r\nexport { FastDomNode };\r\nexport function createFastDomNode(domNode) {\r\n    return new FastDomNode(domNode);\r\n}\r\n","export function memoize(target, key, descriptor) {\r\n    var fnKey = null;\r\n    var fn = null;\r\n    if (typeof descriptor.value === 'function') {\r\n        fnKey = 'value';\r\n        fn = descriptor.value;\r\n        if (fn.length !== 0) {\r\n            console.warn('Memoize should only be used in functions with zero parameters');\r\n        }\r\n    }\r\n    else if (typeof descriptor.get === 'function') {\r\n        fnKey = 'get';\r\n        fn = descriptor.get;\r\n    }\r\n    if (!fn) {\r\n        throw new Error('not supported');\r\n    }\r\n    var memoizeKey = \"$memoize$\" + key;\r\n    descriptor[fnKey] = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (!this.hasOwnProperty(memoizeKey)) {\r\n            Object.defineProperty(this, memoizeKey, {\r\n                configurable: false,\r\n                enumerable: false,\r\n                writable: false,\r\n                value: fn.apply(this, args)\r\n            });\r\n        }\r\n        return this[memoizeKey];\r\n    };\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nimport * as arrays from '../common/arrays.js';\r\nimport { Disposable } from '../common/lifecycle.js';\r\nimport * as DomUtils from './dom.js';\r\nimport { memoize } from '../common/decorators.js';\r\nexport var EventType;\r\n(function (EventType) {\r\n    EventType.Tap = '-monaco-gesturetap';\r\n    EventType.Change = '-monaco-gesturechange';\r\n    EventType.Start = '-monaco-gesturestart';\r\n    EventType.End = '-monaco-gesturesend';\r\n    EventType.Contextmenu = '-monaco-gesturecontextmenu';\r\n})(EventType || (EventType = {}));\r\nvar Gesture = /** @class */ (function (_super) {\r\n    __extends(Gesture, _super);\r\n    function Gesture() {\r\n        var _this = _super.call(this) || this;\r\n        _this.activeTouches = {};\r\n        _this.handle = null;\r\n        _this.targets = [];\r\n        _this._register(DomUtils.addDisposableListener(document, 'touchstart', function (e) { return _this.onTouchStart(e); }));\r\n        _this._register(DomUtils.addDisposableListener(document, 'touchend', function (e) { return _this.onTouchEnd(e); }));\r\n        _this._register(DomUtils.addDisposableListener(document, 'touchmove', function (e) { return _this.onTouchMove(e); }));\r\n        return _this;\r\n    }\r\n    Gesture.addTarget = function (element) {\r\n        if (!Gesture.isTouchDevice()) {\r\n            return;\r\n        }\r\n        if (!Gesture.INSTANCE) {\r\n            Gesture.INSTANCE = new Gesture();\r\n        }\r\n        Gesture.INSTANCE.targets.push(element);\r\n    };\r\n    Gesture.isTouchDevice = function () {\r\n        return 'ontouchstart' in window || navigator.maxTouchPoints > 0 || window.navigator.msMaxTouchPoints > 0;\r\n    };\r\n    Gesture.prototype.dispose = function () {\r\n        if (this.handle) {\r\n            this.handle.dispose();\r\n            this.handle = null;\r\n        }\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    Gesture.prototype.onTouchStart = function (e) {\r\n        var timestamp = Date.now(); // use Date.now() because on FF e.timeStamp is not epoch based.\r\n        if (this.handle) {\r\n            this.handle.dispose();\r\n            this.handle = null;\r\n        }\r\n        for (var i = 0, len = e.targetTouches.length; i < len; i++) {\r\n            var touch = e.targetTouches.item(i);\r\n            this.activeTouches[touch.identifier] = {\r\n                id: touch.identifier,\r\n                initialTarget: touch.target,\r\n                initialTimeStamp: timestamp,\r\n                initialPageX: touch.pageX,\r\n                initialPageY: touch.pageY,\r\n                rollingTimestamps: [timestamp],\r\n                rollingPageX: [touch.pageX],\r\n                rollingPageY: [touch.pageY]\r\n            };\r\n            var evt = this.newGestureEvent(EventType.Start, touch.target);\r\n            evt.pageX = touch.pageX;\r\n            evt.pageY = touch.pageY;\r\n            this.dispatchEvent(evt);\r\n        }\r\n        if (this.dispatched) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            this.dispatched = false;\r\n        }\r\n    };\r\n    Gesture.prototype.onTouchEnd = function (e) {\r\n        var timestamp = Date.now(); // use Date.now() because on FF e.timeStamp is not epoch based.\r\n        var activeTouchCount = Object.keys(this.activeTouches).length;\r\n        var _loop_1 = function (i, len) {\r\n            var touch = e.changedTouches.item(i);\r\n            if (!this_1.activeTouches.hasOwnProperty(String(touch.identifier))) {\r\n                console.warn('move of an UNKNOWN touch', touch);\r\n                return \"continue\";\r\n            }\r\n            var data = this_1.activeTouches[touch.identifier], holdTime = Date.now() - data.initialTimeStamp;\r\n            if (holdTime < Gesture.HOLD_DELAY\r\n                && Math.abs(data.initialPageX - arrays.tail(data.rollingPageX)) < 30\r\n                && Math.abs(data.initialPageY - arrays.tail(data.rollingPageY)) < 30) {\r\n                var evt = this_1.newGestureEvent(EventType.Tap, data.initialTarget);\r\n                evt.pageX = arrays.tail(data.rollingPageX);\r\n                evt.pageY = arrays.tail(data.rollingPageY);\r\n                this_1.dispatchEvent(evt);\r\n            }\r\n            else if (holdTime >= Gesture.HOLD_DELAY\r\n                && Math.abs(data.initialPageX - arrays.tail(data.rollingPageX)) < 30\r\n                && Math.abs(data.initialPageY - arrays.tail(data.rollingPageY)) < 30) {\r\n                var evt = this_1.newGestureEvent(EventType.Contextmenu, data.initialTarget);\r\n                evt.pageX = arrays.tail(data.rollingPageX);\r\n                evt.pageY = arrays.tail(data.rollingPageY);\r\n                this_1.dispatchEvent(evt);\r\n            }\r\n            else if (activeTouchCount === 1) {\r\n                var finalX = arrays.tail(data.rollingPageX);\r\n                var finalY = arrays.tail(data.rollingPageY);\r\n                var deltaT = arrays.tail(data.rollingTimestamps) - data.rollingTimestamps[0];\r\n                var deltaX = finalX - data.rollingPageX[0];\r\n                var deltaY = finalY - data.rollingPageY[0];\r\n                // We need to get all the dispatch targets on the start of the inertia event\r\n                var dispatchTo = this_1.targets.filter(function (t) { return data.initialTarget instanceof Node && t.contains(data.initialTarget); });\r\n                this_1.inertia(dispatchTo, timestamp, // time now\r\n                Math.abs(deltaX) / deltaT, // speed\r\n                deltaX > 0 ? 1 : -1, // x direction\r\n                finalX, // x now\r\n                Math.abs(deltaY) / deltaT, // y speed\r\n                deltaY > 0 ? 1 : -1, // y direction\r\n                finalY // y now\r\n                );\r\n            }\r\n            this_1.dispatchEvent(this_1.newGestureEvent(EventType.End, data.initialTarget));\r\n            // forget about this touch\r\n            delete this_1.activeTouches[touch.identifier];\r\n        };\r\n        var this_1 = this;\r\n        for (var i = 0, len = e.changedTouches.length; i < len; i++) {\r\n            _loop_1(i, len);\r\n        }\r\n        if (this.dispatched) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            this.dispatched = false;\r\n        }\r\n    };\r\n    Gesture.prototype.newGestureEvent = function (type, intialTarget) {\r\n        var event = document.createEvent('CustomEvent');\r\n        event.initEvent(type, false, true);\r\n        event.initialTarget = intialTarget;\r\n        return event;\r\n    };\r\n    Gesture.prototype.dispatchEvent = function (event) {\r\n        var _this = this;\r\n        this.targets.forEach(function (target) {\r\n            if (event.initialTarget instanceof Node && target.contains(event.initialTarget)) {\r\n                target.dispatchEvent(event);\r\n                _this.dispatched = true;\r\n            }\r\n        });\r\n    };\r\n    Gesture.prototype.inertia = function (dispatchTo, t1, vX, dirX, x, vY, dirY, y) {\r\n        var _this = this;\r\n        this.handle = DomUtils.scheduleAtNextAnimationFrame(function () {\r\n            var now = Date.now();\r\n            // velocity: old speed + accel_over_time\r\n            var deltaT = now - t1, delta_pos_x = 0, delta_pos_y = 0, stopped = true;\r\n            vX += Gesture.SCROLL_FRICTION * deltaT;\r\n            vY += Gesture.SCROLL_FRICTION * deltaT;\r\n            if (vX > 0) {\r\n                stopped = false;\r\n                delta_pos_x = dirX * vX * deltaT;\r\n            }\r\n            if (vY > 0) {\r\n                stopped = false;\r\n                delta_pos_y = dirY * vY * deltaT;\r\n            }\r\n            // dispatch translation event\r\n            var evt = _this.newGestureEvent(EventType.Change);\r\n            evt.translationX = delta_pos_x;\r\n            evt.translationY = delta_pos_y;\r\n            dispatchTo.forEach(function (d) { return d.dispatchEvent(evt); });\r\n            if (!stopped) {\r\n                _this.inertia(dispatchTo, now, vX, dirX, x + delta_pos_x, vY, dirY, y + delta_pos_y);\r\n            }\r\n        });\r\n    };\r\n    Gesture.prototype.onTouchMove = function (e) {\r\n        var timestamp = Date.now(); // use Date.now() because on FF e.timeStamp is not epoch based.\r\n        for (var i = 0, len = e.changedTouches.length; i < len; i++) {\r\n            var touch = e.changedTouches.item(i);\r\n            if (!this.activeTouches.hasOwnProperty(String(touch.identifier))) {\r\n                console.warn('end of an UNKNOWN touch', touch);\r\n                continue;\r\n            }\r\n            var data = this.activeTouches[touch.identifier];\r\n            var evt = this.newGestureEvent(EventType.Change, data.initialTarget);\r\n            evt.translationX = touch.pageX - arrays.tail(data.rollingPageX);\r\n            evt.translationY = touch.pageY - arrays.tail(data.rollingPageY);\r\n            evt.pageX = touch.pageX;\r\n            evt.pageY = touch.pageY;\r\n            this.dispatchEvent(evt);\r\n            // only keep a few data points, to average the final speed\r\n            if (data.rollingPageX.length > 3) {\r\n                data.rollingPageX.shift();\r\n                data.rollingPageY.shift();\r\n                data.rollingTimestamps.shift();\r\n            }\r\n            data.rollingPageX.push(touch.pageX);\r\n            data.rollingPageY.push(touch.pageY);\r\n            data.rollingTimestamps.push(timestamp);\r\n        }\r\n        if (this.dispatched) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            this.dispatched = false;\r\n        }\r\n    };\r\n    Gesture.SCROLL_FRICTION = -0.005;\r\n    Gesture.HOLD_DELAY = 700;\r\n    __decorate([\r\n        memoize\r\n    ], Gesture, \"isTouchDevice\", null);\r\n    return Gesture;\r\n}(Disposable));\r\nexport { Gesture };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from './dom.js';\r\nimport { IframeUtils } from './iframe.js';\r\nimport { StandardMouseEvent } from './mouseEvent.js';\r\nimport { Disposable, dispose } from '../common/lifecycle.js';\r\nexport function standardMouseMoveMerger(lastEvent, currentEvent) {\r\n    var ev = new StandardMouseEvent(currentEvent);\r\n    ev.preventDefault();\r\n    return {\r\n        leftButton: ev.leftButton,\r\n        posx: ev.posx,\r\n        posy: ev.posy\r\n    };\r\n}\r\nvar GlobalMouseMoveMonitor = /** @class */ (function (_super) {\r\n    __extends(GlobalMouseMoveMonitor, _super);\r\n    function GlobalMouseMoveMonitor() {\r\n        var _this = _super.call(this) || this;\r\n        _this.hooks = [];\r\n        _this.mouseMoveEventMerger = null;\r\n        _this.mouseMoveCallback = null;\r\n        _this.onStopCallback = null;\r\n        return _this;\r\n    }\r\n    GlobalMouseMoveMonitor.prototype.dispose = function () {\r\n        this.stopMonitoring(false);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    GlobalMouseMoveMonitor.prototype.stopMonitoring = function (invokeStopCallback) {\r\n        if (!this.isMonitoring()) {\r\n            // Not monitoring\r\n            return;\r\n        }\r\n        // Unhook\r\n        this.hooks = dispose(this.hooks);\r\n        this.mouseMoveEventMerger = null;\r\n        this.mouseMoveCallback = null;\r\n        var onStopCallback = this.onStopCallback;\r\n        this.onStopCallback = null;\r\n        if (invokeStopCallback && onStopCallback) {\r\n            onStopCallback();\r\n        }\r\n    };\r\n    GlobalMouseMoveMonitor.prototype.isMonitoring = function () {\r\n        return this.hooks.length > 0;\r\n    };\r\n    GlobalMouseMoveMonitor.prototype.startMonitoring = function (mouseMoveEventMerger, mouseMoveCallback, onStopCallback) {\r\n        var _this = this;\r\n        if (this.isMonitoring()) {\r\n            // I am already hooked\r\n            return;\r\n        }\r\n        this.mouseMoveEventMerger = mouseMoveEventMerger;\r\n        this.mouseMoveCallback = mouseMoveCallback;\r\n        this.onStopCallback = onStopCallback;\r\n        var windowChain = IframeUtils.getSameOriginWindowChain();\r\n        for (var i = 0; i < windowChain.length; i++) {\r\n            this.hooks.push(dom.addDisposableThrottledListener(windowChain[i].window.document, 'mousemove', function (data) { return _this.mouseMoveCallback(data); }, function (lastEvent, currentEvent) { return _this.mouseMoveEventMerger(lastEvent, currentEvent); }));\r\n            this.hooks.push(dom.addDisposableListener(windowChain[i].window.document, 'mouseup', function (e) { return _this.stopMonitoring(true); }));\r\n        }\r\n        if (IframeUtils.hasDifferentOriginAncestor()) {\r\n            var lastSameOriginAncestor = windowChain[windowChain.length - 1];\r\n            // We might miss a mouse up if it happens outside the iframe\r\n            // This one is for Chrome\r\n            this.hooks.push(dom.addDisposableListener(lastSameOriginAncestor.window.document, 'mouseout', function (browserEvent) {\r\n                var e = new StandardMouseEvent(browserEvent);\r\n                if (e.target.tagName.toLowerCase() === 'html') {\r\n                    _this.stopMonitoring(true);\r\n                }\r\n            }));\r\n            // This one is for FF\r\n            this.hooks.push(dom.addDisposableListener(lastSameOriginAncestor.window.document, 'mouseover', function (browserEvent) {\r\n                var e = new StandardMouseEvent(browserEvent);\r\n                if (e.target.tagName.toLowerCase() === 'html') {\r\n                    _this.stopMonitoring(true);\r\n                }\r\n            }));\r\n            // This one is for IE\r\n            this.hooks.push(dom.addDisposableListener(lastSameOriginAncestor.window.document.body, 'mouseleave', function (browserEvent) {\r\n                _this.stopMonitoring(true);\r\n            }));\r\n        }\r\n    };\r\n    return GlobalMouseMoveMonitor;\r\n}(Disposable));\r\nexport { GlobalMouseMoveMonitor };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../../base/browser/dom.js';\r\nimport { GlobalMouseMoveMonitor } from '../../base/browser/globalMouseMoveMonitor.js';\r\nimport { StandardMouseEvent } from '../../base/browser/mouseEvent.js';\r\nimport { Disposable } from '../../base/common/lifecycle.js';\r\n/**\r\n * Coordinates relative to the whole document (e.g. mouse event's pageX and pageY)\r\n */\r\nvar PageCoordinates = /** @class */ (function () {\r\n    function PageCoordinates(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n    PageCoordinates.prototype.toClientCoordinates = function () {\r\n        return new ClientCoordinates(this.x - dom.StandardWindow.scrollX, this.y - dom.StandardWindow.scrollY);\r\n    };\r\n    return PageCoordinates;\r\n}());\r\nexport { PageCoordinates };\r\n/**\r\n * Coordinates within the application's client area (i.e. origin is document's scroll position).\r\n *\r\n * For example, clicking in the top-left corner of the client area will\r\n * always result in a mouse event with a client.x value of 0, regardless\r\n * of whether the page is scrolled horizontally.\r\n */\r\nvar ClientCoordinates = /** @class */ (function () {\r\n    function ClientCoordinates(clientX, clientY) {\r\n        this.clientX = clientX;\r\n        this.clientY = clientY;\r\n    }\r\n    ClientCoordinates.prototype.toPageCoordinates = function () {\r\n        return new PageCoordinates(this.clientX + dom.StandardWindow.scrollX, this.clientY + dom.StandardWindow.scrollY);\r\n    };\r\n    return ClientCoordinates;\r\n}());\r\nexport { ClientCoordinates };\r\n/**\r\n * The position of the editor in the page.\r\n */\r\nvar EditorPagePosition = /** @class */ (function () {\r\n    function EditorPagePosition(x, y, width, height) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n    return EditorPagePosition;\r\n}());\r\nexport { EditorPagePosition };\r\nexport function createEditorPagePosition(editorViewDomNode) {\r\n    var editorPos = dom.getDomNodePagePosition(editorViewDomNode);\r\n    return new EditorPagePosition(editorPos.left, editorPos.top, editorPos.width, editorPos.height);\r\n}\r\nvar EditorMouseEvent = /** @class */ (function (_super) {\r\n    __extends(EditorMouseEvent, _super);\r\n    function EditorMouseEvent(e, editorViewDomNode) {\r\n        var _this = _super.call(this, e) || this;\r\n        _this.pos = new PageCoordinates(_this.posx, _this.posy);\r\n        _this.editorPos = createEditorPagePosition(editorViewDomNode);\r\n        return _this;\r\n    }\r\n    return EditorMouseEvent;\r\n}(StandardMouseEvent));\r\nexport { EditorMouseEvent };\r\nvar EditorMouseEventFactory = /** @class */ (function () {\r\n    function EditorMouseEventFactory(editorViewDomNode) {\r\n        this._editorViewDomNode = editorViewDomNode;\r\n    }\r\n    EditorMouseEventFactory.prototype._create = function (e) {\r\n        return new EditorMouseEvent(e, this._editorViewDomNode);\r\n    };\r\n    EditorMouseEventFactory.prototype.onContextMenu = function (target, callback) {\r\n        var _this = this;\r\n        return dom.addDisposableListener(target, 'contextmenu', function (e) {\r\n            callback(_this._create(e));\r\n        });\r\n    };\r\n    EditorMouseEventFactory.prototype.onMouseUp = function (target, callback) {\r\n        var _this = this;\r\n        return dom.addDisposableListener(target, 'mouseup', function (e) {\r\n            callback(_this._create(e));\r\n        });\r\n    };\r\n    EditorMouseEventFactory.prototype.onMouseDown = function (target, callback) {\r\n        var _this = this;\r\n        return dom.addDisposableListener(target, 'mousedown', function (e) {\r\n            callback(_this._create(e));\r\n        });\r\n    };\r\n    EditorMouseEventFactory.prototype.onMouseLeave = function (target, callback) {\r\n        var _this = this;\r\n        return dom.addDisposableNonBubblingMouseOutListener(target, function (e) {\r\n            callback(_this._create(e));\r\n        });\r\n    };\r\n    EditorMouseEventFactory.prototype.onMouseMoveThrottled = function (target, callback, merger, minimumTimeMs) {\r\n        var _this = this;\r\n        var myMerger = function (lastEvent, currentEvent) {\r\n            return merger(lastEvent, _this._create(currentEvent));\r\n        };\r\n        return dom.addDisposableThrottledListener(target, 'mousemove', callback, myMerger, minimumTimeMs);\r\n    };\r\n    return EditorMouseEventFactory;\r\n}());\r\nexport { EditorMouseEventFactory };\r\nvar GlobalEditorMouseMoveMonitor = /** @class */ (function (_super) {\r\n    __extends(GlobalEditorMouseMoveMonitor, _super);\r\n    function GlobalEditorMouseMoveMonitor(editorViewDomNode) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editorViewDomNode = editorViewDomNode;\r\n        _this._globalMouseMoveMonitor = _this._register(new GlobalMouseMoveMonitor());\r\n        _this._keydownListener = null;\r\n        return _this;\r\n    }\r\n    GlobalEditorMouseMoveMonitor.prototype.startMonitoring = function (merger, mouseMoveCallback, onStopCallback) {\r\n        var _this = this;\r\n        // Add a <<capture>> keydown event listener that will cancel the monitoring\r\n        // if something other than a modifier key is pressed\r\n        this._keydownListener = dom.addStandardDisposableListener(document, 'keydown', function (e) {\r\n            var kb = e.toKeybinding();\r\n            if (kb.isModifierKey()) {\r\n                // Allow modifier keys\r\n                return;\r\n            }\r\n            _this._globalMouseMoveMonitor.stopMonitoring(true);\r\n        }, true);\r\n        var myMerger = function (lastEvent, currentEvent) {\r\n            return merger(lastEvent, new EditorMouseEvent(currentEvent, _this._editorViewDomNode));\r\n        };\r\n        this._globalMouseMoveMonitor.startMonitoring(myMerger, mouseMoveCallback, function () {\r\n            _this._keydownListener.dispose();\r\n            onStopCallback();\r\n        });\r\n    };\r\n    return GlobalEditorMouseMoveMonitor;\r\n}(Disposable));\r\nexport { GlobalEditorMouseMoveMonitor };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nvar ViewEventHandler = /** @class */ (function (_super) {\r\n    __extends(ViewEventHandler, _super);\r\n    function ViewEventHandler() {\r\n        var _this = _super.call(this) || this;\r\n        _this._shouldRender = true;\r\n        return _this;\r\n    }\r\n    ViewEventHandler.prototype.shouldRender = function () {\r\n        return this._shouldRender;\r\n    };\r\n    ViewEventHandler.prototype.forceShouldRender = function () {\r\n        this._shouldRender = true;\r\n    };\r\n    ViewEventHandler.prototype.setShouldRender = function () {\r\n        this._shouldRender = true;\r\n    };\r\n    ViewEventHandler.prototype.onDidRender = function () {\r\n        this._shouldRender = false;\r\n    };\r\n    // --- begin event handlers\r\n    ViewEventHandler.prototype.onConfigurationChanged = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onCursorStateChanged = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onDecorationsChanged = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onFlushed = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onFocusChanged = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onLanguageConfigurationChanged = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onLineMappingChanged = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onLinesChanged = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onLinesDeleted = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onLinesInserted = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onRevealRangeRequest = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onScrollChanged = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onTokensChanged = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onTokensColorsChanged = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onZonesChanged = function (e) {\r\n        return false;\r\n    };\r\n    ViewEventHandler.prototype.onThemeChanged = function (e) {\r\n        return false;\r\n    };\r\n    // --- end event handlers\r\n    ViewEventHandler.prototype.handleEvents = function (events) {\r\n        var shouldRender = false;\r\n        for (var i = 0, len = events.length; i < len; i++) {\r\n            var e = events[i];\r\n            switch (e.type) {\r\n                case 1 /* ViewConfigurationChanged */:\r\n                    if (this.onConfigurationChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 2 /* ViewCursorStateChanged */:\r\n                    if (this.onCursorStateChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 3 /* ViewDecorationsChanged */:\r\n                    if (this.onDecorationsChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 4 /* ViewFlushed */:\r\n                    if (this.onFlushed(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 5 /* ViewFocusChanged */:\r\n                    if (this.onFocusChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 16 /* ViewLanguageConfigurationChanged */:\r\n                    if (this.onLanguageConfigurationChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 6 /* ViewLineMappingChanged */:\r\n                    if (this.onLineMappingChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 7 /* ViewLinesChanged */:\r\n                    if (this.onLinesChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 8 /* ViewLinesDeleted */:\r\n                    if (this.onLinesDeleted(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 9 /* ViewLinesInserted */:\r\n                    if (this.onLinesInserted(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 10 /* ViewRevealRangeRequest */:\r\n                    if (this.onRevealRangeRequest(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 11 /* ViewScrollChanged */:\r\n                    if (this.onScrollChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 12 /* ViewTokensChanged */:\r\n                    if (this.onTokensChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 13 /* ViewTokensColorsChanged */:\r\n                    if (this.onTokensColorsChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 14 /* ViewZonesChanged */:\r\n                    if (this.onZonesChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                case 15 /* ViewThemeChanged */:\r\n                    if (this.onThemeChanged(e)) {\r\n                        shouldRender = true;\r\n                    }\r\n                    break;\r\n                default:\r\n                    console.info('View received unknown event: ');\r\n                    console.info(e);\r\n            }\r\n        }\r\n        if (shouldRender) {\r\n            this._shouldRender = true;\r\n        }\r\n    };\r\n    return ViewEventHandler;\r\n}(Disposable));\r\nexport { ViewEventHandler };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { FastDomNode } from '../../../base/browser/fastDomNode.js';\r\nimport { ViewEventHandler } from '../../common/viewModel/viewEventHandler.js';\r\nvar ViewPart = /** @class */ (function (_super) {\r\n    __extends(ViewPart, _super);\r\n    function ViewPart(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    ViewPart.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    return ViewPart;\r\n}(ViewEventHandler));\r\nexport { ViewPart };\r\nvar PartFingerprints = /** @class */ (function () {\r\n    function PartFingerprints() {\r\n    }\r\n    PartFingerprints.write = function (target, partId) {\r\n        if (target instanceof FastDomNode) {\r\n            target.setAttribute('data-mprt', String(partId));\r\n        }\r\n        else {\r\n            target.setAttribute('data-mprt', String(partId));\r\n        }\r\n    };\r\n    PartFingerprints.read = function (target) {\r\n        var r = target.getAttribute('data-mprt');\r\n        if (r === null) {\r\n            return 0 /* None */;\r\n        }\r\n        return parseInt(r, 10);\r\n    };\r\n    PartFingerprints.collect = function (child, stopAt) {\r\n        var result = [], resultLen = 0;\r\n        while (child && child !== document.body) {\r\n            if (child === stopAt) {\r\n                break;\r\n            }\r\n            if (child.nodeType === child.ELEMENT_NODE) {\r\n                result[resultLen++] = this.read(child);\r\n            }\r\n            child = child.parentElement;\r\n        }\r\n        var r = new Uint8Array(resultLen);\r\n        for (var i = 0; i < resultLen; i++) {\r\n            r[i] = result[resultLen - i - 1];\r\n        }\r\n        return r;\r\n    };\r\n    return PartFingerprints;\r\n}());\r\nexport { PartFingerprints };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar RestrictedRenderingContext = /** @class */ (function () {\r\n    function RestrictedRenderingContext(viewLayout, viewportData) {\r\n        this._viewLayout = viewLayout;\r\n        this.viewportData = viewportData;\r\n        this.scrollWidth = this._viewLayout.getScrollWidth();\r\n        this.scrollHeight = this._viewLayout.getScrollHeight();\r\n        this.visibleRange = this.viewportData.visibleRange;\r\n        this.bigNumbersDelta = this.viewportData.bigNumbersDelta;\r\n        var vInfo = this._viewLayout.getCurrentViewport();\r\n        this.scrollTop = vInfo.top;\r\n        this.scrollLeft = vInfo.left;\r\n        this.viewportWidth = vInfo.width;\r\n        this.viewportHeight = vInfo.height;\r\n    }\r\n    RestrictedRenderingContext.prototype.getScrolledTopFromAbsoluteTop = function (absoluteTop) {\r\n        return absoluteTop - this.scrollTop;\r\n    };\r\n    RestrictedRenderingContext.prototype.getVerticalOffsetForLineNumber = function (lineNumber) {\r\n        return this._viewLayout.getVerticalOffsetForLineNumber(lineNumber);\r\n    };\r\n    RestrictedRenderingContext.prototype.getDecorationsInViewport = function () {\r\n        return this.viewportData.getDecorationsInViewport();\r\n    };\r\n    return RestrictedRenderingContext;\r\n}());\r\nexport { RestrictedRenderingContext };\r\nvar RenderingContext = /** @class */ (function (_super) {\r\n    __extends(RenderingContext, _super);\r\n    function RenderingContext(viewLayout, viewportData, viewLines) {\r\n        var _this = _super.call(this, viewLayout, viewportData) || this;\r\n        _this._viewLines = viewLines;\r\n        return _this;\r\n    }\r\n    RenderingContext.prototype.linesVisibleRangesForRange = function (range, includeNewLines) {\r\n        return this._viewLines.linesVisibleRangesForRange(range, includeNewLines);\r\n    };\r\n    RenderingContext.prototype.visibleRangeForPosition = function (position) {\r\n        return this._viewLines.visibleRangeForPosition(position);\r\n    };\r\n    return RenderingContext;\r\n}(RestrictedRenderingContext));\r\nexport { RenderingContext };\r\nvar LineVisibleRanges = /** @class */ (function () {\r\n    function LineVisibleRanges(lineNumber, ranges) {\r\n        this.lineNumber = lineNumber;\r\n        this.ranges = ranges;\r\n    }\r\n    return LineVisibleRanges;\r\n}());\r\nexport { LineVisibleRanges };\r\nvar HorizontalRange = /** @class */ (function () {\r\n    function HorizontalRange(left, width) {\r\n        this.left = Math.round(left);\r\n        this.width = Math.round(width);\r\n    }\r\n    HorizontalRange.prototype.toString = function () {\r\n        return \"[\" + this.left + \",\" + this.width + \"]\";\r\n    };\r\n    return HorizontalRange;\r\n}());\r\nexport { HorizontalRange };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { HorizontalRange } from '../../../common/view/renderingContext.js';\r\nvar FloatHorizontalRange = /** @class */ (function () {\r\n    function FloatHorizontalRange(left, width) {\r\n        this.left = left;\r\n        this.width = width;\r\n    }\r\n    FloatHorizontalRange.prototype.toString = function () {\r\n        return \"[\" + this.left + \",\" + this.width + \"]\";\r\n    };\r\n    FloatHorizontalRange.compare = function (a, b) {\r\n        return a.left - b.left;\r\n    };\r\n    return FloatHorizontalRange;\r\n}());\r\nvar RangeUtil = /** @class */ (function () {\r\n    function RangeUtil() {\r\n    }\r\n    RangeUtil._createRange = function () {\r\n        if (!this._handyReadyRange) {\r\n            this._handyReadyRange = document.createRange();\r\n        }\r\n        return this._handyReadyRange;\r\n    };\r\n    RangeUtil._detachRange = function (range, endNode) {\r\n        // Move range out of the span node, IE doesn't like having many ranges in\r\n        // the same spot and will act badly for lines containing dashes ('-')\r\n        range.selectNodeContents(endNode);\r\n    };\r\n    RangeUtil._readClientRects = function (startElement, startOffset, endElement, endOffset, endNode) {\r\n        var range = this._createRange();\r\n        try {\r\n            range.setStart(startElement, startOffset);\r\n            range.setEnd(endElement, endOffset);\r\n            return range.getClientRects();\r\n        }\r\n        catch (e) {\r\n            // This is life ...\r\n            return null;\r\n        }\r\n        finally {\r\n            this._detachRange(range, endNode);\r\n        }\r\n    };\r\n    RangeUtil._mergeAdjacentRanges = function (ranges) {\r\n        if (ranges.length === 1) {\r\n            // There is nothing to merge\r\n            return [new HorizontalRange(ranges[0].left, ranges[0].width)];\r\n        }\r\n        ranges.sort(FloatHorizontalRange.compare);\r\n        var result = [], resultLen = 0;\r\n        var prevLeft = ranges[0].left;\r\n        var prevWidth = ranges[0].width;\r\n        for (var i = 1, len = ranges.length; i < len; i++) {\r\n            var range = ranges[i];\r\n            var myLeft = range.left;\r\n            var myWidth = range.width;\r\n            if (prevLeft + prevWidth + 0.9 /* account for browser's rounding errors*/ >= myLeft) {\r\n                prevWidth = Math.max(prevWidth, myLeft + myWidth - prevLeft);\r\n            }\r\n            else {\r\n                result[resultLen++] = new HorizontalRange(prevLeft, prevWidth);\r\n                prevLeft = myLeft;\r\n                prevWidth = myWidth;\r\n            }\r\n        }\r\n        result[resultLen++] = new HorizontalRange(prevLeft, prevWidth);\r\n        return result;\r\n    };\r\n    RangeUtil._createHorizontalRangesFromClientRects = function (clientRects, clientRectDeltaLeft) {\r\n        if (!clientRects || clientRects.length === 0) {\r\n            return null;\r\n        }\r\n        // We go through FloatHorizontalRange because it has been observed in bi-di text\r\n        // that the clientRects are not coming in sorted from the browser\r\n        var result = [];\r\n        for (var i = 0, len = clientRects.length; i < len; i++) {\r\n            var clientRect = clientRects[i];\r\n            result[i] = new FloatHorizontalRange(Math.max(0, clientRect.left - clientRectDeltaLeft), clientRect.width);\r\n        }\r\n        return this._mergeAdjacentRanges(result);\r\n    };\r\n    RangeUtil.readHorizontalRanges = function (domNode, startChildIndex, startOffset, endChildIndex, endOffset, clientRectDeltaLeft, endNode) {\r\n        // Panic check\r\n        var min = 0;\r\n        var max = domNode.children.length - 1;\r\n        if (min > max) {\r\n            return null;\r\n        }\r\n        startChildIndex = Math.min(max, Math.max(min, startChildIndex));\r\n        endChildIndex = Math.min(max, Math.max(min, endChildIndex));\r\n        // If crossing over to a span only to select offset 0, then use the previous span's maximum offset\r\n        // Chrome is buggy and doesn't handle 0 offsets well sometimes.\r\n        if (startChildIndex !== endChildIndex) {\r\n            if (endChildIndex > 0 && endOffset === 0) {\r\n                endChildIndex--;\r\n                endOffset = Number.MAX_VALUE;\r\n            }\r\n        }\r\n        var startElement = domNode.children[startChildIndex].firstChild;\r\n        var endElement = domNode.children[endChildIndex].firstChild;\r\n        if (!startElement || !endElement) {\r\n            // When having an empty <span> (without any text content), try to move to the previous <span>\r\n            if (!startElement && startOffset === 0 && startChildIndex > 0) {\r\n                startElement = domNode.children[startChildIndex - 1].firstChild;\r\n                startOffset = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n            }\r\n            if (!endElement && endOffset === 0 && endChildIndex > 0) {\r\n                endElement = domNode.children[endChildIndex - 1].firstChild;\r\n                endOffset = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n            }\r\n        }\r\n        if (!startElement || !endElement) {\r\n            return null;\r\n        }\r\n        startOffset = Math.min(startElement.textContent.length, Math.max(0, startOffset));\r\n        endOffset = Math.min(endElement.textContent.length, Math.max(0, endOffset));\r\n        var clientRects = this._readClientRects(startElement, startOffset, endElement, endOffset, endNode);\r\n        return this._createHorizontalRangesFromClientRects(clientRects, clientRectDeltaLeft);\r\n    };\r\n    return RangeUtil;\r\n}());\r\nexport { RangeUtil };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nimport { toDisposable } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../registry/common/platform.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nexport var IThemeService = createDecorator('themeService');\r\nexport function themeColorFromId(id) {\r\n    return { id: id };\r\n}\r\n// base themes\r\nexport var DARK = 'dark';\r\nexport var HIGH_CONTRAST = 'hc';\r\nexport function getThemeTypeSelector(type) {\r\n    switch (type) {\r\n        case DARK: return 'vs-dark';\r\n        case HIGH_CONTRAST: return 'hc-black';\r\n        default: return 'vs';\r\n    }\r\n}\r\n// static theming participant\r\nexport var Extensions = {\r\n    ThemingContribution: 'base.contributions.theming'\r\n};\r\nvar ThemingRegistry = /** @class */ (function () {\r\n    function ThemingRegistry() {\r\n        this.themingParticipants = [];\r\n        this.themingParticipants = [];\r\n        this.onThemingParticipantAddedEmitter = new Emitter();\r\n    }\r\n    ThemingRegistry.prototype.onThemeChange = function (participant) {\r\n        var _this = this;\r\n        this.themingParticipants.push(participant);\r\n        this.onThemingParticipantAddedEmitter.fire(participant);\r\n        return toDisposable(function () {\r\n            var idx = _this.themingParticipants.indexOf(participant);\r\n            _this.themingParticipants.splice(idx, 1);\r\n        });\r\n    };\r\n    ThemingRegistry.prototype.getThemingParticipants = function () {\r\n        return this.themingParticipants;\r\n    };\r\n    return ThemingRegistry;\r\n}());\r\nvar themingRegistry = new ThemingRegistry();\r\nplatform.Registry.add(Extensions.ThemingContribution, themingRegistry);\r\nexport function registerThemingParticipant(participant) {\r\n    return themingRegistry.onThemeChange(participant);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nimport { RangeUtil } from './rangeUtil.js';\r\nimport { HorizontalRange } from '../../../common/view/renderingContext.js';\r\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\r\nimport { CharacterMapping, RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\r\nimport { HIGH_CONTRAST } from '../../../../platform/theme/common/themeService.js';\r\nvar canUseFastRenderedViewLine = (function () {\r\n    if (platform.isNative) {\r\n        // In VSCode we know very well when the zoom level changes\r\n        return true;\r\n    }\r\n    if (platform.isLinux || browser.isFirefox || browser.isSafari) {\r\n        // On Linux, it appears that zooming affects char widths (in pixels), which is unexpected.\r\n        // --\r\n        // Even though we read character widths correctly, having read them at a specific zoom level\r\n        // does not mean they are the same at the current zoom level.\r\n        // --\r\n        // This could be improved if we ever figure out how to get an event when browsers zoom,\r\n        // but until then we have to stick with reading client rects.\r\n        // --\r\n        // The same has been observed with Firefox on Windows7\r\n        // --\r\n        // The same has been oversved with Safari\r\n        return false;\r\n    }\r\n    return true;\r\n})();\r\nvar alwaysRenderInlineSelection = (browser.isEdgeOrIE);\r\nvar DomReadingContext = /** @class */ (function () {\r\n    function DomReadingContext(domNode, endNode) {\r\n        this._domNode = domNode;\r\n        this._clientRectDeltaLeft = 0;\r\n        this._clientRectDeltaLeftRead = false;\r\n        this.endNode = endNode;\r\n    }\r\n    Object.defineProperty(DomReadingContext.prototype, \"clientRectDeltaLeft\", {\r\n        get: function () {\r\n            if (!this._clientRectDeltaLeftRead) {\r\n                this._clientRectDeltaLeftRead = true;\r\n                this._clientRectDeltaLeft = this._domNode.getBoundingClientRect().left;\r\n            }\r\n            return this._clientRectDeltaLeft;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return DomReadingContext;\r\n}());\r\nexport { DomReadingContext };\r\nvar ViewLineOptions = /** @class */ (function () {\r\n    function ViewLineOptions(config, themeType) {\r\n        this.themeType = themeType;\r\n        this.renderWhitespace = config.editor.viewInfo.renderWhitespace;\r\n        this.renderControlCharacters = config.editor.viewInfo.renderControlCharacters;\r\n        this.spaceWidth = config.editor.fontInfo.spaceWidth;\r\n        this.useMonospaceOptimizations = (config.editor.fontInfo.isMonospace\r\n            && !config.editor.viewInfo.disableMonospaceOptimizations);\r\n        this.canUseHalfwidthRightwardsArrow = config.editor.fontInfo.canUseHalfwidthRightwardsArrow;\r\n        this.lineHeight = config.editor.lineHeight;\r\n        this.stopRenderingLineAfter = config.editor.viewInfo.stopRenderingLineAfter;\r\n        this.fontLigatures = config.editor.viewInfo.fontLigatures;\r\n    }\r\n    ViewLineOptions.prototype.equals = function (other) {\r\n        return (this.themeType === other.themeType\r\n            && this.renderWhitespace === other.renderWhitespace\r\n            && this.renderControlCharacters === other.renderControlCharacters\r\n            && this.spaceWidth === other.spaceWidth\r\n            && this.useMonospaceOptimizations === other.useMonospaceOptimizations\r\n            && this.canUseHalfwidthRightwardsArrow === other.canUseHalfwidthRightwardsArrow\r\n            && this.lineHeight === other.lineHeight\r\n            && this.stopRenderingLineAfter === other.stopRenderingLineAfter\r\n            && this.fontLigatures === other.fontLigatures);\r\n    };\r\n    return ViewLineOptions;\r\n}());\r\nexport { ViewLineOptions };\r\nvar ViewLine = /** @class */ (function () {\r\n    function ViewLine(options) {\r\n        this._options = options;\r\n        this._isMaybeInvalid = true;\r\n        this._renderedViewLine = null;\r\n    }\r\n    // --- begin IVisibleLineData\r\n    ViewLine.prototype.getDomNode = function () {\r\n        if (this._renderedViewLine && this._renderedViewLine.domNode) {\r\n            return this._renderedViewLine.domNode.domNode;\r\n        }\r\n        return null;\r\n    };\r\n    ViewLine.prototype.setDomNode = function (domNode) {\r\n        if (this._renderedViewLine) {\r\n            this._renderedViewLine.domNode = createFastDomNode(domNode);\r\n        }\r\n        else {\r\n            throw new Error('I have no rendered view line to set the dom node to...');\r\n        }\r\n    };\r\n    ViewLine.prototype.onContentChanged = function () {\r\n        this._isMaybeInvalid = true;\r\n    };\r\n    ViewLine.prototype.onTokensChanged = function () {\r\n        this._isMaybeInvalid = true;\r\n    };\r\n    ViewLine.prototype.onDecorationsChanged = function () {\r\n        this._isMaybeInvalid = true;\r\n    };\r\n    ViewLine.prototype.onOptionsChanged = function (newOptions) {\r\n        this._isMaybeInvalid = true;\r\n        this._options = newOptions;\r\n    };\r\n    ViewLine.prototype.onSelectionChanged = function () {\r\n        if (alwaysRenderInlineSelection || this._options.themeType === HIGH_CONTRAST) {\r\n            this._isMaybeInvalid = true;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ViewLine.prototype.renderLine = function (lineNumber, deltaTop, viewportData, sb) {\r\n        if (this._isMaybeInvalid === false) {\r\n            // it appears that nothing relevant has changed\r\n            return false;\r\n        }\r\n        this._isMaybeInvalid = false;\r\n        var lineData = viewportData.getViewLineRenderingData(lineNumber);\r\n        var options = this._options;\r\n        var actualInlineDecorations = LineDecoration.filter(lineData.inlineDecorations, lineNumber, lineData.minColumn, lineData.maxColumn);\r\n        if (alwaysRenderInlineSelection || options.themeType === HIGH_CONTRAST) {\r\n            var selections = viewportData.selections;\r\n            for (var i = 0, len = selections.length; i < len; i++) {\r\n                var selection = selections[i];\r\n                if (selection.endLineNumber < lineNumber || selection.startLineNumber > lineNumber) {\r\n                    // Selection does not intersect line\r\n                    continue;\r\n                }\r\n                var startColumn = (selection.startLineNumber === lineNumber ? selection.startColumn : lineData.minColumn);\r\n                var endColumn = (selection.endLineNumber === lineNumber ? selection.endColumn : lineData.maxColumn);\r\n                if (startColumn < endColumn) {\r\n                    actualInlineDecorations.push(new LineDecoration(startColumn, endColumn, 'inline-selected-text', 0 /* Regular */));\r\n                }\r\n            }\r\n        }\r\n        var renderLineInput = new RenderLineInput(options.useMonospaceOptimizations, options.canUseHalfwidthRightwardsArrow, lineData.content, lineData.continuesWithWrappedLine, lineData.isBasicASCII, lineData.containsRTL, lineData.minColumn - 1, lineData.tokens, actualInlineDecorations, lineData.tabSize, options.spaceWidth, options.stopRenderingLineAfter, options.renderWhitespace, options.renderControlCharacters, options.fontLigatures);\r\n        if (this._renderedViewLine && this._renderedViewLine.input.equals(renderLineInput)) {\r\n            // no need to do anything, we have the same render input\r\n            return false;\r\n        }\r\n        sb.appendASCIIString('<div style=\"top:');\r\n        sb.appendASCIIString(String(deltaTop));\r\n        sb.appendASCIIString('px;height:');\r\n        sb.appendASCIIString(String(this._options.lineHeight));\r\n        sb.appendASCIIString('px;\" class=\"');\r\n        sb.appendASCIIString(ViewLine.CLASS_NAME);\r\n        sb.appendASCIIString('\">');\r\n        var output = renderViewLine(renderLineInput, sb);\r\n        sb.appendASCIIString('</div>');\r\n        var renderedViewLine = null;\r\n        if (canUseFastRenderedViewLine && lineData.isBasicASCII && options.useMonospaceOptimizations && output.containsForeignElements === 0 /* None */) {\r\n            if (lineData.content.length < 300 && renderLineInput.lineTokens.getCount() < 100) {\r\n                // Browser rounding errors have been observed in Chrome and IE, so using the fast\r\n                // view line only for short lines. Please test before removing the length check...\r\n                // ---\r\n                // Another rounding error has been observed on Linux in VSCode, where <span> width\r\n                // rounding errors add up to an observable large number...\r\n                // ---\r\n                // Also see another example of rounding errors on Windows in\r\n                // https://github.com/Microsoft/vscode/issues/33178\r\n                renderedViewLine = new FastRenderedViewLine(this._renderedViewLine ? this._renderedViewLine.domNode : null, renderLineInput, output.characterMapping);\r\n            }\r\n        }\r\n        if (!renderedViewLine) {\r\n            renderedViewLine = createRenderedLine(this._renderedViewLine ? this._renderedViewLine.domNode : null, renderLineInput, output.characterMapping, output.containsRTL, output.containsForeignElements);\r\n        }\r\n        this._renderedViewLine = renderedViewLine;\r\n        return true;\r\n    };\r\n    ViewLine.prototype.layoutLine = function (lineNumber, deltaTop) {\r\n        if (this._renderedViewLine && this._renderedViewLine.domNode) {\r\n            this._renderedViewLine.domNode.setTop(deltaTop);\r\n            this._renderedViewLine.domNode.setHeight(this._options.lineHeight);\r\n        }\r\n    };\r\n    // --- end IVisibleLineData\r\n    ViewLine.prototype.getWidth = function () {\r\n        if (!this._renderedViewLine) {\r\n            return 0;\r\n        }\r\n        return this._renderedViewLine.getWidth();\r\n    };\r\n    ViewLine.prototype.getWidthIsFast = function () {\r\n        if (!this._renderedViewLine) {\r\n            return true;\r\n        }\r\n        return this._renderedViewLine.getWidthIsFast();\r\n    };\r\n    ViewLine.prototype.getVisibleRangesForRange = function (startColumn, endColumn, context) {\r\n        if (!this._renderedViewLine) {\r\n            return null;\r\n        }\r\n        startColumn = startColumn | 0; // @perf\r\n        endColumn = endColumn | 0; // @perf\r\n        startColumn = Math.min(this._renderedViewLine.input.lineContent.length + 1, Math.max(1, startColumn));\r\n        endColumn = Math.min(this._renderedViewLine.input.lineContent.length + 1, Math.max(1, endColumn));\r\n        var stopRenderingLineAfter = this._renderedViewLine.input.stopRenderingLineAfter | 0; // @perf\r\n        if (stopRenderingLineAfter !== -1 && startColumn > stopRenderingLineAfter && endColumn > stopRenderingLineAfter) {\r\n            // This range is obviously not visible\r\n            return null;\r\n        }\r\n        if (stopRenderingLineAfter !== -1 && startColumn > stopRenderingLineAfter) {\r\n            startColumn = stopRenderingLineAfter;\r\n        }\r\n        if (stopRenderingLineAfter !== -1 && endColumn > stopRenderingLineAfter) {\r\n            endColumn = stopRenderingLineAfter;\r\n        }\r\n        return this._renderedViewLine.getVisibleRangesForRange(startColumn, endColumn, context);\r\n    };\r\n    ViewLine.prototype.getColumnOfNodeOffset = function (lineNumber, spanNode, offset) {\r\n        if (!this._renderedViewLine) {\r\n            return 1;\r\n        }\r\n        return this._renderedViewLine.getColumnOfNodeOffset(lineNumber, spanNode, offset);\r\n    };\r\n    ViewLine.CLASS_NAME = 'view-line';\r\n    return ViewLine;\r\n}());\r\nexport { ViewLine };\r\n/**\r\n * A rendered line which is guaranteed to contain only regular ASCII and is rendered with a monospace font.\r\n */\r\nvar FastRenderedViewLine = /** @class */ (function () {\r\n    function FastRenderedViewLine(domNode, renderLineInput, characterMapping) {\r\n        this.domNode = domNode;\r\n        this.input = renderLineInput;\r\n        this._characterMapping = characterMapping;\r\n        this._charWidth = renderLineInput.spaceWidth;\r\n    }\r\n    FastRenderedViewLine.prototype.getWidth = function () {\r\n        return this._getCharPosition(this._characterMapping.length);\r\n    };\r\n    FastRenderedViewLine.prototype.getWidthIsFast = function () {\r\n        return true;\r\n    };\r\n    FastRenderedViewLine.prototype.getVisibleRangesForRange = function (startColumn, endColumn, context) {\r\n        var startPosition = this._getCharPosition(startColumn);\r\n        var endPosition = this._getCharPosition(endColumn);\r\n        return [new HorizontalRange(startPosition, endPosition - startPosition)];\r\n    };\r\n    FastRenderedViewLine.prototype._getCharPosition = function (column) {\r\n        var charOffset = this._characterMapping.getAbsoluteOffsets();\r\n        if (charOffset.length === 0) {\r\n            // No characters on this line\r\n            return 0;\r\n        }\r\n        return Math.round(this._charWidth * charOffset[column - 1]);\r\n    };\r\n    FastRenderedViewLine.prototype.getColumnOfNodeOffset = function (lineNumber, spanNode, offset) {\r\n        var spanNodeTextContentLength = spanNode.textContent.length;\r\n        var spanIndex = -1;\r\n        while (spanNode) {\r\n            spanNode = spanNode.previousSibling;\r\n            spanIndex++;\r\n        }\r\n        var charOffset = this._characterMapping.partDataToCharOffset(spanIndex, spanNodeTextContentLength, offset);\r\n        return charOffset + 1;\r\n    };\r\n    return FastRenderedViewLine;\r\n}());\r\n/**\r\n * Every time we render a line, we save what we have rendered in an instance of this class.\r\n */\r\nvar RenderedViewLine = /** @class */ (function () {\r\n    function RenderedViewLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\r\n        this.domNode = domNode;\r\n        this.input = renderLineInput;\r\n        this._characterMapping = characterMapping;\r\n        this._isWhitespaceOnly = /^\\s*$/.test(renderLineInput.lineContent);\r\n        this._containsForeignElements = containsForeignElements;\r\n        this._cachedWidth = -1;\r\n        this._pixelOffsetCache = null;\r\n        if (!containsRTL || this._characterMapping.length === 0 /* the line is empty */) {\r\n            this._pixelOffsetCache = new Int32Array(Math.max(2, this._characterMapping.length + 1));\r\n            for (var column = 0, len = this._characterMapping.length; column <= len; column++) {\r\n                this._pixelOffsetCache[column] = -1;\r\n            }\r\n        }\r\n    }\r\n    // --- Reading from the DOM methods\r\n    RenderedViewLine.prototype._getReadingTarget = function () {\r\n        return this.domNode.domNode.firstChild;\r\n    };\r\n    /**\r\n     * Width of the line in pixels\r\n     */\r\n    RenderedViewLine.prototype.getWidth = function () {\r\n        if (this._cachedWidth === -1) {\r\n            this._cachedWidth = this._getReadingTarget().offsetWidth;\r\n        }\r\n        return this._cachedWidth;\r\n    };\r\n    RenderedViewLine.prototype.getWidthIsFast = function () {\r\n        if (this._cachedWidth === -1) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * Visible ranges for a model range\r\n     */\r\n    RenderedViewLine.prototype.getVisibleRangesForRange = function (startColumn, endColumn, context) {\r\n        if (this._pixelOffsetCache !== null) {\r\n            // the text is LTR\r\n            var startOffset = this._readPixelOffset(startColumn, context);\r\n            if (startOffset === -1) {\r\n                return null;\r\n            }\r\n            var endOffset = this._readPixelOffset(endColumn, context);\r\n            if (endOffset === -1) {\r\n                return null;\r\n            }\r\n            return [new HorizontalRange(startOffset, endOffset - startOffset)];\r\n        }\r\n        return this._readVisibleRangesForRange(startColumn, endColumn, context);\r\n    };\r\n    RenderedViewLine.prototype._readVisibleRangesForRange = function (startColumn, endColumn, context) {\r\n        if (startColumn === endColumn) {\r\n            var pixelOffset = this._readPixelOffset(startColumn, context);\r\n            if (pixelOffset === -1) {\r\n                return null;\r\n            }\r\n            else {\r\n                return [new HorizontalRange(pixelOffset, 0)];\r\n            }\r\n        }\r\n        else {\r\n            return this._readRawVisibleRangesForRange(startColumn, endColumn, context);\r\n        }\r\n    };\r\n    RenderedViewLine.prototype._readPixelOffset = function (column, context) {\r\n        if (this._characterMapping.length === 0) {\r\n            // This line has no content\r\n            if (this._containsForeignElements === 0 /* None */) {\r\n                // We can assume the line is really empty\r\n                return 0;\r\n            }\r\n            if (this._containsForeignElements === 2 /* After */) {\r\n                // We have foreign elements after the (empty) line\r\n                return 0;\r\n            }\r\n            if (this._containsForeignElements === 1 /* Before */) {\r\n                // We have foreign element before the (empty) line\r\n                return this.getWidth();\r\n            }\r\n        }\r\n        if (this._pixelOffsetCache !== null) {\r\n            // the text is LTR\r\n            var cachedPixelOffset = this._pixelOffsetCache[column];\r\n            if (cachedPixelOffset !== -1) {\r\n                return cachedPixelOffset;\r\n            }\r\n            var result = this._actualReadPixelOffset(column, context);\r\n            this._pixelOffsetCache[column] = result;\r\n            return result;\r\n        }\r\n        return this._actualReadPixelOffset(column, context);\r\n    };\r\n    RenderedViewLine.prototype._actualReadPixelOffset = function (column, context) {\r\n        if (this._characterMapping.length === 0) {\r\n            // This line has no content\r\n            var r_1 = RangeUtil.readHorizontalRanges(this._getReadingTarget(), 0, 0, 0, 0, context.clientRectDeltaLeft, context.endNode);\r\n            if (!r_1 || r_1.length === 0) {\r\n                return -1;\r\n            }\r\n            return r_1[0].left;\r\n        }\r\n        if (column === this._characterMapping.length && this._isWhitespaceOnly && this._containsForeignElements === 0 /* None */) {\r\n            // This branch helps in the case of whitespace only lines which have a width set\r\n            return this.getWidth();\r\n        }\r\n        var partData = this._characterMapping.charOffsetToPartData(column - 1);\r\n        var partIndex = CharacterMapping.getPartIndex(partData);\r\n        var charOffsetInPart = CharacterMapping.getCharIndex(partData);\r\n        var r = RangeUtil.readHorizontalRanges(this._getReadingTarget(), partIndex, charOffsetInPart, partIndex, charOffsetInPart, context.clientRectDeltaLeft, context.endNode);\r\n        if (!r || r.length === 0) {\r\n            return -1;\r\n        }\r\n        return r[0].left;\r\n    };\r\n    RenderedViewLine.prototype._readRawVisibleRangesForRange = function (startColumn, endColumn, context) {\r\n        if (startColumn === 1 && endColumn === this._characterMapping.length) {\r\n            // This branch helps IE with bidi text & gives a performance boost to other browsers when reading visible ranges for an entire line\r\n            return [new HorizontalRange(0, this.getWidth())];\r\n        }\r\n        var startPartData = this._characterMapping.charOffsetToPartData(startColumn - 1);\r\n        var startPartIndex = CharacterMapping.getPartIndex(startPartData);\r\n        var startCharOffsetInPart = CharacterMapping.getCharIndex(startPartData);\r\n        var endPartData = this._characterMapping.charOffsetToPartData(endColumn - 1);\r\n        var endPartIndex = CharacterMapping.getPartIndex(endPartData);\r\n        var endCharOffsetInPart = CharacterMapping.getCharIndex(endPartData);\r\n        return RangeUtil.readHorizontalRanges(this._getReadingTarget(), startPartIndex, startCharOffsetInPart, endPartIndex, endCharOffsetInPart, context.clientRectDeltaLeft, context.endNode);\r\n    };\r\n    /**\r\n     * Returns the column for the text found at a specific offset inside a rendered dom node\r\n     */\r\n    RenderedViewLine.prototype.getColumnOfNodeOffset = function (lineNumber, spanNode, offset) {\r\n        var spanNodeTextContentLength = spanNode.textContent.length;\r\n        var spanIndex = -1;\r\n        while (spanNode) {\r\n            spanNode = spanNode.previousSibling;\r\n            spanIndex++;\r\n        }\r\n        var charOffset = this._characterMapping.partDataToCharOffset(spanIndex, spanNodeTextContentLength, offset);\r\n        return charOffset + 1;\r\n    };\r\n    return RenderedViewLine;\r\n}());\r\nvar WebKitRenderedViewLine = /** @class */ (function (_super) {\r\n    __extends(WebKitRenderedViewLine, _super);\r\n    function WebKitRenderedViewLine() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WebKitRenderedViewLine.prototype._readVisibleRangesForRange = function (startColumn, endColumn, context) {\r\n        var output = _super.prototype._readVisibleRangesForRange.call(this, startColumn, endColumn, context);\r\n        if (!output || output.length === 0 || startColumn === endColumn || (startColumn === 1 && endColumn === this._characterMapping.length)) {\r\n            return output;\r\n        }\r\n        // WebKit is buggy and returns an expanded range (to contain words in some cases)\r\n        // The last client rect is enlarged (I think)\r\n        if (!this.input.containsRTL) {\r\n            // This is an attempt to patch things up\r\n            // Find position of last column\r\n            var endPixelOffset = this._readPixelOffset(endColumn, context);\r\n            if (endPixelOffset !== -1) {\r\n                var lastRange = output[output.length - 1];\r\n                if (lastRange.left < endPixelOffset) {\r\n                    // Trim down the width of the last visible range to not go after the last column's position\r\n                    lastRange.width = endPixelOffset - lastRange.left;\r\n                }\r\n            }\r\n        }\r\n        return output;\r\n    };\r\n    return WebKitRenderedViewLine;\r\n}(RenderedViewLine));\r\nvar createRenderedLine = (function () {\r\n    if (browser.isWebKit) {\r\n        return createWebKitRenderedLine;\r\n    }\r\n    return createNormalRenderedLine;\r\n})();\r\nfunction createWebKitRenderedLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\r\n    return new WebKitRenderedViewLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements);\r\n}\r\nfunction createNormalRenderedLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\r\n    return new RenderedViewLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from '../../../base/browser/browser.js';\r\nimport { PageCoordinates } from '../editorDom.js';\r\nimport { PartFingerprints } from '../view/viewPart.js';\r\nimport { ViewLine } from '../viewParts/lines/viewLine.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range as EditorRange } from '../../common/core/range.js';\r\nvar MouseTarget = /** @class */ (function () {\r\n    function MouseTarget(element, type, mouseColumn, position, range, detail) {\r\n        if (mouseColumn === void 0) { mouseColumn = 0; }\r\n        if (position === void 0) { position = null; }\r\n        if (range === void 0) { range = null; }\r\n        if (detail === void 0) { detail = null; }\r\n        this.element = element;\r\n        this.type = type;\r\n        this.mouseColumn = mouseColumn;\r\n        this.position = position;\r\n        if (!range && position) {\r\n            range = new EditorRange(position.lineNumber, position.column, position.lineNumber, position.column);\r\n        }\r\n        this.range = range;\r\n        this.detail = detail;\r\n    }\r\n    MouseTarget._typeToString = function (type) {\r\n        if (type === 1 /* TEXTAREA */) {\r\n            return 'TEXTAREA';\r\n        }\r\n        if (type === 2 /* GUTTER_GLYPH_MARGIN */) {\r\n            return 'GUTTER_GLYPH_MARGIN';\r\n        }\r\n        if (type === 3 /* GUTTER_LINE_NUMBERS */) {\r\n            return 'GUTTER_LINE_NUMBERS';\r\n        }\r\n        if (type === 4 /* GUTTER_LINE_DECORATIONS */) {\r\n            return 'GUTTER_LINE_DECORATIONS';\r\n        }\r\n        if (type === 5 /* GUTTER_VIEW_ZONE */) {\r\n            return 'GUTTER_VIEW_ZONE';\r\n        }\r\n        if (type === 6 /* CONTENT_TEXT */) {\r\n            return 'CONTENT_TEXT';\r\n        }\r\n        if (type === 7 /* CONTENT_EMPTY */) {\r\n            return 'CONTENT_EMPTY';\r\n        }\r\n        if (type === 8 /* CONTENT_VIEW_ZONE */) {\r\n            return 'CONTENT_VIEW_ZONE';\r\n        }\r\n        if (type === 9 /* CONTENT_WIDGET */) {\r\n            return 'CONTENT_WIDGET';\r\n        }\r\n        if (type === 10 /* OVERVIEW_RULER */) {\r\n            return 'OVERVIEW_RULER';\r\n        }\r\n        if (type === 11 /* SCROLLBAR */) {\r\n            return 'SCROLLBAR';\r\n        }\r\n        if (type === 12 /* OVERLAY_WIDGET */) {\r\n            return 'OVERLAY_WIDGET';\r\n        }\r\n        return 'UNKNOWN';\r\n    };\r\n    MouseTarget.toString = function (target) {\r\n        return this._typeToString(target.type) + ': ' + target.position + ' - ' + target.range + ' - ' + target.detail;\r\n    };\r\n    MouseTarget.prototype.toString = function () {\r\n        return MouseTarget.toString(this);\r\n    };\r\n    return MouseTarget;\r\n}());\r\nexport { MouseTarget };\r\nvar ElementPath = /** @class */ (function () {\r\n    function ElementPath() {\r\n    }\r\n    ElementPath.isTextArea = function (path) {\r\n        return (path.length === 2\r\n            && path[0] === 3 /* OverflowGuard */\r\n            && path[1] === 6 /* TextArea */);\r\n    };\r\n    ElementPath.isChildOfViewLines = function (path) {\r\n        return (path.length >= 4\r\n            && path[0] === 3 /* OverflowGuard */\r\n            && path[3] === 7 /* ViewLines */);\r\n    };\r\n    ElementPath.isStrictChildOfViewLines = function (path) {\r\n        return (path.length > 4\r\n            && path[0] === 3 /* OverflowGuard */\r\n            && path[3] === 7 /* ViewLines */);\r\n    };\r\n    ElementPath.isChildOfScrollableElement = function (path) {\r\n        return (path.length >= 2\r\n            && path[0] === 3 /* OverflowGuard */\r\n            && path[1] === 5 /* ScrollableElement */);\r\n    };\r\n    ElementPath.isChildOfMinimap = function (path) {\r\n        return (path.length >= 2\r\n            && path[0] === 3 /* OverflowGuard */\r\n            && path[1] === 8 /* Minimap */);\r\n    };\r\n    ElementPath.isChildOfContentWidgets = function (path) {\r\n        return (path.length >= 4\r\n            && path[0] === 3 /* OverflowGuard */\r\n            && path[3] === 1 /* ContentWidgets */);\r\n    };\r\n    ElementPath.isChildOfOverflowingContentWidgets = function (path) {\r\n        return (path.length >= 1\r\n            && path[0] === 2 /* OverflowingContentWidgets */);\r\n    };\r\n    ElementPath.isChildOfOverlayWidgets = function (path) {\r\n        return (path.length >= 2\r\n            && path[0] === 3 /* OverflowGuard */\r\n            && path[1] === 4 /* OverlayWidgets */);\r\n    };\r\n    return ElementPath;\r\n}());\r\nvar HitTestContext = /** @class */ (function () {\r\n    function HitTestContext(context, viewHelper, lastViewCursorsRenderData) {\r\n        this.model = context.model;\r\n        this.layoutInfo = context.configuration.editor.layoutInfo;\r\n        this.viewDomNode = viewHelper.viewDomNode;\r\n        this.lineHeight = context.configuration.editor.lineHeight;\r\n        this.typicalHalfwidthCharacterWidth = context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n        this.lastViewCursorsRenderData = lastViewCursorsRenderData;\r\n        this._context = context;\r\n        this._viewHelper = viewHelper;\r\n    }\r\n    HitTestContext.prototype.getZoneAtCoord = function (mouseVerticalOffset) {\r\n        return HitTestContext.getZoneAtCoord(this._context, mouseVerticalOffset);\r\n    };\r\n    HitTestContext.getZoneAtCoord = function (context, mouseVerticalOffset) {\r\n        // The target is either a view zone or the empty space after the last view-line\r\n        var viewZoneWhitespace = context.viewLayout.getWhitespaceAtVerticalOffset(mouseVerticalOffset);\r\n        if (viewZoneWhitespace) {\r\n            var viewZoneMiddle = viewZoneWhitespace.verticalOffset + viewZoneWhitespace.height / 2, lineCount = context.model.getLineCount(), positionBefore = null, position = void 0, positionAfter = null;\r\n            if (viewZoneWhitespace.afterLineNumber !== lineCount) {\r\n                // There are more lines after this view zone\r\n                positionAfter = new Position(viewZoneWhitespace.afterLineNumber + 1, 1);\r\n            }\r\n            if (viewZoneWhitespace.afterLineNumber > 0) {\r\n                // There are more lines above this view zone\r\n                positionBefore = new Position(viewZoneWhitespace.afterLineNumber, context.model.getLineMaxColumn(viewZoneWhitespace.afterLineNumber));\r\n            }\r\n            if (positionAfter === null) {\r\n                position = positionBefore;\r\n            }\r\n            else if (positionBefore === null) {\r\n                position = positionAfter;\r\n            }\r\n            else if (mouseVerticalOffset < viewZoneMiddle) {\r\n                position = positionBefore;\r\n            }\r\n            else {\r\n                position = positionAfter;\r\n            }\r\n            return {\r\n                viewZoneId: viewZoneWhitespace.id,\r\n                afterLineNumber: viewZoneWhitespace.afterLineNumber,\r\n                positionBefore: positionBefore,\r\n                positionAfter: positionAfter,\r\n                position: position\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    HitTestContext.prototype.getFullLineRangeAtCoord = function (mouseVerticalOffset) {\r\n        if (this._context.viewLayout.isAfterLines(mouseVerticalOffset)) {\r\n            // Below the last line\r\n            var lineNumber_1 = this._context.model.getLineCount();\r\n            var maxLineColumn_1 = this._context.model.getLineMaxColumn(lineNumber_1);\r\n            return {\r\n                range: new EditorRange(lineNumber_1, maxLineColumn_1, lineNumber_1, maxLineColumn_1),\r\n                isAfterLines: true\r\n            };\r\n        }\r\n        var lineNumber = this._context.viewLayout.getLineNumberAtVerticalOffset(mouseVerticalOffset);\r\n        var maxLineColumn = this._context.model.getLineMaxColumn(lineNumber);\r\n        return {\r\n            range: new EditorRange(lineNumber, 1, lineNumber, maxLineColumn),\r\n            isAfterLines: false\r\n        };\r\n    };\r\n    HitTestContext.prototype.getLineNumberAtVerticalOffset = function (mouseVerticalOffset) {\r\n        return this._context.viewLayout.getLineNumberAtVerticalOffset(mouseVerticalOffset);\r\n    };\r\n    HitTestContext.prototype.isAfterLines = function (mouseVerticalOffset) {\r\n        return this._context.viewLayout.isAfterLines(mouseVerticalOffset);\r\n    };\r\n    HitTestContext.prototype.getVerticalOffsetForLineNumber = function (lineNumber) {\r\n        return this._context.viewLayout.getVerticalOffsetForLineNumber(lineNumber);\r\n    };\r\n    HitTestContext.prototype.findAttribute = function (element, attr) {\r\n        return HitTestContext._findAttribute(element, attr, this._viewHelper.viewDomNode);\r\n    };\r\n    HitTestContext._findAttribute = function (element, attr, stopAt) {\r\n        while (element && element !== document.body) {\r\n            if (element.hasAttribute && element.hasAttribute(attr)) {\r\n                return element.getAttribute(attr);\r\n            }\r\n            if (element === stopAt) {\r\n                return null;\r\n            }\r\n            element = element.parentNode;\r\n        }\r\n        return null;\r\n    };\r\n    HitTestContext.prototype.getLineWidth = function (lineNumber) {\r\n        return this._viewHelper.getLineWidth(lineNumber);\r\n    };\r\n    HitTestContext.prototype.visibleRangeForPosition2 = function (lineNumber, column) {\r\n        return this._viewHelper.visibleRangeForPosition2(lineNumber, column);\r\n    };\r\n    HitTestContext.prototype.getPositionFromDOMInfo = function (spanNode, offset) {\r\n        return this._viewHelper.getPositionFromDOMInfo(spanNode, offset);\r\n    };\r\n    HitTestContext.prototype.getCurrentScrollTop = function () {\r\n        return this._context.viewLayout.getCurrentScrollTop();\r\n    };\r\n    HitTestContext.prototype.getCurrentScrollLeft = function () {\r\n        return this._context.viewLayout.getCurrentScrollLeft();\r\n    };\r\n    return HitTestContext;\r\n}());\r\nexport { HitTestContext };\r\nvar BareHitTestRequest = /** @class */ (function () {\r\n    function BareHitTestRequest(ctx, editorPos, pos) {\r\n        this.editorPos = editorPos;\r\n        this.pos = pos;\r\n        this.mouseVerticalOffset = Math.max(0, ctx.getCurrentScrollTop() + pos.y - editorPos.y);\r\n        this.mouseContentHorizontalOffset = ctx.getCurrentScrollLeft() + pos.x - editorPos.x - ctx.layoutInfo.contentLeft;\r\n        this.isInMarginArea = (pos.x - editorPos.x < ctx.layoutInfo.contentLeft && pos.x - editorPos.x >= ctx.layoutInfo.glyphMarginLeft);\r\n        this.isInContentArea = !this.isInMarginArea;\r\n        this.mouseColumn = Math.max(0, MouseTargetFactory._getMouseColumn(this.mouseContentHorizontalOffset, ctx.typicalHalfwidthCharacterWidth));\r\n    }\r\n    return BareHitTestRequest;\r\n}());\r\nvar HitTestRequest = /** @class */ (function (_super) {\r\n    __extends(HitTestRequest, _super);\r\n    function HitTestRequest(ctx, editorPos, pos, target) {\r\n        var _this = _super.call(this, ctx, editorPos, pos) || this;\r\n        _this._ctx = ctx;\r\n        if (target) {\r\n            _this.target = target;\r\n            _this.targetPath = PartFingerprints.collect(target, ctx.viewDomNode);\r\n        }\r\n        else {\r\n            _this.target = null;\r\n            _this.targetPath = new Uint8Array(0);\r\n        }\r\n        return _this;\r\n    }\r\n    HitTestRequest.prototype.toString = function () {\r\n        return \"pos(\" + this.pos.x + \",\" + this.pos.y + \"), editorPos(\" + this.editorPos.x + \",\" + this.editorPos.y + \"), mouseVerticalOffset: \" + this.mouseVerticalOffset + \", mouseContentHorizontalOffset: \" + this.mouseContentHorizontalOffset + \"\\n\\ttarget: \" + (this.target ? this.target.outerHTML : null);\r\n    };\r\n    HitTestRequest.prototype.fulfill = function (type, position, range, detail) {\r\n        if (position === void 0) { position = null; }\r\n        if (range === void 0) { range = null; }\r\n        if (detail === void 0) { detail = null; }\r\n        return new MouseTarget(this.target, type, this.mouseColumn, position, range, detail);\r\n    };\r\n    HitTestRequest.prototype.withTarget = function (target) {\r\n        return new HitTestRequest(this._ctx, this.editorPos, this.pos, target);\r\n    };\r\n    return HitTestRequest;\r\n}(BareHitTestRequest));\r\nvar EMPTY_CONTENT_AFTER_LINES = { isAfterLines: true };\r\nfunction createEmptyContentDataInLines(horizontalDistanceToText) {\r\n    return {\r\n        isAfterLines: false,\r\n        horizontalDistanceToText: horizontalDistanceToText\r\n    };\r\n}\r\nvar MouseTargetFactory = /** @class */ (function () {\r\n    function MouseTargetFactory(context, viewHelper) {\r\n        this._context = context;\r\n        this._viewHelper = viewHelper;\r\n    }\r\n    MouseTargetFactory.prototype.mouseTargetIsWidget = function (e) {\r\n        var t = e.target;\r\n        var path = PartFingerprints.collect(t, this._viewHelper.viewDomNode);\r\n        // Is it a content widget?\r\n        if (ElementPath.isChildOfContentWidgets(path) || ElementPath.isChildOfOverflowingContentWidgets(path)) {\r\n            return true;\r\n        }\r\n        // Is it an overlay widget?\r\n        if (ElementPath.isChildOfOverlayWidgets(path)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    MouseTargetFactory.prototype.createMouseTarget = function (lastViewCursorsRenderData, editorPos, pos, target) {\r\n        var ctx = new HitTestContext(this._context, this._viewHelper, lastViewCursorsRenderData);\r\n        var request = new HitTestRequest(ctx, editorPos, pos, target);\r\n        try {\r\n            var r = MouseTargetFactory._createMouseTarget(ctx, request, false);\r\n            // console.log(r.toString());\r\n            return r;\r\n        }\r\n        catch (err) {\r\n            // console.log(err);\r\n            return request.fulfill(0 /* UNKNOWN */);\r\n        }\r\n    };\r\n    MouseTargetFactory._createMouseTarget = function (ctx, request, domHitTestExecuted) {\r\n        // console.log(`${domHitTestExecuted ? '=>' : ''}CAME IN REQUEST: ${request}`);\r\n        // First ensure the request has a target\r\n        if (request.target === null) {\r\n            if (domHitTestExecuted) {\r\n                // Still no target... and we have already executed hit test...\r\n                return request.fulfill(0 /* UNKNOWN */);\r\n            }\r\n            var hitTestResult = MouseTargetFactory._doHitTest(ctx, request);\r\n            if (hitTestResult.position) {\r\n                return MouseTargetFactory.createMouseTargetFromHitTestPosition(ctx, request, hitTestResult.position.lineNumber, hitTestResult.position.column);\r\n            }\r\n            return this._createMouseTarget(ctx, request.withTarget(hitTestResult.hitTarget), true);\r\n        }\r\n        // we know for a fact that request.target is not null\r\n        var resolvedRequest = request;\r\n        var result = null;\r\n        result = result || MouseTargetFactory._hitTestContentWidget(ctx, resolvedRequest);\r\n        result = result || MouseTargetFactory._hitTestOverlayWidget(ctx, resolvedRequest);\r\n        result = result || MouseTargetFactory._hitTestMinimap(ctx, resolvedRequest);\r\n        result = result || MouseTargetFactory._hitTestScrollbarSlider(ctx, resolvedRequest);\r\n        result = result || MouseTargetFactory._hitTestViewZone(ctx, resolvedRequest);\r\n        result = result || MouseTargetFactory._hitTestMargin(ctx, resolvedRequest);\r\n        result = result || MouseTargetFactory._hitTestViewCursor(ctx, resolvedRequest);\r\n        result = result || MouseTargetFactory._hitTestTextArea(ctx, resolvedRequest);\r\n        result = result || MouseTargetFactory._hitTestViewLines(ctx, resolvedRequest, domHitTestExecuted);\r\n        result = result || MouseTargetFactory._hitTestScrollbar(ctx, resolvedRequest);\r\n        return (result || request.fulfill(0 /* UNKNOWN */));\r\n    };\r\n    MouseTargetFactory._hitTestContentWidget = function (ctx, request) {\r\n        // Is it a content widget?\r\n        if (ElementPath.isChildOfContentWidgets(request.targetPath) || ElementPath.isChildOfOverflowingContentWidgets(request.targetPath)) {\r\n            var widgetId = ctx.findAttribute(request.target, 'widgetId');\r\n            if (widgetId) {\r\n                return request.fulfill(9 /* CONTENT_WIDGET */, null, null, widgetId);\r\n            }\r\n            else {\r\n                return request.fulfill(0 /* UNKNOWN */);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    MouseTargetFactory._hitTestOverlayWidget = function (ctx, request) {\r\n        // Is it an overlay widget?\r\n        if (ElementPath.isChildOfOverlayWidgets(request.targetPath)) {\r\n            var widgetId = ctx.findAttribute(request.target, 'widgetId');\r\n            if (widgetId) {\r\n                return request.fulfill(12 /* OVERLAY_WIDGET */, null, null, widgetId);\r\n            }\r\n            else {\r\n                return request.fulfill(0 /* UNKNOWN */);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    MouseTargetFactory._hitTestViewCursor = function (ctx, request) {\r\n        if (request.target) {\r\n            // Check if we've hit a painted cursor\r\n            var lastViewCursorsRenderData = ctx.lastViewCursorsRenderData;\r\n            for (var i = 0, len = lastViewCursorsRenderData.length; i < len; i++) {\r\n                var d = lastViewCursorsRenderData[i];\r\n                if (request.target === d.domNode) {\r\n                    return request.fulfill(6 /* CONTENT_TEXT */, d.position);\r\n                }\r\n            }\r\n        }\r\n        if (request.isInContentArea) {\r\n            // Edge has a bug when hit-testing the exact position of a cursor,\r\n            // instead of returning the correct dom node, it returns the\r\n            // first or last rendered view line dom node, therefore help it out\r\n            // and first check if we are on top of a cursor\r\n            var lastViewCursorsRenderData = ctx.lastViewCursorsRenderData;\r\n            var mouseContentHorizontalOffset = request.mouseContentHorizontalOffset;\r\n            var mouseVerticalOffset = request.mouseVerticalOffset;\r\n            for (var i = 0, len = lastViewCursorsRenderData.length; i < len; i++) {\r\n                var d = lastViewCursorsRenderData[i];\r\n                if (mouseContentHorizontalOffset < d.contentLeft) {\r\n                    // mouse position is to the left of the cursor\r\n                    continue;\r\n                }\r\n                if (mouseContentHorizontalOffset > d.contentLeft + d.width) {\r\n                    // mouse position is to the right of the cursor\r\n                    continue;\r\n                }\r\n                var cursorVerticalOffset = ctx.getVerticalOffsetForLineNumber(d.position.lineNumber);\r\n                if (cursorVerticalOffset <= mouseVerticalOffset\r\n                    && mouseVerticalOffset <= cursorVerticalOffset + d.height) {\r\n                    return request.fulfill(6 /* CONTENT_TEXT */, d.position);\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    MouseTargetFactory._hitTestViewZone = function (ctx, request) {\r\n        var viewZoneData = ctx.getZoneAtCoord(request.mouseVerticalOffset);\r\n        if (viewZoneData) {\r\n            var mouseTargetType = (request.isInContentArea ? 8 /* CONTENT_VIEW_ZONE */ : 5 /* GUTTER_VIEW_ZONE */);\r\n            return request.fulfill(mouseTargetType, viewZoneData.position, null, viewZoneData);\r\n        }\r\n        return null;\r\n    };\r\n    MouseTargetFactory._hitTestTextArea = function (ctx, request) {\r\n        // Is it the textarea?\r\n        if (ElementPath.isTextArea(request.targetPath)) {\r\n            return request.fulfill(1 /* TEXTAREA */);\r\n        }\r\n        return null;\r\n    };\r\n    MouseTargetFactory._hitTestMargin = function (ctx, request) {\r\n        if (request.isInMarginArea) {\r\n            var res = ctx.getFullLineRangeAtCoord(request.mouseVerticalOffset);\r\n            var pos = res.range.getStartPosition();\r\n            var offset = Math.abs(request.pos.x - request.editorPos.x);\r\n            var detail = {\r\n                isAfterLines: res.isAfterLines,\r\n                glyphMarginLeft: ctx.layoutInfo.glyphMarginLeft,\r\n                glyphMarginWidth: ctx.layoutInfo.glyphMarginWidth,\r\n                lineNumbersWidth: ctx.layoutInfo.lineNumbersWidth,\r\n                offsetX: offset\r\n            };\r\n            offset -= ctx.layoutInfo.glyphMarginLeft;\r\n            if (offset <= ctx.layoutInfo.glyphMarginWidth) {\r\n                // On the glyph margin\r\n                return request.fulfill(2 /* GUTTER_GLYPH_MARGIN */, pos, res.range, detail);\r\n            }\r\n            offset -= ctx.layoutInfo.glyphMarginWidth;\r\n            if (offset <= ctx.layoutInfo.lineNumbersWidth) {\r\n                // On the line numbers\r\n                return request.fulfill(3 /* GUTTER_LINE_NUMBERS */, pos, res.range, detail);\r\n            }\r\n            offset -= ctx.layoutInfo.lineNumbersWidth;\r\n            // On the line decorations\r\n            return request.fulfill(4 /* GUTTER_LINE_DECORATIONS */, pos, res.range, detail);\r\n        }\r\n        return null;\r\n    };\r\n    MouseTargetFactory._hitTestViewLines = function (ctx, request, domHitTestExecuted) {\r\n        if (!ElementPath.isChildOfViewLines(request.targetPath)) {\r\n            return null;\r\n        }\r\n        // Check if it is below any lines and any view zones\r\n        if (ctx.isAfterLines(request.mouseVerticalOffset)) {\r\n            // This most likely indicates it happened after the last view-line\r\n            var lineCount = ctx.model.getLineCount();\r\n            var maxLineColumn = ctx.model.getLineMaxColumn(lineCount);\r\n            return request.fulfill(7 /* CONTENT_EMPTY */, new Position(lineCount, maxLineColumn), void 0, EMPTY_CONTENT_AFTER_LINES);\r\n        }\r\n        if (domHitTestExecuted) {\r\n            // Check if we are hitting a view-line (can happen in the case of inline decorations on empty lines)\r\n            // See https://github.com/Microsoft/vscode/issues/46942\r\n            if (ElementPath.isStrictChildOfViewLines(request.targetPath)) {\r\n                var lineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\r\n                if (ctx.model.getLineLength(lineNumber) === 0) {\r\n                    var lineWidth = ctx.getLineWidth(lineNumber);\r\n                    var detail = createEmptyContentDataInLines(request.mouseContentHorizontalOffset - lineWidth);\r\n                    return request.fulfill(7 /* CONTENT_EMPTY */, new Position(lineNumber, 1), void 0, detail);\r\n                }\r\n            }\r\n            // We have already executed hit test...\r\n            return request.fulfill(0 /* UNKNOWN */);\r\n        }\r\n        var hitTestResult = MouseTargetFactory._doHitTest(ctx, request);\r\n        if (hitTestResult.position) {\r\n            return MouseTargetFactory.createMouseTargetFromHitTestPosition(ctx, request, hitTestResult.position.lineNumber, hitTestResult.position.column);\r\n        }\r\n        return this._createMouseTarget(ctx, request.withTarget(hitTestResult.hitTarget), true);\r\n    };\r\n    MouseTargetFactory._hitTestMinimap = function (ctx, request) {\r\n        if (ElementPath.isChildOfMinimap(request.targetPath)) {\r\n            var possibleLineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\r\n            var maxColumn = ctx.model.getLineMaxColumn(possibleLineNumber);\r\n            return request.fulfill(11 /* SCROLLBAR */, new Position(possibleLineNumber, maxColumn));\r\n        }\r\n        return null;\r\n    };\r\n    MouseTargetFactory._hitTestScrollbarSlider = function (ctx, request) {\r\n        if (ElementPath.isChildOfScrollableElement(request.targetPath)) {\r\n            if (request.target && request.target.nodeType === 1) {\r\n                var className = request.target.className;\r\n                if (className && /\\b(slider|scrollbar)\\b/.test(className)) {\r\n                    var possibleLineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\r\n                    var maxColumn = ctx.model.getLineMaxColumn(possibleLineNumber);\r\n                    return request.fulfill(11 /* SCROLLBAR */, new Position(possibleLineNumber, maxColumn));\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    MouseTargetFactory._hitTestScrollbar = function (ctx, request) {\r\n        // Is it the overview ruler?\r\n        // Is it a child of the scrollable element?\r\n        if (ElementPath.isChildOfScrollableElement(request.targetPath)) {\r\n            var possibleLineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\r\n            var maxColumn = ctx.model.getLineMaxColumn(possibleLineNumber);\r\n            return request.fulfill(11 /* SCROLLBAR */, new Position(possibleLineNumber, maxColumn));\r\n        }\r\n        return null;\r\n    };\r\n    MouseTargetFactory.prototype.getMouseColumn = function (editorPos, pos) {\r\n        var layoutInfo = this._context.configuration.editor.layoutInfo;\r\n        var mouseContentHorizontalOffset = this._context.viewLayout.getCurrentScrollLeft() + pos.x - editorPos.x - layoutInfo.contentLeft;\r\n        return MouseTargetFactory._getMouseColumn(mouseContentHorizontalOffset, this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth);\r\n    };\r\n    MouseTargetFactory._getMouseColumn = function (mouseContentHorizontalOffset, typicalHalfwidthCharacterWidth) {\r\n        if (mouseContentHorizontalOffset < 0) {\r\n            return 1;\r\n        }\r\n        var chars = Math.round(mouseContentHorizontalOffset / typicalHalfwidthCharacterWidth);\r\n        return (chars + 1);\r\n    };\r\n    MouseTargetFactory.createMouseTargetFromHitTestPosition = function (ctx, request, lineNumber, column) {\r\n        var pos = new Position(lineNumber, column);\r\n        var lineWidth = ctx.getLineWidth(lineNumber);\r\n        if (request.mouseContentHorizontalOffset > lineWidth) {\r\n            if (browser.isEdge && pos.column === 1) {\r\n                // See https://github.com/Microsoft/vscode/issues/10875\r\n                var detail_1 = createEmptyContentDataInLines(request.mouseContentHorizontalOffset - lineWidth);\r\n                return request.fulfill(7 /* CONTENT_EMPTY */, new Position(lineNumber, ctx.model.getLineMaxColumn(lineNumber)), void 0, detail_1);\r\n            }\r\n            var detail = createEmptyContentDataInLines(request.mouseContentHorizontalOffset - lineWidth);\r\n            return request.fulfill(7 /* CONTENT_EMPTY */, pos, void 0, detail);\r\n        }\r\n        var visibleRange = ctx.visibleRangeForPosition2(lineNumber, column);\r\n        if (!visibleRange) {\r\n            return request.fulfill(0 /* UNKNOWN */, pos);\r\n        }\r\n        var columnHorizontalOffset = visibleRange.left;\r\n        if (request.mouseContentHorizontalOffset === columnHorizontalOffset) {\r\n            return request.fulfill(6 /* CONTENT_TEXT */, pos);\r\n        }\r\n        var points = [];\r\n        points.push({ offset: visibleRange.left, column: column });\r\n        if (column > 1) {\r\n            var visibleRange_1 = ctx.visibleRangeForPosition2(lineNumber, column - 1);\r\n            if (visibleRange_1) {\r\n                points.push({ offset: visibleRange_1.left, column: column - 1 });\r\n            }\r\n        }\r\n        var lineMaxColumn = ctx.model.getLineMaxColumn(lineNumber);\r\n        if (column < lineMaxColumn) {\r\n            var visibleRange_2 = ctx.visibleRangeForPosition2(lineNumber, column + 1);\r\n            if (visibleRange_2) {\r\n                points.push({ offset: visibleRange_2.left, column: column + 1 });\r\n            }\r\n        }\r\n        points.sort(function (a, b) { return a.offset - b.offset; });\r\n        for (var i = 1; i < points.length; i++) {\r\n            var prev = points[i - 1];\r\n            var curr = points[i];\r\n            if (prev.offset <= request.mouseContentHorizontalOffset && request.mouseContentHorizontalOffset <= curr.offset) {\r\n                var rng = new EditorRange(lineNumber, prev.column, lineNumber, curr.column);\r\n                return request.fulfill(6 /* CONTENT_TEXT */, pos, rng);\r\n            }\r\n        }\r\n        return request.fulfill(6 /* CONTENT_TEXT */, pos);\r\n    };\r\n    /**\r\n     * Most probably WebKit browsers and Edge\r\n     */\r\n    MouseTargetFactory._doHitTestWithCaretRangeFromPoint = function (ctx, request) {\r\n        // In Chrome, especially on Linux it is possible to click between lines,\r\n        // so try to adjust the `hity` below so that it lands in the center of a line\r\n        var lineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\r\n        var lineVerticalOffset = ctx.getVerticalOffsetForLineNumber(lineNumber);\r\n        var lineCenteredVerticalOffset = lineVerticalOffset + Math.floor(ctx.lineHeight / 2);\r\n        var adjustedPageY = request.pos.y + (lineCenteredVerticalOffset - request.mouseVerticalOffset);\r\n        if (adjustedPageY <= request.editorPos.y) {\r\n            adjustedPageY = request.editorPos.y + 1;\r\n        }\r\n        if (adjustedPageY >= request.editorPos.y + ctx.layoutInfo.height) {\r\n            adjustedPageY = request.editorPos.y + ctx.layoutInfo.height - 1;\r\n        }\r\n        var adjustedPage = new PageCoordinates(request.pos.x, adjustedPageY);\r\n        var r = this._actualDoHitTestWithCaretRangeFromPoint(ctx, adjustedPage.toClientCoordinates());\r\n        if (r.position) {\r\n            return r;\r\n        }\r\n        // Also try to hit test without the adjustment (for the edge cases that we are near the top or bottom)\r\n        return this._actualDoHitTestWithCaretRangeFromPoint(ctx, request.pos.toClientCoordinates());\r\n    };\r\n    MouseTargetFactory._actualDoHitTestWithCaretRangeFromPoint = function (ctx, coords) {\r\n        var range = document.caretRangeFromPoint(coords.clientX, coords.clientY);\r\n        if (!range || !range.startContainer) {\r\n            return {\r\n                position: null,\r\n                hitTarget: null\r\n            };\r\n        }\r\n        // Chrome always hits a TEXT_NODE, while Edge sometimes hits a token span\r\n        var startContainer = range.startContainer;\r\n        var hitTarget = null;\r\n        if (startContainer.nodeType === startContainer.TEXT_NODE) {\r\n            // startContainer is expected to be the token text\r\n            var parent1 = startContainer.parentNode; // expected to be the token span\r\n            var parent2 = parent1 ? parent1.parentNode : null; // expected to be the view line container span\r\n            var parent3 = parent2 ? parent2.parentNode : null; // expected to be the view line div\r\n            var parent3ClassName = parent3 && parent3.nodeType === parent3.ELEMENT_NODE ? parent3.className : null;\r\n            if (parent3ClassName === ViewLine.CLASS_NAME) {\r\n                var p = ctx.getPositionFromDOMInfo(parent1, range.startOffset);\r\n                return {\r\n                    position: p,\r\n                    hitTarget: null\r\n                };\r\n            }\r\n            else {\r\n                hitTarget = startContainer.parentNode;\r\n            }\r\n        }\r\n        else if (startContainer.nodeType === startContainer.ELEMENT_NODE) {\r\n            // startContainer is expected to be the token span\r\n            var parent1 = startContainer.parentNode; // expected to be the view line container span\r\n            var parent2 = parent1 ? parent1.parentNode : null; // expected to be the view line div\r\n            var parent2ClassName = parent2 && parent2.nodeType === parent2.ELEMENT_NODE ? parent2.className : null;\r\n            if (parent2ClassName === ViewLine.CLASS_NAME) {\r\n                var p = ctx.getPositionFromDOMInfo(startContainer, startContainer.textContent.length);\r\n                return {\r\n                    position: p,\r\n                    hitTarget: null\r\n                };\r\n            }\r\n            else {\r\n                hitTarget = startContainer;\r\n            }\r\n        }\r\n        return {\r\n            position: null,\r\n            hitTarget: hitTarget\r\n        };\r\n    };\r\n    /**\r\n     * Most probably Gecko\r\n     */\r\n    MouseTargetFactory._doHitTestWithCaretPositionFromPoint = function (ctx, coords) {\r\n        var hitResult = document.caretPositionFromPoint(coords.clientX, coords.clientY);\r\n        if (hitResult.offsetNode.nodeType === hitResult.offsetNode.TEXT_NODE) {\r\n            // offsetNode is expected to be the token text\r\n            var parent1 = hitResult.offsetNode.parentNode; // expected to be the token span\r\n            var parent2 = parent1 ? parent1.parentNode : null; // expected to be the view line container span\r\n            var parent3 = parent2 ? parent2.parentNode : null; // expected to be the view line div\r\n            var parent3ClassName = parent3 && parent3.nodeType === parent3.ELEMENT_NODE ? parent3.className : null;\r\n            if (parent3ClassName === ViewLine.CLASS_NAME) {\r\n                var p = ctx.getPositionFromDOMInfo(hitResult.offsetNode.parentNode, hitResult.offset);\r\n                return {\r\n                    position: p,\r\n                    hitTarget: null\r\n                };\r\n            }\r\n            else {\r\n                return {\r\n                    position: null,\r\n                    hitTarget: hitResult.offsetNode.parentNode\r\n                };\r\n            }\r\n        }\r\n        return {\r\n            position: null,\r\n            hitTarget: hitResult.offsetNode\r\n        };\r\n    };\r\n    /**\r\n     * Most probably IE\r\n     */\r\n    MouseTargetFactory._doHitTestWithMoveToPoint = function (ctx, coords) {\r\n        var resultPosition = null;\r\n        var resultHitTarget = null;\r\n        var textRange = document.body.createTextRange();\r\n        try {\r\n            textRange.moveToPoint(coords.clientX, coords.clientY);\r\n        }\r\n        catch (err) {\r\n            return {\r\n                position: null,\r\n                hitTarget: null\r\n            };\r\n        }\r\n        textRange.collapse(true);\r\n        // Now, let's do our best to figure out what we hit :)\r\n        var parentElement = textRange ? textRange.parentElement() : null;\r\n        var parent1 = parentElement ? parentElement.parentNode : null;\r\n        var parent2 = parent1 ? parent1.parentNode : null;\r\n        var parent2ClassName = parent2 && parent2.nodeType === parent2.ELEMENT_NODE ? parent2.className : '';\r\n        if (parent2ClassName === ViewLine.CLASS_NAME) {\r\n            var rangeToContainEntireSpan = textRange.duplicate();\r\n            rangeToContainEntireSpan.moveToElementText(parentElement);\r\n            rangeToContainEntireSpan.setEndPoint('EndToStart', textRange);\r\n            resultPosition = ctx.getPositionFromDOMInfo(parentElement, rangeToContainEntireSpan.text.length);\r\n            // Move range out of the span node, IE doesn't like having many ranges in\r\n            // the same spot and will act badly for lines containing dashes ('-')\r\n            rangeToContainEntireSpan.moveToElementText(ctx.viewDomNode);\r\n        }\r\n        else {\r\n            // Looks like we've hit the hover or something foreign\r\n            resultHitTarget = parentElement;\r\n        }\r\n        // Move range out of the span node, IE doesn't like having many ranges in\r\n        // the same spot and will act badly for lines containing dashes ('-')\r\n        textRange.moveToElementText(ctx.viewDomNode);\r\n        return {\r\n            position: resultPosition,\r\n            hitTarget: resultHitTarget\r\n        };\r\n    };\r\n    MouseTargetFactory._doHitTest = function (ctx, request) {\r\n        // State of the art (18.10.2012):\r\n        // The spec says browsers should support document.caretPositionFromPoint, but nobody implemented it (http://dev.w3.org/csswg/cssom-view/)\r\n        // Gecko:\r\n        //    - they tried to implement it once, but failed: https://bugzilla.mozilla.org/show_bug.cgi?id=654352\r\n        //    - however, they do give out rangeParent/rangeOffset properties on mouse events\r\n        // Webkit:\r\n        //    - they have implemented a previous version of the spec which was using document.caretRangeFromPoint\r\n        // IE:\r\n        //    - they have a proprietary method on ranges, moveToPoint: https://msdn.microsoft.com/en-us/library/ie/ms536632(v=vs.85).aspx\r\n        // 24.08.2016: Edge has added WebKit's document.caretRangeFromPoint, but it is quite buggy\r\n        //    - when hit testing the cursor it returns the first or the last line in the viewport\r\n        //    - it inconsistently hits text nodes or span nodes, while WebKit only hits text nodes\r\n        //    - when toggling render whitespace on, and hit testing in the empty content after a line, it always hits offset 0 of the first span of the line\r\n        // Thank you browsers for making this so 'easy' :)\r\n        if (document.caretRangeFromPoint) {\r\n            return this._doHitTestWithCaretRangeFromPoint(ctx, request);\r\n        }\r\n        else if (document.caretPositionFromPoint) {\r\n            return this._doHitTestWithCaretPositionFromPoint(ctx, request.pos.toClientCoordinates());\r\n        }\r\n        else if (document.body.createTextRange) {\r\n            return this._doHitTestWithMoveToPoint(ctx, request.pos.toClientCoordinates());\r\n        }\r\n        return {\r\n            position: null,\r\n            hitTarget: null\r\n        };\r\n    };\r\n    return MouseTargetFactory;\r\n}());\r\nexport { MouseTargetFactory };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from '../../../base/browser/browser.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { StandardMouseWheelEvent } from '../../../base/browser/mouseEvent.js';\r\nimport { RunOnceScheduler, TimeoutTimer } from '../../../base/common/async.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { HitTestContext, MouseTarget, MouseTargetFactory } from './mouseTarget.js';\r\nimport { ClientCoordinates, EditorMouseEventFactory, GlobalEditorMouseMoveMonitor, createEditorPagePosition } from '../editorDom.js';\r\nimport { EditorZoom } from '../../common/config/editorZoom.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { ViewEventHandler } from '../../common/viewModel/viewEventHandler.js';\r\n/**\r\n * Merges mouse events when mouse move events are throttled\r\n */\r\nfunction createMouseMoveEventMerger(mouseTargetFactory) {\r\n    return function (lastEvent, currentEvent) {\r\n        var targetIsWidget = false;\r\n        if (mouseTargetFactory) {\r\n            targetIsWidget = mouseTargetFactory.mouseTargetIsWidget(currentEvent);\r\n        }\r\n        if (!targetIsWidget) {\r\n            currentEvent.preventDefault();\r\n        }\r\n        return currentEvent;\r\n    };\r\n}\r\nvar MouseHandler = /** @class */ (function (_super) {\r\n    __extends(MouseHandler, _super);\r\n    function MouseHandler(context, viewController, viewHelper) {\r\n        var _this = _super.call(this) || this;\r\n        _this._isFocused = false;\r\n        _this._context = context;\r\n        _this.viewController = viewController;\r\n        _this.viewHelper = viewHelper;\r\n        _this.mouseTargetFactory = new MouseTargetFactory(_this._context, viewHelper);\r\n        _this._mouseDownOperation = _this._register(new MouseDownOperation(_this._context, _this.viewController, _this.viewHelper, function (e, testEventTarget) { return _this._createMouseTarget(e, testEventTarget); }, function (e) { return _this._getMouseColumn(e); }));\r\n        _this._asyncFocus = _this._register(new RunOnceScheduler(function () { return _this.viewHelper.focusTextArea(); }, 0));\r\n        _this.lastMouseLeaveTime = -1;\r\n        var mouseEvents = new EditorMouseEventFactory(_this.viewHelper.viewDomNode);\r\n        _this._register(mouseEvents.onContextMenu(_this.viewHelper.viewDomNode, function (e) { return _this._onContextMenu(e, true); }));\r\n        _this._register(mouseEvents.onMouseMoveThrottled(_this.viewHelper.viewDomNode, function (e) { return _this._onMouseMove(e); }, createMouseMoveEventMerger(_this.mouseTargetFactory), MouseHandler.MOUSE_MOVE_MINIMUM_TIME));\r\n        _this._register(mouseEvents.onMouseUp(_this.viewHelper.viewDomNode, function (e) { return _this._onMouseUp(e); }));\r\n        _this._register(mouseEvents.onMouseLeave(_this.viewHelper.viewDomNode, function (e) { return _this._onMouseLeave(e); }));\r\n        _this._register(mouseEvents.onMouseDown(_this.viewHelper.viewDomNode, function (e) { return _this._onMouseDown(e); }));\r\n        var onMouseWheel = function (browserEvent) {\r\n            if (!_this._context.configuration.editor.viewInfo.mouseWheelZoom) {\r\n                return;\r\n            }\r\n            var e = new StandardMouseWheelEvent(browserEvent);\r\n            if (e.browserEvent.ctrlKey || e.browserEvent.metaKey) {\r\n                var zoomLevel = EditorZoom.getZoomLevel();\r\n                var delta = e.deltaY > 0 ? 1 : -1;\r\n                EditorZoom.setZoomLevel(zoomLevel + delta);\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n        };\r\n        _this._register(dom.addDisposableListener(_this.viewHelper.viewDomNode, 'mousewheel', onMouseWheel, true));\r\n        _this._register(dom.addDisposableListener(_this.viewHelper.viewDomNode, 'DOMMouseScroll', onMouseWheel, true));\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    MouseHandler.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    MouseHandler.prototype.onCursorStateChanged = function (e) {\r\n        this._mouseDownOperation.onCursorStateChanged(e);\r\n        return false;\r\n    };\r\n    MouseHandler.prototype.onFocusChanged = function (e) {\r\n        this._isFocused = e.isFocused;\r\n        return false;\r\n    };\r\n    MouseHandler.prototype.onScrollChanged = function (e) {\r\n        this._mouseDownOperation.onScrollChanged();\r\n        return false;\r\n    };\r\n    // --- end event handlers\r\n    MouseHandler.prototype.getTargetAtClientPoint = function (clientX, clientY) {\r\n        var clientPos = new ClientCoordinates(clientX, clientY);\r\n        var pos = clientPos.toPageCoordinates();\r\n        var editorPos = createEditorPagePosition(this.viewHelper.viewDomNode);\r\n        if (pos.y < editorPos.y || pos.y > editorPos.y + editorPos.height || pos.x < editorPos.x || pos.x > editorPos.x + editorPos.width) {\r\n            return null;\r\n        }\r\n        var lastViewCursorsRenderData = this.viewHelper.getLastViewCursorsRenderData();\r\n        return this.mouseTargetFactory.createMouseTarget(lastViewCursorsRenderData, editorPos, pos, null);\r\n    };\r\n    MouseHandler.prototype._createMouseTarget = function (e, testEventTarget) {\r\n        var lastViewCursorsRenderData = this.viewHelper.getLastViewCursorsRenderData();\r\n        return this.mouseTargetFactory.createMouseTarget(lastViewCursorsRenderData, e.editorPos, e.pos, testEventTarget ? e.target : null);\r\n    };\r\n    MouseHandler.prototype._getMouseColumn = function (e) {\r\n        return this.mouseTargetFactory.getMouseColumn(e.editorPos, e.pos);\r\n    };\r\n    MouseHandler.prototype._onContextMenu = function (e, testEventTarget) {\r\n        this.viewController.emitContextMenu({\r\n            event: e,\r\n            target: this._createMouseTarget(e, testEventTarget)\r\n        });\r\n    };\r\n    MouseHandler.prototype._onMouseMove = function (e) {\r\n        if (this._mouseDownOperation.isActive()) {\r\n            // In selection/drag operation\r\n            return;\r\n        }\r\n        var actualMouseMoveTime = e.timestamp;\r\n        if (actualMouseMoveTime < this.lastMouseLeaveTime) {\r\n            // Due to throttling, this event occurred before the mouse left the editor, therefore ignore it.\r\n            return;\r\n        }\r\n        this.viewController.emitMouseMove({\r\n            event: e,\r\n            target: this._createMouseTarget(e, true)\r\n        });\r\n    };\r\n    MouseHandler.prototype._onMouseLeave = function (e) {\r\n        this.lastMouseLeaveTime = (new Date()).getTime();\r\n        this.viewController.emitMouseLeave({\r\n            event: e,\r\n            target: null\r\n        });\r\n    };\r\n    MouseHandler.prototype._onMouseUp = function (e) {\r\n        this.viewController.emitMouseUp({\r\n            event: e,\r\n            target: this._createMouseTarget(e, true)\r\n        });\r\n    };\r\n    MouseHandler.prototype._onMouseDown = function (e) {\r\n        var _this = this;\r\n        var t = this._createMouseTarget(e, true);\r\n        var targetIsContent = (t.type === 6 /* CONTENT_TEXT */ || t.type === 7 /* CONTENT_EMPTY */);\r\n        var targetIsGutter = (t.type === 2 /* GUTTER_GLYPH_MARGIN */ || t.type === 3 /* GUTTER_LINE_NUMBERS */ || t.type === 4 /* GUTTER_LINE_DECORATIONS */);\r\n        var targetIsLineNumbers = (t.type === 3 /* GUTTER_LINE_NUMBERS */);\r\n        var selectOnLineNumbers = this._context.configuration.editor.viewInfo.selectOnLineNumbers;\r\n        var targetIsViewZone = (t.type === 8 /* CONTENT_VIEW_ZONE */ || t.type === 5 /* GUTTER_VIEW_ZONE */);\r\n        var targetIsWidget = (t.type === 9 /* CONTENT_WIDGET */);\r\n        var shouldHandle = e.leftButton || e.middleButton;\r\n        if (platform.isMacintosh && e.leftButton && e.ctrlKey) {\r\n            shouldHandle = false;\r\n        }\r\n        var focus = function () {\r\n            // In IE11, if the focus is in the browser's address bar and\r\n            // then you click in the editor, calling preventDefault()\r\n            // will not move focus properly (focus remains the address bar)\r\n            if (browser.isIE && !_this._isFocused) {\r\n                _this._asyncFocus.schedule();\r\n            }\r\n            else {\r\n                e.preventDefault();\r\n                _this.viewHelper.focusTextArea();\r\n            }\r\n        };\r\n        if (shouldHandle && (targetIsContent || (targetIsLineNumbers && selectOnLineNumbers))) {\r\n            focus();\r\n            this._mouseDownOperation.start(t.type, e);\r\n        }\r\n        else if (targetIsGutter) {\r\n            // Do not steal focus\r\n            e.preventDefault();\r\n        }\r\n        else if (targetIsViewZone) {\r\n            var viewZoneData = t.detail;\r\n            if (this.viewHelper.shouldSuppressMouseDownOnViewZone(viewZoneData.viewZoneId)) {\r\n                focus();\r\n                this._mouseDownOperation.start(t.type, e);\r\n                e.preventDefault();\r\n            }\r\n        }\r\n        else if (targetIsWidget && this.viewHelper.shouldSuppressMouseDownOnWidget(t.detail)) {\r\n            focus();\r\n            e.preventDefault();\r\n        }\r\n        this.viewController.emitMouseDown({\r\n            event: e,\r\n            target: t\r\n        });\r\n    };\r\n    MouseHandler.MOUSE_MOVE_MINIMUM_TIME = 100; // ms\r\n    return MouseHandler;\r\n}(ViewEventHandler));\r\nexport { MouseHandler };\r\nvar MouseDownOperation = /** @class */ (function (_super) {\r\n    __extends(MouseDownOperation, _super);\r\n    function MouseDownOperation(context, viewController, viewHelper, createMouseTarget, getMouseColumn) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._viewController = viewController;\r\n        _this._viewHelper = viewHelper;\r\n        _this._createMouseTarget = createMouseTarget;\r\n        _this._getMouseColumn = getMouseColumn;\r\n        _this._mouseMoveMonitor = _this._register(new GlobalEditorMouseMoveMonitor(_this._viewHelper.viewDomNode));\r\n        _this._onScrollTimeout = _this._register(new TimeoutTimer());\r\n        _this._mouseState = new MouseDownState();\r\n        _this._currentSelection = new Selection(1, 1, 1, 1);\r\n        _this._isActive = false;\r\n        _this._lastMouseEvent = null;\r\n        return _this;\r\n    }\r\n    MouseDownOperation.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    MouseDownOperation.prototype.isActive = function () {\r\n        return this._isActive;\r\n    };\r\n    MouseDownOperation.prototype._onMouseDownThenMove = function (e) {\r\n        this._lastMouseEvent = e;\r\n        this._mouseState.setModifiers(e);\r\n        var position = this._findMousePosition(e, true);\r\n        if (!position) {\r\n            // Ignoring because position is unknown\r\n            return;\r\n        }\r\n        if (this._mouseState.isDragAndDrop) {\r\n            this._viewController.emitMouseDrag({\r\n                event: e,\r\n                target: position\r\n            });\r\n        }\r\n        else {\r\n            this._dispatchMouse(position, true);\r\n        }\r\n    };\r\n    MouseDownOperation.prototype.start = function (targetType, e) {\r\n        var _this = this;\r\n        this._lastMouseEvent = e;\r\n        this._mouseState.setStartedOnLineNumbers(targetType === 3 /* GUTTER_LINE_NUMBERS */);\r\n        this._mouseState.setStartButtons(e);\r\n        this._mouseState.setModifiers(e);\r\n        var position = this._findMousePosition(e, true);\r\n        if (!position || !position.position) {\r\n            // Ignoring because position is unknown\r\n            return;\r\n        }\r\n        this._mouseState.trySetCount(e.detail, position.position);\r\n        // Overwrite the detail of the MouseEvent, as it will be sent out in an event and contributions might rely on it.\r\n        e.detail = this._mouseState.count;\r\n        if (!this._context.configuration.editor.readOnly\r\n            && this._context.configuration.editor.dragAndDrop\r\n            && !this._mouseState.altKey // we don't support multiple mouse\r\n            && e.detail < 2 // only single click on a selection can work\r\n            && !this._isActive // the mouse is not down yet\r\n            && !this._currentSelection.isEmpty() // we don't drag single cursor\r\n            && (position.type === 6 /* CONTENT_TEXT */) // single click on text\r\n            && position.position && this._currentSelection.containsPosition(position.position) // single click on a selection\r\n        ) {\r\n            this._mouseState.isDragAndDrop = true;\r\n            this._isActive = true;\r\n            this._mouseMoveMonitor.startMonitoring(createMouseMoveEventMerger(null), function (e) { return _this._onMouseDownThenMove(e); }, function () {\r\n                var position = _this._findMousePosition(_this._lastMouseEvent, true);\r\n                _this._viewController.emitMouseDrop({\r\n                    event: _this._lastMouseEvent,\r\n                    target: (position ? _this._createMouseTarget(_this._lastMouseEvent, true) : null) // Ignoring because position is unknown, e.g., Content View Zone\r\n                });\r\n                _this._stop();\r\n            });\r\n            return;\r\n        }\r\n        this._mouseState.isDragAndDrop = false;\r\n        this._dispatchMouse(position, e.shiftKey);\r\n        if (!this._isActive) {\r\n            this._isActive = true;\r\n            this._mouseMoveMonitor.startMonitoring(createMouseMoveEventMerger(null), function (e) { return _this._onMouseDownThenMove(e); }, function () { return _this._stop(); });\r\n        }\r\n    };\r\n    MouseDownOperation.prototype._stop = function () {\r\n        this._isActive = false;\r\n        this._onScrollTimeout.cancel();\r\n    };\r\n    MouseDownOperation.prototype.onScrollChanged = function () {\r\n        var _this = this;\r\n        if (!this._isActive) {\r\n            return;\r\n        }\r\n        this._onScrollTimeout.setIfNotSet(function () {\r\n            if (!_this._lastMouseEvent) {\r\n                return;\r\n            }\r\n            var position = _this._findMousePosition(_this._lastMouseEvent, false);\r\n            if (!position) {\r\n                // Ignoring because position is unknown\r\n                return;\r\n            }\r\n            if (_this._mouseState.isDragAndDrop) {\r\n                // Ignoring because users are dragging the text\r\n                return;\r\n            }\r\n            _this._dispatchMouse(position, true);\r\n        }, 10);\r\n    };\r\n    MouseDownOperation.prototype.onCursorStateChanged = function (e) {\r\n        this._currentSelection = e.selections[0];\r\n    };\r\n    MouseDownOperation.prototype._getPositionOutsideEditor = function (e) {\r\n        var editorContent = e.editorPos;\r\n        var model = this._context.model;\r\n        var viewLayout = this._context.viewLayout;\r\n        var mouseColumn = this._getMouseColumn(e);\r\n        if (e.posy < editorContent.y) {\r\n            var verticalOffset = Math.max(viewLayout.getCurrentScrollTop() - (editorContent.y - e.posy), 0);\r\n            var viewZoneData = HitTestContext.getZoneAtCoord(this._context, verticalOffset);\r\n            if (viewZoneData) {\r\n                var newPosition = this._helpPositionJumpOverViewZone(viewZoneData);\r\n                if (newPosition) {\r\n                    return new MouseTarget(null, 13 /* OUTSIDE_EDITOR */, mouseColumn, newPosition);\r\n                }\r\n            }\r\n            var aboveLineNumber = viewLayout.getLineNumberAtVerticalOffset(verticalOffset);\r\n            return new MouseTarget(null, 13 /* OUTSIDE_EDITOR */, mouseColumn, new Position(aboveLineNumber, 1));\r\n        }\r\n        if (e.posy > editorContent.y + editorContent.height) {\r\n            var verticalOffset = viewLayout.getCurrentScrollTop() + (e.posy - editorContent.y);\r\n            var viewZoneData = HitTestContext.getZoneAtCoord(this._context, verticalOffset);\r\n            if (viewZoneData) {\r\n                var newPosition = this._helpPositionJumpOverViewZone(viewZoneData);\r\n                if (newPosition) {\r\n                    return new MouseTarget(null, 13 /* OUTSIDE_EDITOR */, mouseColumn, newPosition);\r\n                }\r\n            }\r\n            var belowLineNumber = viewLayout.getLineNumberAtVerticalOffset(verticalOffset);\r\n            return new MouseTarget(null, 13 /* OUTSIDE_EDITOR */, mouseColumn, new Position(belowLineNumber, model.getLineMaxColumn(belowLineNumber)));\r\n        }\r\n        var possibleLineNumber = viewLayout.getLineNumberAtVerticalOffset(viewLayout.getCurrentScrollTop() + (e.posy - editorContent.y));\r\n        if (e.posx < editorContent.x) {\r\n            return new MouseTarget(null, 13 /* OUTSIDE_EDITOR */, mouseColumn, new Position(possibleLineNumber, 1));\r\n        }\r\n        if (e.posx > editorContent.x + editorContent.width) {\r\n            return new MouseTarget(null, 13 /* OUTSIDE_EDITOR */, mouseColumn, new Position(possibleLineNumber, model.getLineMaxColumn(possibleLineNumber)));\r\n        }\r\n        return null;\r\n    };\r\n    MouseDownOperation.prototype._findMousePosition = function (e, testEventTarget) {\r\n        var positionOutsideEditor = this._getPositionOutsideEditor(e);\r\n        if (positionOutsideEditor) {\r\n            return positionOutsideEditor;\r\n        }\r\n        var t = this._createMouseTarget(e, testEventTarget);\r\n        var hintedPosition = t.position;\r\n        if (!hintedPosition) {\r\n            return null;\r\n        }\r\n        if (t.type === 8 /* CONTENT_VIEW_ZONE */ || t.type === 5 /* GUTTER_VIEW_ZONE */) {\r\n            var newPosition = this._helpPositionJumpOverViewZone(t.detail);\r\n            if (newPosition) {\r\n                return new MouseTarget(t.element, t.type, t.mouseColumn, newPosition, null, t.detail);\r\n            }\r\n        }\r\n        return t;\r\n    };\r\n    MouseDownOperation.prototype._helpPositionJumpOverViewZone = function (viewZoneData) {\r\n        // Force position on view zones to go above or below depending on where selection started from\r\n        var selectionStart = new Position(this._currentSelection.selectionStartLineNumber, this._currentSelection.selectionStartColumn);\r\n        var positionBefore = viewZoneData.positionBefore;\r\n        var positionAfter = viewZoneData.positionAfter;\r\n        if (positionBefore && positionAfter) {\r\n            if (positionBefore.isBefore(selectionStart)) {\r\n                return positionBefore;\r\n            }\r\n            else {\r\n                return positionAfter;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    MouseDownOperation.prototype._dispatchMouse = function (position, inSelectionMode) {\r\n        if (!position.position) {\r\n            return;\r\n        }\r\n        this._viewController.dispatchMouse({\r\n            position: position.position,\r\n            mouseColumn: position.mouseColumn,\r\n            startedOnLineNumbers: this._mouseState.startedOnLineNumbers,\r\n            inSelectionMode: inSelectionMode,\r\n            mouseDownCount: this._mouseState.count,\r\n            altKey: this._mouseState.altKey,\r\n            ctrlKey: this._mouseState.ctrlKey,\r\n            metaKey: this._mouseState.metaKey,\r\n            shiftKey: this._mouseState.shiftKey,\r\n            leftButton: this._mouseState.leftButton,\r\n            middleButton: this._mouseState.middleButton,\r\n        });\r\n    };\r\n    return MouseDownOperation;\r\n}(Disposable));\r\nvar MouseDownState = /** @class */ (function () {\r\n    function MouseDownState() {\r\n        this._altKey = false;\r\n        this._ctrlKey = false;\r\n        this._metaKey = false;\r\n        this._shiftKey = false;\r\n        this._leftButton = false;\r\n        this._middleButton = false;\r\n        this._startedOnLineNumbers = false;\r\n        this._lastMouseDownPosition = null;\r\n        this._lastMouseDownPositionEqualCount = 0;\r\n        this._lastMouseDownCount = 0;\r\n        this._lastSetMouseDownCountTime = 0;\r\n        this.isDragAndDrop = false;\r\n    }\r\n    Object.defineProperty(MouseDownState.prototype, \"altKey\", {\r\n        get: function () { return this._altKey; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseDownState.prototype, \"ctrlKey\", {\r\n        get: function () { return this._ctrlKey; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseDownState.prototype, \"metaKey\", {\r\n        get: function () { return this._metaKey; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseDownState.prototype, \"shiftKey\", {\r\n        get: function () { return this._shiftKey; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseDownState.prototype, \"leftButton\", {\r\n        get: function () { return this._leftButton; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseDownState.prototype, \"middleButton\", {\r\n        get: function () { return this._middleButton; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseDownState.prototype, \"startedOnLineNumbers\", {\r\n        get: function () { return this._startedOnLineNumbers; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseDownState.prototype, \"count\", {\r\n        get: function () {\r\n            return this._lastMouseDownCount;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MouseDownState.prototype.setModifiers = function (source) {\r\n        this._altKey = source.altKey;\r\n        this._ctrlKey = source.ctrlKey;\r\n        this._metaKey = source.metaKey;\r\n        this._shiftKey = source.shiftKey;\r\n    };\r\n    MouseDownState.prototype.setStartButtons = function (source) {\r\n        this._leftButton = source.leftButton;\r\n        this._middleButton = source.middleButton;\r\n    };\r\n    MouseDownState.prototype.setStartedOnLineNumbers = function (startedOnLineNumbers) {\r\n        this._startedOnLineNumbers = startedOnLineNumbers;\r\n    };\r\n    MouseDownState.prototype.trySetCount = function (setMouseDownCount, newMouseDownPosition) {\r\n        // a. Invalidate multiple clicking if too much time has passed (will be hit by IE because the detail field of mouse events contains garbage in IE10)\r\n        var currentTime = (new Date()).getTime();\r\n        if (currentTime - this._lastSetMouseDownCountTime > MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME) {\r\n            setMouseDownCount = 1;\r\n        }\r\n        this._lastSetMouseDownCountTime = currentTime;\r\n        // b. Ensure that we don't jump from single click to triple click in one go (will be hit by IE because the detail field of mouse events contains garbage in IE10)\r\n        if (setMouseDownCount > this._lastMouseDownCount + 1) {\r\n            setMouseDownCount = this._lastMouseDownCount + 1;\r\n        }\r\n        // c. Invalidate multiple clicking if the logical position is different\r\n        if (this._lastMouseDownPosition && this._lastMouseDownPosition.equals(newMouseDownPosition)) {\r\n            this._lastMouseDownPositionEqualCount++;\r\n        }\r\n        else {\r\n            this._lastMouseDownPositionEqualCount = 1;\r\n        }\r\n        this._lastMouseDownPosition = newMouseDownPosition;\r\n        // Finally set the lastMouseDownCount\r\n        this._lastMouseDownCount = Math.min(setMouseDownCount, this._lastMouseDownPositionEqualCount);\r\n    };\r\n    MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME = 400; // ms\r\n    return MouseDownState;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { EventType, Gesture } from '../../../base/browser/touch.js';\r\nimport { MouseHandler } from './mouseHandler.js';\r\nimport { EditorMouseEvent } from '../editorDom.js';\r\nfunction gestureChangeEventMerger(lastEvent, currentEvent) {\r\n    var r = {\r\n        translationY: currentEvent.translationY,\r\n        translationX: currentEvent.translationX\r\n    };\r\n    if (lastEvent) {\r\n        r.translationY += lastEvent.translationY;\r\n        r.translationX += lastEvent.translationX;\r\n    }\r\n    return r;\r\n}\r\n/**\r\n * Basically IE10 and IE11\r\n */\r\nvar MsPointerHandler = /** @class */ (function (_super) {\r\n    __extends(MsPointerHandler, _super);\r\n    function MsPointerHandler(context, viewController, viewHelper) {\r\n        var _this = _super.call(this, context, viewController, viewHelper) || this;\r\n        _this.viewHelper.linesContentDomNode.style.msTouchAction = 'none';\r\n        _this.viewHelper.linesContentDomNode.style.msContentZooming = 'none';\r\n        // TODO@Alex -> this expects that the view is added in 100 ms, might not be the case\r\n        // This handler should be added when the dom node is in the dom tree\r\n        _this._installGestureHandlerTimeout = window.setTimeout(function () {\r\n            _this._installGestureHandlerTimeout = -1;\r\n            if (window.MSGesture) {\r\n                var touchGesture_1 = new MSGesture();\r\n                var penGesture_1 = new MSGesture();\r\n                touchGesture_1.target = _this.viewHelper.linesContentDomNode;\r\n                penGesture_1.target = _this.viewHelper.linesContentDomNode;\r\n                _this.viewHelper.linesContentDomNode.addEventListener('MSPointerDown', function (e) {\r\n                    // Circumvent IE11 breaking change in e.pointerType & TypeScript's stale definitions\r\n                    var pointerType = e.pointerType;\r\n                    if (pointerType === (e.MSPOINTER_TYPE_MOUSE || 'mouse')) {\r\n                        _this._lastPointerType = 'mouse';\r\n                        return;\r\n                    }\r\n                    else if (pointerType === (e.MSPOINTER_TYPE_TOUCH || 'touch')) {\r\n                        _this._lastPointerType = 'touch';\r\n                        touchGesture_1.addPointer(e.pointerId);\r\n                    }\r\n                    else {\r\n                        _this._lastPointerType = 'pen';\r\n                        penGesture_1.addPointer(e.pointerId);\r\n                    }\r\n                });\r\n                _this._register(dom.addDisposableThrottledListener(_this.viewHelper.linesContentDomNode, 'MSGestureChange', function (e) { return _this._onGestureChange(e); }, gestureChangeEventMerger));\r\n                _this._register(dom.addDisposableListener(_this.viewHelper.linesContentDomNode, 'MSGestureTap', function (e) { return _this._onCaptureGestureTap(e); }, true));\r\n            }\r\n        }, 100);\r\n        _this._lastPointerType = 'mouse';\r\n        return _this;\r\n    }\r\n    MsPointerHandler.prototype._onMouseDown = function (e) {\r\n        if (this._lastPointerType === 'mouse') {\r\n            _super.prototype._onMouseDown.call(this, e);\r\n        }\r\n    };\r\n    MsPointerHandler.prototype._onCaptureGestureTap = function (rawEvent) {\r\n        var _this = this;\r\n        var e = new EditorMouseEvent(rawEvent, this.viewHelper.viewDomNode);\r\n        var t = this._createMouseTarget(e, false);\r\n        if (t.position) {\r\n            this.viewController.moveTo(t.position);\r\n        }\r\n        // IE does not want to focus when coming in from the browser's address bar\r\n        if (e.browserEvent.fromElement) {\r\n            e.preventDefault();\r\n            this.viewHelper.focusTextArea();\r\n        }\r\n        else {\r\n            // TODO@Alex -> cancel this is focus is lost\r\n            setTimeout(function () {\r\n                _this.viewHelper.focusTextArea();\r\n            });\r\n        }\r\n    };\r\n    MsPointerHandler.prototype._onGestureChange = function (e) {\r\n        this._context.viewLayout.deltaScrollNow(-e.translationX, -e.translationY);\r\n    };\r\n    MsPointerHandler.prototype.dispose = function () {\r\n        window.clearTimeout(this._installGestureHandlerTimeout);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    return MsPointerHandler;\r\n}(MouseHandler));\r\n/**\r\n * Basically Edge but should be modified to handle any pointerEnabled, even without support of MSGesture\r\n */\r\nvar StandardPointerHandler = /** @class */ (function (_super) {\r\n    __extends(StandardPointerHandler, _super);\r\n    function StandardPointerHandler(context, viewController, viewHelper) {\r\n        var _this = _super.call(this, context, viewController, viewHelper) || this;\r\n        _this.viewHelper.linesContentDomNode.style.touchAction = 'none';\r\n        // TODO@Alex -> this expects that the view is added in 100 ms, might not be the case\r\n        // This handler should be added when the dom node is in the dom tree\r\n        _this._installGestureHandlerTimeout = window.setTimeout(function () {\r\n            _this._installGestureHandlerTimeout = -1;\r\n            // TODO@Alex: replace the usage of MSGesture here with something that works across all browsers\r\n            if (window.MSGesture) {\r\n                var touchGesture_2 = new MSGesture();\r\n                var penGesture_2 = new MSGesture();\r\n                touchGesture_2.target = _this.viewHelper.linesContentDomNode;\r\n                penGesture_2.target = _this.viewHelper.linesContentDomNode;\r\n                _this.viewHelper.linesContentDomNode.addEventListener('pointerdown', function (e) {\r\n                    var pointerType = e.pointerType;\r\n                    if (pointerType === 'mouse') {\r\n                        _this._lastPointerType = 'mouse';\r\n                        return;\r\n                    }\r\n                    else if (pointerType === 'touch') {\r\n                        _this._lastPointerType = 'touch';\r\n                        touchGesture_2.addPointer(e.pointerId);\r\n                    }\r\n                    else {\r\n                        _this._lastPointerType = 'pen';\r\n                        penGesture_2.addPointer(e.pointerId);\r\n                    }\r\n                });\r\n                _this._register(dom.addDisposableThrottledListener(_this.viewHelper.linesContentDomNode, 'MSGestureChange', function (e) { return _this._onGestureChange(e); }, gestureChangeEventMerger));\r\n                _this._register(dom.addDisposableListener(_this.viewHelper.linesContentDomNode, 'MSGestureTap', function (e) { return _this._onCaptureGestureTap(e); }, true));\r\n            }\r\n        }, 100);\r\n        _this._lastPointerType = 'mouse';\r\n        return _this;\r\n    }\r\n    StandardPointerHandler.prototype._onMouseDown = function (e) {\r\n        if (this._lastPointerType === 'mouse') {\r\n            _super.prototype._onMouseDown.call(this, e);\r\n        }\r\n    };\r\n    StandardPointerHandler.prototype._onCaptureGestureTap = function (rawEvent) {\r\n        var _this = this;\r\n        var e = new EditorMouseEvent(rawEvent, this.viewHelper.viewDomNode);\r\n        var t = this._createMouseTarget(e, false);\r\n        if (t.position) {\r\n            this.viewController.moveTo(t.position);\r\n        }\r\n        // IE does not want to focus when coming in from the browser's address bar\r\n        if (e.browserEvent.fromElement) {\r\n            e.preventDefault();\r\n            this.viewHelper.focusTextArea();\r\n        }\r\n        else {\r\n            // TODO@Alex -> cancel this is focus is lost\r\n            setTimeout(function () {\r\n                _this.viewHelper.focusTextArea();\r\n            });\r\n        }\r\n    };\r\n    StandardPointerHandler.prototype._onGestureChange = function (e) {\r\n        this._context.viewLayout.deltaScrollNow(-e.translationX, -e.translationY);\r\n    };\r\n    StandardPointerHandler.prototype.dispose = function () {\r\n        window.clearTimeout(this._installGestureHandlerTimeout);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    return StandardPointerHandler;\r\n}(MouseHandler));\r\nvar TouchHandler = /** @class */ (function (_super) {\r\n    __extends(TouchHandler, _super);\r\n    function TouchHandler(context, viewController, viewHelper) {\r\n        var _this = _super.call(this, context, viewController, viewHelper) || this;\r\n        Gesture.addTarget(_this.viewHelper.linesContentDomNode);\r\n        _this._register(dom.addDisposableListener(_this.viewHelper.linesContentDomNode, EventType.Tap, function (e) { return _this.onTap(e); }));\r\n        _this._register(dom.addDisposableListener(_this.viewHelper.linesContentDomNode, EventType.Change, function (e) { return _this.onChange(e); }));\r\n        _this._register(dom.addDisposableListener(_this.viewHelper.linesContentDomNode, EventType.Contextmenu, function (e) { return _this._onContextMenu(new EditorMouseEvent(e, _this.viewHelper.viewDomNode), false); }));\r\n        return _this;\r\n    }\r\n    TouchHandler.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    TouchHandler.prototype.onTap = function (event) {\r\n        event.preventDefault();\r\n        this.viewHelper.focusTextArea();\r\n        var target = this._createMouseTarget(new EditorMouseEvent(event, this.viewHelper.viewDomNode), false);\r\n        if (target.position) {\r\n            this.viewController.moveTo(target.position);\r\n        }\r\n    };\r\n    TouchHandler.prototype.onChange = function (e) {\r\n        this._context.viewLayout.deltaScrollNow(-e.translationX, -e.translationY);\r\n    };\r\n    return TouchHandler;\r\n}(MouseHandler));\r\nvar PointerHandler = /** @class */ (function () {\r\n    function PointerHandler(context, viewController, viewHelper) {\r\n        if (window.navigator.msPointerEnabled) {\r\n            this.handler = new MsPointerHandler(context, viewController, viewHelper);\r\n        }\r\n        else if (window.TouchEvent) {\r\n            this.handler = new TouchHandler(context, viewController, viewHelper);\r\n        }\r\n        else if (window.navigator.pointerEnabled || window.PointerEvent) {\r\n            this.handler = new StandardPointerHandler(context, viewController, viewHelper);\r\n        }\r\n        else {\r\n            this.handler = new MouseHandler(context, viewController, viewHelper);\r\n        }\r\n    }\r\n    PointerHandler.prototype.getTargetAtClientPoint = function (clientX, clientY) {\r\n        return this.handler.getTargetAtClientPoint(clientX, clientY);\r\n    };\r\n    PointerHandler.prototype.dispose = function () {\r\n        this.handler.dispose();\r\n    };\r\n    return PointerHandler;\r\n}());\r\nexport { PointerHandler };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar TextAreaState = /** @class */ (function () {\r\n    function TextAreaState(value, selectionStart, selectionEnd, selectionStartPosition, selectionEndPosition) {\r\n        this.value = value;\r\n        this.selectionStart = selectionStart;\r\n        this.selectionEnd = selectionEnd;\r\n        this.selectionStartPosition = selectionStartPosition;\r\n        this.selectionEndPosition = selectionEndPosition;\r\n    }\r\n    TextAreaState.prototype.toString = function () {\r\n        return '[ <' + this.value + '>, selectionStart: ' + this.selectionStart + ', selectionEnd: ' + this.selectionEnd + ']';\r\n    };\r\n    TextAreaState.readFromTextArea = function (textArea) {\r\n        return new TextAreaState(textArea.getValue(), textArea.getSelectionStart(), textArea.getSelectionEnd(), null, null);\r\n    };\r\n    TextAreaState.prototype.collapseSelection = function () {\r\n        return new TextAreaState(this.value, this.value.length, this.value.length, null, null);\r\n    };\r\n    TextAreaState.prototype.writeToTextArea = function (reason, textArea, select) {\r\n        // console.log(Date.now() + ': writeToTextArea ' + reason + ': ' + this.toString());\r\n        textArea.setValue(reason, this.value);\r\n        if (select) {\r\n            textArea.setSelectionRange(reason, this.selectionStart, this.selectionEnd);\r\n        }\r\n    };\r\n    TextAreaState.prototype.deduceEditorPosition = function (offset) {\r\n        if (offset <= this.selectionStart) {\r\n            var str = this.value.substring(offset, this.selectionStart);\r\n            return this._finishDeduceEditorPosition(this.selectionStartPosition, str, -1);\r\n        }\r\n        if (offset >= this.selectionEnd) {\r\n            var str = this.value.substring(this.selectionEnd, offset);\r\n            return this._finishDeduceEditorPosition(this.selectionEndPosition, str, 1);\r\n        }\r\n        var str1 = this.value.substring(this.selectionStart, offset);\r\n        if (str1.indexOf(String.fromCharCode(8230)) === -1) {\r\n            return this._finishDeduceEditorPosition(this.selectionStartPosition, str1, 1);\r\n        }\r\n        var str2 = this.value.substring(offset, this.selectionEnd);\r\n        return this._finishDeduceEditorPosition(this.selectionEndPosition, str2, -1);\r\n    };\r\n    TextAreaState.prototype._finishDeduceEditorPosition = function (anchor, deltaText, signum) {\r\n        var lineFeedCnt = 0;\r\n        var lastLineFeedIndex = -1;\r\n        while ((lastLineFeedIndex = deltaText.indexOf('\\n', lastLineFeedIndex + 1)) !== -1) {\r\n            lineFeedCnt++;\r\n        }\r\n        return [anchor, signum * deltaText.length, lineFeedCnt];\r\n    };\r\n    TextAreaState.selectedText = function (text) {\r\n        return new TextAreaState(text, 0, text.length, null, null);\r\n    };\r\n    TextAreaState.deduceInput = function (previousState, currentState, couldBeEmojiInput, couldBeTypingAtOffset0) {\r\n        if (!previousState) {\r\n            // This is the EMPTY state\r\n            return {\r\n                text: '',\r\n                replaceCharCnt: 0\r\n            };\r\n        }\r\n        // console.log('------------------------deduceInput');\r\n        // console.log('PREVIOUS STATE: ' + previousState.toString());\r\n        // console.log('CURRENT STATE: ' + currentState.toString());\r\n        var previousValue = previousState.value;\r\n        var previousSelectionStart = previousState.selectionStart;\r\n        var previousSelectionEnd = previousState.selectionEnd;\r\n        var currentValue = currentState.value;\r\n        var currentSelectionStart = currentState.selectionStart;\r\n        var currentSelectionEnd = currentState.selectionEnd;\r\n        if (couldBeTypingAtOffset0 && previousValue.length > 0 && previousSelectionStart === previousSelectionEnd && currentSelectionStart === currentSelectionEnd) {\r\n            // See https://github.com/Microsoft/vscode/issues/42251\r\n            // where typing always happens at offset 0 in the textarea\r\n            // when using a custom title area in OSX and moving the window\r\n            if (!strings.startsWith(currentValue, previousValue) && strings.endsWith(currentValue, previousValue)) {\r\n                // Looks like something was typed at offset 0\r\n                // ==> pretend we placed the cursor at offset 0 to begin with...\r\n                previousSelectionStart = 0;\r\n                previousSelectionEnd = 0;\r\n            }\r\n        }\r\n        // Strip the previous suffix from the value (without interfering with the current selection)\r\n        var previousSuffix = previousValue.substring(previousSelectionEnd);\r\n        var currentSuffix = currentValue.substring(currentSelectionEnd);\r\n        var suffixLength = strings.commonSuffixLength(previousSuffix, currentSuffix);\r\n        currentValue = currentValue.substring(0, currentValue.length - suffixLength);\r\n        previousValue = previousValue.substring(0, previousValue.length - suffixLength);\r\n        var previousPrefix = previousValue.substring(0, previousSelectionStart);\r\n        var currentPrefix = currentValue.substring(0, currentSelectionStart);\r\n        var prefixLength = strings.commonPrefixLength(previousPrefix, currentPrefix);\r\n        currentValue = currentValue.substring(prefixLength);\r\n        previousValue = previousValue.substring(prefixLength);\r\n        currentSelectionStart -= prefixLength;\r\n        previousSelectionStart -= prefixLength;\r\n        currentSelectionEnd -= prefixLength;\r\n        previousSelectionEnd -= prefixLength;\r\n        // console.log('AFTER DIFFING PREVIOUS STATE: <' + previousValue + '>, selectionStart: ' + previousSelectionStart + ', selectionEnd: ' + previousSelectionEnd);\r\n        // console.log('AFTER DIFFING CURRENT STATE: <' + currentValue + '>, selectionStart: ' + currentSelectionStart + ', selectionEnd: ' + currentSelectionEnd);\r\n        if (couldBeEmojiInput && currentSelectionStart === currentSelectionEnd && previousValue.length > 0) {\r\n            // on OSX, emojis from the emoji picker are inserted at random locations\r\n            // the only hints we can use is that the selection is immediately after the inserted emoji\r\n            // and that none of the old text has been deleted\r\n            var potentialEmojiInput = null;\r\n            if (currentSelectionStart === currentValue.length) {\r\n                // emoji potentially inserted \"somewhere\" after the previous selection => it should appear at the end of `currentValue`\r\n                if (strings.startsWith(currentValue, previousValue)) {\r\n                    // only if all of the old text is accounted for\r\n                    potentialEmojiInput = currentValue.substring(previousValue.length);\r\n                }\r\n            }\r\n            else {\r\n                // emoji potentially inserted \"somewhere\" before the previous selection => it should appear at the start of `currentValue`\r\n                if (strings.endsWith(currentValue, previousValue)) {\r\n                    // only if all of the old text is accounted for\r\n                    potentialEmojiInput = currentValue.substring(0, currentValue.length - previousValue.length);\r\n                }\r\n            }\r\n            if (potentialEmojiInput !== null && potentialEmojiInput.length > 0) {\r\n                // now we check that this is indeed an emoji\r\n                // emojis can grow quite long, so a length check is of no help\r\n                // e.g. 1F3F4 E0067 E0062 E0065 E006E E0067 E007F  ; fully-qualified     # 🏴󠁧󠁢󠁥󠁮󠁧󠁿 England\r\n                // Oftentimes, emojis use Variation Selector-16 (U+FE0F), so that is a good hint\r\n                // http://emojipedia.org/variation-selector-16/\r\n                // > An invisible codepoint which specifies that the preceding character\r\n                // > should be displayed with emoji presentation. Only required if the\r\n                // > preceding character defaults to text presentation.\r\n                if (/\\uFE0F/.test(potentialEmojiInput) || strings.containsEmoji(potentialEmojiInput)) {\r\n                    return {\r\n                        text: potentialEmojiInput,\r\n                        replaceCharCnt: 0\r\n                    };\r\n                }\r\n            }\r\n        }\r\n        if (currentSelectionStart === currentSelectionEnd) {\r\n            // composition accept case (noticed in FF + Japanese)\r\n            // [blahblah] => blahblah|\r\n            if (previousValue === currentValue\r\n                && previousSelectionStart === 0\r\n                && previousSelectionEnd === previousValue.length\r\n                && currentSelectionStart === currentValue.length\r\n                && currentValue.indexOf('\\n') === -1) {\r\n                if (strings.containsFullWidthCharacter(currentValue)) {\r\n                    return {\r\n                        text: '',\r\n                        replaceCharCnt: 0\r\n                    };\r\n                }\r\n            }\r\n            // no current selection\r\n            var replacePreviousCharacters_1 = (previousPrefix.length - prefixLength);\r\n            // console.log('REMOVE PREVIOUS: ' + (previousPrefix.length - prefixLength) + ' chars');\r\n            return {\r\n                text: currentValue,\r\n                replaceCharCnt: replacePreviousCharacters_1\r\n            };\r\n        }\r\n        // there is a current selection => composition case\r\n        var replacePreviousCharacters = previousSelectionEnd - previousSelectionStart;\r\n        return {\r\n            text: currentValue,\r\n            replaceCharCnt: replacePreviousCharacters\r\n        };\r\n    };\r\n    TextAreaState.EMPTY = new TextAreaState('', 0, 0, null, null);\r\n    return TextAreaState;\r\n}());\r\nexport { TextAreaState };\r\nvar PagedScreenReaderStrategy = /** @class */ (function () {\r\n    function PagedScreenReaderStrategy() {\r\n    }\r\n    PagedScreenReaderStrategy._getPageOfLine = function (lineNumber) {\r\n        return Math.floor((lineNumber - 1) / PagedScreenReaderStrategy._LINES_PER_PAGE);\r\n    };\r\n    PagedScreenReaderStrategy._getRangeForPage = function (page) {\r\n        var offset = page * PagedScreenReaderStrategy._LINES_PER_PAGE;\r\n        var startLineNumber = offset + 1;\r\n        var endLineNumber = offset + PagedScreenReaderStrategy._LINES_PER_PAGE;\r\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\r\n    };\r\n    PagedScreenReaderStrategy.fromEditorSelection = function (previousState, model, selection, trimLongText) {\r\n        var selectionStartPage = PagedScreenReaderStrategy._getPageOfLine(selection.startLineNumber);\r\n        var selectionStartPageRange = PagedScreenReaderStrategy._getRangeForPage(selectionStartPage);\r\n        var selectionEndPage = PagedScreenReaderStrategy._getPageOfLine(selection.endLineNumber);\r\n        var selectionEndPageRange = PagedScreenReaderStrategy._getRangeForPage(selectionEndPage);\r\n        var pretextRange = selectionStartPageRange.intersectRanges(new Range(1, 1, selection.startLineNumber, selection.startColumn));\r\n        var pretext = model.getValueInRange(pretextRange, 1 /* LF */);\r\n        var lastLine = model.getLineCount();\r\n        var lastLineMaxColumn = model.getLineMaxColumn(lastLine);\r\n        var posttextRange = selectionEndPageRange.intersectRanges(new Range(selection.endLineNumber, selection.endColumn, lastLine, lastLineMaxColumn));\r\n        var posttext = model.getValueInRange(posttextRange, 1 /* LF */);\r\n        var text;\r\n        if (selectionStartPage === selectionEndPage || selectionStartPage + 1 === selectionEndPage) {\r\n            // take full selection\r\n            text = model.getValueInRange(selection, 1 /* LF */);\r\n        }\r\n        else {\r\n            var selectionRange1 = selectionStartPageRange.intersectRanges(selection);\r\n            var selectionRange2 = selectionEndPageRange.intersectRanges(selection);\r\n            text = (model.getValueInRange(selectionRange1, 1 /* LF */)\r\n                + String.fromCharCode(8230)\r\n                + model.getValueInRange(selectionRange2, 1 /* LF */));\r\n        }\r\n        // Chromium handles very poorly text even of a few thousand chars\r\n        // Cut text to avoid stalling the entire UI\r\n        if (trimLongText) {\r\n            var LIMIT_CHARS = 500;\r\n            if (pretext.length > LIMIT_CHARS) {\r\n                pretext = pretext.substring(pretext.length - LIMIT_CHARS, pretext.length);\r\n            }\r\n            if (posttext.length > LIMIT_CHARS) {\r\n                posttext = posttext.substring(0, LIMIT_CHARS);\r\n            }\r\n            if (text.length > 2 * LIMIT_CHARS) {\r\n                text = text.substring(0, LIMIT_CHARS) + String.fromCharCode(8230) + text.substring(text.length - LIMIT_CHARS, text.length);\r\n            }\r\n        }\r\n        return new TextAreaState(pretext + text + posttext, pretext.length, pretext.length + text.length, new Position(selection.startLineNumber, selection.startColumn), new Position(selection.endLineNumber, selection.endColumn));\r\n    };\r\n    PagedScreenReaderStrategy._LINES_PER_PAGE = 10;\r\n    return PagedScreenReaderStrategy;\r\n}());\r\nexport { PagedScreenReaderStrategy };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from '../../../base/browser/browser.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { TextAreaState } from './textAreaState.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nexport var CopyOptions = {\r\n    forceCopyWithSyntaxHighlighting: false\r\n};\r\n/**\r\n * Writes screen reader content to the textarea and is able to analyze its input events to generate:\r\n *  - onCut\r\n *  - onPaste\r\n *  - onType\r\n *\r\n * Composition events are generated for presentation purposes (composition input is reflected in onType).\r\n */\r\nvar TextAreaInput = /** @class */ (function (_super) {\r\n    __extends(TextAreaInput, _super);\r\n    function TextAreaInput(host, textArea) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onFocus = _this._register(new Emitter());\r\n        _this.onFocus = _this._onFocus.event;\r\n        _this._onBlur = _this._register(new Emitter());\r\n        _this.onBlur = _this._onBlur.event;\r\n        _this._onKeyDown = _this._register(new Emitter());\r\n        _this.onKeyDown = _this._onKeyDown.event;\r\n        _this._onKeyUp = _this._register(new Emitter());\r\n        _this.onKeyUp = _this._onKeyUp.event;\r\n        _this._onCut = _this._register(new Emitter());\r\n        _this.onCut = _this._onCut.event;\r\n        _this._onPaste = _this._register(new Emitter());\r\n        _this.onPaste = _this._onPaste.event;\r\n        _this._onType = _this._register(new Emitter());\r\n        _this.onType = _this._onType.event;\r\n        _this._onCompositionStart = _this._register(new Emitter());\r\n        _this.onCompositionStart = _this._onCompositionStart.event;\r\n        _this._onCompositionUpdate = _this._register(new Emitter());\r\n        _this.onCompositionUpdate = _this._onCompositionUpdate.event;\r\n        _this._onCompositionEnd = _this._register(new Emitter());\r\n        _this.onCompositionEnd = _this._onCompositionEnd.event;\r\n        _this._onSelectionChangeRequest = _this._register(new Emitter());\r\n        _this.onSelectionChangeRequest = _this._onSelectionChangeRequest.event;\r\n        _this._host = host;\r\n        _this._textArea = _this._register(new TextAreaWrapper(textArea));\r\n        _this._lastTextAreaEvent = 0 /* none */;\r\n        _this._asyncTriggerCut = _this._register(new RunOnceScheduler(function () { return _this._onCut.fire(); }, 0));\r\n        _this._textAreaState = TextAreaState.EMPTY;\r\n        _this.writeScreenReaderContent('ctor');\r\n        _this._hasFocus = false;\r\n        _this._isDoingComposition = false;\r\n        _this._nextCommand = 0 /* Type */;\r\n        _this._register(dom.addStandardDisposableListener(textArea.domNode, 'keydown', function (e) {\r\n            if (_this._isDoingComposition &&\r\n                (e.keyCode === 109 /* KEY_IN_COMPOSITION */ || e.keyCode === 1 /* Backspace */)) {\r\n                // Stop propagation for keyDown events if the IME is processing key input\r\n                e.stopPropagation();\r\n            }\r\n            if (e.equals(9 /* Escape */)) {\r\n                // Prevent default always for `Esc`, otherwise it will generate a keypress\r\n                // See https://msdn.microsoft.com/en-us/library/ie/ms536939(v=vs.85).aspx\r\n                e.preventDefault();\r\n            }\r\n            _this._onKeyDown.fire(e);\r\n        }));\r\n        _this._register(dom.addStandardDisposableListener(textArea.domNode, 'keyup', function (e) {\r\n            _this._onKeyUp.fire(e);\r\n        }));\r\n        _this._register(dom.addDisposableListener(textArea.domNode, 'compositionstart', function (e) {\r\n            _this._lastTextAreaEvent = 1 /* compositionstart */;\r\n            if (_this._isDoingComposition) {\r\n                return;\r\n            }\r\n            _this._isDoingComposition = true;\r\n            // In IE we cannot set .value when handling 'compositionstart' because the entire composition will get canceled.\r\n            if (!browser.isEdgeOrIE) {\r\n                _this._setAndWriteTextAreaState('compositionstart', TextAreaState.EMPTY);\r\n            }\r\n            _this._onCompositionStart.fire();\r\n        }));\r\n        /**\r\n         * Deduce the typed input from a text area's value and the last observed state.\r\n         */\r\n        var deduceInputFromTextAreaValue = function (couldBeEmojiInput, couldBeTypingAtOffset0) {\r\n            var oldState = _this._textAreaState;\r\n            var newState = TextAreaState.readFromTextArea(_this._textArea);\r\n            return [newState, TextAreaState.deduceInput(oldState, newState, couldBeEmojiInput, couldBeTypingAtOffset0)];\r\n        };\r\n        /**\r\n         * Deduce the composition input from a string.\r\n         */\r\n        var deduceComposition = function (text) {\r\n            var oldState = _this._textAreaState;\r\n            var newState = TextAreaState.selectedText(text);\r\n            var typeInput = {\r\n                text: newState.value,\r\n                replaceCharCnt: oldState.selectionEnd - oldState.selectionStart\r\n            };\r\n            return [newState, typeInput];\r\n        };\r\n        var compositionDataInValid = function (locale) {\r\n            // https://github.com/Microsoft/monaco-editor/issues/339\r\n            // Multi-part Japanese compositions reset cursor in Edge/IE, Chinese and Korean IME don't have this issue.\r\n            // The reason that we can't use this path for all CJK IME is IE and Edge behave differently when handling Korean IME,\r\n            // which breaks this path of code.\r\n            if (browser.isEdgeOrIE && locale === 'ja') {\r\n                return true;\r\n            }\r\n            // https://github.com/Microsoft/monaco-editor/issues/545\r\n            // On IE11, we can't trust composition data when typing Chinese as IE11 doesn't emit correct\r\n            // events when users type numbers in IME.\r\n            // Chinese: zh-Hans-CN, zh-Hans-SG, zh-Hant-TW, zh-Hant-HK\r\n            if (browser.isIE && locale.indexOf('zh-Han') === 0) {\r\n                return true;\r\n            }\r\n            return false;\r\n        };\r\n        _this._register(dom.addDisposableListener(textArea.domNode, 'compositionupdate', function (e) {\r\n            _this._lastTextAreaEvent = 2 /* compositionupdate */;\r\n            if (compositionDataInValid(e.locale)) {\r\n                var _a = deduceInputFromTextAreaValue(/*couldBeEmojiInput*/ false, /*couldBeTypingAtOffset0*/ false), newState_1 = _a[0], typeInput_1 = _a[1];\r\n                _this._textAreaState = newState_1;\r\n                _this._onType.fire(typeInput_1);\r\n                _this._onCompositionUpdate.fire(e);\r\n                return;\r\n            }\r\n            var _b = deduceComposition(e.data), newState = _b[0], typeInput = _b[1];\r\n            _this._textAreaState = newState;\r\n            _this._onType.fire(typeInput);\r\n            _this._onCompositionUpdate.fire(e);\r\n        }));\r\n        _this._register(dom.addDisposableListener(textArea.domNode, 'compositionend', function (e) {\r\n            _this._lastTextAreaEvent = 3 /* compositionend */;\r\n            if (compositionDataInValid(e.locale)) {\r\n                // https://github.com/Microsoft/monaco-editor/issues/339\r\n                var _a = deduceInputFromTextAreaValue(/*couldBeEmojiInput*/ false, /*couldBeTypingAtOffset0*/ false), newState = _a[0], typeInput = _a[1];\r\n                _this._textAreaState = newState;\r\n                _this._onType.fire(typeInput);\r\n            }\r\n            else {\r\n                var _b = deduceComposition(e.data), newState = _b[0], typeInput = _b[1];\r\n                _this._textAreaState = newState;\r\n                _this._onType.fire(typeInput);\r\n            }\r\n            // Due to isEdgeOrIE (where the textarea was not cleared initially) and isChrome (the textarea is not updated correctly when composition ends)\r\n            // we cannot assume the text at the end consists only of the composited text\r\n            if (browser.isEdgeOrIE || browser.isChrome) {\r\n                _this._textAreaState = TextAreaState.readFromTextArea(_this._textArea);\r\n            }\r\n            if (!_this._isDoingComposition) {\r\n                return;\r\n            }\r\n            _this._isDoingComposition = false;\r\n            _this._onCompositionEnd.fire();\r\n        }));\r\n        _this._register(dom.addDisposableListener(textArea.domNode, 'input', function () {\r\n            // We want to find out if this is the first `input` after a `focus`.\r\n            var previousEventWasFocus = (_this._lastTextAreaEvent === 8 /* focus */);\r\n            _this._lastTextAreaEvent = 4 /* input */;\r\n            // Pretend here we touched the text area, as the `input` event will most likely\r\n            // result in a `selectionchange` event which we want to ignore\r\n            _this._textArea.setIgnoreSelectionChangeTime('received input event');\r\n            if (_this._isDoingComposition) {\r\n                return;\r\n            }\r\n            var _a = deduceInputFromTextAreaValue(/*couldBeEmojiInput*/ platform.isMacintosh, /*couldBeTypingAtOffset0*/ previousEventWasFocus && platform.isMacintosh), newState = _a[0], typeInput = _a[1];\r\n            if (typeInput.replaceCharCnt === 0 && typeInput.text.length === 1 && strings.isHighSurrogate(typeInput.text.charCodeAt(0))) {\r\n                // Ignore invalid input but keep it around for next time\r\n                return;\r\n            }\r\n            _this._textAreaState = newState;\r\n            if (_this._nextCommand === 0 /* Type */) {\r\n                if (typeInput.text !== '') {\r\n                    _this._onType.fire(typeInput);\r\n                }\r\n            }\r\n            else {\r\n                if (typeInput.text !== '') {\r\n                    _this._onPaste.fire({\r\n                        text: typeInput.text\r\n                    });\r\n                }\r\n                _this._nextCommand = 0 /* Type */;\r\n            }\r\n        }));\r\n        // --- Clipboard operations\r\n        _this._register(dom.addDisposableListener(textArea.domNode, 'cut', function (e) {\r\n            _this._lastTextAreaEvent = 5 /* cut */;\r\n            // Pretend here we touched the text area, as the `cut` event will most likely\r\n            // result in a `selectionchange` event which we want to ignore\r\n            _this._textArea.setIgnoreSelectionChangeTime('received cut event');\r\n            _this._ensureClipboardGetsEditorSelection(e);\r\n            _this._asyncTriggerCut.schedule();\r\n        }));\r\n        _this._register(dom.addDisposableListener(textArea.domNode, 'copy', function (e) {\r\n            _this._lastTextAreaEvent = 6 /* copy */;\r\n            _this._ensureClipboardGetsEditorSelection(e);\r\n        }));\r\n        _this._register(dom.addDisposableListener(textArea.domNode, 'paste', function (e) {\r\n            _this._lastTextAreaEvent = 7 /* paste */;\r\n            // Pretend here we touched the text area, as the `paste` event will most likely\r\n            // result in a `selectionchange` event which we want to ignore\r\n            _this._textArea.setIgnoreSelectionChangeTime('received paste event');\r\n            if (ClipboardEventUtils.canUseTextData(e)) {\r\n                var pastePlainText = ClipboardEventUtils.getTextData(e);\r\n                if (pastePlainText !== '') {\r\n                    _this._onPaste.fire({\r\n                        text: pastePlainText\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                if (_this._textArea.getSelectionStart() !== _this._textArea.getSelectionEnd()) {\r\n                    // Clean up the textarea, to get a clean paste\r\n                    _this._setAndWriteTextAreaState('paste', TextAreaState.EMPTY);\r\n                }\r\n                _this._nextCommand = 1 /* Paste */;\r\n            }\r\n        }));\r\n        _this._register(dom.addDisposableListener(textArea.domNode, 'focus', function () {\r\n            _this._lastTextAreaEvent = 8 /* focus */;\r\n            _this._setHasFocus(true);\r\n        }));\r\n        _this._register(dom.addDisposableListener(textArea.domNode, 'blur', function () {\r\n            _this._lastTextAreaEvent = 9 /* blur */;\r\n            _this._setHasFocus(false);\r\n        }));\r\n        // See https://github.com/Microsoft/vscode/issues/27216\r\n        // When using a Braille display, it is possible for users to reposition the\r\n        // system caret. This is reflected in Chrome as a `selectionchange` event.\r\n        //\r\n        // The `selectionchange` event appears to be emitted under numerous other circumstances,\r\n        // so it is quite a challenge to distinguish a `selectionchange` coming in from a user\r\n        // using a Braille display from all the other cases.\r\n        //\r\n        // The problems with the `selectionchange` event are:\r\n        //  * the event is emitted when the textarea is focused programmatically -- textarea.focus()\r\n        //  * the event is emitted when the selection is changed in the textarea programatically -- textarea.setSelectionRange(...)\r\n        //  * the event is emitted when the value of the textarea is changed programmatically -- textarea.value = '...'\r\n        //  * the event is emitted when tabbing into the textarea\r\n        //  * the event is emitted asynchronously (sometimes with a delay as high as a few tens of ms)\r\n        //  * the event sometimes comes in bursts for a single logical textarea operation\r\n        // `selectionchange` events often come multiple times for a single logical change\r\n        // so throttle multiple `selectionchange` events that burst in a short period of time.\r\n        var previousSelectionChangeEventTime = 0;\r\n        _this._register(dom.addDisposableListener(document, 'selectionchange', function (e) {\r\n            if (!_this._hasFocus) {\r\n                return;\r\n            }\r\n            if (_this._isDoingComposition) {\r\n                return;\r\n            }\r\n            if (!browser.isChrome || !platform.isWindows) {\r\n                // Support only for Chrome on Windows until testing happens on other browsers + OS configurations\r\n                return;\r\n            }\r\n            var now = Date.now();\r\n            var delta1 = now - previousSelectionChangeEventTime;\r\n            previousSelectionChangeEventTime = now;\r\n            if (delta1 < 5) {\r\n                // received another `selectionchange` event within 5ms of the previous `selectionchange` event\r\n                // => ignore it\r\n                return;\r\n            }\r\n            var delta2 = now - _this._textArea.getIgnoreSelectionChangeTime();\r\n            _this._textArea.resetSelectionChangeTime();\r\n            if (delta2 < 100) {\r\n                // received a `selectionchange` event within 100ms since we touched the textarea\r\n                // => ignore it, since we caused it\r\n                return;\r\n            }\r\n            if (!_this._textAreaState.selectionStartPosition || !_this._textAreaState.selectionEndPosition) {\r\n                // Cannot correlate a position in the textarea with a position in the editor...\r\n                return;\r\n            }\r\n            var newValue = _this._textArea.getValue();\r\n            if (_this._textAreaState.value !== newValue) {\r\n                // Cannot correlate a position in the textarea with a position in the editor...\r\n                return;\r\n            }\r\n            var newSelectionStart = _this._textArea.getSelectionStart();\r\n            var newSelectionEnd = _this._textArea.getSelectionEnd();\r\n            if (_this._textAreaState.selectionStart === newSelectionStart && _this._textAreaState.selectionEnd === newSelectionEnd) {\r\n                // Nothing to do...\r\n                return;\r\n            }\r\n            var _newSelectionStartPosition = _this._textAreaState.deduceEditorPosition(newSelectionStart);\r\n            var newSelectionStartPosition = _this._host.deduceModelPosition(_newSelectionStartPosition[0], _newSelectionStartPosition[1], _newSelectionStartPosition[2]);\r\n            var _newSelectionEndPosition = _this._textAreaState.deduceEditorPosition(newSelectionEnd);\r\n            var newSelectionEndPosition = _this._host.deduceModelPosition(_newSelectionEndPosition[0], _newSelectionEndPosition[1], _newSelectionEndPosition[2]);\r\n            var newSelection = new Selection(newSelectionStartPosition.lineNumber, newSelectionStartPosition.column, newSelectionEndPosition.lineNumber, newSelectionEndPosition.column);\r\n            _this._onSelectionChangeRequest.fire(newSelection);\r\n        }));\r\n        return _this;\r\n    }\r\n    TextAreaInput.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    TextAreaInput.prototype.focusTextArea = function () {\r\n        // Setting this._hasFocus and writing the screen reader content\r\n        // will result in a focus() and setSelectionRange() in the textarea\r\n        this._setHasFocus(true);\r\n    };\r\n    TextAreaInput.prototype.isFocused = function () {\r\n        return this._hasFocus;\r\n    };\r\n    TextAreaInput.prototype._setHasFocus = function (newHasFocus) {\r\n        if (this._hasFocus === newHasFocus) {\r\n            // no change\r\n            return;\r\n        }\r\n        this._hasFocus = newHasFocus;\r\n        if (this._hasFocus) {\r\n            if (browser.isEdge) {\r\n                // Edge has a bug where setting the selection range while the focus event\r\n                // is dispatching doesn't work. To reproduce, \"tab into\" the editor.\r\n                this._setAndWriteTextAreaState('focusgain', TextAreaState.EMPTY);\r\n            }\r\n            else {\r\n                this.writeScreenReaderContent('focusgain');\r\n            }\r\n        }\r\n        if (this._hasFocus) {\r\n            this._onFocus.fire();\r\n        }\r\n        else {\r\n            this._onBlur.fire();\r\n        }\r\n    };\r\n    TextAreaInput.prototype._setAndWriteTextAreaState = function (reason, textAreaState) {\r\n        if (!this._hasFocus) {\r\n            textAreaState = textAreaState.collapseSelection();\r\n        }\r\n        textAreaState.writeToTextArea(reason, this._textArea, this._hasFocus);\r\n        this._textAreaState = textAreaState;\r\n    };\r\n    TextAreaInput.prototype.writeScreenReaderContent = function (reason) {\r\n        if (this._isDoingComposition) {\r\n            // Do not write to the text area when doing composition\r\n            return;\r\n        }\r\n        this._setAndWriteTextAreaState(reason, this._host.getScreenReaderContent(this._textAreaState));\r\n    };\r\n    TextAreaInput.prototype._ensureClipboardGetsEditorSelection = function (e) {\r\n        var copyPlainText = this._host.getPlainTextToCopy();\r\n        if (!ClipboardEventUtils.canUseTextData(e)) {\r\n            // Looks like an old browser. The strategy is to place the text\r\n            // we'd like to be copied to the clipboard in the textarea and select it.\r\n            this._setAndWriteTextAreaState('copy or cut', TextAreaState.selectedText(copyPlainText));\r\n            return;\r\n        }\r\n        var copyHTML = null;\r\n        if (browser.hasClipboardSupport() && (copyPlainText.length < 65536 || CopyOptions.forceCopyWithSyntaxHighlighting)) {\r\n            copyHTML = this._host.getHTMLToCopy();\r\n        }\r\n        ClipboardEventUtils.setTextData(e, copyPlainText, copyHTML);\r\n    };\r\n    return TextAreaInput;\r\n}(Disposable));\r\nexport { TextAreaInput };\r\nvar ClipboardEventUtils = /** @class */ (function () {\r\n    function ClipboardEventUtils() {\r\n    }\r\n    ClipboardEventUtils.canUseTextData = function (e) {\r\n        if (e.clipboardData) {\r\n            return true;\r\n        }\r\n        if (window.clipboardData) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ClipboardEventUtils.getTextData = function (e) {\r\n        if (e.clipboardData) {\r\n            e.preventDefault();\r\n            return e.clipboardData.getData('text/plain');\r\n        }\r\n        if (window.clipboardData) {\r\n            e.preventDefault();\r\n            return window.clipboardData.getData('Text');\r\n        }\r\n        throw new Error('ClipboardEventUtils.getTextData: Cannot use text data!');\r\n    };\r\n    ClipboardEventUtils.setTextData = function (e, text, richText) {\r\n        if (e.clipboardData) {\r\n            e.clipboardData.setData('text/plain', text);\r\n            if (richText !== null) {\r\n                e.clipboardData.setData('text/html', richText);\r\n            }\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (window.clipboardData) {\r\n            window.clipboardData.setData('Text', text);\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        throw new Error('ClipboardEventUtils.setTextData: Cannot use text data!');\r\n    };\r\n    return ClipboardEventUtils;\r\n}());\r\nvar TextAreaWrapper = /** @class */ (function (_super) {\r\n    __extends(TextAreaWrapper, _super);\r\n    function TextAreaWrapper(_textArea) {\r\n        var _this = _super.call(this) || this;\r\n        _this._actual = _textArea;\r\n        _this._ignoreSelectionChangeTime = 0;\r\n        return _this;\r\n    }\r\n    TextAreaWrapper.prototype.setIgnoreSelectionChangeTime = function (reason) {\r\n        this._ignoreSelectionChangeTime = Date.now();\r\n    };\r\n    TextAreaWrapper.prototype.getIgnoreSelectionChangeTime = function () {\r\n        return this._ignoreSelectionChangeTime;\r\n    };\r\n    TextAreaWrapper.prototype.resetSelectionChangeTime = function () {\r\n        this._ignoreSelectionChangeTime = 0;\r\n    };\r\n    TextAreaWrapper.prototype.getValue = function () {\r\n        // console.log('current value: ' + this._textArea.value);\r\n        return this._actual.domNode.value;\r\n    };\r\n    TextAreaWrapper.prototype.setValue = function (reason, value) {\r\n        var textArea = this._actual.domNode;\r\n        if (textArea.value === value) {\r\n            // No change\r\n            return;\r\n        }\r\n        // console.log('reason: ' + reason + ', current value: ' + textArea.value + ' => new value: ' + value);\r\n        this.setIgnoreSelectionChangeTime('setValue');\r\n        textArea.value = value;\r\n    };\r\n    TextAreaWrapper.prototype.getSelectionStart = function () {\r\n        return this._actual.domNode.selectionStart;\r\n    };\r\n    TextAreaWrapper.prototype.getSelectionEnd = function () {\r\n        return this._actual.domNode.selectionEnd;\r\n    };\r\n    TextAreaWrapper.prototype.setSelectionRange = function (reason, selectionStart, selectionEnd) {\r\n        var textArea = this._actual.domNode;\r\n        var currentIsFocused = (document.activeElement === textArea);\r\n        var currentSelectionStart = textArea.selectionStart;\r\n        var currentSelectionEnd = textArea.selectionEnd;\r\n        if (currentIsFocused && currentSelectionStart === selectionStart && currentSelectionEnd === selectionEnd) {\r\n            // No change\r\n            // Firefox iframe bug https://github.com/Microsoft/monaco-editor/issues/643#issuecomment-367871377\r\n            if (browser.isFirefox && window.parent !== window) {\r\n                textArea.focus();\r\n            }\r\n            return;\r\n        }\r\n        // console.log('reason: ' + reason + ', setSelectionRange: ' + selectionStart + ' -> ' + selectionEnd);\r\n        if (currentIsFocused) {\r\n            // No need to focus, only need to change the selection range\r\n            this.setIgnoreSelectionChangeTime('setSelectionRange');\r\n            textArea.setSelectionRange(selectionStart, selectionEnd);\r\n            if (browser.isFirefox && window.parent !== window) {\r\n                textArea.focus();\r\n            }\r\n            return;\r\n        }\r\n        // If the focus is outside the textarea, browsers will try really hard to reveal the textarea.\r\n        // Here, we try to undo the browser's desperate reveal.\r\n        try {\r\n            var scrollState = dom.saveParentsScrollTop(textArea);\r\n            this.setIgnoreSelectionChangeTime('setSelectionRange');\r\n            textArea.focus();\r\n            textArea.setSelectionRange(selectionStart, selectionEnd);\r\n            dom.restoreParentsScrollTop(textArea, scrollState);\r\n        }\r\n        catch (e) {\r\n            // Sometimes IE throws when setting selection (e.g. textarea is off-DOM)\r\n        }\r\n    };\r\n    return TextAreaWrapper;\r\n}(Disposable));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { ViewEventHandler } from '../../common/viewModel/viewEventHandler.js';\r\nvar DynamicViewOverlay = /** @class */ (function (_super) {\r\n    __extends(DynamicViewOverlay, _super);\r\n    function DynamicViewOverlay() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return DynamicViewOverlay;\r\n}(ViewEventHandler));\r\nexport { DynamicViewOverlay };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nfunction roundFloat(number, decimalPoints) {\r\n    var decimal = Math.pow(10, decimalPoints);\r\n    return Math.round(number * decimal) / decimal;\r\n}\r\nvar RGBA = /** @class */ (function () {\r\n    function RGBA(r, g, b, a) {\r\n        if (a === void 0) { a = 1; }\r\n        this.r = Math.min(255, Math.max(0, r)) | 0;\r\n        this.g = Math.min(255, Math.max(0, g)) | 0;\r\n        this.b = Math.min(255, Math.max(0, b)) | 0;\r\n        this.a = roundFloat(Math.max(Math.min(1, a), 0), 3);\r\n    }\r\n    RGBA.equals = function (a, b) {\r\n        return a.r === b.r && a.g === b.g && a.b === b.b && a.a === b.a;\r\n    };\r\n    return RGBA;\r\n}());\r\nexport { RGBA };\r\nvar HSLA = /** @class */ (function () {\r\n    function HSLA(h, s, l, a) {\r\n        this.h = Math.max(Math.min(360, h), 0) | 0;\r\n        this.s = roundFloat(Math.max(Math.min(1, s), 0), 3);\r\n        this.l = roundFloat(Math.max(Math.min(1, l), 0), 3);\r\n        this.a = roundFloat(Math.max(Math.min(1, a), 0), 3);\r\n    }\r\n    HSLA.equals = function (a, b) {\r\n        return a.h === b.h && a.s === b.s && a.l === b.l && a.a === b.a;\r\n    };\r\n    /**\r\n     * Converts an RGB color value to HSL. Conversion formula\r\n     * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\r\n     * Assumes r, g, and b are contained in the set [0, 255] and\r\n     * returns h in the set [0, 360], s, and l in the set [0, 1].\r\n     */\r\n    HSLA.fromRGBA = function (rgba) {\r\n        var r = rgba.r / 255;\r\n        var g = rgba.g / 255;\r\n        var b = rgba.b / 255;\r\n        var a = rgba.a;\r\n        var max = Math.max(r, g, b);\r\n        var min = Math.min(r, g, b);\r\n        var h = 0;\r\n        var s = 0;\r\n        var l = (min + max) / 2;\r\n        var chroma = max - min;\r\n        if (chroma > 0) {\r\n            s = Math.min((l <= 0.5 ? chroma / (2 * l) : chroma / (2 - (2 * l))), 1);\r\n            switch (max) {\r\n                case r:\r\n                    h = (g - b) / chroma + (g < b ? 6 : 0);\r\n                    break;\r\n                case g:\r\n                    h = (b - r) / chroma + 2;\r\n                    break;\r\n                case b:\r\n                    h = (r - g) / chroma + 4;\r\n                    break;\r\n            }\r\n            h *= 60;\r\n            h = Math.round(h);\r\n        }\r\n        return new HSLA(h, s, l, a);\r\n    };\r\n    HSLA._hue2rgb = function (p, q, t) {\r\n        if (t < 0) {\r\n            t += 1;\r\n        }\r\n        if (t > 1) {\r\n            t -= 1;\r\n        }\r\n        if (t < 1 / 6) {\r\n            return p + (q - p) * 6 * t;\r\n        }\r\n        if (t < 1 / 2) {\r\n            return q;\r\n        }\r\n        if (t < 2 / 3) {\r\n            return p + (q - p) * (2 / 3 - t) * 6;\r\n        }\r\n        return p;\r\n    };\r\n    /**\r\n     * Converts an HSL color value to RGB. Conversion formula\r\n     * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\r\n     * Assumes h in the set [0, 360] s, and l are contained in the set [0, 1] and\r\n     * returns r, g, and b in the set [0, 255].\r\n     */\r\n    HSLA.toRGBA = function (hsla) {\r\n        var h = hsla.h / 360;\r\n        var s = hsla.s, l = hsla.l, a = hsla.a;\r\n        var r, g, b;\r\n        if (s === 0) {\r\n            r = g = b = l; // achromatic\r\n        }\r\n        else {\r\n            var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n            var p = 2 * l - q;\r\n            r = HSLA._hue2rgb(p, q, h + 1 / 3);\r\n            g = HSLA._hue2rgb(p, q, h);\r\n            b = HSLA._hue2rgb(p, q, h - 1 / 3);\r\n        }\r\n        return new RGBA(Math.round(r * 255), Math.round(g * 255), Math.round(b * 255), a);\r\n    };\r\n    return HSLA;\r\n}());\r\nexport { HSLA };\r\nvar HSVA = /** @class */ (function () {\r\n    function HSVA(h, s, v, a) {\r\n        this.h = Math.max(Math.min(360, h), 0) | 0;\r\n        this.s = roundFloat(Math.max(Math.min(1, s), 0), 3);\r\n        this.v = roundFloat(Math.max(Math.min(1, v), 0), 3);\r\n        this.a = roundFloat(Math.max(Math.min(1, a), 0), 3);\r\n    }\r\n    HSVA.equals = function (a, b) {\r\n        return a.h === b.h && a.s === b.s && a.v === b.v && a.a === b.a;\r\n    };\r\n    // from http://www.rapidtables.com/convert/color/rgb-to-hsv.htm\r\n    HSVA.fromRGBA = function (rgba) {\r\n        var r = rgba.r / 255;\r\n        var g = rgba.g / 255;\r\n        var b = rgba.b / 255;\r\n        var cmax = Math.max(r, g, b);\r\n        var cmin = Math.min(r, g, b);\r\n        var delta = cmax - cmin;\r\n        var s = cmax === 0 ? 0 : (delta / cmax);\r\n        var m;\r\n        if (delta === 0) {\r\n            m = 0;\r\n        }\r\n        else if (cmax === r) {\r\n            m = ((((g - b) / delta) % 6) + 6) % 6;\r\n        }\r\n        else if (cmax === g) {\r\n            m = ((b - r) / delta) + 2;\r\n        }\r\n        else {\r\n            m = ((r - g) / delta) + 4;\r\n        }\r\n        return new HSVA(Math.round(m * 60), s, cmax, rgba.a);\r\n    };\r\n    // from http://www.rapidtables.com/convert/color/hsv-to-rgb.htm\r\n    HSVA.toRGBA = function (hsva) {\r\n        var h = hsva.h, s = hsva.s, v = hsva.v, a = hsva.a;\r\n        var c = v * s;\r\n        var x = c * (1 - Math.abs((h / 60) % 2 - 1));\r\n        var m = v - c;\r\n        var _a = [0, 0, 0], r = _a[0], g = _a[1], b = _a[2];\r\n        if (h < 60) {\r\n            r = c;\r\n            g = x;\r\n        }\r\n        else if (h < 120) {\r\n            r = x;\r\n            g = c;\r\n        }\r\n        else if (h < 180) {\r\n            g = c;\r\n            b = x;\r\n        }\r\n        else if (h < 240) {\r\n            g = x;\r\n            b = c;\r\n        }\r\n        else if (h < 300) {\r\n            r = x;\r\n            b = c;\r\n        }\r\n        else if (h < 360) {\r\n            r = c;\r\n            b = x;\r\n        }\r\n        r = Math.round((r + m) * 255);\r\n        g = Math.round((g + m) * 255);\r\n        b = Math.round((b + m) * 255);\r\n        return new RGBA(r, g, b, a);\r\n    };\r\n    return HSVA;\r\n}());\r\nexport { HSVA };\r\nvar Color = /** @class */ (function () {\r\n    function Color(arg) {\r\n        if (!arg) {\r\n            throw new Error('Color needs a value');\r\n        }\r\n        else if (arg instanceof RGBA) {\r\n            this.rgba = arg;\r\n        }\r\n        else if (arg instanceof HSLA) {\r\n            this._hsla = arg;\r\n            this.rgba = HSLA.toRGBA(arg);\r\n        }\r\n        else if (arg instanceof HSVA) {\r\n            this._hsva = arg;\r\n            this.rgba = HSVA.toRGBA(arg);\r\n        }\r\n        else {\r\n            throw new Error('Invalid color ctor argument');\r\n        }\r\n    }\r\n    Color.fromHex = function (hex) {\r\n        return Color.Format.CSS.parseHex(hex) || Color.red;\r\n    };\r\n    Object.defineProperty(Color.prototype, \"hsla\", {\r\n        get: function () {\r\n            if (this._hsla) {\r\n                return this._hsla;\r\n            }\r\n            else {\r\n                return HSLA.fromRGBA(this.rgba);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Color.prototype, \"hsva\", {\r\n        get: function () {\r\n            if (this._hsva) {\r\n                return this._hsva;\r\n            }\r\n            return HSVA.fromRGBA(this.rgba);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Color.prototype.equals = function (other) {\r\n        return !!other && RGBA.equals(this.rgba, other.rgba) && HSLA.equals(this.hsla, other.hsla) && HSVA.equals(this.hsva, other.hsva);\r\n    };\r\n    /**\r\n     * http://www.w3.org/TR/WCAG20/#relativeluminancedef\r\n     * Returns the number in the set [0, 1]. O => Darkest Black. 1 => Lightest white.\r\n     */\r\n    Color.prototype.getRelativeLuminance = function () {\r\n        var R = Color._relativeLuminanceForComponent(this.rgba.r);\r\n        var G = Color._relativeLuminanceForComponent(this.rgba.g);\r\n        var B = Color._relativeLuminanceForComponent(this.rgba.b);\r\n        var luminance = 0.2126 * R + 0.7152 * G + 0.0722 * B;\r\n        return roundFloat(luminance, 4);\r\n    };\r\n    Color._relativeLuminanceForComponent = function (color) {\r\n        var c = color / 255;\r\n        return (c <= 0.03928) ? c / 12.92 : Math.pow(((c + 0.055) / 1.055), 2.4);\r\n    };\r\n    /**\r\n     *\thttp://24ways.org/2010/calculating-color-contrast\r\n     *  Return 'true' if lighter color otherwise 'false'\r\n     */\r\n    Color.prototype.isLighter = function () {\r\n        var yiq = (this.rgba.r * 299 + this.rgba.g * 587 + this.rgba.b * 114) / 1000;\r\n        return yiq >= 128;\r\n    };\r\n    Color.prototype.isLighterThan = function (another) {\r\n        var lum1 = this.getRelativeLuminance();\r\n        var lum2 = another.getRelativeLuminance();\r\n        return lum1 > lum2;\r\n    };\r\n    Color.prototype.isDarkerThan = function (another) {\r\n        var lum1 = this.getRelativeLuminance();\r\n        var lum2 = another.getRelativeLuminance();\r\n        return lum1 < lum2;\r\n    };\r\n    Color.prototype.lighten = function (factor) {\r\n        return new Color(new HSLA(this.hsla.h, this.hsla.s, this.hsla.l + this.hsla.l * factor, this.hsla.a));\r\n    };\r\n    Color.prototype.darken = function (factor) {\r\n        return new Color(new HSLA(this.hsla.h, this.hsla.s, this.hsla.l - this.hsla.l * factor, this.hsla.a));\r\n    };\r\n    Color.prototype.transparent = function (factor) {\r\n        var _a = this.rgba, r = _a.r, g = _a.g, b = _a.b, a = _a.a;\r\n        return new Color(new RGBA(r, g, b, a * factor));\r\n    };\r\n    Color.prototype.isTransparent = function () {\r\n        return this.rgba.a === 0;\r\n    };\r\n    Color.prototype.isOpaque = function () {\r\n        return this.rgba.a === 1;\r\n    };\r\n    Color.prototype.opposite = function () {\r\n        return new Color(new RGBA(255 - this.rgba.r, 255 - this.rgba.g, 255 - this.rgba.b, this.rgba.a));\r\n    };\r\n    Color.prototype.toString = function () {\r\n        return '' + Color.Format.CSS.format(this);\r\n    };\r\n    Color.getLighterColor = function (of, relative, factor) {\r\n        if (of.isLighterThan(relative)) {\r\n            return of;\r\n        }\r\n        factor = factor ? factor : 0.5;\r\n        var lum1 = of.getRelativeLuminance();\r\n        var lum2 = relative.getRelativeLuminance();\r\n        factor = factor * (lum2 - lum1) / lum2;\r\n        return of.lighten(factor);\r\n    };\r\n    Color.getDarkerColor = function (of, relative, factor) {\r\n        if (of.isDarkerThan(relative)) {\r\n            return of;\r\n        }\r\n        factor = factor ? factor : 0.5;\r\n        var lum1 = of.getRelativeLuminance();\r\n        var lum2 = relative.getRelativeLuminance();\r\n        factor = factor * (lum1 - lum2) / lum1;\r\n        return of.darken(factor);\r\n    };\r\n    Color.white = new Color(new RGBA(255, 255, 255, 1));\r\n    Color.black = new Color(new RGBA(0, 0, 0, 1));\r\n    Color.red = new Color(new RGBA(255, 0, 0, 1));\r\n    Color.blue = new Color(new RGBA(0, 0, 255, 1));\r\n    Color.cyan = new Color(new RGBA(0, 255, 255, 1));\r\n    Color.lightgrey = new Color(new RGBA(211, 211, 211, 1));\r\n    Color.transparent = new Color(new RGBA(0, 0, 0, 0));\r\n    return Color;\r\n}());\r\nexport { Color };\r\n(function (Color) {\r\n    var Format;\r\n    (function (Format) {\r\n        var CSS;\r\n        (function (CSS) {\r\n            function formatRGB(color) {\r\n                if (color.rgba.a === 1) {\r\n                    return \"rgb(\" + color.rgba.r + \", \" + color.rgba.g + \", \" + color.rgba.b + \")\";\r\n                }\r\n                return Color.Format.CSS.formatRGBA(color);\r\n            }\r\n            CSS.formatRGB = formatRGB;\r\n            function formatRGBA(color) {\r\n                return \"rgba(\" + color.rgba.r + \", \" + color.rgba.g + \", \" + color.rgba.b + \", \" + +(color.rgba.a).toFixed(2) + \")\";\r\n            }\r\n            CSS.formatRGBA = formatRGBA;\r\n            function formatHSL(color) {\r\n                if (color.hsla.a === 1) {\r\n                    return \"hsl(\" + color.hsla.h + \", \" + (color.hsla.s * 100).toFixed(2) + \"%, \" + (color.hsla.l * 100).toFixed(2) + \"%)\";\r\n                }\r\n                return Color.Format.CSS.formatHSLA(color);\r\n            }\r\n            CSS.formatHSL = formatHSL;\r\n            function formatHSLA(color) {\r\n                return \"hsla(\" + color.hsla.h + \", \" + (color.hsla.s * 100).toFixed(2) + \"%, \" + (color.hsla.l * 100).toFixed(2) + \"%, \" + color.hsla.a.toFixed(2) + \")\";\r\n            }\r\n            CSS.formatHSLA = formatHSLA;\r\n            function _toTwoDigitHex(n) {\r\n                var r = n.toString(16);\r\n                return r.length !== 2 ? '0' + r : r;\r\n            }\r\n            /**\r\n             * Formats the color as #RRGGBB\r\n             */\r\n            function formatHex(color) {\r\n                return \"#\" + _toTwoDigitHex(color.rgba.r) + _toTwoDigitHex(color.rgba.g) + _toTwoDigitHex(color.rgba.b);\r\n            }\r\n            CSS.formatHex = formatHex;\r\n            /**\r\n             * Formats the color as #RRGGBBAA\r\n             * If 'compact' is set, colors without transparancy will be printed as #RRGGBB\r\n             */\r\n            function formatHexA(color, compact) {\r\n                if (compact === void 0) { compact = false; }\r\n                if (compact && color.rgba.a === 1) {\r\n                    return Color.Format.CSS.formatHex(color);\r\n                }\r\n                return \"#\" + _toTwoDigitHex(color.rgba.r) + _toTwoDigitHex(color.rgba.g) + _toTwoDigitHex(color.rgba.b) + _toTwoDigitHex(Math.round(color.rgba.a * 255));\r\n            }\r\n            CSS.formatHexA = formatHexA;\r\n            /**\r\n             * The default format will use HEX if opaque and RGBA otherwise.\r\n             */\r\n            function format(color) {\r\n                if (!color) {\r\n                    return null;\r\n                }\r\n                if (color.isOpaque()) {\r\n                    return Color.Format.CSS.formatHex(color);\r\n                }\r\n                return Color.Format.CSS.formatRGBA(color);\r\n            }\r\n            CSS.format = format;\r\n            /**\r\n             * Converts an Hex color value to a Color.\r\n             * returns r, g, and b are contained in the set [0, 255]\r\n             * @param hex string (#RGB, #RGBA, #RRGGBB or #RRGGBBAA).\r\n             */\r\n            function parseHex(hex) {\r\n                if (!hex) {\r\n                    // Invalid color\r\n                    return null;\r\n                }\r\n                var length = hex.length;\r\n                if (length === 0) {\r\n                    // Invalid color\r\n                    return null;\r\n                }\r\n                if (hex.charCodeAt(0) !== 35 /* Hash */) {\r\n                    // Does not begin with a #\r\n                    return null;\r\n                }\r\n                if (length === 7) {\r\n                    // #RRGGBB format\r\n                    var r = 16 * _parseHexDigit(hex.charCodeAt(1)) + _parseHexDigit(hex.charCodeAt(2));\r\n                    var g = 16 * _parseHexDigit(hex.charCodeAt(3)) + _parseHexDigit(hex.charCodeAt(4));\r\n                    var b = 16 * _parseHexDigit(hex.charCodeAt(5)) + _parseHexDigit(hex.charCodeAt(6));\r\n                    return new Color(new RGBA(r, g, b, 1));\r\n                }\r\n                if (length === 9) {\r\n                    // #RRGGBBAA format\r\n                    var r = 16 * _parseHexDigit(hex.charCodeAt(1)) + _parseHexDigit(hex.charCodeAt(2));\r\n                    var g = 16 * _parseHexDigit(hex.charCodeAt(3)) + _parseHexDigit(hex.charCodeAt(4));\r\n                    var b = 16 * _parseHexDigit(hex.charCodeAt(5)) + _parseHexDigit(hex.charCodeAt(6));\r\n                    var a = 16 * _parseHexDigit(hex.charCodeAt(7)) + _parseHexDigit(hex.charCodeAt(8));\r\n                    return new Color(new RGBA(r, g, b, a / 255));\r\n                }\r\n                if (length === 4) {\r\n                    // #RGB format\r\n                    var r = _parseHexDigit(hex.charCodeAt(1));\r\n                    var g = _parseHexDigit(hex.charCodeAt(2));\r\n                    var b = _parseHexDigit(hex.charCodeAt(3));\r\n                    return new Color(new RGBA(16 * r + r, 16 * g + g, 16 * b + b));\r\n                }\r\n                if (length === 5) {\r\n                    // #RGBA format\r\n                    var r = _parseHexDigit(hex.charCodeAt(1));\r\n                    var g = _parseHexDigit(hex.charCodeAt(2));\r\n                    var b = _parseHexDigit(hex.charCodeAt(3));\r\n                    var a = _parseHexDigit(hex.charCodeAt(4));\r\n                    return new Color(new RGBA(16 * r + r, 16 * g + g, 16 * b + b, (16 * a + a) / 255));\r\n                }\r\n                // Invalid color\r\n                return null;\r\n            }\r\n            CSS.parseHex = parseHex;\r\n            function _parseHexDigit(charCode) {\r\n                switch (charCode) {\r\n                    case 48 /* Digit0 */: return 0;\r\n                    case 49 /* Digit1 */: return 1;\r\n                    case 50 /* Digit2 */: return 2;\r\n                    case 51 /* Digit3 */: return 3;\r\n                    case 52 /* Digit4 */: return 4;\r\n                    case 53 /* Digit5 */: return 5;\r\n                    case 54 /* Digit6 */: return 6;\r\n                    case 55 /* Digit7 */: return 7;\r\n                    case 56 /* Digit8 */: return 8;\r\n                    case 57 /* Digit9 */: return 9;\r\n                    case 97 /* a */: return 10;\r\n                    case 65 /* A */: return 10;\r\n                    case 98 /* b */: return 11;\r\n                    case 66 /* B */: return 11;\r\n                    case 99 /* c */: return 12;\r\n                    case 67 /* C */: return 12;\r\n                    case 100 /* d */: return 13;\r\n                    case 68 /* D */: return 13;\r\n                    case 101 /* e */: return 14;\r\n                    case 69 /* E */: return 14;\r\n                    case 102 /* f */: return 15;\r\n                    case 70 /* F */: return 15;\r\n                }\r\n                return 0;\r\n            }\r\n        })(CSS = Format.CSS || (Format.CSS = {}));\r\n    })(Format = Color.Format || (Color.Format = {}));\r\n})(Color || (Color = {}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as platform from '../../registry/common/platform.js';\r\nimport { Color, RGBA } from '../../../base/common/color.js';\r\nimport * as nls from '../../../nls.js';\r\n// color registry\r\nexport var Extensions = {\r\n    ColorContribution: 'base.contributions.colors'\r\n};\r\nvar ColorRegistry = /** @class */ (function () {\r\n    function ColorRegistry() {\r\n        this.colorSchema = { type: 'object', description: nls.localize('schema.colors', \"Colors used in the workbench.\"), properties: {}, additionalProperties: false };\r\n        this.colorReferenceSchema = { type: 'string', enum: [], enumDescriptions: [] };\r\n        this.colorsById = {};\r\n    }\r\n    ColorRegistry.prototype.registerColor = function (id, defaults, description, needsTransparency, deprecationMessage) {\r\n        if (needsTransparency === void 0) { needsTransparency = false; }\r\n        var colorContribution = { id: id, description: description, defaults: defaults, needsTransparency: needsTransparency, deprecationMessage: deprecationMessage };\r\n        this.colorsById[id] = colorContribution;\r\n        var propertySchema = { type: 'string', description: description, format: 'color-hex', default: '#ff0000' };\r\n        if (deprecationMessage) {\r\n            propertySchema.deprecationMessage = deprecationMessage;\r\n        }\r\n        this.colorSchema.properties[id] = propertySchema;\r\n        this.colorReferenceSchema.enum.push(id);\r\n        this.colorReferenceSchema.enumDescriptions.push(description);\r\n        return id;\r\n    };\r\n    ColorRegistry.prototype.resolveDefaultColor = function (id, theme) {\r\n        var colorDesc = this.colorsById[id];\r\n        if (colorDesc && colorDesc.defaults) {\r\n            var colorValue = colorDesc.defaults[theme.type];\r\n            return resolveColorValue(colorValue, theme);\r\n        }\r\n        return null;\r\n    };\r\n    ColorRegistry.prototype.toString = function () {\r\n        var _this = this;\r\n        var sorter = function (a, b) {\r\n            var cat1 = a.indexOf('.') === -1 ? 0 : 1;\r\n            var cat2 = b.indexOf('.') === -1 ? 0 : 1;\r\n            if (cat1 !== cat2) {\r\n                return cat1 - cat2;\r\n            }\r\n            return a.localeCompare(b);\r\n        };\r\n        return Object.keys(this.colorsById).sort(sorter).map(function (k) { return \"- `\" + k + \"`: \" + _this.colorsById[k].description; }).join('\\n');\r\n    };\r\n    return ColorRegistry;\r\n}());\r\nvar colorRegistry = new ColorRegistry();\r\nplatform.Registry.add(Extensions.ColorContribution, colorRegistry);\r\nexport function registerColor(id, defaults, description, needsTransparency, deprecationMessage) {\r\n    return colorRegistry.registerColor(id, defaults, description, needsTransparency, deprecationMessage);\r\n}\r\n// ----- base colors\r\nexport var foreground = registerColor('foreground', { dark: '#CCCCCC', light: '#616161', hc: '#FFFFFF' }, nls.localize('foreground', \"Overall foreground color. This color is only used if not overridden by a component.\"));\r\nexport var errorForeground = registerColor('errorForeground', { dark: '#F48771', light: '#A1260D', hc: '#F48771' }, nls.localize('errorForeground', \"Overall foreground color for error messages. This color is only used if not overridden by a component.\"));\r\nexport var focusBorder = registerColor('focusBorder', { dark: Color.fromHex('#0E639C').transparent(0.8), light: Color.fromHex('#007ACC').transparent(0.4), hc: '#F38518' }, nls.localize('focusBorder', \"Overall border color for focused elements. This color is only used if not overridden by a component.\"));\r\nexport var contrastBorder = registerColor('contrastBorder', { light: null, dark: null, hc: '#6FC3DF' }, nls.localize('contrastBorder', \"An extra border around elements to separate them from others for greater contrast.\"));\r\nexport var activeContrastBorder = registerColor('contrastActiveBorder', { light: null, dark: null, hc: focusBorder }, nls.localize('activeContrastBorder', \"An extra border around active elements to separate them from others for greater contrast.\"));\r\nexport var textLinkForeground = registerColor('textLink.foreground', { light: '#006AB1', dark: '#3794FF', hc: '#3794FF' }, nls.localize('textLinkForeground', \"Foreground color for links in text.\"));\r\nexport var textCodeBlockBackground = registerColor('textCodeBlock.background', { light: '#dcdcdc66', dark: '#0a0a0a66', hc: Color.black }, nls.localize('textCodeBlockBackground', \"Background color for code blocks in text.\"));\r\n// ----- widgets\r\nexport var widgetShadow = registerColor('widget.shadow', { dark: '#000000', light: '#A8A8A8', hc: null }, nls.localize('widgetShadow', 'Shadow color of widgets such as find/replace inside the editor.'));\r\nexport var inputBackground = registerColor('input.background', { dark: '#3C3C3C', light: Color.white, hc: Color.black }, nls.localize('inputBoxBackground', \"Input box background.\"));\r\nexport var inputForeground = registerColor('input.foreground', { dark: foreground, light: foreground, hc: foreground }, nls.localize('inputBoxForeground', \"Input box foreground.\"));\r\nexport var inputBorder = registerColor('input.border', { dark: null, light: null, hc: contrastBorder }, nls.localize('inputBoxBorder', \"Input box border.\"));\r\nexport var inputActiveOptionBorder = registerColor('inputOption.activeBorder', { dark: '#007ACC', light: '#007ACC', hc: activeContrastBorder }, nls.localize('inputBoxActiveOptionBorder', \"Border color of activated options in input fields.\"));\r\nexport var inputValidationInfoBackground = registerColor('inputValidation.infoBackground', { dark: '#063B49', light: '#D6ECF2', hc: Color.black }, nls.localize('inputValidationInfoBackground', \"Input validation background color for information severity.\"));\r\nexport var inputValidationInfoForeground = registerColor('inputValidation.infoForeground', { dark: null, light: null, hc: null }, nls.localize('inputValidationInfoForeground', \"Input validation foreground color for information severity.\"));\r\nexport var inputValidationInfoBorder = registerColor('inputValidation.infoBorder', { dark: '#007acc', light: '#007acc', hc: contrastBorder }, nls.localize('inputValidationInfoBorder', \"Input validation border color for information severity.\"));\r\nexport var inputValidationWarningBackground = registerColor('inputValidation.warningBackground', { dark: '#352A05', light: '#F6F5D2', hc: Color.black }, nls.localize('inputValidationWarningBackground', \"Input validation background color for warning severity.\"));\r\nexport var inputValidationWarningForeground = registerColor('inputValidation.warningForeground', { dark: null, light: null, hc: null }, nls.localize('inputValidationWarningForeground', \"Input validation foreground color for warning severity.\"));\r\nexport var inputValidationWarningBorder = registerColor('inputValidation.warningBorder', { dark: '#B89500', light: '#B89500', hc: contrastBorder }, nls.localize('inputValidationWarningBorder', \"Input validation border color for warning severity.\"));\r\nexport var inputValidationErrorBackground = registerColor('inputValidation.errorBackground', { dark: '#5A1D1D', light: '#F2DEDE', hc: Color.black }, nls.localize('inputValidationErrorBackground', \"Input validation background color for error severity.\"));\r\nexport var inputValidationErrorForeground = registerColor('inputValidation.errorForeground', { dark: null, light: null, hc: null }, nls.localize('inputValidationErrorForeground', \"Input validation foreground color for error severity.\"));\r\nexport var inputValidationErrorBorder = registerColor('inputValidation.errorBorder', { dark: '#BE1100', light: '#BE1100', hc: contrastBorder }, nls.localize('inputValidationErrorBorder', \"Input validation border color for error severity.\"));\r\nexport var selectBackground = registerColor('dropdown.background', { dark: '#3C3C3C', light: Color.white, hc: Color.black }, nls.localize('dropdownBackground', \"Dropdown background.\"));\r\nexport var selectForeground = registerColor('dropdown.foreground', { dark: '#F0F0F0', light: null, hc: Color.white }, nls.localize('dropdownForeground', \"Dropdown foreground.\"));\r\nexport var listFocusBackground = registerColor('list.focusBackground', { dark: '#062F4A', light: '#D6EBFF', hc: null }, nls.localize('listFocusBackground', \"List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.\"));\r\nexport var listFocusForeground = registerColor('list.focusForeground', { dark: null, light: null, hc: null }, nls.localize('listFocusForeground', \"List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.\"));\r\nexport var listActiveSelectionBackground = registerColor('list.activeSelectionBackground', { dark: '#094771', light: '#2477CE', hc: null }, nls.localize('listActiveSelectionBackground', \"List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.\"));\r\nexport var listActiveSelectionForeground = registerColor('list.activeSelectionForeground', { dark: Color.white, light: Color.white, hc: null }, nls.localize('listActiveSelectionForeground', \"List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.\"));\r\nexport var listInactiveSelectionBackground = registerColor('list.inactiveSelectionBackground', { dark: '#37373D', light: '#E4E6F1', hc: null }, nls.localize('listInactiveSelectionBackground', \"List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.\"));\r\nexport var listInactiveSelectionForeground = registerColor('list.inactiveSelectionForeground', { dark: null, light: null, hc: null }, nls.localize('listInactiveSelectionForeground', \"List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.\"));\r\nexport var listInactiveFocusBackground = registerColor('list.inactiveFocusBackground', { dark: '#313135', light: '#d8dae6', hc: null }, nls.localize('listInactiveFocusBackground', \"List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.\"));\r\nexport var listHoverBackground = registerColor('list.hoverBackground', { dark: '#2A2D2E', light: '#F0F0F0', hc: null }, nls.localize('listHoverBackground', \"List/Tree background when hovering over items using the mouse.\"));\r\nexport var listHoverForeground = registerColor('list.hoverForeground', { dark: null, light: null, hc: null }, nls.localize('listHoverForeground', \"List/Tree foreground when hovering over items using the mouse.\"));\r\nexport var listDropBackground = registerColor('list.dropBackground', { dark: listFocusBackground, light: listFocusBackground, hc: null }, nls.localize('listDropBackground', \"List/Tree drag and drop background when moving items around using the mouse.\"));\r\nexport var listHighlightForeground = registerColor('list.highlightForeground', { dark: '#0097fb', light: '#0066BF', hc: focusBorder }, nls.localize('highlight', 'List/Tree foreground color of the match highlights when searching inside the list/tree.'));\r\nexport var pickerGroupForeground = registerColor('pickerGroup.foreground', { dark: '#3794FF', light: '#0066BF', hc: Color.white }, nls.localize('pickerGroupForeground', \"Quick picker color for grouping labels.\"));\r\nexport var pickerGroupBorder = registerColor('pickerGroup.border', { dark: '#3F3F46', light: '#CCCEDB', hc: Color.white }, nls.localize('pickerGroupBorder', \"Quick picker color for grouping borders.\"));\r\nexport var badgeBackground = registerColor('badge.background', { dark: '#4D4D4D', light: '#C4C4C4', hc: Color.black }, nls.localize('badgeBackground', \"Badge background color. Badges are small information labels, e.g. for search results count.\"));\r\nexport var badgeForeground = registerColor('badge.foreground', { dark: Color.white, light: '#333', hc: Color.white }, nls.localize('badgeForeground', \"Badge foreground color. Badges are small information labels, e.g. for search results count.\"));\r\nexport var scrollbarShadow = registerColor('scrollbar.shadow', { dark: '#000000', light: '#DDDDDD', hc: null }, nls.localize('scrollbarShadow', \"Scrollbar shadow to indicate that the view is scrolled.\"));\r\nexport var scrollbarSliderBackground = registerColor('scrollbarSlider.background', { dark: Color.fromHex('#797979').transparent(0.4), light: Color.fromHex('#646464').transparent(0.4), hc: transparent(contrastBorder, 0.6) }, nls.localize('scrollbarSliderBackground', \"Scrollbar slider background color.\"));\r\nexport var scrollbarSliderHoverBackground = registerColor('scrollbarSlider.hoverBackground', { dark: Color.fromHex('#646464').transparent(0.7), light: Color.fromHex('#646464').transparent(0.7), hc: transparent(contrastBorder, 0.8) }, nls.localize('scrollbarSliderHoverBackground', \"Scrollbar slider background color when hovering.\"));\r\nexport var scrollbarSliderActiveBackground = registerColor('scrollbarSlider.activeBackground', { dark: Color.fromHex('#BFBFBF').transparent(0.4), light: Color.fromHex('#000000').transparent(0.6), hc: contrastBorder }, nls.localize('scrollbarSliderActiveBackground', \"Scrollbar slider background color when clicked on.\"));\r\nexport var progressBarBackground = registerColor('progressBar.background', { dark: Color.fromHex('#0E70C0'), light: Color.fromHex('#0E70C0'), hc: contrastBorder }, nls.localize('progressBarBackground', \"Background color of the progress bar that can show for long running operations.\"));\r\nexport var menuBorder = registerColor('menu.border', { dark: null, light: null, hc: contrastBorder }, nls.localize('menuBorder', \"Border color of menus.\"));\r\nexport var menuForeground = registerColor('menu.foreground', { dark: selectForeground, light: selectForeground, hc: selectForeground }, nls.localize('menuForeground', \"Foreground color of menu items.\"));\r\nexport var menuBackground = registerColor('menu.background', { dark: selectBackground, light: selectBackground, hc: selectBackground }, nls.localize('menuBackground', \"Background color of menu items.\"));\r\nexport var menuSelectionForeground = registerColor('menu.selectionForeground', { dark: listActiveSelectionForeground, light: listActiveSelectionForeground, hc: listActiveSelectionForeground }, nls.localize('menuSelectionForeground', \"Foreground color of the selected menu item in menus.\"));\r\nexport var menuSelectionBackground = registerColor('menu.selectionBackground', { dark: listActiveSelectionBackground, light: listActiveSelectionBackground, hc: listActiveSelectionBackground }, nls.localize('menuSelectionBackground', \"Background color of the selected menu item in menus.\"));\r\nexport var menuSelectionBorder = registerColor('menu.selectionBorder', { dark: null, light: null, hc: activeContrastBorder }, nls.localize('menuSelectionBorder', \"Border color of the selected menu item in menus.\"));\r\nexport var menuSeparatorBackground = registerColor('menu.separatorBackground', { dark: '#BBBBBB', light: '#888888', hc: contrastBorder }, nls.localize('menuSeparatorBackground', \"Color of a separator menu item in menus.\"));\r\n/**\r\n * Editor background color.\r\n * Because of bug https://monacotools.visualstudio.com/DefaultCollection/Monaco/_workitems/edit/13254\r\n * we are *not* using the color white (or #ffffff, rgba(255,255,255)) but something very close to white.\r\n */\r\nexport var editorBackground = registerColor('editor.background', { light: '#fffffe', dark: '#1E1E1E', hc: Color.black }, nls.localize('editorBackground', \"Editor background color.\"));\r\n/**\r\n * Editor foreground color.\r\n */\r\nexport var editorForeground = registerColor('editor.foreground', { light: '#333333', dark: '#BBBBBB', hc: Color.white }, nls.localize('editorForeground', \"Editor default foreground color.\"));\r\n/**\r\n * Editor widgets\r\n */\r\nexport var editorWidgetBackground = registerColor('editorWidget.background', { dark: '#252526', light: '#F3F3F3', hc: '#0C141F' }, nls.localize('editorWidgetBackground', 'Background color of editor widgets, such as find/replace.'));\r\nexport var editorWidgetBorder = registerColor('editorWidget.border', { dark: '#454545', light: '#C8C8C8', hc: contrastBorder }, nls.localize('editorWidgetBorder', 'Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.'));\r\nexport var editorWidgetResizeBorder = registerColor('editorWidget.resizeBorder', { light: null, dark: null, hc: null }, nls.localize('editorWidgetResizeBorder', \"Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.\"));\r\n/**\r\n * Editor selection colors.\r\n */\r\nexport var editorSelectionBackground = registerColor('editor.selectionBackground', { light: '#ADD6FF', dark: '#264F78', hc: '#f3f518' }, nls.localize('editorSelectionBackground', \"Color of the editor selection.\"));\r\nexport var editorSelectionForeground = registerColor('editor.selectionForeground', { light: null, dark: null, hc: '#000000' }, nls.localize('editorSelectionForeground', \"Color of the selected text for high contrast.\"));\r\nexport var editorInactiveSelection = registerColor('editor.inactiveSelectionBackground', { light: transparent(editorSelectionBackground, 0.5), dark: transparent(editorSelectionBackground, 0.5), hc: transparent(editorSelectionBackground, 0.5) }, nls.localize('editorInactiveSelection', \"Color of the selection in an inactive editor. The color must not be opaque to not hide underlying decorations.\"), true);\r\nexport var editorSelectionHighlight = registerColor('editor.selectionHighlightBackground', { light: lessProminent(editorSelectionBackground, editorBackground, 0.3, 0.6), dark: lessProminent(editorSelectionBackground, editorBackground, 0.3, 0.6), hc: null }, nls.localize('editorSelectionHighlight', 'Color for regions with the same content as the selection. The color must not be opaque to not hide underlying decorations.'), true);\r\nexport var editorSelectionHighlightBorder = registerColor('editor.selectionHighlightBorder', { light: null, dark: null, hc: activeContrastBorder }, nls.localize('editorSelectionHighlightBorder', \"Border color for regions with the same content as the selection.\"));\r\n/**\r\n * Editor find match colors.\r\n */\r\nexport var editorFindMatch = registerColor('editor.findMatchBackground', { light: '#A8AC94', dark: '#515C6A', hc: null }, nls.localize('editorFindMatch', \"Color of the current search match.\"));\r\nexport var editorFindMatchHighlight = registerColor('editor.findMatchHighlightBackground', { light: '#EA5C0055', dark: '#EA5C0055', hc: null }, nls.localize('findMatchHighlight', \"Color of the other search matches. The color must not be opaque to not hide underlying decorations.\"), true);\r\nexport var editorFindRangeHighlight = registerColor('editor.findRangeHighlightBackground', { dark: '#3a3d4166', light: '#b4b4b44d', hc: null }, nls.localize('findRangeHighlight', \"Color of the range limiting the search. The color must not be opaque to not hide underlying decorations.\"), true);\r\nexport var editorFindMatchBorder = registerColor('editor.findMatchBorder', { light: null, dark: null, hc: activeContrastBorder }, nls.localize('editorFindMatchBorder', \"Border color of the current search match.\"));\r\nexport var editorFindMatchHighlightBorder = registerColor('editor.findMatchHighlightBorder', { light: null, dark: null, hc: activeContrastBorder }, nls.localize('findMatchHighlightBorder', \"Border color of the other search matches.\"));\r\nexport var editorFindRangeHighlightBorder = registerColor('editor.findRangeHighlightBorder', { dark: null, light: null, hc: transparent(activeContrastBorder, 0.4) }, nls.localize('findRangeHighlightBorder', \"Border color of the range limiting the search. The color must not be opaque to not hide underlying decorations.\"), true);\r\n/**\r\n * Editor hover\r\n */\r\nexport var editorHoverHighlight = registerColor('editor.hoverHighlightBackground', { light: '#ADD6FF26', dark: '#264f7840', hc: '#ADD6FF26' }, nls.localize('hoverHighlight', 'Highlight below the word for which a hover is shown. The color must not be opaque to not hide underlying decorations.'), true);\r\nexport var editorHoverBackground = registerColor('editorHoverWidget.background', { light: editorWidgetBackground, dark: editorWidgetBackground, hc: editorWidgetBackground }, nls.localize('hoverBackground', 'Background color of the editor hover.'));\r\nexport var editorHoverBorder = registerColor('editorHoverWidget.border', { light: editorWidgetBorder, dark: editorWidgetBorder, hc: editorWidgetBorder }, nls.localize('hoverBorder', 'Border color of the editor hover.'));\r\n/**\r\n * Editor link colors\r\n */\r\nexport var editorActiveLinkForeground = registerColor('editorLink.activeForeground', { dark: '#4E94CE', light: Color.blue, hc: Color.cyan }, nls.localize('activeLinkForeground', 'Color of active links.'));\r\n/**\r\n * Diff Editor Colors\r\n */\r\nexport var defaultInsertColor = new Color(new RGBA(155, 185, 85, 0.2));\r\nexport var defaultRemoveColor = new Color(new RGBA(255, 0, 0, 0.2));\r\nexport var diffInserted = registerColor('diffEditor.insertedTextBackground', { dark: defaultInsertColor, light: defaultInsertColor, hc: null }, nls.localize('diffEditorInserted', 'Background color for text that got inserted. The color must not be opaque to not hide underlying decorations.'), true);\r\nexport var diffRemoved = registerColor('diffEditor.removedTextBackground', { dark: defaultRemoveColor, light: defaultRemoveColor, hc: null }, nls.localize('diffEditorRemoved', 'Background color for text that got removed. The color must not be opaque to not hide underlying decorations.'), true);\r\nexport var diffInsertedOutline = registerColor('diffEditor.insertedTextBorder', { dark: null, light: null, hc: '#33ff2eff' }, nls.localize('diffEditorInsertedOutline', 'Outline color for the text that got inserted.'));\r\nexport var diffRemovedOutline = registerColor('diffEditor.removedTextBorder', { dark: null, light: null, hc: '#FF008F' }, nls.localize('diffEditorRemovedOutline', 'Outline color for text that got removed.'));\r\nexport var diffBorder = registerColor('diffEditor.border', { dark: null, light: null, hc: contrastBorder }, nls.localize('diffEditorBorder', 'Border color between the two text editors.'));\r\n/**\r\n * Snippet placeholder colors\r\n */\r\nexport var snippetTabstopHighlightBackground = registerColor('editor.snippetTabstopHighlightBackground', { dark: new Color(new RGBA(124, 124, 124, 0.3)), light: new Color(new RGBA(10, 50, 100, 0.2)), hc: new Color(new RGBA(124, 124, 124, 0.3)) }, nls.localize('snippetTabstopHighlightBackground', \"Highlight background color of a snippet tabstop.\"));\r\nexport var snippetTabstopHighlightBorder = registerColor('editor.snippetTabstopHighlightBorder', { dark: null, light: null, hc: null }, nls.localize('snippetTabstopHighlightBorder', \"Highlight border color of a snippet tabstop.\"));\r\nexport var snippetFinalTabstopHighlightBackground = registerColor('editor.snippetFinalTabstopHighlightBackground', { dark: null, light: null, hc: null }, nls.localize('snippetFinalTabstopHighlightBackground', \"Highlight background color of the final tabstop of a snippet.\"));\r\nexport var snippetFinalTabstopHighlightBorder = registerColor('editor.snippetFinalTabstopHighlightBorder', { dark: '#525252', light: new Color(new RGBA(10, 50, 100, 0.5)), hc: '#525252' }, nls.localize('snippetFinalTabstopHighlightBorder', \"Highlight border color of the final stabstop of a snippet.\"));\r\nvar findMatchColorDefault = new Color(new RGBA(246, 185, 77, 0.7));\r\nexport var overviewRulerFindMatchForeground = registerColor('editorOverviewRuler.findMatchForeground', { dark: findMatchColorDefault, light: findMatchColorDefault, hc: findMatchColorDefault }, nls.localize('overviewRulerFindMatchForeground', 'Overview ruler marker color for find matches. The color must not be opaque to not hide underlying decorations.'), true);\r\nexport var overviewRulerSelectionHighlightForeground = registerColor('editorOverviewRuler.selectionHighlightForeground', { dark: '#A0A0A0CC', light: '#A0A0A0CC', hc: '#A0A0A0CC' }, nls.localize('overviewRulerSelectionHighlightForeground', 'Overview ruler marker color for selection highlights. The color must not be opaque to not hide underlying decorations.'), true);\r\nexport function transparent(colorValue, factor) {\r\n    return function (theme) {\r\n        var color = resolveColorValue(colorValue, theme);\r\n        if (color) {\r\n            return color.transparent(factor);\r\n        }\r\n        return null;\r\n    };\r\n}\r\nexport function oneOf() {\r\n    var colorValues = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        colorValues[_i] = arguments[_i];\r\n    }\r\n    return function (theme) {\r\n        for (var _i = 0, colorValues_1 = colorValues; _i < colorValues_1.length; _i++) {\r\n            var colorValue = colorValues_1[_i];\r\n            var color = resolveColorValue(colorValue, theme);\r\n            if (color) {\r\n                return color;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n}\r\nfunction lessProminent(colorValue, backgroundColorValue, factor, transparency) {\r\n    return function (theme) {\r\n        var from = resolveColorValue(colorValue, theme);\r\n        if (from) {\r\n            var backgroundColor = resolveColorValue(backgroundColorValue, theme);\r\n            if (backgroundColor) {\r\n                if (from.isDarkerThan(backgroundColor)) {\r\n                    return Color.getLighterColor(from, backgroundColor, factor).transparent(transparency);\r\n                }\r\n                return Color.getDarkerColor(from, backgroundColor, factor).transparent(transparency);\r\n            }\r\n            return from.transparent(factor * transparency);\r\n        }\r\n        return null;\r\n    };\r\n}\r\n// ----- implementation\r\n/**\r\n * @param colorValue Resolve a color value in the context of a theme\r\n */\r\nfunction resolveColorValue(colorValue, theme) {\r\n    if (colorValue === null) {\r\n        return null;\r\n    }\r\n    else if (typeof colorValue === 'string') {\r\n        if (colorValue[0] === '#') {\r\n            return Color.fromHex(colorValue);\r\n        }\r\n        return theme.getColor(colorValue);\r\n    }\r\n    else if (colorValue instanceof Color) {\r\n        return colorValue;\r\n    }\r\n    else if (typeof colorValue === 'function') {\r\n        return colorValue(theme);\r\n    }\r\n    return null;\r\n}\r\n// setTimeout(_ => console.log(colorRegistry.toString()), 5000);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { Color, RGBA } from '../../../base/common/color.js';\r\nimport { activeContrastBorder, editorBackground, editorForeground, registerColor } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\n/**\r\n * Definition of the editor colors\r\n */\r\nexport var editorLineHighlight = registerColor('editor.lineHighlightBackground', { dark: null, light: null, hc: null }, nls.localize('lineHighlight', 'Background color for the highlight of line at the cursor position.'));\r\nexport var editorLineHighlightBorder = registerColor('editor.lineHighlightBorder', { dark: '#282828', light: '#eeeeee', hc: '#f38518' }, nls.localize('lineHighlightBorderBox', 'Background color for the border around the line at the cursor position.'));\r\nexport var editorRangeHighlight = registerColor('editor.rangeHighlightBackground', { dark: '#ffffff0b', light: '#fdff0033', hc: null }, nls.localize('rangeHighlight', 'Background color of highlighted ranges, like by quick open and find features. The color must not be opaque to not hide underlying decorations.'), true);\r\nexport var editorRangeHighlightBorder = registerColor('editor.rangeHighlightBorder', { dark: null, light: null, hc: activeContrastBorder }, nls.localize('rangeHighlightBorder', 'Background color of the border around highlighted ranges.'), true);\r\nexport var editorCursorForeground = registerColor('editorCursor.foreground', { dark: '#AEAFAD', light: Color.black, hc: Color.white }, nls.localize('caret', 'Color of the editor cursor.'));\r\nexport var editorCursorBackground = registerColor('editorCursor.background', null, nls.localize('editorCursorBackground', 'The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.'));\r\nexport var editorWhitespaces = registerColor('editorWhitespace.foreground', { dark: '#e3e4e229', light: '#33333333', hc: '#e3e4e229' }, nls.localize('editorWhitespaces', 'Color of whitespace characters in the editor.'));\r\nexport var editorIndentGuides = registerColor('editorIndentGuide.background', { dark: editorWhitespaces, light: editorWhitespaces, hc: editorWhitespaces }, nls.localize('editorIndentGuides', 'Color of the editor indentation guides.'));\r\nexport var editorActiveIndentGuides = registerColor('editorIndentGuide.activeBackground', { dark: editorWhitespaces, light: editorWhitespaces, hc: editorWhitespaces }, nls.localize('editorActiveIndentGuide', 'Color of the active editor indentation guides.'));\r\nexport var editorLineNumbers = registerColor('editorLineNumber.foreground', { dark: '#858585', light: '#237893', hc: Color.white }, nls.localize('editorLineNumbers', 'Color of editor line numbers.'));\r\nvar deprecatedEditorActiveLineNumber = registerColor('editorActiveLineNumber.foreground', { dark: '#c6c6c6', light: '#0B216F', hc: activeContrastBorder }, nls.localize('editorActiveLineNumber', 'Color of editor active line number'), false, nls.localize('deprecatedEditorActiveLineNumber', 'Id is deprecated. Use \\'editorLineNumber.activeForeground\\' instead.'));\r\nexport var editorActiveLineNumber = registerColor('editorLineNumber.activeForeground', { dark: deprecatedEditorActiveLineNumber, light: deprecatedEditorActiveLineNumber, hc: deprecatedEditorActiveLineNumber }, nls.localize('editorActiveLineNumber', 'Color of editor active line number'));\r\nexport var editorRuler = registerColor('editorRuler.foreground', { dark: '#5A5A5A', light: Color.lightgrey, hc: Color.white }, nls.localize('editorRuler', 'Color of the editor rulers.'));\r\nexport var editorCodeLensForeground = registerColor('editorCodeLens.foreground', { dark: '#999999', light: '#999999', hc: '#999999' }, nls.localize('editorCodeLensForeground', 'Foreground color of editor code lenses'));\r\nexport var editorBracketMatchBackground = registerColor('editorBracketMatch.background', { dark: '#0064001a', light: '#0064001a', hc: '#0064001a' }, nls.localize('editorBracketMatchBackground', 'Background color behind matching brackets'));\r\nexport var editorBracketMatchBorder = registerColor('editorBracketMatch.border', { dark: '#888', light: '#B9B9B9', hc: '#fff' }, nls.localize('editorBracketMatchBorder', 'Color for matching brackets boxes'));\r\nexport var editorOverviewRulerBorder = registerColor('editorOverviewRuler.border', { dark: '#7f7f7f4d', light: '#7f7f7f4d', hc: '#7f7f7f4d' }, nls.localize('editorOverviewRulerBorder', 'Color of the overview ruler border.'));\r\nexport var editorGutter = registerColor('editorGutter.background', { dark: editorBackground, light: editorBackground, hc: editorBackground }, nls.localize('editorGutter', 'Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.'));\r\nexport var editorErrorForeground = registerColor('editorError.foreground', { dark: '#ea4646', light: '#d60a0a', hc: null }, nls.localize('errorForeground', 'Foreground color of error squigglies in the editor.'));\r\nexport var editorErrorBorder = registerColor('editorError.border', { dark: null, light: null, hc: Color.fromHex('#E47777').transparent(0.8) }, nls.localize('errorBorder', 'Border color of error squigglies in the editor.'));\r\nexport var editorWarningForeground = registerColor('editorWarning.foreground', { dark: '#4d9e4d', light: '#117711', hc: null }, nls.localize('warningForeground', 'Foreground color of warning squigglies in the editor.'));\r\nexport var editorWarningBorder = registerColor('editorWarning.border', { dark: null, light: null, hc: Color.fromHex('#71B771').transparent(0.8) }, nls.localize('warningBorder', 'Border color of warning squigglies in the editor.'));\r\nexport var editorInfoForeground = registerColor('editorInfo.foreground', { dark: '#008000', light: '#008000', hc: null }, nls.localize('infoForeground', 'Foreground color of info squigglies in the editor.'));\r\nexport var editorInfoBorder = registerColor('editorInfo.border', { dark: null, light: null, hc: Color.fromHex('#71B771').transparent(0.8) }, nls.localize('infoBorder', 'Border color of info squigglies in the editor.'));\r\nexport var editorHintForeground = registerColor('editorHint.foreground', { dark: Color.fromHex('#eeeeee').transparent(0.7), light: '#6c6c6c', hc: null }, nls.localize('hintForeground', 'Foreground color of hint squigglies in the editor.'));\r\nexport var editorHintBorder = registerColor('editorHint.border', { dark: null, light: null, hc: Color.fromHex('#eeeeee').transparent(0.8) }, nls.localize('hintBorder', 'Border color of hint squigglies in the editor.'));\r\nexport var editorUnnecessaryCodeBorder = registerColor('editorUnnecessaryCode.border', { dark: null, light: null, hc: Color.fromHex('#fff').transparent(0.8) }, nls.localize('unnecessaryCodeBorder', 'Border of unnecessary code in the editor.'));\r\nexport var editorUnnecessaryCodeOpacity = registerColor('editorUnnecessaryCode.opacity', { dark: Color.fromHex('#000a'), light: Color.fromHex('#0007'), hc: null }, nls.localize('unnecessaryCodeOpacity', 'Opacity of unnecessary code in the editor.'));\r\nexport var overviewRulerError = registerColor('editorOverviewRuler.errorForeground', { dark: new Color(new RGBA(255, 18, 18, 0.7)), light: new Color(new RGBA(255, 18, 18, 0.7)), hc: new Color(new RGBA(255, 50, 50, 1)) }, nls.localize('overviewRuleError', 'Overview ruler marker color for errors.'));\r\nexport var overviewRulerWarning = registerColor('editorOverviewRuler.warningForeground', { dark: new Color(new RGBA(18, 136, 18, 0.7)), light: new Color(new RGBA(18, 136, 18, 0.7)), hc: new Color(new RGBA(50, 255, 50, 1)) }, nls.localize('overviewRuleWarning', 'Overview ruler marker color for warnings.'));\r\nexport var overviewRulerInfo = registerColor('editorOverviewRuler.infoForeground', { dark: new Color(new RGBA(18, 18, 136, 0.7)), light: new Color(new RGBA(18, 18, 136, 0.7)), hc: new Color(new RGBA(50, 50, 255, 1)) }, nls.localize('overviewRuleInfo', 'Overview ruler marker color for infos.'));\r\n// contains all color rules that used to defined in editor/browser/widget/editor.css\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var background = theme.getColor(editorBackground);\r\n    if (background) {\r\n        collector.addRule(\".monaco-editor, .monaco-editor-background, .monaco-editor .inputarea.ime-input { background-color: \" + background + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(editorForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor, .monaco-editor .inputarea.ime-input { color: \" + foreground + \"; }\");\r\n    }\r\n    var gutter = theme.getColor(editorGutter);\r\n    if (gutter) {\r\n        collector.addRule(\".monaco-editor .margin { background-color: \" + gutter + \"; }\");\r\n    }\r\n    var rangeHighlight = theme.getColor(editorRangeHighlight);\r\n    if (rangeHighlight) {\r\n        collector.addRule(\".monaco-editor .rangeHighlight { background-color: \" + rangeHighlight + \"; }\");\r\n    }\r\n    var rangeHighlightBorder = theme.getColor(editorRangeHighlightBorder);\r\n    if (rangeHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .rangeHighlight { border: 1px \" + (theme.type === 'hc' ? 'dotted' : 'solid') + \" \" + rangeHighlightBorder + \"; }\");\r\n    }\r\n    var invisibles = theme.getColor(editorWhitespaces);\r\n    if (invisibles) {\r\n        collector.addRule(\".vs-whitespace { color: \" + invisibles + \" !important; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './lineNumbers.css';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { editorActiveLineNumber, editorLineNumbers } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar LineNumbersOverlay = /** @class */ (function (_super) {\r\n    __extends(LineNumbersOverlay, _super);\r\n    function LineNumbersOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._readConfig();\r\n        _this._lastCursorModelPosition = new Position(1, 1);\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    LineNumbersOverlay.prototype._readConfig = function () {\r\n        var config = this._context.configuration.editor;\r\n        this._lineHeight = config.lineHeight;\r\n        this._renderLineNumbers = config.viewInfo.renderLineNumbers;\r\n        this._renderCustomLineNumbers = config.viewInfo.renderCustomLineNumbers;\r\n        this._lineNumbersLeft = config.layoutInfo.lineNumbersLeft;\r\n        this._lineNumbersWidth = config.layoutInfo.lineNumbersWidth;\r\n    };\r\n    LineNumbersOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    LineNumbersOverlay.prototype.onConfigurationChanged = function (e) {\r\n        this._readConfig();\r\n        return true;\r\n    };\r\n    LineNumbersOverlay.prototype.onCursorStateChanged = function (e) {\r\n        var primaryViewPosition = e.selections[0].getPosition();\r\n        this._lastCursorModelPosition = this._context.model.coordinatesConverter.convertViewPositionToModelPosition(primaryViewPosition);\r\n        if (this._renderLineNumbers === 2 /* Relative */ || this._renderLineNumbers === 3 /* Interval */) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    LineNumbersOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    LineNumbersOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    LineNumbersOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    LineNumbersOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    LineNumbersOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged;\r\n    };\r\n    LineNumbersOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    LineNumbersOverlay.prototype._getLineRenderLineNumber = function (viewLineNumber) {\r\n        var modelPosition = this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new Position(viewLineNumber, 1));\r\n        if (modelPosition.column !== 1) {\r\n            return '';\r\n        }\r\n        var modelLineNumber = modelPosition.lineNumber;\r\n        if (this._renderCustomLineNumbers) {\r\n            return this._renderCustomLineNumbers(modelLineNumber);\r\n        }\r\n        if (this._renderLineNumbers === 2 /* Relative */) {\r\n            var diff = Math.abs(this._lastCursorModelPosition.lineNumber - modelLineNumber);\r\n            if (diff === 0) {\r\n                return '<span class=\"relative-current-line-number\">' + modelLineNumber + '</span>';\r\n            }\r\n            return String(diff);\r\n        }\r\n        if (this._renderLineNumbers === 3 /* Interval */) {\r\n            if (this._lastCursorModelPosition.lineNumber === modelLineNumber) {\r\n                return String(modelLineNumber);\r\n            }\r\n            if (modelLineNumber % 10 === 0) {\r\n                return String(modelLineNumber);\r\n            }\r\n            return '';\r\n        }\r\n        return String(modelLineNumber);\r\n    };\r\n    LineNumbersOverlay.prototype.prepareRender = function (ctx) {\r\n        if (this._renderLineNumbers === 0 /* Off */) {\r\n            this._renderResult = null;\r\n            return;\r\n        }\r\n        var lineHeightClassName = (platform.isLinux ? (this._lineHeight % 2 === 0 ? ' lh-even' : ' lh-odd') : '');\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var common = '<div class=\"' + LineNumbersOverlay.CLASS_NAME + lineHeightClassName + '\" style=\"left:' + this._lineNumbersLeft.toString() + 'px;width:' + this._lineNumbersWidth.toString() + 'px;\">';\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            var renderLineNumber = this._getLineRenderLineNumber(lineNumber);\r\n            if (renderLineNumber) {\r\n                output[lineIndex] = (common\r\n                    + renderLineNumber\r\n                    + '</div>');\r\n            }\r\n            else {\r\n                output[lineIndex] = '';\r\n            }\r\n        }\r\n        this._renderResult = output;\r\n    };\r\n    LineNumbersOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineIndex];\r\n    };\r\n    LineNumbersOverlay.CLASS_NAME = 'line-numbers';\r\n    return LineNumbersOverlay;\r\n}(DynamicViewOverlay));\r\nexport { LineNumbersOverlay };\r\n// theming\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var lineNumbers = theme.getColor(editorLineNumbers);\r\n    if (lineNumbers) {\r\n        collector.addRule(\".monaco-editor .line-numbers { color: \" + lineNumbers + \"; }\");\r\n    }\r\n    var activeLineNumber = theme.getColor(editorActiveLineNumber);\r\n    if (activeLineNumber) {\r\n        collector.addRule(\".monaco-editor .current-line ~ .line-numbers { color: \" + activeLineNumber + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nvar Margin = /** @class */ (function (_super) {\r\n    __extends(Margin, _super);\r\n    function Margin(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._canUseLayerHinting = _this._context.configuration.editor.canUseLayerHinting;\r\n        _this._contentLeft = _this._context.configuration.editor.layoutInfo.contentLeft;\r\n        _this._glyphMarginLeft = _this._context.configuration.editor.layoutInfo.glyphMarginLeft;\r\n        _this._glyphMarginWidth = _this._context.configuration.editor.layoutInfo.glyphMarginWidth;\r\n        _this._domNode = _this._createDomNode();\r\n        return _this;\r\n    }\r\n    Margin.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    Margin.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    Margin.prototype._createDomNode = function () {\r\n        var domNode = createFastDomNode(document.createElement('div'));\r\n        domNode.setClassName(Margin.OUTER_CLASS_NAME);\r\n        domNode.setPosition('absolute');\r\n        domNode.setAttribute('role', 'presentation');\r\n        domNode.setAttribute('aria-hidden', 'true');\r\n        this._glyphMarginBackgroundDomNode = createFastDomNode(document.createElement('div'));\r\n        this._glyphMarginBackgroundDomNode.setClassName(Margin.CLASS_NAME);\r\n        domNode.appendChild(this._glyphMarginBackgroundDomNode);\r\n        return domNode;\r\n    };\r\n    // --- begin event handlers\r\n    Margin.prototype.onConfigurationChanged = function (e) {\r\n        if (e.canUseLayerHinting) {\r\n            this._canUseLayerHinting = this._context.configuration.editor.canUseLayerHinting;\r\n        }\r\n        if (e.layoutInfo) {\r\n            this._contentLeft = this._context.configuration.editor.layoutInfo.contentLeft;\r\n            this._glyphMarginLeft = this._context.configuration.editor.layoutInfo.glyphMarginLeft;\r\n            this._glyphMarginWidth = this._context.configuration.editor.layoutInfo.glyphMarginWidth;\r\n        }\r\n        return true;\r\n    };\r\n    Margin.prototype.onScrollChanged = function (e) {\r\n        return _super.prototype.onScrollChanged.call(this, e) || e.scrollTopChanged;\r\n    };\r\n    // --- end event handlers\r\n    Margin.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    Margin.prototype.render = function (ctx) {\r\n        this._domNode.setLayerHinting(this._canUseLayerHinting);\r\n        var adjustedScrollTop = ctx.scrollTop - ctx.bigNumbersDelta;\r\n        this._domNode.setTop(-adjustedScrollTop);\r\n        var height = Math.min(ctx.scrollHeight, 1000000);\r\n        this._domNode.setHeight(height);\r\n        this._domNode.setWidth(this._contentLeft);\r\n        this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft);\r\n        this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth);\r\n        this._glyphMarginBackgroundDomNode.setHeight(height);\r\n    };\r\n    Margin.CLASS_NAME = 'glyph-margin';\r\n    Margin.OUTER_CLASS_NAME = 'margin';\r\n    return Margin;\r\n}(ViewPart));\r\nexport { Margin };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { CharacterClassifier } from '../core/characterClassifier.js';\r\nvar WordCharacterClassifier = /** @class */ (function (_super) {\r\n    __extends(WordCharacterClassifier, _super);\r\n    function WordCharacterClassifier(wordSeparators) {\r\n        var _this = _super.call(this, 0 /* Regular */) || this;\r\n        for (var i = 0, len = wordSeparators.length; i < len; i++) {\r\n            _this.set(wordSeparators.charCodeAt(i), 2 /* WordSeparator */);\r\n        }\r\n        _this.set(32 /* Space */, 1 /* Whitespace */);\r\n        _this.set(9 /* Tab */, 1 /* Whitespace */);\r\n        return _this;\r\n    }\r\n    return WordCharacterClassifier;\r\n}(CharacterClassifier));\r\nexport { WordCharacterClassifier };\r\nfunction once(computeFn) {\r\n    var cache = {}; // TODO@Alex unbounded cache\r\n    return function (input) {\r\n        if (!cache.hasOwnProperty(input)) {\r\n            cache[input] = computeFn(input);\r\n        }\r\n        return cache[input];\r\n    };\r\n}\r\nexport var getMapForWordSeparators = once(function (input) { return new WordCharacterClassifier(input); });\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as errors from '../../../base/common/errors.js';\r\nimport { Disposable, toDisposable } from '../../../base/common/lifecycle.js';\r\nvar ViewConfigurationChangedEvent = /** @class */ (function () {\r\n    function ViewConfigurationChangedEvent(source) {\r\n        this.type = 1 /* ViewConfigurationChanged */;\r\n        this.canUseLayerHinting = source.canUseLayerHinting;\r\n        this.pixelRatio = source.pixelRatio;\r\n        this.editorClassName = source.editorClassName;\r\n        this.lineHeight = source.lineHeight;\r\n        this.readOnly = source.readOnly;\r\n        this.accessibilitySupport = source.accessibilitySupport;\r\n        this.emptySelectionClipboard = source.emptySelectionClipboard;\r\n        this.copyWithSyntaxHighlighting = source.copyWithSyntaxHighlighting;\r\n        this.layoutInfo = source.layoutInfo;\r\n        this.fontInfo = source.fontInfo;\r\n        this.viewInfo = source.viewInfo;\r\n        this.wrappingInfo = source.wrappingInfo;\r\n    }\r\n    return ViewConfigurationChangedEvent;\r\n}());\r\nexport { ViewConfigurationChangedEvent };\r\nvar ViewCursorStateChangedEvent = /** @class */ (function () {\r\n    function ViewCursorStateChangedEvent(selections) {\r\n        this.type = 2 /* ViewCursorStateChanged */;\r\n        this.selections = selections;\r\n    }\r\n    return ViewCursorStateChangedEvent;\r\n}());\r\nexport { ViewCursorStateChangedEvent };\r\nvar ViewDecorationsChangedEvent = /** @class */ (function () {\r\n    function ViewDecorationsChangedEvent() {\r\n        this.type = 3 /* ViewDecorationsChanged */;\r\n        // Nothing to do\r\n    }\r\n    return ViewDecorationsChangedEvent;\r\n}());\r\nexport { ViewDecorationsChangedEvent };\r\nvar ViewFlushedEvent = /** @class */ (function () {\r\n    function ViewFlushedEvent() {\r\n        this.type = 4 /* ViewFlushed */;\r\n        // Nothing to do\r\n    }\r\n    return ViewFlushedEvent;\r\n}());\r\nexport { ViewFlushedEvent };\r\nvar ViewFocusChangedEvent = /** @class */ (function () {\r\n    function ViewFocusChangedEvent(isFocused) {\r\n        this.type = 5 /* ViewFocusChanged */;\r\n        this.isFocused = isFocused;\r\n    }\r\n    return ViewFocusChangedEvent;\r\n}());\r\nexport { ViewFocusChangedEvent };\r\nvar ViewLineMappingChangedEvent = /** @class */ (function () {\r\n    function ViewLineMappingChangedEvent() {\r\n        this.type = 6 /* ViewLineMappingChanged */;\r\n        // Nothing to do\r\n    }\r\n    return ViewLineMappingChangedEvent;\r\n}());\r\nexport { ViewLineMappingChangedEvent };\r\nvar ViewLinesChangedEvent = /** @class */ (function () {\r\n    function ViewLinesChangedEvent(fromLineNumber, toLineNumber) {\r\n        this.type = 7 /* ViewLinesChanged */;\r\n        this.fromLineNumber = fromLineNumber;\r\n        this.toLineNumber = toLineNumber;\r\n    }\r\n    return ViewLinesChangedEvent;\r\n}());\r\nexport { ViewLinesChangedEvent };\r\nvar ViewLinesDeletedEvent = /** @class */ (function () {\r\n    function ViewLinesDeletedEvent(fromLineNumber, toLineNumber) {\r\n        this.type = 8 /* ViewLinesDeleted */;\r\n        this.fromLineNumber = fromLineNumber;\r\n        this.toLineNumber = toLineNumber;\r\n    }\r\n    return ViewLinesDeletedEvent;\r\n}());\r\nexport { ViewLinesDeletedEvent };\r\nvar ViewLinesInsertedEvent = /** @class */ (function () {\r\n    function ViewLinesInsertedEvent(fromLineNumber, toLineNumber) {\r\n        this.type = 9 /* ViewLinesInserted */;\r\n        this.fromLineNumber = fromLineNumber;\r\n        this.toLineNumber = toLineNumber;\r\n    }\r\n    return ViewLinesInsertedEvent;\r\n}());\r\nexport { ViewLinesInsertedEvent };\r\nvar ViewRevealRangeRequestEvent = /** @class */ (function () {\r\n    function ViewRevealRangeRequestEvent(range, verticalType, revealHorizontal, scrollType) {\r\n        this.type = 10 /* ViewRevealRangeRequest */;\r\n        this.range = range;\r\n        this.verticalType = verticalType;\r\n        this.revealHorizontal = revealHorizontal;\r\n        this.scrollType = scrollType;\r\n    }\r\n    return ViewRevealRangeRequestEvent;\r\n}());\r\nexport { ViewRevealRangeRequestEvent };\r\nvar ViewScrollChangedEvent = /** @class */ (function () {\r\n    function ViewScrollChangedEvent(source) {\r\n        this.type = 11 /* ViewScrollChanged */;\r\n        this.scrollWidth = source.scrollWidth;\r\n        this.scrollLeft = source.scrollLeft;\r\n        this.scrollHeight = source.scrollHeight;\r\n        this.scrollTop = source.scrollTop;\r\n        this.scrollWidthChanged = source.scrollWidthChanged;\r\n        this.scrollLeftChanged = source.scrollLeftChanged;\r\n        this.scrollHeightChanged = source.scrollHeightChanged;\r\n        this.scrollTopChanged = source.scrollTopChanged;\r\n    }\r\n    return ViewScrollChangedEvent;\r\n}());\r\nexport { ViewScrollChangedEvent };\r\nvar ViewTokensChangedEvent = /** @class */ (function () {\r\n    function ViewTokensChangedEvent(ranges) {\r\n        this.type = 12 /* ViewTokensChanged */;\r\n        this.ranges = ranges;\r\n    }\r\n    return ViewTokensChangedEvent;\r\n}());\r\nexport { ViewTokensChangedEvent };\r\nvar ViewThemeChangedEvent = /** @class */ (function () {\r\n    function ViewThemeChangedEvent() {\r\n        this.type = 15 /* ViewThemeChanged */;\r\n    }\r\n    return ViewThemeChangedEvent;\r\n}());\r\nexport { ViewThemeChangedEvent };\r\nvar ViewTokensColorsChangedEvent = /** @class */ (function () {\r\n    function ViewTokensColorsChangedEvent() {\r\n        this.type = 13 /* ViewTokensColorsChanged */;\r\n        // Nothing to do\r\n    }\r\n    return ViewTokensColorsChangedEvent;\r\n}());\r\nexport { ViewTokensColorsChangedEvent };\r\nvar ViewZonesChangedEvent = /** @class */ (function () {\r\n    function ViewZonesChangedEvent() {\r\n        this.type = 14 /* ViewZonesChanged */;\r\n        // Nothing to do\r\n    }\r\n    return ViewZonesChangedEvent;\r\n}());\r\nexport { ViewZonesChangedEvent };\r\nvar ViewLanguageConfigurationEvent = /** @class */ (function () {\r\n    function ViewLanguageConfigurationEvent() {\r\n        this.type = 16 /* ViewLanguageConfigurationChanged */;\r\n    }\r\n    return ViewLanguageConfigurationEvent;\r\n}());\r\nexport { ViewLanguageConfigurationEvent };\r\nvar ViewEventEmitter = /** @class */ (function (_super) {\r\n    __extends(ViewEventEmitter, _super);\r\n    function ViewEventEmitter() {\r\n        var _this = _super.call(this) || this;\r\n        _this._listeners = [];\r\n        _this._collector = null;\r\n        _this._collectorCnt = 0;\r\n        return _this;\r\n    }\r\n    ViewEventEmitter.prototype.dispose = function () {\r\n        this._listeners = [];\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ViewEventEmitter.prototype._beginEmit = function () {\r\n        this._collectorCnt++;\r\n        if (this._collectorCnt === 1) {\r\n            this._collector = new ViewEventsCollector();\r\n        }\r\n        return this._collector;\r\n    };\r\n    ViewEventEmitter.prototype._endEmit = function () {\r\n        this._collectorCnt--;\r\n        if (this._collectorCnt === 0) {\r\n            var events = this._collector.finalize();\r\n            this._collector = null;\r\n            if (events.length > 0) {\r\n                this._emit(events);\r\n            }\r\n        }\r\n    };\r\n    ViewEventEmitter.prototype._emit = function (events) {\r\n        var listeners = this._listeners.slice(0);\r\n        for (var i = 0, len = listeners.length; i < len; i++) {\r\n            safeInvokeListener(listeners[i], events);\r\n        }\r\n    };\r\n    ViewEventEmitter.prototype.addEventListener = function (listener) {\r\n        var _this = this;\r\n        this._listeners.push(listener);\r\n        return toDisposable(function () {\r\n            var listeners = _this._listeners;\r\n            for (var i = 0, len = listeners.length; i < len; i++) {\r\n                if (listeners[i] === listener) {\r\n                    listeners.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n    };\r\n    return ViewEventEmitter;\r\n}(Disposable));\r\nexport { ViewEventEmitter };\r\nvar ViewEventsCollector = /** @class */ (function () {\r\n    function ViewEventsCollector() {\r\n        this._eventsLen = 0;\r\n        this._events = [];\r\n        this._eventsLen = 0;\r\n    }\r\n    ViewEventsCollector.prototype.emit = function (event) {\r\n        this._events[this._eventsLen++] = event;\r\n    };\r\n    ViewEventsCollector.prototype.finalize = function () {\r\n        var result = this._events;\r\n        this._events = [];\r\n        return result;\r\n    };\r\n    return ViewEventsCollector;\r\n}());\r\nexport { ViewEventsCollector };\r\nfunction safeInvokeListener(listener, events) {\r\n    try {\r\n        listener(events);\r\n    }\r\n    catch (e) {\r\n        errors.onUnexpectedError(e);\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './textAreaHandler.css';\r\nimport * as browser from '../../../base/browser/browser.js';\r\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Configuration } from '../config/configuration.js';\r\nimport { CopyOptions, TextAreaInput } from './textAreaInput.js';\r\nimport { PagedScreenReaderStrategy, TextAreaState } from './textAreaState.js';\r\nimport { PartFingerprints, ViewPart } from '../view/viewPart.js';\r\nimport { LineNumbersOverlay } from '../viewParts/lineNumbers/lineNumbers.js';\r\nimport { Margin } from '../viewParts/margin/margin.js';\r\nimport { getMapForWordSeparators } from '../../common/controller/wordCharacterClassifier.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport * as viewEvents from '../../common/view/viewEvents.js';\r\nvar VisibleTextAreaData = /** @class */ (function () {\r\n    function VisibleTextAreaData(top, left, width) {\r\n        this.top = top;\r\n        this.left = left;\r\n        this.width = width;\r\n    }\r\n    VisibleTextAreaData.prototype.setWidth = function (width) {\r\n        return new VisibleTextAreaData(this.top, this.left, width);\r\n    };\r\n    return VisibleTextAreaData;\r\n}());\r\nvar canUseZeroSizeTextarea = (browser.isEdgeOrIE || browser.isFirefox);\r\n/**\r\n * Every time we write to the clipboard, we record a bit of extra metadata here.\r\n * Every time we read from the cipboard, if the text matches our last written text,\r\n * we can fetch the previous metadata.\r\n */\r\nvar LocalClipboardMetadataManager = /** @class */ (function () {\r\n    function LocalClipboardMetadataManager() {\r\n        this._lastState = null;\r\n    }\r\n    LocalClipboardMetadataManager.prototype.set = function (state) {\r\n        this._lastState = state;\r\n    };\r\n    LocalClipboardMetadataManager.prototype.get = function (pastedText) {\r\n        if (this._lastState && this._lastState.lastCopiedValue === pastedText) {\r\n            // match!\r\n            return this._lastState;\r\n        }\r\n        this._lastState = null;\r\n        return null;\r\n    };\r\n    LocalClipboardMetadataManager.INSTANCE = new LocalClipboardMetadataManager();\r\n    return LocalClipboardMetadataManager;\r\n}());\r\nvar TextAreaHandler = /** @class */ (function (_super) {\r\n    __extends(TextAreaHandler, _super);\r\n    function TextAreaHandler(context, viewController, viewHelper) {\r\n        var _this = _super.call(this, context) || this;\r\n        // --- end view API\r\n        _this._primaryCursorVisibleRange = null;\r\n        _this._viewController = viewController;\r\n        _this._viewHelper = viewHelper;\r\n        var conf = _this._context.configuration.editor;\r\n        _this._accessibilitySupport = conf.accessibilitySupport;\r\n        _this._contentLeft = conf.layoutInfo.contentLeft;\r\n        _this._contentWidth = conf.layoutInfo.contentWidth;\r\n        _this._contentHeight = conf.layoutInfo.contentHeight;\r\n        _this._scrollLeft = 0;\r\n        _this._scrollTop = 0;\r\n        _this._fontInfo = conf.fontInfo;\r\n        _this._lineHeight = conf.lineHeight;\r\n        _this._emptySelectionClipboard = conf.emptySelectionClipboard;\r\n        _this._copyWithSyntaxHighlighting = conf.copyWithSyntaxHighlighting;\r\n        _this._visibleTextArea = null;\r\n        _this._selections = [new Selection(1, 1, 1, 1)];\r\n        // Text Area (The focus will always be in the textarea when the cursor is blinking)\r\n        _this.textArea = createFastDomNode(document.createElement('textarea'));\r\n        PartFingerprints.write(_this.textArea, 6 /* TextArea */);\r\n        _this.textArea.setClassName('inputarea');\r\n        _this.textArea.setAttribute('wrap', 'off');\r\n        _this.textArea.setAttribute('autocorrect', 'off');\r\n        _this.textArea.setAttribute('autocapitalize', 'off');\r\n        _this.textArea.setAttribute('autocomplete', 'off');\r\n        _this.textArea.setAttribute('spellcheck', 'false');\r\n        _this.textArea.setAttribute('aria-label', conf.viewInfo.ariaLabel);\r\n        _this.textArea.setAttribute('role', 'textbox');\r\n        _this.textArea.setAttribute('aria-multiline', 'true');\r\n        _this.textArea.setAttribute('aria-haspopup', 'false');\r\n        _this.textArea.setAttribute('aria-autocomplete', 'both');\r\n        _this.textAreaCover = createFastDomNode(document.createElement('div'));\r\n        _this.textAreaCover.setPosition('absolute');\r\n        var simpleModel = {\r\n            getLineCount: function () {\r\n                return _this._context.model.getLineCount();\r\n            },\r\n            getLineMaxColumn: function (lineNumber) {\r\n                return _this._context.model.getLineMaxColumn(lineNumber);\r\n            },\r\n            getValueInRange: function (range, eol) {\r\n                return _this._context.model.getValueInRange(range, eol);\r\n            }\r\n        };\r\n        var textAreaInputHost = {\r\n            getPlainTextToCopy: function () {\r\n                var rawWhatToCopy = _this._context.model.getPlainTextToCopy(_this._selections, _this._emptySelectionClipboard, platform.isWindows);\r\n                var newLineCharacter = _this._context.model.getEOL();\r\n                var isFromEmptySelection = (_this._emptySelectionClipboard && _this._selections.length === 1 && _this._selections[0].isEmpty());\r\n                var multicursorText = (Array.isArray(rawWhatToCopy) ? rawWhatToCopy : null);\r\n                var whatToCopy = (Array.isArray(rawWhatToCopy) ? rawWhatToCopy.join(newLineCharacter) : rawWhatToCopy);\r\n                var metadata = null;\r\n                if (isFromEmptySelection || multicursorText) {\r\n                    // Only store the non-default metadata\r\n                    // When writing \"LINE\\r\\n\" to the clipboard and then pasting,\r\n                    // Firefox pastes \"LINE\\n\", so let's work around this quirk\r\n                    var lastCopiedValue = (browser.isFirefox ? whatToCopy.replace(/\\r\\n/g, '\\n') : whatToCopy);\r\n                    metadata = {\r\n                        lastCopiedValue: lastCopiedValue,\r\n                        isFromEmptySelection: (_this._emptySelectionClipboard && _this._selections.length === 1 && _this._selections[0].isEmpty()),\r\n                        multicursorText: multicursorText\r\n                    };\r\n                }\r\n                LocalClipboardMetadataManager.INSTANCE.set(metadata);\r\n                return whatToCopy;\r\n            },\r\n            getHTMLToCopy: function () {\r\n                if (!_this._copyWithSyntaxHighlighting && !CopyOptions.forceCopyWithSyntaxHighlighting) {\r\n                    return null;\r\n                }\r\n                return _this._context.model.getHTMLToCopy(_this._selections, _this._emptySelectionClipboard);\r\n            },\r\n            getScreenReaderContent: function (currentState) {\r\n                if (browser.isIPad) {\r\n                    // Do not place anything in the textarea for the iPad\r\n                    return TextAreaState.EMPTY;\r\n                }\r\n                if (_this._accessibilitySupport === 1 /* Disabled */) {\r\n                    // We know for a fact that a screen reader is not attached\r\n                    // On OSX, we write the character before the cursor to allow for \"long-press\" composition\r\n                    // Also on OSX, we write the word before the cursor to allow for the Accessibility Keyboard to give good hints\r\n                    if (platform.isMacintosh) {\r\n                        var selection = _this._selections[0];\r\n                        if (selection.isEmpty()) {\r\n                            var position = selection.getStartPosition();\r\n                            var textBefore = _this._getWordBeforePosition(position);\r\n                            if (textBefore.length === 0) {\r\n                                textBefore = _this._getCharacterBeforePosition(position);\r\n                            }\r\n                            if (textBefore.length > 0) {\r\n                                return new TextAreaState(textBefore, textBefore.length, textBefore.length, position, position);\r\n                            }\r\n                        }\r\n                    }\r\n                    return TextAreaState.EMPTY;\r\n                }\r\n                return PagedScreenReaderStrategy.fromEditorSelection(currentState, simpleModel, _this._selections[0], _this._accessibilitySupport === 0 /* Unknown */);\r\n            },\r\n            deduceModelPosition: function (viewAnchorPosition, deltaOffset, lineFeedCnt) {\r\n                return _this._context.model.deduceModelPositionRelativeToViewPosition(viewAnchorPosition, deltaOffset, lineFeedCnt);\r\n            }\r\n        };\r\n        _this._textAreaInput = _this._register(new TextAreaInput(textAreaInputHost, _this.textArea));\r\n        _this._register(_this._textAreaInput.onKeyDown(function (e) {\r\n            _this._viewController.emitKeyDown(e);\r\n        }));\r\n        _this._register(_this._textAreaInput.onKeyUp(function (e) {\r\n            _this._viewController.emitKeyUp(e);\r\n        }));\r\n        _this._register(_this._textAreaInput.onPaste(function (e) {\r\n            var metadata = LocalClipboardMetadataManager.INSTANCE.get(e.text);\r\n            var pasteOnNewLine = false;\r\n            var multicursorText = null;\r\n            if (metadata) {\r\n                pasteOnNewLine = (_this._emptySelectionClipboard && metadata.isFromEmptySelection);\r\n                multicursorText = metadata.multicursorText;\r\n            }\r\n            _this._viewController.paste('keyboard', e.text, pasteOnNewLine, multicursorText);\r\n        }));\r\n        _this._register(_this._textAreaInput.onCut(function () {\r\n            _this._viewController.cut('keyboard');\r\n        }));\r\n        _this._register(_this._textAreaInput.onType(function (e) {\r\n            if (e.replaceCharCnt) {\r\n                _this._viewController.replacePreviousChar('keyboard', e.text, e.replaceCharCnt);\r\n            }\r\n            else {\r\n                _this._viewController.type('keyboard', e.text);\r\n            }\r\n        }));\r\n        _this._register(_this._textAreaInput.onSelectionChangeRequest(function (modelSelection) {\r\n            _this._viewController.setSelection('keyboard', modelSelection);\r\n        }));\r\n        _this._register(_this._textAreaInput.onCompositionStart(function () {\r\n            var lineNumber = _this._selections[0].startLineNumber;\r\n            var column = _this._selections[0].startColumn;\r\n            _this._context.privateViewEventBus.emit(new viewEvents.ViewRevealRangeRequestEvent(new Range(lineNumber, column, lineNumber, column), 0 /* Simple */, true, 1 /* Immediate */));\r\n            // Find range pixel position\r\n            var visibleRange = _this._viewHelper.visibleRangeForPositionRelativeToEditor(lineNumber, column);\r\n            if (visibleRange) {\r\n                _this._visibleTextArea = new VisibleTextAreaData(_this._context.viewLayout.getVerticalOffsetForLineNumber(lineNumber), visibleRange.left, canUseZeroSizeTextarea ? 0 : 1);\r\n                _this._render();\r\n            }\r\n            // Show the textarea\r\n            _this.textArea.setClassName('inputarea ime-input');\r\n            _this._viewController.compositionStart('keyboard');\r\n        }));\r\n        _this._register(_this._textAreaInput.onCompositionUpdate(function (e) {\r\n            if (browser.isEdgeOrIE) {\r\n                // Due to isEdgeOrIE (where the textarea was not cleared initially)\r\n                // we cannot assume the text consists only of the composited text\r\n                _this._visibleTextArea = _this._visibleTextArea.setWidth(0);\r\n            }\r\n            else {\r\n                // adjust width by its size\r\n                _this._visibleTextArea = _this._visibleTextArea.setWidth(measureText(e.data, _this._fontInfo));\r\n            }\r\n            _this._render();\r\n        }));\r\n        _this._register(_this._textAreaInput.onCompositionEnd(function () {\r\n            _this._visibleTextArea = null;\r\n            _this._render();\r\n            _this.textArea.setClassName('inputarea');\r\n            _this._viewController.compositionEnd('keyboard');\r\n        }));\r\n        _this._register(_this._textAreaInput.onFocus(function () {\r\n            _this._context.privateViewEventBus.emit(new viewEvents.ViewFocusChangedEvent(true));\r\n        }));\r\n        _this._register(_this._textAreaInput.onBlur(function () {\r\n            _this._context.privateViewEventBus.emit(new viewEvents.ViewFocusChangedEvent(false));\r\n        }));\r\n        return _this;\r\n    }\r\n    TextAreaHandler.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    TextAreaHandler.prototype._getWordBeforePosition = function (position) {\r\n        var lineContent = this._context.model.getLineContent(position.lineNumber);\r\n        var wordSeparators = getMapForWordSeparators(this._context.configuration.editor.wordSeparators);\r\n        var column = position.column;\r\n        var distance = 0;\r\n        while (column > 1) {\r\n            var charCode = lineContent.charCodeAt(column - 2);\r\n            var charClass = wordSeparators.get(charCode);\r\n            if (charClass !== 0 /* Regular */ || distance > 50) {\r\n                return lineContent.substring(column - 1, position.column - 1);\r\n            }\r\n            distance++;\r\n            column--;\r\n        }\r\n        return lineContent.substring(0, position.column - 1);\r\n    };\r\n    TextAreaHandler.prototype._getCharacterBeforePosition = function (position) {\r\n        if (position.column > 1) {\r\n            var lineContent = this._context.model.getLineContent(position.lineNumber);\r\n            var charBefore = lineContent.charAt(position.column - 2);\r\n            if (!strings.isHighSurrogate(charBefore.charCodeAt(0))) {\r\n                return charBefore;\r\n            }\r\n        }\r\n        return '';\r\n    };\r\n    // --- begin event handlers\r\n    TextAreaHandler.prototype.onConfigurationChanged = function (e) {\r\n        var conf = this._context.configuration.editor;\r\n        if (e.fontInfo) {\r\n            this._fontInfo = conf.fontInfo;\r\n        }\r\n        if (e.viewInfo) {\r\n            this.textArea.setAttribute('aria-label', conf.viewInfo.ariaLabel);\r\n        }\r\n        if (e.layoutInfo) {\r\n            this._contentLeft = conf.layoutInfo.contentLeft;\r\n            this._contentWidth = conf.layoutInfo.contentWidth;\r\n            this._contentHeight = conf.layoutInfo.contentHeight;\r\n        }\r\n        if (e.lineHeight) {\r\n            this._lineHeight = conf.lineHeight;\r\n        }\r\n        if (e.accessibilitySupport) {\r\n            this._accessibilitySupport = conf.accessibilitySupport;\r\n            this._textAreaInput.writeScreenReaderContent('strategy changed');\r\n        }\r\n        if (e.emptySelectionClipboard) {\r\n            this._emptySelectionClipboard = conf.emptySelectionClipboard;\r\n        }\r\n        if (e.copyWithSyntaxHighlighting) {\r\n            this._copyWithSyntaxHighlighting = conf.copyWithSyntaxHighlighting;\r\n        }\r\n        return true;\r\n    };\r\n    TextAreaHandler.prototype.onCursorStateChanged = function (e) {\r\n        this._selections = e.selections.slice(0);\r\n        this._textAreaInput.writeScreenReaderContent('selection changed');\r\n        return true;\r\n    };\r\n    TextAreaHandler.prototype.onDecorationsChanged = function (e) {\r\n        // true for inline decorations that can end up relayouting text\r\n        return true;\r\n    };\r\n    TextAreaHandler.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    TextAreaHandler.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    TextAreaHandler.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    TextAreaHandler.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    TextAreaHandler.prototype.onScrollChanged = function (e) {\r\n        this._scrollLeft = e.scrollLeft;\r\n        this._scrollTop = e.scrollTop;\r\n        return true;\r\n    };\r\n    TextAreaHandler.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    // --- begin view API\r\n    TextAreaHandler.prototype.isFocused = function () {\r\n        return this._textAreaInput.isFocused();\r\n    };\r\n    TextAreaHandler.prototype.focusTextArea = function () {\r\n        this._textAreaInput.focusTextArea();\r\n    };\r\n    TextAreaHandler.prototype.prepareRender = function (ctx) {\r\n        if (this._accessibilitySupport === 2 /* Enabled */) {\r\n            // Do not move the textarea with the cursor, as this generates accessibility events that might confuse screen readers\r\n            // See https://github.com/Microsoft/vscode/issues/26730\r\n            this._primaryCursorVisibleRange = null;\r\n        }\r\n        else {\r\n            var primaryCursorPosition = new Position(this._selections[0].positionLineNumber, this._selections[0].positionColumn);\r\n            this._primaryCursorVisibleRange = ctx.visibleRangeForPosition(primaryCursorPosition);\r\n        }\r\n    };\r\n    TextAreaHandler.prototype.render = function (ctx) {\r\n        this._textAreaInput.writeScreenReaderContent('render');\r\n        this._render();\r\n    };\r\n    TextAreaHandler.prototype._render = function () {\r\n        if (this._visibleTextArea) {\r\n            // The text area is visible for composition reasons\r\n            this._renderInsideEditor(this._visibleTextArea.top - this._scrollTop, this._contentLeft + this._visibleTextArea.left - this._scrollLeft, this._visibleTextArea.width, this._lineHeight, true);\r\n            return;\r\n        }\r\n        if (!this._primaryCursorVisibleRange) {\r\n            // The primary cursor is outside the viewport => place textarea to the top left\r\n            this._renderAtTopLeft();\r\n            return;\r\n        }\r\n        var left = this._contentLeft + this._primaryCursorVisibleRange.left - this._scrollLeft;\r\n        if (left < this._contentLeft || left > this._contentLeft + this._contentWidth) {\r\n            // cursor is outside the viewport\r\n            this._renderAtTopLeft();\r\n            return;\r\n        }\r\n        var top = this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber) - this._scrollTop;\r\n        if (top < 0 || top > this._contentHeight) {\r\n            // cursor is outside the viewport\r\n            this._renderAtTopLeft();\r\n            return;\r\n        }\r\n        // The primary cursor is in the viewport (at least vertically) => place textarea on the cursor\r\n        this._renderInsideEditor(top, left, canUseZeroSizeTextarea ? 0 : 1, canUseZeroSizeTextarea ? 0 : 1, false);\r\n    };\r\n    TextAreaHandler.prototype._renderInsideEditor = function (top, left, width, height, useEditorFont) {\r\n        var ta = this.textArea;\r\n        var tac = this.textAreaCover;\r\n        if (useEditorFont) {\r\n            Configuration.applyFontInfo(ta, this._fontInfo);\r\n        }\r\n        else {\r\n            ta.setFontSize(1);\r\n            ta.setLineHeight(this._fontInfo.lineHeight);\r\n        }\r\n        ta.setTop(top);\r\n        ta.setLeft(left);\r\n        ta.setWidth(width);\r\n        ta.setHeight(height);\r\n        tac.setTop(0);\r\n        tac.setLeft(0);\r\n        tac.setWidth(0);\r\n        tac.setHeight(0);\r\n    };\r\n    TextAreaHandler.prototype._renderAtTopLeft = function () {\r\n        var ta = this.textArea;\r\n        var tac = this.textAreaCover;\r\n        Configuration.applyFontInfo(ta, this._fontInfo);\r\n        ta.setTop(0);\r\n        ta.setLeft(0);\r\n        tac.setTop(0);\r\n        tac.setLeft(0);\r\n        if (canUseZeroSizeTextarea) {\r\n            ta.setWidth(0);\r\n            ta.setHeight(0);\r\n            tac.setWidth(0);\r\n            tac.setHeight(0);\r\n            return;\r\n        }\r\n        // (in WebKit the textarea is 1px by 1px because it cannot handle input to a 0x0 textarea)\r\n        // specifically, when doing Korean IME, setting the textare to 0x0 breaks IME badly.\r\n        ta.setWidth(1);\r\n        ta.setHeight(1);\r\n        tac.setWidth(1);\r\n        tac.setHeight(1);\r\n        if (this._context.configuration.editor.viewInfo.glyphMargin) {\r\n            tac.setClassName('monaco-editor-background textAreaCover ' + Margin.OUTER_CLASS_NAME);\r\n        }\r\n        else {\r\n            if (this._context.configuration.editor.viewInfo.renderLineNumbers !== 0 /* Off */) {\r\n                tac.setClassName('monaco-editor-background textAreaCover ' + LineNumbersOverlay.CLASS_NAME);\r\n            }\r\n            else {\r\n                tac.setClassName('monaco-editor-background textAreaCover');\r\n            }\r\n        }\r\n    };\r\n    return TextAreaHandler;\r\n}(ViewPart));\r\nexport { TextAreaHandler };\r\nfunction measureText(text, fontInfo) {\r\n    // adjust width by its size\r\n    var canvasElem = document.createElement('canvas');\r\n    var context = canvasElem.getContext('2d');\r\n    context.font = createFontString(fontInfo);\r\n    var metrics = context.measureText(text);\r\n    if (browser.isFirefox) {\r\n        return metrics.width + 2; // +2 for Japanese...\r\n    }\r\n    else {\r\n        return metrics.width;\r\n    }\r\n}\r\nfunction createFontString(bareFontInfo) {\r\n    return doCreateFontString('normal', bareFontInfo.fontWeight, bareFontInfo.fontSize, bareFontInfo.lineHeight, bareFontInfo.fontFamily);\r\n}\r\nfunction doCreateFontString(fontStyle, fontWeight, fontSize, lineHeight, fontFamily) {\r\n    // The full font syntax is:\r\n    // style | variant | weight | stretch | size/line-height | fontFamily\r\n    // (https://developer.mozilla.org/en-US/docs/Web/CSS/font)\r\n    // But it appears Edge and IE11 cannot properly parse `stretch`.\r\n    return fontStyle + \" normal \" + fontWeight + \" \" + fontSize + \"px / \" + lineHeight + \"px \" + fontFamily;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { globals } from './platform.js';\r\nvar hasPerformanceNow = (globals.performance && typeof globals.performance.now === 'function');\r\nvar StopWatch = /** @class */ (function () {\r\n    function StopWatch(highResolution) {\r\n        this._highResolution = hasPerformanceNow && highResolution;\r\n        this._startTime = this._now();\r\n        this._stopTime = -1;\r\n    }\r\n    StopWatch.create = function (highResolution) {\r\n        if (highResolution === void 0) { highResolution = true; }\r\n        return new StopWatch(highResolution);\r\n    };\r\n    StopWatch.prototype.elapsed = function () {\r\n        if (this._stopTime !== -1) {\r\n            return this._stopTime - this._startTime;\r\n        }\r\n        return this._now() - this._startTime;\r\n    };\r\n    StopWatch.prototype._now = function () {\r\n        return this._highResolution ? globals.performance.now() : new Date().getTime();\r\n    };\r\n    return StopWatch;\r\n}());\r\nexport { StopWatch };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nvar EditStackElement = /** @class */ (function () {\r\n    function EditStackElement(beforeVersionId, beforeCursorState) {\r\n        this.beforeVersionId = beforeVersionId;\r\n        this.beforeCursorState = beforeCursorState;\r\n        this.afterCursorState = null;\r\n        this.afterVersionId = -1;\r\n        this.editOperations = [];\r\n    }\r\n    EditStackElement.prototype.undo = function (model) {\r\n        // Apply all operations in reverse order\r\n        for (var i = this.editOperations.length - 1; i >= 0; i--) {\r\n            this.editOperations[i] = {\r\n                operations: model.applyEdits(this.editOperations[i].operations)\r\n            };\r\n        }\r\n    };\r\n    EditStackElement.prototype.redo = function (model) {\r\n        // Apply all operations\r\n        for (var i = 0; i < this.editOperations.length; i++) {\r\n            this.editOperations[i] = {\r\n                operations: model.applyEdits(this.editOperations[i].operations)\r\n            };\r\n        }\r\n    };\r\n    return EditStackElement;\r\n}());\r\nfunction getModelEOL(model) {\r\n    var eol = model.getEOL();\r\n    if (eol === '\\n') {\r\n        return 0 /* LF */;\r\n    }\r\n    else {\r\n        return 1 /* CRLF */;\r\n    }\r\n}\r\nvar EOLStackElement = /** @class */ (function () {\r\n    function EOLStackElement(beforeVersionId, setEOL) {\r\n        this.beforeVersionId = beforeVersionId;\r\n        this.beforeCursorState = null;\r\n        this.afterCursorState = null;\r\n        this.afterVersionId = -1;\r\n        this.eol = setEOL;\r\n    }\r\n    EOLStackElement.prototype.undo = function (model) {\r\n        var redoEOL = getModelEOL(model);\r\n        model.setEOL(this.eol);\r\n        this.eol = redoEOL;\r\n    };\r\n    EOLStackElement.prototype.redo = function (model) {\r\n        var undoEOL = getModelEOL(model);\r\n        model.setEOL(this.eol);\r\n        this.eol = undoEOL;\r\n    };\r\n    return EOLStackElement;\r\n}());\r\nvar EditStack = /** @class */ (function () {\r\n    function EditStack(model) {\r\n        this.model = model;\r\n        this.currentOpenStackElement = null;\r\n        this.past = [];\r\n        this.future = [];\r\n    }\r\n    EditStack.prototype.pushStackElement = function () {\r\n        if (this.currentOpenStackElement !== null) {\r\n            this.past.push(this.currentOpenStackElement);\r\n            this.currentOpenStackElement = null;\r\n        }\r\n    };\r\n    EditStack.prototype.clear = function () {\r\n        this.currentOpenStackElement = null;\r\n        this.past = [];\r\n        this.future = [];\r\n    };\r\n    EditStack.prototype.pushEOL = function (eol) {\r\n        // No support for parallel universes :(\r\n        this.future = [];\r\n        if (this.currentOpenStackElement) {\r\n            this.pushStackElement();\r\n        }\r\n        var prevEOL = getModelEOL(this.model);\r\n        var stackElement = new EOLStackElement(this.model.getAlternativeVersionId(), prevEOL);\r\n        this.model.setEOL(eol);\r\n        stackElement.afterVersionId = this.model.getVersionId();\r\n        this.currentOpenStackElement = stackElement;\r\n        this.pushStackElement();\r\n    };\r\n    EditStack.prototype.pushEditOperation = function (beforeCursorState, editOperations, cursorStateComputer) {\r\n        // No support for parallel universes :(\r\n        this.future = [];\r\n        var stackElement = null;\r\n        if (this.currentOpenStackElement) {\r\n            if (this.currentOpenStackElement instanceof EditStackElement) {\r\n                stackElement = this.currentOpenStackElement;\r\n            }\r\n            else {\r\n                this.pushStackElement();\r\n            }\r\n        }\r\n        if (!this.currentOpenStackElement) {\r\n            stackElement = new EditStackElement(this.model.getAlternativeVersionId(), beforeCursorState);\r\n            this.currentOpenStackElement = stackElement;\r\n        }\r\n        var inverseEditOperation = {\r\n            operations: this.model.applyEdits(editOperations)\r\n        };\r\n        stackElement.editOperations.push(inverseEditOperation);\r\n        stackElement.afterCursorState = EditStack._computeCursorState(cursorStateComputer, inverseEditOperation.operations);\r\n        stackElement.afterVersionId = this.model.getVersionId();\r\n        return stackElement.afterCursorState;\r\n    };\r\n    EditStack._computeCursorState = function (cursorStateComputer, inverseEditOperations) {\r\n        try {\r\n            return cursorStateComputer ? cursorStateComputer(inverseEditOperations) : null;\r\n        }\r\n        catch (e) {\r\n            onUnexpectedError(e);\r\n            return null;\r\n        }\r\n    };\r\n    EditStack.prototype.undo = function () {\r\n        this.pushStackElement();\r\n        if (this.past.length > 0) {\r\n            var pastStackElement = this.past.pop();\r\n            try {\r\n                pastStackElement.undo(this.model);\r\n            }\r\n            catch (e) {\r\n                onUnexpectedError(e);\r\n                this.clear();\r\n                return null;\r\n            }\r\n            this.future.push(pastStackElement);\r\n            return {\r\n                selections: pastStackElement.beforeCursorState,\r\n                recordedVersionId: pastStackElement.beforeVersionId\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    EditStack.prototype.canUndo = function () {\r\n        return (this.past.length > 0);\r\n    };\r\n    EditStack.prototype.redo = function () {\r\n        if (this.future.length > 0) {\r\n            var futureStackElement = this.future.pop();\r\n            try {\r\n                futureStackElement.redo(this.model);\r\n            }\r\n            catch (e) {\r\n                onUnexpectedError(e);\r\n                this.clear();\r\n                return null;\r\n            }\r\n            this.past.push(futureStackElement);\r\n            return {\r\n                selections: futureStackElement.afterCursorState,\r\n                recordedVersionId: futureStackElement.afterVersionId\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    EditStack.prototype.canRedo = function () {\r\n        return (this.future.length > 0);\r\n    };\r\n    return EditStack;\r\n}());\r\nexport { EditStack };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar SpacesDiffResult = /** @class */ (function () {\r\n    function SpacesDiffResult() {\r\n    }\r\n    return SpacesDiffResult;\r\n}());\r\n/**\r\n * Compute the diff in spaces between two line's indentation.\r\n */\r\nfunction spacesDiff(a, aLength, b, bLength, result) {\r\n    result.spacesDiff = 0;\r\n    result.looksLikeAlignment = false;\r\n    // This can go both ways (e.g.):\r\n    //  - a: \"\\t\"\r\n    //  - b: \"\\t    \"\r\n    //  => This should count 1 tab and 4 spaces\r\n    var i;\r\n    for (i = 0; i < aLength && i < bLength; i++) {\r\n        var aCharCode = a.charCodeAt(i);\r\n        var bCharCode = b.charCodeAt(i);\r\n        if (aCharCode !== bCharCode) {\r\n            break;\r\n        }\r\n    }\r\n    var aSpacesCnt = 0, aTabsCount = 0;\r\n    for (var j = i; j < aLength; j++) {\r\n        var aCharCode = a.charCodeAt(j);\r\n        if (aCharCode === 32 /* Space */) {\r\n            aSpacesCnt++;\r\n        }\r\n        else {\r\n            aTabsCount++;\r\n        }\r\n    }\r\n    var bSpacesCnt = 0, bTabsCount = 0;\r\n    for (var j = i; j < bLength; j++) {\r\n        var bCharCode = b.charCodeAt(j);\r\n        if (bCharCode === 32 /* Space */) {\r\n            bSpacesCnt++;\r\n        }\r\n        else {\r\n            bTabsCount++;\r\n        }\r\n    }\r\n    if (aSpacesCnt > 0 && aTabsCount > 0) {\r\n        return;\r\n    }\r\n    if (bSpacesCnt > 0 && bTabsCount > 0) {\r\n        return;\r\n    }\r\n    var tabsDiff = Math.abs(aTabsCount - bTabsCount);\r\n    var spacesDiff = Math.abs(aSpacesCnt - bSpacesCnt);\r\n    if (tabsDiff === 0) {\r\n        // check if the indentation difference might be caused by alignment reasons\r\n        // sometime folks like to align their code, but this should not be used as a hint\r\n        result.spacesDiff = spacesDiff;\r\n        if (spacesDiff > 0 && 0 <= bSpacesCnt - 1 && bSpacesCnt - 1 < a.length && bSpacesCnt < b.length) {\r\n            if (b.charCodeAt(bSpacesCnt) !== 32 /* Space */ && a.charCodeAt(bSpacesCnt - 1) === 32 /* Space */) {\r\n                // This looks like an alignment desire: e.g.\r\n                // const a = b + c,\r\n                //       d = b - c;\r\n                result.looksLikeAlignment = true;\r\n            }\r\n        }\r\n        return;\r\n    }\r\n    if (spacesDiff % tabsDiff === 0) {\r\n        result.spacesDiff = spacesDiff / tabsDiff;\r\n        return;\r\n    }\r\n}\r\nexport function guessIndentation(source, defaultTabSize, defaultInsertSpaces) {\r\n    // Look at most at the first 10k lines\r\n    var linesCount = Math.min(source.getLineCount(), 10000);\r\n    var linesIndentedWithTabsCount = 0; // number of lines that contain at least one tab in indentation\r\n    var linesIndentedWithSpacesCount = 0; // number of lines that contain only spaces in indentation\r\n    var previousLineText = ''; // content of latest line that contained non-whitespace chars\r\n    var previousLineIndentation = 0; // index at which latest line contained the first non-whitespace char\r\n    var ALLOWED_TAB_SIZE_GUESSES = [2, 4, 6, 8, 3, 5, 7]; // prefer even guesses for `tabSize`, limit to [2, 8].\r\n    var MAX_ALLOWED_TAB_SIZE_GUESS = 8; // max(ALLOWED_TAB_SIZE_GUESSES) = 8\r\n    var spacesDiffCount = [0, 0, 0, 0, 0, 0, 0, 0, 0]; // `tabSize` scores\r\n    var tmp = new SpacesDiffResult();\r\n    for (var lineNumber = 1; lineNumber <= linesCount; lineNumber++) {\r\n        var currentLineLength = source.getLineLength(lineNumber);\r\n        var currentLineText = source.getLineContent(lineNumber);\r\n        // if the text buffer is chunk based, so long lines are cons-string, v8 will flattern the string when we check charCode.\r\n        // checking charCode on chunks directly is cheaper.\r\n        var useCurrentLineText = (currentLineLength <= 65536);\r\n        var currentLineHasContent = false; // does `currentLineText` contain non-whitespace chars\r\n        var currentLineIndentation = 0; // index at which `currentLineText` contains the first non-whitespace char\r\n        var currentLineSpacesCount = 0; // count of spaces found in `currentLineText` indentation\r\n        var currentLineTabsCount = 0; // count of tabs found in `currentLineText` indentation\r\n        for (var j = 0, lenJ = currentLineLength; j < lenJ; j++) {\r\n            var charCode = (useCurrentLineText ? currentLineText.charCodeAt(j) : source.getLineCharCode(lineNumber, j));\r\n            if (charCode === 9 /* Tab */) {\r\n                currentLineTabsCount++;\r\n            }\r\n            else if (charCode === 32 /* Space */) {\r\n                currentLineSpacesCount++;\r\n            }\r\n            else {\r\n                // Hit non whitespace character on this line\r\n                currentLineHasContent = true;\r\n                currentLineIndentation = j;\r\n                break;\r\n            }\r\n        }\r\n        // Ignore empty or only whitespace lines\r\n        if (!currentLineHasContent) {\r\n            continue;\r\n        }\r\n        if (currentLineTabsCount > 0) {\r\n            linesIndentedWithTabsCount++;\r\n        }\r\n        else if (currentLineSpacesCount > 1) {\r\n            linesIndentedWithSpacesCount++;\r\n        }\r\n        spacesDiff(previousLineText, previousLineIndentation, currentLineText, currentLineIndentation, tmp);\r\n        if (tmp.looksLikeAlignment) {\r\n            // skip this line entirely\r\n            continue;\r\n        }\r\n        var currentSpacesDiff = tmp.spacesDiff;\r\n        if (currentSpacesDiff <= MAX_ALLOWED_TAB_SIZE_GUESS) {\r\n            spacesDiffCount[currentSpacesDiff]++;\r\n        }\r\n        previousLineText = currentLineText;\r\n        previousLineIndentation = currentLineIndentation;\r\n    }\r\n    var insertSpaces = defaultInsertSpaces;\r\n    if (linesIndentedWithTabsCount !== linesIndentedWithSpacesCount) {\r\n        insertSpaces = (linesIndentedWithTabsCount < linesIndentedWithSpacesCount);\r\n    }\r\n    var tabSize = defaultTabSize;\r\n    var tabSizeScore = (insertSpaces ? 0 : 0.1 * linesCount);\r\n    // console.log(\"score threshold: \" + tabSizeScore);\r\n    ALLOWED_TAB_SIZE_GUESSES.forEach(function (possibleTabSize) {\r\n        var possibleTabSizeScore = spacesDiffCount[possibleTabSize];\r\n        if (possibleTabSizeScore > tabSizeScore) {\r\n            tabSizeScore = possibleTabSizeScore;\r\n            tabSize = possibleTabSize;\r\n        }\r\n    });\r\n    // console.log('--------------------------');\r\n    // console.log('linesIndentedWithTabsCount: ' + linesIndentedWithTabsCount + ', linesIndentedWithSpacesCount: ' + linesIndentedWithSpacesCount);\r\n    // console.log('spacesDiffCount: ' + spacesDiffCount);\r\n    // console.log('tabSize: ' + tabSize + ', tabSizeScore: ' + tabSizeScore);\r\n    return {\r\n        insertSpaces: insertSpaces,\r\n        tabSize: tabSize\r\n    };\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport function getNodeColor(node) {\r\n    return ((node.metadata & 1 /* ColorMask */) >>> 0 /* ColorOffset */);\r\n}\r\nfunction setNodeColor(node, color) {\r\n    node.metadata = ((node.metadata & 254 /* ColorMaskInverse */) | (color << 0 /* ColorOffset */));\r\n}\r\nfunction getNodeIsVisited(node) {\r\n    return ((node.metadata & 2 /* IsVisitedMask */) >>> 1 /* IsVisitedOffset */) === 1;\r\n}\r\nfunction setNodeIsVisited(node, value) {\r\n    node.metadata = ((node.metadata & 253 /* IsVisitedMaskInverse */) | ((value ? 1 : 0) << 1 /* IsVisitedOffset */));\r\n}\r\nfunction getNodeIsForValidation(node) {\r\n    return ((node.metadata & 4 /* IsForValidationMask */) >>> 2 /* IsForValidationOffset */) === 1;\r\n}\r\nfunction setNodeIsForValidation(node, value) {\r\n    node.metadata = ((node.metadata & 251 /* IsForValidationMaskInverse */) | ((value ? 1 : 0) << 2 /* IsForValidationOffset */));\r\n}\r\nexport function getNodeIsInOverviewRuler(node) {\r\n    return ((node.metadata & 8 /* IsInOverviewRulerMask */) >>> 3 /* IsInOverviewRulerOffset */) === 1;\r\n}\r\nfunction setNodeIsInOverviewRuler(node, value) {\r\n    node.metadata = ((node.metadata & 247 /* IsInOverviewRulerMaskInverse */) | ((value ? 1 : 0) << 3 /* IsInOverviewRulerOffset */));\r\n}\r\nfunction getNodeStickiness(node) {\r\n    return ((node.metadata & 48 /* StickinessMask */) >>> 4 /* StickinessOffset */);\r\n}\r\nfunction _setNodeStickiness(node, stickiness) {\r\n    node.metadata = ((node.metadata & 207 /* StickinessMaskInverse */) | (stickiness << 4 /* StickinessOffset */));\r\n}\r\nfunction getCollapseOnReplaceEdit(node) {\r\n    return ((node.metadata & 64 /* CollapseOnReplaceEditMask */) >>> 6 /* CollapseOnReplaceEditOffset */) === 1;\r\n}\r\nfunction setCollapseOnReplaceEdit(node, value) {\r\n    node.metadata = ((node.metadata & 191 /* CollapseOnReplaceEditMaskInverse */) | ((value ? 1 : 0) << 6 /* CollapseOnReplaceEditOffset */));\r\n}\r\nvar IntervalNode = /** @class */ (function () {\r\n    function IntervalNode(id, start, end) {\r\n        this.metadata = 0;\r\n        this.parent = this;\r\n        this.left = this;\r\n        this.right = this;\r\n        setNodeColor(this, 1 /* Red */);\r\n        this.start = start;\r\n        this.end = end;\r\n        // FORCE_OVERFLOWING_TEST: this.delta = start;\r\n        this.delta = 0;\r\n        this.maxEnd = end;\r\n        this.id = id;\r\n        this.ownerId = 0;\r\n        this.options = null;\r\n        setNodeIsForValidation(this, false);\r\n        _setNodeStickiness(this, 1 /* NeverGrowsWhenTypingAtEdges */);\r\n        setNodeIsInOverviewRuler(this, false);\r\n        setCollapseOnReplaceEdit(this, false);\r\n        this.cachedVersionId = 0;\r\n        this.cachedAbsoluteStart = start;\r\n        this.cachedAbsoluteEnd = end;\r\n        this.range = null;\r\n        setNodeIsVisited(this, false);\r\n    }\r\n    IntervalNode.prototype.reset = function (versionId, start, end, range) {\r\n        this.start = start;\r\n        this.end = end;\r\n        this.maxEnd = end;\r\n        this.cachedVersionId = versionId;\r\n        this.cachedAbsoluteStart = start;\r\n        this.cachedAbsoluteEnd = end;\r\n        this.range = range;\r\n    };\r\n    IntervalNode.prototype.setOptions = function (options) {\r\n        this.options = options;\r\n        var className = this.options.className;\r\n        setNodeIsForValidation(this, (className === \"squiggly-error\" /* EditorErrorDecoration */\r\n            || className === \"squiggly-warning\" /* EditorWarningDecoration */\r\n            || className === \"squiggly-info\" /* EditorInfoDecoration */));\r\n        _setNodeStickiness(this, this.options.stickiness);\r\n        setNodeIsInOverviewRuler(this, (this.options.overviewRuler && this.options.overviewRuler.color) ? true : false);\r\n        setCollapseOnReplaceEdit(this, this.options.collapseOnReplaceEdit);\r\n    };\r\n    IntervalNode.prototype.setCachedOffsets = function (absoluteStart, absoluteEnd, cachedVersionId) {\r\n        if (this.cachedVersionId !== cachedVersionId) {\r\n            this.range = null;\r\n        }\r\n        this.cachedVersionId = cachedVersionId;\r\n        this.cachedAbsoluteStart = absoluteStart;\r\n        this.cachedAbsoluteEnd = absoluteEnd;\r\n    };\r\n    IntervalNode.prototype.detach = function () {\r\n        this.parent = null;\r\n        this.left = null;\r\n        this.right = null;\r\n    };\r\n    return IntervalNode;\r\n}());\r\nexport { IntervalNode };\r\nexport var SENTINEL = new IntervalNode(null, 0, 0);\r\nSENTINEL.parent = SENTINEL;\r\nSENTINEL.left = SENTINEL;\r\nSENTINEL.right = SENTINEL;\r\nsetNodeColor(SENTINEL, 0 /* Black */);\r\nvar IntervalTree = /** @class */ (function () {\r\n    function IntervalTree() {\r\n        this.root = SENTINEL;\r\n        this.requestNormalizeDelta = false;\r\n    }\r\n    IntervalTree.prototype.intervalSearch = function (start, end, filterOwnerId, filterOutValidation, cachedVersionId) {\r\n        if (this.root === SENTINEL) {\r\n            return [];\r\n        }\r\n        return intervalSearch(this, start, end, filterOwnerId, filterOutValidation, cachedVersionId);\r\n    };\r\n    IntervalTree.prototype.search = function (filterOwnerId, filterOutValidation, cachedVersionId) {\r\n        if (this.root === SENTINEL) {\r\n            return [];\r\n        }\r\n        return search(this, filterOwnerId, filterOutValidation, cachedVersionId);\r\n    };\r\n    /**\r\n     * Will not set `cachedAbsoluteStart` nor `cachedAbsoluteEnd` on the returned nodes!\r\n     */\r\n    IntervalTree.prototype.collectNodesFromOwner = function (ownerId) {\r\n        return collectNodesFromOwner(this, ownerId);\r\n    };\r\n    /**\r\n     * Will not set `cachedAbsoluteStart` nor `cachedAbsoluteEnd` on the returned nodes!\r\n     */\r\n    IntervalTree.prototype.collectNodesPostOrder = function () {\r\n        return collectNodesPostOrder(this);\r\n    };\r\n    IntervalTree.prototype.insert = function (node) {\r\n        rbTreeInsert(this, node);\r\n        this._normalizeDeltaIfNecessary();\r\n    };\r\n    IntervalTree.prototype.delete = function (node) {\r\n        rbTreeDelete(this, node);\r\n        this._normalizeDeltaIfNecessary();\r\n    };\r\n    IntervalTree.prototype.resolveNode = function (node, cachedVersionId) {\r\n        var initialNode = node;\r\n        var delta = 0;\r\n        while (node !== this.root) {\r\n            if (node === node.parent.right) {\r\n                delta += node.parent.delta;\r\n            }\r\n            node = node.parent;\r\n        }\r\n        var nodeStart = initialNode.start + delta;\r\n        var nodeEnd = initialNode.end + delta;\r\n        initialNode.setCachedOffsets(nodeStart, nodeEnd, cachedVersionId);\r\n    };\r\n    IntervalTree.prototype.acceptReplace = function (offset, length, textLength, forceMoveMarkers) {\r\n        // Our strategy is to remove all directly impacted nodes, and then add them back to the tree.\r\n        // (1) collect all nodes that are intersecting this edit as nodes of interest\r\n        var nodesOfInterest = searchForEditing(this, offset, offset + length);\r\n        // (2) remove all nodes that are intersecting this edit\r\n        for (var i = 0, len = nodesOfInterest.length; i < len; i++) {\r\n            var node = nodesOfInterest[i];\r\n            rbTreeDelete(this, node);\r\n        }\r\n        this._normalizeDeltaIfNecessary();\r\n        // (3) edit all tree nodes except the nodes of interest\r\n        noOverlapReplace(this, offset, offset + length, textLength);\r\n        this._normalizeDeltaIfNecessary();\r\n        // (4) edit the nodes of interest and insert them back in the tree\r\n        for (var i = 0, len = nodesOfInterest.length; i < len; i++) {\r\n            var node = nodesOfInterest[i];\r\n            node.start = node.cachedAbsoluteStart;\r\n            node.end = node.cachedAbsoluteEnd;\r\n            nodeAcceptEdit(node, offset, (offset + length), textLength, forceMoveMarkers);\r\n            node.maxEnd = node.end;\r\n            rbTreeInsert(this, node);\r\n        }\r\n        this._normalizeDeltaIfNecessary();\r\n    };\r\n    IntervalTree.prototype._normalizeDeltaIfNecessary = function () {\r\n        if (!this.requestNormalizeDelta) {\r\n            return;\r\n        }\r\n        this.requestNormalizeDelta = false;\r\n        normalizeDelta(this);\r\n    };\r\n    return IntervalTree;\r\n}());\r\nexport { IntervalTree };\r\n//#region Delta Normalization\r\nfunction normalizeDelta(T) {\r\n    var node = T.root;\r\n    var delta = 0;\r\n    while (node !== SENTINEL) {\r\n        if (node.left !== SENTINEL && !getNodeIsVisited(node.left)) {\r\n            // go left\r\n            node = node.left;\r\n            continue;\r\n        }\r\n        if (node.right !== SENTINEL && !getNodeIsVisited(node.right)) {\r\n            // go right\r\n            delta += node.delta;\r\n            node = node.right;\r\n            continue;\r\n        }\r\n        // handle current node\r\n        node.start = delta + node.start;\r\n        node.end = delta + node.end;\r\n        node.delta = 0;\r\n        recomputeMaxEnd(node);\r\n        setNodeIsVisited(node, true);\r\n        // going up from this node\r\n        setNodeIsVisited(node.left, false);\r\n        setNodeIsVisited(node.right, false);\r\n        if (node === node.parent.right) {\r\n            delta -= node.parent.delta;\r\n        }\r\n        node = node.parent;\r\n    }\r\n    setNodeIsVisited(T.root, false);\r\n}\r\nfunction adjustMarkerBeforeColumn(markerOffset, markerStickToPreviousCharacter, checkOffset, moveSemantics) {\r\n    if (markerOffset < checkOffset) {\r\n        return true;\r\n    }\r\n    if (markerOffset > checkOffset) {\r\n        return false;\r\n    }\r\n    if (moveSemantics === 1 /* ForceMove */) {\r\n        return false;\r\n    }\r\n    if (moveSemantics === 2 /* ForceStay */) {\r\n        return true;\r\n    }\r\n    return markerStickToPreviousCharacter;\r\n}\r\n/**\r\n * This is a lot more complicated than strictly necessary to maintain the same behaviour\r\n * as when decorations were implemented using two markers.\r\n */\r\nexport function nodeAcceptEdit(node, start, end, textLength, forceMoveMarkers) {\r\n    var nodeStickiness = getNodeStickiness(node);\r\n    var startStickToPreviousCharacter = (nodeStickiness === 0 /* AlwaysGrowsWhenTypingAtEdges */\r\n        || nodeStickiness === 2 /* GrowsOnlyWhenTypingBefore */);\r\n    var endStickToPreviousCharacter = (nodeStickiness === 1 /* NeverGrowsWhenTypingAtEdges */\r\n        || nodeStickiness === 2 /* GrowsOnlyWhenTypingBefore */);\r\n    var deletingCnt = (end - start);\r\n    var insertingCnt = textLength;\r\n    var commonLength = Math.min(deletingCnt, insertingCnt);\r\n    var nodeStart = node.start;\r\n    var startDone = false;\r\n    var nodeEnd = node.end;\r\n    var endDone = false;\r\n    if (start <= nodeStart && nodeEnd <= end && getCollapseOnReplaceEdit(node)) {\r\n        // This edit encompasses the entire decoration range\r\n        // and the decoration has asked to become collapsed\r\n        node.start = start;\r\n        startDone = true;\r\n        node.end = start;\r\n        endDone = true;\r\n    }\r\n    {\r\n        var moveSemantics = forceMoveMarkers ? 1 /* ForceMove */ : (deletingCnt > 0 ? 2 /* ForceStay */ : 0 /* MarkerDefined */);\r\n        if (!startDone && adjustMarkerBeforeColumn(nodeStart, startStickToPreviousCharacter, start, moveSemantics)) {\r\n            startDone = true;\r\n        }\r\n        if (!endDone && adjustMarkerBeforeColumn(nodeEnd, endStickToPreviousCharacter, start, moveSemantics)) {\r\n            endDone = true;\r\n        }\r\n    }\r\n    if (commonLength > 0 && !forceMoveMarkers) {\r\n        var moveSemantics = (deletingCnt > insertingCnt ? 2 /* ForceStay */ : 0 /* MarkerDefined */);\r\n        if (!startDone && adjustMarkerBeforeColumn(nodeStart, startStickToPreviousCharacter, start + commonLength, moveSemantics)) {\r\n            startDone = true;\r\n        }\r\n        if (!endDone && adjustMarkerBeforeColumn(nodeEnd, endStickToPreviousCharacter, start + commonLength, moveSemantics)) {\r\n            endDone = true;\r\n        }\r\n    }\r\n    {\r\n        var moveSemantics = forceMoveMarkers ? 1 /* ForceMove */ : 0 /* MarkerDefined */;\r\n        if (!startDone && adjustMarkerBeforeColumn(nodeStart, startStickToPreviousCharacter, end, moveSemantics)) {\r\n            node.start = start + insertingCnt;\r\n            startDone = true;\r\n        }\r\n        if (!endDone && adjustMarkerBeforeColumn(nodeEnd, endStickToPreviousCharacter, end, moveSemantics)) {\r\n            node.end = start + insertingCnt;\r\n            endDone = true;\r\n        }\r\n    }\r\n    // Finish\r\n    var deltaColumn = (insertingCnt - deletingCnt);\r\n    if (!startDone) {\r\n        node.start = Math.max(0, nodeStart + deltaColumn);\r\n        startDone = true;\r\n    }\r\n    if (!endDone) {\r\n        node.end = Math.max(0, nodeEnd + deltaColumn);\r\n        endDone = true;\r\n    }\r\n    if (node.start > node.end) {\r\n        node.end = node.start;\r\n    }\r\n}\r\nfunction searchForEditing(T, start, end) {\r\n    // https://en.wikipedia.org/wiki/Interval_tree#Augmented_tree\r\n    // Now, it is known that two intervals A and B overlap only when both\r\n    // A.low <= B.high and A.high >= B.low. When searching the trees for\r\n    // nodes overlapping with a given interval, you can immediately skip:\r\n    //  a) all nodes to the right of nodes whose low value is past the end of the given interval.\r\n    //  b) all nodes that have their maximum 'high' value below the start of the given interval.\r\n    var node = T.root;\r\n    var delta = 0;\r\n    var nodeMaxEnd = 0;\r\n    var nodeStart = 0;\r\n    var nodeEnd = 0;\r\n    var result = [];\r\n    var resultLen = 0;\r\n    while (node !== SENTINEL) {\r\n        if (getNodeIsVisited(node)) {\r\n            // going up from this node\r\n            setNodeIsVisited(node.left, false);\r\n            setNodeIsVisited(node.right, false);\r\n            if (node === node.parent.right) {\r\n                delta -= node.parent.delta;\r\n            }\r\n            node = node.parent;\r\n            continue;\r\n        }\r\n        if (!getNodeIsVisited(node.left)) {\r\n            // first time seeing this node\r\n            nodeMaxEnd = delta + node.maxEnd;\r\n            if (nodeMaxEnd < start) {\r\n                // cover case b) from above\r\n                // there is no need to search this node or its children\r\n                setNodeIsVisited(node, true);\r\n                continue;\r\n            }\r\n            if (node.left !== SENTINEL) {\r\n                // go left\r\n                node = node.left;\r\n                continue;\r\n            }\r\n        }\r\n        // handle current node\r\n        nodeStart = delta + node.start;\r\n        if (nodeStart > end) {\r\n            // cover case a) from above\r\n            // there is no need to search this node or its right subtree\r\n            setNodeIsVisited(node, true);\r\n            continue;\r\n        }\r\n        nodeEnd = delta + node.end;\r\n        if (nodeEnd >= start) {\r\n            node.setCachedOffsets(nodeStart, nodeEnd, 0);\r\n            result[resultLen++] = node;\r\n        }\r\n        setNodeIsVisited(node, true);\r\n        if (node.right !== SENTINEL && !getNodeIsVisited(node.right)) {\r\n            // go right\r\n            delta += node.delta;\r\n            node = node.right;\r\n            continue;\r\n        }\r\n    }\r\n    setNodeIsVisited(T.root, false);\r\n    return result;\r\n}\r\nfunction noOverlapReplace(T, start, end, textLength) {\r\n    // https://en.wikipedia.org/wiki/Interval_tree#Augmented_tree\r\n    // Now, it is known that two intervals A and B overlap only when both\r\n    // A.low <= B.high and A.high >= B.low. When searching the trees for\r\n    // nodes overlapping with a given interval, you can immediately skip:\r\n    //  a) all nodes to the right of nodes whose low value is past the end of the given interval.\r\n    //  b) all nodes that have their maximum 'high' value below the start of the given interval.\r\n    var node = T.root;\r\n    var delta = 0;\r\n    var nodeMaxEnd = 0;\r\n    var nodeStart = 0;\r\n    var editDelta = (textLength - (end - start));\r\n    while (node !== SENTINEL) {\r\n        if (getNodeIsVisited(node)) {\r\n            // going up from this node\r\n            setNodeIsVisited(node.left, false);\r\n            setNodeIsVisited(node.right, false);\r\n            if (node === node.parent.right) {\r\n                delta -= node.parent.delta;\r\n            }\r\n            recomputeMaxEnd(node);\r\n            node = node.parent;\r\n            continue;\r\n        }\r\n        if (!getNodeIsVisited(node.left)) {\r\n            // first time seeing this node\r\n            nodeMaxEnd = delta + node.maxEnd;\r\n            if (nodeMaxEnd < start) {\r\n                // cover case b) from above\r\n                // there is no need to search this node or its children\r\n                setNodeIsVisited(node, true);\r\n                continue;\r\n            }\r\n            if (node.left !== SENTINEL) {\r\n                // go left\r\n                node = node.left;\r\n                continue;\r\n            }\r\n        }\r\n        // handle current node\r\n        nodeStart = delta + node.start;\r\n        if (nodeStart > end) {\r\n            node.start += editDelta;\r\n            node.end += editDelta;\r\n            node.delta += editDelta;\r\n            if (node.delta < -1073741824 /* MIN_SAFE_DELTA */ || node.delta > 1073741824 /* MAX_SAFE_DELTA */) {\r\n                T.requestNormalizeDelta = true;\r\n            }\r\n            // cover case a) from above\r\n            // there is no need to search this node or its right subtree\r\n            setNodeIsVisited(node, true);\r\n            continue;\r\n        }\r\n        setNodeIsVisited(node, true);\r\n        if (node.right !== SENTINEL && !getNodeIsVisited(node.right)) {\r\n            // go right\r\n            delta += node.delta;\r\n            node = node.right;\r\n            continue;\r\n        }\r\n    }\r\n    setNodeIsVisited(T.root, false);\r\n}\r\n//#endregion\r\n//#region Searching\r\nfunction collectNodesFromOwner(T, ownerId) {\r\n    var node = T.root;\r\n    var result = [];\r\n    var resultLen = 0;\r\n    while (node !== SENTINEL) {\r\n        if (getNodeIsVisited(node)) {\r\n            // going up from this node\r\n            setNodeIsVisited(node.left, false);\r\n            setNodeIsVisited(node.right, false);\r\n            node = node.parent;\r\n            continue;\r\n        }\r\n        if (node.left !== SENTINEL && !getNodeIsVisited(node.left)) {\r\n            // go left\r\n            node = node.left;\r\n            continue;\r\n        }\r\n        // handle current node\r\n        if (node.ownerId === ownerId) {\r\n            result[resultLen++] = node;\r\n        }\r\n        setNodeIsVisited(node, true);\r\n        if (node.right !== SENTINEL && !getNodeIsVisited(node.right)) {\r\n            // go right\r\n            node = node.right;\r\n            continue;\r\n        }\r\n    }\r\n    setNodeIsVisited(T.root, false);\r\n    return result;\r\n}\r\nfunction collectNodesPostOrder(T) {\r\n    var node = T.root;\r\n    var result = [];\r\n    var resultLen = 0;\r\n    while (node !== SENTINEL) {\r\n        if (getNodeIsVisited(node)) {\r\n            // going up from this node\r\n            setNodeIsVisited(node.left, false);\r\n            setNodeIsVisited(node.right, false);\r\n            node = node.parent;\r\n            continue;\r\n        }\r\n        if (node.left !== SENTINEL && !getNodeIsVisited(node.left)) {\r\n            // go left\r\n            node = node.left;\r\n            continue;\r\n        }\r\n        if (node.right !== SENTINEL && !getNodeIsVisited(node.right)) {\r\n            // go right\r\n            node = node.right;\r\n            continue;\r\n        }\r\n        // handle current node\r\n        result[resultLen++] = node;\r\n        setNodeIsVisited(node, true);\r\n    }\r\n    setNodeIsVisited(T.root, false);\r\n    return result;\r\n}\r\nfunction search(T, filterOwnerId, filterOutValidation, cachedVersionId) {\r\n    var node = T.root;\r\n    var delta = 0;\r\n    var nodeStart = 0;\r\n    var nodeEnd = 0;\r\n    var result = [];\r\n    var resultLen = 0;\r\n    while (node !== SENTINEL) {\r\n        if (getNodeIsVisited(node)) {\r\n            // going up from this node\r\n            setNodeIsVisited(node.left, false);\r\n            setNodeIsVisited(node.right, false);\r\n            if (node === node.parent.right) {\r\n                delta -= node.parent.delta;\r\n            }\r\n            node = node.parent;\r\n            continue;\r\n        }\r\n        if (node.left !== SENTINEL && !getNodeIsVisited(node.left)) {\r\n            // go left\r\n            node = node.left;\r\n            continue;\r\n        }\r\n        // handle current node\r\n        nodeStart = delta + node.start;\r\n        nodeEnd = delta + node.end;\r\n        node.setCachedOffsets(nodeStart, nodeEnd, cachedVersionId);\r\n        var include = true;\r\n        if (filterOwnerId && node.ownerId && node.ownerId !== filterOwnerId) {\r\n            include = false;\r\n        }\r\n        if (filterOutValidation && getNodeIsForValidation(node)) {\r\n            include = false;\r\n        }\r\n        if (include) {\r\n            result[resultLen++] = node;\r\n        }\r\n        setNodeIsVisited(node, true);\r\n        if (node.right !== SENTINEL && !getNodeIsVisited(node.right)) {\r\n            // go right\r\n            delta += node.delta;\r\n            node = node.right;\r\n            continue;\r\n        }\r\n    }\r\n    setNodeIsVisited(T.root, false);\r\n    return result;\r\n}\r\nfunction intervalSearch(T, intervalStart, intervalEnd, filterOwnerId, filterOutValidation, cachedVersionId) {\r\n    // https://en.wikipedia.org/wiki/Interval_tree#Augmented_tree\r\n    // Now, it is known that two intervals A and B overlap only when both\r\n    // A.low <= B.high and A.high >= B.low. When searching the trees for\r\n    // nodes overlapping with a given interval, you can immediately skip:\r\n    //  a) all nodes to the right of nodes whose low value is past the end of the given interval.\r\n    //  b) all nodes that have their maximum 'high' value below the start of the given interval.\r\n    var node = T.root;\r\n    var delta = 0;\r\n    var nodeMaxEnd = 0;\r\n    var nodeStart = 0;\r\n    var nodeEnd = 0;\r\n    var result = [];\r\n    var resultLen = 0;\r\n    while (node !== SENTINEL) {\r\n        if (getNodeIsVisited(node)) {\r\n            // going up from this node\r\n            setNodeIsVisited(node.left, false);\r\n            setNodeIsVisited(node.right, false);\r\n            if (node === node.parent.right) {\r\n                delta -= node.parent.delta;\r\n            }\r\n            node = node.parent;\r\n            continue;\r\n        }\r\n        if (!getNodeIsVisited(node.left)) {\r\n            // first time seeing this node\r\n            nodeMaxEnd = delta + node.maxEnd;\r\n            if (nodeMaxEnd < intervalStart) {\r\n                // cover case b) from above\r\n                // there is no need to search this node or its children\r\n                setNodeIsVisited(node, true);\r\n                continue;\r\n            }\r\n            if (node.left !== SENTINEL) {\r\n                // go left\r\n                node = node.left;\r\n                continue;\r\n            }\r\n        }\r\n        // handle current node\r\n        nodeStart = delta + node.start;\r\n        if (nodeStart > intervalEnd) {\r\n            // cover case a) from above\r\n            // there is no need to search this node or its right subtree\r\n            setNodeIsVisited(node, true);\r\n            continue;\r\n        }\r\n        nodeEnd = delta + node.end;\r\n        if (nodeEnd >= intervalStart) {\r\n            // There is overlap\r\n            node.setCachedOffsets(nodeStart, nodeEnd, cachedVersionId);\r\n            var include = true;\r\n            if (filterOwnerId && node.ownerId && node.ownerId !== filterOwnerId) {\r\n                include = false;\r\n            }\r\n            if (filterOutValidation && getNodeIsForValidation(node)) {\r\n                include = false;\r\n            }\r\n            if (include) {\r\n                result[resultLen++] = node;\r\n            }\r\n        }\r\n        setNodeIsVisited(node, true);\r\n        if (node.right !== SENTINEL && !getNodeIsVisited(node.right)) {\r\n            // go right\r\n            delta += node.delta;\r\n            node = node.right;\r\n            continue;\r\n        }\r\n    }\r\n    setNodeIsVisited(T.root, false);\r\n    return result;\r\n}\r\n//#endregion\r\n//#region Insertion\r\nfunction rbTreeInsert(T, newNode) {\r\n    if (T.root === SENTINEL) {\r\n        newNode.parent = SENTINEL;\r\n        newNode.left = SENTINEL;\r\n        newNode.right = SENTINEL;\r\n        setNodeColor(newNode, 0 /* Black */);\r\n        T.root = newNode;\r\n        return T.root;\r\n    }\r\n    treeInsert(T, newNode);\r\n    recomputeMaxEndWalkToRoot(newNode.parent);\r\n    // repair tree\r\n    var x = newNode;\r\n    while (x !== T.root && getNodeColor(x.parent) === 1 /* Red */) {\r\n        if (x.parent === x.parent.parent.left) {\r\n            var y = x.parent.parent.right;\r\n            if (getNodeColor(y) === 1 /* Red */) {\r\n                setNodeColor(x.parent, 0 /* Black */);\r\n                setNodeColor(y, 0 /* Black */);\r\n                setNodeColor(x.parent.parent, 1 /* Red */);\r\n                x = x.parent.parent;\r\n            }\r\n            else {\r\n                if (x === x.parent.right) {\r\n                    x = x.parent;\r\n                    leftRotate(T, x);\r\n                }\r\n                setNodeColor(x.parent, 0 /* Black */);\r\n                setNodeColor(x.parent.parent, 1 /* Red */);\r\n                rightRotate(T, x.parent.parent);\r\n            }\r\n        }\r\n        else {\r\n            var y = x.parent.parent.left;\r\n            if (getNodeColor(y) === 1 /* Red */) {\r\n                setNodeColor(x.parent, 0 /* Black */);\r\n                setNodeColor(y, 0 /* Black */);\r\n                setNodeColor(x.parent.parent, 1 /* Red */);\r\n                x = x.parent.parent;\r\n            }\r\n            else {\r\n                if (x === x.parent.left) {\r\n                    x = x.parent;\r\n                    rightRotate(T, x);\r\n                }\r\n                setNodeColor(x.parent, 0 /* Black */);\r\n                setNodeColor(x.parent.parent, 1 /* Red */);\r\n                leftRotate(T, x.parent.parent);\r\n            }\r\n        }\r\n    }\r\n    setNodeColor(T.root, 0 /* Black */);\r\n    return newNode;\r\n}\r\nfunction treeInsert(T, z) {\r\n    var delta = 0;\r\n    var x = T.root;\r\n    var zAbsoluteStart = z.start;\r\n    var zAbsoluteEnd = z.end;\r\n    while (true) {\r\n        var cmp = intervalCompare(zAbsoluteStart, zAbsoluteEnd, x.start + delta, x.end + delta);\r\n        if (cmp < 0) {\r\n            // this node should be inserted to the left\r\n            // => it is not affected by the node's delta\r\n            if (x.left === SENTINEL) {\r\n                z.start -= delta;\r\n                z.end -= delta;\r\n                z.maxEnd -= delta;\r\n                x.left = z;\r\n                break;\r\n            }\r\n            else {\r\n                x = x.left;\r\n            }\r\n        }\r\n        else {\r\n            // this node should be inserted to the right\r\n            // => it is not affected by the node's delta\r\n            if (x.right === SENTINEL) {\r\n                z.start -= (delta + x.delta);\r\n                z.end -= (delta + x.delta);\r\n                z.maxEnd -= (delta + x.delta);\r\n                x.right = z;\r\n                break;\r\n            }\r\n            else {\r\n                delta += x.delta;\r\n                x = x.right;\r\n            }\r\n        }\r\n    }\r\n    z.parent = x;\r\n    z.left = SENTINEL;\r\n    z.right = SENTINEL;\r\n    setNodeColor(z, 1 /* Red */);\r\n}\r\n//#endregion\r\n//#region Deletion\r\nfunction rbTreeDelete(T, z) {\r\n    var x;\r\n    var y;\r\n    // RB-DELETE except we don't swap z and y in case c)\r\n    // i.e. we always delete what's pointed at by z.\r\n    if (z.left === SENTINEL) {\r\n        x = z.right;\r\n        y = z;\r\n        // x's delta is no longer influenced by z's delta\r\n        x.delta += z.delta;\r\n        if (x.delta < -1073741824 /* MIN_SAFE_DELTA */ || x.delta > 1073741824 /* MAX_SAFE_DELTA */) {\r\n            T.requestNormalizeDelta = true;\r\n        }\r\n        x.start += z.delta;\r\n        x.end += z.delta;\r\n    }\r\n    else if (z.right === SENTINEL) {\r\n        x = z.left;\r\n        y = z;\r\n    }\r\n    else {\r\n        y = leftest(z.right);\r\n        x = y.right;\r\n        // y's delta is no longer influenced by z's delta,\r\n        // but we don't want to walk the entire right-hand-side subtree of x.\r\n        // we therefore maintain z's delta in y, and adjust only x\r\n        x.start += y.delta;\r\n        x.end += y.delta;\r\n        x.delta += y.delta;\r\n        if (x.delta < -1073741824 /* MIN_SAFE_DELTA */ || x.delta > 1073741824 /* MAX_SAFE_DELTA */) {\r\n            T.requestNormalizeDelta = true;\r\n        }\r\n        y.start += z.delta;\r\n        y.end += z.delta;\r\n        y.delta = z.delta;\r\n        if (y.delta < -1073741824 /* MIN_SAFE_DELTA */ || y.delta > 1073741824 /* MAX_SAFE_DELTA */) {\r\n            T.requestNormalizeDelta = true;\r\n        }\r\n    }\r\n    if (y === T.root) {\r\n        T.root = x;\r\n        setNodeColor(x, 0 /* Black */);\r\n        z.detach();\r\n        resetSentinel();\r\n        recomputeMaxEnd(x);\r\n        T.root.parent = SENTINEL;\r\n        return;\r\n    }\r\n    var yWasRed = (getNodeColor(y) === 1 /* Red */);\r\n    if (y === y.parent.left) {\r\n        y.parent.left = x;\r\n    }\r\n    else {\r\n        y.parent.right = x;\r\n    }\r\n    if (y === z) {\r\n        x.parent = y.parent;\r\n    }\r\n    else {\r\n        if (y.parent === z) {\r\n            x.parent = y;\r\n        }\r\n        else {\r\n            x.parent = y.parent;\r\n        }\r\n        y.left = z.left;\r\n        y.right = z.right;\r\n        y.parent = z.parent;\r\n        setNodeColor(y, getNodeColor(z));\r\n        if (z === T.root) {\r\n            T.root = y;\r\n        }\r\n        else {\r\n            if (z === z.parent.left) {\r\n                z.parent.left = y;\r\n            }\r\n            else {\r\n                z.parent.right = y;\r\n            }\r\n        }\r\n        if (y.left !== SENTINEL) {\r\n            y.left.parent = y;\r\n        }\r\n        if (y.right !== SENTINEL) {\r\n            y.right.parent = y;\r\n        }\r\n    }\r\n    z.detach();\r\n    if (yWasRed) {\r\n        recomputeMaxEndWalkToRoot(x.parent);\r\n        if (y !== z) {\r\n            recomputeMaxEndWalkToRoot(y);\r\n            recomputeMaxEndWalkToRoot(y.parent);\r\n        }\r\n        resetSentinel();\r\n        return;\r\n    }\r\n    recomputeMaxEndWalkToRoot(x);\r\n    recomputeMaxEndWalkToRoot(x.parent);\r\n    if (y !== z) {\r\n        recomputeMaxEndWalkToRoot(y);\r\n        recomputeMaxEndWalkToRoot(y.parent);\r\n    }\r\n    // RB-DELETE-FIXUP\r\n    var w;\r\n    while (x !== T.root && getNodeColor(x) === 0 /* Black */) {\r\n        if (x === x.parent.left) {\r\n            w = x.parent.right;\r\n            if (getNodeColor(w) === 1 /* Red */) {\r\n                setNodeColor(w, 0 /* Black */);\r\n                setNodeColor(x.parent, 1 /* Red */);\r\n                leftRotate(T, x.parent);\r\n                w = x.parent.right;\r\n            }\r\n            if (getNodeColor(w.left) === 0 /* Black */ && getNodeColor(w.right) === 0 /* Black */) {\r\n                setNodeColor(w, 1 /* Red */);\r\n                x = x.parent;\r\n            }\r\n            else {\r\n                if (getNodeColor(w.right) === 0 /* Black */) {\r\n                    setNodeColor(w.left, 0 /* Black */);\r\n                    setNodeColor(w, 1 /* Red */);\r\n                    rightRotate(T, w);\r\n                    w = x.parent.right;\r\n                }\r\n                setNodeColor(w, getNodeColor(x.parent));\r\n                setNodeColor(x.parent, 0 /* Black */);\r\n                setNodeColor(w.right, 0 /* Black */);\r\n                leftRotate(T, x.parent);\r\n                x = T.root;\r\n            }\r\n        }\r\n        else {\r\n            w = x.parent.left;\r\n            if (getNodeColor(w) === 1 /* Red */) {\r\n                setNodeColor(w, 0 /* Black */);\r\n                setNodeColor(x.parent, 1 /* Red */);\r\n                rightRotate(T, x.parent);\r\n                w = x.parent.left;\r\n            }\r\n            if (getNodeColor(w.left) === 0 /* Black */ && getNodeColor(w.right) === 0 /* Black */) {\r\n                setNodeColor(w, 1 /* Red */);\r\n                x = x.parent;\r\n            }\r\n            else {\r\n                if (getNodeColor(w.left) === 0 /* Black */) {\r\n                    setNodeColor(w.right, 0 /* Black */);\r\n                    setNodeColor(w, 1 /* Red */);\r\n                    leftRotate(T, w);\r\n                    w = x.parent.left;\r\n                }\r\n                setNodeColor(w, getNodeColor(x.parent));\r\n                setNodeColor(x.parent, 0 /* Black */);\r\n                setNodeColor(w.left, 0 /* Black */);\r\n                rightRotate(T, x.parent);\r\n                x = T.root;\r\n            }\r\n        }\r\n    }\r\n    setNodeColor(x, 0 /* Black */);\r\n    resetSentinel();\r\n}\r\nfunction leftest(node) {\r\n    while (node.left !== SENTINEL) {\r\n        node = node.left;\r\n    }\r\n    return node;\r\n}\r\nfunction resetSentinel() {\r\n    SENTINEL.parent = SENTINEL;\r\n    SENTINEL.delta = 0; // optional\r\n    SENTINEL.start = 0; // optional\r\n    SENTINEL.end = 0; // optional\r\n}\r\n//#endregion\r\n//#region Rotations\r\nfunction leftRotate(T, x) {\r\n    var y = x.right; // set y.\r\n    y.delta += x.delta; // y's delta is no longer influenced by x's delta\r\n    if (y.delta < -1073741824 /* MIN_SAFE_DELTA */ || y.delta > 1073741824 /* MAX_SAFE_DELTA */) {\r\n        T.requestNormalizeDelta = true;\r\n    }\r\n    y.start += x.delta;\r\n    y.end += x.delta;\r\n    x.right = y.left; // turn y's left subtree into x's right subtree.\r\n    if (y.left !== SENTINEL) {\r\n        y.left.parent = x;\r\n    }\r\n    y.parent = x.parent; // link x's parent to y.\r\n    if (x.parent === SENTINEL) {\r\n        T.root = y;\r\n    }\r\n    else if (x === x.parent.left) {\r\n        x.parent.left = y;\r\n    }\r\n    else {\r\n        x.parent.right = y;\r\n    }\r\n    y.left = x; // put x on y's left.\r\n    x.parent = y;\r\n    recomputeMaxEnd(x);\r\n    recomputeMaxEnd(y);\r\n}\r\nfunction rightRotate(T, y) {\r\n    var x = y.left;\r\n    y.delta -= x.delta;\r\n    if (y.delta < -1073741824 /* MIN_SAFE_DELTA */ || y.delta > 1073741824 /* MAX_SAFE_DELTA */) {\r\n        T.requestNormalizeDelta = true;\r\n    }\r\n    y.start -= x.delta;\r\n    y.end -= x.delta;\r\n    y.left = x.right;\r\n    if (x.right !== SENTINEL) {\r\n        x.right.parent = y;\r\n    }\r\n    x.parent = y.parent;\r\n    if (y.parent === SENTINEL) {\r\n        T.root = x;\r\n    }\r\n    else if (y === y.parent.right) {\r\n        y.parent.right = x;\r\n    }\r\n    else {\r\n        y.parent.left = x;\r\n    }\r\n    x.right = y;\r\n    y.parent = x;\r\n    recomputeMaxEnd(y);\r\n    recomputeMaxEnd(x);\r\n}\r\n//#endregion\r\n//#region max end computation\r\nfunction computeMaxEnd(node) {\r\n    var maxEnd = node.end;\r\n    if (node.left !== SENTINEL) {\r\n        var leftMaxEnd = node.left.maxEnd;\r\n        if (leftMaxEnd > maxEnd) {\r\n            maxEnd = leftMaxEnd;\r\n        }\r\n    }\r\n    if (node.right !== SENTINEL) {\r\n        var rightMaxEnd = node.right.maxEnd + node.delta;\r\n        if (rightMaxEnd > maxEnd) {\r\n            maxEnd = rightMaxEnd;\r\n        }\r\n    }\r\n    return maxEnd;\r\n}\r\nexport function recomputeMaxEnd(node) {\r\n    node.maxEnd = computeMaxEnd(node);\r\n}\r\nfunction recomputeMaxEndWalkToRoot(node) {\r\n    while (node !== SENTINEL) {\r\n        var maxEnd = computeMaxEnd(node);\r\n        if (node.maxEnd === maxEnd) {\r\n            // no need to go further\r\n            return;\r\n        }\r\n        node.maxEnd = maxEnd;\r\n        node = node.parent;\r\n    }\r\n}\r\n//#endregion\r\n//#region utils\r\nexport function intervalCompare(aStart, aEnd, bStart, bEnd) {\r\n    if (aStart === bStart) {\r\n        return aEnd - bEnd;\r\n    }\r\n    return aStart - bStart;\r\n}\r\n//#endregion\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar TreeNode = /** @class */ (function () {\r\n    function TreeNode(piece, color) {\r\n        this.piece = piece;\r\n        this.color = color;\r\n        this.size_left = 0;\r\n        this.lf_left = 0;\r\n        this.parent = this;\r\n        this.left = this;\r\n        this.right = this;\r\n    }\r\n    TreeNode.prototype.next = function () {\r\n        if (this.right !== SENTINEL) {\r\n            return leftest(this.right);\r\n        }\r\n        var node = this;\r\n        while (node.parent !== SENTINEL) {\r\n            if (node.parent.left === node) {\r\n                break;\r\n            }\r\n            node = node.parent;\r\n        }\r\n        if (node.parent === SENTINEL) {\r\n            return SENTINEL;\r\n        }\r\n        else {\r\n            return node.parent;\r\n        }\r\n    };\r\n    TreeNode.prototype.prev = function () {\r\n        if (this.left !== SENTINEL) {\r\n            return righttest(this.left);\r\n        }\r\n        var node = this;\r\n        while (node.parent !== SENTINEL) {\r\n            if (node.parent.right === node) {\r\n                break;\r\n            }\r\n            node = node.parent;\r\n        }\r\n        if (node.parent === SENTINEL) {\r\n            return SENTINEL;\r\n        }\r\n        else {\r\n            return node.parent;\r\n        }\r\n    };\r\n    TreeNode.prototype.detach = function () {\r\n        this.parent = null;\r\n        this.left = null;\r\n        this.right = null;\r\n    };\r\n    return TreeNode;\r\n}());\r\nexport { TreeNode };\r\nexport var SENTINEL = new TreeNode(null, 0 /* Black */);\r\nSENTINEL.parent = SENTINEL;\r\nSENTINEL.left = SENTINEL;\r\nSENTINEL.right = SENTINEL;\r\nSENTINEL.color = 0 /* Black */;\r\nexport function leftest(node) {\r\n    while (node.left !== SENTINEL) {\r\n        node = node.left;\r\n    }\r\n    return node;\r\n}\r\nexport function righttest(node) {\r\n    while (node.right !== SENTINEL) {\r\n        node = node.right;\r\n    }\r\n    return node;\r\n}\r\nexport function calculateSize(node) {\r\n    if (node === SENTINEL) {\r\n        return 0;\r\n    }\r\n    return node.size_left + node.piece.length + calculateSize(node.right);\r\n}\r\nexport function calculateLF(node) {\r\n    if (node === SENTINEL) {\r\n        return 0;\r\n    }\r\n    return node.lf_left + node.piece.lineFeedCnt + calculateLF(node.right);\r\n}\r\nexport function resetSentinel() {\r\n    SENTINEL.parent = SENTINEL;\r\n}\r\nexport function leftRotate(tree, x) {\r\n    var y = x.right;\r\n    // fix size_left\r\n    y.size_left += x.size_left + (x.piece ? x.piece.length : 0);\r\n    y.lf_left += x.lf_left + (x.piece ? x.piece.lineFeedCnt : 0);\r\n    x.right = y.left;\r\n    if (y.left !== SENTINEL) {\r\n        y.left.parent = x;\r\n    }\r\n    y.parent = x.parent;\r\n    if (x.parent === SENTINEL) {\r\n        tree.root = y;\r\n    }\r\n    else if (x.parent.left === x) {\r\n        x.parent.left = y;\r\n    }\r\n    else {\r\n        x.parent.right = y;\r\n    }\r\n    y.left = x;\r\n    x.parent = y;\r\n}\r\nexport function rightRotate(tree, y) {\r\n    var x = y.left;\r\n    y.left = x.right;\r\n    if (x.right !== SENTINEL) {\r\n        x.right.parent = y;\r\n    }\r\n    x.parent = y.parent;\r\n    // fix size_left\r\n    y.size_left -= x.size_left + (x.piece ? x.piece.length : 0);\r\n    y.lf_left -= x.lf_left + (x.piece ? x.piece.lineFeedCnt : 0);\r\n    if (y.parent === SENTINEL) {\r\n        tree.root = x;\r\n    }\r\n    else if (y === y.parent.right) {\r\n        y.parent.right = x;\r\n    }\r\n    else {\r\n        y.parent.left = x;\r\n    }\r\n    x.right = y;\r\n    y.parent = x;\r\n}\r\nexport function rbDelete(tree, z) {\r\n    var x;\r\n    var y;\r\n    if (z.left === SENTINEL) {\r\n        y = z;\r\n        x = y.right;\r\n    }\r\n    else if (z.right === SENTINEL) {\r\n        y = z;\r\n        x = y.left;\r\n    }\r\n    else {\r\n        y = leftest(z.right);\r\n        x = y.right;\r\n    }\r\n    if (y === tree.root) {\r\n        tree.root = x;\r\n        // if x is null, we are removing the only node\r\n        x.color = 0 /* Black */;\r\n        z.detach();\r\n        resetSentinel();\r\n        tree.root.parent = SENTINEL;\r\n        return;\r\n    }\r\n    var yWasRed = (y.color === 1 /* Red */);\r\n    if (y === y.parent.left) {\r\n        y.parent.left = x;\r\n    }\r\n    else {\r\n        y.parent.right = x;\r\n    }\r\n    if (y === z) {\r\n        x.parent = y.parent;\r\n        recomputeTreeMetadata(tree, x);\r\n    }\r\n    else {\r\n        if (y.parent === z) {\r\n            x.parent = y;\r\n        }\r\n        else {\r\n            x.parent = y.parent;\r\n        }\r\n        // as we make changes to x's hierarchy, update size_left of subtree first\r\n        recomputeTreeMetadata(tree, x);\r\n        y.left = z.left;\r\n        y.right = z.right;\r\n        y.parent = z.parent;\r\n        y.color = z.color;\r\n        if (z === tree.root) {\r\n            tree.root = y;\r\n        }\r\n        else {\r\n            if (z === z.parent.left) {\r\n                z.parent.left = y;\r\n            }\r\n            else {\r\n                z.parent.right = y;\r\n            }\r\n        }\r\n        if (y.left !== SENTINEL) {\r\n            y.left.parent = y;\r\n        }\r\n        if (y.right !== SENTINEL) {\r\n            y.right.parent = y;\r\n        }\r\n        // update metadata\r\n        // we replace z with y, so in this sub tree, the length change is z.item.length\r\n        y.size_left = z.size_left;\r\n        y.lf_left = z.lf_left;\r\n        recomputeTreeMetadata(tree, y);\r\n    }\r\n    z.detach();\r\n    if (x.parent.left === x) {\r\n        var newSizeLeft = calculateSize(x);\r\n        var newLFLeft = calculateLF(x);\r\n        if (newSizeLeft !== x.parent.size_left || newLFLeft !== x.parent.lf_left) {\r\n            var delta = newSizeLeft - x.parent.size_left;\r\n            var lf_delta = newLFLeft - x.parent.lf_left;\r\n            x.parent.size_left = newSizeLeft;\r\n            x.parent.lf_left = newLFLeft;\r\n            updateTreeMetadata(tree, x.parent, delta, lf_delta);\r\n        }\r\n    }\r\n    recomputeTreeMetadata(tree, x.parent);\r\n    if (yWasRed) {\r\n        resetSentinel();\r\n        return;\r\n    }\r\n    // RB-DELETE-FIXUP\r\n    var w;\r\n    while (x !== tree.root && x.color === 0 /* Black */) {\r\n        if (x === x.parent.left) {\r\n            w = x.parent.right;\r\n            if (w.color === 1 /* Red */) {\r\n                w.color = 0 /* Black */;\r\n                x.parent.color = 1 /* Red */;\r\n                leftRotate(tree, x.parent);\r\n                w = x.parent.right;\r\n            }\r\n            if (w.left.color === 0 /* Black */ && w.right.color === 0 /* Black */) {\r\n                w.color = 1 /* Red */;\r\n                x = x.parent;\r\n            }\r\n            else {\r\n                if (w.right.color === 0 /* Black */) {\r\n                    w.left.color = 0 /* Black */;\r\n                    w.color = 1 /* Red */;\r\n                    rightRotate(tree, w);\r\n                    w = x.parent.right;\r\n                }\r\n                w.color = x.parent.color;\r\n                x.parent.color = 0 /* Black */;\r\n                w.right.color = 0 /* Black */;\r\n                leftRotate(tree, x.parent);\r\n                x = tree.root;\r\n            }\r\n        }\r\n        else {\r\n            w = x.parent.left;\r\n            if (w.color === 1 /* Red */) {\r\n                w.color = 0 /* Black */;\r\n                x.parent.color = 1 /* Red */;\r\n                rightRotate(tree, x.parent);\r\n                w = x.parent.left;\r\n            }\r\n            if (w.left.color === 0 /* Black */ && w.right.color === 0 /* Black */) {\r\n                w.color = 1 /* Red */;\r\n                x = x.parent;\r\n            }\r\n            else {\r\n                if (w.left.color === 0 /* Black */) {\r\n                    w.right.color = 0 /* Black */;\r\n                    w.color = 1 /* Red */;\r\n                    leftRotate(tree, w);\r\n                    w = x.parent.left;\r\n                }\r\n                w.color = x.parent.color;\r\n                x.parent.color = 0 /* Black */;\r\n                w.left.color = 0 /* Black */;\r\n                rightRotate(tree, x.parent);\r\n                x = tree.root;\r\n            }\r\n        }\r\n    }\r\n    x.color = 0 /* Black */;\r\n    resetSentinel();\r\n}\r\nexport function fixInsert(tree, x) {\r\n    recomputeTreeMetadata(tree, x);\r\n    while (x !== tree.root && x.parent.color === 1 /* Red */) {\r\n        if (x.parent === x.parent.parent.left) {\r\n            var y = x.parent.parent.right;\r\n            if (y.color === 1 /* Red */) {\r\n                x.parent.color = 0 /* Black */;\r\n                y.color = 0 /* Black */;\r\n                x.parent.parent.color = 1 /* Red */;\r\n                x = x.parent.parent;\r\n            }\r\n            else {\r\n                if (x === x.parent.right) {\r\n                    x = x.parent;\r\n                    leftRotate(tree, x);\r\n                }\r\n                x.parent.color = 0 /* Black */;\r\n                x.parent.parent.color = 1 /* Red */;\r\n                rightRotate(tree, x.parent.parent);\r\n            }\r\n        }\r\n        else {\r\n            var y = x.parent.parent.left;\r\n            if (y.color === 1 /* Red */) {\r\n                x.parent.color = 0 /* Black */;\r\n                y.color = 0 /* Black */;\r\n                x.parent.parent.color = 1 /* Red */;\r\n                x = x.parent.parent;\r\n            }\r\n            else {\r\n                if (x === x.parent.left) {\r\n                    x = x.parent;\r\n                    rightRotate(tree, x);\r\n                }\r\n                x.parent.color = 0 /* Black */;\r\n                x.parent.parent.color = 1 /* Red */;\r\n                leftRotate(tree, x.parent.parent);\r\n            }\r\n        }\r\n    }\r\n    tree.root.color = 0 /* Black */;\r\n}\r\nexport function updateTreeMetadata(tree, x, delta, lineFeedCntDelta) {\r\n    // node length change or line feed count change\r\n    while (x !== tree.root && x !== SENTINEL) {\r\n        if (x.parent.left === x) {\r\n            x.parent.size_left += delta;\r\n            x.parent.lf_left += lineFeedCntDelta;\r\n        }\r\n        x = x.parent;\r\n    }\r\n}\r\nexport function recomputeTreeMetadata(tree, x) {\r\n    var delta = 0;\r\n    var lf_delta = 0;\r\n    if (x === tree.root) {\r\n        return;\r\n    }\r\n    if (delta === 0) {\r\n        // go upwards till the node whose left subtree is changed.\r\n        while (x !== tree.root && x === x.parent.right) {\r\n            x = x.parent;\r\n        }\r\n        if (x === tree.root) {\r\n            // well, it means we add a node to the end (inorder)\r\n            return;\r\n        }\r\n        // x is the node whose right subtree is changed.\r\n        x = x.parent;\r\n        delta = calculateSize(x.left) - x.size_left;\r\n        lf_delta = calculateLF(x.left) - x.lf_left;\r\n        x.size_left += delta;\r\n        x.lf_left += lf_delta;\r\n    }\r\n    // go upwards till root. O(logN)\r\n    while (x !== tree.root && (delta !== 0 || lf_delta !== 0)) {\r\n        if (x.parent.left === x) {\r\n            x.parent.size_left += delta;\r\n            x.parent.lf_left += lf_delta;\r\n        }\r\n        x = x.parent;\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { getMapForWordSeparators } from '../controller/wordCharacterClassifier.js';\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nimport { FindMatch } from '../model.js';\r\nvar LIMIT_FIND_COUNT = 999;\r\nvar SearchParams = /** @class */ (function () {\r\n    function SearchParams(searchString, isRegex, matchCase, wordSeparators) {\r\n        this.searchString = searchString;\r\n        this.isRegex = isRegex;\r\n        this.matchCase = matchCase;\r\n        this.wordSeparators = wordSeparators;\r\n    }\r\n    SearchParams.prototype.parseSearchRequest = function () {\r\n        if (this.searchString === '') {\r\n            return null;\r\n        }\r\n        // Try to create a RegExp out of the params\r\n        var multiline;\r\n        if (this.isRegex) {\r\n            multiline = isMultilineRegexSource(this.searchString);\r\n        }\r\n        else {\r\n            multiline = (this.searchString.indexOf('\\n') >= 0);\r\n        }\r\n        var regex = null;\r\n        try {\r\n            regex = strings.createRegExp(this.searchString, this.isRegex, {\r\n                matchCase: this.matchCase,\r\n                wholeWord: false,\r\n                multiline: multiline,\r\n                global: true\r\n            });\r\n        }\r\n        catch (err) {\r\n            return null;\r\n        }\r\n        if (!regex) {\r\n            return null;\r\n        }\r\n        var canUseSimpleSearch = (!this.isRegex && !multiline);\r\n        if (canUseSimpleSearch && this.searchString.toLowerCase() !== this.searchString.toUpperCase()) {\r\n            // casing might make a difference\r\n            canUseSimpleSearch = this.matchCase;\r\n        }\r\n        return new SearchData(regex, this.wordSeparators ? getMapForWordSeparators(this.wordSeparators) : null, canUseSimpleSearch ? this.searchString : null);\r\n    };\r\n    return SearchParams;\r\n}());\r\nexport { SearchParams };\r\nexport function isMultilineRegexSource(searchString) {\r\n    if (!searchString || searchString.length === 0) {\r\n        return false;\r\n    }\r\n    for (var i = 0, len = searchString.length; i < len; i++) {\r\n        var chCode = searchString.charCodeAt(i);\r\n        if (chCode === 92 /* Backslash */) {\r\n            // move to next char\r\n            i++;\r\n            if (i >= len) {\r\n                // string ends with a \\\r\n                break;\r\n            }\r\n            var nextChCode = searchString.charCodeAt(i);\r\n            if (nextChCode === 110 /* n */ || nextChCode === 114 /* r */ || nextChCode === 87 /* W */) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\nvar SearchData = /** @class */ (function () {\r\n    function SearchData(regex, wordSeparators, simpleSearch) {\r\n        this.regex = regex;\r\n        this.wordSeparators = wordSeparators;\r\n        this.simpleSearch = simpleSearch;\r\n    }\r\n    return SearchData;\r\n}());\r\nexport { SearchData };\r\nexport function createFindMatch(range, rawMatches, captureMatches) {\r\n    if (!captureMatches) {\r\n        return new FindMatch(range, null);\r\n    }\r\n    var matches = [];\r\n    for (var i = 0, len = rawMatches.length; i < len; i++) {\r\n        matches[i] = rawMatches[i];\r\n    }\r\n    return new FindMatch(range, matches);\r\n}\r\nvar LineFeedCounter = /** @class */ (function () {\r\n    function LineFeedCounter(text) {\r\n        var lineFeedsOffsets = [];\r\n        var lineFeedsOffsetsLen = 0;\r\n        for (var i = 0, textLen = text.length; i < textLen; i++) {\r\n            if (text.charCodeAt(i) === 10 /* LineFeed */) {\r\n                lineFeedsOffsets[lineFeedsOffsetsLen++] = i;\r\n            }\r\n        }\r\n        this._lineFeedsOffsets = lineFeedsOffsets;\r\n    }\r\n    LineFeedCounter.prototype.findLineFeedCountBeforeOffset = function (offset) {\r\n        var lineFeedsOffsets = this._lineFeedsOffsets;\r\n        var min = 0;\r\n        var max = lineFeedsOffsets.length - 1;\r\n        if (max === -1) {\r\n            // no line feeds\r\n            return 0;\r\n        }\r\n        if (offset <= lineFeedsOffsets[0]) {\r\n            // before first line feed\r\n            return 0;\r\n        }\r\n        while (min < max) {\r\n            var mid = min + ((max - min) / 2 >> 0);\r\n            if (lineFeedsOffsets[mid] >= offset) {\r\n                max = mid - 1;\r\n            }\r\n            else {\r\n                if (lineFeedsOffsets[mid + 1] >= offset) {\r\n                    // bingo!\r\n                    min = mid;\r\n                    max = mid;\r\n                }\r\n                else {\r\n                    min = mid + 1;\r\n                }\r\n            }\r\n        }\r\n        return min + 1;\r\n    };\r\n    return LineFeedCounter;\r\n}());\r\nvar TextModelSearch = /** @class */ (function () {\r\n    function TextModelSearch() {\r\n    }\r\n    TextModelSearch.findMatches = function (model, searchParams, searchRange, captureMatches, limitResultCount) {\r\n        var searchData = searchParams.parseSearchRequest();\r\n        if (!searchData) {\r\n            return [];\r\n        }\r\n        if (searchData.regex.multiline) {\r\n            return this._doFindMatchesMultiline(model, searchRange, new Searcher(searchData.wordSeparators, searchData.regex), captureMatches, limitResultCount);\r\n        }\r\n        return this._doFindMatchesLineByLine(model, searchRange, searchData, captureMatches, limitResultCount);\r\n    };\r\n    /**\r\n     * Multiline search always executes on the lines concatenated with \\n.\r\n     * We must therefore compensate for the count of \\n in case the model is CRLF\r\n     */\r\n    TextModelSearch._getMultilineMatchRange = function (model, deltaOffset, text, lfCounter, matchIndex, match0) {\r\n        var startOffset;\r\n        var lineFeedCountBeforeMatch = 0;\r\n        if (lfCounter) {\r\n            lineFeedCountBeforeMatch = lfCounter.findLineFeedCountBeforeOffset(matchIndex);\r\n            startOffset = deltaOffset + matchIndex + lineFeedCountBeforeMatch /* add as many \\r as there were \\n */;\r\n        }\r\n        else {\r\n            startOffset = deltaOffset + matchIndex;\r\n        }\r\n        var endOffset;\r\n        if (lfCounter) {\r\n            var lineFeedCountBeforeEndOfMatch = lfCounter.findLineFeedCountBeforeOffset(matchIndex + match0.length);\r\n            var lineFeedCountInMatch = lineFeedCountBeforeEndOfMatch - lineFeedCountBeforeMatch;\r\n            endOffset = startOffset + match0.length + lineFeedCountInMatch /* add as many \\r as there were \\n */;\r\n        }\r\n        else {\r\n            endOffset = startOffset + match0.length;\r\n        }\r\n        var startPosition = model.getPositionAt(startOffset);\r\n        var endPosition = model.getPositionAt(endOffset);\r\n        return new Range(startPosition.lineNumber, startPosition.column, endPosition.lineNumber, endPosition.column);\r\n    };\r\n    TextModelSearch._doFindMatchesMultiline = function (model, searchRange, searcher, captureMatches, limitResultCount) {\r\n        var deltaOffset = model.getOffsetAt(searchRange.getStartPosition());\r\n        // We always execute multiline search over the lines joined with \\n\r\n        // This makes it that \\n will match the EOL for both CRLF and LF models\r\n        // We compensate for offset errors in `_getMultilineMatchRange`\r\n        var text = model.getValueInRange(searchRange, 1 /* LF */);\r\n        var lfCounter = (model.getEOL() === '\\r\\n' ? new LineFeedCounter(text) : null);\r\n        var result = [];\r\n        var counter = 0;\r\n        var m;\r\n        searcher.reset(0);\r\n        while ((m = searcher.next(text))) {\r\n            result[counter++] = createFindMatch(this._getMultilineMatchRange(model, deltaOffset, text, lfCounter, m.index, m[0]), m, captureMatches);\r\n            if (counter >= limitResultCount) {\r\n                return result;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    TextModelSearch._doFindMatchesLineByLine = function (model, searchRange, searchData, captureMatches, limitResultCount) {\r\n        var result = [];\r\n        var resultLen = 0;\r\n        // Early case for a search range that starts & stops on the same line number\r\n        if (searchRange.startLineNumber === searchRange.endLineNumber) {\r\n            var text_1 = model.getLineContent(searchRange.startLineNumber).substring(searchRange.startColumn - 1, searchRange.endColumn - 1);\r\n            resultLen = this._findMatchesInLine(searchData, text_1, searchRange.startLineNumber, searchRange.startColumn - 1, resultLen, result, captureMatches, limitResultCount);\r\n            return result;\r\n        }\r\n        // Collect results from first line\r\n        var text = model.getLineContent(searchRange.startLineNumber).substring(searchRange.startColumn - 1);\r\n        resultLen = this._findMatchesInLine(searchData, text, searchRange.startLineNumber, searchRange.startColumn - 1, resultLen, result, captureMatches, limitResultCount);\r\n        // Collect results from middle lines\r\n        for (var lineNumber = searchRange.startLineNumber + 1; lineNumber < searchRange.endLineNumber && resultLen < limitResultCount; lineNumber++) {\r\n            resultLen = this._findMatchesInLine(searchData, model.getLineContent(lineNumber), lineNumber, 0, resultLen, result, captureMatches, limitResultCount);\r\n        }\r\n        // Collect results from last line\r\n        if (resultLen < limitResultCount) {\r\n            var text_2 = model.getLineContent(searchRange.endLineNumber).substring(0, searchRange.endColumn - 1);\r\n            resultLen = this._findMatchesInLine(searchData, text_2, searchRange.endLineNumber, 0, resultLen, result, captureMatches, limitResultCount);\r\n        }\r\n        return result;\r\n    };\r\n    TextModelSearch._findMatchesInLine = function (searchData, text, lineNumber, deltaOffset, resultLen, result, captureMatches, limitResultCount) {\r\n        var wordSeparators = searchData.wordSeparators;\r\n        if (!captureMatches && searchData.simpleSearch) {\r\n            var searchString = searchData.simpleSearch;\r\n            var searchStringLen = searchString.length;\r\n            var textLength = text.length;\r\n            var lastMatchIndex = -searchStringLen;\r\n            while ((lastMatchIndex = text.indexOf(searchString, lastMatchIndex + searchStringLen)) !== -1) {\r\n                if (!wordSeparators || isValidMatch(wordSeparators, text, textLength, lastMatchIndex, searchStringLen)) {\r\n                    result[resultLen++] = new FindMatch(new Range(lineNumber, lastMatchIndex + 1 + deltaOffset, lineNumber, lastMatchIndex + 1 + searchStringLen + deltaOffset), null);\r\n                    if (resultLen >= limitResultCount) {\r\n                        return resultLen;\r\n                    }\r\n                }\r\n            }\r\n            return resultLen;\r\n        }\r\n        var searcher = new Searcher(searchData.wordSeparators, searchData.regex);\r\n        var m;\r\n        // Reset regex to search from the beginning\r\n        searcher.reset(0);\r\n        do {\r\n            m = searcher.next(text);\r\n            if (m) {\r\n                result[resultLen++] = createFindMatch(new Range(lineNumber, m.index + 1 + deltaOffset, lineNumber, m.index + 1 + m[0].length + deltaOffset), m, captureMatches);\r\n                if (resultLen >= limitResultCount) {\r\n                    return resultLen;\r\n                }\r\n            }\r\n        } while (m);\r\n        return resultLen;\r\n    };\r\n    TextModelSearch.findNextMatch = function (model, searchParams, searchStart, captureMatches) {\r\n        var searchData = searchParams.parseSearchRequest();\r\n        if (!searchData) {\r\n            return null;\r\n        }\r\n        var searcher = new Searcher(searchData.wordSeparators, searchData.regex);\r\n        if (searchData.regex.multiline) {\r\n            return this._doFindNextMatchMultiline(model, searchStart, searcher, captureMatches);\r\n        }\r\n        return this._doFindNextMatchLineByLine(model, searchStart, searcher, captureMatches);\r\n    };\r\n    TextModelSearch._doFindNextMatchMultiline = function (model, searchStart, searcher, captureMatches) {\r\n        var searchTextStart = new Position(searchStart.lineNumber, 1);\r\n        var deltaOffset = model.getOffsetAt(searchTextStart);\r\n        var lineCount = model.getLineCount();\r\n        // We always execute multiline search over the lines joined with \\n\r\n        // This makes it that \\n will match the EOL for both CRLF and LF models\r\n        // We compensate for offset errors in `_getMultilineMatchRange`\r\n        var text = model.getValueInRange(new Range(searchTextStart.lineNumber, searchTextStart.column, lineCount, model.getLineMaxColumn(lineCount)), 1 /* LF */);\r\n        var lfCounter = (model.getEOL() === '\\r\\n' ? new LineFeedCounter(text) : null);\r\n        searcher.reset(searchStart.column - 1);\r\n        var m = searcher.next(text);\r\n        if (m) {\r\n            return createFindMatch(this._getMultilineMatchRange(model, deltaOffset, text, lfCounter, m.index, m[0]), m, captureMatches);\r\n        }\r\n        if (searchStart.lineNumber !== 1 || searchStart.column !== 1) {\r\n            // Try again from the top\r\n            return this._doFindNextMatchMultiline(model, new Position(1, 1), searcher, captureMatches);\r\n        }\r\n        return null;\r\n    };\r\n    TextModelSearch._doFindNextMatchLineByLine = function (model, searchStart, searcher, captureMatches) {\r\n        var lineCount = model.getLineCount();\r\n        var startLineNumber = searchStart.lineNumber;\r\n        // Look in first line\r\n        var text = model.getLineContent(startLineNumber);\r\n        var r = this._findFirstMatchInLine(searcher, text, startLineNumber, searchStart.column, captureMatches);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        for (var i = 1; i <= lineCount; i++) {\r\n            var lineIndex = (startLineNumber + i - 1) % lineCount;\r\n            var text_3 = model.getLineContent(lineIndex + 1);\r\n            var r_1 = this._findFirstMatchInLine(searcher, text_3, lineIndex + 1, 1, captureMatches);\r\n            if (r_1) {\r\n                return r_1;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TextModelSearch._findFirstMatchInLine = function (searcher, text, lineNumber, fromColumn, captureMatches) {\r\n        // Set regex to search from column\r\n        searcher.reset(fromColumn - 1);\r\n        var m = searcher.next(text);\r\n        if (m) {\r\n            return createFindMatch(new Range(lineNumber, m.index + 1, lineNumber, m.index + 1 + m[0].length), m, captureMatches);\r\n        }\r\n        return null;\r\n    };\r\n    TextModelSearch.findPreviousMatch = function (model, searchParams, searchStart, captureMatches) {\r\n        var searchData = searchParams.parseSearchRequest();\r\n        if (!searchData) {\r\n            return null;\r\n        }\r\n        var searcher = new Searcher(searchData.wordSeparators, searchData.regex);\r\n        if (searchData.regex.multiline) {\r\n            return this._doFindPreviousMatchMultiline(model, searchStart, searcher, captureMatches);\r\n        }\r\n        return this._doFindPreviousMatchLineByLine(model, searchStart, searcher, captureMatches);\r\n    };\r\n    TextModelSearch._doFindPreviousMatchMultiline = function (model, searchStart, searcher, captureMatches) {\r\n        var matches = this._doFindMatchesMultiline(model, new Range(1, 1, searchStart.lineNumber, searchStart.column), searcher, captureMatches, 10 * LIMIT_FIND_COUNT);\r\n        if (matches.length > 0) {\r\n            return matches[matches.length - 1];\r\n        }\r\n        var lineCount = model.getLineCount();\r\n        if (searchStart.lineNumber !== lineCount || searchStart.column !== model.getLineMaxColumn(lineCount)) {\r\n            // Try again with all content\r\n            return this._doFindPreviousMatchMultiline(model, new Position(lineCount, model.getLineMaxColumn(lineCount)), searcher, captureMatches);\r\n        }\r\n        return null;\r\n    };\r\n    TextModelSearch._doFindPreviousMatchLineByLine = function (model, searchStart, searcher, captureMatches) {\r\n        var lineCount = model.getLineCount();\r\n        var startLineNumber = searchStart.lineNumber;\r\n        // Look in first line\r\n        var text = model.getLineContent(startLineNumber).substring(0, searchStart.column - 1);\r\n        var r = this._findLastMatchInLine(searcher, text, startLineNumber, captureMatches);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        for (var i = 1; i <= lineCount; i++) {\r\n            var lineIndex = (lineCount + startLineNumber - i - 1) % lineCount;\r\n            var text_4 = model.getLineContent(lineIndex + 1);\r\n            var r_2 = this._findLastMatchInLine(searcher, text_4, lineIndex + 1, captureMatches);\r\n            if (r_2) {\r\n                return r_2;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TextModelSearch._findLastMatchInLine = function (searcher, text, lineNumber, captureMatches) {\r\n        var bestResult = null;\r\n        var m;\r\n        searcher.reset(0);\r\n        while ((m = searcher.next(text))) {\r\n            bestResult = createFindMatch(new Range(lineNumber, m.index + 1, lineNumber, m.index + 1 + m[0].length), m, captureMatches);\r\n        }\r\n        return bestResult;\r\n    };\r\n    return TextModelSearch;\r\n}());\r\nexport { TextModelSearch };\r\nfunction leftIsWordBounday(wordSeparators, text, textLength, matchStartIndex, matchLength) {\r\n    if (matchStartIndex === 0) {\r\n        // Match starts at start of string\r\n        return true;\r\n    }\r\n    var charBefore = text.charCodeAt(matchStartIndex - 1);\r\n    if (wordSeparators.get(charBefore) !== 0 /* Regular */) {\r\n        // The character before the match is a word separator\r\n        return true;\r\n    }\r\n    if (charBefore === 13 /* CarriageReturn */ || charBefore === 10 /* LineFeed */) {\r\n        // The character before the match is line break or carriage return.\r\n        return true;\r\n    }\r\n    if (matchLength > 0) {\r\n        var firstCharInMatch = text.charCodeAt(matchStartIndex);\r\n        if (wordSeparators.get(firstCharInMatch) !== 0 /* Regular */) {\r\n            // The first character inside the match is a word separator\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction rightIsWordBounday(wordSeparators, text, textLength, matchStartIndex, matchLength) {\r\n    if (matchStartIndex + matchLength === textLength) {\r\n        // Match ends at end of string\r\n        return true;\r\n    }\r\n    var charAfter = text.charCodeAt(matchStartIndex + matchLength);\r\n    if (wordSeparators.get(charAfter) !== 0 /* Regular */) {\r\n        // The character after the match is a word separator\r\n        return true;\r\n    }\r\n    if (charAfter === 13 /* CarriageReturn */ || charAfter === 10 /* LineFeed */) {\r\n        // The character after the match is line break or carriage return.\r\n        return true;\r\n    }\r\n    if (matchLength > 0) {\r\n        var lastCharInMatch = text.charCodeAt(matchStartIndex + matchLength - 1);\r\n        if (wordSeparators.get(lastCharInMatch) !== 0 /* Regular */) {\r\n            // The last character in the match is a word separator\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function isValidMatch(wordSeparators, text, textLength, matchStartIndex, matchLength) {\r\n    return (leftIsWordBounday(wordSeparators, text, textLength, matchStartIndex, matchLength)\r\n        && rightIsWordBounday(wordSeparators, text, textLength, matchStartIndex, matchLength));\r\n}\r\nvar Searcher = /** @class */ (function () {\r\n    function Searcher(wordSeparators, searchRegex) {\r\n        this._wordSeparators = wordSeparators;\r\n        this._searchRegex = searchRegex;\r\n        this._prevMatchStartIndex = -1;\r\n        this._prevMatchLength = 0;\r\n    }\r\n    Searcher.prototype.reset = function (lastIndex) {\r\n        this._searchRegex.lastIndex = lastIndex;\r\n        this._prevMatchStartIndex = -1;\r\n        this._prevMatchLength = 0;\r\n    };\r\n    Searcher.prototype.next = function (text) {\r\n        var textLength = text.length;\r\n        var m;\r\n        do {\r\n            if (this._prevMatchStartIndex + this._prevMatchLength === textLength) {\r\n                // Reached the end of the line\r\n                return null;\r\n            }\r\n            m = this._searchRegex.exec(text);\r\n            if (!m) {\r\n                return null;\r\n            }\r\n            var matchStartIndex = m.index;\r\n            var matchLength = m[0].length;\r\n            if (matchStartIndex === this._prevMatchStartIndex && matchLength === this._prevMatchLength) {\r\n                // Exit early if the regex matches the same range twice\r\n                return null;\r\n            }\r\n            this._prevMatchStartIndex = matchStartIndex;\r\n            this._prevMatchLength = matchLength;\r\n            if (!this._wordSeparators || isValidMatch(this._wordSeparators, text, textLength, matchStartIndex, matchLength)) {\r\n                return m;\r\n            }\r\n        } while (m);\r\n        return null;\r\n    };\r\n    return Searcher;\r\n}());\r\nexport { Searcher };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Position } from '../../core/position.js';\r\nimport { Range } from '../../core/range.js';\r\nimport { FindMatch } from '../../model.js';\r\nimport { SENTINEL, TreeNode, fixInsert, leftest, rbDelete, righttest, updateTreeMetadata } from './rbTreeBase.js';\r\nimport { Searcher, createFindMatch, isValidMatch } from '../textModelSearch.js';\r\n// const lfRegex = new RegExp(/\\r\\n|\\r|\\n/g);\r\nexport var AverageBufferSize = 65535;\r\nexport function createUintArray(arr) {\r\n    var r;\r\n    if (arr[arr.length - 1] < 65536) {\r\n        r = new Uint16Array(arr.length);\r\n    }\r\n    else {\r\n        r = new Uint32Array(arr.length);\r\n    }\r\n    r.set(arr, 0);\r\n    return r;\r\n}\r\nvar LineStarts = /** @class */ (function () {\r\n    function LineStarts(lineStarts, cr, lf, crlf, isBasicASCII) {\r\n        this.lineStarts = lineStarts;\r\n        this.cr = cr;\r\n        this.lf = lf;\r\n        this.crlf = crlf;\r\n        this.isBasicASCII = isBasicASCII;\r\n    }\r\n    return LineStarts;\r\n}());\r\nexport { LineStarts };\r\nexport function createLineStartsFast(str, readonly) {\r\n    if (readonly === void 0) { readonly = true; }\r\n    var r = [0], rLength = 1;\r\n    for (var i = 0, len = str.length; i < len; i++) {\r\n        var chr = str.charCodeAt(i);\r\n        if (chr === 13 /* CarriageReturn */) {\r\n            if (i + 1 < len && str.charCodeAt(i + 1) === 10 /* LineFeed */) {\r\n                // \\r\\n... case\r\n                r[rLength++] = i + 2;\r\n                i++; // skip \\n\r\n            }\r\n            else {\r\n                // \\r... case\r\n                r[rLength++] = i + 1;\r\n            }\r\n        }\r\n        else if (chr === 10 /* LineFeed */) {\r\n            r[rLength++] = i + 1;\r\n        }\r\n    }\r\n    if (readonly) {\r\n        return createUintArray(r);\r\n    }\r\n    else {\r\n        return r;\r\n    }\r\n}\r\nexport function createLineStarts(r, str) {\r\n    r.length = 0;\r\n    r[0] = 0;\r\n    var rLength = 1;\r\n    var cr = 0, lf = 0, crlf = 0;\r\n    var isBasicASCII = true;\r\n    for (var i = 0, len = str.length; i < len; i++) {\r\n        var chr = str.charCodeAt(i);\r\n        if (chr === 13 /* CarriageReturn */) {\r\n            if (i + 1 < len && str.charCodeAt(i + 1) === 10 /* LineFeed */) {\r\n                // \\r\\n... case\r\n                crlf++;\r\n                r[rLength++] = i + 2;\r\n                i++; // skip \\n\r\n            }\r\n            else {\r\n                cr++;\r\n                // \\r... case\r\n                r[rLength++] = i + 1;\r\n            }\r\n        }\r\n        else if (chr === 10 /* LineFeed */) {\r\n            lf++;\r\n            r[rLength++] = i + 1;\r\n        }\r\n        else {\r\n            if (isBasicASCII) {\r\n                if (chr !== 9 /* Tab */ && (chr < 32 || chr > 126)) {\r\n                    isBasicASCII = false;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    var result = new LineStarts(createUintArray(r), cr, lf, crlf, isBasicASCII);\r\n    r.length = 0;\r\n    return result;\r\n}\r\nvar Piece = /** @class */ (function () {\r\n    function Piece(bufferIndex, start, end, lineFeedCnt, length) {\r\n        this.bufferIndex = bufferIndex;\r\n        this.start = start;\r\n        this.end = end;\r\n        this.lineFeedCnt = lineFeedCnt;\r\n        this.length = length;\r\n    }\r\n    return Piece;\r\n}());\r\nexport { Piece };\r\nvar StringBuffer = /** @class */ (function () {\r\n    function StringBuffer(buffer, lineStarts) {\r\n        this.buffer = buffer;\r\n        this.lineStarts = lineStarts;\r\n    }\r\n    return StringBuffer;\r\n}());\r\nexport { StringBuffer };\r\nvar PieceTreeSearchCache = /** @class */ (function () {\r\n    function PieceTreeSearchCache(limit) {\r\n        this._limit = limit;\r\n        this._cache = [];\r\n    }\r\n    PieceTreeSearchCache.prototype.get = function (offset) {\r\n        for (var i = this._cache.length - 1; i >= 0; i--) {\r\n            var nodePos = this._cache[i];\r\n            if (nodePos.nodeStartOffset <= offset && nodePos.nodeStartOffset + nodePos.node.piece.length >= offset) {\r\n                return nodePos;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    PieceTreeSearchCache.prototype.get2 = function (lineNumber) {\r\n        for (var i = this._cache.length - 1; i >= 0; i--) {\r\n            var nodePos = this._cache[i];\r\n            if (nodePos.nodeStartLineNumber && nodePos.nodeStartLineNumber < lineNumber && nodePos.nodeStartLineNumber + nodePos.node.piece.lineFeedCnt >= lineNumber) {\r\n                return nodePos;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    PieceTreeSearchCache.prototype.set = function (nodePosition) {\r\n        if (this._cache.length >= this._limit) {\r\n            this._cache.shift();\r\n        }\r\n        this._cache.push(nodePosition);\r\n    };\r\n    PieceTreeSearchCache.prototype.valdiate = function (offset) {\r\n        var hasInvalidVal = false;\r\n        var tmp = this._cache;\r\n        for (var i = 0; i < tmp.length; i++) {\r\n            var nodePos = tmp[i];\r\n            if (nodePos.node.parent === null || nodePos.nodeStartOffset >= offset) {\r\n                tmp[i] = null;\r\n                hasInvalidVal = true;\r\n                continue;\r\n            }\r\n        }\r\n        if (hasInvalidVal) {\r\n            var newArr = [];\r\n            for (var i = 0; i < tmp.length; i++) {\r\n                var entry = tmp[i];\r\n                if (entry !== null) {\r\n                    newArr.push(entry);\r\n                }\r\n            }\r\n            this._cache = newArr;\r\n        }\r\n    };\r\n    return PieceTreeSearchCache;\r\n}());\r\nvar PieceTreeBase = /** @class */ (function () {\r\n    function PieceTreeBase(chunks, eol, eolNormalized) {\r\n        this.create(chunks, eol, eolNormalized);\r\n    }\r\n    PieceTreeBase.prototype.create = function (chunks, eol, eolNormalized) {\r\n        this._buffers = [\r\n            new StringBuffer('', [0])\r\n        ];\r\n        this._lastChangeBufferPos = { line: 0, column: 0 };\r\n        this.root = SENTINEL;\r\n        this._lineCnt = 1;\r\n        this._length = 0;\r\n        this._EOL = eol;\r\n        this._EOLLength = eol.length;\r\n        this._EOLNormalized = eolNormalized;\r\n        var lastNode = null;\r\n        for (var i = 0, len = chunks.length; i < len; i++) {\r\n            if (chunks[i].buffer.length > 0) {\r\n                if (!chunks[i].lineStarts) {\r\n                    chunks[i].lineStarts = createLineStartsFast(chunks[i].buffer);\r\n                }\r\n                var piece = new Piece(i + 1, { line: 0, column: 0 }, { line: chunks[i].lineStarts.length - 1, column: chunks[i].buffer.length - chunks[i].lineStarts[chunks[i].lineStarts.length - 1] }, chunks[i].lineStarts.length - 1, chunks[i].buffer.length);\r\n                this._buffers.push(chunks[i]);\r\n                lastNode = this.rbInsertRight(lastNode, piece);\r\n            }\r\n        }\r\n        this._searchCache = new PieceTreeSearchCache(1);\r\n        this._lastVisitedLine = { lineNumber: 0, value: '' };\r\n        this.computeBufferMetadata();\r\n    };\r\n    PieceTreeBase.prototype.normalizeEOL = function (eol) {\r\n        var _this = this;\r\n        var averageBufferSize = AverageBufferSize;\r\n        var min = averageBufferSize - Math.floor(averageBufferSize / 3);\r\n        var max = min * 2;\r\n        var tempChunk = '';\r\n        var tempChunkLen = 0;\r\n        var chunks = [];\r\n        this.iterate(this.root, function (node) {\r\n            var str = _this.getNodeContent(node);\r\n            var len = str.length;\r\n            if (tempChunkLen <= min || tempChunkLen + len < max) {\r\n                tempChunk += str;\r\n                tempChunkLen += len;\r\n                return true;\r\n            }\r\n            // flush anyways\r\n            var text = tempChunk.replace(/\\r\\n|\\r|\\n/g, eol);\r\n            chunks.push(new StringBuffer(text, createLineStartsFast(text)));\r\n            tempChunk = str;\r\n            tempChunkLen = len;\r\n            return true;\r\n        });\r\n        if (tempChunkLen > 0) {\r\n            var text = tempChunk.replace(/\\r\\n|\\r|\\n/g, eol);\r\n            chunks.push(new StringBuffer(text, createLineStartsFast(text)));\r\n        }\r\n        this.create(chunks, eol, true);\r\n    };\r\n    // #region Buffer API\r\n    PieceTreeBase.prototype.getEOL = function () {\r\n        return this._EOL;\r\n    };\r\n    PieceTreeBase.prototype.setEOL = function (newEOL) {\r\n        this._EOL = newEOL;\r\n        this._EOLLength = this._EOL.length;\r\n        this.normalizeEOL(newEOL);\r\n    };\r\n    PieceTreeBase.prototype.getOffsetAt = function (lineNumber, column) {\r\n        var leftLen = 0; // inorder\r\n        var x = this.root;\r\n        while (x !== SENTINEL) {\r\n            if (x.left !== SENTINEL && x.lf_left + 1 >= lineNumber) {\r\n                x = x.left;\r\n            }\r\n            else if (x.lf_left + x.piece.lineFeedCnt + 1 >= lineNumber) {\r\n                leftLen += x.size_left;\r\n                // lineNumber >= 2\r\n                var accumualtedValInCurrentIndex = this.getAccumulatedValue(x, lineNumber - x.lf_left - 2);\r\n                return leftLen += accumualtedValInCurrentIndex + column - 1;\r\n            }\r\n            else {\r\n                lineNumber -= x.lf_left + x.piece.lineFeedCnt;\r\n                leftLen += x.size_left + x.piece.length;\r\n                x = x.right;\r\n            }\r\n        }\r\n        return leftLen;\r\n    };\r\n    PieceTreeBase.prototype.getPositionAt = function (offset) {\r\n        offset = Math.floor(offset);\r\n        offset = Math.max(0, offset);\r\n        var x = this.root;\r\n        var lfCnt = 0;\r\n        var originalOffset = offset;\r\n        while (x !== SENTINEL) {\r\n            if (x.size_left !== 0 && x.size_left >= offset) {\r\n                x = x.left;\r\n            }\r\n            else if (x.size_left + x.piece.length >= offset) {\r\n                var out = this.getIndexOf(x, offset - x.size_left);\r\n                lfCnt += x.lf_left + out.index;\r\n                if (out.index === 0) {\r\n                    var lineStartOffset = this.getOffsetAt(lfCnt + 1, 1);\r\n                    var column = originalOffset - lineStartOffset;\r\n                    return new Position(lfCnt + 1, column + 1);\r\n                }\r\n                return new Position(lfCnt + 1, out.remainder + 1);\r\n            }\r\n            else {\r\n                offset -= x.size_left + x.piece.length;\r\n                lfCnt += x.lf_left + x.piece.lineFeedCnt;\r\n                if (x.right === SENTINEL) {\r\n                    // last node\r\n                    var lineStartOffset = this.getOffsetAt(lfCnt + 1, 1);\r\n                    var column = originalOffset - offset - lineStartOffset;\r\n                    return new Position(lfCnt + 1, column + 1);\r\n                }\r\n                else {\r\n                    x = x.right;\r\n                }\r\n            }\r\n        }\r\n        return new Position(1, 1);\r\n    };\r\n    PieceTreeBase.prototype.getValueInRange = function (range, eol) {\r\n        if (range.startLineNumber === range.endLineNumber && range.startColumn === range.endColumn) {\r\n            return '';\r\n        }\r\n        var startPosition = this.nodeAt2(range.startLineNumber, range.startColumn);\r\n        var endPosition = this.nodeAt2(range.endLineNumber, range.endColumn);\r\n        var value = this.getValueInRange2(startPosition, endPosition);\r\n        if (eol) {\r\n            if (eol !== this._EOL || !this._EOLNormalized) {\r\n                return value.replace(/\\r\\n|\\r|\\n/g, eol);\r\n            }\r\n            if (eol === this.getEOL() && this._EOLNormalized) {\r\n                if (eol === '\\r\\n') {\r\n                }\r\n                return value;\r\n            }\r\n            return value.replace(/\\r\\n|\\r|\\n/g, eol);\r\n        }\r\n        return value;\r\n    };\r\n    PieceTreeBase.prototype.getValueInRange2 = function (startPosition, endPosition) {\r\n        if (startPosition.node === endPosition.node) {\r\n            var node = startPosition.node;\r\n            var buffer_1 = this._buffers[node.piece.bufferIndex].buffer;\r\n            var startOffset_1 = this.offsetInBuffer(node.piece.bufferIndex, node.piece.start);\r\n            return buffer_1.substring(startOffset_1 + startPosition.remainder, startOffset_1 + endPosition.remainder);\r\n        }\r\n        var x = startPosition.node;\r\n        var buffer = this._buffers[x.piece.bufferIndex].buffer;\r\n        var startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\r\n        var ret = buffer.substring(startOffset + startPosition.remainder, startOffset + x.piece.length);\r\n        x = x.next();\r\n        while (x !== SENTINEL) {\r\n            var buffer_2 = this._buffers[x.piece.bufferIndex].buffer;\r\n            var startOffset_2 = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\r\n            if (x === endPosition.node) {\r\n                ret += buffer_2.substring(startOffset_2, startOffset_2 + endPosition.remainder);\r\n                break;\r\n            }\r\n            else {\r\n                ret += buffer_2.substr(startOffset_2, x.piece.length);\r\n            }\r\n            x = x.next();\r\n        }\r\n        return ret;\r\n    };\r\n    PieceTreeBase.prototype.getLinesContent = function () {\r\n        return this.getContentOfSubTree(this.root).split(/\\r\\n|\\r|\\n/);\r\n    };\r\n    PieceTreeBase.prototype.getLength = function () {\r\n        return this._length;\r\n    };\r\n    PieceTreeBase.prototype.getLineCount = function () {\r\n        return this._lineCnt;\r\n    };\r\n    PieceTreeBase.prototype.getLineContent = function (lineNumber) {\r\n        if (this._lastVisitedLine.lineNumber === lineNumber) {\r\n            return this._lastVisitedLine.value;\r\n        }\r\n        this._lastVisitedLine.lineNumber = lineNumber;\r\n        if (lineNumber === this._lineCnt) {\r\n            this._lastVisitedLine.value = this.getLineRawContent(lineNumber);\r\n        }\r\n        else if (this._EOLNormalized) {\r\n            this._lastVisitedLine.value = this.getLineRawContent(lineNumber, this._EOLLength);\r\n        }\r\n        else {\r\n            this._lastVisitedLine.value = this.getLineRawContent(lineNumber).replace(/(\\r\\n|\\r|\\n)$/, '');\r\n        }\r\n        return this._lastVisitedLine.value;\r\n    };\r\n    PieceTreeBase.prototype.getLineCharCode = function (lineNumber, index) {\r\n        var nodePos = this.nodeAt2(lineNumber, index + 1);\r\n        if (nodePos.remainder === nodePos.node.piece.length) {\r\n            // the char we want to fetch is at the head of next node.\r\n            var matchingNode = nodePos.node.next();\r\n            if (!matchingNode) {\r\n                return 0;\r\n            }\r\n            var buffer = this._buffers[matchingNode.piece.bufferIndex];\r\n            var startOffset = this.offsetInBuffer(matchingNode.piece.bufferIndex, matchingNode.piece.start);\r\n            return buffer.buffer.charCodeAt(startOffset);\r\n        }\r\n        else {\r\n            var buffer = this._buffers[nodePos.node.piece.bufferIndex];\r\n            var startOffset = this.offsetInBuffer(nodePos.node.piece.bufferIndex, nodePos.node.piece.start);\r\n            var targetOffset = startOffset + nodePos.remainder;\r\n            return buffer.buffer.charCodeAt(targetOffset);\r\n        }\r\n    };\r\n    PieceTreeBase.prototype.getLineLength = function (lineNumber) {\r\n        if (lineNumber === this.getLineCount()) {\r\n            var startOffset = this.getOffsetAt(lineNumber, 1);\r\n            return this.getLength() - startOffset;\r\n        }\r\n        return this.getOffsetAt(lineNumber + 1, 1) - this.getOffsetAt(lineNumber, 1) - this._EOLLength;\r\n    };\r\n    PieceTreeBase.prototype.findMatchesInNode = function (node, searcher, startLineNumber, startColumn, startCursor, endCursor, searchData, captureMatches, limitResultCount, resultLen, result) {\r\n        var buffer = this._buffers[node.piece.bufferIndex];\r\n        var startOffsetInBuffer = this.offsetInBuffer(node.piece.bufferIndex, node.piece.start);\r\n        var start = this.offsetInBuffer(node.piece.bufferIndex, startCursor);\r\n        var end = this.offsetInBuffer(node.piece.bufferIndex, endCursor);\r\n        var m;\r\n        // Reset regex to search from the beginning\r\n        searcher.reset(start);\r\n        var ret = { line: 0, column: 0 };\r\n        do {\r\n            m = searcher.next(buffer.buffer);\r\n            if (m) {\r\n                if (m.index >= end) {\r\n                    return resultLen;\r\n                }\r\n                this.positionInBuffer(node, m.index - startOffsetInBuffer, ret);\r\n                var lineFeedCnt = this.getLineFeedCnt(node.piece.bufferIndex, startCursor, ret);\r\n                var retStartColumn = ret.line === startCursor.line ? ret.column - startCursor.column + startColumn : ret.column + 1;\r\n                var retEndColumn = retStartColumn + m[0].length;\r\n                result[resultLen++] = createFindMatch(new Range(startLineNumber + lineFeedCnt, retStartColumn, startLineNumber + lineFeedCnt, retEndColumn), m, captureMatches);\r\n                if (m.index + m[0].length >= end) {\r\n                    return resultLen;\r\n                }\r\n                if (resultLen >= limitResultCount) {\r\n                    return resultLen;\r\n                }\r\n            }\r\n        } while (m);\r\n        return resultLen;\r\n    };\r\n    PieceTreeBase.prototype.findMatchesLineByLine = function (searchRange, searchData, captureMatches, limitResultCount) {\r\n        var result = [];\r\n        var resultLen = 0;\r\n        var searcher = new Searcher(searchData.wordSeparators, searchData.regex);\r\n        var startPostion = this.nodeAt2(searchRange.startLineNumber, searchRange.startColumn);\r\n        if (startPostion === null) {\r\n            return [];\r\n        }\r\n        var endPosition = this.nodeAt2(searchRange.endLineNumber, searchRange.endColumn);\r\n        if (endPosition === null) {\r\n            return [];\r\n        }\r\n        var start = this.positionInBuffer(startPostion.node, startPostion.remainder);\r\n        var end = this.positionInBuffer(endPosition.node, endPosition.remainder);\r\n        if (startPostion.node === endPosition.node) {\r\n            this.findMatchesInNode(startPostion.node, searcher, searchRange.startLineNumber, searchRange.startColumn, start, end, searchData, captureMatches, limitResultCount, resultLen, result);\r\n            return result;\r\n        }\r\n        var startLineNumber = searchRange.startLineNumber;\r\n        var currentNode = startPostion.node;\r\n        while (currentNode !== endPosition.node) {\r\n            var lineBreakCnt = this.getLineFeedCnt(currentNode.piece.bufferIndex, start, currentNode.piece.end);\r\n            if (lineBreakCnt >= 1) {\r\n                // last line break position\r\n                var lineStarts = this._buffers[currentNode.piece.bufferIndex].lineStarts;\r\n                var startOffsetInBuffer = this.offsetInBuffer(currentNode.piece.bufferIndex, currentNode.piece.start);\r\n                var nextLineStartOffset = lineStarts[start.line + lineBreakCnt];\r\n                var startColumn_1 = startLineNumber === searchRange.startLineNumber ? searchRange.startColumn : 1;\r\n                resultLen = this.findMatchesInNode(currentNode, searcher, startLineNumber, startColumn_1, start, this.positionInBuffer(currentNode, nextLineStartOffset - startOffsetInBuffer), searchData, captureMatches, limitResultCount, resultLen, result);\r\n                if (resultLen >= limitResultCount) {\r\n                    return result;\r\n                }\r\n                startLineNumber += lineBreakCnt;\r\n            }\r\n            var startColumn_2 = startLineNumber === searchRange.startLineNumber ? searchRange.startColumn - 1 : 0;\r\n            // search for the remaining content\r\n            if (startLineNumber === searchRange.endLineNumber) {\r\n                var text = this.getLineContent(startLineNumber).substring(startColumn_2, searchRange.endColumn - 1);\r\n                resultLen = this._findMatchesInLine(searchData, searcher, text, searchRange.endLineNumber, startColumn_2, resultLen, result, captureMatches, limitResultCount);\r\n                return result;\r\n            }\r\n            resultLen = this._findMatchesInLine(searchData, searcher, this.getLineContent(startLineNumber).substr(startColumn_2), startLineNumber, startColumn_2, resultLen, result, captureMatches, limitResultCount);\r\n            if (resultLen >= limitResultCount) {\r\n                return result;\r\n            }\r\n            startLineNumber++;\r\n            startPostion = this.nodeAt2(startLineNumber, 1);\r\n            currentNode = startPostion.node;\r\n            start = this.positionInBuffer(startPostion.node, startPostion.remainder);\r\n        }\r\n        if (startLineNumber === searchRange.endLineNumber) {\r\n            var startColumn_3 = startLineNumber === searchRange.startLineNumber ? searchRange.startColumn - 1 : 0;\r\n            var text = this.getLineContent(startLineNumber).substring(startColumn_3, searchRange.endColumn - 1);\r\n            resultLen = this._findMatchesInLine(searchData, searcher, text, searchRange.endLineNumber, startColumn_3, resultLen, result, captureMatches, limitResultCount);\r\n            return result;\r\n        }\r\n        var startColumn = startLineNumber === searchRange.startLineNumber ? searchRange.startColumn : 1;\r\n        resultLen = this.findMatchesInNode(endPosition.node, searcher, startLineNumber, startColumn, start, end, searchData, captureMatches, limitResultCount, resultLen, result);\r\n        return result;\r\n    };\r\n    PieceTreeBase.prototype._findMatchesInLine = function (searchData, searcher, text, lineNumber, deltaOffset, resultLen, result, captureMatches, limitResultCount) {\r\n        var wordSeparators = searchData.wordSeparators;\r\n        if (!captureMatches && searchData.simpleSearch) {\r\n            var searchString = searchData.simpleSearch;\r\n            var searchStringLen = searchString.length;\r\n            var textLength = text.length;\r\n            var lastMatchIndex = -searchStringLen;\r\n            while ((lastMatchIndex = text.indexOf(searchString, lastMatchIndex + searchStringLen)) !== -1) {\r\n                if (!wordSeparators || isValidMatch(wordSeparators, text, textLength, lastMatchIndex, searchStringLen)) {\r\n                    result[resultLen++] = new FindMatch(new Range(lineNumber, lastMatchIndex + 1 + deltaOffset, lineNumber, lastMatchIndex + 1 + searchStringLen + deltaOffset), null);\r\n                    if (resultLen >= limitResultCount) {\r\n                        return resultLen;\r\n                    }\r\n                }\r\n            }\r\n            return resultLen;\r\n        }\r\n        var m;\r\n        // Reset regex to search from the beginning\r\n        searcher.reset(0);\r\n        do {\r\n            m = searcher.next(text);\r\n            if (m) {\r\n                result[resultLen++] = createFindMatch(new Range(lineNumber, m.index + 1 + deltaOffset, lineNumber, m.index + 1 + m[0].length + deltaOffset), m, captureMatches);\r\n                if (resultLen >= limitResultCount) {\r\n                    return resultLen;\r\n                }\r\n            }\r\n        } while (m);\r\n        return resultLen;\r\n    };\r\n    // #endregion\r\n    // #region Piece Table\r\n    PieceTreeBase.prototype.insert = function (offset, value, eolNormalized) {\r\n        if (eolNormalized === void 0) { eolNormalized = false; }\r\n        this._EOLNormalized = this._EOLNormalized && eolNormalized;\r\n        this._lastVisitedLine.lineNumber = 0;\r\n        this._lastVisitedLine.value = '';\r\n        if (this.root !== SENTINEL) {\r\n            var _a = this.nodeAt(offset), node = _a.node, remainder = _a.remainder, nodeStartOffset = _a.nodeStartOffset;\r\n            var piece = node.piece;\r\n            var bufferIndex = piece.bufferIndex;\r\n            var insertPosInBuffer = this.positionInBuffer(node, remainder);\r\n            if (node.piece.bufferIndex === 0 &&\r\n                piece.end.line === this._lastChangeBufferPos.line &&\r\n                piece.end.column === this._lastChangeBufferPos.column &&\r\n                (nodeStartOffset + piece.length === offset) &&\r\n                value.length < AverageBufferSize) {\r\n                // changed buffer\r\n                this.appendToNode(node, value);\r\n                this.computeBufferMetadata();\r\n                return;\r\n            }\r\n            if (nodeStartOffset === offset) {\r\n                this.insertContentToNodeLeft(value, node);\r\n                this._searchCache.valdiate(offset);\r\n            }\r\n            else if (nodeStartOffset + node.piece.length > offset) {\r\n                // we are inserting into the middle of a node.\r\n                var nodesToDel = [];\r\n                var newRightPiece = new Piece(piece.bufferIndex, insertPosInBuffer, piece.end, this.getLineFeedCnt(piece.bufferIndex, insertPosInBuffer, piece.end), this.offsetInBuffer(bufferIndex, piece.end) - this.offsetInBuffer(bufferIndex, insertPosInBuffer));\r\n                if (this.shouldCheckCRLF() && this.endWithCR(value)) {\r\n                    var headOfRight = this.nodeCharCodeAt(node, remainder);\r\n                    if (headOfRight === 10 /** \\n */) {\r\n                        var newStart = { line: newRightPiece.start.line + 1, column: 0 };\r\n                        newRightPiece = new Piece(newRightPiece.bufferIndex, newStart, newRightPiece.end, this.getLineFeedCnt(newRightPiece.bufferIndex, newStart, newRightPiece.end), newRightPiece.length - 1);\r\n                        value += '\\n';\r\n                    }\r\n                }\r\n                // reuse node for content before insertion point.\r\n                if (this.shouldCheckCRLF() && this.startWithLF(value)) {\r\n                    var tailOfLeft = this.nodeCharCodeAt(node, remainder - 1);\r\n                    if (tailOfLeft === 13 /** \\r */) {\r\n                        var previousPos = this.positionInBuffer(node, remainder - 1);\r\n                        this.deleteNodeTail(node, previousPos);\r\n                        value = '\\r' + value;\r\n                        if (node.piece.length === 0) {\r\n                            nodesToDel.push(node);\r\n                        }\r\n                    }\r\n                    else {\r\n                        this.deleteNodeTail(node, insertPosInBuffer);\r\n                    }\r\n                }\r\n                else {\r\n                    this.deleteNodeTail(node, insertPosInBuffer);\r\n                }\r\n                var newPieces = this.createNewPieces(value);\r\n                if (newRightPiece.length > 0) {\r\n                    this.rbInsertRight(node, newRightPiece);\r\n                }\r\n                var tmpNode = node;\r\n                for (var k = 0; k < newPieces.length; k++) {\r\n                    tmpNode = this.rbInsertRight(tmpNode, newPieces[k]);\r\n                }\r\n                this.deleteNodes(nodesToDel);\r\n            }\r\n            else {\r\n                this.insertContentToNodeRight(value, node);\r\n            }\r\n        }\r\n        else {\r\n            // insert new node\r\n            var pieces = this.createNewPieces(value);\r\n            var node = this.rbInsertLeft(null, pieces[0]);\r\n            for (var k = 1; k < pieces.length; k++) {\r\n                node = this.rbInsertRight(node, pieces[k]);\r\n            }\r\n        }\r\n        // todo, this is too brutal. Total line feed count should be updated the same way as lf_left.\r\n        this.computeBufferMetadata();\r\n    };\r\n    PieceTreeBase.prototype.delete = function (offset, cnt) {\r\n        this._lastVisitedLine.lineNumber = 0;\r\n        this._lastVisitedLine.value = '';\r\n        if (cnt <= 0 || this.root === SENTINEL) {\r\n            return;\r\n        }\r\n        var startPosition = this.nodeAt(offset);\r\n        var endPosition = this.nodeAt(offset + cnt);\r\n        var startNode = startPosition.node;\r\n        var endNode = endPosition.node;\r\n        if (startNode === endNode) {\r\n            var startSplitPosInBuffer_1 = this.positionInBuffer(startNode, startPosition.remainder);\r\n            var endSplitPosInBuffer_1 = this.positionInBuffer(startNode, endPosition.remainder);\r\n            if (startPosition.nodeStartOffset === offset) {\r\n                if (cnt === startNode.piece.length) { // delete node\r\n                    var next = startNode.next();\r\n                    rbDelete(this, startNode);\r\n                    this.validateCRLFWithPrevNode(next);\r\n                    this.computeBufferMetadata();\r\n                    return;\r\n                }\r\n                this.deleteNodeHead(startNode, endSplitPosInBuffer_1);\r\n                this._searchCache.valdiate(offset);\r\n                this.validateCRLFWithPrevNode(startNode);\r\n                this.computeBufferMetadata();\r\n                return;\r\n            }\r\n            if (startPosition.nodeStartOffset + startNode.piece.length === offset + cnt) {\r\n                this.deleteNodeTail(startNode, startSplitPosInBuffer_1);\r\n                this.validateCRLFWithNextNode(startNode);\r\n                this.computeBufferMetadata();\r\n                return;\r\n            }\r\n            // delete content in the middle, this node will be splitted to nodes\r\n            this.shrinkNode(startNode, startSplitPosInBuffer_1, endSplitPosInBuffer_1);\r\n            this.computeBufferMetadata();\r\n            return;\r\n        }\r\n        var nodesToDel = [];\r\n        var startSplitPosInBuffer = this.positionInBuffer(startNode, startPosition.remainder);\r\n        this.deleteNodeTail(startNode, startSplitPosInBuffer);\r\n        this._searchCache.valdiate(offset);\r\n        if (startNode.piece.length === 0) {\r\n            nodesToDel.push(startNode);\r\n        }\r\n        // update last touched node\r\n        var endSplitPosInBuffer = this.positionInBuffer(endNode, endPosition.remainder);\r\n        this.deleteNodeHead(endNode, endSplitPosInBuffer);\r\n        if (endNode.piece.length === 0) {\r\n            nodesToDel.push(endNode);\r\n        }\r\n        // delete nodes in between\r\n        var secondNode = startNode.next();\r\n        for (var node = secondNode; node !== SENTINEL && node !== endNode; node = node.next()) {\r\n            nodesToDel.push(node);\r\n        }\r\n        var prev = startNode.piece.length === 0 ? startNode.prev() : startNode;\r\n        this.deleteNodes(nodesToDel);\r\n        this.validateCRLFWithNextNode(prev);\r\n        this.computeBufferMetadata();\r\n    };\r\n    PieceTreeBase.prototype.insertContentToNodeLeft = function (value, node) {\r\n        // we are inserting content to the beginning of node\r\n        var nodesToDel = [];\r\n        if (this.shouldCheckCRLF() && this.endWithCR(value) && this.startWithLF(node)) {\r\n            // move `\\n` to new node.\r\n            var piece = node.piece;\r\n            var newStart = { line: piece.start.line + 1, column: 0 };\r\n            var nPiece = new Piece(piece.bufferIndex, newStart, piece.end, this.getLineFeedCnt(piece.bufferIndex, newStart, piece.end), piece.length - 1);\r\n            node.piece = nPiece;\r\n            value += '\\n';\r\n            updateTreeMetadata(this, node, -1, -1);\r\n            if (node.piece.length === 0) {\r\n                nodesToDel.push(node);\r\n            }\r\n        }\r\n        var newPieces = this.createNewPieces(value);\r\n        var newNode = this.rbInsertLeft(node, newPieces[newPieces.length - 1]);\r\n        for (var k = newPieces.length - 2; k >= 0; k--) {\r\n            newNode = this.rbInsertLeft(newNode, newPieces[k]);\r\n        }\r\n        this.validateCRLFWithPrevNode(newNode);\r\n        this.deleteNodes(nodesToDel);\r\n    };\r\n    PieceTreeBase.prototype.insertContentToNodeRight = function (value, node) {\r\n        // we are inserting to the right of this node.\r\n        if (this.adjustCarriageReturnFromNext(value, node)) {\r\n            // move \\n to the new node.\r\n            value += '\\n';\r\n        }\r\n        var newPieces = this.createNewPieces(value);\r\n        var newNode = this.rbInsertRight(node, newPieces[0]);\r\n        var tmpNode = newNode;\r\n        for (var k = 1; k < newPieces.length; k++) {\r\n            tmpNode = this.rbInsertRight(tmpNode, newPieces[k]);\r\n        }\r\n        this.validateCRLFWithPrevNode(newNode);\r\n    };\r\n    PieceTreeBase.prototype.positionInBuffer = function (node, remainder, ret) {\r\n        var piece = node.piece;\r\n        var bufferIndex = node.piece.bufferIndex;\r\n        var lineStarts = this._buffers[bufferIndex].lineStarts;\r\n        var startOffset = lineStarts[piece.start.line] + piece.start.column;\r\n        var offset = startOffset + remainder;\r\n        // binary search offset between startOffset and endOffset\r\n        var low = piece.start.line;\r\n        var high = piece.end.line;\r\n        var mid = 0;\r\n        var midStop = 0;\r\n        var midStart = 0;\r\n        while (low <= high) {\r\n            mid = low + ((high - low) / 2) | 0;\r\n            midStart = lineStarts[mid];\r\n            if (mid === high) {\r\n                break;\r\n            }\r\n            midStop = lineStarts[mid + 1];\r\n            if (offset < midStart) {\r\n                high = mid - 1;\r\n            }\r\n            else if (offset >= midStop) {\r\n                low = mid + 1;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        if (ret) {\r\n            ret.line = mid;\r\n            ret.column = offset - midStart;\r\n            return null;\r\n        }\r\n        return {\r\n            line: mid,\r\n            column: offset - midStart\r\n        };\r\n    };\r\n    PieceTreeBase.prototype.getLineFeedCnt = function (bufferIndex, start, end) {\r\n        // we don't need to worry about start: abc\\r|\\n, or abc|\\r, or abc|\\n, or abc|\\r\\n doesn't change the fact that, there is one line break after start.\r\n        // now let's take care of end: abc\\r|\\n, if end is in between \\r and \\n, we need to add line feed count by 1\r\n        if (end.column === 0) {\r\n            return end.line - start.line;\r\n        }\r\n        var lineStarts = this._buffers[bufferIndex].lineStarts;\r\n        if (end.line === lineStarts.length - 1) { // it means, there is no \\n after end, otherwise, there will be one more lineStart.\r\n            return end.line - start.line;\r\n        }\r\n        var nextLineStartOffset = lineStarts[end.line + 1];\r\n        var endOffset = lineStarts[end.line] + end.column;\r\n        if (nextLineStartOffset > endOffset + 1) { // there are more than 1 character after end, which means it can't be \\n\r\n            return end.line - start.line;\r\n        }\r\n        // endOffset + 1 === nextLineStartOffset\r\n        // character at endOffset is \\n, so we check the character before first\r\n        // if character at endOffset is \\r, end.column is 0 and we can't get here.\r\n        var previousCharOffset = endOffset - 1; // end.column > 0 so it's okay.\r\n        var buffer = this._buffers[bufferIndex].buffer;\r\n        if (buffer.charCodeAt(previousCharOffset) === 13) {\r\n            return end.line - start.line + 1;\r\n        }\r\n        else {\r\n            return end.line - start.line;\r\n        }\r\n    };\r\n    PieceTreeBase.prototype.offsetInBuffer = function (bufferIndex, cursor) {\r\n        var lineStarts = this._buffers[bufferIndex].lineStarts;\r\n        return lineStarts[cursor.line] + cursor.column;\r\n    };\r\n    PieceTreeBase.prototype.deleteNodes = function (nodes) {\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            rbDelete(this, nodes[i]);\r\n        }\r\n    };\r\n    PieceTreeBase.prototype.createNewPieces = function (text) {\r\n        if (text.length > AverageBufferSize) {\r\n            // the content is large, operations like substring, charCode becomes slow\r\n            // so here we split it into smaller chunks, just like what we did for CR/LF normalization\r\n            var newPieces = [];\r\n            while (text.length > AverageBufferSize) {\r\n                var lastChar = text.charCodeAt(AverageBufferSize - 1);\r\n                var splitText = void 0;\r\n                if (lastChar === 13 /* CarriageReturn */ || (lastChar >= 0xd800 && lastChar <= 0xdbff)) {\r\n                    // last character is \\r or a high surrogate => keep it back\r\n                    splitText = text.substring(0, AverageBufferSize - 1);\r\n                    text = text.substring(AverageBufferSize - 1);\r\n                }\r\n                else {\r\n                    splitText = text.substring(0, AverageBufferSize);\r\n                    text = text.substring(AverageBufferSize);\r\n                }\r\n                var lineStarts_1 = createLineStartsFast(splitText);\r\n                newPieces.push(new Piece(this._buffers.length, /* buffer index */ { line: 0, column: 0 }, { line: lineStarts_1.length - 1, column: splitText.length - lineStarts_1[lineStarts_1.length - 1] }, lineStarts_1.length - 1, splitText.length));\r\n                this._buffers.push(new StringBuffer(splitText, lineStarts_1));\r\n            }\r\n            var lineStarts_2 = createLineStartsFast(text);\r\n            newPieces.push(new Piece(this._buffers.length, /* buffer index */ { line: 0, column: 0 }, { line: lineStarts_2.length - 1, column: text.length - lineStarts_2[lineStarts_2.length - 1] }, lineStarts_2.length - 1, text.length));\r\n            this._buffers.push(new StringBuffer(text, lineStarts_2));\r\n            return newPieces;\r\n        }\r\n        var startOffset = this._buffers[0].buffer.length;\r\n        var lineStarts = createLineStartsFast(text, false);\r\n        var start = this._lastChangeBufferPos;\r\n        if (this._buffers[0].lineStarts[this._buffers[0].lineStarts.length - 1] === startOffset\r\n            && startOffset !== 0\r\n            && this.startWithLF(text)\r\n            && this.endWithCR(this._buffers[0].buffer) // todo, we can check this._lastChangeBufferPos's column as it's the last one\r\n        ) {\r\n            this._lastChangeBufferPos = { line: this._lastChangeBufferPos.line, column: this._lastChangeBufferPos.column + 1 };\r\n            start = this._lastChangeBufferPos;\r\n            for (var i = 0; i < lineStarts.length; i++) {\r\n                lineStarts[i] += startOffset + 1;\r\n            }\r\n            this._buffers[0].lineStarts = this._buffers[0].lineStarts.concat(lineStarts.slice(1));\r\n            this._buffers[0].buffer += '_' + text;\r\n            startOffset += 1;\r\n        }\r\n        else {\r\n            if (startOffset !== 0) {\r\n                for (var i = 0; i < lineStarts.length; i++) {\r\n                    lineStarts[i] += startOffset;\r\n                }\r\n            }\r\n            this._buffers[0].lineStarts = this._buffers[0].lineStarts.concat(lineStarts.slice(1));\r\n            this._buffers[0].buffer += text;\r\n        }\r\n        var endOffset = this._buffers[0].buffer.length;\r\n        var endIndex = this._buffers[0].lineStarts.length - 1;\r\n        var endColumn = endOffset - this._buffers[0].lineStarts[endIndex];\r\n        var endPos = { line: endIndex, column: endColumn };\r\n        var newPiece = new Piece(0, /** todo@peng */ start, endPos, this.getLineFeedCnt(0, start, endPos), endOffset - startOffset);\r\n        this._lastChangeBufferPos = endPos;\r\n        return [newPiece];\r\n    };\r\n    PieceTreeBase.prototype.getLineRawContent = function (lineNumber, endOffset) {\r\n        if (endOffset === void 0) { endOffset = 0; }\r\n        var x = this.root;\r\n        var ret = '';\r\n        var cache = this._searchCache.get2(lineNumber);\r\n        if (cache) {\r\n            x = cache.node;\r\n            var prevAccumualtedValue = this.getAccumulatedValue(x, lineNumber - cache.nodeStartLineNumber - 1);\r\n            var buffer = this._buffers[x.piece.bufferIndex].buffer;\r\n            var startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\r\n            if (cache.nodeStartLineNumber + x.piece.lineFeedCnt === lineNumber) {\r\n                ret = buffer.substring(startOffset + prevAccumualtedValue, startOffset + x.piece.length);\r\n            }\r\n            else {\r\n                var accumualtedValue = this.getAccumulatedValue(x, lineNumber - cache.nodeStartLineNumber);\r\n                return buffer.substring(startOffset + prevAccumualtedValue, startOffset + accumualtedValue - endOffset);\r\n            }\r\n        }\r\n        else {\r\n            var nodeStartOffset = 0;\r\n            var originalLineNumber = lineNumber;\r\n            while (x !== SENTINEL) {\r\n                if (x.left !== SENTINEL && x.lf_left >= lineNumber - 1) {\r\n                    x = x.left;\r\n                }\r\n                else if (x.lf_left + x.piece.lineFeedCnt > lineNumber - 1) {\r\n                    var prevAccumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 2);\r\n                    var accumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 1);\r\n                    var buffer = this._buffers[x.piece.bufferIndex].buffer;\r\n                    var startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\r\n                    nodeStartOffset += x.size_left;\r\n                    this._searchCache.set({\r\n                        node: x,\r\n                        nodeStartOffset: nodeStartOffset,\r\n                        nodeStartLineNumber: originalLineNumber - (lineNumber - 1 - x.lf_left)\r\n                    });\r\n                    return buffer.substring(startOffset + prevAccumualtedValue, startOffset + accumualtedValue - endOffset);\r\n                }\r\n                else if (x.lf_left + x.piece.lineFeedCnt === lineNumber - 1) {\r\n                    var prevAccumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 2);\r\n                    var buffer = this._buffers[x.piece.bufferIndex].buffer;\r\n                    var startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\r\n                    ret = buffer.substring(startOffset + prevAccumualtedValue, startOffset + x.piece.length);\r\n                    break;\r\n                }\r\n                else {\r\n                    lineNumber -= x.lf_left + x.piece.lineFeedCnt;\r\n                    nodeStartOffset += x.size_left + x.piece.length;\r\n                    x = x.right;\r\n                }\r\n            }\r\n        }\r\n        // search in order, to find the node contains end column\r\n        x = x.next();\r\n        while (x !== SENTINEL) {\r\n            var buffer = this._buffers[x.piece.bufferIndex].buffer;\r\n            if (x.piece.lineFeedCnt > 0) {\r\n                var accumualtedValue = this.getAccumulatedValue(x, 0);\r\n                var startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\r\n                ret += buffer.substring(startOffset, startOffset + accumualtedValue - endOffset);\r\n                return ret;\r\n            }\r\n            else {\r\n                var startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\r\n                ret += buffer.substr(startOffset, x.piece.length);\r\n            }\r\n            x = x.next();\r\n        }\r\n        return ret;\r\n    };\r\n    PieceTreeBase.prototype.computeBufferMetadata = function () {\r\n        var x = this.root;\r\n        var lfCnt = 1;\r\n        var len = 0;\r\n        while (x !== SENTINEL) {\r\n            lfCnt += x.lf_left + x.piece.lineFeedCnt;\r\n            len += x.size_left + x.piece.length;\r\n            x = x.right;\r\n        }\r\n        this._lineCnt = lfCnt;\r\n        this._length = len;\r\n        this._searchCache.valdiate(this._length);\r\n    };\r\n    // #region node operations\r\n    PieceTreeBase.prototype.getIndexOf = function (node, accumulatedValue) {\r\n        var piece = node.piece;\r\n        var pos = this.positionInBuffer(node, accumulatedValue);\r\n        var lineCnt = pos.line - piece.start.line;\r\n        if (this.offsetInBuffer(piece.bufferIndex, piece.end) - this.offsetInBuffer(piece.bufferIndex, piece.start) === accumulatedValue) {\r\n            // we are checking the end of this node, so a CRLF check is necessary.\r\n            var realLineCnt = this.getLineFeedCnt(node.piece.bufferIndex, piece.start, pos);\r\n            if (realLineCnt !== lineCnt) {\r\n                // aha yes, CRLF\r\n                return { index: realLineCnt, remainder: 0 };\r\n            }\r\n        }\r\n        return { index: lineCnt, remainder: pos.column };\r\n    };\r\n    PieceTreeBase.prototype.getAccumulatedValue = function (node, index) {\r\n        if (index < 0) {\r\n            return 0;\r\n        }\r\n        var piece = node.piece;\r\n        var lineStarts = this._buffers[piece.bufferIndex].lineStarts;\r\n        var expectedLineStartIndex = piece.start.line + index + 1;\r\n        if (expectedLineStartIndex > piece.end.line) {\r\n            return lineStarts[piece.end.line] + piece.end.column - lineStarts[piece.start.line] - piece.start.column;\r\n        }\r\n        else {\r\n            return lineStarts[expectedLineStartIndex] - lineStarts[piece.start.line] - piece.start.column;\r\n        }\r\n    };\r\n    PieceTreeBase.prototype.deleteNodeTail = function (node, pos) {\r\n        var piece = node.piece;\r\n        var originalLFCnt = piece.lineFeedCnt;\r\n        var originalEndOffset = this.offsetInBuffer(piece.bufferIndex, piece.end);\r\n        var newEnd = pos;\r\n        var newEndOffset = this.offsetInBuffer(piece.bufferIndex, newEnd);\r\n        var newLineFeedCnt = this.getLineFeedCnt(piece.bufferIndex, piece.start, newEnd);\r\n        var lf_delta = newLineFeedCnt - originalLFCnt;\r\n        var size_delta = newEndOffset - originalEndOffset;\r\n        var newLength = piece.length + size_delta;\r\n        node.piece = new Piece(piece.bufferIndex, piece.start, newEnd, newLineFeedCnt, newLength);\r\n        updateTreeMetadata(this, node, size_delta, lf_delta);\r\n    };\r\n    PieceTreeBase.prototype.deleteNodeHead = function (node, pos) {\r\n        var piece = node.piece;\r\n        var originalLFCnt = piece.lineFeedCnt;\r\n        var originalStartOffset = this.offsetInBuffer(piece.bufferIndex, piece.start);\r\n        var newStart = pos;\r\n        var newLineFeedCnt = this.getLineFeedCnt(piece.bufferIndex, newStart, piece.end);\r\n        var newStartOffset = this.offsetInBuffer(piece.bufferIndex, newStart);\r\n        var lf_delta = newLineFeedCnt - originalLFCnt;\r\n        var size_delta = originalStartOffset - newStartOffset;\r\n        var newLength = piece.length + size_delta;\r\n        node.piece = new Piece(piece.bufferIndex, newStart, piece.end, newLineFeedCnt, newLength);\r\n        updateTreeMetadata(this, node, size_delta, lf_delta);\r\n    };\r\n    PieceTreeBase.prototype.shrinkNode = function (node, start, end) {\r\n        var piece = node.piece;\r\n        var originalStartPos = piece.start;\r\n        var originalEndPos = piece.end;\r\n        // old piece, originalStartPos, start\r\n        var oldLength = piece.length;\r\n        var oldLFCnt = piece.lineFeedCnt;\r\n        var newEnd = start;\r\n        var newLineFeedCnt = this.getLineFeedCnt(piece.bufferIndex, piece.start, newEnd);\r\n        var newLength = this.offsetInBuffer(piece.bufferIndex, start) - this.offsetInBuffer(piece.bufferIndex, originalStartPos);\r\n        node.piece = new Piece(piece.bufferIndex, piece.start, newEnd, newLineFeedCnt, newLength);\r\n        updateTreeMetadata(this, node, newLength - oldLength, newLineFeedCnt - oldLFCnt);\r\n        // new right piece, end, originalEndPos\r\n        var newPiece = new Piece(piece.bufferIndex, end, originalEndPos, this.getLineFeedCnt(piece.bufferIndex, end, originalEndPos), this.offsetInBuffer(piece.bufferIndex, originalEndPos) - this.offsetInBuffer(piece.bufferIndex, end));\r\n        var newNode = this.rbInsertRight(node, newPiece);\r\n        this.validateCRLFWithPrevNode(newNode);\r\n    };\r\n    PieceTreeBase.prototype.appendToNode = function (node, value) {\r\n        if (this.adjustCarriageReturnFromNext(value, node)) {\r\n            value += '\\n';\r\n        }\r\n        var hitCRLF = this.shouldCheckCRLF() && this.startWithLF(value) && this.endWithCR(node);\r\n        var startOffset = this._buffers[0].buffer.length;\r\n        this._buffers[0].buffer += value;\r\n        var lineStarts = createLineStartsFast(value, false);\r\n        for (var i = 0; i < lineStarts.length; i++) {\r\n            lineStarts[i] += startOffset;\r\n        }\r\n        if (hitCRLF) {\r\n            var prevStartOffset = this._buffers[0].lineStarts[this._buffers[0].lineStarts.length - 2];\r\n            this._buffers[0].lineStarts.pop();\r\n            // _lastChangeBufferPos is already wrong\r\n            this._lastChangeBufferPos = { line: this._lastChangeBufferPos.line - 1, column: startOffset - prevStartOffset };\r\n        }\r\n        this._buffers[0].lineStarts = this._buffers[0].lineStarts.concat(lineStarts.slice(1));\r\n        var endIndex = this._buffers[0].lineStarts.length - 1;\r\n        var endColumn = this._buffers[0].buffer.length - this._buffers[0].lineStarts[endIndex];\r\n        var newEnd = { line: endIndex, column: endColumn };\r\n        var newLength = node.piece.length + value.length;\r\n        var oldLineFeedCnt = node.piece.lineFeedCnt;\r\n        var newLineFeedCnt = this.getLineFeedCnt(0, node.piece.start, newEnd);\r\n        var lf_delta = newLineFeedCnt - oldLineFeedCnt;\r\n        node.piece = new Piece(node.piece.bufferIndex, node.piece.start, newEnd, newLineFeedCnt, newLength);\r\n        this._lastChangeBufferPos = newEnd;\r\n        updateTreeMetadata(this, node, value.length, lf_delta);\r\n    };\r\n    PieceTreeBase.prototype.nodeAt = function (offset) {\r\n        var x = this.root;\r\n        var cache = this._searchCache.get(offset);\r\n        if (cache) {\r\n            return {\r\n                node: cache.node,\r\n                nodeStartOffset: cache.nodeStartOffset,\r\n                remainder: offset - cache.nodeStartOffset\r\n            };\r\n        }\r\n        var nodeStartOffset = 0;\r\n        while (x !== SENTINEL) {\r\n            if (x.size_left > offset) {\r\n                x = x.left;\r\n            }\r\n            else if (x.size_left + x.piece.length >= offset) {\r\n                nodeStartOffset += x.size_left;\r\n                var ret = {\r\n                    node: x,\r\n                    remainder: offset - x.size_left,\r\n                    nodeStartOffset: nodeStartOffset\r\n                };\r\n                this._searchCache.set(ret);\r\n                return ret;\r\n            }\r\n            else {\r\n                offset -= x.size_left + x.piece.length;\r\n                nodeStartOffset += x.size_left + x.piece.length;\r\n                x = x.right;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    PieceTreeBase.prototype.nodeAt2 = function (lineNumber, column) {\r\n        var x = this.root;\r\n        var nodeStartOffset = 0;\r\n        while (x !== SENTINEL) {\r\n            if (x.left !== SENTINEL && x.lf_left >= lineNumber - 1) {\r\n                x = x.left;\r\n            }\r\n            else if (x.lf_left + x.piece.lineFeedCnt > lineNumber - 1) {\r\n                var prevAccumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 2);\r\n                var accumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 1);\r\n                nodeStartOffset += x.size_left;\r\n                return {\r\n                    node: x,\r\n                    remainder: Math.min(prevAccumualtedValue + column - 1, accumualtedValue),\r\n                    nodeStartOffset: nodeStartOffset\r\n                };\r\n            }\r\n            else if (x.lf_left + x.piece.lineFeedCnt === lineNumber - 1) {\r\n                var prevAccumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 2);\r\n                if (prevAccumualtedValue + column - 1 <= x.piece.length) {\r\n                    return {\r\n                        node: x,\r\n                        remainder: prevAccumualtedValue + column - 1,\r\n                        nodeStartOffset: nodeStartOffset\r\n                    };\r\n                }\r\n                else {\r\n                    column -= x.piece.length - prevAccumualtedValue;\r\n                    break;\r\n                }\r\n            }\r\n            else {\r\n                lineNumber -= x.lf_left + x.piece.lineFeedCnt;\r\n                nodeStartOffset += x.size_left + x.piece.length;\r\n                x = x.right;\r\n            }\r\n        }\r\n        // search in order, to find the node contains position.column\r\n        x = x.next();\r\n        while (x !== SENTINEL) {\r\n            if (x.piece.lineFeedCnt > 0) {\r\n                var accumualtedValue = this.getAccumulatedValue(x, 0);\r\n                var nodeStartOffset_1 = this.offsetOfNode(x);\r\n                return {\r\n                    node: x,\r\n                    remainder: Math.min(column - 1, accumualtedValue),\r\n                    nodeStartOffset: nodeStartOffset_1\r\n                };\r\n            }\r\n            else {\r\n                if (x.piece.length >= column - 1) {\r\n                    var nodeStartOffset_2 = this.offsetOfNode(x);\r\n                    return {\r\n                        node: x,\r\n                        remainder: column - 1,\r\n                        nodeStartOffset: nodeStartOffset_2\r\n                    };\r\n                }\r\n                else {\r\n                    column -= x.piece.length;\r\n                }\r\n            }\r\n            x = x.next();\r\n        }\r\n        return null;\r\n    };\r\n    PieceTreeBase.prototype.nodeCharCodeAt = function (node, offset) {\r\n        if (node.piece.lineFeedCnt < 1) {\r\n            return -1;\r\n        }\r\n        var buffer = this._buffers[node.piece.bufferIndex];\r\n        var newOffset = this.offsetInBuffer(node.piece.bufferIndex, node.piece.start) + offset;\r\n        return buffer.buffer.charCodeAt(newOffset);\r\n    };\r\n    PieceTreeBase.prototype.offsetOfNode = function (node) {\r\n        if (!node) {\r\n            return 0;\r\n        }\r\n        var pos = node.size_left;\r\n        while (node !== this.root) {\r\n            if (node.parent.right === node) {\r\n                pos += node.parent.size_left + node.parent.piece.length;\r\n            }\r\n            node = node.parent;\r\n        }\r\n        return pos;\r\n    };\r\n    // #endregion\r\n    // #region CRLF\r\n    PieceTreeBase.prototype.shouldCheckCRLF = function () {\r\n        return !(this._EOLNormalized && this._EOL === '\\n');\r\n    };\r\n    PieceTreeBase.prototype.startWithLF = function (val) {\r\n        if (typeof val === 'string') {\r\n            return val.charCodeAt(0) === 10;\r\n        }\r\n        if (val === SENTINEL || val.piece.lineFeedCnt === 0) {\r\n            return false;\r\n        }\r\n        var piece = val.piece;\r\n        var lineStarts = this._buffers[piece.bufferIndex].lineStarts;\r\n        var line = piece.start.line;\r\n        var startOffset = lineStarts[line] + piece.start.column;\r\n        if (line === lineStarts.length - 1) {\r\n            // last line, so there is no line feed at the end of this line\r\n            return false;\r\n        }\r\n        var nextLineOffset = lineStarts[line + 1];\r\n        if (nextLineOffset > startOffset + 1) {\r\n            return false;\r\n        }\r\n        return this._buffers[piece.bufferIndex].buffer.charCodeAt(startOffset) === 10;\r\n    };\r\n    PieceTreeBase.prototype.endWithCR = function (val) {\r\n        if (typeof val === 'string') {\r\n            return val.charCodeAt(val.length - 1) === 13;\r\n        }\r\n        if (val === SENTINEL || val.piece.lineFeedCnt === 0) {\r\n            return false;\r\n        }\r\n        return this.nodeCharCodeAt(val, val.piece.length - 1) === 13;\r\n    };\r\n    PieceTreeBase.prototype.validateCRLFWithPrevNode = function (nextNode) {\r\n        if (this.shouldCheckCRLF() && this.startWithLF(nextNode)) {\r\n            var node = nextNode.prev();\r\n            if (this.endWithCR(node)) {\r\n                this.fixCRLF(node, nextNode);\r\n            }\r\n        }\r\n    };\r\n    PieceTreeBase.prototype.validateCRLFWithNextNode = function (node) {\r\n        if (this.shouldCheckCRLF() && this.endWithCR(node)) {\r\n            var nextNode = node.next();\r\n            if (this.startWithLF(nextNode)) {\r\n                this.fixCRLF(node, nextNode);\r\n            }\r\n        }\r\n    };\r\n    PieceTreeBase.prototype.fixCRLF = function (prev, next) {\r\n        var nodesToDel = [];\r\n        // update node\r\n        var lineStarts = this._buffers[prev.piece.bufferIndex].lineStarts;\r\n        var newEnd;\r\n        if (prev.piece.end.column === 0) {\r\n            // it means, last line ends with \\r, not \\r\\n\r\n            newEnd = { line: prev.piece.end.line - 1, column: lineStarts[prev.piece.end.line] - lineStarts[prev.piece.end.line - 1] - 1 };\r\n        }\r\n        else {\r\n            // \\r\\n\r\n            newEnd = { line: prev.piece.end.line, column: prev.piece.end.column - 1 };\r\n        }\r\n        var prevNewLength = prev.piece.length - 1;\r\n        var prevNewLFCnt = prev.piece.lineFeedCnt - 1;\r\n        prev.piece = new Piece(prev.piece.bufferIndex, prev.piece.start, newEnd, prevNewLFCnt, prevNewLength);\r\n        updateTreeMetadata(this, prev, -1, -1);\r\n        if (prev.piece.length === 0) {\r\n            nodesToDel.push(prev);\r\n        }\r\n        // update nextNode\r\n        var newStart = { line: next.piece.start.line + 1, column: 0 };\r\n        var newLength = next.piece.length - 1;\r\n        var newLineFeedCnt = this.getLineFeedCnt(next.piece.bufferIndex, newStart, next.piece.end);\r\n        next.piece = new Piece(next.piece.bufferIndex, newStart, next.piece.end, newLineFeedCnt, newLength);\r\n        updateTreeMetadata(this, next, -1, -1);\r\n        if (next.piece.length === 0) {\r\n            nodesToDel.push(next);\r\n        }\r\n        // create new piece which contains \\r\\n\r\n        var pieces = this.createNewPieces('\\r\\n');\r\n        this.rbInsertRight(prev, pieces[0]);\r\n        // delete empty nodes\r\n        for (var i = 0; i < nodesToDel.length; i++) {\r\n            rbDelete(this, nodesToDel[i]);\r\n        }\r\n    };\r\n    PieceTreeBase.prototype.adjustCarriageReturnFromNext = function (value, node) {\r\n        if (this.shouldCheckCRLF() && this.endWithCR(value)) {\r\n            var nextNode = node.next();\r\n            if (this.startWithLF(nextNode)) {\r\n                // move `\\n` forward\r\n                value += '\\n';\r\n                if (nextNode.piece.length === 1) {\r\n                    rbDelete(this, nextNode);\r\n                }\r\n                else {\r\n                    var piece = nextNode.piece;\r\n                    var newStart = { line: piece.start.line + 1, column: 0 };\r\n                    var newLength = piece.length - 1;\r\n                    var newLineFeedCnt = this.getLineFeedCnt(piece.bufferIndex, newStart, piece.end);\r\n                    nextNode.piece = new Piece(piece.bufferIndex, newStart, piece.end, newLineFeedCnt, newLength);\r\n                    updateTreeMetadata(this, nextNode, -1, -1);\r\n                }\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    // #endregion\r\n    // #endregion\r\n    // #region Tree operations\r\n    PieceTreeBase.prototype.iterate = function (node, callback) {\r\n        if (node === SENTINEL) {\r\n            return callback(SENTINEL);\r\n        }\r\n        var leftRet = this.iterate(node.left, callback);\r\n        if (!leftRet) {\r\n            return leftRet;\r\n        }\r\n        return callback(node) && this.iterate(node.right, callback);\r\n    };\r\n    PieceTreeBase.prototype.getNodeContent = function (node) {\r\n        if (node === SENTINEL) {\r\n            return '';\r\n        }\r\n        var buffer = this._buffers[node.piece.bufferIndex];\r\n        var currentContent;\r\n        var piece = node.piece;\r\n        var startOffset = this.offsetInBuffer(piece.bufferIndex, piece.start);\r\n        var endOffset = this.offsetInBuffer(piece.bufferIndex, piece.end);\r\n        currentContent = buffer.buffer.substring(startOffset, endOffset);\r\n        return currentContent;\r\n    };\r\n    /**\r\n     *      node              node\r\n     *     /  \\              /  \\\r\n     *    a   b    <----   a    b\r\n     *                         /\r\n     *                        z\r\n     */\r\n    PieceTreeBase.prototype.rbInsertRight = function (node, p) {\r\n        var z = new TreeNode(p, 1 /* Red */);\r\n        z.left = SENTINEL;\r\n        z.right = SENTINEL;\r\n        z.parent = SENTINEL;\r\n        z.size_left = 0;\r\n        z.lf_left = 0;\r\n        var x = this.root;\r\n        if (x === SENTINEL) {\r\n            this.root = z;\r\n            z.color = 0 /* Black */;\r\n        }\r\n        else if (node.right === SENTINEL) {\r\n            node.right = z;\r\n            z.parent = node;\r\n        }\r\n        else {\r\n            var nextNode = leftest(node.right);\r\n            nextNode.left = z;\r\n            z.parent = nextNode;\r\n        }\r\n        fixInsert(this, z);\r\n        return z;\r\n    };\r\n    /**\r\n     *      node              node\r\n     *     /  \\              /  \\\r\n     *    a   b     ---->   a    b\r\n     *                       \\\r\n     *                        z\r\n     */\r\n    PieceTreeBase.prototype.rbInsertLeft = function (node, p) {\r\n        var z = new TreeNode(p, 1 /* Red */);\r\n        z.left = SENTINEL;\r\n        z.right = SENTINEL;\r\n        z.parent = SENTINEL;\r\n        z.size_left = 0;\r\n        z.lf_left = 0;\r\n        if (this.root === SENTINEL) {\r\n            this.root = z;\r\n            z.color = 0 /* Black */;\r\n        }\r\n        else if (node.left === SENTINEL) {\r\n            node.left = z;\r\n            z.parent = node;\r\n        }\r\n        else {\r\n            var prevNode = righttest(node.left); // a\r\n            prevNode.right = z;\r\n            z.parent = prevNode;\r\n        }\r\n        fixInsert(this, z);\r\n        return z;\r\n    };\r\n    PieceTreeBase.prototype.getContentOfSubTree = function (node) {\r\n        var _this = this;\r\n        var str = '';\r\n        this.iterate(node, function (node) {\r\n            str += _this.getNodeContent(node);\r\n            return true;\r\n        });\r\n        return str;\r\n    };\r\n    return PieceTreeBase;\r\n}());\r\nexport { PieceTreeBase };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { Range } from '../../core/range.js';\r\nimport { ApplyEditsResult } from '../../model.js';\r\nimport { PieceTreeBase } from './pieceTreeBase.js';\r\nvar PieceTreeTextBuffer = /** @class */ (function () {\r\n    function PieceTreeTextBuffer(chunks, BOM, eol, containsRTL, isBasicASCII, eolNormalized) {\r\n        this._BOM = BOM;\r\n        this._mightContainNonBasicASCII = !isBasicASCII;\r\n        this._mightContainRTL = containsRTL;\r\n        this._pieceTree = new PieceTreeBase(chunks, eol, eolNormalized);\r\n    }\r\n    PieceTreeTextBuffer.prototype.mightContainRTL = function () {\r\n        return this._mightContainRTL;\r\n    };\r\n    PieceTreeTextBuffer.prototype.mightContainNonBasicASCII = function () {\r\n        return this._mightContainNonBasicASCII;\r\n    };\r\n    PieceTreeTextBuffer.prototype.getBOM = function () {\r\n        return this._BOM;\r\n    };\r\n    PieceTreeTextBuffer.prototype.getEOL = function () {\r\n        return this._pieceTree.getEOL();\r\n    };\r\n    PieceTreeTextBuffer.prototype.getOffsetAt = function (lineNumber, column) {\r\n        return this._pieceTree.getOffsetAt(lineNumber, column);\r\n    };\r\n    PieceTreeTextBuffer.prototype.getPositionAt = function (offset) {\r\n        return this._pieceTree.getPositionAt(offset);\r\n    };\r\n    PieceTreeTextBuffer.prototype.getRangeAt = function (start, length) {\r\n        var end = start + length;\r\n        var startPosition = this.getPositionAt(start);\r\n        var endPosition = this.getPositionAt(end);\r\n        return new Range(startPosition.lineNumber, startPosition.column, endPosition.lineNumber, endPosition.column);\r\n    };\r\n    PieceTreeTextBuffer.prototype.getValueInRange = function (range, eol) {\r\n        if (eol === void 0) { eol = 0 /* TextDefined */; }\r\n        if (range.isEmpty()) {\r\n            return '';\r\n        }\r\n        var lineEnding = this._getEndOfLine(eol);\r\n        return this._pieceTree.getValueInRange(range, lineEnding);\r\n    };\r\n    PieceTreeTextBuffer.prototype.getValueLengthInRange = function (range, eol) {\r\n        if (eol === void 0) { eol = 0 /* TextDefined */; }\r\n        if (range.isEmpty()) {\r\n            return 0;\r\n        }\r\n        if (range.startLineNumber === range.endLineNumber) {\r\n            return (range.endColumn - range.startColumn);\r\n        }\r\n        var startOffset = this.getOffsetAt(range.startLineNumber, range.startColumn);\r\n        var endOffset = this.getOffsetAt(range.endLineNumber, range.endColumn);\r\n        return endOffset - startOffset;\r\n    };\r\n    PieceTreeTextBuffer.prototype.getLength = function () {\r\n        return this._pieceTree.getLength();\r\n    };\r\n    PieceTreeTextBuffer.prototype.getLineCount = function () {\r\n        return this._pieceTree.getLineCount();\r\n    };\r\n    PieceTreeTextBuffer.prototype.getLinesContent = function () {\r\n        return this._pieceTree.getLinesContent();\r\n    };\r\n    PieceTreeTextBuffer.prototype.getLineContent = function (lineNumber) {\r\n        return this._pieceTree.getLineContent(lineNumber);\r\n    };\r\n    PieceTreeTextBuffer.prototype.getLineCharCode = function (lineNumber, index) {\r\n        return this._pieceTree.getLineCharCode(lineNumber, index);\r\n    };\r\n    PieceTreeTextBuffer.prototype.getLineLength = function (lineNumber) {\r\n        return this._pieceTree.getLineLength(lineNumber);\r\n    };\r\n    PieceTreeTextBuffer.prototype.getLineFirstNonWhitespaceColumn = function (lineNumber) {\r\n        var result = strings.firstNonWhitespaceIndex(this.getLineContent(lineNumber));\r\n        if (result === -1) {\r\n            return 0;\r\n        }\r\n        return result + 1;\r\n    };\r\n    PieceTreeTextBuffer.prototype.getLineLastNonWhitespaceColumn = function (lineNumber) {\r\n        var result = strings.lastNonWhitespaceIndex(this.getLineContent(lineNumber));\r\n        if (result === -1) {\r\n            return 0;\r\n        }\r\n        return result + 2;\r\n    };\r\n    PieceTreeTextBuffer.prototype._getEndOfLine = function (eol) {\r\n        switch (eol) {\r\n            case 1 /* LF */:\r\n                return '\\n';\r\n            case 2 /* CRLF */:\r\n                return '\\r\\n';\r\n            case 0 /* TextDefined */:\r\n                return this.getEOL();\r\n        }\r\n        throw new Error('Unknown EOL preference');\r\n    };\r\n    PieceTreeTextBuffer.prototype.setEOL = function (newEOL) {\r\n        this._pieceTree.setEOL(newEOL);\r\n    };\r\n    PieceTreeTextBuffer.prototype.applyEdits = function (rawOperations, recordTrimAutoWhitespace) {\r\n        var mightContainRTL = this._mightContainRTL;\r\n        var mightContainNonBasicASCII = this._mightContainNonBasicASCII;\r\n        var canReduceOperations = true;\r\n        var operations = [];\r\n        for (var i = 0; i < rawOperations.length; i++) {\r\n            var op = rawOperations[i];\r\n            if (canReduceOperations && op._isTracked) {\r\n                canReduceOperations = false;\r\n            }\r\n            var validatedRange = op.range;\r\n            if (!mightContainRTL && op.text) {\r\n                // check if the new inserted text contains RTL\r\n                mightContainRTL = strings.containsRTL(op.text);\r\n            }\r\n            if (!mightContainNonBasicASCII && op.text) {\r\n                mightContainNonBasicASCII = !strings.isBasicASCII(op.text);\r\n            }\r\n            operations[i] = {\r\n                sortIndex: i,\r\n                identifier: op.identifier || null,\r\n                range: validatedRange,\r\n                rangeOffset: this.getOffsetAt(validatedRange.startLineNumber, validatedRange.startColumn),\r\n                rangeLength: this.getValueLengthInRange(validatedRange),\r\n                lines: op.text ? op.text.split(/\\r\\n|\\r|\\n/) : null,\r\n                forceMoveMarkers: Boolean(op.forceMoveMarkers),\r\n                isAutoWhitespaceEdit: op.isAutoWhitespaceEdit || false\r\n            };\r\n        }\r\n        // Sort operations ascending\r\n        operations.sort(PieceTreeTextBuffer._sortOpsAscending);\r\n        var hasTouchingRanges = false;\r\n        for (var i = 0, count = operations.length - 1; i < count; i++) {\r\n            var rangeEnd = operations[i].range.getEndPosition();\r\n            var nextRangeStart = operations[i + 1].range.getStartPosition();\r\n            if (nextRangeStart.isBeforeOrEqual(rangeEnd)) {\r\n                if (nextRangeStart.isBefore(rangeEnd)) {\r\n                    // overlapping ranges\r\n                    throw new Error('Overlapping ranges are not allowed!');\r\n                }\r\n                hasTouchingRanges = true;\r\n            }\r\n        }\r\n        if (canReduceOperations) {\r\n            operations = this._reduceOperations(operations);\r\n        }\r\n        // Delta encode operations\r\n        var reverseRanges = PieceTreeTextBuffer._getInverseEditRanges(operations);\r\n        var newTrimAutoWhitespaceCandidates = [];\r\n        for (var i = 0; i < operations.length; i++) {\r\n            var op = operations[i];\r\n            var reverseRange = reverseRanges[i];\r\n            if (recordTrimAutoWhitespace && op.isAutoWhitespaceEdit && op.range.isEmpty()) {\r\n                // Record already the future line numbers that might be auto whitespace removal candidates on next edit\r\n                for (var lineNumber = reverseRange.startLineNumber; lineNumber <= reverseRange.endLineNumber; lineNumber++) {\r\n                    var currentLineContent = '';\r\n                    if (lineNumber === reverseRange.startLineNumber) {\r\n                        currentLineContent = this.getLineContent(op.range.startLineNumber);\r\n                        if (strings.firstNonWhitespaceIndex(currentLineContent) !== -1) {\r\n                            continue;\r\n                        }\r\n                    }\r\n                    newTrimAutoWhitespaceCandidates.push({ lineNumber: lineNumber, oldContent: currentLineContent });\r\n                }\r\n            }\r\n        }\r\n        var reverseOperations = [];\r\n        for (var i = 0; i < operations.length; i++) {\r\n            var op = operations[i];\r\n            var reverseRange = reverseRanges[i];\r\n            reverseOperations[i] = {\r\n                sortIndex: op.sortIndex,\r\n                identifier: op.identifier,\r\n                range: reverseRange,\r\n                text: this.getValueInRange(op.range),\r\n                forceMoveMarkers: op.forceMoveMarkers\r\n            };\r\n        }\r\n        // Can only sort reverse operations when the order is not significant\r\n        if (!hasTouchingRanges) {\r\n            reverseOperations.sort(function (a, b) { return a.sortIndex - b.sortIndex; });\r\n        }\r\n        this._mightContainRTL = mightContainRTL;\r\n        this._mightContainNonBasicASCII = mightContainNonBasicASCII;\r\n        var contentChanges = this._doApplyEdits(operations);\r\n        var trimAutoWhitespaceLineNumbers = null;\r\n        if (recordTrimAutoWhitespace && newTrimAutoWhitespaceCandidates.length > 0) {\r\n            // sort line numbers auto whitespace removal candidates for next edit descending\r\n            newTrimAutoWhitespaceCandidates.sort(function (a, b) { return b.lineNumber - a.lineNumber; });\r\n            trimAutoWhitespaceLineNumbers = [];\r\n            for (var i = 0, len = newTrimAutoWhitespaceCandidates.length; i < len; i++) {\r\n                var lineNumber = newTrimAutoWhitespaceCandidates[i].lineNumber;\r\n                if (i > 0 && newTrimAutoWhitespaceCandidates[i - 1].lineNumber === lineNumber) {\r\n                    // Do not have the same line number twice\r\n                    continue;\r\n                }\r\n                var prevContent = newTrimAutoWhitespaceCandidates[i].oldContent;\r\n                var lineContent = this.getLineContent(lineNumber);\r\n                if (lineContent.length === 0 || lineContent === prevContent || strings.firstNonWhitespaceIndex(lineContent) !== -1) {\r\n                    continue;\r\n                }\r\n                trimAutoWhitespaceLineNumbers.push(lineNumber);\r\n            }\r\n        }\r\n        return new ApplyEditsResult(reverseOperations, contentChanges, trimAutoWhitespaceLineNumbers);\r\n    };\r\n    /**\r\n     * Transform operations such that they represent the same logic edit,\r\n     * but that they also do not cause OOM crashes.\r\n     */\r\n    PieceTreeTextBuffer.prototype._reduceOperations = function (operations) {\r\n        if (operations.length < 1000) {\r\n            // We know from empirical testing that a thousand edits work fine regardless of their shape.\r\n            return operations;\r\n        }\r\n        // At one point, due to how events are emitted and how each operation is handled,\r\n        // some operations can trigger a high amount of temporary string allocations,\r\n        // that will immediately get edited again.\r\n        // e.g. a formatter inserting ridiculous ammounts of \\n on a model with a single line\r\n        // Therefore, the strategy is to collapse all the operations into a huge single edit operation\r\n        return [this._toSingleEditOperation(operations)];\r\n    };\r\n    PieceTreeTextBuffer.prototype._toSingleEditOperation = function (operations) {\r\n        var forceMoveMarkers = false, firstEditRange = operations[0].range, lastEditRange = operations[operations.length - 1].range, entireEditRange = new Range(firstEditRange.startLineNumber, firstEditRange.startColumn, lastEditRange.endLineNumber, lastEditRange.endColumn), lastEndLineNumber = firstEditRange.startLineNumber, lastEndColumn = firstEditRange.startColumn, result = [];\r\n        for (var i = 0, len = operations.length; i < len; i++) {\r\n            var operation = operations[i], range = operation.range;\r\n            forceMoveMarkers = forceMoveMarkers || operation.forceMoveMarkers;\r\n            // (1) -- Push old text\r\n            for (var lineNumber = lastEndLineNumber; lineNumber < range.startLineNumber; lineNumber++) {\r\n                if (lineNumber === lastEndLineNumber) {\r\n                    result.push(this.getLineContent(lineNumber).substring(lastEndColumn - 1));\r\n                }\r\n                else {\r\n                    result.push('\\n');\r\n                    result.push(this.getLineContent(lineNumber));\r\n                }\r\n            }\r\n            if (range.startLineNumber === lastEndLineNumber) {\r\n                result.push(this.getLineContent(range.startLineNumber).substring(lastEndColumn - 1, range.startColumn - 1));\r\n            }\r\n            else {\r\n                result.push('\\n');\r\n                result.push(this.getLineContent(range.startLineNumber).substring(0, range.startColumn - 1));\r\n            }\r\n            // (2) -- Push new text\r\n            if (operation.lines) {\r\n                for (var j = 0, lenJ = operation.lines.length; j < lenJ; j++) {\r\n                    if (j !== 0) {\r\n                        result.push('\\n');\r\n                    }\r\n                    result.push(operation.lines[j]);\r\n                }\r\n            }\r\n            lastEndLineNumber = operation.range.endLineNumber;\r\n            lastEndColumn = operation.range.endColumn;\r\n        }\r\n        return {\r\n            sortIndex: 0,\r\n            identifier: operations[0].identifier,\r\n            range: entireEditRange,\r\n            rangeOffset: this.getOffsetAt(entireEditRange.startLineNumber, entireEditRange.startColumn),\r\n            rangeLength: this.getValueLengthInRange(entireEditRange, 0 /* TextDefined */),\r\n            lines: result.join('').split('\\n'),\r\n            forceMoveMarkers: forceMoveMarkers,\r\n            isAutoWhitespaceEdit: false\r\n        };\r\n    };\r\n    PieceTreeTextBuffer.prototype._doApplyEdits = function (operations) {\r\n        operations.sort(PieceTreeTextBuffer._sortOpsDescending);\r\n        var contentChanges = [];\r\n        // operations are from bottom to top\r\n        for (var i = 0; i < operations.length; i++) {\r\n            var op = operations[i];\r\n            var startLineNumber = op.range.startLineNumber;\r\n            var startColumn = op.range.startColumn;\r\n            var endLineNumber = op.range.endLineNumber;\r\n            var endColumn = op.range.endColumn;\r\n            if (startLineNumber === endLineNumber && startColumn === endColumn && (!op.lines || op.lines.length === 0)) {\r\n                // no-op\r\n                continue;\r\n            }\r\n            var deletingLinesCnt = endLineNumber - startLineNumber;\r\n            var insertingLinesCnt = (op.lines ? op.lines.length - 1 : 0);\r\n            var editingLinesCnt = Math.min(deletingLinesCnt, insertingLinesCnt);\r\n            var text = (op.lines ? op.lines.join(this.getEOL()) : '');\r\n            if (text) {\r\n                // replacement\r\n                this._pieceTree.delete(op.rangeOffset, op.rangeLength);\r\n                this._pieceTree.insert(op.rangeOffset, text, true);\r\n            }\r\n            else {\r\n                // deletion\r\n                this._pieceTree.delete(op.rangeOffset, op.rangeLength);\r\n            }\r\n            if (editingLinesCnt < insertingLinesCnt) {\r\n                var newLinesContent = [];\r\n                for (var j = editingLinesCnt + 1; j <= insertingLinesCnt; j++) {\r\n                    newLinesContent.push(op.lines[j]);\r\n                }\r\n                newLinesContent[newLinesContent.length - 1] = this.getLineContent(startLineNumber + insertingLinesCnt - 1);\r\n            }\r\n            var contentChangeRange = new Range(startLineNumber, startColumn, endLineNumber, endColumn);\r\n            contentChanges.push({\r\n                range: contentChangeRange,\r\n                rangeLength: op.rangeLength,\r\n                text: text,\r\n                rangeOffset: op.rangeOffset,\r\n                forceMoveMarkers: op.forceMoveMarkers\r\n            });\r\n        }\r\n        return contentChanges;\r\n    };\r\n    PieceTreeTextBuffer.prototype.findMatchesLineByLine = function (searchRange, searchData, captureMatches, limitResultCount) {\r\n        return this._pieceTree.findMatchesLineByLine(searchRange, searchData, captureMatches, limitResultCount);\r\n    };\r\n    /**\r\n     * Assumes `operations` are validated and sorted ascending\r\n     */\r\n    PieceTreeTextBuffer._getInverseEditRanges = function (operations) {\r\n        var result = [];\r\n        var prevOpEndLineNumber = 0;\r\n        var prevOpEndColumn = 0;\r\n        var prevOp = null;\r\n        for (var i = 0, len = operations.length; i < len; i++) {\r\n            var op = operations[i];\r\n            var startLineNumber = void 0;\r\n            var startColumn = void 0;\r\n            if (prevOp) {\r\n                if (prevOp.range.endLineNumber === op.range.startLineNumber) {\r\n                    startLineNumber = prevOpEndLineNumber;\r\n                    startColumn = prevOpEndColumn + (op.range.startColumn - prevOp.range.endColumn);\r\n                }\r\n                else {\r\n                    startLineNumber = prevOpEndLineNumber + (op.range.startLineNumber - prevOp.range.endLineNumber);\r\n                    startColumn = op.range.startColumn;\r\n                }\r\n            }\r\n            else {\r\n                startLineNumber = op.range.startLineNumber;\r\n                startColumn = op.range.startColumn;\r\n            }\r\n            var resultRange = void 0;\r\n            if (op.lines && op.lines.length > 0) {\r\n                // the operation inserts something\r\n                var lineCount = op.lines.length;\r\n                var firstLine = op.lines[0];\r\n                var lastLine = op.lines[lineCount - 1];\r\n                if (lineCount === 1) {\r\n                    // single line insert\r\n                    resultRange = new Range(startLineNumber, startColumn, startLineNumber, startColumn + firstLine.length);\r\n                }\r\n                else {\r\n                    // multi line insert\r\n                    resultRange = new Range(startLineNumber, startColumn, startLineNumber + lineCount - 1, lastLine.length + 1);\r\n                }\r\n            }\r\n            else {\r\n                // There is nothing to insert\r\n                resultRange = new Range(startLineNumber, startColumn, startLineNumber, startColumn);\r\n            }\r\n            prevOpEndLineNumber = resultRange.endLineNumber;\r\n            prevOpEndColumn = resultRange.endColumn;\r\n            result.push(resultRange);\r\n            prevOp = op;\r\n        }\r\n        return result;\r\n    };\r\n    PieceTreeTextBuffer._sortOpsAscending = function (a, b) {\r\n        var r = Range.compareRangesUsingEnds(a.range, b.range);\r\n        if (r === 0) {\r\n            return a.sortIndex - b.sortIndex;\r\n        }\r\n        return r;\r\n    };\r\n    PieceTreeTextBuffer._sortOpsDescending = function (a, b) {\r\n        var r = Range.compareRangesUsingEnds(a.range, b.range);\r\n        if (r === 0) {\r\n            return b.sortIndex - a.sortIndex;\r\n        }\r\n        return -r;\r\n    };\r\n    return PieceTreeTextBuffer;\r\n}());\r\nexport { PieceTreeTextBuffer };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { StringBuffer, createLineStarts, createLineStartsFast } from './pieceTreeBase.js';\r\nimport { PieceTreeTextBuffer } from './pieceTreeTextBuffer.js';\r\nvar PieceTreeTextBufferFactory = /** @class */ (function () {\r\n    function PieceTreeTextBufferFactory(_chunks, _bom, _cr, _lf, _crlf, _containsRTL, _isBasicASCII, _normalizeEOL) {\r\n        this._chunks = _chunks;\r\n        this._bom = _bom;\r\n        this._cr = _cr;\r\n        this._lf = _lf;\r\n        this._crlf = _crlf;\r\n        this._containsRTL = _containsRTL;\r\n        this._isBasicASCII = _isBasicASCII;\r\n        this._normalizeEOL = _normalizeEOL;\r\n    }\r\n    PieceTreeTextBufferFactory.prototype._getEOL = function (defaultEOL) {\r\n        var totalEOLCount = this._cr + this._lf + this._crlf;\r\n        var totalCRCount = this._cr + this._crlf;\r\n        if (totalEOLCount === 0) {\r\n            // This is an empty file or a file with precisely one line\r\n            return (defaultEOL === 1 /* LF */ ? '\\n' : '\\r\\n');\r\n        }\r\n        if (totalCRCount > totalEOLCount / 2) {\r\n            // More than half of the file contains \\r\\n ending lines\r\n            return '\\r\\n';\r\n        }\r\n        // At least one line more ends in \\n\r\n        return '\\n';\r\n    };\r\n    PieceTreeTextBufferFactory.prototype.create = function (defaultEOL) {\r\n        var eol = this._getEOL(defaultEOL);\r\n        var chunks = this._chunks;\r\n        if (this._normalizeEOL &&\r\n            ((eol === '\\r\\n' && (this._cr > 0 || this._lf > 0))\r\n                || (eol === '\\n' && (this._cr > 0 || this._crlf > 0)))) {\r\n            // Normalize pieces\r\n            for (var i = 0, len = chunks.length; i < len; i++) {\r\n                var str = chunks[i].buffer.replace(/\\r\\n|\\r|\\n/g, eol);\r\n                var newLineStart = createLineStartsFast(str);\r\n                chunks[i] = new StringBuffer(str, newLineStart);\r\n            }\r\n        }\r\n        return new PieceTreeTextBuffer(chunks, this._bom, eol, this._containsRTL, this._isBasicASCII, this._normalizeEOL);\r\n    };\r\n    return PieceTreeTextBufferFactory;\r\n}());\r\nexport { PieceTreeTextBufferFactory };\r\nvar PieceTreeTextBufferBuilder = /** @class */ (function () {\r\n    function PieceTreeTextBufferBuilder() {\r\n        this.chunks = [];\r\n        this.BOM = '';\r\n        this._hasPreviousChar = false;\r\n        this._previousChar = 0;\r\n        this._tmpLineStarts = [];\r\n        this.cr = 0;\r\n        this.lf = 0;\r\n        this.crlf = 0;\r\n        this.containsRTL = false;\r\n        this.isBasicASCII = true;\r\n    }\r\n    PieceTreeTextBufferBuilder.prototype.acceptChunk = function (chunk) {\r\n        if (chunk.length === 0) {\r\n            return;\r\n        }\r\n        if (this.chunks.length === 0) {\r\n            if (strings.startsWithUTF8BOM(chunk)) {\r\n                this.BOM = strings.UTF8_BOM_CHARACTER;\r\n                chunk = chunk.substr(1);\r\n            }\r\n        }\r\n        var lastChar = chunk.charCodeAt(chunk.length - 1);\r\n        if (lastChar === 13 /* CarriageReturn */ || (lastChar >= 0xd800 && lastChar <= 0xdbff)) {\r\n            // last character is \\r or a high surrogate => keep it back\r\n            this._acceptChunk1(chunk.substr(0, chunk.length - 1), false);\r\n            this._hasPreviousChar = true;\r\n            this._previousChar = lastChar;\r\n        }\r\n        else {\r\n            this._acceptChunk1(chunk, false);\r\n            this._hasPreviousChar = false;\r\n            this._previousChar = lastChar;\r\n        }\r\n    };\r\n    PieceTreeTextBufferBuilder.prototype._acceptChunk1 = function (chunk, allowEmptyStrings) {\r\n        if (!allowEmptyStrings && chunk.length === 0) {\r\n            // Nothing to do\r\n            return;\r\n        }\r\n        if (this._hasPreviousChar) {\r\n            this._acceptChunk2(String.fromCharCode(this._previousChar) + chunk);\r\n        }\r\n        else {\r\n            this._acceptChunk2(chunk);\r\n        }\r\n    };\r\n    PieceTreeTextBufferBuilder.prototype._acceptChunk2 = function (chunk) {\r\n        var lineStarts = createLineStarts(this._tmpLineStarts, chunk);\r\n        this.chunks.push(new StringBuffer(chunk, lineStarts.lineStarts));\r\n        this.cr += lineStarts.cr;\r\n        this.lf += lineStarts.lf;\r\n        this.crlf += lineStarts.crlf;\r\n        if (this.isBasicASCII) {\r\n            this.isBasicASCII = lineStarts.isBasicASCII;\r\n        }\r\n        if (!this.isBasicASCII && !this.containsRTL) {\r\n            // No need to check if is basic ASCII\r\n            this.containsRTL = strings.containsRTL(chunk);\r\n        }\r\n    };\r\n    PieceTreeTextBufferBuilder.prototype.finish = function (normalizeEOL) {\r\n        if (normalizeEOL === void 0) { normalizeEOL = true; }\r\n        this._finish();\r\n        return new PieceTreeTextBufferFactory(this.chunks, this.BOM, this.cr, this.lf, this.crlf, this.containsRTL, this.isBasicASCII, normalizeEOL);\r\n    };\r\n    PieceTreeTextBufferBuilder.prototype._finish = function () {\r\n        if (this.chunks.length === 0) {\r\n            this._acceptChunk1('', true);\r\n        }\r\n        if (this._hasPreviousChar) {\r\n            this._hasPreviousChar = false;\r\n            // recreate last chunk\r\n            var lastChunk = this.chunks[this.chunks.length - 1];\r\n            lastChunk.buffer += String.fromCharCode(this._previousChar);\r\n            var newLineStarts = createLineStartsFast(lastChunk.buffer);\r\n            lastChunk.lineStarts = newLineStarts;\r\n            if (this._previousChar === 13 /* CarriageReturn */) {\r\n                this.cr++;\r\n            }\r\n        }\r\n    };\r\n    return PieceTreeTextBufferBuilder;\r\n}());\r\nexport { PieceTreeTextBufferBuilder };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/**\r\n * An event describing that a model has been reset to a new value.\r\n * @internal\r\n */\r\nvar ModelRawFlush = /** @class */ (function () {\r\n    function ModelRawFlush() {\r\n        this.changeType = 1 /* Flush */;\r\n    }\r\n    return ModelRawFlush;\r\n}());\r\nexport { ModelRawFlush };\r\n/**\r\n * An event describing that a line has changed in a model.\r\n * @internal\r\n */\r\nvar ModelRawLineChanged = /** @class */ (function () {\r\n    function ModelRawLineChanged(lineNumber, detail) {\r\n        this.changeType = 2 /* LineChanged */;\r\n        this.lineNumber = lineNumber;\r\n        this.detail = detail;\r\n    }\r\n    return ModelRawLineChanged;\r\n}());\r\nexport { ModelRawLineChanged };\r\n/**\r\n * An event describing that line(s) have been deleted in a model.\r\n * @internal\r\n */\r\nvar ModelRawLinesDeleted = /** @class */ (function () {\r\n    function ModelRawLinesDeleted(fromLineNumber, toLineNumber) {\r\n        this.changeType = 3 /* LinesDeleted */;\r\n        this.fromLineNumber = fromLineNumber;\r\n        this.toLineNumber = toLineNumber;\r\n    }\r\n    return ModelRawLinesDeleted;\r\n}());\r\nexport { ModelRawLinesDeleted };\r\n/**\r\n * An event describing that line(s) have been inserted in a model.\r\n * @internal\r\n */\r\nvar ModelRawLinesInserted = /** @class */ (function () {\r\n    function ModelRawLinesInserted(fromLineNumber, toLineNumber, detail) {\r\n        this.changeType = 4 /* LinesInserted */;\r\n        this.fromLineNumber = fromLineNumber;\r\n        this.toLineNumber = toLineNumber;\r\n        this.detail = detail;\r\n    }\r\n    return ModelRawLinesInserted;\r\n}());\r\nexport { ModelRawLinesInserted };\r\n/**\r\n * An event describing that a model has had its EOL changed.\r\n * @internal\r\n */\r\nvar ModelRawEOLChanged = /** @class */ (function () {\r\n    function ModelRawEOLChanged() {\r\n        this.changeType = 5 /* EOLChanged */;\r\n    }\r\n    return ModelRawEOLChanged;\r\n}());\r\nexport { ModelRawEOLChanged };\r\n/**\r\n * An event describing a change in the text of a model.\r\n * @internal\r\n */\r\nvar ModelRawContentChangedEvent = /** @class */ (function () {\r\n    function ModelRawContentChangedEvent(changes, versionId, isUndoing, isRedoing) {\r\n        this.changes = changes;\r\n        this.versionId = versionId;\r\n        this.isUndoing = isUndoing;\r\n        this.isRedoing = isRedoing;\r\n    }\r\n    ModelRawContentChangedEvent.prototype.containsEvent = function (type) {\r\n        for (var i = 0, len = this.changes.length; i < len; i++) {\r\n            var change = this.changes[i];\r\n            if (change.changeType === type) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    ModelRawContentChangedEvent.merge = function (a, b) {\r\n        var changes = [].concat(a.changes).concat(b.changes);\r\n        var versionId = b.versionId;\r\n        var isUndoing = (a.isUndoing || b.isUndoing);\r\n        var isRedoing = (a.isRedoing || b.isRedoing);\r\n        return new ModelRawContentChangedEvent(changes, versionId, isUndoing, isRedoing);\r\n    };\r\n    return ModelRawContentChangedEvent;\r\n}());\r\nexport { ModelRawContentChangedEvent };\r\n/**\r\n * @internal\r\n */\r\nvar InternalModelContentChangeEvent = /** @class */ (function () {\r\n    function InternalModelContentChangeEvent(rawContentChangedEvent, contentChangedEvent) {\r\n        this.rawContentChangedEvent = rawContentChangedEvent;\r\n        this.contentChangedEvent = contentChangedEvent;\r\n    }\r\n    InternalModelContentChangeEvent.prototype.merge = function (other) {\r\n        var rawContentChangedEvent = ModelRawContentChangedEvent.merge(this.rawContentChangedEvent, other.rawContentChangedEvent);\r\n        var contentChangedEvent = InternalModelContentChangeEvent._mergeChangeEvents(this.contentChangedEvent, other.contentChangedEvent);\r\n        return new InternalModelContentChangeEvent(rawContentChangedEvent, contentChangedEvent);\r\n    };\r\n    InternalModelContentChangeEvent._mergeChangeEvents = function (a, b) {\r\n        var changes = [].concat(a.changes).concat(b.changes);\r\n        var eol = b.eol;\r\n        var versionId = b.versionId;\r\n        var isUndoing = (a.isUndoing || b.isUndoing);\r\n        var isRedoing = (a.isRedoing || b.isRedoing);\r\n        var isFlush = (a.isFlush || b.isFlush);\r\n        return {\r\n            changes: changes,\r\n            eol: eol,\r\n            versionId: versionId,\r\n            isUndoing: isUndoing,\r\n            isRedoing: isRedoing,\r\n            isFlush: isFlush\r\n        };\r\n    };\r\n    return InternalModelContentChangeEvent;\r\n}());\r\nexport { InternalModelContentChangeEvent };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as arrays from '../../../base/common/arrays.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { LineTokens } from '../core/lineTokens.js';\r\nimport { Position } from '../core/position.js';\r\nimport { nullTokenize2 } from '../modes/nullMode.js';\r\nfunction getDefaultMetadata(topLevelLanguageId) {\r\n    return ((topLevelLanguageId << 0 /* LANGUAGEID_OFFSET */)\r\n        | (0 /* Other */ << 8 /* TOKEN_TYPE_OFFSET */)\r\n        | (0 /* None */ << 11 /* FONT_STYLE_OFFSET */)\r\n        | (1 /* DefaultForeground */ << 14 /* FOREGROUND_OFFSET */)\r\n        | (2 /* DefaultBackground */ << 23 /* BACKGROUND_OFFSET */)) >>> 0;\r\n}\r\nvar EMPTY_LINE_TOKENS = (new Uint32Array(0)).buffer;\r\nvar ModelLineTokens = /** @class */ (function () {\r\n    function ModelLineTokens(state) {\r\n        this._state = state;\r\n        this._lineTokens = null;\r\n        this._invalid = true;\r\n    }\r\n    ModelLineTokens.prototype.deleteBeginning = function (toChIndex) {\r\n        if (this._lineTokens === null || this._lineTokens === EMPTY_LINE_TOKENS) {\r\n            return;\r\n        }\r\n        this.delete(0, toChIndex);\r\n    };\r\n    ModelLineTokens.prototype.deleteEnding = function (fromChIndex) {\r\n        if (this._lineTokens === null || this._lineTokens === EMPTY_LINE_TOKENS) {\r\n            return;\r\n        }\r\n        var tokens = new Uint32Array(this._lineTokens);\r\n        var lineTextLength = tokens[tokens.length - 2];\r\n        this.delete(fromChIndex, lineTextLength);\r\n    };\r\n    ModelLineTokens.prototype.delete = function (fromChIndex, toChIndex) {\r\n        if (this._lineTokens === null || this._lineTokens === EMPTY_LINE_TOKENS || fromChIndex === toChIndex) {\r\n            return;\r\n        }\r\n        var tokens = new Uint32Array(this._lineTokens);\r\n        var tokensCount = (tokens.length >>> 1);\r\n        // special case: deleting everything\r\n        if (fromChIndex === 0 && tokens[tokens.length - 2] === toChIndex) {\r\n            this._lineTokens = EMPTY_LINE_TOKENS;\r\n            return;\r\n        }\r\n        var fromTokenIndex = LineTokens.findIndexInTokensArray(tokens, fromChIndex);\r\n        var fromTokenStartOffset = (fromTokenIndex > 0 ? tokens[(fromTokenIndex - 1) << 1] : 0);\r\n        var fromTokenEndOffset = tokens[fromTokenIndex << 1];\r\n        if (toChIndex < fromTokenEndOffset) {\r\n            // the delete range is inside a single token\r\n            var delta_1 = (toChIndex - fromChIndex);\r\n            for (var i = fromTokenIndex; i < tokensCount; i++) {\r\n                tokens[i << 1] -= delta_1;\r\n            }\r\n            return;\r\n        }\r\n        var dest;\r\n        var lastEnd;\r\n        if (fromTokenStartOffset !== fromChIndex) {\r\n            tokens[fromTokenIndex << 1] = fromChIndex;\r\n            dest = ((fromTokenIndex + 1) << 1);\r\n            lastEnd = fromChIndex;\r\n        }\r\n        else {\r\n            dest = (fromTokenIndex << 1);\r\n            lastEnd = fromTokenStartOffset;\r\n        }\r\n        var delta = (toChIndex - fromChIndex);\r\n        for (var tokenIndex = fromTokenIndex + 1; tokenIndex < tokensCount; tokenIndex++) {\r\n            var tokenEndOffset = tokens[tokenIndex << 1] - delta;\r\n            if (tokenEndOffset > lastEnd) {\r\n                tokens[dest++] = tokenEndOffset;\r\n                tokens[dest++] = tokens[(tokenIndex << 1) + 1];\r\n                lastEnd = tokenEndOffset;\r\n            }\r\n        }\r\n        if (dest === tokens.length) {\r\n            // nothing to trim\r\n            return;\r\n        }\r\n        var tmp = new Uint32Array(dest);\r\n        tmp.set(tokens.subarray(0, dest), 0);\r\n        this._lineTokens = tmp.buffer;\r\n    };\r\n    ModelLineTokens.prototype.append = function (_otherTokens) {\r\n        if (_otherTokens === EMPTY_LINE_TOKENS) {\r\n            return;\r\n        }\r\n        if (this._lineTokens === EMPTY_LINE_TOKENS) {\r\n            this._lineTokens = _otherTokens;\r\n            return;\r\n        }\r\n        if (this._lineTokens === null) {\r\n            return;\r\n        }\r\n        if (_otherTokens === null) {\r\n            // cannot determine combined line length...\r\n            this._lineTokens = null;\r\n            return;\r\n        }\r\n        var myTokens = new Uint32Array(this._lineTokens);\r\n        var otherTokens = new Uint32Array(_otherTokens);\r\n        var otherTokensCount = (otherTokens.length >>> 1);\r\n        var result = new Uint32Array(myTokens.length + otherTokens.length);\r\n        result.set(myTokens, 0);\r\n        var dest = myTokens.length;\r\n        var delta = myTokens[myTokens.length - 2];\r\n        for (var i = 0; i < otherTokensCount; i++) {\r\n            result[dest++] = otherTokens[(i << 1)] + delta;\r\n            result[dest++] = otherTokens[(i << 1) + 1];\r\n        }\r\n        this._lineTokens = result.buffer;\r\n    };\r\n    ModelLineTokens.prototype.insert = function (chIndex, textLength) {\r\n        if (!this._lineTokens) {\r\n            // nothing to do\r\n            return;\r\n        }\r\n        var tokens = new Uint32Array(this._lineTokens);\r\n        var tokensCount = (tokens.length >>> 1);\r\n        var fromTokenIndex = LineTokens.findIndexInTokensArray(tokens, chIndex);\r\n        if (fromTokenIndex > 0) {\r\n            var fromTokenStartOffset = (fromTokenIndex > 0 ? tokens[(fromTokenIndex - 1) << 1] : 0);\r\n            if (fromTokenStartOffset === chIndex) {\r\n                fromTokenIndex--;\r\n            }\r\n        }\r\n        for (var tokenIndex = fromTokenIndex; tokenIndex < tokensCount; tokenIndex++) {\r\n            tokens[tokenIndex << 1] += textLength;\r\n        }\r\n    };\r\n    return ModelLineTokens;\r\n}());\r\nvar ModelLinesTokens = /** @class */ (function () {\r\n    function ModelLinesTokens(languageIdentifier, tokenizationSupport) {\r\n        this.languageIdentifier = languageIdentifier;\r\n        this.tokenizationSupport = tokenizationSupport;\r\n        this._tokens = [];\r\n        if (this.tokenizationSupport) {\r\n            var initialState = null;\r\n            try {\r\n                initialState = this.tokenizationSupport.getInitialState();\r\n            }\r\n            catch (e) {\r\n                onUnexpectedError(e);\r\n                this.tokenizationSupport = null;\r\n            }\r\n            if (initialState) {\r\n                this._tokens[0] = new ModelLineTokens(initialState);\r\n            }\r\n        }\r\n        this._invalidLineStartIndex = 0;\r\n        this._lastState = null;\r\n    }\r\n    Object.defineProperty(ModelLinesTokens.prototype, \"inValidLineStartIndex\", {\r\n        get: function () {\r\n            return this._invalidLineStartIndex;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ModelLinesTokens.prototype.getTokens = function (topLevelLanguageId, lineIndex, lineText) {\r\n        var rawLineTokens = null;\r\n        if (lineIndex < this._tokens.length && this._tokens[lineIndex]) {\r\n            rawLineTokens = this._tokens[lineIndex]._lineTokens;\r\n        }\r\n        if (rawLineTokens !== null && rawLineTokens !== EMPTY_LINE_TOKENS) {\r\n            return new LineTokens(new Uint32Array(rawLineTokens), lineText);\r\n        }\r\n        var lineTokens = new Uint32Array(2);\r\n        lineTokens[0] = lineText.length;\r\n        lineTokens[1] = getDefaultMetadata(topLevelLanguageId);\r\n        return new LineTokens(lineTokens, lineText);\r\n    };\r\n    ModelLinesTokens.prototype.isCheapToTokenize = function (lineNumber) {\r\n        var firstInvalidLineNumber = this._invalidLineStartIndex + 1;\r\n        return (firstInvalidLineNumber >= lineNumber);\r\n    };\r\n    ModelLinesTokens.prototype.hasLinesToTokenize = function (buffer) {\r\n        return (this._invalidLineStartIndex < buffer.getLineCount());\r\n    };\r\n    ModelLinesTokens.prototype.invalidateLine = function (lineIndex) {\r\n        this._setIsInvalid(lineIndex, true);\r\n        if (lineIndex < this._invalidLineStartIndex) {\r\n            this._setIsInvalid(this._invalidLineStartIndex, true);\r\n            this._invalidLineStartIndex = lineIndex;\r\n        }\r\n    };\r\n    ModelLinesTokens.prototype._setIsInvalid = function (lineIndex, invalid) {\r\n        if (lineIndex < this._tokens.length && this._tokens[lineIndex]) {\r\n            this._tokens[lineIndex]._invalid = invalid;\r\n        }\r\n    };\r\n    ModelLinesTokens.prototype._isInvalid = function (lineIndex) {\r\n        if (lineIndex < this._tokens.length && this._tokens[lineIndex]) {\r\n            return this._tokens[lineIndex]._invalid;\r\n        }\r\n        return true;\r\n    };\r\n    ModelLinesTokens.prototype._getState = function (lineIndex) {\r\n        if (lineIndex < this._tokens.length && this._tokens[lineIndex]) {\r\n            return this._tokens[lineIndex]._state;\r\n        }\r\n        return null;\r\n    };\r\n    ModelLinesTokens.prototype._setTokens = function (topLevelLanguageId, lineIndex, lineTextLength, tokens) {\r\n        var target;\r\n        if (lineIndex < this._tokens.length && this._tokens[lineIndex]) {\r\n            target = this._tokens[lineIndex];\r\n        }\r\n        else {\r\n            target = new ModelLineTokens(null);\r\n            this._tokens[lineIndex] = target;\r\n        }\r\n        if (lineTextLength === 0) {\r\n            target._lineTokens = EMPTY_LINE_TOKENS;\r\n            return;\r\n        }\r\n        if (!tokens || tokens.length === 0) {\r\n            tokens = new Uint32Array(2);\r\n            tokens[0] = 0;\r\n            tokens[1] = getDefaultMetadata(topLevelLanguageId);\r\n        }\r\n        LineTokens.convertToEndOffset(tokens, lineTextLength);\r\n        target._lineTokens = tokens.buffer;\r\n    };\r\n    ModelLinesTokens.prototype._setState = function (lineIndex, state) {\r\n        if (lineIndex < this._tokens.length && this._tokens[lineIndex]) {\r\n            this._tokens[lineIndex]._state = state;\r\n        }\r\n        else {\r\n            var tmp = new ModelLineTokens(state);\r\n            this._tokens[lineIndex] = tmp;\r\n        }\r\n    };\r\n    //#region Editing\r\n    ModelLinesTokens.prototype.applyEdits = function (range, eolCount, firstLineLength) {\r\n        var deletingLinesCnt = range.endLineNumber - range.startLineNumber;\r\n        var insertingLinesCnt = eolCount;\r\n        var editingLinesCnt = Math.min(deletingLinesCnt, insertingLinesCnt);\r\n        for (var j = editingLinesCnt; j >= 0; j--) {\r\n            this.invalidateLine(range.startLineNumber + j - 1);\r\n        }\r\n        this._acceptDeleteRange(range);\r\n        this._acceptInsertText(new Position(range.startLineNumber, range.startColumn), eolCount, firstLineLength);\r\n    };\r\n    ModelLinesTokens.prototype._acceptDeleteRange = function (range) {\r\n        var firstLineIndex = range.startLineNumber - 1;\r\n        if (firstLineIndex >= this._tokens.length) {\r\n            return;\r\n        }\r\n        if (range.startLineNumber === range.endLineNumber) {\r\n            if (range.startColumn === range.endColumn) {\r\n                // Nothing to delete\r\n                return;\r\n            }\r\n            this._tokens[firstLineIndex].delete(range.startColumn - 1, range.endColumn - 1);\r\n            return;\r\n        }\r\n        var firstLine = this._tokens[firstLineIndex];\r\n        firstLine.deleteEnding(range.startColumn - 1);\r\n        var lastLineIndex = range.endLineNumber - 1;\r\n        var lastLineTokens = null;\r\n        if (lastLineIndex < this._tokens.length) {\r\n            var lastLine = this._tokens[lastLineIndex];\r\n            lastLine.deleteBeginning(range.endColumn - 1);\r\n            lastLineTokens = lastLine._lineTokens;\r\n        }\r\n        // Take remaining text on last line and append it to remaining text on first line\r\n        firstLine.append(lastLineTokens);\r\n        // Delete middle lines\r\n        this._tokens.splice(range.startLineNumber, range.endLineNumber - range.startLineNumber);\r\n    };\r\n    ModelLinesTokens.prototype._acceptInsertText = function (position, eolCount, firstLineLength) {\r\n        if (eolCount === 0 && firstLineLength === 0) {\r\n            // Nothing to insert\r\n            return;\r\n        }\r\n        var lineIndex = position.lineNumber - 1;\r\n        if (lineIndex >= this._tokens.length) {\r\n            return;\r\n        }\r\n        if (eolCount === 0) {\r\n            // Inserting text on one line\r\n            this._tokens[lineIndex].insert(position.column - 1, firstLineLength);\r\n            return;\r\n        }\r\n        var line = this._tokens[lineIndex];\r\n        line.deleteEnding(position.column - 1);\r\n        line.insert(position.column - 1, firstLineLength);\r\n        var insert = new Array(eolCount);\r\n        for (var i = eolCount - 1; i >= 0; i--) {\r\n            insert[i] = new ModelLineTokens(null);\r\n        }\r\n        this._tokens = arrays.arrayInsert(this._tokens, position.lineNumber, insert);\r\n    };\r\n    //#endregion\r\n    //#region Tokenization\r\n    ModelLinesTokens.prototype._tokenizeOneLine = function (buffer, eventBuilder) {\r\n        if (!this.hasLinesToTokenize(buffer)) {\r\n            return buffer.getLineCount() + 1;\r\n        }\r\n        var lineNumber = this._invalidLineStartIndex + 1;\r\n        this._updateTokensUntilLine(buffer, eventBuilder, lineNumber);\r\n        return lineNumber;\r\n    };\r\n    ModelLinesTokens.prototype._tokenizeText = function (buffer, text, state) {\r\n        var r = null;\r\n        if (this.tokenizationSupport) {\r\n            try {\r\n                r = this.tokenizationSupport.tokenize2(text, state, 0);\r\n            }\r\n            catch (e) {\r\n                onUnexpectedError(e);\r\n            }\r\n        }\r\n        if (!r) {\r\n            r = nullTokenize2(this.languageIdentifier.id, text, state, 0);\r\n        }\r\n        return r;\r\n    };\r\n    ModelLinesTokens.prototype._updateTokensUntilLine = function (buffer, eventBuilder, lineNumber) {\r\n        if (!this.tokenizationSupport) {\r\n            this._invalidLineStartIndex = buffer.getLineCount();\r\n            return;\r\n        }\r\n        var linesLength = buffer.getLineCount();\r\n        var endLineIndex = lineNumber - 1;\r\n        // Validate all states up to and including endLineIndex\r\n        for (var lineIndex = this._invalidLineStartIndex; lineIndex <= endLineIndex; lineIndex++) {\r\n            var endStateIndex = lineIndex + 1;\r\n            var text = buffer.getLineContent(lineIndex + 1);\r\n            var lineStartState = this._getState(lineIndex);\r\n            var r = null;\r\n            try {\r\n                // Tokenize only the first X characters\r\n                var freshState = lineStartState.clone();\r\n                r = this.tokenizationSupport.tokenize2(text, freshState, 0);\r\n            }\r\n            catch (e) {\r\n                onUnexpectedError(e);\r\n            }\r\n            if (!r) {\r\n                r = nullTokenize2(this.languageIdentifier.id, text, lineStartState, 0);\r\n            }\r\n            this._setTokens(this.languageIdentifier.id, lineIndex, text.length, r.tokens);\r\n            eventBuilder.registerChangedTokens(lineIndex + 1);\r\n            this._setIsInvalid(lineIndex, false);\r\n            if (endStateIndex < linesLength) {\r\n                var previousEndState = this._getState(endStateIndex);\r\n                if (previousEndState !== null && r.endState.equals(previousEndState)) {\r\n                    // The end state of this line remains the same\r\n                    var nextInvalidLineIndex = lineIndex + 1;\r\n                    while (nextInvalidLineIndex < linesLength) {\r\n                        if (this._isInvalid(nextInvalidLineIndex)) {\r\n                            break;\r\n                        }\r\n                        if (nextInvalidLineIndex + 1 < linesLength) {\r\n                            if (this._getState(nextInvalidLineIndex + 1) === null) {\r\n                                break;\r\n                            }\r\n                        }\r\n                        else {\r\n                            if (this._lastState === null) {\r\n                                break;\r\n                            }\r\n                        }\r\n                        nextInvalidLineIndex++;\r\n                    }\r\n                    this._invalidLineStartIndex = Math.max(this._invalidLineStartIndex, nextInvalidLineIndex);\r\n                    lineIndex = nextInvalidLineIndex - 1; // -1 because the outer loop increments it\r\n                }\r\n                else {\r\n                    this._setState(endStateIndex, r.endState);\r\n                }\r\n            }\r\n            else {\r\n                this._lastState = r.endState;\r\n            }\r\n        }\r\n        this._invalidLineStartIndex = Math.max(this._invalidLineStartIndex, endLineIndex + 1);\r\n    };\r\n    return ModelLinesTokens;\r\n}());\r\nexport { ModelLinesTokens };\r\nvar ModelTokensChangedEventBuilder = /** @class */ (function () {\r\n    function ModelTokensChangedEventBuilder() {\r\n        this._ranges = [];\r\n    }\r\n    ModelTokensChangedEventBuilder.prototype.registerChangedTokens = function (lineNumber) {\r\n        var ranges = this._ranges;\r\n        var rangesLength = ranges.length;\r\n        var previousRange = rangesLength > 0 ? ranges[rangesLength - 1] : null;\r\n        if (previousRange && previousRange.toLineNumber === lineNumber - 1) {\r\n            // extend previous range\r\n            previousRange.toLineNumber++;\r\n        }\r\n        else {\r\n            // insert new range\r\n            ranges[rangesLength] = {\r\n                fromLineNumber: lineNumber,\r\n                toLineNumber: lineNumber\r\n            };\r\n        }\r\n    };\r\n    ModelTokensChangedEventBuilder.prototype.build = function () {\r\n        if (this._ranges.length === 0) {\r\n            return null;\r\n        }\r\n        return {\r\n            ranges: this._ranges\r\n        };\r\n    };\r\n    return ModelTokensChangedEventBuilder;\r\n}());\r\nexport { ModelTokensChangedEventBuilder };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { StopWatch } from '../../../base/common/stopwatch.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { EDITOR_MODEL_DEFAULTS } from '../config/editorOptions.js';\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nimport { Selection } from '../core/selection.js';\r\nimport * as model from '../model.js';\r\nimport { EditStack } from './editStack.js';\r\nimport { guessIndentation } from './indentationGuesser.js';\r\nimport { IntervalNode, IntervalTree, getNodeIsInOverviewRuler, recomputeMaxEnd } from './intervalTree.js';\r\nimport { PieceTreeTextBufferBuilder } from './pieceTreeTextBuffer/pieceTreeTextBufferBuilder.js';\r\nimport { InternalModelContentChangeEvent, ModelRawContentChangedEvent, ModelRawEOLChanged, ModelRawFlush, ModelRawLineChanged, ModelRawLinesDeleted, ModelRawLinesInserted } from './textModelEvents.js';\r\nimport { SearchParams, TextModelSearch } from './textModelSearch.js';\r\nimport { ModelLinesTokens, ModelTokensChangedEventBuilder } from './textModelTokens.js';\r\nimport { getWordAtText } from './wordHelper.js';\r\nimport { TokenizationRegistry } from '../modes.js';\r\nimport { LanguageConfigurationRegistry } from '../modes/languageConfigurationRegistry.js';\r\nimport { NULL_LANGUAGE_IDENTIFIER } from '../modes/nullMode.js';\r\nimport { ignoreBracketsInToken } from '../modes/supports.js';\r\nimport { BracketsUtils } from '../modes/supports/richEditBrackets.js';\r\nvar CHEAP_TOKENIZATION_LENGTH_LIMIT = 2048;\r\nfunction createTextBufferBuilder() {\r\n    return new PieceTreeTextBufferBuilder();\r\n}\r\nexport function createTextBufferFactory(text) {\r\n    var builder = createTextBufferBuilder();\r\n    builder.acceptChunk(text);\r\n    return builder.finish();\r\n}\r\nexport function createTextBuffer(value, defaultEOL) {\r\n    var factory = (typeof value === 'string' ? createTextBufferFactory(value) : value);\r\n    return factory.create(defaultEOL);\r\n}\r\nvar MODEL_ID = 0;\r\n/**\r\n * Produces 'a'-'z', followed by 'A'-'Z'... followed by 'a'-'z', etc.\r\n */\r\nfunction singleLetter(result) {\r\n    var LETTERS_CNT = (90 /* Z */ - 65 /* A */ + 1);\r\n    result = result % (2 * LETTERS_CNT);\r\n    if (result < LETTERS_CNT) {\r\n        return String.fromCharCode(97 /* a */ + result);\r\n    }\r\n    return String.fromCharCode(65 /* A */ + result - LETTERS_CNT);\r\n}\r\nvar LIMIT_FIND_COUNT = 999;\r\nexport var LONG_LINE_BOUNDARY = 10000;\r\nvar invalidFunc = function () { throw new Error(\"Invalid change accessor\"); };\r\nvar TextModel = /** @class */ (function (_super) {\r\n    __extends(TextModel, _super);\r\n    //#endregion\r\n    function TextModel(source, creationOptions, languageIdentifier, associatedResource) {\r\n        if (associatedResource === void 0) { associatedResource = null; }\r\n        var _this = _super.call(this) || this;\r\n        //#region Events\r\n        _this._onWillDispose = _this._register(new Emitter());\r\n        _this.onWillDispose = _this._onWillDispose.event;\r\n        _this._onDidChangeDecorations = _this._register(new DidChangeDecorationsEmitter());\r\n        _this.onDidChangeDecorations = _this._onDidChangeDecorations.event;\r\n        _this._onDidChangeLanguage = _this._register(new Emitter());\r\n        _this.onDidChangeLanguage = _this._onDidChangeLanguage.event;\r\n        _this._onDidChangeLanguageConfiguration = _this._register(new Emitter());\r\n        _this.onDidChangeLanguageConfiguration = _this._onDidChangeLanguageConfiguration.event;\r\n        _this._onDidChangeTokens = _this._register(new Emitter());\r\n        _this.onDidChangeTokens = _this._onDidChangeTokens.event;\r\n        _this._onDidChangeOptions = _this._register(new Emitter());\r\n        _this.onDidChangeOptions = _this._onDidChangeOptions.event;\r\n        _this._eventEmitter = _this._register(new DidChangeContentEmitter());\r\n        // Generate a new unique model id\r\n        MODEL_ID++;\r\n        _this.id = '$model' + MODEL_ID;\r\n        _this.isForSimpleWidget = creationOptions.isForSimpleWidget;\r\n        if (typeof associatedResource === 'undefined' || associatedResource === null) {\r\n            _this._associatedResource = URI.parse('inmemory://model/' + MODEL_ID);\r\n        }\r\n        else {\r\n            _this._associatedResource = associatedResource;\r\n        }\r\n        _this._attachedEditorCount = 0;\r\n        _this._buffer = createTextBuffer(source, creationOptions.defaultEOL);\r\n        _this._options = TextModel.resolveOptions(_this._buffer, creationOptions);\r\n        var bufferLineCount = _this._buffer.getLineCount();\r\n        var bufferTextLength = _this._buffer.getValueLengthInRange(new Range(1, 1, bufferLineCount, _this._buffer.getLineLength(bufferLineCount) + 1), 0 /* TextDefined */);\r\n        // !!! Make a decision in the ctor and permanently respect this decision !!!\r\n        // If a model is too large at construction time, it will never get tokenized,\r\n        // under no circumstances.\r\n        if (creationOptions.largeFileOptimizations) {\r\n            _this._isTooLargeForTokenization = ((bufferTextLength > TextModel.LARGE_FILE_SIZE_THRESHOLD)\r\n                || (bufferLineCount > TextModel.LARGE_FILE_LINE_COUNT_THRESHOLD));\r\n        }\r\n        else {\r\n            _this._isTooLargeForTokenization = false;\r\n        }\r\n        _this._isTooLargeForSyncing = (bufferTextLength > TextModel.MODEL_SYNC_LIMIT);\r\n        _this._setVersionId(1);\r\n        _this._isDisposed = false;\r\n        _this._isDisposing = false;\r\n        _this._languageIdentifier = languageIdentifier || NULL_LANGUAGE_IDENTIFIER;\r\n        _this._tokenizationListener = TokenizationRegistry.onDidChange(function (e) {\r\n            if (e.changedLanguages.indexOf(_this._languageIdentifier.language) === -1) {\r\n                return;\r\n            }\r\n            _this._resetTokenizationState();\r\n            _this.emitModelTokensChangedEvent({\r\n                ranges: [{\r\n                        fromLineNumber: 1,\r\n                        toLineNumber: _this.getLineCount()\r\n                    }]\r\n            });\r\n            if (_this._shouldAutoTokenize()) {\r\n                _this._warmUpTokens();\r\n            }\r\n        });\r\n        _this._revalidateTokensTimeout = -1;\r\n        _this._languageRegistryListener = LanguageConfigurationRegistry.onDidChange(function (e) {\r\n            if (e.languageIdentifier.id === _this._languageIdentifier.id) {\r\n                _this._onDidChangeLanguageConfiguration.fire({});\r\n            }\r\n        });\r\n        _this._resetTokenizationState();\r\n        _this._instanceId = singleLetter(MODEL_ID);\r\n        _this._lastDecorationId = 0;\r\n        _this._decorations = Object.create(null);\r\n        _this._decorationsTree = new DecorationsTrees();\r\n        _this._commandManager = new EditStack(_this);\r\n        _this._isUndoing = false;\r\n        _this._isRedoing = false;\r\n        _this._trimAutoWhitespaceLines = null;\r\n        return _this;\r\n    }\r\n    TextModel.createFromString = function (text, options, languageIdentifier, uri) {\r\n        if (options === void 0) { options = TextModel.DEFAULT_CREATION_OPTIONS; }\r\n        if (languageIdentifier === void 0) { languageIdentifier = null; }\r\n        if (uri === void 0) { uri = null; }\r\n        return new TextModel(text, options, languageIdentifier, uri);\r\n    };\r\n    TextModel.resolveOptions = function (textBuffer, options) {\r\n        if (options.detectIndentation) {\r\n            var guessedIndentation = guessIndentation(textBuffer, options.tabSize, options.insertSpaces);\r\n            return new model.TextModelResolvedOptions({\r\n                tabSize: guessedIndentation.tabSize,\r\n                insertSpaces: guessedIndentation.insertSpaces,\r\n                trimAutoWhitespace: options.trimAutoWhitespace,\r\n                defaultEOL: options.defaultEOL\r\n            });\r\n        }\r\n        return new model.TextModelResolvedOptions({\r\n            tabSize: options.tabSize,\r\n            insertSpaces: options.insertSpaces,\r\n            trimAutoWhitespace: options.trimAutoWhitespace,\r\n            defaultEOL: options.defaultEOL\r\n        });\r\n    };\r\n    TextModel.prototype.onDidChangeRawContentFast = function (listener) {\r\n        return this._eventEmitter.fastEvent(function (e) { return listener(e.rawContentChangedEvent); });\r\n    };\r\n    TextModel.prototype.onDidChangeRawContent = function (listener) {\r\n        return this._eventEmitter.slowEvent(function (e) { return listener(e.rawContentChangedEvent); });\r\n    };\r\n    TextModel.prototype.onDidChangeContent = function (listener) {\r\n        return this._eventEmitter.slowEvent(function (e) { return listener(e.contentChangedEvent); });\r\n    };\r\n    TextModel.prototype.dispose = function () {\r\n        this._isDisposing = true;\r\n        this._onWillDispose.fire();\r\n        this._tokenizationListener.dispose();\r\n        this._languageRegistryListener.dispose();\r\n        this._clearTimers();\r\n        this._isDisposed = true;\r\n        // Null out members, such that any use of a disposed model will throw exceptions sooner rather than later\r\n        _super.prototype.dispose.call(this);\r\n        this._isDisposing = false;\r\n    };\r\n    TextModel.prototype._assertNotDisposed = function () {\r\n        if (this._isDisposed) {\r\n            throw new Error('Model is disposed!');\r\n        }\r\n    };\r\n    TextModel.prototype._emitContentChangedEvent = function (rawChange, change) {\r\n        if (this._isDisposing) {\r\n            // Do not confuse listeners by emitting any event after disposing\r\n            return;\r\n        }\r\n        this._eventEmitter.fire(new InternalModelContentChangeEvent(rawChange, change));\r\n    };\r\n    TextModel.prototype.setValue = function (value) {\r\n        this._assertNotDisposed();\r\n        if (value === null) {\r\n            // There's nothing to do\r\n            return;\r\n        }\r\n        var textBuffer = createTextBuffer(value, this._options.defaultEOL);\r\n        this.setValueFromTextBuffer(textBuffer);\r\n    };\r\n    TextModel.prototype._createContentChanged2 = function (range, rangeOffset, rangeLength, text, isUndoing, isRedoing, isFlush) {\r\n        return {\r\n            changes: [{\r\n                    range: range,\r\n                    rangeOffset: rangeOffset,\r\n                    rangeLength: rangeLength,\r\n                    text: text,\r\n                }],\r\n            eol: this._buffer.getEOL(),\r\n            versionId: this.getVersionId(),\r\n            isUndoing: isUndoing,\r\n            isRedoing: isRedoing,\r\n            isFlush: isFlush\r\n        };\r\n    };\r\n    TextModel.prototype.setValueFromTextBuffer = function (textBuffer) {\r\n        this._assertNotDisposed();\r\n        if (textBuffer === null) {\r\n            // There's nothing to do\r\n            return;\r\n        }\r\n        var oldFullModelRange = this.getFullModelRange();\r\n        var oldModelValueLength = this.getValueLengthInRange(oldFullModelRange);\r\n        var endLineNumber = this.getLineCount();\r\n        var endColumn = this.getLineMaxColumn(endLineNumber);\r\n        this._buffer = textBuffer;\r\n        this._increaseVersionId();\r\n        // Cancel tokenization, clear all tokens and begin tokenizing\r\n        this._resetTokenizationState();\r\n        // Destroy all my decorations\r\n        this._decorations = Object.create(null);\r\n        this._decorationsTree = new DecorationsTrees();\r\n        // Destroy my edit history and settings\r\n        this._commandManager = new EditStack(this);\r\n        this._trimAutoWhitespaceLines = null;\r\n        this._emitContentChangedEvent(new ModelRawContentChangedEvent([\r\n            new ModelRawFlush()\r\n        ], this._versionId, false, false), this._createContentChanged2(new Range(1, 1, endLineNumber, endColumn), 0, oldModelValueLength, this.getValue(), false, false, true));\r\n    };\r\n    TextModel.prototype.setEOL = function (eol) {\r\n        this._assertNotDisposed();\r\n        var newEOL = (eol === 1 /* CRLF */ ? '\\r\\n' : '\\n');\r\n        if (this._buffer.getEOL() === newEOL) {\r\n            // Nothing to do\r\n            return;\r\n        }\r\n        var oldFullModelRange = this.getFullModelRange();\r\n        var oldModelValueLength = this.getValueLengthInRange(oldFullModelRange);\r\n        var endLineNumber = this.getLineCount();\r\n        var endColumn = this.getLineMaxColumn(endLineNumber);\r\n        this._onBeforeEOLChange();\r\n        this._buffer.setEOL(newEOL);\r\n        this._increaseVersionId();\r\n        this._onAfterEOLChange();\r\n        this._emitContentChangedEvent(new ModelRawContentChangedEvent([\r\n            new ModelRawEOLChanged()\r\n        ], this._versionId, false, false), this._createContentChanged2(new Range(1, 1, endLineNumber, endColumn), 0, oldModelValueLength, this.getValue(), false, false, false));\r\n    };\r\n    TextModel.prototype._onBeforeEOLChange = function () {\r\n        // Ensure all decorations get their `range` set.\r\n        var versionId = this.getVersionId();\r\n        var allDecorations = this._decorationsTree.search(0, false, false, versionId);\r\n        this._ensureNodesHaveRanges(allDecorations);\r\n    };\r\n    TextModel.prototype._onAfterEOLChange = function () {\r\n        // Transform back `range` to offsets\r\n        var versionId = this.getVersionId();\r\n        var allDecorations = this._decorationsTree.collectNodesPostOrder();\r\n        for (var i = 0, len = allDecorations.length; i < len; i++) {\r\n            var node = allDecorations[i];\r\n            var delta = node.cachedAbsoluteStart - node.start;\r\n            var startOffset = this._buffer.getOffsetAt(node.range.startLineNumber, node.range.startColumn);\r\n            var endOffset = this._buffer.getOffsetAt(node.range.endLineNumber, node.range.endColumn);\r\n            node.cachedAbsoluteStart = startOffset;\r\n            node.cachedAbsoluteEnd = endOffset;\r\n            node.cachedVersionId = versionId;\r\n            node.start = startOffset - delta;\r\n            node.end = endOffset - delta;\r\n            recomputeMaxEnd(node);\r\n        }\r\n    };\r\n    TextModel.prototype._resetTokenizationState = function () {\r\n        this._clearTimers();\r\n        var tokenizationSupport = (this._isTooLargeForTokenization\r\n            ? null\r\n            : TokenizationRegistry.get(this._languageIdentifier.language));\r\n        this._tokens = new ModelLinesTokens(this._languageIdentifier, tokenizationSupport);\r\n        this._beginBackgroundTokenization();\r\n    };\r\n    TextModel.prototype._clearTimers = function () {\r\n        if (this._revalidateTokensTimeout !== -1) {\r\n            clearTimeout(this._revalidateTokensTimeout);\r\n            this._revalidateTokensTimeout = -1;\r\n        }\r\n    };\r\n    TextModel.prototype.onBeforeAttached = function () {\r\n        this._attachedEditorCount++;\r\n        // Warm up tokens for the editor\r\n        this._warmUpTokens();\r\n    };\r\n    TextModel.prototype.onBeforeDetached = function () {\r\n        this._attachedEditorCount--;\r\n    };\r\n    TextModel.prototype._shouldAutoTokenize = function () {\r\n        return this.isAttachedToEditor();\r\n    };\r\n    TextModel.prototype.isAttachedToEditor = function () {\r\n        return this._attachedEditorCount > 0;\r\n    };\r\n    TextModel.prototype.getAttachedEditorCount = function () {\r\n        return this._attachedEditorCount;\r\n    };\r\n    TextModel.prototype.isTooLargeForSyncing = function () {\r\n        return this._isTooLargeForSyncing;\r\n    };\r\n    TextModel.prototype.isTooLargeForTokenization = function () {\r\n        return this._isTooLargeForTokenization;\r\n    };\r\n    TextModel.prototype.isDisposed = function () {\r\n        return this._isDisposed;\r\n    };\r\n    TextModel.prototype.isDominatedByLongLines = function () {\r\n        this._assertNotDisposed();\r\n        if (this.isTooLargeForTokenization()) {\r\n            // Cannot word wrap huge files anyways, so it doesn't really matter\r\n            return false;\r\n        }\r\n        var smallLineCharCount = 0;\r\n        var longLineCharCount = 0;\r\n        var lineCount = this._buffer.getLineCount();\r\n        for (var lineNumber = 1; lineNumber <= lineCount; lineNumber++) {\r\n            var lineLength = this._buffer.getLineLength(lineNumber);\r\n            if (lineLength >= LONG_LINE_BOUNDARY) {\r\n                longLineCharCount += lineLength;\r\n            }\r\n            else {\r\n                smallLineCharCount += lineLength;\r\n            }\r\n        }\r\n        return (longLineCharCount > smallLineCharCount);\r\n    };\r\n    Object.defineProperty(TextModel.prototype, \"uri\", {\r\n        get: function () {\r\n            return this._associatedResource;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    //#region Options\r\n    TextModel.prototype.getOptions = function () {\r\n        this._assertNotDisposed();\r\n        return this._options;\r\n    };\r\n    TextModel.prototype.updateOptions = function (_newOpts) {\r\n        this._assertNotDisposed();\r\n        var tabSize = (typeof _newOpts.tabSize !== 'undefined') ? _newOpts.tabSize : this._options.tabSize;\r\n        var insertSpaces = (typeof _newOpts.insertSpaces !== 'undefined') ? _newOpts.insertSpaces : this._options.insertSpaces;\r\n        var trimAutoWhitespace = (typeof _newOpts.trimAutoWhitespace !== 'undefined') ? _newOpts.trimAutoWhitespace : this._options.trimAutoWhitespace;\r\n        var newOpts = new model.TextModelResolvedOptions({\r\n            tabSize: tabSize,\r\n            insertSpaces: insertSpaces,\r\n            defaultEOL: this._options.defaultEOL,\r\n            trimAutoWhitespace: trimAutoWhitespace\r\n        });\r\n        if (this._options.equals(newOpts)) {\r\n            return;\r\n        }\r\n        var e = this._options.createChangeEvent(newOpts);\r\n        this._options = newOpts;\r\n        this._onDidChangeOptions.fire(e);\r\n    };\r\n    TextModel.prototype.detectIndentation = function (defaultInsertSpaces, defaultTabSize) {\r\n        this._assertNotDisposed();\r\n        var guessedIndentation = guessIndentation(this._buffer, defaultTabSize, defaultInsertSpaces);\r\n        this.updateOptions({\r\n            insertSpaces: guessedIndentation.insertSpaces,\r\n            tabSize: guessedIndentation.tabSize\r\n        });\r\n    };\r\n    TextModel._normalizeIndentationFromWhitespace = function (str, tabSize, insertSpaces) {\r\n        var spacesCnt = 0;\r\n        for (var i = 0; i < str.length; i++) {\r\n            if (str.charAt(i) === '\\t') {\r\n                spacesCnt += tabSize;\r\n            }\r\n            else {\r\n                spacesCnt++;\r\n            }\r\n        }\r\n        var result = '';\r\n        if (!insertSpaces) {\r\n            var tabsCnt = Math.floor(spacesCnt / tabSize);\r\n            spacesCnt = spacesCnt % tabSize;\r\n            for (var i = 0; i < tabsCnt; i++) {\r\n                result += '\\t';\r\n            }\r\n        }\r\n        for (var i = 0; i < spacesCnt; i++) {\r\n            result += ' ';\r\n        }\r\n        return result;\r\n    };\r\n    TextModel.normalizeIndentation = function (str, tabSize, insertSpaces) {\r\n        var firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(str);\r\n        if (firstNonWhitespaceIndex === -1) {\r\n            firstNonWhitespaceIndex = str.length;\r\n        }\r\n        return TextModel._normalizeIndentationFromWhitespace(str.substring(0, firstNonWhitespaceIndex), tabSize, insertSpaces) + str.substring(firstNonWhitespaceIndex);\r\n    };\r\n    TextModel.prototype.normalizeIndentation = function (str) {\r\n        this._assertNotDisposed();\r\n        return TextModel.normalizeIndentation(str, this._options.tabSize, this._options.insertSpaces);\r\n    };\r\n    TextModel.prototype.getOneIndent = function () {\r\n        this._assertNotDisposed();\r\n        var tabSize = this._options.tabSize;\r\n        var insertSpaces = this._options.insertSpaces;\r\n        if (insertSpaces) {\r\n            var result = '';\r\n            for (var i = 0; i < tabSize; i++) {\r\n                result += ' ';\r\n            }\r\n            return result;\r\n        }\r\n        else {\r\n            return '\\t';\r\n        }\r\n    };\r\n    //#endregion\r\n    //#region Reading\r\n    TextModel.prototype.getVersionId = function () {\r\n        this._assertNotDisposed();\r\n        return this._versionId;\r\n    };\r\n    TextModel.prototype.mightContainRTL = function () {\r\n        return this._buffer.mightContainRTL();\r\n    };\r\n    TextModel.prototype.mightContainNonBasicASCII = function () {\r\n        return this._buffer.mightContainNonBasicASCII();\r\n    };\r\n    TextModel.prototype.getAlternativeVersionId = function () {\r\n        this._assertNotDisposed();\r\n        return this._alternativeVersionId;\r\n    };\r\n    TextModel.prototype.getOffsetAt = function (rawPosition) {\r\n        this._assertNotDisposed();\r\n        var position = this._validatePosition(rawPosition.lineNumber, rawPosition.column, false);\r\n        return this._buffer.getOffsetAt(position.lineNumber, position.column);\r\n    };\r\n    TextModel.prototype.getPositionAt = function (rawOffset) {\r\n        this._assertNotDisposed();\r\n        var offset = (Math.min(this._buffer.getLength(), Math.max(0, rawOffset)));\r\n        return this._buffer.getPositionAt(offset);\r\n    };\r\n    TextModel.prototype._increaseVersionId = function () {\r\n        this._setVersionId(this._versionId + 1);\r\n    };\r\n    TextModel.prototype._setVersionId = function (newVersionId) {\r\n        this._versionId = newVersionId;\r\n        this._alternativeVersionId = this._versionId;\r\n    };\r\n    TextModel.prototype._overwriteAlternativeVersionId = function (newAlternativeVersionId) {\r\n        this._alternativeVersionId = newAlternativeVersionId;\r\n    };\r\n    TextModel.prototype.getValue = function (eol, preserveBOM) {\r\n        if (preserveBOM === void 0) { preserveBOM = false; }\r\n        this._assertNotDisposed();\r\n        var fullModelRange = this.getFullModelRange();\r\n        var fullModelValue = this.getValueInRange(fullModelRange, eol);\r\n        if (preserveBOM) {\r\n            return this._buffer.getBOM() + fullModelValue;\r\n        }\r\n        return fullModelValue;\r\n    };\r\n    TextModel.prototype.getValueLength = function (eol, preserveBOM) {\r\n        if (preserveBOM === void 0) { preserveBOM = false; }\r\n        this._assertNotDisposed();\r\n        var fullModelRange = this.getFullModelRange();\r\n        var fullModelValue = this.getValueLengthInRange(fullModelRange, eol);\r\n        if (preserveBOM) {\r\n            return this._buffer.getBOM().length + fullModelValue;\r\n        }\r\n        return fullModelValue;\r\n    };\r\n    TextModel.prototype.getValueInRange = function (rawRange, eol) {\r\n        if (eol === void 0) { eol = 0 /* TextDefined */; }\r\n        this._assertNotDisposed();\r\n        return this._buffer.getValueInRange(this.validateRange(rawRange), eol);\r\n    };\r\n    TextModel.prototype.getValueLengthInRange = function (rawRange, eol) {\r\n        if (eol === void 0) { eol = 0 /* TextDefined */; }\r\n        this._assertNotDisposed();\r\n        return this._buffer.getValueLengthInRange(this.validateRange(rawRange), eol);\r\n    };\r\n    TextModel.prototype.getLineCount = function () {\r\n        this._assertNotDisposed();\r\n        return this._buffer.getLineCount();\r\n    };\r\n    TextModel.prototype.getLineContent = function (lineNumber) {\r\n        this._assertNotDisposed();\r\n        if (lineNumber < 1 || lineNumber > this.getLineCount()) {\r\n            throw new Error('Illegal value for lineNumber');\r\n        }\r\n        return this._buffer.getLineContent(lineNumber);\r\n    };\r\n    TextModel.prototype.getLineLength = function (lineNumber) {\r\n        this._assertNotDisposed();\r\n        if (lineNumber < 1 || lineNumber > this.getLineCount()) {\r\n            throw new Error('Illegal value for lineNumber');\r\n        }\r\n        return this._buffer.getLineLength(lineNumber);\r\n    };\r\n    TextModel.prototype.getLinesContent = function () {\r\n        this._assertNotDisposed();\r\n        return this._buffer.getLinesContent();\r\n    };\r\n    TextModel.prototype.getEOL = function () {\r\n        this._assertNotDisposed();\r\n        return this._buffer.getEOL();\r\n    };\r\n    TextModel.prototype.getLineMinColumn = function (lineNumber) {\r\n        this._assertNotDisposed();\r\n        return 1;\r\n    };\r\n    TextModel.prototype.getLineMaxColumn = function (lineNumber) {\r\n        this._assertNotDisposed();\r\n        if (lineNumber < 1 || lineNumber > this.getLineCount()) {\r\n            throw new Error('Illegal value for lineNumber');\r\n        }\r\n        return this._buffer.getLineLength(lineNumber) + 1;\r\n    };\r\n    TextModel.prototype.getLineFirstNonWhitespaceColumn = function (lineNumber) {\r\n        this._assertNotDisposed();\r\n        if (lineNumber < 1 || lineNumber > this.getLineCount()) {\r\n            throw new Error('Illegal value for lineNumber');\r\n        }\r\n        return this._buffer.getLineFirstNonWhitespaceColumn(lineNumber);\r\n    };\r\n    TextModel.prototype.getLineLastNonWhitespaceColumn = function (lineNumber) {\r\n        this._assertNotDisposed();\r\n        if (lineNumber < 1 || lineNumber > this.getLineCount()) {\r\n            throw new Error('Illegal value for lineNumber');\r\n        }\r\n        return this._buffer.getLineLastNonWhitespaceColumn(lineNumber);\r\n    };\r\n    /**\r\n     * Validates `range` is within buffer bounds, but allows it to sit in between surrogate pairs, etc.\r\n     * Will try to not allocate if possible.\r\n     */\r\n    TextModel.prototype._validateRangeRelaxedNoAllocations = function (range) {\r\n        var linesCount = this._buffer.getLineCount();\r\n        var initialStartLineNumber = range.startLineNumber;\r\n        var initialStartColumn = range.startColumn;\r\n        var startLineNumber;\r\n        var startColumn;\r\n        if (initialStartLineNumber < 1) {\r\n            startLineNumber = 1;\r\n            startColumn = 1;\r\n        }\r\n        else if (initialStartLineNumber > linesCount) {\r\n            startLineNumber = linesCount;\r\n            startColumn = this.getLineMaxColumn(startLineNumber);\r\n        }\r\n        else {\r\n            startLineNumber = initialStartLineNumber | 0;\r\n            if (initialStartColumn <= 1) {\r\n                startColumn = 1;\r\n            }\r\n            else {\r\n                var maxColumn = this.getLineMaxColumn(startLineNumber);\r\n                if (initialStartColumn >= maxColumn) {\r\n                    startColumn = maxColumn;\r\n                }\r\n                else {\r\n                    startColumn = initialStartColumn | 0;\r\n                }\r\n            }\r\n        }\r\n        var initialEndLineNumber = range.endLineNumber;\r\n        var initialEndColumn = range.endColumn;\r\n        var endLineNumber;\r\n        var endColumn;\r\n        if (initialEndLineNumber < 1) {\r\n            endLineNumber = 1;\r\n            endColumn = 1;\r\n        }\r\n        else if (initialEndLineNumber > linesCount) {\r\n            endLineNumber = linesCount;\r\n            endColumn = this.getLineMaxColumn(endLineNumber);\r\n        }\r\n        else {\r\n            endLineNumber = initialEndLineNumber | 0;\r\n            if (initialEndColumn <= 1) {\r\n                endColumn = 1;\r\n            }\r\n            else {\r\n                var maxColumn = this.getLineMaxColumn(endLineNumber);\r\n                if (initialEndColumn >= maxColumn) {\r\n                    endColumn = maxColumn;\r\n                }\r\n                else {\r\n                    endColumn = initialEndColumn | 0;\r\n                }\r\n            }\r\n        }\r\n        if (initialStartLineNumber === startLineNumber\r\n            && initialStartColumn === startColumn\r\n            && initialEndLineNumber === endLineNumber\r\n            && initialEndColumn === endColumn\r\n            && range instanceof Range\r\n            && !(range instanceof Selection)) {\r\n            return range;\r\n        }\r\n        return new Range(startLineNumber, startColumn, endLineNumber, endColumn);\r\n    };\r\n    /**\r\n     * @param strict Do NOT allow a position inside a high-low surrogate pair\r\n     */\r\n    TextModel.prototype._isValidPosition = function (lineNumber, column, strict) {\r\n        if (isNaN(lineNumber)) {\r\n            return false;\r\n        }\r\n        if (lineNumber < 1) {\r\n            return false;\r\n        }\r\n        var lineCount = this._buffer.getLineCount();\r\n        if (lineNumber > lineCount) {\r\n            return false;\r\n        }\r\n        if (isNaN(column)) {\r\n            return false;\r\n        }\r\n        if (column < 1) {\r\n            return false;\r\n        }\r\n        var maxColumn = this.getLineMaxColumn(lineNumber);\r\n        if (column > maxColumn) {\r\n            return false;\r\n        }\r\n        if (strict) {\r\n            if (column > 1) {\r\n                var charCodeBefore = this._buffer.getLineCharCode(lineNumber, column - 2);\r\n                if (strings.isHighSurrogate(charCodeBefore)) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * @param strict Do NOT allow a position inside a high-low surrogate pair\r\n     */\r\n    TextModel.prototype._validatePosition = function (_lineNumber, _column, strict) {\r\n        var lineNumber = Math.floor((typeof _lineNumber === 'number' && !isNaN(_lineNumber)) ? _lineNumber : 1);\r\n        var column = Math.floor((typeof _column === 'number' && !isNaN(_column)) ? _column : 1);\r\n        var lineCount = this._buffer.getLineCount();\r\n        if (lineNumber < 1) {\r\n            return new Position(1, 1);\r\n        }\r\n        if (lineNumber > lineCount) {\r\n            return new Position(lineCount, this.getLineMaxColumn(lineCount));\r\n        }\r\n        if (column <= 1) {\r\n            return new Position(lineNumber, 1);\r\n        }\r\n        var maxColumn = this.getLineMaxColumn(lineNumber);\r\n        if (column >= maxColumn) {\r\n            return new Position(lineNumber, maxColumn);\r\n        }\r\n        if (strict) {\r\n            // If the position would end up in the middle of a high-low surrogate pair,\r\n            // we move it to before the pair\r\n            // !!At this point, column > 1\r\n            var charCodeBefore = this._buffer.getLineCharCode(lineNumber, column - 2);\r\n            if (strings.isHighSurrogate(charCodeBefore)) {\r\n                return new Position(lineNumber, column - 1);\r\n            }\r\n        }\r\n        return new Position(lineNumber, column);\r\n    };\r\n    TextModel.prototype.validatePosition = function (position) {\r\n        this._assertNotDisposed();\r\n        // Avoid object allocation and cover most likely case\r\n        if (position instanceof Position) {\r\n            if (this._isValidPosition(position.lineNumber, position.column, true)) {\r\n                return position;\r\n            }\r\n        }\r\n        return this._validatePosition(position.lineNumber, position.column, true);\r\n    };\r\n    /**\r\n     * @param strict Do NOT allow a range to have its boundaries inside a high-low surrogate pair\r\n     */\r\n    TextModel.prototype._isValidRange = function (range, strict) {\r\n        var startLineNumber = range.startLineNumber;\r\n        var startColumn = range.startColumn;\r\n        var endLineNumber = range.endLineNumber;\r\n        var endColumn = range.endColumn;\r\n        if (!this._isValidPosition(startLineNumber, startColumn, false)) {\r\n            return false;\r\n        }\r\n        if (!this._isValidPosition(endLineNumber, endColumn, false)) {\r\n            return false;\r\n        }\r\n        if (strict) {\r\n            var charCodeBeforeStart = (startColumn > 1 ? this._buffer.getLineCharCode(startLineNumber, startColumn - 2) : 0);\r\n            var charCodeBeforeEnd = (endColumn > 1 && endColumn <= this._buffer.getLineLength(endLineNumber) ? this._buffer.getLineCharCode(endLineNumber, endColumn - 2) : 0);\r\n            var startInsideSurrogatePair = strings.isHighSurrogate(charCodeBeforeStart);\r\n            var endInsideSurrogatePair = strings.isHighSurrogate(charCodeBeforeEnd);\r\n            if (!startInsideSurrogatePair && !endInsideSurrogatePair) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    TextModel.prototype.validateRange = function (_range) {\r\n        this._assertNotDisposed();\r\n        // Avoid object allocation and cover most likely case\r\n        if ((_range instanceof Range) && !(_range instanceof Selection)) {\r\n            if (this._isValidRange(_range, true)) {\r\n                return _range;\r\n            }\r\n        }\r\n        var start = this._validatePosition(_range.startLineNumber, _range.startColumn, false);\r\n        var end = this._validatePosition(_range.endLineNumber, _range.endColumn, false);\r\n        var startLineNumber = start.lineNumber;\r\n        var startColumn = start.column;\r\n        var endLineNumber = end.lineNumber;\r\n        var endColumn = end.column;\r\n        var charCodeBeforeStart = (startColumn > 1 ? this._buffer.getLineCharCode(startLineNumber, startColumn - 2) : 0);\r\n        var charCodeBeforeEnd = (endColumn > 1 && endColumn <= this._buffer.getLineLength(endLineNumber) ? this._buffer.getLineCharCode(endLineNumber, endColumn - 2) : 0);\r\n        var startInsideSurrogatePair = strings.isHighSurrogate(charCodeBeforeStart);\r\n        var endInsideSurrogatePair = strings.isHighSurrogate(charCodeBeforeEnd);\r\n        if (!startInsideSurrogatePair && !endInsideSurrogatePair) {\r\n            return new Range(startLineNumber, startColumn, endLineNumber, endColumn);\r\n        }\r\n        if (startLineNumber === endLineNumber && startColumn === endColumn) {\r\n            // do not expand a collapsed range, simply move it to a valid location\r\n            return new Range(startLineNumber, startColumn - 1, endLineNumber, endColumn - 1);\r\n        }\r\n        if (startInsideSurrogatePair && endInsideSurrogatePair) {\r\n            // expand range at both ends\r\n            return new Range(startLineNumber, startColumn - 1, endLineNumber, endColumn + 1);\r\n        }\r\n        if (startInsideSurrogatePair) {\r\n            // only expand range at the start\r\n            return new Range(startLineNumber, startColumn - 1, endLineNumber, endColumn);\r\n        }\r\n        // only expand range at the end\r\n        return new Range(startLineNumber, startColumn, endLineNumber, endColumn + 1);\r\n    };\r\n    TextModel.prototype.modifyPosition = function (rawPosition, offset) {\r\n        this._assertNotDisposed();\r\n        var candidate = this.getOffsetAt(rawPosition) + offset;\r\n        return this.getPositionAt(Math.min(this._buffer.getLength(), Math.max(0, candidate)));\r\n    };\r\n    TextModel.prototype.getFullModelRange = function () {\r\n        this._assertNotDisposed();\r\n        var lineCount = this.getLineCount();\r\n        return new Range(1, 1, lineCount, this.getLineMaxColumn(lineCount));\r\n    };\r\n    TextModel.prototype.findMatchesLineByLine = function (searchRange, searchData, captureMatches, limitResultCount) {\r\n        return this._buffer.findMatchesLineByLine(searchRange, searchData, captureMatches, limitResultCount);\r\n    };\r\n    TextModel.prototype.findMatches = function (searchString, rawSearchScope, isRegex, matchCase, wordSeparators, captureMatches, limitResultCount) {\r\n        if (limitResultCount === void 0) { limitResultCount = LIMIT_FIND_COUNT; }\r\n        this._assertNotDisposed();\r\n        var searchRange;\r\n        if (Range.isIRange(rawSearchScope)) {\r\n            searchRange = this.validateRange(rawSearchScope);\r\n        }\r\n        else {\r\n            searchRange = this.getFullModelRange();\r\n        }\r\n        if (!isRegex && searchString.indexOf('\\n') < 0) {\r\n            // not regex, not multi line\r\n            var searchParams = new SearchParams(searchString, isRegex, matchCase, wordSeparators);\r\n            var searchData = searchParams.parseSearchRequest();\r\n            if (!searchData) {\r\n                return [];\r\n            }\r\n            return this.findMatchesLineByLine(searchRange, searchData, captureMatches, limitResultCount);\r\n        }\r\n        return TextModelSearch.findMatches(this, new SearchParams(searchString, isRegex, matchCase, wordSeparators), searchRange, captureMatches, limitResultCount);\r\n    };\r\n    TextModel.prototype.findNextMatch = function (searchString, rawSearchStart, isRegex, matchCase, wordSeparators, captureMatches) {\r\n        this._assertNotDisposed();\r\n        var searchStart = this.validatePosition(rawSearchStart);\r\n        if (!isRegex && searchString.indexOf('\\n') < 0) {\r\n            var searchParams = new SearchParams(searchString, isRegex, matchCase, wordSeparators);\r\n            var searchData = searchParams.parseSearchRequest();\r\n            if (!searchData) {\r\n                return null;\r\n            }\r\n            var lineCount = this.getLineCount();\r\n            var searchRange = new Range(searchStart.lineNumber, searchStart.column, lineCount, this.getLineMaxColumn(lineCount));\r\n            var ret = this.findMatchesLineByLine(searchRange, searchData, captureMatches, 1);\r\n            TextModelSearch.findNextMatch(this, new SearchParams(searchString, isRegex, matchCase, wordSeparators), searchStart, captureMatches);\r\n            if (ret.length > 0) {\r\n                return ret[0];\r\n            }\r\n            searchRange = new Range(1, 1, searchStart.lineNumber, this.getLineMaxColumn(searchStart.lineNumber));\r\n            ret = this.findMatchesLineByLine(searchRange, searchData, captureMatches, 1);\r\n            if (ret.length > 0) {\r\n                return ret[0];\r\n            }\r\n            return null;\r\n        }\r\n        return TextModelSearch.findNextMatch(this, new SearchParams(searchString, isRegex, matchCase, wordSeparators), searchStart, captureMatches);\r\n    };\r\n    TextModel.prototype.findPreviousMatch = function (searchString, rawSearchStart, isRegex, matchCase, wordSeparators, captureMatches) {\r\n        this._assertNotDisposed();\r\n        var searchStart = this.validatePosition(rawSearchStart);\r\n        return TextModelSearch.findPreviousMatch(this, new SearchParams(searchString, isRegex, matchCase, wordSeparators), searchStart, captureMatches);\r\n    };\r\n    //#endregion\r\n    //#region Editing\r\n    TextModel.prototype.pushStackElement = function () {\r\n        this._commandManager.pushStackElement();\r\n    };\r\n    TextModel.prototype.pushEOL = function (eol) {\r\n        var currentEOL = (this.getEOL() === '\\n' ? 0 /* LF */ : 1 /* CRLF */);\r\n        if (currentEOL === eol) {\r\n            return;\r\n        }\r\n        try {\r\n            this._onDidChangeDecorations.beginDeferredEmit();\r\n            this._eventEmitter.beginDeferredEmit();\r\n            this._commandManager.pushEOL(eol);\r\n        }\r\n        finally {\r\n            this._eventEmitter.endDeferredEmit();\r\n            this._onDidChangeDecorations.endDeferredEmit();\r\n        }\r\n    };\r\n    TextModel.prototype.pushEditOperations = function (beforeCursorState, editOperations, cursorStateComputer) {\r\n        try {\r\n            this._onDidChangeDecorations.beginDeferredEmit();\r\n            this._eventEmitter.beginDeferredEmit();\r\n            return this._pushEditOperations(beforeCursorState, editOperations, cursorStateComputer);\r\n        }\r\n        finally {\r\n            this._eventEmitter.endDeferredEmit();\r\n            this._onDidChangeDecorations.endDeferredEmit();\r\n        }\r\n    };\r\n    TextModel.prototype._pushEditOperations = function (beforeCursorState, editOperations, cursorStateComputer) {\r\n        var _this = this;\r\n        if (this._options.trimAutoWhitespace && this._trimAutoWhitespaceLines) {\r\n            // Go through each saved line number and insert a trim whitespace edit\r\n            // if it is safe to do so (no conflicts with other edits).\r\n            var incomingEdits = editOperations.map(function (op) {\r\n                return {\r\n                    range: _this.validateRange(op.range),\r\n                    text: op.text\r\n                };\r\n            });\r\n            // Sometimes, auto-formatters change ranges automatically which can cause undesired auto whitespace trimming near the cursor\r\n            // We'll use the following heuristic: if the edits occur near the cursor, then it's ok to trim auto whitespace\r\n            var editsAreNearCursors = true;\r\n            for (var i = 0, len = beforeCursorState.length; i < len; i++) {\r\n                var sel = beforeCursorState[i];\r\n                var foundEditNearSel = false;\r\n                for (var j = 0, lenJ = incomingEdits.length; j < lenJ; j++) {\r\n                    var editRange = incomingEdits[j].range;\r\n                    var selIsAbove = editRange.startLineNumber > sel.endLineNumber;\r\n                    var selIsBelow = sel.startLineNumber > editRange.endLineNumber;\r\n                    if (!selIsAbove && !selIsBelow) {\r\n                        foundEditNearSel = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if (!foundEditNearSel) {\r\n                    editsAreNearCursors = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (editsAreNearCursors) {\r\n                for (var i = 0, len = this._trimAutoWhitespaceLines.length; i < len; i++) {\r\n                    var trimLineNumber = this._trimAutoWhitespaceLines[i];\r\n                    var maxLineColumn = this.getLineMaxColumn(trimLineNumber);\r\n                    var allowTrimLine = true;\r\n                    for (var j = 0, lenJ = incomingEdits.length; j < lenJ; j++) {\r\n                        var editRange = incomingEdits[j].range;\r\n                        var editText = incomingEdits[j].text;\r\n                        if (trimLineNumber < editRange.startLineNumber || trimLineNumber > editRange.endLineNumber) {\r\n                            // `trimLine` is completely outside this edit\r\n                            continue;\r\n                        }\r\n                        // At this point:\r\n                        //   editRange.startLineNumber <= trimLine <= editRange.endLineNumber\r\n                        if (trimLineNumber === editRange.startLineNumber && editRange.startColumn === maxLineColumn\r\n                            && editRange.isEmpty() && editText && editText.length > 0 && editText.charAt(0) === '\\n') {\r\n                            // This edit inserts a new line (and maybe other text) after `trimLine`\r\n                            continue;\r\n                        }\r\n                        if (trimLineNumber === editRange.startLineNumber && editRange.startColumn === 1\r\n                            && editRange.isEmpty() && editText && editText.length > 0 && editText.charAt(editText.length - 1) === '\\n') {\r\n                            // This edit inserts a new line (and maybe other text) before `trimLine`\r\n                            continue;\r\n                        }\r\n                        // Looks like we can't trim this line as it would interfere with an incoming edit\r\n                        allowTrimLine = false;\r\n                        break;\r\n                    }\r\n                    if (allowTrimLine) {\r\n                        editOperations.push({\r\n                            range: new Range(trimLineNumber, 1, trimLineNumber, maxLineColumn),\r\n                            text: null\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n            this._trimAutoWhitespaceLines = null;\r\n        }\r\n        return this._commandManager.pushEditOperation(beforeCursorState, editOperations, cursorStateComputer);\r\n    };\r\n    TextModel.prototype.applyEdits = function (rawOperations) {\r\n        try {\r\n            this._onDidChangeDecorations.beginDeferredEmit();\r\n            this._eventEmitter.beginDeferredEmit();\r\n            return this._applyEdits(rawOperations);\r\n        }\r\n        finally {\r\n            this._eventEmitter.endDeferredEmit();\r\n            this._onDidChangeDecorations.endDeferredEmit();\r\n        }\r\n    };\r\n    TextModel._eolCount = function (text) {\r\n        var eolCount = 0;\r\n        var firstLineLength = 0;\r\n        for (var i = 0, len = text.length; i < len; i++) {\r\n            var chr = text.charCodeAt(i);\r\n            if (chr === 13 /* CarriageReturn */) {\r\n                if (eolCount === 0) {\r\n                    firstLineLength = i;\r\n                }\r\n                eolCount++;\r\n                if (i + 1 < len && text.charCodeAt(i + 1) === 10 /* LineFeed */) {\r\n                    // \\r\\n... case\r\n                    i++; // skip \\n\r\n                }\r\n                else {\r\n                    // \\r... case\r\n                }\r\n            }\r\n            else if (chr === 10 /* LineFeed */) {\r\n                if (eolCount === 0) {\r\n                    firstLineLength = i;\r\n                }\r\n                eolCount++;\r\n            }\r\n        }\r\n        if (eolCount === 0) {\r\n            firstLineLength = text.length;\r\n        }\r\n        return [eolCount, firstLineLength];\r\n    };\r\n    TextModel.prototype._applyEdits = function (rawOperations) {\r\n        for (var i = 0, len = rawOperations.length; i < len; i++) {\r\n            rawOperations[i].range = this.validateRange(rawOperations[i].range);\r\n        }\r\n        var oldLineCount = this._buffer.getLineCount();\r\n        var result = this._buffer.applyEdits(rawOperations, this._options.trimAutoWhitespace);\r\n        var newLineCount = this._buffer.getLineCount();\r\n        var contentChanges = result.changes;\r\n        this._trimAutoWhitespaceLines = result.trimAutoWhitespaceLineNumbers;\r\n        if (contentChanges.length !== 0) {\r\n            var rawContentChanges = [];\r\n            var lineCount = oldLineCount;\r\n            for (var i = 0, len = contentChanges.length; i < len; i++) {\r\n                var change = contentChanges[i];\r\n                var _a = TextModel._eolCount(change.text), eolCount = _a[0], firstLineLength = _a[1];\r\n                try {\r\n                    this._tokens.applyEdits(change.range, eolCount, firstLineLength);\r\n                }\r\n                catch (err) {\r\n                    // emergency recovery => reset tokens\r\n                    this._tokens = new ModelLinesTokens(this._tokens.languageIdentifier, this._tokens.tokenizationSupport);\r\n                }\r\n                this._onDidChangeDecorations.fire();\r\n                this._decorationsTree.acceptReplace(change.rangeOffset, change.rangeLength, change.text.length, change.forceMoveMarkers);\r\n                var startLineNumber = change.range.startLineNumber;\r\n                var endLineNumber = change.range.endLineNumber;\r\n                var deletingLinesCnt = endLineNumber - startLineNumber;\r\n                var insertingLinesCnt = eolCount;\r\n                var editingLinesCnt = Math.min(deletingLinesCnt, insertingLinesCnt);\r\n                var changeLineCountDelta = (insertingLinesCnt - deletingLinesCnt);\r\n                for (var j = editingLinesCnt; j >= 0; j--) {\r\n                    var editLineNumber = startLineNumber + j;\r\n                    var currentEditLineNumber = newLineCount - lineCount - changeLineCountDelta + editLineNumber;\r\n                    rawContentChanges.push(new ModelRawLineChanged(editLineNumber, this.getLineContent(currentEditLineNumber)));\r\n                }\r\n                if (editingLinesCnt < deletingLinesCnt) {\r\n                    // Must delete some lines\r\n                    var spliceStartLineNumber = startLineNumber + editingLinesCnt;\r\n                    rawContentChanges.push(new ModelRawLinesDeleted(spliceStartLineNumber + 1, endLineNumber));\r\n                }\r\n                if (editingLinesCnt < insertingLinesCnt) {\r\n                    // Must insert some lines\r\n                    var spliceLineNumber = startLineNumber + editingLinesCnt;\r\n                    var cnt = insertingLinesCnt - editingLinesCnt;\r\n                    var fromLineNumber = newLineCount - lineCount - cnt + spliceLineNumber + 1;\r\n                    var newLines = [];\r\n                    for (var i_1 = 0; i_1 < cnt; i_1++) {\r\n                        var lineNumber = fromLineNumber + i_1;\r\n                        newLines[lineNumber - fromLineNumber] = this.getLineContent(lineNumber);\r\n                    }\r\n                    rawContentChanges.push(new ModelRawLinesInserted(spliceLineNumber + 1, startLineNumber + insertingLinesCnt, newLines));\r\n                }\r\n                lineCount += changeLineCountDelta;\r\n            }\r\n            this._increaseVersionId();\r\n            this._emitContentChangedEvent(new ModelRawContentChangedEvent(rawContentChanges, this.getVersionId(), this._isUndoing, this._isRedoing), {\r\n                changes: contentChanges,\r\n                eol: this._buffer.getEOL(),\r\n                versionId: this.getVersionId(),\r\n                isUndoing: this._isUndoing,\r\n                isRedoing: this._isRedoing,\r\n                isFlush: false\r\n            });\r\n        }\r\n        if (this._tokens.hasLinesToTokenize(this._buffer)) {\r\n            this._beginBackgroundTokenization();\r\n        }\r\n        return result.reverseEdits;\r\n    };\r\n    TextModel.prototype._undo = function () {\r\n        this._isUndoing = true;\r\n        var r = this._commandManager.undo();\r\n        this._isUndoing = false;\r\n        if (!r) {\r\n            return null;\r\n        }\r\n        this._overwriteAlternativeVersionId(r.recordedVersionId);\r\n        return r.selections;\r\n    };\r\n    TextModel.prototype.undo = function () {\r\n        try {\r\n            this._onDidChangeDecorations.beginDeferredEmit();\r\n            this._eventEmitter.beginDeferredEmit();\r\n            return this._undo();\r\n        }\r\n        finally {\r\n            this._eventEmitter.endDeferredEmit();\r\n            this._onDidChangeDecorations.endDeferredEmit();\r\n        }\r\n    };\r\n    TextModel.prototype.canUndo = function () {\r\n        return this._commandManager.canUndo();\r\n    };\r\n    TextModel.prototype._redo = function () {\r\n        this._isRedoing = true;\r\n        var r = this._commandManager.redo();\r\n        this._isRedoing = false;\r\n        if (!r) {\r\n            return null;\r\n        }\r\n        this._overwriteAlternativeVersionId(r.recordedVersionId);\r\n        return r.selections;\r\n    };\r\n    TextModel.prototype.redo = function () {\r\n        try {\r\n            this._onDidChangeDecorations.beginDeferredEmit();\r\n            this._eventEmitter.beginDeferredEmit();\r\n            return this._redo();\r\n        }\r\n        finally {\r\n            this._eventEmitter.endDeferredEmit();\r\n            this._onDidChangeDecorations.endDeferredEmit();\r\n        }\r\n    };\r\n    TextModel.prototype.canRedo = function () {\r\n        return this._commandManager.canRedo();\r\n    };\r\n    //#endregion\r\n    //#region Decorations\r\n    TextModel.prototype.changeDecorations = function (callback, ownerId) {\r\n        if (ownerId === void 0) { ownerId = 0; }\r\n        this._assertNotDisposed();\r\n        try {\r\n            this._onDidChangeDecorations.beginDeferredEmit();\r\n            return this._changeDecorations(ownerId, callback);\r\n        }\r\n        finally {\r\n            this._onDidChangeDecorations.endDeferredEmit();\r\n        }\r\n    };\r\n    TextModel.prototype._changeDecorations = function (ownerId, callback) {\r\n        var _this = this;\r\n        var changeAccessor = {\r\n            addDecoration: function (range, options) {\r\n                _this._onDidChangeDecorations.fire();\r\n                return _this._deltaDecorationsImpl(ownerId, [], [{ range: range, options: options }])[0];\r\n            },\r\n            changeDecoration: function (id, newRange) {\r\n                _this._onDidChangeDecorations.fire();\r\n                _this._changeDecorationImpl(id, newRange);\r\n            },\r\n            changeDecorationOptions: function (id, options) {\r\n                _this._onDidChangeDecorations.fire();\r\n                _this._changeDecorationOptionsImpl(id, _normalizeOptions(options));\r\n            },\r\n            removeDecoration: function (id) {\r\n                _this._onDidChangeDecorations.fire();\r\n                _this._deltaDecorationsImpl(ownerId, [id], []);\r\n            },\r\n            deltaDecorations: function (oldDecorations, newDecorations) {\r\n                if (oldDecorations.length === 0 && newDecorations.length === 0) {\r\n                    // nothing to do\r\n                    return [];\r\n                }\r\n                _this._onDidChangeDecorations.fire();\r\n                return _this._deltaDecorationsImpl(ownerId, oldDecorations, newDecorations);\r\n            }\r\n        };\r\n        var result = null;\r\n        try {\r\n            result = callback(changeAccessor);\r\n        }\r\n        catch (e) {\r\n            onUnexpectedError(e);\r\n        }\r\n        // Invalidate change accessor\r\n        changeAccessor.addDecoration = invalidFunc;\r\n        changeAccessor.changeDecoration = invalidFunc;\r\n        changeAccessor.changeDecorationOptions = invalidFunc;\r\n        changeAccessor.removeDecoration = invalidFunc;\r\n        changeAccessor.deltaDecorations = invalidFunc;\r\n        return result;\r\n    };\r\n    TextModel.prototype.deltaDecorations = function (oldDecorations, newDecorations, ownerId) {\r\n        if (ownerId === void 0) { ownerId = 0; }\r\n        this._assertNotDisposed();\r\n        if (!oldDecorations) {\r\n            oldDecorations = [];\r\n        }\r\n        if (oldDecorations.length === 0 && newDecorations.length === 0) {\r\n            // nothing to do\r\n            return [];\r\n        }\r\n        try {\r\n            this._onDidChangeDecorations.beginDeferredEmit();\r\n            this._onDidChangeDecorations.fire();\r\n            return this._deltaDecorationsImpl(ownerId, oldDecorations, newDecorations);\r\n        }\r\n        finally {\r\n            this._onDidChangeDecorations.endDeferredEmit();\r\n        }\r\n    };\r\n    TextModel.prototype._getTrackedRange = function (id) {\r\n        return this.getDecorationRange(id);\r\n    };\r\n    TextModel.prototype._setTrackedRange = function (id, newRange, newStickiness) {\r\n        var node = (id ? this._decorations[id] : null);\r\n        if (!node) {\r\n            if (!newRange) {\r\n                // node doesn't exist, the request is to delete => nothing to do\r\n                return null;\r\n            }\r\n            // node doesn't exist, the request is to set => add the tracked range\r\n            return this._deltaDecorationsImpl(0, [], [{ range: newRange, options: TRACKED_RANGE_OPTIONS[newStickiness] }])[0];\r\n        }\r\n        if (!newRange) {\r\n            // node exists, the request is to delete => delete node\r\n            this._decorationsTree.delete(node);\r\n            delete this._decorations[node.id];\r\n            return null;\r\n        }\r\n        // node exists, the request is to set => change the tracked range and its options\r\n        var range = this._validateRangeRelaxedNoAllocations(newRange);\r\n        var startOffset = this._buffer.getOffsetAt(range.startLineNumber, range.startColumn);\r\n        var endOffset = this._buffer.getOffsetAt(range.endLineNumber, range.endColumn);\r\n        this._decorationsTree.delete(node);\r\n        node.reset(this.getVersionId(), startOffset, endOffset, range);\r\n        node.setOptions(TRACKED_RANGE_OPTIONS[newStickiness]);\r\n        this._decorationsTree.insert(node);\r\n        return node.id;\r\n    };\r\n    TextModel.prototype.removeAllDecorationsWithOwnerId = function (ownerId) {\r\n        if (this._isDisposed) {\r\n            return;\r\n        }\r\n        var nodes = this._decorationsTree.collectNodesFromOwner(ownerId);\r\n        for (var i = 0, len = nodes.length; i < len; i++) {\r\n            var node = nodes[i];\r\n            this._decorationsTree.delete(node);\r\n            delete this._decorations[node.id];\r\n        }\r\n    };\r\n    TextModel.prototype.getDecorationOptions = function (decorationId) {\r\n        var node = this._decorations[decorationId];\r\n        if (!node) {\r\n            return null;\r\n        }\r\n        return node.options;\r\n    };\r\n    TextModel.prototype.getDecorationRange = function (decorationId) {\r\n        var node = this._decorations[decorationId];\r\n        if (!node) {\r\n            return null;\r\n        }\r\n        var versionId = this.getVersionId();\r\n        if (node.cachedVersionId !== versionId) {\r\n            this._decorationsTree.resolveNode(node, versionId);\r\n        }\r\n        if (node.range === null) {\r\n            node.range = this._getRangeAt(node.cachedAbsoluteStart, node.cachedAbsoluteEnd);\r\n        }\r\n        return node.range;\r\n    };\r\n    TextModel.prototype.getLineDecorations = function (lineNumber, ownerId, filterOutValidation) {\r\n        if (ownerId === void 0) { ownerId = 0; }\r\n        if (filterOutValidation === void 0) { filterOutValidation = false; }\r\n        if (lineNumber < 1 || lineNumber > this.getLineCount()) {\r\n            return [];\r\n        }\r\n        return this.getLinesDecorations(lineNumber, lineNumber, ownerId, filterOutValidation);\r\n    };\r\n    TextModel.prototype.getLinesDecorations = function (_startLineNumber, _endLineNumber, ownerId, filterOutValidation) {\r\n        if (ownerId === void 0) { ownerId = 0; }\r\n        if (filterOutValidation === void 0) { filterOutValidation = false; }\r\n        var lineCount = this.getLineCount();\r\n        var startLineNumber = Math.min(lineCount, Math.max(1, _startLineNumber));\r\n        var endLineNumber = Math.min(lineCount, Math.max(1, _endLineNumber));\r\n        var endColumn = this.getLineMaxColumn(endLineNumber);\r\n        return this._getDecorationsInRange(new Range(startLineNumber, 1, endLineNumber, endColumn), ownerId, filterOutValidation);\r\n    };\r\n    TextModel.prototype.getDecorationsInRange = function (range, ownerId, filterOutValidation) {\r\n        if (ownerId === void 0) { ownerId = 0; }\r\n        if (filterOutValidation === void 0) { filterOutValidation = false; }\r\n        var validatedRange = this.validateRange(range);\r\n        return this._getDecorationsInRange(validatedRange, ownerId, filterOutValidation);\r\n    };\r\n    TextModel.prototype.getOverviewRulerDecorations = function (ownerId, filterOutValidation) {\r\n        if (ownerId === void 0) { ownerId = 0; }\r\n        if (filterOutValidation === void 0) { filterOutValidation = false; }\r\n        var versionId = this.getVersionId();\r\n        var result = this._decorationsTree.search(ownerId, filterOutValidation, true, versionId);\r\n        return this._ensureNodesHaveRanges(result);\r\n    };\r\n    TextModel.prototype.getAllDecorations = function (ownerId, filterOutValidation) {\r\n        if (ownerId === void 0) { ownerId = 0; }\r\n        if (filterOutValidation === void 0) { filterOutValidation = false; }\r\n        var versionId = this.getVersionId();\r\n        var result = this._decorationsTree.search(ownerId, filterOutValidation, false, versionId);\r\n        return this._ensureNodesHaveRanges(result);\r\n    };\r\n    TextModel.prototype._getDecorationsInRange = function (filterRange, filterOwnerId, filterOutValidation) {\r\n        var startOffset = this._buffer.getOffsetAt(filterRange.startLineNumber, filterRange.startColumn);\r\n        var endOffset = this._buffer.getOffsetAt(filterRange.endLineNumber, filterRange.endColumn);\r\n        var versionId = this.getVersionId();\r\n        var result = this._decorationsTree.intervalSearch(startOffset, endOffset, filterOwnerId, filterOutValidation, versionId);\r\n        return this._ensureNodesHaveRanges(result);\r\n    };\r\n    TextModel.prototype._ensureNodesHaveRanges = function (nodes) {\r\n        for (var i = 0, len = nodes.length; i < len; i++) {\r\n            var node = nodes[i];\r\n            if (node.range === null) {\r\n                node.range = this._getRangeAt(node.cachedAbsoluteStart, node.cachedAbsoluteEnd);\r\n            }\r\n        }\r\n        return nodes;\r\n    };\r\n    TextModel.prototype._getRangeAt = function (start, end) {\r\n        return this._buffer.getRangeAt(start, end - start);\r\n    };\r\n    TextModel.prototype._changeDecorationImpl = function (decorationId, _range) {\r\n        var node = this._decorations[decorationId];\r\n        if (!node) {\r\n            return;\r\n        }\r\n        var range = this._validateRangeRelaxedNoAllocations(_range);\r\n        var startOffset = this._buffer.getOffsetAt(range.startLineNumber, range.startColumn);\r\n        var endOffset = this._buffer.getOffsetAt(range.endLineNumber, range.endColumn);\r\n        this._decorationsTree.delete(node);\r\n        node.reset(this.getVersionId(), startOffset, endOffset, range);\r\n        this._decorationsTree.insert(node);\r\n    };\r\n    TextModel.prototype._changeDecorationOptionsImpl = function (decorationId, options) {\r\n        var node = this._decorations[decorationId];\r\n        if (!node) {\r\n            return;\r\n        }\r\n        var nodeWasInOverviewRuler = (node.options.overviewRuler && node.options.overviewRuler.color ? true : false);\r\n        var nodeIsInOverviewRuler = (options.overviewRuler && options.overviewRuler.color ? true : false);\r\n        if (nodeWasInOverviewRuler !== nodeIsInOverviewRuler) {\r\n            // Delete + Insert due to an overview ruler status change\r\n            this._decorationsTree.delete(node);\r\n            node.setOptions(options);\r\n            this._decorationsTree.insert(node);\r\n        }\r\n        else {\r\n            node.setOptions(options);\r\n        }\r\n    };\r\n    TextModel.prototype._deltaDecorationsImpl = function (ownerId, oldDecorationsIds, newDecorations) {\r\n        var versionId = this.getVersionId();\r\n        var oldDecorationsLen = oldDecorationsIds.length;\r\n        var oldDecorationIndex = 0;\r\n        var newDecorationsLen = newDecorations.length;\r\n        var newDecorationIndex = 0;\r\n        var result = new Array(newDecorationsLen);\r\n        while (oldDecorationIndex < oldDecorationsLen || newDecorationIndex < newDecorationsLen) {\r\n            var node = null;\r\n            if (oldDecorationIndex < oldDecorationsLen) {\r\n                // (1) get ourselves an old node\r\n                do {\r\n                    node = this._decorations[oldDecorationsIds[oldDecorationIndex++]];\r\n                } while (!node && oldDecorationIndex < oldDecorationsLen);\r\n                // (2) remove the node from the tree (if it exists)\r\n                if (node) {\r\n                    this._decorationsTree.delete(node);\r\n                }\r\n            }\r\n            if (newDecorationIndex < newDecorationsLen) {\r\n                // (3) create a new node if necessary\r\n                if (!node) {\r\n                    var internalDecorationId = (++this._lastDecorationId);\r\n                    var decorationId = this._instanceId + \";\" + internalDecorationId;\r\n                    node = new IntervalNode(decorationId, 0, 0);\r\n                    this._decorations[decorationId] = node;\r\n                }\r\n                // (4) initialize node\r\n                var newDecoration = newDecorations[newDecorationIndex];\r\n                var range = this._validateRangeRelaxedNoAllocations(newDecoration.range);\r\n                var options = _normalizeOptions(newDecoration.options);\r\n                var startOffset = this._buffer.getOffsetAt(range.startLineNumber, range.startColumn);\r\n                var endOffset = this._buffer.getOffsetAt(range.endLineNumber, range.endColumn);\r\n                node.ownerId = ownerId;\r\n                node.reset(versionId, startOffset, endOffset, range);\r\n                node.setOptions(options);\r\n                this._decorationsTree.insert(node);\r\n                result[newDecorationIndex] = node.id;\r\n                newDecorationIndex++;\r\n            }\r\n            else {\r\n                if (node) {\r\n                    delete this._decorations[node.id];\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    //#endregion\r\n    //#region Tokenization\r\n    TextModel.prototype.tokenizeViewport = function (startLineNumber, endLineNumber) {\r\n        if (!this._tokens.tokenizationSupport) {\r\n            return;\r\n        }\r\n        // we tokenize `this._tokens.inValidLineStartIndex` lines in around 20ms so it's a good baseline.\r\n        var contextBefore = Math.floor(this._tokens.inValidLineStartIndex * 0.3);\r\n        startLineNumber = Math.max(1, startLineNumber - contextBefore);\r\n        if (startLineNumber <= this._tokens.inValidLineStartIndex) {\r\n            this.forceTokenization(endLineNumber);\r\n            return;\r\n        }\r\n        var eventBuilder = new ModelTokensChangedEventBuilder();\r\n        var nonWhitespaceColumn = this.getLineFirstNonWhitespaceColumn(startLineNumber);\r\n        var fakeLines = [];\r\n        var i = startLineNumber - 1;\r\n        var initialState = null;\r\n        if (nonWhitespaceColumn > 0) {\r\n            while (nonWhitespaceColumn > 0 && i >= 1) {\r\n                var newNonWhitespaceIndex = this.getLineFirstNonWhitespaceColumn(i);\r\n                if (newNonWhitespaceIndex === 0) {\r\n                    i--;\r\n                    continue;\r\n                }\r\n                if (newNonWhitespaceIndex < nonWhitespaceColumn) {\r\n                    initialState = this._tokens._getState(i - 1);\r\n                    if (initialState) {\r\n                        break;\r\n                    }\r\n                    fakeLines.push(this.getLineContent(i));\r\n                    nonWhitespaceColumn = newNonWhitespaceIndex;\r\n                }\r\n                i--;\r\n            }\r\n        }\r\n        if (!initialState) {\r\n            initialState = this._tokens.tokenizationSupport.getInitialState();\r\n        }\r\n        var state = initialState.clone();\r\n        for (var i_2 = fakeLines.length - 1; i_2 >= 0; i_2--) {\r\n            var r = this._tokens._tokenizeText(this._buffer, fakeLines[i_2], state);\r\n            if (r) {\r\n                state = r.endState.clone();\r\n            }\r\n            else {\r\n                state = initialState.clone();\r\n            }\r\n        }\r\n        var contextAfter = Math.floor(this._tokens.inValidLineStartIndex * 0.4);\r\n        endLineNumber = Math.min(this.getLineCount(), endLineNumber + contextAfter);\r\n        for (var i_3 = startLineNumber; i_3 <= endLineNumber; i_3++) {\r\n            var text = this.getLineContent(i_3);\r\n            var r = this._tokens._tokenizeText(this._buffer, text, state);\r\n            if (r) {\r\n                this._tokens._setTokens(this._tokens.languageIdentifier.id, i_3 - 1, text.length, r.tokens);\r\n                /*\r\n                 * we think it's valid and give it a state but we don't update `_invalidLineStartIndex` then the top-to-bottom tokenization\r\n                 * goes through the viewport, it can skip them if they already have correct tokens and state, and the lines after the viewport\r\n                 * can still be tokenized.\r\n                 */\r\n                this._tokens._setIsInvalid(i_3 - 1, false);\r\n                this._tokens._setState(i_3 - 1, state);\r\n                state = r.endState.clone();\r\n                eventBuilder.registerChangedTokens(i_3);\r\n            }\r\n            else {\r\n                state = initialState.clone();\r\n            }\r\n        }\r\n        var e = eventBuilder.build();\r\n        if (e) {\r\n            this._onDidChangeTokens.fire(e);\r\n        }\r\n    };\r\n    TextModel.prototype.forceTokenization = function (lineNumber) {\r\n        if (lineNumber < 1 || lineNumber > this.getLineCount()) {\r\n            throw new Error('Illegal value for lineNumber');\r\n        }\r\n        var eventBuilder = new ModelTokensChangedEventBuilder();\r\n        this._tokens._updateTokensUntilLine(this._buffer, eventBuilder, lineNumber);\r\n        var e = eventBuilder.build();\r\n        if (e) {\r\n            this._onDidChangeTokens.fire(e);\r\n        }\r\n    };\r\n    TextModel.prototype.isCheapToTokenize = function (lineNumber) {\r\n        if (!this._tokens.isCheapToTokenize(lineNumber)) {\r\n            return false;\r\n        }\r\n        if (lineNumber < this._tokens.inValidLineStartIndex + 1) {\r\n            return true;\r\n        }\r\n        if (this.getLineLength(lineNumber) < CHEAP_TOKENIZATION_LENGTH_LIMIT) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    TextModel.prototype.tokenizeIfCheap = function (lineNumber) {\r\n        if (this.isCheapToTokenize(lineNumber)) {\r\n            this.forceTokenization(lineNumber);\r\n        }\r\n    };\r\n    TextModel.prototype.getLineTokens = function (lineNumber) {\r\n        if (lineNumber < 1 || lineNumber > this.getLineCount()) {\r\n            throw new Error('Illegal value for lineNumber');\r\n        }\r\n        return this._getLineTokens(lineNumber);\r\n    };\r\n    TextModel.prototype._getLineTokens = function (lineNumber) {\r\n        var lineText = this._buffer.getLineContent(lineNumber);\r\n        return this._tokens.getTokens(this._languageIdentifier.id, lineNumber - 1, lineText);\r\n    };\r\n    TextModel.prototype.getLanguageIdentifier = function () {\r\n        return this._languageIdentifier;\r\n    };\r\n    TextModel.prototype.getModeId = function () {\r\n        return this._languageIdentifier.language;\r\n    };\r\n    TextModel.prototype.setMode = function (languageIdentifier) {\r\n        if (this._languageIdentifier.id === languageIdentifier.id) {\r\n            // There's nothing to do\r\n            return;\r\n        }\r\n        var e = {\r\n            oldLanguage: this._languageIdentifier.language,\r\n            newLanguage: languageIdentifier.language\r\n        };\r\n        this._languageIdentifier = languageIdentifier;\r\n        // Cancel tokenization, clear all tokens and begin tokenizing\r\n        this._resetTokenizationState();\r\n        this.emitModelTokensChangedEvent({\r\n            ranges: [{\r\n                    fromLineNumber: 1,\r\n                    toLineNumber: this.getLineCount()\r\n                }]\r\n        });\r\n        this._onDidChangeLanguage.fire(e);\r\n        this._onDidChangeLanguageConfiguration.fire({});\r\n    };\r\n    TextModel.prototype.getLanguageIdAtPosition = function (_lineNumber, _column) {\r\n        if (!this._tokens.tokenizationSupport) {\r\n            return this._languageIdentifier.id;\r\n        }\r\n        var _a = this.validatePosition({ lineNumber: _lineNumber, column: _column }), lineNumber = _a.lineNumber, column = _a.column;\r\n        var lineTokens = this._getLineTokens(lineNumber);\r\n        return lineTokens.getLanguageId(lineTokens.findTokenIndexAtOffset(column - 1));\r\n    };\r\n    TextModel.prototype._beginBackgroundTokenization = function () {\r\n        var _this = this;\r\n        if (this._shouldAutoTokenize() && this._revalidateTokensTimeout === -1) {\r\n            this._revalidateTokensTimeout = setTimeout(function () {\r\n                _this._revalidateTokensTimeout = -1;\r\n                _this._revalidateTokensNow();\r\n            }, 0);\r\n        }\r\n    };\r\n    TextModel.prototype._warmUpTokens = function () {\r\n        // Warm up first 100 lines (if it takes less than 50ms)\r\n        var maxLineNumber = Math.min(100, this.getLineCount());\r\n        this._revalidateTokensNow(maxLineNumber);\r\n        if (this._tokens.hasLinesToTokenize(this._buffer)) {\r\n            this._beginBackgroundTokenization();\r\n        }\r\n    };\r\n    TextModel.prototype._revalidateTokensNow = function (toLineNumber) {\r\n        if (toLineNumber === void 0) { toLineNumber = this._buffer.getLineCount(); }\r\n        var MAX_ALLOWED_TIME = 20;\r\n        var eventBuilder = new ModelTokensChangedEventBuilder();\r\n        var sw = StopWatch.create(false);\r\n        while (this._tokens.hasLinesToTokenize(this._buffer)) {\r\n            if (sw.elapsed() > MAX_ALLOWED_TIME) {\r\n                // Stop if MAX_ALLOWED_TIME is reached\r\n                break;\r\n            }\r\n            var tokenizedLineNumber = this._tokens._tokenizeOneLine(this._buffer, eventBuilder);\r\n            if (tokenizedLineNumber >= toLineNumber) {\r\n                break;\r\n            }\r\n        }\r\n        if (this._tokens.hasLinesToTokenize(this._buffer)) {\r\n            this._beginBackgroundTokenization();\r\n        }\r\n        var e = eventBuilder.build();\r\n        if (e) {\r\n            this._onDidChangeTokens.fire(e);\r\n        }\r\n    };\r\n    TextModel.prototype.emitModelTokensChangedEvent = function (e) {\r\n        if (!this._isDisposing) {\r\n            this._onDidChangeTokens.fire(e);\r\n        }\r\n    };\r\n    // Having tokens allows implementing additional helper methods\r\n    TextModel.prototype.getWordAtPosition = function (_position) {\r\n        this._assertNotDisposed();\r\n        var position = this.validatePosition(_position);\r\n        var lineContent = this.getLineContent(position.lineNumber);\r\n        var lineTokens = this._getLineTokens(position.lineNumber);\r\n        var tokenIndex = lineTokens.findTokenIndexAtOffset(position.column - 1);\r\n        // (1). First try checking right biased word\r\n        var _a = TextModel._findLanguageBoundaries(lineTokens, tokenIndex), rbStartOffset = _a[0], rbEndOffset = _a[1];\r\n        var rightBiasedWord = getWordAtText(position.column, LanguageConfigurationRegistry.getWordDefinition(lineTokens.getLanguageId(tokenIndex)), lineContent.substring(rbStartOffset, rbEndOffset), rbStartOffset);\r\n        // Make sure the result touches the original passed in position\r\n        if (rightBiasedWord && rightBiasedWord.startColumn <= _position.column && _position.column <= rightBiasedWord.endColumn) {\r\n            return rightBiasedWord;\r\n        }\r\n        // (2). Else, if we were at a language boundary, check the left biased word\r\n        if (tokenIndex > 0 && rbStartOffset === position.column - 1) {\r\n            // edge case, where `position` sits between two tokens belonging to two different languages\r\n            var _b = TextModel._findLanguageBoundaries(lineTokens, tokenIndex - 1), lbStartOffset = _b[0], lbEndOffset = _b[1];\r\n            var leftBiasedWord = getWordAtText(position.column, LanguageConfigurationRegistry.getWordDefinition(lineTokens.getLanguageId(tokenIndex - 1)), lineContent.substring(lbStartOffset, lbEndOffset), lbStartOffset);\r\n            // Make sure the result touches the original passed in position\r\n            if (leftBiasedWord && leftBiasedWord.startColumn <= _position.column && _position.column <= leftBiasedWord.endColumn) {\r\n                return leftBiasedWord;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TextModel._findLanguageBoundaries = function (lineTokens, tokenIndex) {\r\n        var languageId = lineTokens.getLanguageId(tokenIndex);\r\n        // go left until a different language is hit\r\n        var startOffset = 0;\r\n        for (var i = tokenIndex; i >= 0 && lineTokens.getLanguageId(i) === languageId; i--) {\r\n            startOffset = lineTokens.getStartOffset(i);\r\n        }\r\n        // go right until a different language is hit\r\n        var endOffset = lineTokens.getLineContent().length;\r\n        for (var i = tokenIndex, tokenCount = lineTokens.getCount(); i < tokenCount && lineTokens.getLanguageId(i) === languageId; i++) {\r\n            endOffset = lineTokens.getEndOffset(i);\r\n        }\r\n        return [startOffset, endOffset];\r\n    };\r\n    TextModel.prototype.getWordUntilPosition = function (position) {\r\n        var wordAtPosition = this.getWordAtPosition(position);\r\n        if (!wordAtPosition) {\r\n            return {\r\n                word: '',\r\n                startColumn: position.column,\r\n                endColumn: position.column\r\n            };\r\n        }\r\n        return {\r\n            word: wordAtPosition.word.substr(0, position.column - wordAtPosition.startColumn),\r\n            startColumn: wordAtPosition.startColumn,\r\n            endColumn: position.column\r\n        };\r\n    };\r\n    TextModel.prototype.findMatchingBracketUp = function (_bracket, _position) {\r\n        var bracket = _bracket.toLowerCase();\r\n        var position = this.validatePosition(_position);\r\n        var lineTokens = this._getLineTokens(position.lineNumber);\r\n        var languageId = lineTokens.getLanguageId(lineTokens.findTokenIndexAtOffset(position.column - 1));\r\n        var bracketsSupport = LanguageConfigurationRegistry.getBracketsSupport(languageId);\r\n        if (!bracketsSupport) {\r\n            return null;\r\n        }\r\n        var data = bracketsSupport.textIsBracket[bracket];\r\n        if (!data) {\r\n            return null;\r\n        }\r\n        return this._findMatchingBracketUp(data, position);\r\n    };\r\n    TextModel.prototype.matchBracket = function (position) {\r\n        return this._matchBracket(this.validatePosition(position));\r\n    };\r\n    TextModel.prototype._matchBracket = function (position) {\r\n        var lineNumber = position.lineNumber;\r\n        var lineTokens = this._getLineTokens(lineNumber);\r\n        var lineText = this._buffer.getLineContent(lineNumber);\r\n        var tokenIndex = lineTokens.findTokenIndexAtOffset(position.column - 1);\r\n        if (tokenIndex < 0) {\r\n            return null;\r\n        }\r\n        var currentModeBrackets = LanguageConfigurationRegistry.getBracketsSupport(lineTokens.getLanguageId(tokenIndex));\r\n        // check that the token is not to be ignored\r\n        if (currentModeBrackets && !ignoreBracketsInToken(lineTokens.getStandardTokenType(tokenIndex))) {\r\n            // limit search to not go before `maxBracketLength`\r\n            var searchStartOffset = Math.max(lineTokens.getStartOffset(tokenIndex), position.column - 1 - currentModeBrackets.maxBracketLength);\r\n            // limit search to not go after `maxBracketLength`\r\n            var searchEndOffset = Math.min(lineTokens.getEndOffset(tokenIndex), position.column - 1 + currentModeBrackets.maxBracketLength);\r\n            // it might be the case that [currentTokenStart -> currentTokenEnd] contains multiple brackets\r\n            // `bestResult` will contain the most right-side result\r\n            var bestResult = null;\r\n            while (true) {\r\n                var foundBracket = BracketsUtils.findNextBracketInToken(currentModeBrackets.forwardRegex, lineNumber, lineText, searchStartOffset, searchEndOffset);\r\n                if (!foundBracket) {\r\n                    // there are no more brackets in this text\r\n                    break;\r\n                }\r\n                // check that we didn't hit a bracket too far away from position\r\n                if (foundBracket.startColumn <= position.column && position.column <= foundBracket.endColumn) {\r\n                    var foundBracketText = lineText.substring(foundBracket.startColumn - 1, foundBracket.endColumn - 1);\r\n                    foundBracketText = foundBracketText.toLowerCase();\r\n                    var r = this._matchFoundBracket(foundBracket, currentModeBrackets.textIsBracket[foundBracketText], currentModeBrackets.textIsOpenBracket[foundBracketText]);\r\n                    // check that we can actually match this bracket\r\n                    if (r) {\r\n                        bestResult = r;\r\n                    }\r\n                }\r\n                searchStartOffset = foundBracket.endColumn - 1;\r\n            }\r\n            if (bestResult) {\r\n                return bestResult;\r\n            }\r\n        }\r\n        // If position is in between two tokens, try also looking in the previous token\r\n        if (tokenIndex > 0 && lineTokens.getStartOffset(tokenIndex) === position.column - 1) {\r\n            var searchEndOffset = lineTokens.getStartOffset(tokenIndex);\r\n            tokenIndex--;\r\n            var prevModeBrackets = LanguageConfigurationRegistry.getBracketsSupport(lineTokens.getLanguageId(tokenIndex));\r\n            // check that previous token is not to be ignored\r\n            if (prevModeBrackets && !ignoreBracketsInToken(lineTokens.getStandardTokenType(tokenIndex))) {\r\n                // limit search in case previous token is very large, there's no need to go beyond `maxBracketLength`\r\n                var searchStartOffset = Math.max(lineTokens.getStartOffset(tokenIndex), position.column - 1 - prevModeBrackets.maxBracketLength);\r\n                var foundBracket = BracketsUtils.findPrevBracketInToken(prevModeBrackets.reversedRegex, lineNumber, lineText, searchStartOffset, searchEndOffset);\r\n                // check that we didn't hit a bracket too far away from position\r\n                if (foundBracket && foundBracket.startColumn <= position.column && position.column <= foundBracket.endColumn) {\r\n                    var foundBracketText = lineText.substring(foundBracket.startColumn - 1, foundBracket.endColumn - 1);\r\n                    foundBracketText = foundBracketText.toLowerCase();\r\n                    var r = this._matchFoundBracket(foundBracket, prevModeBrackets.textIsBracket[foundBracketText], prevModeBrackets.textIsOpenBracket[foundBracketText]);\r\n                    // check that we can actually match this bracket\r\n                    if (r) {\r\n                        return r;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TextModel.prototype._matchFoundBracket = function (foundBracket, data, isOpen) {\r\n        if (!data) {\r\n            return null;\r\n        }\r\n        if (isOpen) {\r\n            var matched = this._findMatchingBracketDown(data, foundBracket.getEndPosition());\r\n            if (matched) {\r\n                return [foundBracket, matched];\r\n            }\r\n        }\r\n        else {\r\n            var matched = this._findMatchingBracketUp(data, foundBracket.getStartPosition());\r\n            if (matched) {\r\n                return [foundBracket, matched];\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TextModel.prototype._findMatchingBracketUp = function (bracket, position) {\r\n        // console.log('_findMatchingBracketUp: ', 'bracket: ', JSON.stringify(bracket), 'startPosition: ', String(position));\r\n        var languageId = bracket.languageIdentifier.id;\r\n        var reversedBracketRegex = bracket.reversedRegex;\r\n        var count = -1;\r\n        for (var lineNumber = position.lineNumber; lineNumber >= 1; lineNumber--) {\r\n            var lineTokens = this._getLineTokens(lineNumber);\r\n            var tokenCount = lineTokens.getCount();\r\n            var lineText = this._buffer.getLineContent(lineNumber);\r\n            var tokenIndex = tokenCount - 1;\r\n            var searchStopOffset = -1;\r\n            if (lineNumber === position.lineNumber) {\r\n                tokenIndex = lineTokens.findTokenIndexAtOffset(position.column - 1);\r\n                searchStopOffset = position.column - 1;\r\n            }\r\n            for (; tokenIndex >= 0; tokenIndex--) {\r\n                var tokenLanguageId = lineTokens.getLanguageId(tokenIndex);\r\n                var tokenType = lineTokens.getStandardTokenType(tokenIndex);\r\n                var tokenStartOffset = lineTokens.getStartOffset(tokenIndex);\r\n                var tokenEndOffset = lineTokens.getEndOffset(tokenIndex);\r\n                if (searchStopOffset === -1) {\r\n                    searchStopOffset = tokenEndOffset;\r\n                }\r\n                if (tokenLanguageId === languageId && !ignoreBracketsInToken(tokenType)) {\r\n                    while (true) {\r\n                        var r = BracketsUtils.findPrevBracketInToken(reversedBracketRegex, lineNumber, lineText, tokenStartOffset, searchStopOffset);\r\n                        if (!r) {\r\n                            break;\r\n                        }\r\n                        var hitText = lineText.substring(r.startColumn - 1, r.endColumn - 1);\r\n                        hitText = hitText.toLowerCase();\r\n                        if (hitText === bracket.open) {\r\n                            count++;\r\n                        }\r\n                        else if (hitText === bracket.close) {\r\n                            count--;\r\n                        }\r\n                        if (count === 0) {\r\n                            return r;\r\n                        }\r\n                        searchStopOffset = r.startColumn - 1;\r\n                    }\r\n                }\r\n                searchStopOffset = -1;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TextModel.prototype._findMatchingBracketDown = function (bracket, position) {\r\n        // console.log('_findMatchingBracketDown: ', 'bracket: ', JSON.stringify(bracket), 'startPosition: ', String(position));\r\n        var languageId = bracket.languageIdentifier.id;\r\n        var bracketRegex = bracket.forwardRegex;\r\n        var count = 1;\r\n        for (var lineNumber = position.lineNumber, lineCount = this.getLineCount(); lineNumber <= lineCount; lineNumber++) {\r\n            var lineTokens = this._getLineTokens(lineNumber);\r\n            var tokenCount = lineTokens.getCount();\r\n            var lineText = this._buffer.getLineContent(lineNumber);\r\n            var tokenIndex = 0;\r\n            var searchStartOffset = 0;\r\n            if (lineNumber === position.lineNumber) {\r\n                tokenIndex = lineTokens.findTokenIndexAtOffset(position.column - 1);\r\n                searchStartOffset = position.column - 1;\r\n            }\r\n            for (; tokenIndex < tokenCount; tokenIndex++) {\r\n                var tokenLanguageId = lineTokens.getLanguageId(tokenIndex);\r\n                var tokenType = lineTokens.getStandardTokenType(tokenIndex);\r\n                var tokenStartOffset = lineTokens.getStartOffset(tokenIndex);\r\n                var tokenEndOffset = lineTokens.getEndOffset(tokenIndex);\r\n                if (searchStartOffset === 0) {\r\n                    searchStartOffset = tokenStartOffset;\r\n                }\r\n                if (tokenLanguageId === languageId && !ignoreBracketsInToken(tokenType)) {\r\n                    while (true) {\r\n                        var r = BracketsUtils.findNextBracketInToken(bracketRegex, lineNumber, lineText, searchStartOffset, tokenEndOffset);\r\n                        if (!r) {\r\n                            break;\r\n                        }\r\n                        var hitText = lineText.substring(r.startColumn - 1, r.endColumn - 1);\r\n                        hitText = hitText.toLowerCase();\r\n                        if (hitText === bracket.open) {\r\n                            count++;\r\n                        }\r\n                        else if (hitText === bracket.close) {\r\n                            count--;\r\n                        }\r\n                        if (count === 0) {\r\n                            return r;\r\n                        }\r\n                        searchStartOffset = r.endColumn - 1;\r\n                    }\r\n                }\r\n                searchStartOffset = 0;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TextModel.prototype.findNextBracket = function (_position) {\r\n        var position = this.validatePosition(_position);\r\n        var languageId = -1;\r\n        var modeBrackets = null;\r\n        for (var lineNumber = position.lineNumber, lineCount = this.getLineCount(); lineNumber <= lineCount; lineNumber++) {\r\n            var lineTokens = this._getLineTokens(lineNumber);\r\n            var tokenCount = lineTokens.getCount();\r\n            var lineText = this._buffer.getLineContent(lineNumber);\r\n            var tokenIndex = 0;\r\n            var searchStartOffset = 0;\r\n            if (lineNumber === position.lineNumber) {\r\n                tokenIndex = lineTokens.findTokenIndexAtOffset(position.column - 1);\r\n                searchStartOffset = position.column - 1;\r\n            }\r\n            for (; tokenIndex < tokenCount; tokenIndex++) {\r\n                var tokenLanguageId = lineTokens.getLanguageId(tokenIndex);\r\n                var tokenType = lineTokens.getStandardTokenType(tokenIndex);\r\n                var tokenStartOffset = lineTokens.getStartOffset(tokenIndex);\r\n                var tokenEndOffset = lineTokens.getEndOffset(tokenIndex);\r\n                if (searchStartOffset === 0) {\r\n                    searchStartOffset = tokenStartOffset;\r\n                }\r\n                if (languageId !== tokenLanguageId) {\r\n                    languageId = tokenLanguageId;\r\n                    modeBrackets = LanguageConfigurationRegistry.getBracketsSupport(languageId);\r\n                }\r\n                if (modeBrackets && !ignoreBracketsInToken(tokenType)) {\r\n                    var r = BracketsUtils.findNextBracketInToken(modeBrackets.forwardRegex, lineNumber, lineText, searchStartOffset, tokenEndOffset);\r\n                    if (r) {\r\n                        return this._toFoundBracket(modeBrackets, r);\r\n                    }\r\n                }\r\n                searchStartOffset = 0;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TextModel.prototype._toFoundBracket = function (modeBrackets, r) {\r\n        if (!r) {\r\n            return null;\r\n        }\r\n        var text = this.getValueInRange(r);\r\n        text = text.toLowerCase();\r\n        var data = modeBrackets.textIsBracket[text];\r\n        if (!data) {\r\n            return null;\r\n        }\r\n        return {\r\n            range: r,\r\n            open: data.open,\r\n            close: data.close,\r\n            isOpen: modeBrackets.textIsOpenBracket[text]\r\n        };\r\n    };\r\n    /**\r\n     * Returns:\r\n     *  - -1 => the line consists of whitespace\r\n     *  - otherwise => the indent level is returned value\r\n     */\r\n    TextModel.computeIndentLevel = function (line, tabSize) {\r\n        var indent = 0;\r\n        var i = 0;\r\n        var len = line.length;\r\n        while (i < len) {\r\n            var chCode = line.charCodeAt(i);\r\n            if (chCode === 32 /* Space */) {\r\n                indent++;\r\n            }\r\n            else if (chCode === 9 /* Tab */) {\r\n                indent = indent - indent % tabSize + tabSize;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n            i++;\r\n        }\r\n        if (i === len) {\r\n            return -1; // line only consists of whitespace\r\n        }\r\n        return indent;\r\n    };\r\n    TextModel.prototype._computeIndentLevel = function (lineIndex) {\r\n        return TextModel.computeIndentLevel(this._buffer.getLineContent(lineIndex + 1), this._options.tabSize);\r\n    };\r\n    TextModel.prototype.getActiveIndentGuide = function (lineNumber, minLineNumber, maxLineNumber) {\r\n        var _this = this;\r\n        this._assertNotDisposed();\r\n        var lineCount = this.getLineCount();\r\n        if (lineNumber < 1 || lineNumber > lineCount) {\r\n            throw new Error('Illegal value for lineNumber');\r\n        }\r\n        var foldingRules = LanguageConfigurationRegistry.getFoldingRules(this._languageIdentifier.id);\r\n        var offSide = Boolean(foldingRules && foldingRules.offSide);\r\n        var up_aboveContentLineIndex = -2; /* -2 is a marker for not having computed it */\r\n        var up_aboveContentLineIndent = -1;\r\n        var up_belowContentLineIndex = -2; /* -2 is a marker for not having computed it */\r\n        var up_belowContentLineIndent = -1;\r\n        var up_resolveIndents = function (lineNumber) {\r\n            if (up_aboveContentLineIndex !== -1 && (up_aboveContentLineIndex === -2 || up_aboveContentLineIndex > lineNumber - 1)) {\r\n                up_aboveContentLineIndex = -1;\r\n                up_aboveContentLineIndent = -1;\r\n                // must find previous line with content\r\n                for (var lineIndex = lineNumber - 2; lineIndex >= 0; lineIndex--) {\r\n                    var indent_1 = _this._computeIndentLevel(lineIndex);\r\n                    if (indent_1 >= 0) {\r\n                        up_aboveContentLineIndex = lineIndex;\r\n                        up_aboveContentLineIndent = indent_1;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (up_belowContentLineIndex === -2) {\r\n                up_belowContentLineIndex = -1;\r\n                up_belowContentLineIndent = -1;\r\n                // must find next line with content\r\n                for (var lineIndex = lineNumber; lineIndex < lineCount; lineIndex++) {\r\n                    var indent_2 = _this._computeIndentLevel(lineIndex);\r\n                    if (indent_2 >= 0) {\r\n                        up_belowContentLineIndex = lineIndex;\r\n                        up_belowContentLineIndent = indent_2;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        var down_aboveContentLineIndex = -2; /* -2 is a marker for not having computed it */\r\n        var down_aboveContentLineIndent = -1;\r\n        var down_belowContentLineIndex = -2; /* -2 is a marker for not having computed it */\r\n        var down_belowContentLineIndent = -1;\r\n        var down_resolveIndents = function (lineNumber) {\r\n            if (down_aboveContentLineIndex === -2) {\r\n                down_aboveContentLineIndex = -1;\r\n                down_aboveContentLineIndent = -1;\r\n                // must find previous line with content\r\n                for (var lineIndex = lineNumber - 2; lineIndex >= 0; lineIndex--) {\r\n                    var indent_3 = _this._computeIndentLevel(lineIndex);\r\n                    if (indent_3 >= 0) {\r\n                        down_aboveContentLineIndex = lineIndex;\r\n                        down_aboveContentLineIndent = indent_3;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (down_belowContentLineIndex !== -1 && (down_belowContentLineIndex === -2 || down_belowContentLineIndex < lineNumber - 1)) {\r\n                down_belowContentLineIndex = -1;\r\n                down_belowContentLineIndent = -1;\r\n                // must find next line with content\r\n                for (var lineIndex = lineNumber; lineIndex < lineCount; lineIndex++) {\r\n                    var indent_4 = _this._computeIndentLevel(lineIndex);\r\n                    if (indent_4 >= 0) {\r\n                        down_belowContentLineIndex = lineIndex;\r\n                        down_belowContentLineIndent = indent_4;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        var startLineNumber = 0;\r\n        var goUp = true;\r\n        var endLineNumber = 0;\r\n        var goDown = true;\r\n        var indent = 0;\r\n        for (var distance = 0; goUp || goDown; distance++) {\r\n            var upLineNumber = lineNumber - distance;\r\n            var downLineNumber = lineNumber + distance;\r\n            if (distance !== 0 && (upLineNumber < 1 || upLineNumber < minLineNumber)) {\r\n                goUp = false;\r\n            }\r\n            if (distance !== 0 && (downLineNumber > lineCount || downLineNumber > maxLineNumber)) {\r\n                goDown = false;\r\n            }\r\n            if (distance > 50000) {\r\n                // stop processing\r\n                goUp = false;\r\n                goDown = false;\r\n            }\r\n            if (goUp) {\r\n                // compute indent level going up\r\n                var upLineIndentLevel = void 0;\r\n                var currentIndent = this._computeIndentLevel(upLineNumber - 1);\r\n                if (currentIndent >= 0) {\r\n                    // This line has content (besides whitespace)\r\n                    // Use the line's indent\r\n                    up_belowContentLineIndex = upLineNumber - 1;\r\n                    up_belowContentLineIndent = currentIndent;\r\n                    upLineIndentLevel = Math.ceil(currentIndent / this._options.tabSize);\r\n                }\r\n                else {\r\n                    up_resolveIndents(upLineNumber);\r\n                    upLineIndentLevel = this._getIndentLevelForWhitespaceLine(offSide, up_aboveContentLineIndent, up_belowContentLineIndent);\r\n                }\r\n                if (distance === 0) {\r\n                    // This is the initial line number\r\n                    startLineNumber = upLineNumber;\r\n                    endLineNumber = downLineNumber;\r\n                    indent = upLineIndentLevel;\r\n                    if (indent === 0) {\r\n                        // No need to continue\r\n                        return { startLineNumber: startLineNumber, endLineNumber: endLineNumber, indent: indent };\r\n                    }\r\n                    continue;\r\n                }\r\n                if (upLineIndentLevel >= indent) {\r\n                    startLineNumber = upLineNumber;\r\n                }\r\n                else {\r\n                    goUp = false;\r\n                }\r\n            }\r\n            if (goDown) {\r\n                // compute indent level going down\r\n                var downLineIndentLevel = void 0;\r\n                var currentIndent = this._computeIndentLevel(downLineNumber - 1);\r\n                if (currentIndent >= 0) {\r\n                    // This line has content (besides whitespace)\r\n                    // Use the line's indent\r\n                    down_aboveContentLineIndex = downLineNumber - 1;\r\n                    down_aboveContentLineIndent = currentIndent;\r\n                    downLineIndentLevel = Math.ceil(currentIndent / this._options.tabSize);\r\n                }\r\n                else {\r\n                    down_resolveIndents(downLineNumber);\r\n                    downLineIndentLevel = this._getIndentLevelForWhitespaceLine(offSide, down_aboveContentLineIndent, down_belowContentLineIndent);\r\n                }\r\n                if (downLineIndentLevel >= indent) {\r\n                    endLineNumber = downLineNumber;\r\n                }\r\n                else {\r\n                    goDown = false;\r\n                }\r\n            }\r\n        }\r\n        return { startLineNumber: startLineNumber, endLineNumber: endLineNumber, indent: indent };\r\n    };\r\n    TextModel.prototype.getLinesIndentGuides = function (startLineNumber, endLineNumber) {\r\n        this._assertNotDisposed();\r\n        var lineCount = this.getLineCount();\r\n        if (startLineNumber < 1 || startLineNumber > lineCount) {\r\n            throw new Error('Illegal value for startLineNumber');\r\n        }\r\n        if (endLineNumber < 1 || endLineNumber > lineCount) {\r\n            throw new Error('Illegal value for endLineNumber');\r\n        }\r\n        var foldingRules = LanguageConfigurationRegistry.getFoldingRules(this._languageIdentifier.id);\r\n        var offSide = Boolean(foldingRules && foldingRules.offSide);\r\n        var result = new Array(endLineNumber - startLineNumber + 1);\r\n        var aboveContentLineIndex = -2; /* -2 is a marker for not having computed it */\r\n        var aboveContentLineIndent = -1;\r\n        var belowContentLineIndex = -2; /* -2 is a marker for not having computed it */\r\n        var belowContentLineIndent = -1;\r\n        for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n            var resultIndex = lineNumber - startLineNumber;\r\n            var currentIndent = this._computeIndentLevel(lineNumber - 1);\r\n            if (currentIndent >= 0) {\r\n                // This line has content (besides whitespace)\r\n                // Use the line's indent\r\n                aboveContentLineIndex = lineNumber - 1;\r\n                aboveContentLineIndent = currentIndent;\r\n                result[resultIndex] = Math.ceil(currentIndent / this._options.tabSize);\r\n                continue;\r\n            }\r\n            if (aboveContentLineIndex === -2) {\r\n                aboveContentLineIndex = -1;\r\n                aboveContentLineIndent = -1;\r\n                // must find previous line with content\r\n                for (var lineIndex = lineNumber - 2; lineIndex >= 0; lineIndex--) {\r\n                    var indent = this._computeIndentLevel(lineIndex);\r\n                    if (indent >= 0) {\r\n                        aboveContentLineIndex = lineIndex;\r\n                        aboveContentLineIndent = indent;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (belowContentLineIndex !== -1 && (belowContentLineIndex === -2 || belowContentLineIndex < lineNumber - 1)) {\r\n                belowContentLineIndex = -1;\r\n                belowContentLineIndent = -1;\r\n                // must find next line with content\r\n                for (var lineIndex = lineNumber; lineIndex < lineCount; lineIndex++) {\r\n                    var indent = this._computeIndentLevel(lineIndex);\r\n                    if (indent >= 0) {\r\n                        belowContentLineIndex = lineIndex;\r\n                        belowContentLineIndent = indent;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            result[resultIndex] = this._getIndentLevelForWhitespaceLine(offSide, aboveContentLineIndent, belowContentLineIndent);\r\n        }\r\n        return result;\r\n    };\r\n    TextModel.prototype._getIndentLevelForWhitespaceLine = function (offSide, aboveContentLineIndent, belowContentLineIndent) {\r\n        if (aboveContentLineIndent === -1 || belowContentLineIndent === -1) {\r\n            // At the top or bottom of the file\r\n            return 0;\r\n        }\r\n        else if (aboveContentLineIndent < belowContentLineIndent) {\r\n            // we are inside the region above\r\n            return (1 + Math.floor(aboveContentLineIndent / this._options.tabSize));\r\n        }\r\n        else if (aboveContentLineIndent === belowContentLineIndent) {\r\n            // we are in between two regions\r\n            return Math.ceil(belowContentLineIndent / this._options.tabSize);\r\n        }\r\n        else {\r\n            if (offSide) {\r\n                // same level as region below\r\n                return Math.ceil(belowContentLineIndent / this._options.tabSize);\r\n            }\r\n            else {\r\n                // we are inside the region that ends below\r\n                return (1 + Math.floor(belowContentLineIndent / this._options.tabSize));\r\n            }\r\n        }\r\n    };\r\n    TextModel.MODEL_SYNC_LIMIT = 50 * 1024 * 1024; // 50 MB\r\n    TextModel.LARGE_FILE_SIZE_THRESHOLD = 20 * 1024 * 1024; // 20 MB;\r\n    TextModel.LARGE_FILE_LINE_COUNT_THRESHOLD = 300 * 1000; // 300K lines\r\n    TextModel.DEFAULT_CREATION_OPTIONS = {\r\n        isForSimpleWidget: false,\r\n        tabSize: EDITOR_MODEL_DEFAULTS.tabSize,\r\n        insertSpaces: EDITOR_MODEL_DEFAULTS.insertSpaces,\r\n        detectIndentation: false,\r\n        defaultEOL: 1 /* LF */,\r\n        trimAutoWhitespace: EDITOR_MODEL_DEFAULTS.trimAutoWhitespace,\r\n        largeFileOptimizations: EDITOR_MODEL_DEFAULTS.largeFileOptimizations,\r\n    };\r\n    return TextModel;\r\n}(Disposable));\r\nexport { TextModel };\r\n//#region Decorations\r\nvar DecorationsTrees = /** @class */ (function () {\r\n    function DecorationsTrees() {\r\n        this._decorationsTree0 = new IntervalTree();\r\n        this._decorationsTree1 = new IntervalTree();\r\n    }\r\n    DecorationsTrees.prototype.intervalSearch = function (start, end, filterOwnerId, filterOutValidation, cachedVersionId) {\r\n        var r0 = this._decorationsTree0.intervalSearch(start, end, filterOwnerId, filterOutValidation, cachedVersionId);\r\n        var r1 = this._decorationsTree1.intervalSearch(start, end, filterOwnerId, filterOutValidation, cachedVersionId);\r\n        return r0.concat(r1);\r\n    };\r\n    DecorationsTrees.prototype.search = function (filterOwnerId, filterOutValidation, overviewRulerOnly, cachedVersionId) {\r\n        if (overviewRulerOnly) {\r\n            return this._decorationsTree1.search(filterOwnerId, filterOutValidation, cachedVersionId);\r\n        }\r\n        else {\r\n            var r0 = this._decorationsTree0.search(filterOwnerId, filterOutValidation, cachedVersionId);\r\n            var r1 = this._decorationsTree1.search(filterOwnerId, filterOutValidation, cachedVersionId);\r\n            return r0.concat(r1);\r\n        }\r\n    };\r\n    DecorationsTrees.prototype.collectNodesFromOwner = function (ownerId) {\r\n        var r0 = this._decorationsTree0.collectNodesFromOwner(ownerId);\r\n        var r1 = this._decorationsTree1.collectNodesFromOwner(ownerId);\r\n        return r0.concat(r1);\r\n    };\r\n    DecorationsTrees.prototype.collectNodesPostOrder = function () {\r\n        var r0 = this._decorationsTree0.collectNodesPostOrder();\r\n        var r1 = this._decorationsTree1.collectNodesPostOrder();\r\n        return r0.concat(r1);\r\n    };\r\n    DecorationsTrees.prototype.insert = function (node) {\r\n        if (getNodeIsInOverviewRuler(node)) {\r\n            this._decorationsTree1.insert(node);\r\n        }\r\n        else {\r\n            this._decorationsTree0.insert(node);\r\n        }\r\n    };\r\n    DecorationsTrees.prototype.delete = function (node) {\r\n        if (getNodeIsInOverviewRuler(node)) {\r\n            this._decorationsTree1.delete(node);\r\n        }\r\n        else {\r\n            this._decorationsTree0.delete(node);\r\n        }\r\n    };\r\n    DecorationsTrees.prototype.resolveNode = function (node, cachedVersionId) {\r\n        if (getNodeIsInOverviewRuler(node)) {\r\n            this._decorationsTree1.resolveNode(node, cachedVersionId);\r\n        }\r\n        else {\r\n            this._decorationsTree0.resolveNode(node, cachedVersionId);\r\n        }\r\n    };\r\n    DecorationsTrees.prototype.acceptReplace = function (offset, length, textLength, forceMoveMarkers) {\r\n        this._decorationsTree0.acceptReplace(offset, length, textLength, forceMoveMarkers);\r\n        this._decorationsTree1.acceptReplace(offset, length, textLength, forceMoveMarkers);\r\n    };\r\n    return DecorationsTrees;\r\n}());\r\nfunction cleanClassName(className) {\r\n    return className.replace(/[^a-z0-9\\-_]/gi, ' ');\r\n}\r\nvar ModelDecorationOverviewRulerOptions = /** @class */ (function () {\r\n    function ModelDecorationOverviewRulerOptions(options) {\r\n        this.color = options.color || strings.empty;\r\n        this.darkColor = options.darkColor || strings.empty;\r\n        this.position = (typeof options.position === 'number' ? options.position : model.OverviewRulerLane.Center);\r\n        this._resolvedColor = null;\r\n    }\r\n    ModelDecorationOverviewRulerOptions.prototype.getColor = function (theme) {\r\n        if (!this._resolvedColor) {\r\n            if (theme.type !== 'light' && this.darkColor) {\r\n                this._resolvedColor = this._resolveColor(this.darkColor, theme);\r\n            }\r\n            else {\r\n                this._resolvedColor = this._resolveColor(this.color, theme);\r\n            }\r\n        }\r\n        return this._resolvedColor;\r\n    };\r\n    ModelDecorationOverviewRulerOptions.prototype.invalidateCachedColor = function () {\r\n        this._resolvedColor = null;\r\n    };\r\n    ModelDecorationOverviewRulerOptions.prototype._resolveColor = function (color, theme) {\r\n        if (typeof color === 'string') {\r\n            return color;\r\n        }\r\n        var c = color ? theme.getColor(color.id) : null;\r\n        if (!c) {\r\n            return strings.empty;\r\n        }\r\n        return c.toString();\r\n    };\r\n    return ModelDecorationOverviewRulerOptions;\r\n}());\r\nexport { ModelDecorationOverviewRulerOptions };\r\nvar ModelDecorationOptions = /** @class */ (function () {\r\n    function ModelDecorationOptions(options) {\r\n        this.stickiness = options.stickiness || 0 /* AlwaysGrowsWhenTypingAtEdges */;\r\n        this.zIndex = options.zIndex || 0;\r\n        this.className = options.className ? cleanClassName(options.className) : null;\r\n        this.hoverMessage = options.hoverMessage || null;\r\n        this.glyphMarginHoverMessage = options.glyphMarginHoverMessage || null;\r\n        this.isWholeLine = options.isWholeLine || false;\r\n        this.showIfCollapsed = options.showIfCollapsed || false;\r\n        this.collapseOnReplaceEdit = options.collapseOnReplaceEdit || false;\r\n        this.overviewRuler = options.overviewRuler ? new ModelDecorationOverviewRulerOptions(options.overviewRuler) : null;\r\n        this.glyphMarginClassName = options.glyphMarginClassName ? cleanClassName(options.glyphMarginClassName) : null;\r\n        this.linesDecorationsClassName = options.linesDecorationsClassName ? cleanClassName(options.linesDecorationsClassName) : null;\r\n        this.marginClassName = options.marginClassName ? cleanClassName(options.marginClassName) : null;\r\n        this.inlineClassName = options.inlineClassName ? cleanClassName(options.inlineClassName) : null;\r\n        this.inlineClassNameAffectsLetterSpacing = options.inlineClassNameAffectsLetterSpacing || false;\r\n        this.beforeContentClassName = options.beforeContentClassName ? cleanClassName(options.beforeContentClassName) : null;\r\n        this.afterContentClassName = options.afterContentClassName ? cleanClassName(options.afterContentClassName) : null;\r\n    }\r\n    ModelDecorationOptions.register = function (options) {\r\n        return new ModelDecorationOptions(options);\r\n    };\r\n    ModelDecorationOptions.createDynamic = function (options) {\r\n        return new ModelDecorationOptions(options);\r\n    };\r\n    return ModelDecorationOptions;\r\n}());\r\nexport { ModelDecorationOptions };\r\nModelDecorationOptions.EMPTY = ModelDecorationOptions.register({});\r\n/**\r\n * The order carefully matches the values of the enum.\r\n */\r\nvar TRACKED_RANGE_OPTIONS = [\r\n    ModelDecorationOptions.register({ stickiness: 0 /* AlwaysGrowsWhenTypingAtEdges */ }),\r\n    ModelDecorationOptions.register({ stickiness: 1 /* NeverGrowsWhenTypingAtEdges */ }),\r\n    ModelDecorationOptions.register({ stickiness: 2 /* GrowsOnlyWhenTypingBefore */ }),\r\n    ModelDecorationOptions.register({ stickiness: 3 /* GrowsOnlyWhenTypingAfter */ }),\r\n];\r\nfunction _normalizeOptions(options) {\r\n    if (options instanceof ModelDecorationOptions) {\r\n        return options;\r\n    }\r\n    return ModelDecorationOptions.createDynamic(options);\r\n}\r\nvar DidChangeDecorationsEmitter = /** @class */ (function (_super) {\r\n    __extends(DidChangeDecorationsEmitter, _super);\r\n    function DidChangeDecorationsEmitter() {\r\n        var _this = _super.call(this) || this;\r\n        _this._actual = _this._register(new Emitter());\r\n        _this.event = _this._actual.event;\r\n        _this._deferredCnt = 0;\r\n        _this._shouldFire = false;\r\n        return _this;\r\n    }\r\n    DidChangeDecorationsEmitter.prototype.beginDeferredEmit = function () {\r\n        this._deferredCnt++;\r\n    };\r\n    DidChangeDecorationsEmitter.prototype.endDeferredEmit = function () {\r\n        this._deferredCnt--;\r\n        if (this._deferredCnt === 0) {\r\n            if (this._shouldFire) {\r\n                this._shouldFire = false;\r\n                this._actual.fire({});\r\n            }\r\n        }\r\n    };\r\n    DidChangeDecorationsEmitter.prototype.fire = function () {\r\n        this._shouldFire = true;\r\n    };\r\n    return DidChangeDecorationsEmitter;\r\n}(Disposable));\r\nexport { DidChangeDecorationsEmitter };\r\n//#endregion\r\nvar DidChangeContentEmitter = /** @class */ (function (_super) {\r\n    __extends(DidChangeContentEmitter, _super);\r\n    function DidChangeContentEmitter() {\r\n        var _this = _super.call(this) || this;\r\n        /**\r\n         * Both `fastEvent` and `slowEvent` work the same way and contain the same events, but first we invoke `fastEvent` and then `slowEvent`.\r\n         */\r\n        _this._fastEmitter = _this._register(new Emitter());\r\n        _this.fastEvent = _this._fastEmitter.event;\r\n        _this._slowEmitter = _this._register(new Emitter());\r\n        _this.slowEvent = _this._slowEmitter.event;\r\n        _this._deferredCnt = 0;\r\n        _this._deferredEvent = null;\r\n        return _this;\r\n    }\r\n    DidChangeContentEmitter.prototype.beginDeferredEmit = function () {\r\n        this._deferredCnt++;\r\n    };\r\n    DidChangeContentEmitter.prototype.endDeferredEmit = function () {\r\n        this._deferredCnt--;\r\n        if (this._deferredCnt === 0) {\r\n            if (this._deferredEvent !== null) {\r\n                var e = this._deferredEvent;\r\n                this._deferredEvent = null;\r\n                this._fastEmitter.fire(e);\r\n                this._slowEmitter.fire(e);\r\n            }\r\n        }\r\n    };\r\n    DidChangeContentEmitter.prototype.fire = function (e) {\r\n        if (this._deferredCnt > 0) {\r\n            if (this._deferredEvent) {\r\n                this._deferredEvent = this._deferredEvent.merge(e);\r\n            }\r\n            else {\r\n                this._deferredEvent = e;\r\n            }\r\n            return;\r\n        }\r\n        this._fastEmitter.fire(e);\r\n        this._slowEmitter.fire(e);\r\n    };\r\n    return DidChangeContentEmitter;\r\n}(Disposable));\r\nexport { DidChangeContentEmitter };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nimport { Selection } from '../core/selection.js';\r\nimport { TextModel } from '../model/textModel.js';\r\nimport { LanguageConfigurationRegistry } from '../modes/languageConfigurationRegistry.js';\r\nvar autoCloseAlways = function (_) { return true; };\r\nvar autoCloseNever = function (_) { return false; };\r\nvar autoCloseBeforeWhitespace = function (chr) { return (chr === ' ' || chr === '\\t'); };\r\nvar CursorConfiguration = /** @class */ (function () {\r\n    function CursorConfiguration(languageIdentifier, oneIndent, modelOptions, configuration) {\r\n        this._languageIdentifier = languageIdentifier;\r\n        var c = configuration.editor;\r\n        this.readOnly = c.readOnly;\r\n        this.tabSize = modelOptions.tabSize;\r\n        this.insertSpaces = modelOptions.insertSpaces;\r\n        this.oneIndent = oneIndent;\r\n        this.pageSize = Math.max(1, Math.floor(c.layoutInfo.height / c.fontInfo.lineHeight) - 2);\r\n        this.lineHeight = c.lineHeight;\r\n        this.useTabStops = c.useTabStops;\r\n        this.wordSeparators = c.wordSeparators;\r\n        this.emptySelectionClipboard = c.emptySelectionClipboard;\r\n        this.copyWithSyntaxHighlighting = c.copyWithSyntaxHighlighting;\r\n        this.multiCursorMergeOverlapping = c.multiCursorMergeOverlapping;\r\n        this.autoClosingBrackets = c.autoClosingBrackets;\r\n        this.autoClosingQuotes = c.autoClosingQuotes;\r\n        this.autoSurround = c.autoSurround;\r\n        this.autoIndent = c.autoIndent;\r\n        this.autoClosingPairsOpen = {};\r\n        this.autoClosingPairsClose = {};\r\n        this.surroundingPairs = {};\r\n        this._electricChars = null;\r\n        this.shouldAutoCloseBefore = {\r\n            quote: CursorConfiguration._getShouldAutoClose(languageIdentifier, this.autoClosingQuotes),\r\n            bracket: CursorConfiguration._getShouldAutoClose(languageIdentifier, this.autoClosingBrackets)\r\n        };\r\n        var autoClosingPairs = CursorConfiguration._getAutoClosingPairs(languageIdentifier);\r\n        if (autoClosingPairs) {\r\n            for (var i = 0; i < autoClosingPairs.length; i++) {\r\n                this.autoClosingPairsOpen[autoClosingPairs[i].open] = autoClosingPairs[i].close;\r\n                this.autoClosingPairsClose[autoClosingPairs[i].close] = autoClosingPairs[i].open;\r\n            }\r\n        }\r\n        var surroundingPairs = CursorConfiguration._getSurroundingPairs(languageIdentifier);\r\n        if (surroundingPairs) {\r\n            for (var i = 0; i < surroundingPairs.length; i++) {\r\n                this.surroundingPairs[surroundingPairs[i].open] = surroundingPairs[i].close;\r\n            }\r\n        }\r\n    }\r\n    CursorConfiguration.shouldRecreate = function (e) {\r\n        return (e.layoutInfo\r\n            || e.wordSeparators\r\n            || e.emptySelectionClipboard\r\n            || e.multiCursorMergeOverlapping\r\n            || e.autoClosingBrackets\r\n            || e.autoClosingQuotes\r\n            || e.autoSurround\r\n            || e.useTabStops\r\n            || e.lineHeight\r\n            || e.readOnly);\r\n    };\r\n    Object.defineProperty(CursorConfiguration.prototype, \"electricChars\", {\r\n        get: function () {\r\n            if (!this._electricChars) {\r\n                this._electricChars = {};\r\n                var electricChars = CursorConfiguration._getElectricCharacters(this._languageIdentifier);\r\n                if (electricChars) {\r\n                    for (var i = 0; i < electricChars.length; i++) {\r\n                        this._electricChars[electricChars[i]] = true;\r\n                    }\r\n                }\r\n            }\r\n            return this._electricChars;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CursorConfiguration.prototype.normalizeIndentation = function (str) {\r\n        return TextModel.normalizeIndentation(str, this.tabSize, this.insertSpaces);\r\n    };\r\n    CursorConfiguration._getElectricCharacters = function (languageIdentifier) {\r\n        try {\r\n            return LanguageConfigurationRegistry.getElectricCharacters(languageIdentifier.id);\r\n        }\r\n        catch (e) {\r\n            onUnexpectedError(e);\r\n            return null;\r\n        }\r\n    };\r\n    CursorConfiguration._getAutoClosingPairs = function (languageIdentifier) {\r\n        try {\r\n            return LanguageConfigurationRegistry.getAutoClosingPairs(languageIdentifier.id);\r\n        }\r\n        catch (e) {\r\n            onUnexpectedError(e);\r\n            return null;\r\n        }\r\n    };\r\n    CursorConfiguration._getShouldAutoClose = function (languageIdentifier, autoCloseConfig) {\r\n        switch (autoCloseConfig) {\r\n            case 'beforeWhitespace':\r\n                return autoCloseBeforeWhitespace;\r\n            case 'languageDefined':\r\n                return CursorConfiguration._getLanguageDefinedShouldAutoClose(languageIdentifier);\r\n            case 'always':\r\n                return autoCloseAlways;\r\n            case 'never':\r\n                return autoCloseNever;\r\n        }\r\n    };\r\n    CursorConfiguration._getLanguageDefinedShouldAutoClose = function (languageIdentifier) {\r\n        try {\r\n            var autoCloseBeforeSet_1 = LanguageConfigurationRegistry.getAutoCloseBeforeSet(languageIdentifier.id);\r\n            return function (c) { return autoCloseBeforeSet_1.indexOf(c) !== -1; };\r\n        }\r\n        catch (e) {\r\n            onUnexpectedError(e);\r\n            return autoCloseNever;\r\n        }\r\n    };\r\n    CursorConfiguration._getSurroundingPairs = function (languageIdentifier) {\r\n        try {\r\n            return LanguageConfigurationRegistry.getSurroundingPairs(languageIdentifier.id);\r\n        }\r\n        catch (e) {\r\n            onUnexpectedError(e);\r\n            return null;\r\n        }\r\n    };\r\n    return CursorConfiguration;\r\n}());\r\nexport { CursorConfiguration };\r\n/**\r\n * Represents the cursor state on either the model or on the view model.\r\n */\r\nvar SingleCursorState = /** @class */ (function () {\r\n    function SingleCursorState(selectionStart, selectionStartLeftoverVisibleColumns, position, leftoverVisibleColumns) {\r\n        this.selectionStart = selectionStart;\r\n        this.selectionStartLeftoverVisibleColumns = selectionStartLeftoverVisibleColumns;\r\n        this.position = position;\r\n        this.leftoverVisibleColumns = leftoverVisibleColumns;\r\n        this.selection = SingleCursorState._computeSelection(this.selectionStart, this.position);\r\n    }\r\n    SingleCursorState.prototype.equals = function (other) {\r\n        return (this.selectionStartLeftoverVisibleColumns === other.selectionStartLeftoverVisibleColumns\r\n            && this.leftoverVisibleColumns === other.leftoverVisibleColumns\r\n            && this.position.equals(other.position)\r\n            && this.selectionStart.equalsRange(other.selectionStart));\r\n    };\r\n    SingleCursorState.prototype.hasSelection = function () {\r\n        return (!this.selection.isEmpty() || !this.selectionStart.isEmpty());\r\n    };\r\n    SingleCursorState.prototype.move = function (inSelectionMode, lineNumber, column, leftoverVisibleColumns) {\r\n        if (inSelectionMode) {\r\n            // move just position\r\n            return new SingleCursorState(this.selectionStart, this.selectionStartLeftoverVisibleColumns, new Position(lineNumber, column), leftoverVisibleColumns);\r\n        }\r\n        else {\r\n            // move everything\r\n            return new SingleCursorState(new Range(lineNumber, column, lineNumber, column), leftoverVisibleColumns, new Position(lineNumber, column), leftoverVisibleColumns);\r\n        }\r\n    };\r\n    SingleCursorState._computeSelection = function (selectionStart, position) {\r\n        var startLineNumber, startColumn, endLineNumber, endColumn;\r\n        if (selectionStart.isEmpty()) {\r\n            startLineNumber = selectionStart.startLineNumber;\r\n            startColumn = selectionStart.startColumn;\r\n            endLineNumber = position.lineNumber;\r\n            endColumn = position.column;\r\n        }\r\n        else {\r\n            if (position.isBeforeOrEqual(selectionStart.getStartPosition())) {\r\n                startLineNumber = selectionStart.endLineNumber;\r\n                startColumn = selectionStart.endColumn;\r\n                endLineNumber = position.lineNumber;\r\n                endColumn = position.column;\r\n            }\r\n            else {\r\n                startLineNumber = selectionStart.startLineNumber;\r\n                startColumn = selectionStart.startColumn;\r\n                endLineNumber = position.lineNumber;\r\n                endColumn = position.column;\r\n            }\r\n        }\r\n        return new Selection(startLineNumber, startColumn, endLineNumber, endColumn);\r\n    };\r\n    return SingleCursorState;\r\n}());\r\nexport { SingleCursorState };\r\nvar CursorContext = /** @class */ (function () {\r\n    function CursorContext(configuration, model, viewModel) {\r\n        this.model = model;\r\n        this.viewModel = viewModel;\r\n        this.config = new CursorConfiguration(this.model.getLanguageIdentifier(), this.model.getOneIndent(), this.model.getOptions(), configuration);\r\n    }\r\n    CursorContext.prototype.validateViewPosition = function (viewPosition, modelPosition) {\r\n        return this.viewModel.coordinatesConverter.validateViewPosition(viewPosition, modelPosition);\r\n    };\r\n    CursorContext.prototype.validateViewRange = function (viewRange, expectedModelRange) {\r\n        return this.viewModel.coordinatesConverter.validateViewRange(viewRange, expectedModelRange);\r\n    };\r\n    CursorContext.prototype.convertViewRangeToModelRange = function (viewRange) {\r\n        return this.viewModel.coordinatesConverter.convertViewRangeToModelRange(viewRange);\r\n    };\r\n    CursorContext.prototype.convertViewPositionToModelPosition = function (lineNumber, column) {\r\n        return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position(lineNumber, column));\r\n    };\r\n    CursorContext.prototype.convertModelPositionToViewPosition = function (modelPosition) {\r\n        return this.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\r\n    };\r\n    CursorContext.prototype.convertModelRangeToViewRange = function (modelRange) {\r\n        return this.viewModel.coordinatesConverter.convertModelRangeToViewRange(modelRange);\r\n    };\r\n    CursorContext.prototype.getCurrentScrollTop = function () {\r\n        return this.viewModel.viewLayout.getCurrentScrollTop();\r\n    };\r\n    CursorContext.prototype.getCompletelyVisibleViewRange = function () {\r\n        return this.viewModel.getCompletelyVisibleViewRange();\r\n    };\r\n    CursorContext.prototype.getCompletelyVisibleModelRange = function () {\r\n        var viewRange = this.viewModel.getCompletelyVisibleViewRange();\r\n        return this.viewModel.coordinatesConverter.convertViewRangeToModelRange(viewRange);\r\n    };\r\n    CursorContext.prototype.getCompletelyVisibleViewRangeAtScrollTop = function (scrollTop) {\r\n        return this.viewModel.getCompletelyVisibleViewRangeAtScrollTop(scrollTop);\r\n    };\r\n    CursorContext.prototype.getVerticalOffsetForViewLine = function (viewLineNumber) {\r\n        return this.viewModel.viewLayout.getVerticalOffsetForLineNumber(viewLineNumber);\r\n    };\r\n    return CursorContext;\r\n}());\r\nexport { CursorContext };\r\nvar PartialModelCursorState = /** @class */ (function () {\r\n    function PartialModelCursorState(modelState) {\r\n        this.modelState = modelState;\r\n        this.viewState = null;\r\n    }\r\n    return PartialModelCursorState;\r\n}());\r\nexport { PartialModelCursorState };\r\nvar PartialViewCursorState = /** @class */ (function () {\r\n    function PartialViewCursorState(viewState) {\r\n        this.modelState = null;\r\n        this.viewState = viewState;\r\n    }\r\n    return PartialViewCursorState;\r\n}());\r\nexport { PartialViewCursorState };\r\nvar CursorState = /** @class */ (function () {\r\n    function CursorState(modelState, viewState) {\r\n        this.modelState = modelState;\r\n        this.viewState = viewState;\r\n    }\r\n    CursorState.fromModelState = function (modelState) {\r\n        return new PartialModelCursorState(modelState);\r\n    };\r\n    CursorState.fromViewState = function (viewState) {\r\n        return new PartialViewCursorState(viewState);\r\n    };\r\n    CursorState.fromModelSelection = function (modelSelection) {\r\n        var selectionStartLineNumber = modelSelection.selectionStartLineNumber;\r\n        var selectionStartColumn = modelSelection.selectionStartColumn;\r\n        var positionLineNumber = modelSelection.positionLineNumber;\r\n        var positionColumn = modelSelection.positionColumn;\r\n        var modelState = new SingleCursorState(new Range(selectionStartLineNumber, selectionStartColumn, selectionStartLineNumber, selectionStartColumn), 0, new Position(positionLineNumber, positionColumn), 0);\r\n        return CursorState.fromModelState(modelState);\r\n    };\r\n    CursorState.fromModelSelections = function (modelSelections) {\r\n        var states = [];\r\n        for (var i = 0, len = modelSelections.length; i < len; i++) {\r\n            states[i] = this.fromModelSelection(modelSelections[i]);\r\n        }\r\n        return states;\r\n    };\r\n    CursorState.prototype.equals = function (other) {\r\n        return (this.viewState.equals(other.viewState) && this.modelState.equals(other.modelState));\r\n    };\r\n    return CursorState;\r\n}());\r\nexport { CursorState };\r\nvar EditOperationResult = /** @class */ (function () {\r\n    function EditOperationResult(type, commands, opts) {\r\n        this.type = type;\r\n        this.commands = commands;\r\n        this.shouldPushStackElementBefore = opts.shouldPushStackElementBefore;\r\n        this.shouldPushStackElementAfter = opts.shouldPushStackElementAfter;\r\n    }\r\n    return EditOperationResult;\r\n}());\r\nexport { EditOperationResult };\r\n/**\r\n * Common operations that work and make sense both on the model and on the view model.\r\n */\r\nvar CursorColumns = /** @class */ (function () {\r\n    function CursorColumns() {\r\n    }\r\n    CursorColumns.isLowSurrogate = function (model, lineNumber, charOffset) {\r\n        var lineContent = model.getLineContent(lineNumber);\r\n        if (charOffset < 0 || charOffset >= lineContent.length) {\r\n            return false;\r\n        }\r\n        return strings.isLowSurrogate(lineContent.charCodeAt(charOffset));\r\n    };\r\n    CursorColumns.isHighSurrogate = function (model, lineNumber, charOffset) {\r\n        var lineContent = model.getLineContent(lineNumber);\r\n        if (charOffset < 0 || charOffset >= lineContent.length) {\r\n            return false;\r\n        }\r\n        return strings.isHighSurrogate(lineContent.charCodeAt(charOffset));\r\n    };\r\n    CursorColumns.isInsideSurrogatePair = function (model, lineNumber, column) {\r\n        return this.isHighSurrogate(model, lineNumber, column - 2);\r\n    };\r\n    CursorColumns.visibleColumnFromColumn = function (lineContent, column, tabSize) {\r\n        var endOffset = lineContent.length;\r\n        if (endOffset > column - 1) {\r\n            endOffset = column - 1;\r\n        }\r\n        var result = 0;\r\n        for (var i = 0; i < endOffset; i++) {\r\n            var charCode = lineContent.charCodeAt(i);\r\n            if (charCode === 9 /* Tab */) {\r\n                result = this.nextTabStop(result, tabSize);\r\n            }\r\n            else if (strings.isFullWidthCharacter(charCode)) {\r\n                result = result + 2;\r\n            }\r\n            else {\r\n                result = result + 1;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    CursorColumns.visibleColumnFromColumn2 = function (config, model, position) {\r\n        return this.visibleColumnFromColumn(model.getLineContent(position.lineNumber), position.column, config.tabSize);\r\n    };\r\n    CursorColumns.columnFromVisibleColumn = function (lineContent, visibleColumn, tabSize) {\r\n        if (visibleColumn <= 0) {\r\n            return 1;\r\n        }\r\n        var lineLength = lineContent.length;\r\n        var beforeVisibleColumn = 0;\r\n        for (var i = 0; i < lineLength; i++) {\r\n            var charCode = lineContent.charCodeAt(i);\r\n            var afterVisibleColumn = void 0;\r\n            if (charCode === 9 /* Tab */) {\r\n                afterVisibleColumn = this.nextTabStop(beforeVisibleColumn, tabSize);\r\n            }\r\n            else if (strings.isFullWidthCharacter(charCode)) {\r\n                afterVisibleColumn = beforeVisibleColumn + 2;\r\n            }\r\n            else {\r\n                afterVisibleColumn = beforeVisibleColumn + 1;\r\n            }\r\n            if (afterVisibleColumn >= visibleColumn) {\r\n                var prevDelta = visibleColumn - beforeVisibleColumn;\r\n                var afterDelta = afterVisibleColumn - visibleColumn;\r\n                if (afterDelta < prevDelta) {\r\n                    return i + 2;\r\n                }\r\n                else {\r\n                    return i + 1;\r\n                }\r\n            }\r\n            beforeVisibleColumn = afterVisibleColumn;\r\n        }\r\n        // walked the entire string\r\n        return lineLength + 1;\r\n    };\r\n    CursorColumns.columnFromVisibleColumn2 = function (config, model, lineNumber, visibleColumn) {\r\n        var result = this.columnFromVisibleColumn(model.getLineContent(lineNumber), visibleColumn, config.tabSize);\r\n        var minColumn = model.getLineMinColumn(lineNumber);\r\n        if (result < minColumn) {\r\n            return minColumn;\r\n        }\r\n        var maxColumn = model.getLineMaxColumn(lineNumber);\r\n        if (result > maxColumn) {\r\n            return maxColumn;\r\n        }\r\n        return result;\r\n    };\r\n    /**\r\n     * ATTENTION: This works with 0-based columns (as oposed to the regular 1-based columns)\r\n     */\r\n    CursorColumns.nextTabStop = function (visibleColumn, tabSize) {\r\n        return visibleColumn + tabSize - visibleColumn % tabSize;\r\n    };\r\n    /**\r\n     * ATTENTION: This works with 0-based columns (as oposed to the regular 1-based columns)\r\n     */\r\n    CursorColumns.prevTabStop = function (column, tabSize) {\r\n        return column - 1 - (column - 1) % tabSize;\r\n    };\r\n    return CursorColumns;\r\n}());\r\nexport { CursorColumns };\r\nexport function isQuote(ch) {\r\n    return (ch === '\\'' || ch === '\"' || ch === '`');\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { CursorColumns, SingleCursorState } from './cursorCommon.js';\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nvar ColumnSelection = /** @class */ (function () {\r\n    function ColumnSelection() {\r\n    }\r\n    ColumnSelection._columnSelect = function (config, model, fromLineNumber, fromVisibleColumn, toLineNumber, toVisibleColumn) {\r\n        var lineCount = Math.abs(toLineNumber - fromLineNumber) + 1;\r\n        var reversed = (fromLineNumber > toLineNumber);\r\n        var isRTL = (fromVisibleColumn > toVisibleColumn);\r\n        var isLTR = (fromVisibleColumn < toVisibleColumn);\r\n        var result = [];\r\n        // console.log(`fromVisibleColumn: ${fromVisibleColumn}, toVisibleColumn: ${toVisibleColumn}`);\r\n        for (var i = 0; i < lineCount; i++) {\r\n            var lineNumber = fromLineNumber + (reversed ? -i : i);\r\n            var startColumn = CursorColumns.columnFromVisibleColumn2(config, model, lineNumber, fromVisibleColumn);\r\n            var endColumn = CursorColumns.columnFromVisibleColumn2(config, model, lineNumber, toVisibleColumn);\r\n            var visibleStartColumn = CursorColumns.visibleColumnFromColumn2(config, model, new Position(lineNumber, startColumn));\r\n            var visibleEndColumn = CursorColumns.visibleColumnFromColumn2(config, model, new Position(lineNumber, endColumn));\r\n            // console.log(`lineNumber: ${lineNumber}: visibleStartColumn: ${visibleStartColumn}, visibleEndColumn: ${visibleEndColumn}`);\r\n            if (isLTR) {\r\n                if (visibleStartColumn > toVisibleColumn) {\r\n                    continue;\r\n                }\r\n                if (visibleEndColumn < fromVisibleColumn) {\r\n                    continue;\r\n                }\r\n            }\r\n            if (isRTL) {\r\n                if (visibleEndColumn > fromVisibleColumn) {\r\n                    continue;\r\n                }\r\n                if (visibleStartColumn < toVisibleColumn) {\r\n                    continue;\r\n                }\r\n            }\r\n            result.push(new SingleCursorState(new Range(lineNumber, startColumn, lineNumber, startColumn), 0, new Position(lineNumber, endColumn), 0));\r\n        }\r\n        return {\r\n            viewStates: result,\r\n            reversed: reversed,\r\n            toLineNumber: toLineNumber,\r\n            toVisualColumn: toVisibleColumn\r\n        };\r\n    };\r\n    ColumnSelection.columnSelect = function (config, model, fromViewSelection, toViewLineNumber, toViewVisualColumn) {\r\n        var fromViewPosition = new Position(fromViewSelection.selectionStartLineNumber, fromViewSelection.selectionStartColumn);\r\n        var fromViewVisibleColumn = CursorColumns.visibleColumnFromColumn2(config, model, fromViewPosition);\r\n        return ColumnSelection._columnSelect(config, model, fromViewPosition.lineNumber, fromViewVisibleColumn, toViewLineNumber, toViewVisualColumn);\r\n    };\r\n    ColumnSelection.columnSelectLeft = function (config, model, cursor, toViewLineNumber, toViewVisualColumn) {\r\n        if (toViewVisualColumn > 1) {\r\n            toViewVisualColumn--;\r\n        }\r\n        return this.columnSelect(config, model, cursor.selection, toViewLineNumber, toViewVisualColumn);\r\n    };\r\n    ColumnSelection.columnSelectRight = function (config, model, cursor, toViewLineNumber, toViewVisualColumn) {\r\n        var maxVisualViewColumn = 0;\r\n        var minViewLineNumber = Math.min(cursor.position.lineNumber, toViewLineNumber);\r\n        var maxViewLineNumber = Math.max(cursor.position.lineNumber, toViewLineNumber);\r\n        for (var lineNumber = minViewLineNumber; lineNumber <= maxViewLineNumber; lineNumber++) {\r\n            var lineMaxViewColumn = model.getLineMaxColumn(lineNumber);\r\n            var lineMaxVisualViewColumn = CursorColumns.visibleColumnFromColumn2(config, model, new Position(lineNumber, lineMaxViewColumn));\r\n            maxVisualViewColumn = Math.max(maxVisualViewColumn, lineMaxVisualViewColumn);\r\n        }\r\n        if (toViewVisualColumn < maxVisualViewColumn) {\r\n            toViewVisualColumn++;\r\n        }\r\n        return this.columnSelect(config, model, cursor.selection, toViewLineNumber, toViewVisualColumn);\r\n    };\r\n    ColumnSelection.columnSelectUp = function (config, model, cursor, isPaged, toViewLineNumber, toViewVisualColumn) {\r\n        var linesCount = isPaged ? config.pageSize : 1;\r\n        toViewLineNumber -= linesCount;\r\n        if (toViewLineNumber < 1) {\r\n            toViewLineNumber = 1;\r\n        }\r\n        return this.columnSelect(config, model, cursor.selection, toViewLineNumber, toViewVisualColumn);\r\n    };\r\n    ColumnSelection.columnSelectDown = function (config, model, cursor, isPaged, toViewLineNumber, toViewVisualColumn) {\r\n        var linesCount = isPaged ? config.pageSize : 1;\r\n        toViewLineNumber += linesCount;\r\n        if (toViewLineNumber > model.getLineCount()) {\r\n            toViewLineNumber = model.getLineCount();\r\n        }\r\n        return this.columnSelect(config, model, cursor.selection, toViewLineNumber, toViewVisualColumn);\r\n    };\r\n    return ColumnSelection;\r\n}());\r\nexport { ColumnSelection };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Selection } from '../core/selection.js';\r\nvar ReplaceCommand = /** @class */ (function () {\r\n    function ReplaceCommand(range, text, insertsAutoWhitespace) {\r\n        if (insertsAutoWhitespace === void 0) { insertsAutoWhitespace = false; }\r\n        this._range = range;\r\n        this._text = text;\r\n        this.insertsAutoWhitespace = insertsAutoWhitespace;\r\n    }\r\n    ReplaceCommand.prototype.getEditOperations = function (model, builder) {\r\n        builder.addTrackedEditOperation(this._range, this._text);\r\n    };\r\n    ReplaceCommand.prototype.computeCursorState = function (model, helper) {\r\n        var inverseEditOperations = helper.getInverseEditOperations();\r\n        var srcRange = inverseEditOperations[0].range;\r\n        return new Selection(srcRange.endLineNumber, srcRange.endColumn, srcRange.endLineNumber, srcRange.endColumn);\r\n    };\r\n    return ReplaceCommand;\r\n}());\r\nexport { ReplaceCommand };\r\nvar ReplaceCommandWithoutChangingPosition = /** @class */ (function () {\r\n    function ReplaceCommandWithoutChangingPosition(range, text, insertsAutoWhitespace) {\r\n        if (insertsAutoWhitespace === void 0) { insertsAutoWhitespace = false; }\r\n        this._range = range;\r\n        this._text = text;\r\n        this.insertsAutoWhitespace = insertsAutoWhitespace;\r\n    }\r\n    ReplaceCommandWithoutChangingPosition.prototype.getEditOperations = function (model, builder) {\r\n        builder.addTrackedEditOperation(this._range, this._text);\r\n    };\r\n    ReplaceCommandWithoutChangingPosition.prototype.computeCursorState = function (model, helper) {\r\n        var inverseEditOperations = helper.getInverseEditOperations();\r\n        var srcRange = inverseEditOperations[0].range;\r\n        return new Selection(srcRange.startLineNumber, srcRange.startColumn, srcRange.startLineNumber, srcRange.startColumn);\r\n    };\r\n    return ReplaceCommandWithoutChangingPosition;\r\n}());\r\nexport { ReplaceCommandWithoutChangingPosition };\r\nvar ReplaceCommandWithOffsetCursorState = /** @class */ (function () {\r\n    function ReplaceCommandWithOffsetCursorState(range, text, lineNumberDeltaOffset, columnDeltaOffset, insertsAutoWhitespace) {\r\n        if (insertsAutoWhitespace === void 0) { insertsAutoWhitespace = false; }\r\n        this._range = range;\r\n        this._text = text;\r\n        this._columnDeltaOffset = columnDeltaOffset;\r\n        this._lineNumberDeltaOffset = lineNumberDeltaOffset;\r\n        this.insertsAutoWhitespace = insertsAutoWhitespace;\r\n    }\r\n    ReplaceCommandWithOffsetCursorState.prototype.getEditOperations = function (model, builder) {\r\n        builder.addTrackedEditOperation(this._range, this._text);\r\n    };\r\n    ReplaceCommandWithOffsetCursorState.prototype.computeCursorState = function (model, helper) {\r\n        var inverseEditOperations = helper.getInverseEditOperations();\r\n        var srcRange = inverseEditOperations[0].range;\r\n        return new Selection(srcRange.endLineNumber + this._lineNumberDeltaOffset, srcRange.endColumn + this._columnDeltaOffset, srcRange.endLineNumber + this._lineNumberDeltaOffset, srcRange.endColumn + this._columnDeltaOffset);\r\n    };\r\n    return ReplaceCommandWithOffsetCursorState;\r\n}());\r\nexport { ReplaceCommandWithOffsetCursorState };\r\nvar ReplaceCommandThatPreservesSelection = /** @class */ (function () {\r\n    function ReplaceCommandThatPreservesSelection(editRange, text, initialSelection) {\r\n        this._range = editRange;\r\n        this._text = text;\r\n        this._initialSelection = initialSelection;\r\n    }\r\n    ReplaceCommandThatPreservesSelection.prototype.getEditOperations = function (model, builder) {\r\n        builder.addEditOperation(this._range, this._text);\r\n        this._selectionId = builder.trackSelection(this._initialSelection);\r\n    };\r\n    ReplaceCommandThatPreservesSelection.prototype.computeCursorState = function (model, helper) {\r\n        return helper.getTrackedSelection(this._selectionId);\r\n    };\r\n    return ReplaceCommandThatPreservesSelection;\r\n}());\r\nexport { ReplaceCommandThatPreservesSelection };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { CursorColumns, SingleCursorState } from './cursorCommon.js';\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nvar CursorPosition = /** @class */ (function () {\r\n    function CursorPosition(lineNumber, column, leftoverVisibleColumns) {\r\n        this.lineNumber = lineNumber;\r\n        this.column = column;\r\n        this.leftoverVisibleColumns = leftoverVisibleColumns;\r\n    }\r\n    return CursorPosition;\r\n}());\r\nexport { CursorPosition };\r\nvar MoveOperations = /** @class */ (function () {\r\n    function MoveOperations() {\r\n    }\r\n    MoveOperations.left = function (config, model, lineNumber, column) {\r\n        if (column > model.getLineMinColumn(lineNumber)) {\r\n            if (CursorColumns.isLowSurrogate(model, lineNumber, column - 2)) {\r\n                // character before column is a low surrogate\r\n                column = column - 2;\r\n            }\r\n            else {\r\n                column = column - 1;\r\n            }\r\n        }\r\n        else if (lineNumber > 1) {\r\n            lineNumber = lineNumber - 1;\r\n            column = model.getLineMaxColumn(lineNumber);\r\n        }\r\n        return new CursorPosition(lineNumber, column, 0);\r\n    };\r\n    MoveOperations.moveLeft = function (config, model, cursor, inSelectionMode, noOfColumns) {\r\n        var lineNumber, column;\r\n        if (cursor.hasSelection() && !inSelectionMode) {\r\n            // If we are in selection mode, move left without selection cancels selection and puts cursor at the beginning of the selection\r\n            lineNumber = cursor.selection.startLineNumber;\r\n            column = cursor.selection.startColumn;\r\n        }\r\n        else {\r\n            var r = MoveOperations.left(config, model, cursor.position.lineNumber, cursor.position.column - (noOfColumns - 1));\r\n            lineNumber = r.lineNumber;\r\n            column = r.column;\r\n        }\r\n        return cursor.move(inSelectionMode, lineNumber, column, 0);\r\n    };\r\n    MoveOperations.right = function (config, model, lineNumber, column) {\r\n        if (column < model.getLineMaxColumn(lineNumber)) {\r\n            if (CursorColumns.isHighSurrogate(model, lineNumber, column - 1)) {\r\n                // character after column is a high surrogate\r\n                column = column + 2;\r\n            }\r\n            else {\r\n                column = column + 1;\r\n            }\r\n        }\r\n        else if (lineNumber < model.getLineCount()) {\r\n            lineNumber = lineNumber + 1;\r\n            column = model.getLineMinColumn(lineNumber);\r\n        }\r\n        return new CursorPosition(lineNumber, column, 0);\r\n    };\r\n    MoveOperations.moveRight = function (config, model, cursor, inSelectionMode, noOfColumns) {\r\n        var lineNumber, column;\r\n        if (cursor.hasSelection() && !inSelectionMode) {\r\n            // If we are in selection mode, move right without selection cancels selection and puts cursor at the end of the selection\r\n            lineNumber = cursor.selection.endLineNumber;\r\n            column = cursor.selection.endColumn;\r\n        }\r\n        else {\r\n            var r = MoveOperations.right(config, model, cursor.position.lineNumber, cursor.position.column + (noOfColumns - 1));\r\n            lineNumber = r.lineNumber;\r\n            column = r.column;\r\n        }\r\n        return cursor.move(inSelectionMode, lineNumber, column, 0);\r\n    };\r\n    MoveOperations.down = function (config, model, lineNumber, column, leftoverVisibleColumns, count, allowMoveOnLastLine) {\r\n        var currentVisibleColumn = CursorColumns.visibleColumnFromColumn(model.getLineContent(lineNumber), column, config.tabSize) + leftoverVisibleColumns;\r\n        lineNumber = lineNumber + count;\r\n        var lineCount = model.getLineCount();\r\n        if (lineNumber > lineCount) {\r\n            lineNumber = lineCount;\r\n            if (allowMoveOnLastLine) {\r\n                column = model.getLineMaxColumn(lineNumber);\r\n            }\r\n            else {\r\n                column = Math.min(model.getLineMaxColumn(lineNumber), column);\r\n                if (CursorColumns.isInsideSurrogatePair(model, lineNumber, column)) {\r\n                    column = column - 1;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            column = CursorColumns.columnFromVisibleColumn2(config, model, lineNumber, currentVisibleColumn);\r\n            if (CursorColumns.isInsideSurrogatePair(model, lineNumber, column)) {\r\n                column = column - 1;\r\n            }\r\n        }\r\n        leftoverVisibleColumns = currentVisibleColumn - CursorColumns.visibleColumnFromColumn(model.getLineContent(lineNumber), column, config.tabSize);\r\n        return new CursorPosition(lineNumber, column, leftoverVisibleColumns);\r\n    };\r\n    MoveOperations.moveDown = function (config, model, cursor, inSelectionMode, linesCount) {\r\n        var lineNumber, column;\r\n        if (cursor.hasSelection() && !inSelectionMode) {\r\n            // If we are in selection mode, move down acts relative to the end of selection\r\n            lineNumber = cursor.selection.endLineNumber;\r\n            column = cursor.selection.endColumn;\r\n        }\r\n        else {\r\n            lineNumber = cursor.position.lineNumber;\r\n            column = cursor.position.column;\r\n        }\r\n        var r = MoveOperations.down(config, model, lineNumber, column, cursor.leftoverVisibleColumns, linesCount, true);\r\n        return cursor.move(inSelectionMode, r.lineNumber, r.column, r.leftoverVisibleColumns);\r\n    };\r\n    MoveOperations.translateDown = function (config, model, cursor) {\r\n        var selection = cursor.selection;\r\n        var selectionStart = MoveOperations.down(config, model, selection.selectionStartLineNumber, selection.selectionStartColumn, cursor.selectionStartLeftoverVisibleColumns, 1, false);\r\n        var position = MoveOperations.down(config, model, selection.positionLineNumber, selection.positionColumn, cursor.leftoverVisibleColumns, 1, false);\r\n        return new SingleCursorState(new Range(selectionStart.lineNumber, selectionStart.column, selectionStart.lineNumber, selectionStart.column), selectionStart.leftoverVisibleColumns, new Position(position.lineNumber, position.column), position.leftoverVisibleColumns);\r\n    };\r\n    MoveOperations.up = function (config, model, lineNumber, column, leftoverVisibleColumns, count, allowMoveOnFirstLine) {\r\n        var currentVisibleColumn = CursorColumns.visibleColumnFromColumn(model.getLineContent(lineNumber), column, config.tabSize) + leftoverVisibleColumns;\r\n        lineNumber = lineNumber - count;\r\n        if (lineNumber < 1) {\r\n            lineNumber = 1;\r\n            if (allowMoveOnFirstLine) {\r\n                column = model.getLineMinColumn(lineNumber);\r\n            }\r\n            else {\r\n                column = Math.min(model.getLineMaxColumn(lineNumber), column);\r\n                if (CursorColumns.isInsideSurrogatePair(model, lineNumber, column)) {\r\n                    column = column - 1;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            column = CursorColumns.columnFromVisibleColumn2(config, model, lineNumber, currentVisibleColumn);\r\n            if (CursorColumns.isInsideSurrogatePair(model, lineNumber, column)) {\r\n                column = column - 1;\r\n            }\r\n        }\r\n        leftoverVisibleColumns = currentVisibleColumn - CursorColumns.visibleColumnFromColumn(model.getLineContent(lineNumber), column, config.tabSize);\r\n        return new CursorPosition(lineNumber, column, leftoverVisibleColumns);\r\n    };\r\n    MoveOperations.moveUp = function (config, model, cursor, inSelectionMode, linesCount) {\r\n        var lineNumber, column;\r\n        if (cursor.hasSelection() && !inSelectionMode) {\r\n            // If we are in selection mode, move up acts relative to the beginning of selection\r\n            lineNumber = cursor.selection.startLineNumber;\r\n            column = cursor.selection.startColumn;\r\n        }\r\n        else {\r\n            lineNumber = cursor.position.lineNumber;\r\n            column = cursor.position.column;\r\n        }\r\n        var r = MoveOperations.up(config, model, lineNumber, column, cursor.leftoverVisibleColumns, linesCount, true);\r\n        return cursor.move(inSelectionMode, r.lineNumber, r.column, r.leftoverVisibleColumns);\r\n    };\r\n    MoveOperations.translateUp = function (config, model, cursor) {\r\n        var selection = cursor.selection;\r\n        var selectionStart = MoveOperations.up(config, model, selection.selectionStartLineNumber, selection.selectionStartColumn, cursor.selectionStartLeftoverVisibleColumns, 1, false);\r\n        var position = MoveOperations.up(config, model, selection.positionLineNumber, selection.positionColumn, cursor.leftoverVisibleColumns, 1, false);\r\n        return new SingleCursorState(new Range(selectionStart.lineNumber, selectionStart.column, selectionStart.lineNumber, selectionStart.column), selectionStart.leftoverVisibleColumns, new Position(position.lineNumber, position.column), position.leftoverVisibleColumns);\r\n    };\r\n    MoveOperations.moveToBeginningOfLine = function (config, model, cursor, inSelectionMode) {\r\n        var lineNumber = cursor.position.lineNumber;\r\n        var minColumn = model.getLineMinColumn(lineNumber);\r\n        var firstNonBlankColumn = model.getLineFirstNonWhitespaceColumn(lineNumber) || minColumn;\r\n        var column;\r\n        var relevantColumnNumber = cursor.position.column;\r\n        if (relevantColumnNumber === firstNonBlankColumn) {\r\n            column = minColumn;\r\n        }\r\n        else {\r\n            column = firstNonBlankColumn;\r\n        }\r\n        return cursor.move(inSelectionMode, lineNumber, column, 0);\r\n    };\r\n    MoveOperations.moveToEndOfLine = function (config, model, cursor, inSelectionMode) {\r\n        var lineNumber = cursor.position.lineNumber;\r\n        var maxColumn = model.getLineMaxColumn(lineNumber);\r\n        return cursor.move(inSelectionMode, lineNumber, maxColumn, 0);\r\n    };\r\n    MoveOperations.moveToBeginningOfBuffer = function (config, model, cursor, inSelectionMode) {\r\n        return cursor.move(inSelectionMode, 1, 1, 0);\r\n    };\r\n    MoveOperations.moveToEndOfBuffer = function (config, model, cursor, inSelectionMode) {\r\n        var lastLineNumber = model.getLineCount();\r\n        var lastColumn = model.getLineMaxColumn(lastLineNumber);\r\n        return cursor.move(inSelectionMode, lastLineNumber, lastColumn, 0);\r\n    };\r\n    return MoveOperations;\r\n}());\r\nexport { MoveOperations };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { ReplaceCommand } from '../commands/replaceCommand.js';\r\nimport { CursorColumns, EditOperationResult, isQuote } from './cursorCommon.js';\r\nimport { MoveOperations } from './cursorMoveOperations.js';\r\nimport { Range } from '../core/range.js';\r\nvar DeleteOperations = /** @class */ (function () {\r\n    function DeleteOperations() {\r\n    }\r\n    DeleteOperations.deleteRight = function (prevEditOperationType, config, model, selections) {\r\n        var commands = [];\r\n        var shouldPushStackElementBefore = (prevEditOperationType !== 3 /* DeletingRight */);\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            var deleteSelection = selection;\r\n            if (deleteSelection.isEmpty()) {\r\n                var position = selection.getPosition();\r\n                var rightOfPosition = MoveOperations.right(config, model, position.lineNumber, position.column);\r\n                deleteSelection = new Range(rightOfPosition.lineNumber, rightOfPosition.column, position.lineNumber, position.column);\r\n            }\r\n            if (deleteSelection.isEmpty()) {\r\n                // Probably at end of file => ignore\r\n                commands[i] = null;\r\n                continue;\r\n            }\r\n            if (deleteSelection.startLineNumber !== deleteSelection.endLineNumber) {\r\n                shouldPushStackElementBefore = true;\r\n            }\r\n            commands[i] = new ReplaceCommand(deleteSelection, '');\r\n        }\r\n        return [shouldPushStackElementBefore, commands];\r\n    };\r\n    DeleteOperations._isAutoClosingPairDelete = function (config, model, selections) {\r\n        if (config.autoClosingBrackets === 'never' && config.autoClosingQuotes === 'never') {\r\n            return false;\r\n        }\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            var position = selection.getPosition();\r\n            if (!selection.isEmpty()) {\r\n                return false;\r\n            }\r\n            var lineText = model.getLineContent(position.lineNumber);\r\n            var character = lineText[position.column - 2];\r\n            if (!config.autoClosingPairsOpen.hasOwnProperty(character)) {\r\n                return false;\r\n            }\r\n            if (isQuote(character)) {\r\n                if (config.autoClosingQuotes === 'never') {\r\n                    return false;\r\n                }\r\n            }\r\n            else {\r\n                if (config.autoClosingBrackets === 'never') {\r\n                    return false;\r\n                }\r\n            }\r\n            var afterCharacter = lineText[position.column - 1];\r\n            var closeCharacter = config.autoClosingPairsOpen[character];\r\n            if (afterCharacter !== closeCharacter) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    DeleteOperations._runAutoClosingPairDelete = function (config, model, selections) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var position = selections[i].getPosition();\r\n            var deleteSelection = new Range(position.lineNumber, position.column - 1, position.lineNumber, position.column + 1);\r\n            commands[i] = new ReplaceCommand(deleteSelection, '');\r\n        }\r\n        return [true, commands];\r\n    };\r\n    DeleteOperations.deleteLeft = function (prevEditOperationType, config, model, selections) {\r\n        if (this._isAutoClosingPairDelete(config, model, selections)) {\r\n            return this._runAutoClosingPairDelete(config, model, selections);\r\n        }\r\n        var commands = [];\r\n        var shouldPushStackElementBefore = (prevEditOperationType !== 2 /* DeletingLeft */);\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            var deleteSelection = selection;\r\n            if (deleteSelection.isEmpty()) {\r\n                var position = selection.getPosition();\r\n                if (config.useTabStops && position.column > 1) {\r\n                    var lineContent = model.getLineContent(position.lineNumber);\r\n                    var firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\r\n                    var lastIndentationColumn = (firstNonWhitespaceIndex === -1\r\n                        ? /* entire string is whitespace */ lineContent.length + 1\r\n                        : firstNonWhitespaceIndex + 1);\r\n                    if (position.column <= lastIndentationColumn) {\r\n                        var fromVisibleColumn = CursorColumns.visibleColumnFromColumn2(config, model, position);\r\n                        var toVisibleColumn = CursorColumns.prevTabStop(fromVisibleColumn, config.tabSize);\r\n                        var toColumn = CursorColumns.columnFromVisibleColumn2(config, model, position.lineNumber, toVisibleColumn);\r\n                        deleteSelection = new Range(position.lineNumber, toColumn, position.lineNumber, position.column);\r\n                    }\r\n                    else {\r\n                        deleteSelection = new Range(position.lineNumber, position.column - 1, position.lineNumber, position.column);\r\n                    }\r\n                }\r\n                else {\r\n                    var leftOfPosition = MoveOperations.left(config, model, position.lineNumber, position.column);\r\n                    deleteSelection = new Range(leftOfPosition.lineNumber, leftOfPosition.column, position.lineNumber, position.column);\r\n                }\r\n            }\r\n            if (deleteSelection.isEmpty()) {\r\n                // Probably at beginning of file => ignore\r\n                commands[i] = null;\r\n                continue;\r\n            }\r\n            if (deleteSelection.startLineNumber !== deleteSelection.endLineNumber) {\r\n                shouldPushStackElementBefore = true;\r\n            }\r\n            commands[i] = new ReplaceCommand(deleteSelection, '');\r\n        }\r\n        return [shouldPushStackElementBefore, commands];\r\n    };\r\n    DeleteOperations.cut = function (config, model, selections) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (selection.isEmpty()) {\r\n                if (config.emptySelectionClipboard) {\r\n                    // This is a full line cut\r\n                    var position = selection.getPosition();\r\n                    var startLineNumber = void 0, startColumn = void 0, endLineNumber = void 0, endColumn = void 0;\r\n                    if (position.lineNumber < model.getLineCount()) {\r\n                        // Cutting a line in the middle of the model\r\n                        startLineNumber = position.lineNumber;\r\n                        startColumn = 1;\r\n                        endLineNumber = position.lineNumber + 1;\r\n                        endColumn = 1;\r\n                    }\r\n                    else if (position.lineNumber > 1) {\r\n                        // Cutting the last line & there are more than 1 lines in the model\r\n                        startLineNumber = position.lineNumber - 1;\r\n                        startColumn = model.getLineMaxColumn(position.lineNumber - 1);\r\n                        endLineNumber = position.lineNumber;\r\n                        endColumn = model.getLineMaxColumn(position.lineNumber);\r\n                    }\r\n                    else {\r\n                        // Cutting the single line that the model contains\r\n                        startLineNumber = position.lineNumber;\r\n                        startColumn = 1;\r\n                        endLineNumber = position.lineNumber;\r\n                        endColumn = model.getLineMaxColumn(position.lineNumber);\r\n                    }\r\n                    var deleteSelection = new Range(startLineNumber, startColumn, endLineNumber, endColumn);\r\n                    if (!deleteSelection.isEmpty()) {\r\n                        commands[i] = new ReplaceCommand(deleteSelection, '');\r\n                    }\r\n                    else {\r\n                        commands[i] = null;\r\n                    }\r\n                }\r\n                else {\r\n                    // Cannot cut empty selection\r\n                    commands[i] = null;\r\n                }\r\n            }\r\n            else {\r\n                commands[i] = new ReplaceCommand(selection, '');\r\n            }\r\n        }\r\n        return new EditOperationResult(0 /* Other */, commands, {\r\n            shouldPushStackElementBefore: true,\r\n            shouldPushStackElementAfter: true\r\n        });\r\n    };\r\n    return DeleteOperations;\r\n}());\r\nexport { DeleteOperations };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { SingleCursorState } from './cursorCommon.js';\r\nimport { getMapForWordSeparators } from './wordCharacterClassifier.js';\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nvar WordOperations = /** @class */ (function () {\r\n    function WordOperations() {\r\n    }\r\n    WordOperations._createWord = function (lineContent, wordType, nextCharClass, start, end) {\r\n        // console.log('WORD ==> ' + start + ' => ' + end + ':::: <<<' + lineContent.substring(start, end) + '>>>');\r\n        return { start: start, end: end, wordType: wordType, nextCharClass: nextCharClass };\r\n    };\r\n    WordOperations._findPreviousWordOnLine = function (wordSeparators, model, position) {\r\n        var lineContent = model.getLineContent(position.lineNumber);\r\n        return this._doFindPreviousWordOnLine(lineContent, wordSeparators, position);\r\n    };\r\n    WordOperations._doFindPreviousWordOnLine = function (lineContent, wordSeparators, position) {\r\n        var wordType = 0 /* None */;\r\n        for (var chIndex = position.column - 2; chIndex >= 0; chIndex--) {\r\n            var chCode = lineContent.charCodeAt(chIndex);\r\n            var chClass = wordSeparators.get(chCode);\r\n            if (chClass === 0 /* Regular */) {\r\n                if (wordType === 2 /* Separator */) {\r\n                    return this._createWord(lineContent, wordType, chClass, chIndex + 1, this._findEndOfWord(lineContent, wordSeparators, wordType, chIndex + 1));\r\n                }\r\n                wordType = 1 /* Regular */;\r\n            }\r\n            else if (chClass === 2 /* WordSeparator */) {\r\n                if (wordType === 1 /* Regular */) {\r\n                    return this._createWord(lineContent, wordType, chClass, chIndex + 1, this._findEndOfWord(lineContent, wordSeparators, wordType, chIndex + 1));\r\n                }\r\n                wordType = 2 /* Separator */;\r\n            }\r\n            else if (chClass === 1 /* Whitespace */) {\r\n                if (wordType !== 0 /* None */) {\r\n                    return this._createWord(lineContent, wordType, chClass, chIndex + 1, this._findEndOfWord(lineContent, wordSeparators, wordType, chIndex + 1));\r\n                }\r\n            }\r\n        }\r\n        if (wordType !== 0 /* None */) {\r\n            return this._createWord(lineContent, wordType, 1 /* Whitespace */, 0, this._findEndOfWord(lineContent, wordSeparators, wordType, 0));\r\n        }\r\n        return null;\r\n    };\r\n    WordOperations._findEndOfWord = function (lineContent, wordSeparators, wordType, startIndex) {\r\n        var len = lineContent.length;\r\n        for (var chIndex = startIndex; chIndex < len; chIndex++) {\r\n            var chCode = lineContent.charCodeAt(chIndex);\r\n            var chClass = wordSeparators.get(chCode);\r\n            if (chClass === 1 /* Whitespace */) {\r\n                return chIndex;\r\n            }\r\n            if (wordType === 1 /* Regular */ && chClass === 2 /* WordSeparator */) {\r\n                return chIndex;\r\n            }\r\n            if (wordType === 2 /* Separator */ && chClass === 0 /* Regular */) {\r\n                return chIndex;\r\n            }\r\n        }\r\n        return len;\r\n    };\r\n    WordOperations._findNextWordOnLine = function (wordSeparators, model, position) {\r\n        var lineContent = model.getLineContent(position.lineNumber);\r\n        return this._doFindNextWordOnLine(lineContent, wordSeparators, position);\r\n    };\r\n    WordOperations._doFindNextWordOnLine = function (lineContent, wordSeparators, position) {\r\n        var wordType = 0 /* None */;\r\n        var len = lineContent.length;\r\n        for (var chIndex = position.column - 1; chIndex < len; chIndex++) {\r\n            var chCode = lineContent.charCodeAt(chIndex);\r\n            var chClass = wordSeparators.get(chCode);\r\n            if (chClass === 0 /* Regular */) {\r\n                if (wordType === 2 /* Separator */) {\r\n                    return this._createWord(lineContent, wordType, chClass, this._findStartOfWord(lineContent, wordSeparators, wordType, chIndex - 1), chIndex);\r\n                }\r\n                wordType = 1 /* Regular */;\r\n            }\r\n            else if (chClass === 2 /* WordSeparator */) {\r\n                if (wordType === 1 /* Regular */) {\r\n                    return this._createWord(lineContent, wordType, chClass, this._findStartOfWord(lineContent, wordSeparators, wordType, chIndex - 1), chIndex);\r\n                }\r\n                wordType = 2 /* Separator */;\r\n            }\r\n            else if (chClass === 1 /* Whitespace */) {\r\n                if (wordType !== 0 /* None */) {\r\n                    return this._createWord(lineContent, wordType, chClass, this._findStartOfWord(lineContent, wordSeparators, wordType, chIndex - 1), chIndex);\r\n                }\r\n            }\r\n        }\r\n        if (wordType !== 0 /* None */) {\r\n            return this._createWord(lineContent, wordType, 1 /* Whitespace */, this._findStartOfWord(lineContent, wordSeparators, wordType, len - 1), len);\r\n        }\r\n        return null;\r\n    };\r\n    WordOperations._findStartOfWord = function (lineContent, wordSeparators, wordType, startIndex) {\r\n        for (var chIndex = startIndex; chIndex >= 0; chIndex--) {\r\n            var chCode = lineContent.charCodeAt(chIndex);\r\n            var chClass = wordSeparators.get(chCode);\r\n            if (chClass === 1 /* Whitespace */) {\r\n                return chIndex + 1;\r\n            }\r\n            if (wordType === 1 /* Regular */ && chClass === 2 /* WordSeparator */) {\r\n                return chIndex + 1;\r\n            }\r\n            if (wordType === 2 /* Separator */ && chClass === 0 /* Regular */) {\r\n                return chIndex + 1;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    WordOperations.moveWordLeft = function (wordSeparators, model, position, wordNavigationType) {\r\n        var lineNumber = position.lineNumber;\r\n        var column = position.column;\r\n        var movedToPreviousLine = false;\r\n        if (column === 1) {\r\n            if (lineNumber > 1) {\r\n                movedToPreviousLine = true;\r\n                lineNumber = lineNumber - 1;\r\n                column = model.getLineMaxColumn(lineNumber);\r\n            }\r\n        }\r\n        var prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, new Position(lineNumber, column));\r\n        if (wordNavigationType === 0 /* WordStart */) {\r\n            if (prevWordOnLine && !movedToPreviousLine) {\r\n                // Special case for Visual Studio compatibility:\r\n                // when starting in the trim whitespace at the end of a line,\r\n                // go to the end of the last word\r\n                var lastWhitespaceColumn = model.getLineLastNonWhitespaceColumn(lineNumber);\r\n                if (lastWhitespaceColumn < column) {\r\n                    return new Position(lineNumber, prevWordOnLine.end + 1);\r\n                }\r\n            }\r\n            return new Position(lineNumber, prevWordOnLine ? prevWordOnLine.start + 1 : 1);\r\n        }\r\n        if (wordNavigationType === 1 /* WordStartFast */) {\r\n            if (prevWordOnLine\r\n                && prevWordOnLine.wordType === 2 /* Separator */\r\n                && prevWordOnLine.end - prevWordOnLine.start === 1\r\n                && prevWordOnLine.nextCharClass === 0 /* Regular */) {\r\n                // Skip over a word made up of one single separator and followed by a regular character\r\n                prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, new Position(lineNumber, prevWordOnLine.start + 1));\r\n            }\r\n            return new Position(lineNumber, prevWordOnLine ? prevWordOnLine.start + 1 : 1);\r\n        }\r\n        // We are stopping at the ending of words\r\n        if (prevWordOnLine && column <= prevWordOnLine.end + 1) {\r\n            prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, new Position(lineNumber, prevWordOnLine.start + 1));\r\n        }\r\n        return new Position(lineNumber, prevWordOnLine ? prevWordOnLine.end + 1 : 1);\r\n    };\r\n    WordOperations._moveWordPartLeft = function (model, position) {\r\n        var lineNumber = position.lineNumber;\r\n        var maxColumn = model.getLineMaxColumn(lineNumber);\r\n        if (position.column === 1) {\r\n            return (lineNumber > 1 ? new Position(lineNumber - 1, model.getLineMaxColumn(lineNumber - 1)) : position);\r\n        }\r\n        var lineContent = model.getLineContent(lineNumber);\r\n        for (var column = position.column - 1; column > 1; column--) {\r\n            var left = lineContent.charCodeAt(column - 2);\r\n            var right = lineContent.charCodeAt(column - 1);\r\n            if (left !== 95 /* Underline */ && right === 95 /* Underline */) {\r\n                // snake_case_variables\r\n                return new Position(lineNumber, column);\r\n            }\r\n            if (strings.isLowerAsciiLetter(left) && strings.isUpperAsciiLetter(right)) {\r\n                // camelCaseVariables\r\n                return new Position(lineNumber, column);\r\n            }\r\n            if (strings.isUpperAsciiLetter(left) && strings.isUpperAsciiLetter(right)) {\r\n                // thisIsACamelCaseWithOneLetterWords\r\n                if (column + 1 < maxColumn) {\r\n                    var rightRight = lineContent.charCodeAt(column);\r\n                    if (strings.isLowerAsciiLetter(rightRight)) {\r\n                        return new Position(lineNumber, column);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return new Position(lineNumber, 1);\r\n    };\r\n    WordOperations.moveWordRight = function (wordSeparators, model, position, wordNavigationType) {\r\n        var lineNumber = position.lineNumber;\r\n        var column = position.column;\r\n        if (column === model.getLineMaxColumn(lineNumber)) {\r\n            if (lineNumber < model.getLineCount()) {\r\n                lineNumber = lineNumber + 1;\r\n                column = 1;\r\n            }\r\n        }\r\n        var nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, column));\r\n        if (wordNavigationType === 2 /* WordEnd */) {\r\n            if (nextWordOnLine && nextWordOnLine.wordType === 2 /* Separator */) {\r\n                if (nextWordOnLine.end - nextWordOnLine.start === 1 && nextWordOnLine.nextCharClass === 0 /* Regular */) {\r\n                    // Skip over a word made up of one single separator and followed by a regular character\r\n                    nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, nextWordOnLine.end + 1));\r\n                }\r\n            }\r\n            if (nextWordOnLine) {\r\n                column = nextWordOnLine.end + 1;\r\n            }\r\n            else {\r\n                column = model.getLineMaxColumn(lineNumber);\r\n            }\r\n        }\r\n        else {\r\n            if (nextWordOnLine && column >= nextWordOnLine.start + 1) {\r\n                nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, nextWordOnLine.end + 1));\r\n            }\r\n            if (nextWordOnLine) {\r\n                column = nextWordOnLine.start + 1;\r\n            }\r\n            else {\r\n                column = model.getLineMaxColumn(lineNumber);\r\n            }\r\n        }\r\n        return new Position(lineNumber, column);\r\n    };\r\n    WordOperations._moveWordPartRight = function (model, position) {\r\n        var lineNumber = position.lineNumber;\r\n        var maxColumn = model.getLineMaxColumn(lineNumber);\r\n        if (position.column === maxColumn) {\r\n            return (lineNumber < model.getLineCount() ? new Position(lineNumber + 1, 1) : position);\r\n        }\r\n        var lineContent = model.getLineContent(lineNumber);\r\n        for (var column = position.column + 1; column < maxColumn; column++) {\r\n            var left = lineContent.charCodeAt(column - 2);\r\n            var right = lineContent.charCodeAt(column - 1);\r\n            if (left === 95 /* Underline */ && right !== 95 /* Underline */) {\r\n                // snake_case_variables\r\n                return new Position(lineNumber, column);\r\n            }\r\n            if (strings.isLowerAsciiLetter(left) && strings.isUpperAsciiLetter(right)) {\r\n                // camelCaseVariables\r\n                return new Position(lineNumber, column);\r\n            }\r\n            if (strings.isUpperAsciiLetter(left) && strings.isUpperAsciiLetter(right)) {\r\n                // thisIsACamelCaseWithOneLetterWords\r\n                if (column + 1 < maxColumn) {\r\n                    var rightRight = lineContent.charCodeAt(column);\r\n                    if (strings.isLowerAsciiLetter(rightRight)) {\r\n                        return new Position(lineNumber, column);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return new Position(lineNumber, maxColumn);\r\n    };\r\n    WordOperations._deleteWordLeftWhitespace = function (model, position) {\r\n        var lineContent = model.getLineContent(position.lineNumber);\r\n        var startIndex = position.column - 2;\r\n        var lastNonWhitespace = strings.lastNonWhitespaceIndex(lineContent, startIndex);\r\n        if (lastNonWhitespace + 1 < startIndex) {\r\n            return new Range(position.lineNumber, lastNonWhitespace + 2, position.lineNumber, position.column);\r\n        }\r\n        return null;\r\n    };\r\n    WordOperations.deleteWordLeft = function (wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType) {\r\n        if (!selection.isEmpty()) {\r\n            return selection;\r\n        }\r\n        var position = new Position(selection.positionLineNumber, selection.positionColumn);\r\n        var lineNumber = position.lineNumber;\r\n        var column = position.column;\r\n        if (lineNumber === 1 && column === 1) {\r\n            // Ignore deleting at beginning of file\r\n            return null;\r\n        }\r\n        if (whitespaceHeuristics) {\r\n            var r = this._deleteWordLeftWhitespace(model, position);\r\n            if (r) {\r\n                return r;\r\n            }\r\n        }\r\n        var prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, position);\r\n        if (wordNavigationType === 0 /* WordStart */) {\r\n            if (prevWordOnLine) {\r\n                column = prevWordOnLine.start + 1;\r\n            }\r\n            else {\r\n                if (column > 1) {\r\n                    column = 1;\r\n                }\r\n                else {\r\n                    lineNumber--;\r\n                    column = model.getLineMaxColumn(lineNumber);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (prevWordOnLine && column <= prevWordOnLine.end + 1) {\r\n                prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, new Position(lineNumber, prevWordOnLine.start + 1));\r\n            }\r\n            if (prevWordOnLine) {\r\n                column = prevWordOnLine.end + 1;\r\n            }\r\n            else {\r\n                if (column > 1) {\r\n                    column = 1;\r\n                }\r\n                else {\r\n                    lineNumber--;\r\n                    column = model.getLineMaxColumn(lineNumber);\r\n                }\r\n            }\r\n        }\r\n        return new Range(lineNumber, column, position.lineNumber, position.column);\r\n    };\r\n    WordOperations._deleteWordPartLeft = function (model, selection) {\r\n        if (!selection.isEmpty()) {\r\n            return selection;\r\n        }\r\n        var pos = selection.getPosition();\r\n        var toPosition = WordOperations._moveWordPartLeft(model, pos);\r\n        return new Range(pos.lineNumber, pos.column, toPosition.lineNumber, toPosition.column);\r\n    };\r\n    WordOperations._findFirstNonWhitespaceChar = function (str, startIndex) {\r\n        var len = str.length;\r\n        for (var chIndex = startIndex; chIndex < len; chIndex++) {\r\n            var ch = str.charAt(chIndex);\r\n            if (ch !== ' ' && ch !== '\\t') {\r\n                return chIndex;\r\n            }\r\n        }\r\n        return len;\r\n    };\r\n    WordOperations._deleteWordRightWhitespace = function (model, position) {\r\n        var lineContent = model.getLineContent(position.lineNumber);\r\n        var startIndex = position.column - 1;\r\n        var firstNonWhitespace = this._findFirstNonWhitespaceChar(lineContent, startIndex);\r\n        if (startIndex + 1 < firstNonWhitespace) {\r\n            // bingo\r\n            return new Range(position.lineNumber, position.column, position.lineNumber, firstNonWhitespace + 1);\r\n        }\r\n        return null;\r\n    };\r\n    WordOperations.deleteWordRight = function (wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType) {\r\n        if (!selection.isEmpty()) {\r\n            return selection;\r\n        }\r\n        var position = new Position(selection.positionLineNumber, selection.positionColumn);\r\n        var lineNumber = position.lineNumber;\r\n        var column = position.column;\r\n        var lineCount = model.getLineCount();\r\n        var maxColumn = model.getLineMaxColumn(lineNumber);\r\n        if (lineNumber === lineCount && column === maxColumn) {\r\n            // Ignore deleting at end of file\r\n            return null;\r\n        }\r\n        if (whitespaceHeuristics) {\r\n            var r = this._deleteWordRightWhitespace(model, position);\r\n            if (r) {\r\n                return r;\r\n            }\r\n        }\r\n        var nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, position);\r\n        if (wordNavigationType === 2 /* WordEnd */) {\r\n            if (nextWordOnLine) {\r\n                column = nextWordOnLine.end + 1;\r\n            }\r\n            else {\r\n                if (column < maxColumn || lineNumber === lineCount) {\r\n                    column = maxColumn;\r\n                }\r\n                else {\r\n                    lineNumber++;\r\n                    nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, 1));\r\n                    if (nextWordOnLine) {\r\n                        column = nextWordOnLine.start + 1;\r\n                    }\r\n                    else {\r\n                        column = model.getLineMaxColumn(lineNumber);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (nextWordOnLine && column >= nextWordOnLine.start + 1) {\r\n                nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, nextWordOnLine.end + 1));\r\n            }\r\n            if (nextWordOnLine) {\r\n                column = nextWordOnLine.start + 1;\r\n            }\r\n            else {\r\n                if (column < maxColumn || lineNumber === lineCount) {\r\n                    column = maxColumn;\r\n                }\r\n                else {\r\n                    lineNumber++;\r\n                    nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, 1));\r\n                    if (nextWordOnLine) {\r\n                        column = nextWordOnLine.start + 1;\r\n                    }\r\n                    else {\r\n                        column = model.getLineMaxColumn(lineNumber);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return new Range(lineNumber, column, position.lineNumber, position.column);\r\n    };\r\n    WordOperations._deleteWordPartRight = function (model, selection) {\r\n        if (!selection.isEmpty()) {\r\n            return selection;\r\n        }\r\n        var pos = selection.getPosition();\r\n        var toPosition = WordOperations._moveWordPartRight(model, pos);\r\n        return new Range(pos.lineNumber, pos.column, toPosition.lineNumber, toPosition.column);\r\n    };\r\n    WordOperations.word = function (config, model, cursor, inSelectionMode, position) {\r\n        var wordSeparators = getMapForWordSeparators(config.wordSeparators);\r\n        var prevWord = WordOperations._findPreviousWordOnLine(wordSeparators, model, position);\r\n        var nextWord = WordOperations._findNextWordOnLine(wordSeparators, model, position);\r\n        if (!inSelectionMode) {\r\n            // Entering word selection for the first time\r\n            var startColumn_1;\r\n            var endColumn_1;\r\n            if (prevWord && prevWord.wordType === 1 /* Regular */ && prevWord.start <= position.column - 1 && position.column - 1 <= prevWord.end) {\r\n                // isTouchingPrevWord\r\n                startColumn_1 = prevWord.start + 1;\r\n                endColumn_1 = prevWord.end + 1;\r\n            }\r\n            else if (nextWord && nextWord.wordType === 1 /* Regular */ && nextWord.start <= position.column - 1 && position.column - 1 <= nextWord.end) {\r\n                // isTouchingNextWord\r\n                startColumn_1 = nextWord.start + 1;\r\n                endColumn_1 = nextWord.end + 1;\r\n            }\r\n            else {\r\n                if (prevWord) {\r\n                    startColumn_1 = prevWord.end + 1;\r\n                }\r\n                else {\r\n                    startColumn_1 = 1;\r\n                }\r\n                if (nextWord) {\r\n                    endColumn_1 = nextWord.start + 1;\r\n                }\r\n                else {\r\n                    endColumn_1 = model.getLineMaxColumn(position.lineNumber);\r\n                }\r\n            }\r\n            return new SingleCursorState(new Range(position.lineNumber, startColumn_1, position.lineNumber, endColumn_1), 0, new Position(position.lineNumber, endColumn_1), 0);\r\n        }\r\n        var startColumn;\r\n        var endColumn;\r\n        if (prevWord && prevWord.wordType === 1 /* Regular */ && prevWord.start < position.column - 1 && position.column - 1 < prevWord.end) {\r\n            // isInsidePrevWord\r\n            startColumn = prevWord.start + 1;\r\n            endColumn = prevWord.end + 1;\r\n        }\r\n        else if (nextWord && nextWord.wordType === 1 /* Regular */ && nextWord.start < position.column - 1 && position.column - 1 < nextWord.end) {\r\n            // isInsideNextWord\r\n            startColumn = nextWord.start + 1;\r\n            endColumn = nextWord.end + 1;\r\n        }\r\n        else {\r\n            startColumn = position.column;\r\n            endColumn = position.column;\r\n        }\r\n        var lineNumber = position.lineNumber;\r\n        var column;\r\n        if (cursor.selectionStart.containsPosition(position)) {\r\n            column = cursor.selectionStart.endColumn;\r\n        }\r\n        else if (position.isBeforeOrEqual(cursor.selectionStart.getStartPosition())) {\r\n            column = startColumn;\r\n            var possiblePosition = new Position(lineNumber, column);\r\n            if (cursor.selectionStart.containsPosition(possiblePosition)) {\r\n                column = cursor.selectionStart.endColumn;\r\n            }\r\n        }\r\n        else {\r\n            column = endColumn;\r\n            var possiblePosition = new Position(lineNumber, column);\r\n            if (cursor.selectionStart.containsPosition(possiblePosition)) {\r\n                column = cursor.selectionStart.startColumn;\r\n            }\r\n        }\r\n        return cursor.move(true, lineNumber, column, 0);\r\n    };\r\n    return WordOperations;\r\n}());\r\nexport { WordOperations };\r\nvar WordPartOperations = /** @class */ (function (_super) {\r\n    __extends(WordPartOperations, _super);\r\n    function WordPartOperations() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WordPartOperations.deleteWordPartLeft = function (wordSeparators, model, selection, whitespaceHeuristics) {\r\n        var candidates = enforceDefined([\r\n            WordOperations.deleteWordLeft(wordSeparators, model, selection, whitespaceHeuristics, 0 /* WordStart */),\r\n            WordOperations.deleteWordLeft(wordSeparators, model, selection, whitespaceHeuristics, 2 /* WordEnd */),\r\n            WordOperations._deleteWordPartLeft(model, selection)\r\n        ]);\r\n        candidates.sort(Range.compareRangesUsingEnds);\r\n        return candidates[2];\r\n    };\r\n    WordPartOperations.deleteWordPartRight = function (wordSeparators, model, selection, whitespaceHeuristics) {\r\n        var candidates = enforceDefined([\r\n            WordOperations.deleteWordRight(wordSeparators, model, selection, whitespaceHeuristics, 0 /* WordStart */),\r\n            WordOperations.deleteWordRight(wordSeparators, model, selection, whitespaceHeuristics, 2 /* WordEnd */),\r\n            WordOperations._deleteWordPartRight(model, selection)\r\n        ]);\r\n        candidates.sort(Range.compareRangesUsingStarts);\r\n        return candidates[0];\r\n    };\r\n    WordPartOperations.moveWordPartLeft = function (wordSeparators, model, position) {\r\n        var candidates = enforceDefined([\r\n            WordOperations.moveWordLeft(wordSeparators, model, position, 0 /* WordStart */),\r\n            WordOperations.moveWordLeft(wordSeparators, model, position, 2 /* WordEnd */),\r\n            WordOperations._moveWordPartLeft(model, position)\r\n        ]);\r\n        candidates.sort(Position.compare);\r\n        return candidates[2];\r\n    };\r\n    WordPartOperations.moveWordPartRight = function (wordSeparators, model, position) {\r\n        var candidates = enforceDefined([\r\n            WordOperations.moveWordRight(wordSeparators, model, position, 0 /* WordStart */),\r\n            WordOperations.moveWordRight(wordSeparators, model, position, 2 /* WordEnd */),\r\n            WordOperations._moveWordPartRight(model, position)\r\n        ]);\r\n        candidates.sort(Position.compare);\r\n        return candidates[0];\r\n    };\r\n    return WordPartOperations;\r\n}(WordOperations));\r\nexport { WordPartOperations };\r\nfunction enforceDefined(arr) {\r\n    return arr.filter(function (el) { return Boolean(el); });\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as types from '../../../base/common/types.js';\r\nimport { CursorState, SingleCursorState } from './cursorCommon.js';\r\nimport { MoveOperations } from './cursorMoveOperations.js';\r\nimport { WordOperations } from './cursorWordOperations.js';\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nvar CursorMoveCommands = /** @class */ (function () {\r\n    function CursorMoveCommands() {\r\n    }\r\n    CursorMoveCommands.addCursorDown = function (context, cursors, useLogicalLine) {\r\n        var result = [], resultLen = 0;\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            result[resultLen++] = new CursorState(cursor.modelState, cursor.viewState);\r\n            if (useLogicalLine) {\r\n                result[resultLen++] = CursorState.fromModelState(MoveOperations.translateDown(context.config, context.model, cursor.modelState));\r\n            }\r\n            else {\r\n                result[resultLen++] = CursorState.fromViewState(MoveOperations.translateDown(context.config, context.viewModel, cursor.viewState));\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands.addCursorUp = function (context, cursors, useLogicalLine) {\r\n        var result = [], resultLen = 0;\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            result[resultLen++] = new CursorState(cursor.modelState, cursor.viewState);\r\n            if (useLogicalLine) {\r\n                result[resultLen++] = CursorState.fromModelState(MoveOperations.translateUp(context.config, context.model, cursor.modelState));\r\n            }\r\n            else {\r\n                result[resultLen++] = CursorState.fromViewState(MoveOperations.translateUp(context.config, context.viewModel, cursor.viewState));\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands.moveToBeginningOfLine = function (context, cursors, inSelectionMode) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            result[i] = this._moveToLineStart(context, cursor, inSelectionMode);\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveToLineStart = function (context, cursor, inSelectionMode) {\r\n        var currentViewStateColumn = cursor.viewState.position.column;\r\n        var currentModelStateColumn = cursor.modelState.position.column;\r\n        var isFirstLineOfWrappedLine = currentViewStateColumn === currentModelStateColumn;\r\n        var currentViewStatelineNumber = cursor.viewState.position.lineNumber;\r\n        var firstNonBlankColumn = context.viewModel.getLineFirstNonWhitespaceColumn(currentViewStatelineNumber);\r\n        var isBeginningOfViewLine = currentViewStateColumn === firstNonBlankColumn;\r\n        if (!isFirstLineOfWrappedLine && !isBeginningOfViewLine) {\r\n            return this._moveToLineStartByView(context, cursor, inSelectionMode);\r\n        }\r\n        else {\r\n            return this._moveToLineStartByModel(context, cursor, inSelectionMode);\r\n        }\r\n    };\r\n    CursorMoveCommands._moveToLineStartByView = function (context, cursor, inSelectionMode) {\r\n        return CursorState.fromViewState(MoveOperations.moveToBeginningOfLine(context.config, context.viewModel, cursor.viewState, inSelectionMode));\r\n    };\r\n    CursorMoveCommands._moveToLineStartByModel = function (context, cursor, inSelectionMode) {\r\n        return CursorState.fromModelState(MoveOperations.moveToBeginningOfLine(context.config, context.model, cursor.modelState, inSelectionMode));\r\n    };\r\n    CursorMoveCommands.moveToEndOfLine = function (context, cursors, inSelectionMode) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            result[i] = this._moveToLineEnd(context, cursor, inSelectionMode);\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveToLineEnd = function (context, cursor, inSelectionMode) {\r\n        var viewStatePosition = cursor.viewState.position;\r\n        var viewModelMaxColumn = context.viewModel.getLineMaxColumn(viewStatePosition.lineNumber);\r\n        var isEndOfViewLine = viewStatePosition.column === viewModelMaxColumn;\r\n        var modelStatePosition = cursor.modelState.position;\r\n        var modelMaxColumn = context.model.getLineMaxColumn(modelStatePosition.lineNumber);\r\n        var isEndLineOfWrappedLine = viewModelMaxColumn - viewStatePosition.column === modelMaxColumn - modelStatePosition.column;\r\n        if (isEndOfViewLine || isEndLineOfWrappedLine) {\r\n            return this._moveToLineEndByModel(context, cursor, inSelectionMode);\r\n        }\r\n        else {\r\n            return this._moveToLineEndByView(context, cursor, inSelectionMode);\r\n        }\r\n    };\r\n    CursorMoveCommands._moveToLineEndByView = function (context, cursor, inSelectionMode) {\r\n        return CursorState.fromViewState(MoveOperations.moveToEndOfLine(context.config, context.viewModel, cursor.viewState, inSelectionMode));\r\n    };\r\n    CursorMoveCommands._moveToLineEndByModel = function (context, cursor, inSelectionMode) {\r\n        return CursorState.fromModelState(MoveOperations.moveToEndOfLine(context.config, context.model, cursor.modelState, inSelectionMode));\r\n    };\r\n    CursorMoveCommands.expandLineSelection = function (context, cursors) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            var viewSelection = cursor.viewState.selection;\r\n            var startLineNumber = viewSelection.startLineNumber;\r\n            var lineCount = context.viewModel.getLineCount();\r\n            var endLineNumber = viewSelection.endLineNumber;\r\n            var endColumn = void 0;\r\n            if (endLineNumber === lineCount) {\r\n                endColumn = context.viewModel.getLineMaxColumn(lineCount);\r\n            }\r\n            else {\r\n                endLineNumber++;\r\n                endColumn = 1;\r\n            }\r\n            result[i] = CursorState.fromViewState(new SingleCursorState(new Range(startLineNumber, 1, startLineNumber, 1), 0, new Position(endLineNumber, endColumn), 0));\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands.moveToBeginningOfBuffer = function (context, cursors, inSelectionMode) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            result[i] = CursorState.fromModelState(MoveOperations.moveToBeginningOfBuffer(context.config, context.model, cursor.modelState, inSelectionMode));\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands.moveToEndOfBuffer = function (context, cursors, inSelectionMode) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            result[i] = CursorState.fromModelState(MoveOperations.moveToEndOfBuffer(context.config, context.model, cursor.modelState, inSelectionMode));\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands.selectAll = function (context, cursor) {\r\n        var lineCount = context.model.getLineCount();\r\n        var maxColumn = context.model.getLineMaxColumn(lineCount);\r\n        return CursorState.fromModelState(new SingleCursorState(new Range(1, 1, 1, 1), 0, new Position(lineCount, maxColumn), 0));\r\n    };\r\n    CursorMoveCommands.line = function (context, cursor, inSelectionMode, _position, _viewPosition) {\r\n        var position = context.model.validatePosition(_position);\r\n        var viewPosition = (_viewPosition\r\n            ? context.validateViewPosition(new Position(_viewPosition.lineNumber, _viewPosition.column), position)\r\n            : context.convertModelPositionToViewPosition(position));\r\n        if (!inSelectionMode || !cursor.modelState.hasSelection()) {\r\n            // Entering line selection for the first time\r\n            var lineCount = context.model.getLineCount();\r\n            var selectToLineNumber = position.lineNumber + 1;\r\n            var selectToColumn = 1;\r\n            if (selectToLineNumber > lineCount) {\r\n                selectToLineNumber = lineCount;\r\n                selectToColumn = context.model.getLineMaxColumn(selectToLineNumber);\r\n            }\r\n            return CursorState.fromModelState(new SingleCursorState(new Range(position.lineNumber, 1, selectToLineNumber, selectToColumn), 0, new Position(selectToLineNumber, selectToColumn), 0));\r\n        }\r\n        // Continuing line selection\r\n        var enteringLineNumber = cursor.modelState.selectionStart.getStartPosition().lineNumber;\r\n        if (position.lineNumber < enteringLineNumber) {\r\n            return CursorState.fromViewState(cursor.viewState.move(cursor.modelState.hasSelection(), viewPosition.lineNumber, 1, 0));\r\n        }\r\n        else if (position.lineNumber > enteringLineNumber) {\r\n            var lineCount = context.viewModel.getLineCount();\r\n            var selectToViewLineNumber = viewPosition.lineNumber + 1;\r\n            var selectToViewColumn = 1;\r\n            if (selectToViewLineNumber > lineCount) {\r\n                selectToViewLineNumber = lineCount;\r\n                selectToViewColumn = context.viewModel.getLineMaxColumn(selectToViewLineNumber);\r\n            }\r\n            return CursorState.fromViewState(cursor.viewState.move(cursor.modelState.hasSelection(), selectToViewLineNumber, selectToViewColumn, 0));\r\n        }\r\n        else {\r\n            var endPositionOfSelectionStart = cursor.modelState.selectionStart.getEndPosition();\r\n            return CursorState.fromModelState(cursor.modelState.move(cursor.modelState.hasSelection(), endPositionOfSelectionStart.lineNumber, endPositionOfSelectionStart.column, 0));\r\n        }\r\n    };\r\n    CursorMoveCommands.word = function (context, cursor, inSelectionMode, _position) {\r\n        var position = context.model.validatePosition(_position);\r\n        return CursorState.fromModelState(WordOperations.word(context.config, context.model, cursor.modelState, inSelectionMode, position));\r\n    };\r\n    CursorMoveCommands.cancelSelection = function (context, cursor) {\r\n        if (!cursor.modelState.hasSelection()) {\r\n            return new CursorState(cursor.modelState, cursor.viewState);\r\n        }\r\n        var lineNumber = cursor.viewState.position.lineNumber;\r\n        var column = cursor.viewState.position.column;\r\n        return CursorState.fromViewState(new SingleCursorState(new Range(lineNumber, column, lineNumber, column), 0, new Position(lineNumber, column), 0));\r\n    };\r\n    CursorMoveCommands.moveTo = function (context, cursor, inSelectionMode, _position, _viewPosition) {\r\n        var position = context.model.validatePosition(_position);\r\n        var viewPosition = (_viewPosition\r\n            ? context.validateViewPosition(new Position(_viewPosition.lineNumber, _viewPosition.column), position)\r\n            : context.convertModelPositionToViewPosition(position));\r\n        return CursorState.fromViewState(cursor.viewState.move(inSelectionMode, viewPosition.lineNumber, viewPosition.column, 0));\r\n    };\r\n    CursorMoveCommands.move = function (context, cursors, args) {\r\n        var inSelectionMode = args.select;\r\n        var value = args.value;\r\n        switch (args.direction) {\r\n            case 0 /* Left */: {\r\n                if (args.unit === 4 /* HalfLine */) {\r\n                    // Move left by half the current line length\r\n                    return this._moveHalfLineLeft(context, cursors, inSelectionMode);\r\n                }\r\n                else {\r\n                    // Move left by `moveParams.value` columns\r\n                    return this._moveLeft(context, cursors, inSelectionMode, value);\r\n                }\r\n            }\r\n            case 1 /* Right */: {\r\n                if (args.unit === 4 /* HalfLine */) {\r\n                    // Move right by half the current line length\r\n                    return this._moveHalfLineRight(context, cursors, inSelectionMode);\r\n                }\r\n                else {\r\n                    // Move right by `moveParams.value` columns\r\n                    return this._moveRight(context, cursors, inSelectionMode, value);\r\n                }\r\n            }\r\n            case 2 /* Up */: {\r\n                if (args.unit === 2 /* WrappedLine */) {\r\n                    // Move up by view lines\r\n                    return this._moveUpByViewLines(context, cursors, inSelectionMode, value);\r\n                }\r\n                else {\r\n                    // Move up by model lines\r\n                    return this._moveUpByModelLines(context, cursors, inSelectionMode, value);\r\n                }\r\n            }\r\n            case 3 /* Down */: {\r\n                if (args.unit === 2 /* WrappedLine */) {\r\n                    // Move down by view lines\r\n                    return this._moveDownByViewLines(context, cursors, inSelectionMode, value);\r\n                }\r\n                else {\r\n                    // Move down by model lines\r\n                    return this._moveDownByModelLines(context, cursors, inSelectionMode, value);\r\n                }\r\n            }\r\n            case 4 /* WrappedLineStart */: {\r\n                // Move to the beginning of the current view line\r\n                return this._moveToViewMinColumn(context, cursors, inSelectionMode);\r\n            }\r\n            case 5 /* WrappedLineFirstNonWhitespaceCharacter */: {\r\n                // Move to the first non-whitespace column of the current view line\r\n                return this._moveToViewFirstNonWhitespaceColumn(context, cursors, inSelectionMode);\r\n            }\r\n            case 6 /* WrappedLineColumnCenter */: {\r\n                // Move to the \"center\" of the current view line\r\n                return this._moveToViewCenterColumn(context, cursors, inSelectionMode);\r\n            }\r\n            case 7 /* WrappedLineEnd */: {\r\n                // Move to the end of the current view line\r\n                return this._moveToViewMaxColumn(context, cursors, inSelectionMode);\r\n            }\r\n            case 8 /* WrappedLineLastNonWhitespaceCharacter */: {\r\n                // Move to the last non-whitespace column of the current view line\r\n                return this._moveToViewLastNonWhitespaceColumn(context, cursors, inSelectionMode);\r\n            }\r\n            case 9 /* ViewPortTop */: {\r\n                // Move to the nth line start in the viewport (from the top)\r\n                var cursor = cursors[0];\r\n                var visibleModelRange = context.getCompletelyVisibleModelRange();\r\n                var modelLineNumber = this._firstLineNumberInRange(context.model, visibleModelRange, value);\r\n                var modelColumn = context.model.getLineFirstNonWhitespaceColumn(modelLineNumber);\r\n                return [this._moveToModelPosition(context, cursor, inSelectionMode, modelLineNumber, modelColumn)];\r\n            }\r\n            case 11 /* ViewPortBottom */: {\r\n                // Move to the nth line start in the viewport (from the bottom)\r\n                var cursor = cursors[0];\r\n                var visibleModelRange = context.getCompletelyVisibleModelRange();\r\n                var modelLineNumber = this._lastLineNumberInRange(context.model, visibleModelRange, value);\r\n                var modelColumn = context.model.getLineFirstNonWhitespaceColumn(modelLineNumber);\r\n                return [this._moveToModelPosition(context, cursor, inSelectionMode, modelLineNumber, modelColumn)];\r\n            }\r\n            case 10 /* ViewPortCenter */: {\r\n                // Move to the line start in the viewport center\r\n                var cursor = cursors[0];\r\n                var visibleModelRange = context.getCompletelyVisibleModelRange();\r\n                var modelLineNumber = Math.round((visibleModelRange.startLineNumber + visibleModelRange.endLineNumber) / 2);\r\n                var modelColumn = context.model.getLineFirstNonWhitespaceColumn(modelLineNumber);\r\n                return [this._moveToModelPosition(context, cursor, inSelectionMode, modelLineNumber, modelColumn)];\r\n            }\r\n            case 12 /* ViewPortIfOutside */: {\r\n                // Move to a position inside the viewport\r\n                var visibleViewRange = context.getCompletelyVisibleViewRange();\r\n                var result = [];\r\n                for (var i = 0, len = cursors.length; i < len; i++) {\r\n                    var cursor = cursors[i];\r\n                    result[i] = this.findPositionInViewportIfOutside(context, cursor, visibleViewRange, inSelectionMode);\r\n                }\r\n                return result;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    CursorMoveCommands.findPositionInViewportIfOutside = function (context, cursor, visibleViewRange, inSelectionMode) {\r\n        var viewLineNumber = cursor.viewState.position.lineNumber;\r\n        if (visibleViewRange.startLineNumber <= viewLineNumber && viewLineNumber <= visibleViewRange.endLineNumber - 1) {\r\n            // Nothing to do, cursor is in viewport\r\n            return new CursorState(cursor.modelState, cursor.viewState);\r\n        }\r\n        else {\r\n            if (viewLineNumber > visibleViewRange.endLineNumber - 1) {\r\n                viewLineNumber = visibleViewRange.endLineNumber - 1;\r\n            }\r\n            if (viewLineNumber < visibleViewRange.startLineNumber) {\r\n                viewLineNumber = visibleViewRange.startLineNumber;\r\n            }\r\n            var viewColumn = context.viewModel.getLineFirstNonWhitespaceColumn(viewLineNumber);\r\n            return this._moveToViewPosition(context, cursor, inSelectionMode, viewLineNumber, viewColumn);\r\n        }\r\n    };\r\n    /**\r\n     * Find the nth line start included in the range (from the start).\r\n     */\r\n    CursorMoveCommands._firstLineNumberInRange = function (model, range, count) {\r\n        var startLineNumber = range.startLineNumber;\r\n        if (range.startColumn !== model.getLineMinColumn(startLineNumber)) {\r\n            // Move on to the second line if the first line start is not included in the range\r\n            startLineNumber++;\r\n        }\r\n        return Math.min(range.endLineNumber, startLineNumber + count - 1);\r\n    };\r\n    /**\r\n     * Find the nth line start included in the range (from the end).\r\n     */\r\n    CursorMoveCommands._lastLineNumberInRange = function (model, range, count) {\r\n        var startLineNumber = range.startLineNumber;\r\n        if (range.startColumn !== model.getLineMinColumn(startLineNumber)) {\r\n            // Move on to the second line if the first line start is not included in the range\r\n            startLineNumber++;\r\n        }\r\n        return Math.max(startLineNumber, range.endLineNumber - count + 1);\r\n    };\r\n    CursorMoveCommands._moveLeft = function (context, cursors, inSelectionMode, noOfColumns) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            var newViewState = MoveOperations.moveLeft(context.config, context.viewModel, cursor.viewState, inSelectionMode, noOfColumns);\r\n            if (noOfColumns === 1 && newViewState.position.lineNumber !== cursor.viewState.position.lineNumber) {\r\n                // moved over to the previous view line\r\n                var newViewModelPosition = context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(newViewState.position);\r\n                if (newViewModelPosition.lineNumber === cursor.modelState.position.lineNumber) {\r\n                    // stayed on the same model line => pass wrapping point where 2 view positions map to a single model position\r\n                    newViewState = MoveOperations.moveLeft(context.config, context.viewModel, newViewState, inSelectionMode, 1);\r\n                }\r\n            }\r\n            result[i] = CursorState.fromViewState(newViewState);\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveHalfLineLeft = function (context, cursors, inSelectionMode) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            var viewLineNumber = cursor.viewState.position.lineNumber;\r\n            var halfLine = Math.round(context.viewModel.getLineContent(viewLineNumber).length / 2);\r\n            result[i] = CursorState.fromViewState(MoveOperations.moveLeft(context.config, context.viewModel, cursor.viewState, inSelectionMode, halfLine));\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveRight = function (context, cursors, inSelectionMode, noOfColumns) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            var newViewState = MoveOperations.moveRight(context.config, context.viewModel, cursor.viewState, inSelectionMode, noOfColumns);\r\n            if (noOfColumns === 1 && newViewState.position.lineNumber !== cursor.viewState.position.lineNumber) {\r\n                // moved over to the next view line\r\n                var newViewModelPosition = context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(newViewState.position);\r\n                if (newViewModelPosition.lineNumber === cursor.modelState.position.lineNumber) {\r\n                    // stayed on the same model line => pass wrapping point where 2 view positions map to a single model position\r\n                    newViewState = MoveOperations.moveRight(context.config, context.viewModel, newViewState, inSelectionMode, 1);\r\n                }\r\n            }\r\n            result[i] = CursorState.fromViewState(newViewState);\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveHalfLineRight = function (context, cursors, inSelectionMode) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            var viewLineNumber = cursor.viewState.position.lineNumber;\r\n            var halfLine = Math.round(context.viewModel.getLineContent(viewLineNumber).length / 2);\r\n            result[i] = CursorState.fromViewState(MoveOperations.moveRight(context.config, context.viewModel, cursor.viewState, inSelectionMode, halfLine));\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveDownByViewLines = function (context, cursors, inSelectionMode, linesCount) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            result[i] = CursorState.fromViewState(MoveOperations.moveDown(context.config, context.viewModel, cursor.viewState, inSelectionMode, linesCount));\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveDownByModelLines = function (context, cursors, inSelectionMode, linesCount) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            result[i] = CursorState.fromModelState(MoveOperations.moveDown(context.config, context.model, cursor.modelState, inSelectionMode, linesCount));\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveUpByViewLines = function (context, cursors, inSelectionMode, linesCount) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            result[i] = CursorState.fromViewState(MoveOperations.moveUp(context.config, context.viewModel, cursor.viewState, inSelectionMode, linesCount));\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveUpByModelLines = function (context, cursors, inSelectionMode, linesCount) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            result[i] = CursorState.fromModelState(MoveOperations.moveUp(context.config, context.model, cursor.modelState, inSelectionMode, linesCount));\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveToViewPosition = function (context, cursor, inSelectionMode, toViewLineNumber, toViewColumn) {\r\n        return CursorState.fromViewState(cursor.viewState.move(inSelectionMode, toViewLineNumber, toViewColumn, 0));\r\n    };\r\n    CursorMoveCommands._moveToModelPosition = function (context, cursor, inSelectionMode, toModelLineNumber, toModelColumn) {\r\n        return CursorState.fromModelState(cursor.modelState.move(inSelectionMode, toModelLineNumber, toModelColumn, 0));\r\n    };\r\n    CursorMoveCommands._moveToViewMinColumn = function (context, cursors, inSelectionMode) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            var viewLineNumber = cursor.viewState.position.lineNumber;\r\n            var viewColumn = context.viewModel.getLineMinColumn(viewLineNumber);\r\n            result[i] = this._moveToViewPosition(context, cursor, inSelectionMode, viewLineNumber, viewColumn);\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveToViewFirstNonWhitespaceColumn = function (context, cursors, inSelectionMode) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            var viewLineNumber = cursor.viewState.position.lineNumber;\r\n            var viewColumn = context.viewModel.getLineFirstNonWhitespaceColumn(viewLineNumber);\r\n            result[i] = this._moveToViewPosition(context, cursor, inSelectionMode, viewLineNumber, viewColumn);\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveToViewCenterColumn = function (context, cursors, inSelectionMode) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            var viewLineNumber = cursor.viewState.position.lineNumber;\r\n            var viewColumn = Math.round((context.viewModel.getLineMaxColumn(viewLineNumber) + context.viewModel.getLineMinColumn(viewLineNumber)) / 2);\r\n            result[i] = this._moveToViewPosition(context, cursor, inSelectionMode, viewLineNumber, viewColumn);\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveToViewMaxColumn = function (context, cursors, inSelectionMode) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            var viewLineNumber = cursor.viewState.position.lineNumber;\r\n            var viewColumn = context.viewModel.getLineMaxColumn(viewLineNumber);\r\n            result[i] = this._moveToViewPosition(context, cursor, inSelectionMode, viewLineNumber, viewColumn);\r\n        }\r\n        return result;\r\n    };\r\n    CursorMoveCommands._moveToViewLastNonWhitespaceColumn = function (context, cursors, inSelectionMode) {\r\n        var result = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            var cursor = cursors[i];\r\n            var viewLineNumber = cursor.viewState.position.lineNumber;\r\n            var viewColumn = context.viewModel.getLineLastNonWhitespaceColumn(viewLineNumber);\r\n            result[i] = this._moveToViewPosition(context, cursor, inSelectionMode, viewLineNumber, viewColumn);\r\n        }\r\n        return result;\r\n    };\r\n    return CursorMoveCommands;\r\n}());\r\nexport { CursorMoveCommands };\r\nexport var CursorMove;\r\n(function (CursorMove) {\r\n    var isCursorMoveArgs = function (arg) {\r\n        if (!types.isObject(arg)) {\r\n            return false;\r\n        }\r\n        var cursorMoveArg = arg;\r\n        if (!types.isString(cursorMoveArg.to)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(cursorMoveArg.select) && !types.isBoolean(cursorMoveArg.select)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(cursorMoveArg.by) && !types.isString(cursorMoveArg.by)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(cursorMoveArg.value) && !types.isNumber(cursorMoveArg.value)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    CursorMove.description = {\r\n        description: 'Move cursor to a logical position in the view',\r\n        args: [\r\n            {\r\n                name: 'Cursor move argument object',\r\n                description: \"Property-value pairs that can be passed through this argument:\\n\\t\\t\\t\\t\\t* 'to': A mandatory logical position value providing where to move the cursor.\\n\\t\\t\\t\\t\\t\\t```\\n\\t\\t\\t\\t\\t\\t'left', 'right', 'up', 'down'\\n\\t\\t\\t\\t\\t\\t'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'\\n\\t\\t\\t\\t\\t\\t'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'\\n\\t\\t\\t\\t\\t\\t'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'\\n\\t\\t\\t\\t\\t\\t```\\n\\t\\t\\t\\t\\t* 'by': Unit to move. Default is computed based on 'to' value.\\n\\t\\t\\t\\t\\t\\t```\\n\\t\\t\\t\\t\\t\\t'line', 'wrappedLine', 'character', 'halfLine'\\n\\t\\t\\t\\t\\t\\t```\\n\\t\\t\\t\\t\\t* 'value': Number of units to move. Default is '1'.\\n\\t\\t\\t\\t\\t* 'select': If 'true' makes the selection. Default is 'false'.\\n\\t\\t\\t\\t\",\r\n                constraint: isCursorMoveArgs\r\n            }\r\n        ]\r\n    };\r\n    /**\r\n     * Positions in the view for cursor move command.\r\n     */\r\n    CursorMove.RawDirection = {\r\n        Left: 'left',\r\n        Right: 'right',\r\n        Up: 'up',\r\n        Down: 'down',\r\n        WrappedLineStart: 'wrappedLineStart',\r\n        WrappedLineFirstNonWhitespaceCharacter: 'wrappedLineFirstNonWhitespaceCharacter',\r\n        WrappedLineColumnCenter: 'wrappedLineColumnCenter',\r\n        WrappedLineEnd: 'wrappedLineEnd',\r\n        WrappedLineLastNonWhitespaceCharacter: 'wrappedLineLastNonWhitespaceCharacter',\r\n        ViewPortTop: 'viewPortTop',\r\n        ViewPortCenter: 'viewPortCenter',\r\n        ViewPortBottom: 'viewPortBottom',\r\n        ViewPortIfOutside: 'viewPortIfOutside'\r\n    };\r\n    /**\r\n     * Units for Cursor move 'by' argument\r\n     */\r\n    CursorMove.RawUnit = {\r\n        Line: 'line',\r\n        WrappedLine: 'wrappedLine',\r\n        Character: 'character',\r\n        HalfLine: 'halfLine'\r\n    };\r\n    function parse(args) {\r\n        if (!args.to) {\r\n            // illegal arguments\r\n            return null;\r\n        }\r\n        var direction;\r\n        switch (args.to) {\r\n            case CursorMove.RawDirection.Left:\r\n                direction = 0 /* Left */;\r\n                break;\r\n            case CursorMove.RawDirection.Right:\r\n                direction = 1 /* Right */;\r\n                break;\r\n            case CursorMove.RawDirection.Up:\r\n                direction = 2 /* Up */;\r\n                break;\r\n            case CursorMove.RawDirection.Down:\r\n                direction = 3 /* Down */;\r\n                break;\r\n            case CursorMove.RawDirection.WrappedLineStart:\r\n                direction = 4 /* WrappedLineStart */;\r\n                break;\r\n            case CursorMove.RawDirection.WrappedLineFirstNonWhitespaceCharacter:\r\n                direction = 5 /* WrappedLineFirstNonWhitespaceCharacter */;\r\n                break;\r\n            case CursorMove.RawDirection.WrappedLineColumnCenter:\r\n                direction = 6 /* WrappedLineColumnCenter */;\r\n                break;\r\n            case CursorMove.RawDirection.WrappedLineEnd:\r\n                direction = 7 /* WrappedLineEnd */;\r\n                break;\r\n            case CursorMove.RawDirection.WrappedLineLastNonWhitespaceCharacter:\r\n                direction = 8 /* WrappedLineLastNonWhitespaceCharacter */;\r\n                break;\r\n            case CursorMove.RawDirection.ViewPortTop:\r\n                direction = 9 /* ViewPortTop */;\r\n                break;\r\n            case CursorMove.RawDirection.ViewPortBottom:\r\n                direction = 11 /* ViewPortBottom */;\r\n                break;\r\n            case CursorMove.RawDirection.ViewPortCenter:\r\n                direction = 10 /* ViewPortCenter */;\r\n                break;\r\n            case CursorMove.RawDirection.ViewPortIfOutside:\r\n                direction = 12 /* ViewPortIfOutside */;\r\n                break;\r\n            default:\r\n                // illegal arguments\r\n                return null;\r\n        }\r\n        var unit = 0 /* None */;\r\n        switch (args.by) {\r\n            case CursorMove.RawUnit.Line:\r\n                unit = 1 /* Line */;\r\n                break;\r\n            case CursorMove.RawUnit.WrappedLine:\r\n                unit = 2 /* WrappedLine */;\r\n                break;\r\n            case CursorMove.RawUnit.Character:\r\n                unit = 3 /* Character */;\r\n                break;\r\n            case CursorMove.RawUnit.HalfLine:\r\n                unit = 4 /* HalfLine */;\r\n                break;\r\n        }\r\n        return {\r\n            direction: direction,\r\n            unit: unit,\r\n            select: (!!args.select),\r\n            value: (args.value || 1)\r\n        };\r\n    }\r\n    CursorMove.parse = parse;\r\n})(CursorMove || (CursorMove = {}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { CursorColumns } from '../controller/cursorCommon.js';\r\nimport { Range } from '../core/range.js';\r\nimport { Selection } from '../core/selection.js';\r\nimport { LanguageConfigurationRegistry } from '../modes/languageConfigurationRegistry.js';\r\nvar ShiftCommand = /** @class */ (function () {\r\n    function ShiftCommand(range, opts) {\r\n        this._opts = opts;\r\n        this._selection = range;\r\n        this._useLastEditRangeForCursorEndPosition = false;\r\n        this._selectionStartColumnStaysPut = false;\r\n    }\r\n    ShiftCommand.unshiftIndentCount = function (line, column, tabSize) {\r\n        // Determine the visible column where the content starts\r\n        var contentStartVisibleColumn = CursorColumns.visibleColumnFromColumn(line, column, tabSize);\r\n        var desiredTabStop = CursorColumns.prevTabStop(contentStartVisibleColumn, tabSize);\r\n        // The `desiredTabStop` is a multiple of `tabSize` => determine the number of indents\r\n        return desiredTabStop / tabSize;\r\n    };\r\n    ShiftCommand.shiftIndentCount = function (line, column, tabSize) {\r\n        // Determine the visible column where the content starts\r\n        var contentStartVisibleColumn = CursorColumns.visibleColumnFromColumn(line, column, tabSize);\r\n        var desiredTabStop = CursorColumns.nextTabStop(contentStartVisibleColumn, tabSize);\r\n        // The `desiredTabStop` is a multiple of `tabSize` => determine the number of indents\r\n        return desiredTabStop / tabSize;\r\n    };\r\n    ShiftCommand.prototype._addEditOperation = function (builder, range, text) {\r\n        if (this._useLastEditRangeForCursorEndPosition) {\r\n            builder.addTrackedEditOperation(range, text);\r\n        }\r\n        else {\r\n            builder.addEditOperation(range, text);\r\n        }\r\n    };\r\n    ShiftCommand.prototype.getEditOperations = function (model, builder) {\r\n        var startLine = this._selection.startLineNumber;\r\n        var endLine = this._selection.endLineNumber;\r\n        if (this._selection.endColumn === 1 && startLine !== endLine) {\r\n            endLine = endLine - 1;\r\n        }\r\n        var tabSize = this._opts.tabSize;\r\n        var oneIndent = this._opts.oneIndent;\r\n        var shouldIndentEmptyLines = (startLine === endLine);\r\n        // if indenting or outdenting on a whitespace only line\r\n        if (this._selection.isEmpty()) {\r\n            if (/^\\s*$/.test(model.getLineContent(startLine))) {\r\n                this._useLastEditRangeForCursorEndPosition = true;\r\n            }\r\n        }\r\n        if (this._opts.useTabStops) {\r\n            // indents[i] represents i * oneIndent\r\n            var indents = ['', oneIndent];\r\n            // keep track of previous line's \"miss-alignment\"\r\n            var previousLineExtraSpaces = 0, extraSpaces = 0;\r\n            for (var lineNumber = startLine; lineNumber <= endLine; lineNumber++, previousLineExtraSpaces = extraSpaces) {\r\n                extraSpaces = 0;\r\n                var lineText = model.getLineContent(lineNumber);\r\n                var indentationEndIndex = strings.firstNonWhitespaceIndex(lineText);\r\n                if (this._opts.isUnshift && (lineText.length === 0 || indentationEndIndex === 0)) {\r\n                    // empty line or line with no leading whitespace => nothing to do\r\n                    continue;\r\n                }\r\n                if (!shouldIndentEmptyLines && !this._opts.isUnshift && lineText.length === 0) {\r\n                    // do not indent empty lines => nothing to do\r\n                    continue;\r\n                }\r\n                if (indentationEndIndex === -1) {\r\n                    // the entire line is whitespace\r\n                    indentationEndIndex = lineText.length;\r\n                }\r\n                if (lineNumber > 1) {\r\n                    var contentStartVisibleColumn = CursorColumns.visibleColumnFromColumn(lineText, indentationEndIndex + 1, tabSize);\r\n                    if (contentStartVisibleColumn % tabSize !== 0) {\r\n                        // The current line is \"miss-aligned\", so let's see if this is expected...\r\n                        // This can only happen when it has trailing commas in the indent\r\n                        if (model.isCheapToTokenize(lineNumber - 1)) {\r\n                            var enterAction = LanguageConfigurationRegistry.getRawEnterActionAtPosition(model, lineNumber - 1, model.getLineMaxColumn(lineNumber - 1));\r\n                            if (enterAction) {\r\n                                extraSpaces = previousLineExtraSpaces;\r\n                                if (enterAction.appendText) {\r\n                                    for (var j = 0, lenJ = enterAction.appendText.length; j < lenJ && extraSpaces < tabSize; j++) {\r\n                                        if (enterAction.appendText.charCodeAt(j) === 32 /* Space */) {\r\n                                            extraSpaces++;\r\n                                        }\r\n                                        else {\r\n                                            break;\r\n                                        }\r\n                                    }\r\n                                }\r\n                                if (enterAction.removeText) {\r\n                                    extraSpaces = Math.max(0, extraSpaces - enterAction.removeText);\r\n                                }\r\n                                // Act as if `prefixSpaces` is not part of the indentation\r\n                                for (var j = 0; j < extraSpaces; j++) {\r\n                                    if (indentationEndIndex === 0 || lineText.charCodeAt(indentationEndIndex - 1) !== 32 /* Space */) {\r\n                                        break;\r\n                                    }\r\n                                    indentationEndIndex--;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                if (this._opts.isUnshift && indentationEndIndex === 0) {\r\n                    // line with no leading whitespace => nothing to do\r\n                    continue;\r\n                }\r\n                var desiredIndentCount = void 0;\r\n                if (this._opts.isUnshift) {\r\n                    desiredIndentCount = ShiftCommand.unshiftIndentCount(lineText, indentationEndIndex + 1, tabSize);\r\n                }\r\n                else {\r\n                    desiredIndentCount = ShiftCommand.shiftIndentCount(lineText, indentationEndIndex + 1, tabSize);\r\n                }\r\n                // Fill `indents`, as needed\r\n                for (var j = indents.length; j <= desiredIndentCount; j++) {\r\n                    indents[j] = indents[j - 1] + oneIndent;\r\n                }\r\n                this._addEditOperation(builder, new Range(lineNumber, 1, lineNumber, indentationEndIndex + 1), indents[desiredIndentCount]);\r\n                if (lineNumber === startLine) {\r\n                    // Force the startColumn to stay put because we're inserting after it\r\n                    this._selectionStartColumnStaysPut = (this._selection.startColumn <= indentationEndIndex + 1);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (var lineNumber = startLine; lineNumber <= endLine; lineNumber++) {\r\n                var lineText = model.getLineContent(lineNumber);\r\n                var indentationEndIndex = strings.firstNonWhitespaceIndex(lineText);\r\n                if (this._opts.isUnshift && (lineText.length === 0 || indentationEndIndex === 0)) {\r\n                    // empty line or line with no leading whitespace => nothing to do\r\n                    continue;\r\n                }\r\n                if (!shouldIndentEmptyLines && !this._opts.isUnshift && lineText.length === 0) {\r\n                    // do not indent empty lines => nothing to do\r\n                    continue;\r\n                }\r\n                if (indentationEndIndex === -1) {\r\n                    // the entire line is whitespace\r\n                    indentationEndIndex = lineText.length;\r\n                }\r\n                if (this._opts.isUnshift && indentationEndIndex === 0) {\r\n                    // line with no leading whitespace => nothing to do\r\n                    continue;\r\n                }\r\n                if (this._opts.isUnshift) {\r\n                    indentationEndIndex = Math.min(indentationEndIndex, tabSize);\r\n                    for (var i = 0; i < indentationEndIndex; i++) {\r\n                        var chr = lineText.charCodeAt(i);\r\n                        if (chr === 9 /* Tab */) {\r\n                            indentationEndIndex = i + 1;\r\n                            break;\r\n                        }\r\n                    }\r\n                    this._addEditOperation(builder, new Range(lineNumber, 1, lineNumber, indentationEndIndex + 1), '');\r\n                }\r\n                else {\r\n                    this._addEditOperation(builder, new Range(lineNumber, 1, lineNumber, 1), oneIndent);\r\n                    if (lineNumber === startLine) {\r\n                        // Force the startColumn to stay put because we're inserting after it\r\n                        this._selectionStartColumnStaysPut = (this._selection.startColumn === 1);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(this._selection);\r\n    };\r\n    ShiftCommand.prototype.computeCursorState = function (model, helper) {\r\n        if (this._useLastEditRangeForCursorEndPosition) {\r\n            var lastOp = helper.getInverseEditOperations()[0];\r\n            return new Selection(lastOp.range.endLineNumber, lastOp.range.endColumn, lastOp.range.endLineNumber, lastOp.range.endColumn);\r\n        }\r\n        var result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._selectionStartColumnStaysPut) {\r\n            // The selection start should not move\r\n            var initialStartColumn = this._selection.startColumn;\r\n            var resultStartColumn = result.startColumn;\r\n            if (resultStartColumn <= initialStartColumn) {\r\n                return result;\r\n            }\r\n            if (result.getDirection() === 0 /* LTR */) {\r\n                return new Selection(result.startLineNumber, initialStartColumn, result.endLineNumber, result.endColumn);\r\n            }\r\n            return new Selection(result.endLineNumber, result.endColumn, result.startLineNumber, initialStartColumn);\r\n        }\r\n        return result;\r\n    };\r\n    return ShiftCommand;\r\n}());\r\nexport { ShiftCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../core/range.js';\r\nimport { Selection } from '../core/selection.js';\r\nvar SurroundSelectionCommand = /** @class */ (function () {\r\n    function SurroundSelectionCommand(range, charBeforeSelection, charAfterSelection) {\r\n        this._range = range;\r\n        this._charBeforeSelection = charBeforeSelection;\r\n        this._charAfterSelection = charAfterSelection;\r\n    }\r\n    SurroundSelectionCommand.prototype.getEditOperations = function (model, builder) {\r\n        builder.addTrackedEditOperation(new Range(this._range.startLineNumber, this._range.startColumn, this._range.startLineNumber, this._range.startColumn), this._charBeforeSelection);\r\n        builder.addTrackedEditOperation(new Range(this._range.endLineNumber, this._range.endColumn, this._range.endLineNumber, this._range.endColumn), this._charAfterSelection);\r\n    };\r\n    SurroundSelectionCommand.prototype.computeCursorState = function (model, helper) {\r\n        var inverseEditOperations = helper.getInverseEditOperations();\r\n        var firstOperationRange = inverseEditOperations[0].range;\r\n        var secondOperationRange = inverseEditOperations[1].range;\r\n        return new Selection(firstOperationRange.endLineNumber, firstOperationRange.endColumn, secondOperationRange.endLineNumber, secondOperationRange.endColumn - this._charAfterSelection.length);\r\n    };\r\n    return SurroundSelectionCommand;\r\n}());\r\nexport { SurroundSelectionCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { ReplaceCommand, ReplaceCommandWithOffsetCursorState, ReplaceCommandWithoutChangingPosition } from '../commands/replaceCommand.js';\r\nimport { ShiftCommand } from '../commands/shiftCommand.js';\r\nimport { SurroundSelectionCommand } from '../commands/surroundSelectionCommand.js';\r\nimport { CursorColumns, EditOperationResult, isQuote } from './cursorCommon.js';\r\nimport { getMapForWordSeparators } from './wordCharacterClassifier.js';\r\nimport { Range } from '../core/range.js';\r\nimport { IndentAction } from '../modes/languageConfiguration.js';\r\nimport { LanguageConfigurationRegistry } from '../modes/languageConfigurationRegistry.js';\r\nvar TypeOperations = /** @class */ (function () {\r\n    function TypeOperations() {\r\n    }\r\n    TypeOperations.indent = function (config, model, selections) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            commands[i] = new ShiftCommand(selections[i], {\r\n                isUnshift: false,\r\n                tabSize: config.tabSize,\r\n                oneIndent: config.oneIndent,\r\n                useTabStops: config.useTabStops\r\n            });\r\n        }\r\n        return commands;\r\n    };\r\n    TypeOperations.outdent = function (config, model, selections) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            commands[i] = new ShiftCommand(selections[i], {\r\n                isUnshift: true,\r\n                tabSize: config.tabSize,\r\n                oneIndent: config.oneIndent,\r\n                useTabStops: config.useTabStops\r\n            });\r\n        }\r\n        return commands;\r\n    };\r\n    TypeOperations.shiftIndent = function (config, indentation, count) {\r\n        count = count || 1;\r\n        var desiredIndentCount = ShiftCommand.shiftIndentCount(indentation, indentation.length + count, config.tabSize);\r\n        var newIndentation = '';\r\n        for (var i = 0; i < desiredIndentCount; i++) {\r\n            newIndentation += '\\t';\r\n        }\r\n        return newIndentation;\r\n    };\r\n    TypeOperations.unshiftIndent = function (config, indentation, count) {\r\n        count = count || 1;\r\n        var desiredIndentCount = ShiftCommand.unshiftIndentCount(indentation, indentation.length + count, config.tabSize);\r\n        var newIndentation = '';\r\n        for (var i = 0; i < desiredIndentCount; i++) {\r\n            newIndentation += '\\t';\r\n        }\r\n        return newIndentation;\r\n    };\r\n    TypeOperations._distributedPaste = function (config, model, selections, text) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            commands[i] = new ReplaceCommand(selections[i], text[i]);\r\n        }\r\n        return new EditOperationResult(0 /* Other */, commands, {\r\n            shouldPushStackElementBefore: true,\r\n            shouldPushStackElementAfter: true\r\n        });\r\n    };\r\n    TypeOperations._simplePaste = function (config, model, selections, text, pasteOnNewLine) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            var position = selection.getPosition();\r\n            if (pasteOnNewLine && text.indexOf('\\n') !== text.length - 1) {\r\n                pasteOnNewLine = false;\r\n            }\r\n            if (pasteOnNewLine && selection.startLineNumber !== selection.endLineNumber) {\r\n                pasteOnNewLine = false;\r\n            }\r\n            if (pasteOnNewLine && selection.startColumn === model.getLineMinColumn(selection.startLineNumber) && selection.endColumn === model.getLineMaxColumn(selection.startLineNumber)) {\r\n                pasteOnNewLine = false;\r\n            }\r\n            if (pasteOnNewLine) {\r\n                // Paste entire line at the beginning of line\r\n                var typeSelection = new Range(position.lineNumber, 1, position.lineNumber, 1);\r\n                commands[i] = new ReplaceCommand(typeSelection, text);\r\n            }\r\n            else {\r\n                commands[i] = new ReplaceCommand(selection, text);\r\n            }\r\n        }\r\n        return new EditOperationResult(0 /* Other */, commands, {\r\n            shouldPushStackElementBefore: true,\r\n            shouldPushStackElementAfter: true\r\n        });\r\n    };\r\n    TypeOperations._distributePasteToCursors = function (selections, text, pasteOnNewLine, multicursorText) {\r\n        if (pasteOnNewLine) {\r\n            return null;\r\n        }\r\n        if (selections.length === 1) {\r\n            return null;\r\n        }\r\n        if (multicursorText && multicursorText.length === selections.length) {\r\n            return multicursorText;\r\n        }\r\n        // Remove trailing \\n if present\r\n        if (text.charCodeAt(text.length - 1) === 10 /* LineFeed */) {\r\n            text = text.substr(0, text.length - 1);\r\n        }\r\n        var lines = text.split(/\\r\\n|\\r|\\n/);\r\n        if (lines.length === selections.length) {\r\n            return lines;\r\n        }\r\n        return null;\r\n    };\r\n    TypeOperations.paste = function (config, model, selections, text, pasteOnNewLine, multicursorText) {\r\n        var distributedPaste = this._distributePasteToCursors(selections, text, pasteOnNewLine, multicursorText);\r\n        if (distributedPaste) {\r\n            selections = selections.sort(Range.compareRangesUsingStarts);\r\n            return this._distributedPaste(config, model, selections, distributedPaste);\r\n        }\r\n        else {\r\n            return this._simplePaste(config, model, selections, text, pasteOnNewLine);\r\n        }\r\n    };\r\n    TypeOperations._goodIndentForLine = function (config, model, lineNumber) {\r\n        var action = null;\r\n        var indentation = '';\r\n        var expectedIndentAction = config.autoIndent ? LanguageConfigurationRegistry.getInheritIndentForLine(model, lineNumber, false) : null;\r\n        if (expectedIndentAction) {\r\n            action = expectedIndentAction.action;\r\n            indentation = expectedIndentAction.indentation;\r\n        }\r\n        else if (lineNumber > 1) {\r\n            var lastLineNumber = lineNumber - 1;\r\n            for (lastLineNumber = lineNumber - 1; lastLineNumber >= 1; lastLineNumber--) {\r\n                var lineText = model.getLineContent(lastLineNumber);\r\n                var nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineText);\r\n                if (nonWhitespaceIdx >= 0) {\r\n                    break;\r\n                }\r\n            }\r\n            if (lastLineNumber < 1) {\r\n                // No previous line with content found\r\n                return null;\r\n            }\r\n            var maxColumn = model.getLineMaxColumn(lastLineNumber);\r\n            var expectedEnterAction = LanguageConfigurationRegistry.getEnterAction(model, new Range(lastLineNumber, maxColumn, lastLineNumber, maxColumn));\r\n            if (expectedEnterAction) {\r\n                indentation = expectedEnterAction.indentation;\r\n                action = expectedEnterAction.enterAction;\r\n                if (action) {\r\n                    indentation += action.appendText;\r\n                }\r\n            }\r\n        }\r\n        if (action) {\r\n            if (action === IndentAction.Indent) {\r\n                indentation = TypeOperations.shiftIndent(config, indentation);\r\n            }\r\n            if (action === IndentAction.Outdent) {\r\n                indentation = TypeOperations.unshiftIndent(config, indentation);\r\n            }\r\n            indentation = config.normalizeIndentation(indentation);\r\n        }\r\n        if (!indentation) {\r\n            return null;\r\n        }\r\n        return indentation;\r\n    };\r\n    TypeOperations._replaceJumpToNextIndent = function (config, model, selection, insertsAutoWhitespace) {\r\n        var typeText = '';\r\n        var position = selection.getStartPosition();\r\n        if (config.insertSpaces) {\r\n            var visibleColumnFromColumn = CursorColumns.visibleColumnFromColumn2(config, model, position);\r\n            var tabSize = config.tabSize;\r\n            var spacesCnt = tabSize - (visibleColumnFromColumn % tabSize);\r\n            for (var i = 0; i < spacesCnt; i++) {\r\n                typeText += ' ';\r\n            }\r\n        }\r\n        else {\r\n            typeText = '\\t';\r\n        }\r\n        return new ReplaceCommand(selection, typeText, insertsAutoWhitespace);\r\n    };\r\n    TypeOperations.tab = function (config, model, selections) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (selection.isEmpty()) {\r\n                var lineText = model.getLineContent(selection.startLineNumber);\r\n                if (/^\\s*$/.test(lineText) && model.isCheapToTokenize(selection.startLineNumber)) {\r\n                    var goodIndent = this._goodIndentForLine(config, model, selection.startLineNumber);\r\n                    goodIndent = goodIndent || '\\t';\r\n                    var possibleTypeText = config.normalizeIndentation(goodIndent);\r\n                    if (!strings.startsWith(lineText, possibleTypeText)) {\r\n                        commands[i] = new ReplaceCommand(new Range(selection.startLineNumber, 1, selection.startLineNumber, lineText.length + 1), possibleTypeText, true);\r\n                        continue;\r\n                    }\r\n                }\r\n                commands[i] = this._replaceJumpToNextIndent(config, model, selection, true);\r\n            }\r\n            else {\r\n                if (selection.startLineNumber === selection.endLineNumber) {\r\n                    var lineMaxColumn = model.getLineMaxColumn(selection.startLineNumber);\r\n                    if (selection.startColumn !== 1 || selection.endColumn !== lineMaxColumn) {\r\n                        // This is a single line selection that is not the entire line\r\n                        commands[i] = this._replaceJumpToNextIndent(config, model, selection, false);\r\n                        continue;\r\n                    }\r\n                }\r\n                commands[i] = new ShiftCommand(selection, {\r\n                    isUnshift: false,\r\n                    tabSize: config.tabSize,\r\n                    oneIndent: config.oneIndent,\r\n                    useTabStops: config.useTabStops\r\n                });\r\n            }\r\n        }\r\n        return commands;\r\n    };\r\n    TypeOperations.replacePreviousChar = function (prevEditOperationType, config, model, selections, txt, replaceCharCnt) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (!selection.isEmpty()) {\r\n                // looks like https://github.com/Microsoft/vscode/issues/2773\r\n                // where a cursor operation occurred before a canceled composition\r\n                // => ignore composition\r\n                commands[i] = null;\r\n                continue;\r\n            }\r\n            var pos = selection.getPosition();\r\n            var startColumn = Math.max(1, pos.column - replaceCharCnt);\r\n            var range = new Range(pos.lineNumber, startColumn, pos.lineNumber, pos.column);\r\n            commands[i] = new ReplaceCommand(range, txt);\r\n        }\r\n        return new EditOperationResult(1 /* Typing */, commands, {\r\n            shouldPushStackElementBefore: (prevEditOperationType !== 1 /* Typing */),\r\n            shouldPushStackElementAfter: false\r\n        });\r\n    };\r\n    TypeOperations._typeCommand = function (range, text, keepPosition) {\r\n        if (keepPosition) {\r\n            return new ReplaceCommandWithoutChangingPosition(range, text, true);\r\n        }\r\n        else {\r\n            return new ReplaceCommand(range, text, true);\r\n        }\r\n    };\r\n    TypeOperations._enter = function (config, model, keepPosition, range) {\r\n        if (!model.isCheapToTokenize(range.getStartPosition().lineNumber)) {\r\n            var lineText_1 = model.getLineContent(range.startLineNumber);\r\n            var indentation_1 = strings.getLeadingWhitespace(lineText_1).substring(0, range.startColumn - 1);\r\n            return TypeOperations._typeCommand(range, '\\n' + config.normalizeIndentation(indentation_1), keepPosition);\r\n        }\r\n        var r = LanguageConfigurationRegistry.getEnterAction(model, range);\r\n        if (r) {\r\n            var enterAction = r.enterAction;\r\n            var indentation_2 = r.indentation;\r\n            if (enterAction.indentAction === IndentAction.None) {\r\n                // Nothing special\r\n                return TypeOperations._typeCommand(range, '\\n' + config.normalizeIndentation(indentation_2 + enterAction.appendText), keepPosition);\r\n            }\r\n            else if (enterAction.indentAction === IndentAction.Indent) {\r\n                // Indent once\r\n                return TypeOperations._typeCommand(range, '\\n' + config.normalizeIndentation(indentation_2 + enterAction.appendText), keepPosition);\r\n            }\r\n            else if (enterAction.indentAction === IndentAction.IndentOutdent) {\r\n                // Ultra special\r\n                var normalIndent = config.normalizeIndentation(indentation_2);\r\n                var increasedIndent = config.normalizeIndentation(indentation_2 + enterAction.appendText);\r\n                var typeText = '\\n' + increasedIndent + '\\n' + normalIndent;\r\n                if (keepPosition) {\r\n                    return new ReplaceCommandWithoutChangingPosition(range, typeText, true);\r\n                }\r\n                else {\r\n                    return new ReplaceCommandWithOffsetCursorState(range, typeText, -1, increasedIndent.length - normalIndent.length, true);\r\n                }\r\n            }\r\n            else if (enterAction.indentAction === IndentAction.Outdent) {\r\n                var actualIndentation = TypeOperations.unshiftIndent(config, indentation_2);\r\n                return TypeOperations._typeCommand(range, '\\n' + config.normalizeIndentation(actualIndentation + enterAction.appendText), keepPosition);\r\n            }\r\n        }\r\n        // no enter rules applied, we should check indentation rules then.\r\n        if (!config.autoIndent) {\r\n            // Nothing special\r\n            var lineText_2 = model.getLineContent(range.startLineNumber);\r\n            var indentation_3 = strings.getLeadingWhitespace(lineText_2).substring(0, range.startColumn - 1);\r\n            return TypeOperations._typeCommand(range, '\\n' + config.normalizeIndentation(indentation_3), keepPosition);\r\n        }\r\n        var ir = LanguageConfigurationRegistry.getIndentForEnter(model, range, {\r\n            unshiftIndent: function (indent) {\r\n                return TypeOperations.unshiftIndent(config, indent);\r\n            },\r\n            shiftIndent: function (indent) {\r\n                return TypeOperations.shiftIndent(config, indent);\r\n            },\r\n            normalizeIndentation: function (indent) {\r\n                return config.normalizeIndentation(indent);\r\n            }\r\n        }, config.autoIndent);\r\n        var lineText = model.getLineContent(range.startLineNumber);\r\n        var indentation = strings.getLeadingWhitespace(lineText).substring(0, range.startColumn - 1);\r\n        if (ir) {\r\n            var oldEndViewColumn = CursorColumns.visibleColumnFromColumn2(config, model, range.getEndPosition());\r\n            var oldEndColumn = range.endColumn;\r\n            var beforeText = '\\n';\r\n            if (indentation !== config.normalizeIndentation(ir.beforeEnter)) {\r\n                beforeText = config.normalizeIndentation(ir.beforeEnter) + lineText.substring(indentation.length, range.startColumn - 1) + '\\n';\r\n                range = new Range(range.startLineNumber, 1, range.endLineNumber, range.endColumn);\r\n            }\r\n            var newLineContent = model.getLineContent(range.endLineNumber);\r\n            var firstNonWhitespace = strings.firstNonWhitespaceIndex(newLineContent);\r\n            if (firstNonWhitespace >= 0) {\r\n                range = range.setEndPosition(range.endLineNumber, Math.max(range.endColumn, firstNonWhitespace + 1));\r\n            }\r\n            else {\r\n                range = range.setEndPosition(range.endLineNumber, model.getLineMaxColumn(range.endLineNumber));\r\n            }\r\n            if (keepPosition) {\r\n                return new ReplaceCommandWithoutChangingPosition(range, beforeText + config.normalizeIndentation(ir.afterEnter), true);\r\n            }\r\n            else {\r\n                var offset = 0;\r\n                if (oldEndColumn <= firstNonWhitespace + 1) {\r\n                    if (!config.insertSpaces) {\r\n                        oldEndViewColumn = Math.ceil(oldEndViewColumn / config.tabSize);\r\n                    }\r\n                    offset = Math.min(oldEndViewColumn + 1 - config.normalizeIndentation(ir.afterEnter).length - 1, 0);\r\n                }\r\n                return new ReplaceCommandWithOffsetCursorState(range, beforeText + config.normalizeIndentation(ir.afterEnter), 0, offset, true);\r\n            }\r\n        }\r\n        else {\r\n            return TypeOperations._typeCommand(range, '\\n' + config.normalizeIndentation(indentation), keepPosition);\r\n        }\r\n    };\r\n    TypeOperations._isAutoIndentType = function (config, model, selections) {\r\n        if (!config.autoIndent) {\r\n            return false;\r\n        }\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            if (!model.isCheapToTokenize(selections[i].getEndPosition().lineNumber)) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    TypeOperations._runAutoIndentType = function (config, model, range, ch) {\r\n        var currentIndentation = LanguageConfigurationRegistry.getIndentationAtPosition(model, range.startLineNumber, range.startColumn);\r\n        var actualIndentation = LanguageConfigurationRegistry.getIndentActionForType(model, range, ch, {\r\n            shiftIndent: function (indentation) {\r\n                return TypeOperations.shiftIndent(config, indentation);\r\n            },\r\n            unshiftIndent: function (indentation) {\r\n                return TypeOperations.unshiftIndent(config, indentation);\r\n            },\r\n        });\r\n        if (actualIndentation === null) {\r\n            return null;\r\n        }\r\n        if (actualIndentation !== config.normalizeIndentation(currentIndentation)) {\r\n            var firstNonWhitespace = model.getLineFirstNonWhitespaceColumn(range.startLineNumber);\r\n            if (firstNonWhitespace === 0) {\r\n                return TypeOperations._typeCommand(new Range(range.startLineNumber, 0, range.endLineNumber, range.endColumn), config.normalizeIndentation(actualIndentation) + ch, false);\r\n            }\r\n            else {\r\n                return TypeOperations._typeCommand(new Range(range.startLineNumber, 0, range.endLineNumber, range.endColumn), config.normalizeIndentation(actualIndentation) +\r\n                    model.getLineContent(range.startLineNumber).substring(firstNonWhitespace - 1, range.startColumn - 1) + ch, false);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TypeOperations._isAutoClosingCloseCharType = function (config, model, selections, ch) {\r\n        var autoCloseConfig = isQuote(ch) ? config.autoClosingQuotes : config.autoClosingBrackets;\r\n        if (autoCloseConfig === 'never' || !config.autoClosingPairsClose.hasOwnProperty(ch)) {\r\n            return false;\r\n        }\r\n        var isEqualPair = (ch === config.autoClosingPairsClose[ch]);\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (!selection.isEmpty()) {\r\n                return false;\r\n            }\r\n            var position = selection.getPosition();\r\n            var lineText = model.getLineContent(position.lineNumber);\r\n            var afterCharacter = lineText.charAt(position.column - 1);\r\n            if (afterCharacter !== ch) {\r\n                return false;\r\n            }\r\n            if (isEqualPair) {\r\n                var lineTextBeforeCursor = lineText.substr(0, position.column - 1);\r\n                var chCntBefore = this._countNeedlesInHaystack(lineTextBeforeCursor, ch);\r\n                if (chCntBefore % 2 === 0) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    TypeOperations._countNeedlesInHaystack = function (haystack, needle) {\r\n        var cnt = 0;\r\n        var lastIndex = -1;\r\n        while ((lastIndex = haystack.indexOf(needle, lastIndex + 1)) !== -1) {\r\n            cnt++;\r\n        }\r\n        return cnt;\r\n    };\r\n    TypeOperations._runAutoClosingCloseCharType = function (prevEditOperationType, config, model, selections, ch) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            var position = selection.getPosition();\r\n            var typeSelection = new Range(position.lineNumber, position.column, position.lineNumber, position.column + 1);\r\n            commands[i] = new ReplaceCommand(typeSelection, ch);\r\n        }\r\n        return new EditOperationResult(1 /* Typing */, commands, {\r\n            shouldPushStackElementBefore: (prevEditOperationType !== 1 /* Typing */),\r\n            shouldPushStackElementAfter: false\r\n        });\r\n    };\r\n    TypeOperations._isBeforeClosingBrace = function (config, ch, characterAfter) {\r\n        var thisBraceIsSymmetric = (config.autoClosingPairsOpen[ch] === ch);\r\n        var isBeforeCloseBrace = false;\r\n        for (var otherCloseBrace in config.autoClosingPairsClose) {\r\n            var otherBraceIsSymmetric = (config.autoClosingPairsOpen[otherCloseBrace] === otherCloseBrace);\r\n            if (!thisBraceIsSymmetric && otherBraceIsSymmetric) {\r\n                continue;\r\n            }\r\n            if (characterAfter === otherCloseBrace) {\r\n                isBeforeCloseBrace = true;\r\n                break;\r\n            }\r\n        }\r\n        return isBeforeCloseBrace;\r\n    };\r\n    TypeOperations._isAutoClosingOpenCharType = function (config, model, selections, ch) {\r\n        var chIsQuote = isQuote(ch);\r\n        var autoCloseConfig = chIsQuote ? config.autoClosingQuotes : config.autoClosingBrackets;\r\n        if (autoCloseConfig === 'never' || !config.autoClosingPairsOpen.hasOwnProperty(ch)) {\r\n            return false;\r\n        }\r\n        var shouldAutoCloseBefore = chIsQuote ? config.shouldAutoCloseBefore.quote : config.shouldAutoCloseBefore.bracket;\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (!selection.isEmpty()) {\r\n                return false;\r\n            }\r\n            var position = selection.getPosition();\r\n            var lineText = model.getLineContent(position.lineNumber);\r\n            // Do not auto-close ' or \" after a word character\r\n            if (chIsQuote && position.column > 1) {\r\n                var wordSeparators = getMapForWordSeparators(config.wordSeparators);\r\n                var characterBeforeCode = lineText.charCodeAt(position.column - 2);\r\n                var characterBeforeType = wordSeparators.get(characterBeforeCode);\r\n                if (characterBeforeType === 0 /* Regular */) {\r\n                    return false;\r\n                }\r\n            }\r\n            // Only consider auto closing the pair if a space follows or if another autoclosed pair follows\r\n            var characterAfter = lineText.charAt(position.column - 1);\r\n            if (characterAfter) {\r\n                var isBeforeCloseBrace = TypeOperations._isBeforeClosingBrace(config, ch, characterAfter);\r\n                if (!isBeforeCloseBrace && !shouldAutoCloseBefore(characterAfter)) {\r\n                    return false;\r\n                }\r\n            }\r\n            if (!model.isCheapToTokenize(position.lineNumber)) {\r\n                // Do not force tokenization\r\n                return false;\r\n            }\r\n            model.forceTokenization(position.lineNumber);\r\n            var lineTokens = model.getLineTokens(position.lineNumber);\r\n            var shouldAutoClosePair = false;\r\n            try {\r\n                shouldAutoClosePair = LanguageConfigurationRegistry.shouldAutoClosePair(ch, lineTokens, position.column);\r\n            }\r\n            catch (e) {\r\n                onUnexpectedError(e);\r\n            }\r\n            if (!shouldAutoClosePair) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    TypeOperations._runAutoClosingOpenCharType = function (prevEditOperationType, config, model, selections, ch) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            var closeCharacter = config.autoClosingPairsOpen[ch];\r\n            commands[i] = new ReplaceCommandWithOffsetCursorState(selection, ch + closeCharacter, 0, -closeCharacter.length);\r\n        }\r\n        return new EditOperationResult(1 /* Typing */, commands, {\r\n            shouldPushStackElementBefore: true,\r\n            shouldPushStackElementAfter: false\r\n        });\r\n    };\r\n    TypeOperations._shouldSurroundChar = function (config, ch) {\r\n        if (isQuote(ch)) {\r\n            return (config.autoSurround === 'quotes' || config.autoSurround === 'languageDefined');\r\n        }\r\n        else {\r\n            // Character is a bracket\r\n            return (config.autoSurround === 'brackets' || config.autoSurround === 'languageDefined');\r\n        }\r\n    };\r\n    TypeOperations._isSurroundSelectionType = function (config, model, selections, ch) {\r\n        if (!TypeOperations._shouldSurroundChar(config, ch) || !config.surroundingPairs.hasOwnProperty(ch)) {\r\n            return false;\r\n        }\r\n        var isTypingAQuoteCharacter = isQuote(ch);\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (selection.isEmpty()) {\r\n                return false;\r\n            }\r\n            var selectionContainsOnlyWhitespace = true;\r\n            for (var lineNumber = selection.startLineNumber; lineNumber <= selection.endLineNumber; lineNumber++) {\r\n                var lineText = model.getLineContent(lineNumber);\r\n                var startIndex = (lineNumber === selection.startLineNumber ? selection.startColumn - 1 : 0);\r\n                var endIndex = (lineNumber === selection.endLineNumber ? selection.endColumn - 1 : lineText.length);\r\n                var selectedText = lineText.substring(startIndex, endIndex);\r\n                if (/[^ \\t]/.test(selectedText)) {\r\n                    // this selected text contains something other than whitespace\r\n                    selectionContainsOnlyWhitespace = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (selectionContainsOnlyWhitespace) {\r\n                return false;\r\n            }\r\n            if (isTypingAQuoteCharacter && selection.startLineNumber === selection.endLineNumber && selection.startColumn + 1 === selection.endColumn) {\r\n                var selectionText = model.getValueInRange(selection);\r\n                if (isQuote(selectionText)) {\r\n                    // Typing a quote character on top of another quote character\r\n                    // => disable surround selection type\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    TypeOperations._runSurroundSelectionType = function (prevEditOperationType, config, model, selections, ch) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            var closeCharacter = config.surroundingPairs[ch];\r\n            commands[i] = new SurroundSelectionCommand(selection, ch, closeCharacter);\r\n        }\r\n        return new EditOperationResult(0 /* Other */, commands, {\r\n            shouldPushStackElementBefore: true,\r\n            shouldPushStackElementAfter: true\r\n        });\r\n    };\r\n    TypeOperations._isTypeInterceptorElectricChar = function (config, model, selections) {\r\n        if (selections.length === 1 && model.isCheapToTokenize(selections[0].getEndPosition().lineNumber)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    TypeOperations._typeInterceptorElectricChar = function (prevEditOperationType, config, model, selection, ch) {\r\n        if (!config.electricChars.hasOwnProperty(ch) || !selection.isEmpty()) {\r\n            return null;\r\n        }\r\n        var position = selection.getPosition();\r\n        model.forceTokenization(position.lineNumber);\r\n        var lineTokens = model.getLineTokens(position.lineNumber);\r\n        var electricAction;\r\n        try {\r\n            electricAction = LanguageConfigurationRegistry.onElectricCharacter(ch, lineTokens, position.column);\r\n        }\r\n        catch (e) {\r\n            onUnexpectedError(e);\r\n            return null;\r\n        }\r\n        if (!electricAction) {\r\n            return null;\r\n        }\r\n        if (electricAction.appendText) {\r\n            var command = new ReplaceCommandWithOffsetCursorState(selection, ch + electricAction.appendText, 0, -electricAction.appendText.length);\r\n            return new EditOperationResult(1 /* Typing */, [command], {\r\n                shouldPushStackElementBefore: false,\r\n                shouldPushStackElementAfter: true\r\n            });\r\n        }\r\n        if (electricAction.matchOpenBracket) {\r\n            var endColumn = (lineTokens.getLineContent() + ch).lastIndexOf(electricAction.matchOpenBracket) + 1;\r\n            var match = model.findMatchingBracketUp(electricAction.matchOpenBracket, {\r\n                lineNumber: position.lineNumber,\r\n                column: endColumn\r\n            });\r\n            if (match) {\r\n                if (match.startLineNumber === position.lineNumber) {\r\n                    // matched something on the same line => no change in indentation\r\n                    return null;\r\n                }\r\n                var matchLine = model.getLineContent(match.startLineNumber);\r\n                var matchLineIndentation = strings.getLeadingWhitespace(matchLine);\r\n                var newIndentation = config.normalizeIndentation(matchLineIndentation);\r\n                var lineText = model.getLineContent(position.lineNumber);\r\n                var lineFirstNonBlankColumn = model.getLineFirstNonWhitespaceColumn(position.lineNumber) || position.column;\r\n                var prefix = lineText.substring(lineFirstNonBlankColumn - 1, position.column - 1);\r\n                var typeText = newIndentation + prefix + ch;\r\n                var typeSelection = new Range(position.lineNumber, 1, position.lineNumber, position.column);\r\n                var command = new ReplaceCommand(typeSelection, typeText);\r\n                return new EditOperationResult(1 /* Typing */, [command], {\r\n                    shouldPushStackElementBefore: false,\r\n                    shouldPushStackElementAfter: true\r\n                });\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TypeOperations.compositionEndWithInterceptors = function (prevEditOperationType, config, model, selections) {\r\n        if (config.autoClosingQuotes === 'never') {\r\n            return null;\r\n        }\r\n        var commands = [];\r\n        for (var i = 0; i < selections.length; i++) {\r\n            if (!selections[i].isEmpty()) {\r\n                continue;\r\n            }\r\n            var position = selections[i].getPosition();\r\n            var lineText = model.getLineContent(position.lineNumber);\r\n            var ch = lineText.charAt(position.column - 2);\r\n            if (config.autoClosingPairsClose.hasOwnProperty(ch)) { // first of all, it's a closing tag\r\n                if (ch === config.autoClosingPairsClose[ch] /** isEqualPair */) {\r\n                    var lineTextBeforeCursor = lineText.substr(0, position.column - 2);\r\n                    var chCntBefore = this._countNeedlesInHaystack(lineTextBeforeCursor, ch);\r\n                    if (chCntBefore % 2 === 1) {\r\n                        continue; // it pairs with the opening tag.\r\n                    }\r\n                }\r\n            }\r\n            // As we are not typing in a new character, so we don't need to run `_runAutoClosingCloseCharType`\r\n            // Next step, let's try to check if it's an open char.\r\n            if (config.autoClosingPairsOpen.hasOwnProperty(ch)) {\r\n                if (isQuote(ch) && position.column > 2) {\r\n                    var wordSeparators = getMapForWordSeparators(config.wordSeparators);\r\n                    var characterBeforeCode = lineText.charCodeAt(position.column - 3);\r\n                    var characterBeforeType = wordSeparators.get(characterBeforeCode);\r\n                    if (characterBeforeType === 0 /* Regular */) {\r\n                        continue;\r\n                    }\r\n                }\r\n                var characterAfter = lineText.charAt(position.column - 1);\r\n                if (characterAfter) {\r\n                    var isBeforeCloseBrace = TypeOperations._isBeforeClosingBrace(config, ch, characterAfter);\r\n                    var shouldAutoCloseBefore = isQuote(ch) ? config.shouldAutoCloseBefore.quote : config.shouldAutoCloseBefore.bracket;\r\n                    if (isBeforeCloseBrace) {\r\n                        // In normal auto closing logic, we will auto close if the cursor is even before a closing brace intentionally.\r\n                        // However for composition mode, we do nothing here as users might clear all the characters for composition and we don't want to do a unnecessary auto close.\r\n                        // Related: microsoft/vscode#57250.\r\n                        continue;\r\n                    }\r\n                    if (!shouldAutoCloseBefore(characterAfter)) {\r\n                        continue;\r\n                    }\r\n                }\r\n                if (!model.isCheapToTokenize(position.lineNumber)) {\r\n                    // Do not force tokenization\r\n                    continue;\r\n                }\r\n                model.forceTokenization(position.lineNumber);\r\n                var lineTokens = model.getLineTokens(position.lineNumber);\r\n                var shouldAutoClosePair = false;\r\n                try {\r\n                    shouldAutoClosePair = LanguageConfigurationRegistry.shouldAutoClosePair(ch, lineTokens, position.column - 1);\r\n                }\r\n                catch (e) {\r\n                    onUnexpectedError(e);\r\n                }\r\n                if (shouldAutoClosePair) {\r\n                    var closeCharacter = config.autoClosingPairsOpen[ch];\r\n                    commands[i] = new ReplaceCommandWithOffsetCursorState(selections[i], closeCharacter, 0, -closeCharacter.length);\r\n                }\r\n            }\r\n        }\r\n        return new EditOperationResult(1 /* Typing */, commands, {\r\n            shouldPushStackElementBefore: true,\r\n            shouldPushStackElementAfter: false\r\n        });\r\n    };\r\n    TypeOperations.typeWithInterceptors = function (prevEditOperationType, config, model, selections, ch) {\r\n        if (ch === '\\n') {\r\n            var commands_1 = [];\r\n            for (var i = 0, len = selections.length; i < len; i++) {\r\n                commands_1[i] = TypeOperations._enter(config, model, false, selections[i]);\r\n            }\r\n            return new EditOperationResult(1 /* Typing */, commands_1, {\r\n                shouldPushStackElementBefore: true,\r\n                shouldPushStackElementAfter: false,\r\n            });\r\n        }\r\n        if (this._isAutoIndentType(config, model, selections)) {\r\n            var commands_2 = [];\r\n            var autoIndentFails = false;\r\n            for (var i = 0, len = selections.length; i < len; i++) {\r\n                commands_2[i] = this._runAutoIndentType(config, model, selections[i], ch);\r\n                if (!commands_2[i]) {\r\n                    autoIndentFails = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!autoIndentFails) {\r\n                return new EditOperationResult(1 /* Typing */, commands_2, {\r\n                    shouldPushStackElementBefore: true,\r\n                    shouldPushStackElementAfter: false,\r\n                });\r\n            }\r\n        }\r\n        if (this._isAutoClosingCloseCharType(config, model, selections, ch)) {\r\n            return this._runAutoClosingCloseCharType(prevEditOperationType, config, model, selections, ch);\r\n        }\r\n        if (this._isAutoClosingOpenCharType(config, model, selections, ch)) {\r\n            return this._runAutoClosingOpenCharType(prevEditOperationType, config, model, selections, ch);\r\n        }\r\n        if (this._isSurroundSelectionType(config, model, selections, ch)) {\r\n            return this._runSurroundSelectionType(prevEditOperationType, config, model, selections, ch);\r\n        }\r\n        // Electric characters make sense only when dealing with a single cursor,\r\n        // as multiple cursors typing brackets for example would interfer with bracket matching\r\n        if (this._isTypeInterceptorElectricChar(config, model, selections)) {\r\n            var r = this._typeInterceptorElectricChar(prevEditOperationType, config, model, selections[0], ch);\r\n            if (r) {\r\n                return r;\r\n            }\r\n        }\r\n        // A simple character type\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            commands[i] = new ReplaceCommand(selections[i], ch);\r\n        }\r\n        var shouldPushStackElementBefore = (prevEditOperationType !== 1 /* Typing */);\r\n        if (ch === ' ') {\r\n            shouldPushStackElementBefore = true;\r\n        }\r\n        return new EditOperationResult(1 /* Typing */, commands, {\r\n            shouldPushStackElementBefore: shouldPushStackElementBefore,\r\n            shouldPushStackElementAfter: false\r\n        });\r\n    };\r\n    TypeOperations.typeWithoutInterceptors = function (prevEditOperationType, config, model, selections, str) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            commands[i] = new ReplaceCommand(selections[i], str);\r\n        }\r\n        return new EditOperationResult(1 /* Typing */, commands, {\r\n            shouldPushStackElementBefore: (prevEditOperationType !== 1 /* Typing */),\r\n            shouldPushStackElementAfter: false\r\n        });\r\n    };\r\n    TypeOperations.lineInsertBefore = function (config, model, selections) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var lineNumber = selections[i].positionLineNumber;\r\n            if (lineNumber === 1) {\r\n                commands[i] = new ReplaceCommandWithoutChangingPosition(new Range(1, 1, 1, 1), '\\n');\r\n            }\r\n            else {\r\n                lineNumber--;\r\n                var column = model.getLineMaxColumn(lineNumber);\r\n                commands[i] = this._enter(config, model, false, new Range(lineNumber, column, lineNumber, column));\r\n            }\r\n        }\r\n        return commands;\r\n    };\r\n    TypeOperations.lineInsertAfter = function (config, model, selections) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var lineNumber = selections[i].positionLineNumber;\r\n            var column = model.getLineMaxColumn(lineNumber);\r\n            commands[i] = this._enter(config, model, false, new Range(lineNumber, column, lineNumber, column));\r\n        }\r\n        return commands;\r\n    };\r\n    TypeOperations.lineBreakInsert = function (config, model, selections) {\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            commands[i] = this._enter(config, model, true, selections[i]);\r\n        }\r\n        return commands;\r\n    };\r\n    return TypeOperations;\r\n}());\r\nexport { TypeOperations };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { RawContextKey } from '../../platform/contextkey/common/contextkey.js';\r\nexport var EditorContextKeys;\r\n(function (EditorContextKeys) {\r\n    /**\r\n     * A context key that is set when the editor's text has focus (cursor is blinking).\r\n     */\r\n    EditorContextKeys.editorTextFocus = new RawContextKey('editorTextFocus', false);\r\n    /**\r\n     * A context key that is set when the editor's text or an editor's widget has focus.\r\n     */\r\n    EditorContextKeys.focus = new RawContextKey('editorFocus', false);\r\n    /**\r\n     * A context key that is set when any editor input has focus (regular editor, repl input...).\r\n     */\r\n    EditorContextKeys.textInputFocus = new RawContextKey('textInputFocus', false);\r\n    EditorContextKeys.readOnly = new RawContextKey('editorReadonly', false);\r\n    EditorContextKeys.writable = EditorContextKeys.readOnly.toNegated();\r\n    EditorContextKeys.hasNonEmptySelection = new RawContextKey('editorHasSelection', false);\r\n    EditorContextKeys.hasOnlyEmptySelection = EditorContextKeys.hasNonEmptySelection.toNegated();\r\n    EditorContextKeys.hasMultipleSelections = new RawContextKey('editorHasMultipleSelections', false);\r\n    EditorContextKeys.hasSingleSelection = EditorContextKeys.hasMultipleSelections.toNegated();\r\n    EditorContextKeys.tabMovesFocus = new RawContextKey('editorTabMovesFocus', false);\r\n    EditorContextKeys.tabDoesNotMoveFocus = EditorContextKeys.tabMovesFocus.toNegated();\r\n    EditorContextKeys.isInEmbeddedEditor = new RawContextKey('isInEmbeddedEditor', false);\r\n    EditorContextKeys.canUndo = new RawContextKey('canUndo', false);\r\n    EditorContextKeys.canRedo = new RawContextKey('canRedo', false);\r\n    // -- mode context keys\r\n    EditorContextKeys.languageId = new RawContextKey('editorLangId', '');\r\n    EditorContextKeys.hasCompletionItemProvider = new RawContextKey('editorHasCompletionItemProvider', false);\r\n    EditorContextKeys.hasCodeActionsProvider = new RawContextKey('editorHasCodeActionsProvider', false);\r\n    EditorContextKeys.hasCodeLensProvider = new RawContextKey('editorHasCodeLensProvider', false);\r\n    EditorContextKeys.hasDefinitionProvider = new RawContextKey('editorHasDefinitionProvider', false);\r\n    EditorContextKeys.hasImplementationProvider = new RawContextKey('editorHasImplementationProvider', false);\r\n    EditorContextKeys.hasTypeDefinitionProvider = new RawContextKey('editorHasTypeDefinitionProvider', false);\r\n    EditorContextKeys.hasHoverProvider = new RawContextKey('editorHasHoverProvider', false);\r\n    EditorContextKeys.hasDocumentHighlightProvider = new RawContextKey('editorHasDocumentHighlightProvider', false);\r\n    EditorContextKeys.hasDocumentSymbolProvider = new RawContextKey('editorHasDocumentSymbolProvider', false);\r\n    EditorContextKeys.hasReferenceProvider = new RawContextKey('editorHasReferenceProvider', false);\r\n    EditorContextKeys.hasRenameProvider = new RawContextKey('editorHasRenameProvider', false);\r\n    EditorContextKeys.hasDocumentFormattingProvider = new RawContextKey('editorHasDocumentFormattingProvider', false);\r\n    EditorContextKeys.hasDocumentSelectionFormattingProvider = new RawContextKey('editorHasDocumentSelectionFormattingProvider', false);\r\n    EditorContextKeys.hasSignatureHelpProvider = new RawContextKey('editorHasSignatureHelpProvider', false);\r\n})(EditorContextKeys || (EditorContextKeys = {}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport * as types from '../../../base/common/types.js';\r\nimport { Command, EditorCommand, registerEditorCommand } from '../editorExtensions.js';\r\nimport { ICodeEditorService } from '../services/codeEditorService.js';\r\nimport { ColumnSelection } from '../../common/controller/cursorColumnSelection.js';\r\nimport { CursorState } from '../../common/controller/cursorCommon.js';\r\nimport { DeleteOperations } from '../../common/controller/cursorDeleteOperations.js';\r\nimport { CursorMove as CursorMove_, CursorMoveCommands } from '../../common/controller/cursorMoveCommands.js';\r\nimport { TypeOperations } from '../../common/controller/cursorTypeOperations.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Handler } from '../../common/editorCommon.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MenuId } from '../../../platform/actions/common/actions.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nvar CORE_WEIGHT = 0 /* EditorCore */;\r\nvar CoreEditorCommand = /** @class */ (function (_super) {\r\n    __extends(CoreEditorCommand, _super);\r\n    function CoreEditorCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    CoreEditorCommand.prototype.runEditorCommand = function (accessor, editor, args) {\r\n        var cursors = editor._getCursors();\r\n        if (!cursors) {\r\n            // the editor has no view => has no cursors\r\n            return;\r\n        }\r\n        this.runCoreEditorCommand(cursors, args || {});\r\n    };\r\n    return CoreEditorCommand;\r\n}(EditorCommand));\r\nexport { CoreEditorCommand };\r\nexport var EditorScroll_;\r\n(function (EditorScroll_) {\r\n    var isEditorScrollArgs = function (arg) {\r\n        if (!types.isObject(arg)) {\r\n            return false;\r\n        }\r\n        var scrollArg = arg;\r\n        if (!types.isString(scrollArg.to)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(scrollArg.by) && !types.isString(scrollArg.by)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(scrollArg.value) && !types.isNumber(scrollArg.value)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(scrollArg.revealCursor) && !types.isBoolean(scrollArg.revealCursor)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    EditorScroll_.description = {\r\n        description: 'Scroll editor in the given direction',\r\n        args: [\r\n            {\r\n                name: 'Editor scroll argument object',\r\n                description: \"Property-value pairs that can be passed through this argument:\\n\\t\\t\\t\\t\\t* 'to': A mandatory direction value.\\n\\t\\t\\t\\t\\t\\t```\\n\\t\\t\\t\\t\\t\\t'up', 'down'\\n\\t\\t\\t\\t\\t\\t```\\n\\t\\t\\t\\t\\t* 'by': Unit to move. Default is computed based on 'to' value.\\n\\t\\t\\t\\t\\t\\t```\\n\\t\\t\\t\\t\\t\\t'line', 'wrappedLine', 'page', 'halfPage'\\n\\t\\t\\t\\t\\t\\t```\\n\\t\\t\\t\\t\\t* 'value': Number of units to move. Default is '1'.\\n\\t\\t\\t\\t\\t* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\\n\\t\\t\\t\\t\",\r\n                constraint: isEditorScrollArgs\r\n            }\r\n        ]\r\n    };\r\n    /**\r\n     * Directions in the view for editor scroll command.\r\n     */\r\n    EditorScroll_.RawDirection = {\r\n        Up: 'up',\r\n        Down: 'down',\r\n    };\r\n    /**\r\n     * Units for editor scroll 'by' argument\r\n     */\r\n    EditorScroll_.RawUnit = {\r\n        Line: 'line',\r\n        WrappedLine: 'wrappedLine',\r\n        Page: 'page',\r\n        HalfPage: 'halfPage'\r\n    };\r\n    function parse(args) {\r\n        var direction;\r\n        switch (args.to) {\r\n            case EditorScroll_.RawDirection.Up:\r\n                direction = 1 /* Up */;\r\n                break;\r\n            case EditorScroll_.RawDirection.Down:\r\n                direction = 2 /* Down */;\r\n                break;\r\n            default:\r\n                // Illegal arguments\r\n                return null;\r\n        }\r\n        var unit;\r\n        switch (args.by) {\r\n            case EditorScroll_.RawUnit.Line:\r\n                unit = 1 /* Line */;\r\n                break;\r\n            case EditorScroll_.RawUnit.WrappedLine:\r\n                unit = 2 /* WrappedLine */;\r\n                break;\r\n            case EditorScroll_.RawUnit.Page:\r\n                unit = 3 /* Page */;\r\n                break;\r\n            case EditorScroll_.RawUnit.HalfPage:\r\n                unit = 4 /* HalfPage */;\r\n                break;\r\n            default:\r\n                unit = 2 /* WrappedLine */;\r\n        }\r\n        var value = Math.floor(args.value || 1);\r\n        var revealCursor = !!args.revealCursor;\r\n        return {\r\n            direction: direction,\r\n            unit: unit,\r\n            value: value,\r\n            revealCursor: revealCursor,\r\n            select: (!!args.select)\r\n        };\r\n    }\r\n    EditorScroll_.parse = parse;\r\n})(EditorScroll_ || (EditorScroll_ = {}));\r\nexport var RevealLine_;\r\n(function (RevealLine_) {\r\n    var isRevealLineArgs = function (arg) {\r\n        if (!types.isObject(arg)) {\r\n            return false;\r\n        }\r\n        var reveaLineArg = arg;\r\n        if (!types.isNumber(reveaLineArg.lineNumber)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(reveaLineArg.at) && !types.isString(reveaLineArg.at)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    RevealLine_.description = {\r\n        description: 'Reveal the given line at the given logical position',\r\n        args: [\r\n            {\r\n                name: 'Reveal line argument object',\r\n                description: \"Property-value pairs that can be passed through this argument:\\n\\t\\t\\t\\t\\t* 'lineNumber': A mandatory line number value.\\n\\t\\t\\t\\t\\t* 'at': Logical position at which line has to be revealed .\\n\\t\\t\\t\\t\\t\\t```\\n\\t\\t\\t\\t\\t\\t'top', 'center', 'bottom'\\n\\t\\t\\t\\t\\t\\t```\\n\\t\\t\\t\\t\",\r\n                constraint: isRevealLineArgs\r\n            }\r\n        ]\r\n    };\r\n    /**\r\n     * Values for reveal line 'at' argument\r\n     */\r\n    RevealLine_.RawAtArgument = {\r\n        Top: 'top',\r\n        Center: 'center',\r\n        Bottom: 'bottom'\r\n    };\r\n})(RevealLine_ || (RevealLine_ = {}));\r\nexport var CoreNavigationCommands;\r\n(function (CoreNavigationCommands) {\r\n    var BaseMoveToCommand = /** @class */ (function (_super) {\r\n        __extends(BaseMoveToCommand, _super);\r\n        function BaseMoveToCommand(opts) {\r\n            var _this = _super.call(this, opts) || this;\r\n            _this._inSelectionMode = opts.inSelectionMode;\r\n            return _this;\r\n        }\r\n        BaseMoveToCommand.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, [\r\n                CursorMoveCommands.moveTo(cursors.context, cursors.getPrimaryCursor(), this._inSelectionMode, args.position, args.viewPosition)\r\n            ]);\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        return BaseMoveToCommand;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.MoveTo = registerEditorCommand(new BaseMoveToCommand({\r\n        id: '_moveTo',\r\n        inSelectionMode: false,\r\n        precondition: null\r\n    }));\r\n    CoreNavigationCommands.MoveToSelect = registerEditorCommand(new BaseMoveToCommand({\r\n        id: '_moveToSelect',\r\n        inSelectionMode: true,\r\n        precondition: null\r\n    }));\r\n    var ColumnSelectCommand = /** @class */ (function (_super) {\r\n        __extends(ColumnSelectCommand, _super);\r\n        function ColumnSelectCommand() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        ColumnSelectCommand.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            var result = this._getColumnSelectResult(cursors.context, cursors.getPrimaryCursor(), cursors.getColumnSelectData(), args);\r\n            cursors.setStates(args.source, 3 /* Explicit */, result.viewStates.map(function (viewState) { return CursorState.fromViewState(viewState); }));\r\n            cursors.setColumnSelectData({\r\n                toViewLineNumber: result.toLineNumber,\r\n                toViewVisualColumn: result.toVisualColumn\r\n            });\r\n            cursors.reveal(true, (result.reversed ? 1 /* TopMost */ : 2 /* BottomMost */), 0 /* Smooth */);\r\n        };\r\n        return ColumnSelectCommand;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.ColumnSelect = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_1, _super);\r\n        function class_1() {\r\n            return _super.call(this, {\r\n                id: 'columnSelect',\r\n                precondition: null\r\n            }) || this;\r\n        }\r\n        class_1.prototype._getColumnSelectResult = function (context, primary, prevColumnSelectData, args) {\r\n            // validate `args`\r\n            var validatedPosition = context.model.validatePosition(args.position);\r\n            var validatedViewPosition;\r\n            if (args.viewPosition) {\r\n                validatedViewPosition = context.validateViewPosition(new Position(args.viewPosition.lineNumber, args.viewPosition.column), validatedPosition);\r\n            }\r\n            else {\r\n                validatedViewPosition = context.convertModelPositionToViewPosition(validatedPosition);\r\n            }\r\n            return ColumnSelection.columnSelect(context.config, context.viewModel, primary.viewState.selection, validatedViewPosition.lineNumber, args.mouseColumn - 1);\r\n        };\r\n        return class_1;\r\n    }(ColumnSelectCommand)));\r\n    CoreNavigationCommands.CursorColumnSelectLeft = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_2, _super);\r\n        function class_2() {\r\n            return _super.call(this, {\r\n                id: 'cursorColumnSelectLeft',\r\n                precondition: null,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 15 /* LeftArrow */,\r\n                    linux: { primary: 0 }\r\n                }\r\n            }) || this;\r\n        }\r\n        class_2.prototype._getColumnSelectResult = function (context, primary, prevColumnSelectData, args) {\r\n            return ColumnSelection.columnSelectLeft(context.config, context.viewModel, primary.viewState, prevColumnSelectData.toViewLineNumber, prevColumnSelectData.toViewVisualColumn);\r\n        };\r\n        return class_2;\r\n    }(ColumnSelectCommand)));\r\n    CoreNavigationCommands.CursorColumnSelectRight = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_3, _super);\r\n        function class_3() {\r\n            return _super.call(this, {\r\n                id: 'cursorColumnSelectRight',\r\n                precondition: null,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 17 /* RightArrow */,\r\n                    linux: { primary: 0 }\r\n                }\r\n            }) || this;\r\n        }\r\n        class_3.prototype._getColumnSelectResult = function (context, primary, prevColumnSelectData, args) {\r\n            return ColumnSelection.columnSelectRight(context.config, context.viewModel, primary.viewState, prevColumnSelectData.toViewLineNumber, prevColumnSelectData.toViewVisualColumn);\r\n        };\r\n        return class_3;\r\n    }(ColumnSelectCommand)));\r\n    var ColumnSelectUpCommand = /** @class */ (function (_super) {\r\n        __extends(ColumnSelectUpCommand, _super);\r\n        function ColumnSelectUpCommand(opts) {\r\n            var _this = _super.call(this, opts) || this;\r\n            _this._isPaged = opts.isPaged;\r\n            return _this;\r\n        }\r\n        ColumnSelectUpCommand.prototype._getColumnSelectResult = function (context, primary, prevColumnSelectData, args) {\r\n            return ColumnSelection.columnSelectUp(context.config, context.viewModel, primary.viewState, this._isPaged, prevColumnSelectData.toViewLineNumber, prevColumnSelectData.toViewVisualColumn);\r\n        };\r\n        return ColumnSelectUpCommand;\r\n    }(ColumnSelectCommand));\r\n    CoreNavigationCommands.CursorColumnSelectUp = registerEditorCommand(new ColumnSelectUpCommand({\r\n        isPaged: false,\r\n        id: 'cursorColumnSelectUp',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 16 /* UpArrow */,\r\n            linux: { primary: 0 }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorColumnSelectPageUp = registerEditorCommand(new ColumnSelectUpCommand({\r\n        isPaged: true,\r\n        id: 'cursorColumnSelectPageUp',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 11 /* PageUp */,\r\n            linux: { primary: 0 }\r\n        }\r\n    }));\r\n    var ColumnSelectDownCommand = /** @class */ (function (_super) {\r\n        __extends(ColumnSelectDownCommand, _super);\r\n        function ColumnSelectDownCommand(opts) {\r\n            var _this = _super.call(this, opts) || this;\r\n            _this._isPaged = opts.isPaged;\r\n            return _this;\r\n        }\r\n        ColumnSelectDownCommand.prototype._getColumnSelectResult = function (context, primary, prevColumnSelectData, args) {\r\n            return ColumnSelection.columnSelectDown(context.config, context.viewModel, primary.viewState, this._isPaged, prevColumnSelectData.toViewLineNumber, prevColumnSelectData.toViewVisualColumn);\r\n        };\r\n        return ColumnSelectDownCommand;\r\n    }(ColumnSelectCommand));\r\n    CoreNavigationCommands.CursorColumnSelectDown = registerEditorCommand(new ColumnSelectDownCommand({\r\n        isPaged: false,\r\n        id: 'cursorColumnSelectDown',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 18 /* DownArrow */,\r\n            linux: { primary: 0 }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorColumnSelectPageDown = registerEditorCommand(new ColumnSelectDownCommand({\r\n        isPaged: true,\r\n        id: 'cursorColumnSelectPageDown',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 12 /* PageDown */,\r\n            linux: { primary: 0 }\r\n        }\r\n    }));\r\n    var CursorMoveImpl = /** @class */ (function (_super) {\r\n        __extends(CursorMoveImpl, _super);\r\n        function CursorMoveImpl() {\r\n            return _super.call(this, {\r\n                id: 'cursorMove',\r\n                precondition: null,\r\n                description: CursorMove_.description\r\n            }) || this;\r\n        }\r\n        CursorMoveImpl.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            var parsed = CursorMove_.parse(args);\r\n            if (!parsed) {\r\n                // illegal arguments\r\n                return;\r\n            }\r\n            this._runCursorMove(cursors, args.source, parsed);\r\n        };\r\n        CursorMoveImpl.prototype._runCursorMove = function (cursors, source, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(source, 3 /* Explicit */, CursorMoveCommands.move(cursors.context, cursors.getAll(), args));\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        return CursorMoveImpl;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.CursorMoveImpl = CursorMoveImpl;\r\n    CoreNavigationCommands.CursorMove = registerEditorCommand(new CursorMoveImpl());\r\n    var CursorMoveBasedCommand = /** @class */ (function (_super) {\r\n        __extends(CursorMoveBasedCommand, _super);\r\n        function CursorMoveBasedCommand(opts) {\r\n            var _this = _super.call(this, opts) || this;\r\n            _this._staticArgs = opts.args;\r\n            return _this;\r\n        }\r\n        CursorMoveBasedCommand.prototype.runCoreEditorCommand = function (cursors, dynamicArgs) {\r\n            var args = this._staticArgs;\r\n            if (this._staticArgs.value === -1 /* PAGE_SIZE_MARKER */) {\r\n                // -1 is a marker for page size\r\n                args = {\r\n                    direction: this._staticArgs.direction,\r\n                    unit: this._staticArgs.unit,\r\n                    select: this._staticArgs.select,\r\n                    value: cursors.context.config.pageSize\r\n                };\r\n            }\r\n            CoreNavigationCommands.CursorMove._runCursorMove(cursors, dynamicArgs.source, args);\r\n        };\r\n        return CursorMoveBasedCommand;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.CursorLeft = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 0 /* Left */,\r\n            unit: 0 /* None */,\r\n            select: false,\r\n            value: 1\r\n        },\r\n        id: 'cursorLeft',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 15 /* LeftArrow */,\r\n            mac: { primary: 15 /* LeftArrow */, secondary: [256 /* WinCtrl */ | 32 /* KEY_B */] }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorLeftSelect = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 0 /* Left */,\r\n            unit: 0 /* None */,\r\n            select: true,\r\n            value: 1\r\n        },\r\n        id: 'cursorLeftSelect',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 1024 /* Shift */ | 15 /* LeftArrow */\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorRight = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 1 /* Right */,\r\n            unit: 0 /* None */,\r\n            select: false,\r\n            value: 1\r\n        },\r\n        id: 'cursorRight',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 17 /* RightArrow */,\r\n            mac: { primary: 17 /* RightArrow */, secondary: [256 /* WinCtrl */ | 36 /* KEY_F */] }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorRightSelect = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 1 /* Right */,\r\n            unit: 0 /* None */,\r\n            select: true,\r\n            value: 1\r\n        },\r\n        id: 'cursorRightSelect',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 1024 /* Shift */ | 17 /* RightArrow */\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorUp = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 2 /* Up */,\r\n            unit: 2 /* WrappedLine */,\r\n            select: false,\r\n            value: 1\r\n        },\r\n        id: 'cursorUp',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 16 /* UpArrow */,\r\n            mac: { primary: 16 /* UpArrow */, secondary: [256 /* WinCtrl */ | 46 /* KEY_P */] }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorUpSelect = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 2 /* Up */,\r\n            unit: 2 /* WrappedLine */,\r\n            select: true,\r\n            value: 1\r\n        },\r\n        id: 'cursorUpSelect',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 1024 /* Shift */ | 16 /* UpArrow */,\r\n            secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 16 /* UpArrow */],\r\n            mac: { primary: 1024 /* Shift */ | 16 /* UpArrow */ },\r\n            linux: { primary: 1024 /* Shift */ | 16 /* UpArrow */ }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorPageUp = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 2 /* Up */,\r\n            unit: 2 /* WrappedLine */,\r\n            select: false,\r\n            value: -1 /* PAGE_SIZE_MARKER */\r\n        },\r\n        id: 'cursorPageUp',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 11 /* PageUp */\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorPageUpSelect = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 2 /* Up */,\r\n            unit: 2 /* WrappedLine */,\r\n            select: true,\r\n            value: -1 /* PAGE_SIZE_MARKER */\r\n        },\r\n        id: 'cursorPageUpSelect',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 1024 /* Shift */ | 11 /* PageUp */\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorDown = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 3 /* Down */,\r\n            unit: 2 /* WrappedLine */,\r\n            select: false,\r\n            value: 1\r\n        },\r\n        id: 'cursorDown',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 18 /* DownArrow */,\r\n            mac: { primary: 18 /* DownArrow */, secondary: [256 /* WinCtrl */ | 44 /* KEY_N */] }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorDownSelect = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 3 /* Down */,\r\n            unit: 2 /* WrappedLine */,\r\n            select: true,\r\n            value: 1\r\n        },\r\n        id: 'cursorDownSelect',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 1024 /* Shift */ | 18 /* DownArrow */,\r\n            secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 18 /* DownArrow */],\r\n            mac: { primary: 1024 /* Shift */ | 18 /* DownArrow */ },\r\n            linux: { primary: 1024 /* Shift */ | 18 /* DownArrow */ }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorPageDown = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 3 /* Down */,\r\n            unit: 2 /* WrappedLine */,\r\n            select: false,\r\n            value: -1 /* PAGE_SIZE_MARKER */\r\n        },\r\n        id: 'cursorPageDown',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 12 /* PageDown */\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorPageDownSelect = registerEditorCommand(new CursorMoveBasedCommand({\r\n        args: {\r\n            direction: 3 /* Down */,\r\n            unit: 2 /* WrappedLine */,\r\n            select: true,\r\n            value: -1 /* PAGE_SIZE_MARKER */\r\n        },\r\n        id: 'cursorPageDownSelect',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 1024 /* Shift */ | 12 /* PageDown */\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CreateCursor = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_4, _super);\r\n        function class_4() {\r\n            return _super.call(this, {\r\n                id: 'createCursor',\r\n                precondition: null\r\n            }) || this;\r\n        }\r\n        class_4.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            var context = cursors.context;\r\n            var newState;\r\n            if (args.wholeLine) {\r\n                newState = CursorMoveCommands.line(context, cursors.getPrimaryCursor(), false, args.position, args.viewPosition);\r\n            }\r\n            else {\r\n                newState = CursorMoveCommands.moveTo(context, cursors.getPrimaryCursor(), false, args.position, args.viewPosition);\r\n            }\r\n            var states = cursors.getAll();\r\n            // Check if we should remove a cursor (sort of like a toggle)\r\n            if (states.length > 1) {\r\n                var newModelPosition = (newState.modelState ? newState.modelState.position : null);\r\n                var newViewPosition = (newState.viewState ? newState.viewState.position : null);\r\n                for (var i = 0, len = states.length; i < len; i++) {\r\n                    var state = states[i];\r\n                    if (newModelPosition && !state.modelState.selection.containsPosition(newModelPosition)) {\r\n                        continue;\r\n                    }\r\n                    if (newViewPosition && !state.viewState.selection.containsPosition(newViewPosition)) {\r\n                        continue;\r\n                    }\r\n                    // => Remove the cursor\r\n                    states.splice(i, 1);\r\n                    cursors.context.model.pushStackElement();\r\n                    cursors.setStates(args.source, 3 /* Explicit */, states);\r\n                    return;\r\n                }\r\n            }\r\n            // => Add the new cursor\r\n            states.push(newState);\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, states);\r\n        };\r\n        return class_4;\r\n    }(CoreEditorCommand)));\r\n    CoreNavigationCommands.LastCursorMoveToSelect = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_5, _super);\r\n        function class_5() {\r\n            return _super.call(this, {\r\n                id: '_lastCursorMoveToSelect',\r\n                precondition: null\r\n            }) || this;\r\n        }\r\n        class_5.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            var context = cursors.context;\r\n            var lastAddedCursorIndex = cursors.getLastAddedCursorIndex();\r\n            var states = cursors.getAll();\r\n            var newStates = states.slice(0);\r\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.moveTo(context, states[lastAddedCursorIndex], true, args.position, args.viewPosition);\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, newStates);\r\n        };\r\n        return class_5;\r\n    }(CoreEditorCommand)));\r\n    var HomeCommand = /** @class */ (function (_super) {\r\n        __extends(HomeCommand, _super);\r\n        function HomeCommand(opts) {\r\n            var _this = _super.call(this, opts) || this;\r\n            _this._inSelectionMode = opts.inSelectionMode;\r\n            return _this;\r\n        }\r\n        HomeCommand.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, CursorMoveCommands.moveToBeginningOfLine(cursors.context, cursors.getAll(), this._inSelectionMode));\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        return HomeCommand;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.CursorHome = registerEditorCommand(new HomeCommand({\r\n        inSelectionMode: false,\r\n        id: 'cursorHome',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 14 /* Home */,\r\n            mac: { primary: 14 /* Home */, secondary: [2048 /* CtrlCmd */ | 15 /* LeftArrow */] }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorHomeSelect = registerEditorCommand(new HomeCommand({\r\n        inSelectionMode: true,\r\n        id: 'cursorHomeSelect',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 1024 /* Shift */ | 14 /* Home */,\r\n            mac: { primary: 1024 /* Shift */ | 14 /* Home */, secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 15 /* LeftArrow */] }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorLineStart = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_6, _super);\r\n        function class_6() {\r\n            return _super.call(this, {\r\n                id: 'cursorLineStart',\r\n                precondition: null,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 0,\r\n                    mac: { primary: 256 /* WinCtrl */ | 31 /* KEY_A */ }\r\n                }\r\n            }) || this;\r\n        }\r\n        class_6.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, this._exec(cursors.context, cursors.getAll()));\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        class_6.prototype._exec = function (context, cursors) {\r\n            var result = [];\r\n            for (var i = 0, len = cursors.length; i < len; i++) {\r\n                var cursor = cursors[i];\r\n                var lineNumber = cursor.modelState.position.lineNumber;\r\n                result[i] = CursorState.fromModelState(cursor.modelState.move(false, lineNumber, 1, 0));\r\n            }\r\n            return result;\r\n        };\r\n        return class_6;\r\n    }(CoreEditorCommand)));\r\n    var EndCommand = /** @class */ (function (_super) {\r\n        __extends(EndCommand, _super);\r\n        function EndCommand(opts) {\r\n            var _this = _super.call(this, opts) || this;\r\n            _this._inSelectionMode = opts.inSelectionMode;\r\n            return _this;\r\n        }\r\n        EndCommand.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, CursorMoveCommands.moveToEndOfLine(cursors.context, cursors.getAll(), this._inSelectionMode));\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        return EndCommand;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.CursorEnd = registerEditorCommand(new EndCommand({\r\n        inSelectionMode: false,\r\n        id: 'cursorEnd',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 13 /* End */,\r\n            mac: { primary: 13 /* End */, secondary: [2048 /* CtrlCmd */ | 17 /* RightArrow */] }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorEndSelect = registerEditorCommand(new EndCommand({\r\n        inSelectionMode: true,\r\n        id: 'cursorEndSelect',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 1024 /* Shift */ | 13 /* End */,\r\n            mac: { primary: 1024 /* Shift */ | 13 /* End */, secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 17 /* RightArrow */] }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorLineEnd = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_7, _super);\r\n        function class_7() {\r\n            return _super.call(this, {\r\n                id: 'cursorLineEnd',\r\n                precondition: null,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 0,\r\n                    mac: { primary: 256 /* WinCtrl */ | 35 /* KEY_E */ }\r\n                }\r\n            }) || this;\r\n        }\r\n        class_7.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, this._exec(cursors.context, cursors.getAll()));\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        class_7.prototype._exec = function (context, cursors) {\r\n            var result = [];\r\n            for (var i = 0, len = cursors.length; i < len; i++) {\r\n                var cursor = cursors[i];\r\n                var lineNumber = cursor.modelState.position.lineNumber;\r\n                var maxColumn = context.model.getLineMaxColumn(lineNumber);\r\n                result[i] = CursorState.fromModelState(cursor.modelState.move(false, lineNumber, maxColumn, 0));\r\n            }\r\n            return result;\r\n        };\r\n        return class_7;\r\n    }(CoreEditorCommand)));\r\n    var TopCommand = /** @class */ (function (_super) {\r\n        __extends(TopCommand, _super);\r\n        function TopCommand(opts) {\r\n            var _this = _super.call(this, opts) || this;\r\n            _this._inSelectionMode = opts.inSelectionMode;\r\n            return _this;\r\n        }\r\n        TopCommand.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, CursorMoveCommands.moveToBeginningOfBuffer(cursors.context, cursors.getAll(), this._inSelectionMode));\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        return TopCommand;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.CursorTop = registerEditorCommand(new TopCommand({\r\n        inSelectionMode: false,\r\n        id: 'cursorTop',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 14 /* Home */,\r\n            mac: { primary: 2048 /* CtrlCmd */ | 16 /* UpArrow */ }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorTopSelect = registerEditorCommand(new TopCommand({\r\n        inSelectionMode: true,\r\n        id: 'cursorTopSelect',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 14 /* Home */,\r\n            mac: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 16 /* UpArrow */ }\r\n        }\r\n    }));\r\n    var BottomCommand = /** @class */ (function (_super) {\r\n        __extends(BottomCommand, _super);\r\n        function BottomCommand(opts) {\r\n            var _this = _super.call(this, opts) || this;\r\n            _this._inSelectionMode = opts.inSelectionMode;\r\n            return _this;\r\n        }\r\n        BottomCommand.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, CursorMoveCommands.moveToEndOfBuffer(cursors.context, cursors.getAll(), this._inSelectionMode));\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        return BottomCommand;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.CursorBottom = registerEditorCommand(new BottomCommand({\r\n        inSelectionMode: false,\r\n        id: 'cursorBottom',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 13 /* End */,\r\n            mac: { primary: 2048 /* CtrlCmd */ | 18 /* DownArrow */ }\r\n        }\r\n    }));\r\n    CoreNavigationCommands.CursorBottomSelect = registerEditorCommand(new BottomCommand({\r\n        inSelectionMode: true,\r\n        id: 'cursorBottomSelect',\r\n        precondition: null,\r\n        kbOpts: {\r\n            weight: CORE_WEIGHT,\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 13 /* End */,\r\n            mac: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 18 /* DownArrow */ }\r\n        }\r\n    }));\r\n    var EditorScrollImpl = /** @class */ (function (_super) {\r\n        __extends(EditorScrollImpl, _super);\r\n        function EditorScrollImpl() {\r\n            return _super.call(this, {\r\n                id: 'editorScroll',\r\n                precondition: null,\r\n                description: EditorScroll_.description\r\n            }) || this;\r\n        }\r\n        EditorScrollImpl.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            var parsed = EditorScroll_.parse(args);\r\n            if (!parsed) {\r\n                // illegal arguments\r\n                return;\r\n            }\r\n            this._runEditorScroll(cursors, args.source, parsed);\r\n        };\r\n        EditorScrollImpl.prototype._runEditorScroll = function (cursors, source, args) {\r\n            var desiredScrollTop = this._computeDesiredScrollTop(cursors.context, args);\r\n            if (args.revealCursor) {\r\n                // must ensure cursor is in new visible range\r\n                var desiredVisibleViewRange = cursors.context.getCompletelyVisibleViewRangeAtScrollTop(desiredScrollTop);\r\n                cursors.setStates(source, 3 /* Explicit */, [\r\n                    CursorMoveCommands.findPositionInViewportIfOutside(cursors.context, cursors.getPrimaryCursor(), desiredVisibleViewRange, args.select)\r\n                ]);\r\n            }\r\n            cursors.scrollTo(desiredScrollTop);\r\n        };\r\n        EditorScrollImpl.prototype._computeDesiredScrollTop = function (context, args) {\r\n            if (args.unit === 1 /* Line */) {\r\n                // scrolling by model lines\r\n                var visibleModelRange = context.getCompletelyVisibleModelRange();\r\n                var desiredTopModelLineNumber = void 0;\r\n                if (args.direction === 1 /* Up */) {\r\n                    // must go x model lines up\r\n                    desiredTopModelLineNumber = Math.max(1, visibleModelRange.startLineNumber - args.value);\r\n                }\r\n                else {\r\n                    // must go x model lines down\r\n                    desiredTopModelLineNumber = Math.min(context.model.getLineCount(), visibleModelRange.startLineNumber + args.value);\r\n                }\r\n                var desiredTopViewPosition = context.convertModelPositionToViewPosition(new Position(desiredTopModelLineNumber, 1));\r\n                return context.getVerticalOffsetForViewLine(desiredTopViewPosition.lineNumber);\r\n            }\r\n            var noOfLines;\r\n            if (args.unit === 3 /* Page */) {\r\n                noOfLines = context.config.pageSize * args.value;\r\n            }\r\n            else if (args.unit === 4 /* HalfPage */) {\r\n                noOfLines = Math.round(context.config.pageSize / 2) * args.value;\r\n            }\r\n            else {\r\n                noOfLines = args.value;\r\n            }\r\n            var deltaLines = (args.direction === 1 /* Up */ ? -1 : 1) * noOfLines;\r\n            return context.getCurrentScrollTop() + deltaLines * context.config.lineHeight;\r\n        };\r\n        return EditorScrollImpl;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.EditorScrollImpl = EditorScrollImpl;\r\n    CoreNavigationCommands.EditorScroll = registerEditorCommand(new EditorScrollImpl());\r\n    CoreNavigationCommands.ScrollLineUp = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_8, _super);\r\n        function class_8() {\r\n            return _super.call(this, {\r\n                id: 'scrollLineUp',\r\n                precondition: null,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 16 /* UpArrow */,\r\n                    mac: { primary: 256 /* WinCtrl */ | 11 /* PageUp */ }\r\n                }\r\n            }) || this;\r\n        }\r\n        class_8.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            CoreNavigationCommands.EditorScroll._runEditorScroll(cursors, args.source, {\r\n                direction: 1 /* Up */,\r\n                unit: 2 /* WrappedLine */,\r\n                value: 1,\r\n                revealCursor: false,\r\n                select: false\r\n            });\r\n        };\r\n        return class_8;\r\n    }(CoreEditorCommand)));\r\n    CoreNavigationCommands.ScrollPageUp = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_9, _super);\r\n        function class_9() {\r\n            return _super.call(this, {\r\n                id: 'scrollPageUp',\r\n                precondition: null,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 11 /* PageUp */,\r\n                    win: { primary: 512 /* Alt */ | 11 /* PageUp */ },\r\n                    linux: { primary: 512 /* Alt */ | 11 /* PageUp */ }\r\n                }\r\n            }) || this;\r\n        }\r\n        class_9.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            CoreNavigationCommands.EditorScroll._runEditorScroll(cursors, args.source, {\r\n                direction: 1 /* Up */,\r\n                unit: 3 /* Page */,\r\n                value: 1,\r\n                revealCursor: false,\r\n                select: false\r\n            });\r\n        };\r\n        return class_9;\r\n    }(CoreEditorCommand)));\r\n    CoreNavigationCommands.ScrollLineDown = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_10, _super);\r\n        function class_10() {\r\n            return _super.call(this, {\r\n                id: 'scrollLineDown',\r\n                precondition: null,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 18 /* DownArrow */,\r\n                    mac: { primary: 256 /* WinCtrl */ | 12 /* PageDown */ }\r\n                }\r\n            }) || this;\r\n        }\r\n        class_10.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            CoreNavigationCommands.EditorScroll._runEditorScroll(cursors, args.source, {\r\n                direction: 2 /* Down */,\r\n                unit: 2 /* WrappedLine */,\r\n                value: 1,\r\n                revealCursor: false,\r\n                select: false\r\n            });\r\n        };\r\n        return class_10;\r\n    }(CoreEditorCommand)));\r\n    CoreNavigationCommands.ScrollPageDown = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_11, _super);\r\n        function class_11() {\r\n            return _super.call(this, {\r\n                id: 'scrollPageDown',\r\n                precondition: null,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 12 /* PageDown */,\r\n                    win: { primary: 512 /* Alt */ | 12 /* PageDown */ },\r\n                    linux: { primary: 512 /* Alt */ | 12 /* PageDown */ }\r\n                }\r\n            }) || this;\r\n        }\r\n        class_11.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            CoreNavigationCommands.EditorScroll._runEditorScroll(cursors, args.source, {\r\n                direction: 2 /* Down */,\r\n                unit: 3 /* Page */,\r\n                value: 1,\r\n                revealCursor: false,\r\n                select: false\r\n            });\r\n        };\r\n        return class_11;\r\n    }(CoreEditorCommand)));\r\n    var WordCommand = /** @class */ (function (_super) {\r\n        __extends(WordCommand, _super);\r\n        function WordCommand(opts) {\r\n            var _this = _super.call(this, opts) || this;\r\n            _this._inSelectionMode = opts.inSelectionMode;\r\n            return _this;\r\n        }\r\n        WordCommand.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, [\r\n                CursorMoveCommands.word(cursors.context, cursors.getPrimaryCursor(), this._inSelectionMode, args.position)\r\n            ]);\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        return WordCommand;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.WordSelect = registerEditorCommand(new WordCommand({\r\n        inSelectionMode: false,\r\n        id: '_wordSelect',\r\n        precondition: null\r\n    }));\r\n    CoreNavigationCommands.WordSelectDrag = registerEditorCommand(new WordCommand({\r\n        inSelectionMode: true,\r\n        id: '_wordSelectDrag',\r\n        precondition: null\r\n    }));\r\n    CoreNavigationCommands.LastCursorWordSelect = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_12, _super);\r\n        function class_12() {\r\n            return _super.call(this, {\r\n                id: 'lastCursorWordSelect',\r\n                precondition: null\r\n            }) || this;\r\n        }\r\n        class_12.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            var context = cursors.context;\r\n            var lastAddedCursorIndex = cursors.getLastAddedCursorIndex();\r\n            var states = cursors.getAll();\r\n            var newStates = states.slice(0);\r\n            var lastAddedState = states[lastAddedCursorIndex];\r\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.word(context, lastAddedState, lastAddedState.modelState.hasSelection(), args.position);\r\n            context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, newStates);\r\n        };\r\n        return class_12;\r\n    }(CoreEditorCommand)));\r\n    var LineCommand = /** @class */ (function (_super) {\r\n        __extends(LineCommand, _super);\r\n        function LineCommand(opts) {\r\n            var _this = _super.call(this, opts) || this;\r\n            _this._inSelectionMode = opts.inSelectionMode;\r\n            return _this;\r\n        }\r\n        LineCommand.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, [\r\n                CursorMoveCommands.line(cursors.context, cursors.getPrimaryCursor(), this._inSelectionMode, args.position, args.viewPosition)\r\n            ]);\r\n            cursors.reveal(false, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        return LineCommand;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.LineSelect = registerEditorCommand(new LineCommand({\r\n        inSelectionMode: false,\r\n        id: '_lineSelect',\r\n        precondition: null\r\n    }));\r\n    CoreNavigationCommands.LineSelectDrag = registerEditorCommand(new LineCommand({\r\n        inSelectionMode: true,\r\n        id: '_lineSelectDrag',\r\n        precondition: null\r\n    }));\r\n    var LastCursorLineCommand = /** @class */ (function (_super) {\r\n        __extends(LastCursorLineCommand, _super);\r\n        function LastCursorLineCommand(opts) {\r\n            var _this = _super.call(this, opts) || this;\r\n            _this._inSelectionMode = opts.inSelectionMode;\r\n            return _this;\r\n        }\r\n        LastCursorLineCommand.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            var lastAddedCursorIndex = cursors.getLastAddedCursorIndex();\r\n            var states = cursors.getAll();\r\n            var newStates = states.slice(0);\r\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.line(cursors.context, states[lastAddedCursorIndex], this._inSelectionMode, args.position, args.viewPosition);\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, newStates);\r\n        };\r\n        return LastCursorLineCommand;\r\n    }(CoreEditorCommand));\r\n    CoreNavigationCommands.LastCursorLineSelect = registerEditorCommand(new LastCursorLineCommand({\r\n        inSelectionMode: false,\r\n        id: 'lastCursorLineSelect',\r\n        precondition: null\r\n    }));\r\n    CoreNavigationCommands.LastCursorLineSelectDrag = registerEditorCommand(new LastCursorLineCommand({\r\n        inSelectionMode: true,\r\n        id: 'lastCursorLineSelectDrag',\r\n        precondition: null\r\n    }));\r\n    CoreNavigationCommands.ExpandLineSelection = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_13, _super);\r\n        function class_13() {\r\n            return _super.call(this, {\r\n                id: 'expandLineSelection',\r\n                precondition: null,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 39 /* KEY_I */\r\n                }\r\n            }) || this;\r\n        }\r\n        class_13.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, CursorMoveCommands.expandLineSelection(cursors.context, cursors.getAll()));\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        return class_13;\r\n    }(CoreEditorCommand)));\r\n    CoreNavigationCommands.CancelSelection = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_14, _super);\r\n        function class_14() {\r\n            return _super.call(this, {\r\n                id: 'cancelSelection',\r\n                precondition: EditorContextKeys.hasNonEmptySelection,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 9 /* Escape */,\r\n                    secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n                }\r\n            }) || this;\r\n        }\r\n        class_14.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, [\r\n                CursorMoveCommands.cancelSelection(cursors.context, cursors.getPrimaryCursor())\r\n            ]);\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        return class_14;\r\n    }(CoreEditorCommand)));\r\n    CoreNavigationCommands.RemoveSecondaryCursors = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_15, _super);\r\n        function class_15() {\r\n            return _super.call(this, {\r\n                id: 'removeSecondaryCursors',\r\n                precondition: EditorContextKeys.hasMultipleSelections,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT + 1,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 9 /* Escape */,\r\n                    secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n                }\r\n            }) || this;\r\n        }\r\n        class_15.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, [\r\n                cursors.getPrimaryCursor()\r\n            ]);\r\n            cursors.reveal(true, 0 /* Primary */, 0 /* Smooth */);\r\n        };\r\n        return class_15;\r\n    }(CoreEditorCommand)));\r\n    CoreNavigationCommands.RevealLine = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_16, _super);\r\n        function class_16() {\r\n            return _super.call(this, {\r\n                id: 'revealLine',\r\n                precondition: null,\r\n                description: RevealLine_.description\r\n            }) || this;\r\n        }\r\n        class_16.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            var revealLineArg = args;\r\n            var lineNumber = (revealLineArg.lineNumber || 0) + 1;\r\n            if (lineNumber < 1) {\r\n                lineNumber = 1;\r\n            }\r\n            var lineCount = cursors.context.model.getLineCount();\r\n            if (lineNumber > lineCount) {\r\n                lineNumber = lineCount;\r\n            }\r\n            var range = new Range(lineNumber, 1, lineNumber, cursors.context.model.getLineMaxColumn(lineNumber));\r\n            var revealAt = 0 /* Simple */;\r\n            if (revealLineArg.at) {\r\n                switch (revealLineArg.at) {\r\n                    case RevealLine_.RawAtArgument.Top:\r\n                        revealAt = 3 /* Top */;\r\n                        break;\r\n                    case RevealLine_.RawAtArgument.Center:\r\n                        revealAt = 1 /* Center */;\r\n                        break;\r\n                    case RevealLine_.RawAtArgument.Bottom:\r\n                        revealAt = 4 /* Bottom */;\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            }\r\n            var viewRange = cursors.context.convertModelRangeToViewRange(range);\r\n            cursors.revealRange(false, viewRange, revealAt, 0 /* Smooth */);\r\n        };\r\n        return class_16;\r\n    }(CoreEditorCommand)));\r\n    CoreNavigationCommands.SelectAll = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_17, _super);\r\n        function class_17() {\r\n            return _super.call(this, {\r\n                id: 'selectAll',\r\n                precondition: null\r\n            }) || this;\r\n        }\r\n        class_17.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, [\r\n                CursorMoveCommands.selectAll(cursors.context, cursors.getPrimaryCursor())\r\n            ]);\r\n        };\r\n        return class_17;\r\n    }(CoreEditorCommand)));\r\n    CoreNavigationCommands.SetSelection = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_18, _super);\r\n        function class_18() {\r\n            return _super.call(this, {\r\n                id: 'setSelection',\r\n                precondition: null\r\n            }) || this;\r\n        }\r\n        class_18.prototype.runCoreEditorCommand = function (cursors, args) {\r\n            cursors.context.model.pushStackElement();\r\n            cursors.setStates(args.source, 3 /* Explicit */, [\r\n                CursorState.fromModelSelection(args.selection)\r\n            ]);\r\n        };\r\n        return class_18;\r\n    }(CoreEditorCommand)));\r\n})(CoreNavigationCommands || (CoreNavigationCommands = {}));\r\nexport var CoreEditingCommands;\r\n(function (CoreEditingCommands) {\r\n    var CoreEditingCommand = /** @class */ (function (_super) {\r\n        __extends(CoreEditingCommand, _super);\r\n        function CoreEditingCommand() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        CoreEditingCommand.prototype.runEditorCommand = function (accessor, editor, args) {\r\n            var cursors = editor._getCursors();\r\n            if (!cursors) {\r\n                // the editor has no view => has no cursors\r\n                return;\r\n            }\r\n            this.runCoreEditingCommand(editor, cursors, args || {});\r\n        };\r\n        return CoreEditingCommand;\r\n    }(EditorCommand));\r\n    CoreEditingCommands.CoreEditingCommand = CoreEditingCommand;\r\n    CoreEditingCommands.LineBreakInsert = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_19, _super);\r\n        function class_19() {\r\n            return _super.call(this, {\r\n                id: 'lineBreakInsert',\r\n                precondition: EditorContextKeys.writable,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 0,\r\n                    mac: { primary: 256 /* WinCtrl */ | 45 /* KEY_O */ }\r\n                }\r\n            }) || this;\r\n        }\r\n        class_19.prototype.runCoreEditingCommand = function (editor, cursors, args) {\r\n            editor.pushUndoStop();\r\n            editor.executeCommands(this.id, TypeOperations.lineBreakInsert(cursors.context.config, cursors.context.model, cursors.getAll().map(function (s) { return s.modelState.selection; })));\r\n        };\r\n        return class_19;\r\n    }(CoreEditingCommand)));\r\n    CoreEditingCommands.Outdent = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_20, _super);\r\n        function class_20() {\r\n            return _super.call(this, {\r\n                id: 'outdent',\r\n                precondition: EditorContextKeys.writable,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.tabDoesNotMoveFocus),\r\n                    primary: 1024 /* Shift */ | 2 /* Tab */\r\n                }\r\n            }) || this;\r\n        }\r\n        class_20.prototype.runCoreEditingCommand = function (editor, cursors, args) {\r\n            editor.pushUndoStop();\r\n            editor.executeCommands(this.id, TypeOperations.outdent(cursors.context.config, cursors.context.model, cursors.getAll().map(function (s) { return s.modelState.selection; })));\r\n            editor.pushUndoStop();\r\n        };\r\n        return class_20;\r\n    }(CoreEditingCommand)));\r\n    CoreEditingCommands.Tab = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_21, _super);\r\n        function class_21() {\r\n            return _super.call(this, {\r\n                id: 'tab',\r\n                precondition: EditorContextKeys.writable,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.tabDoesNotMoveFocus),\r\n                    primary: 2 /* Tab */\r\n                }\r\n            }) || this;\r\n        }\r\n        class_21.prototype.runCoreEditingCommand = function (editor, cursors, args) {\r\n            editor.pushUndoStop();\r\n            editor.executeCommands(this.id, TypeOperations.tab(cursors.context.config, cursors.context.model, cursors.getAll().map(function (s) { return s.modelState.selection; })));\r\n            editor.pushUndoStop();\r\n        };\r\n        return class_21;\r\n    }(CoreEditingCommand)));\r\n    CoreEditingCommands.DeleteLeft = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_22, _super);\r\n        function class_22() {\r\n            return _super.call(this, {\r\n                id: 'deleteLeft',\r\n                precondition: EditorContextKeys.writable,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 1 /* Backspace */,\r\n                    secondary: [1024 /* Shift */ | 1 /* Backspace */],\r\n                    mac: { primary: 1 /* Backspace */, secondary: [1024 /* Shift */ | 1 /* Backspace */, 256 /* WinCtrl */ | 38 /* KEY_H */, 256 /* WinCtrl */ | 1 /* Backspace */] }\r\n                }\r\n            }) || this;\r\n        }\r\n        class_22.prototype.runCoreEditingCommand = function (editor, cursors, args) {\r\n            var _a = DeleteOperations.deleteLeft(cursors.getPrevEditOperationType(), cursors.context.config, cursors.context.model, cursors.getAll().map(function (s) { return s.modelState.selection; })), shouldPushStackElementBefore = _a[0], commands = _a[1];\r\n            if (shouldPushStackElementBefore) {\r\n                editor.pushUndoStop();\r\n            }\r\n            editor.executeCommands(this.id, commands);\r\n            cursors.setPrevEditOperationType(2 /* DeletingLeft */);\r\n        };\r\n        return class_22;\r\n    }(CoreEditingCommand)));\r\n    CoreEditingCommands.DeleteRight = registerEditorCommand(new /** @class */ (function (_super) {\r\n        __extends(class_23, _super);\r\n        function class_23() {\r\n            return _super.call(this, {\r\n                id: 'deleteRight',\r\n                precondition: EditorContextKeys.writable,\r\n                kbOpts: {\r\n                    weight: CORE_WEIGHT,\r\n                    kbExpr: EditorContextKeys.textInputFocus,\r\n                    primary: 20 /* Delete */,\r\n                    mac: { primary: 20 /* Delete */, secondary: [256 /* WinCtrl */ | 34 /* KEY_D */, 256 /* WinCtrl */ | 20 /* Delete */] }\r\n                }\r\n            }) || this;\r\n        }\r\n        class_23.prototype.runCoreEditingCommand = function (editor, cursors, args) {\r\n            var _a = DeleteOperations.deleteRight(cursors.getPrevEditOperationType(), cursors.context.config, cursors.context.model, cursors.getAll().map(function (s) { return s.modelState.selection; })), shouldPushStackElementBefore = _a[0], commands = _a[1];\r\n            if (shouldPushStackElementBefore) {\r\n                editor.pushUndoStop();\r\n            }\r\n            editor.executeCommands(this.id, commands);\r\n            cursors.setPrevEditOperationType(3 /* DeletingRight */);\r\n        };\r\n        return class_23;\r\n    }(CoreEditingCommand)));\r\n})(CoreEditingCommands || (CoreEditingCommands = {}));\r\nfunction registerCommand(command) {\r\n    command.register();\r\n}\r\n/**\r\n * A command that will:\r\n *  1. invoke a command on the focused editor.\r\n *  2. otherwise, invoke a browser built-in command on the `activeElement`.\r\n *  3. otherwise, invoke a command on the workbench active editor.\r\n */\r\nvar EditorOrNativeTextInputCommand = /** @class */ (function (_super) {\r\n    __extends(EditorOrNativeTextInputCommand, _super);\r\n    function EditorOrNativeTextInputCommand(opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._editorHandler = opts.editorHandler;\r\n        _this._inputHandler = opts.inputHandler;\r\n        return _this;\r\n    }\r\n    EditorOrNativeTextInputCommand.prototype.runCommand = function (accessor, args) {\r\n        var focusedEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n        // Only if editor text focus (i.e. not if editor has widget focus).\r\n        if (focusedEditor && focusedEditor.hasTextFocus()) {\r\n            return this._runEditorHandler(accessor, focusedEditor, args);\r\n        }\r\n        // Ignore this action when user is focused on an element that allows for entering text\r\n        var activeElement = document.activeElement;\r\n        if (activeElement && ['input', 'textarea'].indexOf(activeElement.tagName.toLowerCase()) >= 0) {\r\n            document.execCommand(this._inputHandler);\r\n            return;\r\n        }\r\n        // Redirecting to active editor\r\n        var activeEditor = accessor.get(ICodeEditorService).getActiveCodeEditor();\r\n        if (activeEditor) {\r\n            activeEditor.focus();\r\n            return this._runEditorHandler(accessor, activeEditor, args);\r\n        }\r\n    };\r\n    EditorOrNativeTextInputCommand.prototype._runEditorHandler = function (accessor, editor, args) {\r\n        var HANDLER = this._editorHandler;\r\n        if (typeof HANDLER === 'string') {\r\n            editor.trigger('keyboard', HANDLER, args);\r\n        }\r\n        else {\r\n            args = args || {};\r\n            args.source = 'keyboard';\r\n            HANDLER.runEditorCommand(accessor, editor, args);\r\n        }\r\n    };\r\n    return EditorOrNativeTextInputCommand;\r\n}(Command));\r\n/**\r\n * A command that will invoke a command on the focused editor.\r\n */\r\nvar EditorHandlerCommand = /** @class */ (function (_super) {\r\n    __extends(EditorHandlerCommand, _super);\r\n    function EditorHandlerCommand(id, handlerId) {\r\n        var _this = _super.call(this, {\r\n            id: id,\r\n            precondition: null\r\n        }) || this;\r\n        _this._handlerId = handlerId;\r\n        return _this;\r\n    }\r\n    EditorHandlerCommand.prototype.runCommand = function (accessor, args) {\r\n        var editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n        if (!editor) {\r\n            return;\r\n        }\r\n        editor.trigger('keyboard', this._handlerId, args);\r\n    };\r\n    return EditorHandlerCommand;\r\n}(Command));\r\nregisterCommand(new EditorOrNativeTextInputCommand({\r\n    editorHandler: CoreNavigationCommands.SelectAll,\r\n    inputHandler: 'selectAll',\r\n    id: 'editor.action.selectAll',\r\n    precondition: EditorContextKeys.textInputFocus,\r\n    kbOpts: {\r\n        weight: CORE_WEIGHT,\r\n        kbExpr: null,\r\n        primary: 2048 /* CtrlCmd */ | 31 /* KEY_A */\r\n    },\r\n    menubarOpts: {\r\n        menuId: MenuId.MenubarSelectionMenu,\r\n        group: '1_basic',\r\n        title: nls.localize({ key: 'miSelectAll', comment: ['&& denotes a mnemonic'] }, \"&&Select All\"),\r\n        order: 1\r\n    }\r\n}));\r\nregisterCommand(new EditorOrNativeTextInputCommand({\r\n    editorHandler: Handler.Undo,\r\n    inputHandler: 'undo',\r\n    id: Handler.Undo,\r\n    precondition: EditorContextKeys.writable,\r\n    kbOpts: {\r\n        weight: CORE_WEIGHT,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 2048 /* CtrlCmd */ | 56 /* KEY_Z */\r\n    },\r\n    menubarOpts: {\r\n        menuId: MenuId.MenubarEditMenu,\r\n        group: '1_do',\r\n        title: nls.localize({ key: 'miUndo', comment: ['&& denotes a mnemonic'] }, \"&&Undo\"),\r\n        order: 1\r\n    }\r\n}));\r\nregisterCommand(new EditorHandlerCommand('default:' + Handler.Undo, Handler.Undo));\r\nregisterCommand(new EditorOrNativeTextInputCommand({\r\n    editorHandler: Handler.Redo,\r\n    inputHandler: 'redo',\r\n    id: Handler.Redo,\r\n    precondition: EditorContextKeys.writable,\r\n    kbOpts: {\r\n        weight: CORE_WEIGHT,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 2048 /* CtrlCmd */ | 55 /* KEY_Y */,\r\n        secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 56 /* KEY_Z */],\r\n        mac: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 56 /* KEY_Z */ }\r\n    },\r\n    menubarOpts: {\r\n        menuId: MenuId.MenubarEditMenu,\r\n        group: '1_do',\r\n        title: nls.localize({ key: 'miRedo', comment: ['&& denotes a mnemonic'] }, \"&&Redo\"),\r\n        order: 2\r\n    }\r\n}));\r\nregisterCommand(new EditorHandlerCommand('default:' + Handler.Redo, Handler.Redo));\r\nfunction registerOverwritableCommand(handlerId) {\r\n    registerCommand(new EditorHandlerCommand('default:' + handlerId, handlerId));\r\n    registerCommand(new EditorHandlerCommand(handlerId, handlerId));\r\n}\r\nregisterOverwritableCommand(Handler.Type);\r\nregisterOverwritableCommand(Handler.ReplacePreviousChar);\r\nregisterOverwritableCommand(Handler.CompositionStart);\r\nregisterOverwritableCommand(Handler.CompositionEnd);\r\nregisterOverwritableCommand(Handler.Paste);\r\nregisterOverwritableCommand(Handler.Cut);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { CoreNavigationCommands } from '../controller/coreCommands.js';\r\nimport { Position } from '../../common/core/position.js';\r\nvar ViewController = /** @class */ (function () {\r\n    function ViewController(configuration, viewModel, outgoingEvents, commandDelegate) {\r\n        this.configuration = configuration;\r\n        this.viewModel = viewModel;\r\n        this.outgoingEvents = outgoingEvents;\r\n        this.commandDelegate = commandDelegate;\r\n    }\r\n    ViewController.prototype._execMouseCommand = function (editorCommand, args) {\r\n        args.source = 'mouse';\r\n        this.commandDelegate.executeEditorCommand(editorCommand, args);\r\n    };\r\n    ViewController.prototype.paste = function (source, text, pasteOnNewLine, multicursorText) {\r\n        this.commandDelegate.paste(source, text, pasteOnNewLine, multicursorText);\r\n    };\r\n    ViewController.prototype.type = function (source, text) {\r\n        this.commandDelegate.type(source, text);\r\n    };\r\n    ViewController.prototype.replacePreviousChar = function (source, text, replaceCharCnt) {\r\n        this.commandDelegate.replacePreviousChar(source, text, replaceCharCnt);\r\n    };\r\n    ViewController.prototype.compositionStart = function (source) {\r\n        this.commandDelegate.compositionStart(source);\r\n    };\r\n    ViewController.prototype.compositionEnd = function (source) {\r\n        this.commandDelegate.compositionEnd(source);\r\n    };\r\n    ViewController.prototype.cut = function (source) {\r\n        this.commandDelegate.cut(source);\r\n    };\r\n    ViewController.prototype.setSelection = function (source, modelSelection) {\r\n        this.commandDelegate.executeEditorCommand(CoreNavigationCommands.SetSelection, {\r\n            source: source,\r\n            selection: modelSelection\r\n        });\r\n    };\r\n    ViewController.prototype._validateViewColumn = function (viewPosition) {\r\n        var minColumn = this.viewModel.getLineMinColumn(viewPosition.lineNumber);\r\n        if (viewPosition.column < minColumn) {\r\n            return new Position(viewPosition.lineNumber, minColumn);\r\n        }\r\n        return viewPosition;\r\n    };\r\n    ViewController.prototype._hasMulticursorModifier = function (data) {\r\n        switch (this.configuration.editor.multiCursorModifier) {\r\n            case 'altKey':\r\n                return data.altKey;\r\n            case 'ctrlKey':\r\n                return data.ctrlKey;\r\n            case 'metaKey':\r\n                return data.metaKey;\r\n        }\r\n        return false;\r\n    };\r\n    ViewController.prototype._hasNonMulticursorModifier = function (data) {\r\n        switch (this.configuration.editor.multiCursorModifier) {\r\n            case 'altKey':\r\n                return data.ctrlKey || data.metaKey;\r\n            case 'ctrlKey':\r\n                return data.altKey || data.metaKey;\r\n            case 'metaKey':\r\n                return data.ctrlKey || data.altKey;\r\n        }\r\n        return false;\r\n    };\r\n    ViewController.prototype.dispatchMouse = function (data) {\r\n        if (data.middleButton) {\r\n            if (data.inSelectionMode) {\r\n                this.columnSelect(data.position, data.mouseColumn);\r\n            }\r\n            else {\r\n                this.moveTo(data.position);\r\n            }\r\n        }\r\n        else if (data.startedOnLineNumbers) {\r\n            // If the dragging started on the gutter, then have operations work on the entire line\r\n            if (this._hasMulticursorModifier(data)) {\r\n                if (data.inSelectionMode) {\r\n                    this.lastCursorLineSelect(data.position);\r\n                }\r\n                else {\r\n                    this.createCursor(data.position, true);\r\n                }\r\n            }\r\n            else {\r\n                if (data.inSelectionMode) {\r\n                    this.lineSelectDrag(data.position);\r\n                }\r\n                else {\r\n                    this.lineSelect(data.position);\r\n                }\r\n            }\r\n        }\r\n        else if (data.mouseDownCount >= 4) {\r\n            this.selectAll();\r\n        }\r\n        else if (data.mouseDownCount === 3) {\r\n            if (this._hasMulticursorModifier(data)) {\r\n                if (data.inSelectionMode) {\r\n                    this.lastCursorLineSelectDrag(data.position);\r\n                }\r\n                else {\r\n                    this.lastCursorLineSelect(data.position);\r\n                }\r\n            }\r\n            else {\r\n                if (data.inSelectionMode) {\r\n                    this.lineSelectDrag(data.position);\r\n                }\r\n                else {\r\n                    this.lineSelect(data.position);\r\n                }\r\n            }\r\n        }\r\n        else if (data.mouseDownCount === 2) {\r\n            if (this._hasMulticursorModifier(data)) {\r\n                this.lastCursorWordSelect(data.position);\r\n            }\r\n            else {\r\n                if (data.inSelectionMode) {\r\n                    this.wordSelectDrag(data.position);\r\n                }\r\n                else {\r\n                    this.wordSelect(data.position);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (this._hasMulticursorModifier(data)) {\r\n                if (!this._hasNonMulticursorModifier(data)) {\r\n                    if (data.shiftKey) {\r\n                        this.columnSelect(data.position, data.mouseColumn);\r\n                    }\r\n                    else {\r\n                        // Do multi-cursor operations only when purely alt is pressed\r\n                        if (data.inSelectionMode) {\r\n                            this.lastCursorMoveToSelect(data.position);\r\n                        }\r\n                        else {\r\n                            this.createCursor(data.position, false);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                if (data.inSelectionMode) {\r\n                    this.moveToSelect(data.position);\r\n                }\r\n                else {\r\n                    this.moveTo(data.position);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    ViewController.prototype._usualArgs = function (viewPosition) {\r\n        viewPosition = this._validateViewColumn(viewPosition);\r\n        return {\r\n            position: this.convertViewToModelPosition(viewPosition),\r\n            viewPosition: viewPosition\r\n        };\r\n    };\r\n    ViewController.prototype.moveTo = function (viewPosition) {\r\n        this._execMouseCommand(CoreNavigationCommands.MoveTo, this._usualArgs(viewPosition));\r\n    };\r\n    ViewController.prototype.moveToSelect = function (viewPosition) {\r\n        this._execMouseCommand(CoreNavigationCommands.MoveToSelect, this._usualArgs(viewPosition));\r\n    };\r\n    ViewController.prototype.columnSelect = function (viewPosition, mouseColumn) {\r\n        viewPosition = this._validateViewColumn(viewPosition);\r\n        this._execMouseCommand(CoreNavigationCommands.ColumnSelect, {\r\n            position: this.convertViewToModelPosition(viewPosition),\r\n            viewPosition: viewPosition,\r\n            mouseColumn: mouseColumn\r\n        });\r\n    };\r\n    ViewController.prototype.createCursor = function (viewPosition, wholeLine) {\r\n        viewPosition = this._validateViewColumn(viewPosition);\r\n        this._execMouseCommand(CoreNavigationCommands.CreateCursor, {\r\n            position: this.convertViewToModelPosition(viewPosition),\r\n            viewPosition: viewPosition,\r\n            wholeLine: wholeLine\r\n        });\r\n    };\r\n    ViewController.prototype.lastCursorMoveToSelect = function (viewPosition) {\r\n        this._execMouseCommand(CoreNavigationCommands.LastCursorMoveToSelect, this._usualArgs(viewPosition));\r\n    };\r\n    ViewController.prototype.wordSelect = function (viewPosition) {\r\n        this._execMouseCommand(CoreNavigationCommands.WordSelect, this._usualArgs(viewPosition));\r\n    };\r\n    ViewController.prototype.wordSelectDrag = function (viewPosition) {\r\n        this._execMouseCommand(CoreNavigationCommands.WordSelectDrag, this._usualArgs(viewPosition));\r\n    };\r\n    ViewController.prototype.lastCursorWordSelect = function (viewPosition) {\r\n        this._execMouseCommand(CoreNavigationCommands.LastCursorWordSelect, this._usualArgs(viewPosition));\r\n    };\r\n    ViewController.prototype.lineSelect = function (viewPosition) {\r\n        this._execMouseCommand(CoreNavigationCommands.LineSelect, this._usualArgs(viewPosition));\r\n    };\r\n    ViewController.prototype.lineSelectDrag = function (viewPosition) {\r\n        this._execMouseCommand(CoreNavigationCommands.LineSelectDrag, this._usualArgs(viewPosition));\r\n    };\r\n    ViewController.prototype.lastCursorLineSelect = function (viewPosition) {\r\n        this._execMouseCommand(CoreNavigationCommands.LastCursorLineSelect, this._usualArgs(viewPosition));\r\n    };\r\n    ViewController.prototype.lastCursorLineSelectDrag = function (viewPosition) {\r\n        this._execMouseCommand(CoreNavigationCommands.LastCursorLineSelectDrag, this._usualArgs(viewPosition));\r\n    };\r\n    ViewController.prototype.selectAll = function () {\r\n        this._execMouseCommand(CoreNavigationCommands.SelectAll, {});\r\n    };\r\n    // ----------------------\r\n    ViewController.prototype.convertViewToModelPosition = function (viewPosition) {\r\n        return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(viewPosition);\r\n    };\r\n    ViewController.prototype.emitKeyDown = function (e) {\r\n        this.outgoingEvents.emitKeyDown(e);\r\n    };\r\n    ViewController.prototype.emitKeyUp = function (e) {\r\n        this.outgoingEvents.emitKeyUp(e);\r\n    };\r\n    ViewController.prototype.emitContextMenu = function (e) {\r\n        this.outgoingEvents.emitContextMenu(e);\r\n    };\r\n    ViewController.prototype.emitMouseMove = function (e) {\r\n        this.outgoingEvents.emitMouseMove(e);\r\n    };\r\n    ViewController.prototype.emitMouseLeave = function (e) {\r\n        this.outgoingEvents.emitMouseLeave(e);\r\n    };\r\n    ViewController.prototype.emitMouseUp = function (e) {\r\n        this.outgoingEvents.emitMouseUp(e);\r\n    };\r\n    ViewController.prototype.emitMouseDown = function (e) {\r\n        this.outgoingEvents.emitMouseDown(e);\r\n    };\r\n    ViewController.prototype.emitMouseDrag = function (e) {\r\n        this.outgoingEvents.emitMouseDrag(e);\r\n    };\r\n    ViewController.prototype.emitMouseDrop = function (e) {\r\n        this.outgoingEvents.emitMouseDrop(e);\r\n    };\r\n    return ViewController;\r\n}());\r\nexport { ViewController };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\r\nimport { createStringBuilder } from '../../common/core/stringBuilder.js';\r\nvar RenderedLinesCollection = /** @class */ (function () {\r\n    function RenderedLinesCollection(createLine) {\r\n        this._createLine = createLine;\r\n        this._set(1, []);\r\n    }\r\n    RenderedLinesCollection.prototype.flush = function () {\r\n        this._set(1, []);\r\n    };\r\n    RenderedLinesCollection.prototype._set = function (rendLineNumberStart, lines) {\r\n        this._lines = lines;\r\n        this._rendLineNumberStart = rendLineNumberStart;\r\n    };\r\n    RenderedLinesCollection.prototype._get = function () {\r\n        return {\r\n            rendLineNumberStart: this._rendLineNumberStart,\r\n            lines: this._lines\r\n        };\r\n    };\r\n    /**\r\n     * @returns Inclusive line number that is inside this collection\r\n     */\r\n    RenderedLinesCollection.prototype.getStartLineNumber = function () {\r\n        return this._rendLineNumberStart;\r\n    };\r\n    /**\r\n     * @returns Inclusive line number that is inside this collection\r\n     */\r\n    RenderedLinesCollection.prototype.getEndLineNumber = function () {\r\n        return this._rendLineNumberStart + this._lines.length - 1;\r\n    };\r\n    RenderedLinesCollection.prototype.getCount = function () {\r\n        return this._lines.length;\r\n    };\r\n    RenderedLinesCollection.prototype.getLine = function (lineNumber) {\r\n        var lineIndex = lineNumber - this._rendLineNumberStart;\r\n        if (lineIndex < 0 || lineIndex >= this._lines.length) {\r\n            throw new Error('Illegal value for lineNumber');\r\n        }\r\n        return this._lines[lineIndex];\r\n    };\r\n    /**\r\n     * @returns Lines that were removed from this collection\r\n     */\r\n    RenderedLinesCollection.prototype.onLinesDeleted = function (deleteFromLineNumber, deleteToLineNumber) {\r\n        if (this.getCount() === 0) {\r\n            // no lines\r\n            return null;\r\n        }\r\n        var startLineNumber = this.getStartLineNumber();\r\n        var endLineNumber = this.getEndLineNumber();\r\n        if (deleteToLineNumber < startLineNumber) {\r\n            // deleting above the viewport\r\n            var deleteCnt = deleteToLineNumber - deleteFromLineNumber + 1;\r\n            this._rendLineNumberStart -= deleteCnt;\r\n            return null;\r\n        }\r\n        if (deleteFromLineNumber > endLineNumber) {\r\n            // deleted below the viewport\r\n            return null;\r\n        }\r\n        // Record what needs to be deleted\r\n        var deleteStartIndex = 0;\r\n        var deleteCount = 0;\r\n        for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - this._rendLineNumberStart;\r\n            if (deleteFromLineNumber <= lineNumber && lineNumber <= deleteToLineNumber) {\r\n                // this is a line to be deleted\r\n                if (deleteCount === 0) {\r\n                    // this is the first line to be deleted\r\n                    deleteStartIndex = lineIndex;\r\n                    deleteCount = 1;\r\n                }\r\n                else {\r\n                    deleteCount++;\r\n                }\r\n            }\r\n        }\r\n        // Adjust this._rendLineNumberStart for lines deleted above\r\n        if (deleteFromLineNumber < startLineNumber) {\r\n            // Something was deleted above\r\n            var deleteAboveCount = 0;\r\n            if (deleteToLineNumber < startLineNumber) {\r\n                // the entire deleted lines are above\r\n                deleteAboveCount = deleteToLineNumber - deleteFromLineNumber + 1;\r\n            }\r\n            else {\r\n                deleteAboveCount = startLineNumber - deleteFromLineNumber;\r\n            }\r\n            this._rendLineNumberStart -= deleteAboveCount;\r\n        }\r\n        var deleted = this._lines.splice(deleteStartIndex, deleteCount);\r\n        return deleted;\r\n    };\r\n    RenderedLinesCollection.prototype.onLinesChanged = function (changeFromLineNumber, changeToLineNumber) {\r\n        if (this.getCount() === 0) {\r\n            // no lines\r\n            return false;\r\n        }\r\n        var startLineNumber = this.getStartLineNumber();\r\n        var endLineNumber = this.getEndLineNumber();\r\n        var someoneNotified = false;\r\n        for (var changedLineNumber = changeFromLineNumber; changedLineNumber <= changeToLineNumber; changedLineNumber++) {\r\n            if (changedLineNumber >= startLineNumber && changedLineNumber <= endLineNumber) {\r\n                // Notify the line\r\n                this._lines[changedLineNumber - this._rendLineNumberStart].onContentChanged();\r\n                someoneNotified = true;\r\n            }\r\n        }\r\n        return someoneNotified;\r\n    };\r\n    RenderedLinesCollection.prototype.onLinesInserted = function (insertFromLineNumber, insertToLineNumber) {\r\n        if (this.getCount() === 0) {\r\n            // no lines\r\n            return null;\r\n        }\r\n        var insertCnt = insertToLineNumber - insertFromLineNumber + 1;\r\n        var startLineNumber = this.getStartLineNumber();\r\n        var endLineNumber = this.getEndLineNumber();\r\n        if (insertFromLineNumber <= startLineNumber) {\r\n            // inserting above the viewport\r\n            this._rendLineNumberStart += insertCnt;\r\n            return null;\r\n        }\r\n        if (insertFromLineNumber > endLineNumber) {\r\n            // inserting below the viewport\r\n            return null;\r\n        }\r\n        if (insertCnt + insertFromLineNumber > endLineNumber) {\r\n            // insert inside the viewport in such a way that all remaining lines are pushed outside\r\n            var deleted = this._lines.splice(insertFromLineNumber - this._rendLineNumberStart, endLineNumber - insertFromLineNumber + 1);\r\n            return deleted;\r\n        }\r\n        // insert inside the viewport, push out some lines, but not all remaining lines\r\n        var newLines = [];\r\n        for (var i = 0; i < insertCnt; i++) {\r\n            newLines[i] = this._createLine();\r\n        }\r\n        var insertIndex = insertFromLineNumber - this._rendLineNumberStart;\r\n        var beforeLines = this._lines.slice(0, insertIndex);\r\n        var afterLines = this._lines.slice(insertIndex, this._lines.length - insertCnt);\r\n        var deletedLines = this._lines.slice(this._lines.length - insertCnt, this._lines.length);\r\n        this._lines = beforeLines.concat(newLines).concat(afterLines);\r\n        return deletedLines;\r\n    };\r\n    RenderedLinesCollection.prototype.onTokensChanged = function (ranges) {\r\n        if (this.getCount() === 0) {\r\n            // no lines\r\n            return false;\r\n        }\r\n        var startLineNumber = this.getStartLineNumber();\r\n        var endLineNumber = this.getEndLineNumber();\r\n        var notifiedSomeone = false;\r\n        for (var i = 0, len = ranges.length; i < len; i++) {\r\n            var rng = ranges[i];\r\n            if (rng.toLineNumber < startLineNumber || rng.fromLineNumber > endLineNumber) {\r\n                // range outside viewport\r\n                continue;\r\n            }\r\n            var from = Math.max(startLineNumber, rng.fromLineNumber);\r\n            var to = Math.min(endLineNumber, rng.toLineNumber);\r\n            for (var lineNumber = from; lineNumber <= to; lineNumber++) {\r\n                var lineIndex = lineNumber - this._rendLineNumberStart;\r\n                this._lines[lineIndex].onTokensChanged();\r\n                notifiedSomeone = true;\r\n            }\r\n        }\r\n        return notifiedSomeone;\r\n    };\r\n    return RenderedLinesCollection;\r\n}());\r\nexport { RenderedLinesCollection };\r\nvar VisibleLinesCollection = /** @class */ (function () {\r\n    function VisibleLinesCollection(host) {\r\n        var _this = this;\r\n        this._host = host;\r\n        this.domNode = this._createDomNode();\r\n        this._linesCollection = new RenderedLinesCollection(function () { return _this._host.createVisibleLine(); });\r\n    }\r\n    VisibleLinesCollection.prototype._createDomNode = function () {\r\n        var domNode = createFastDomNode(document.createElement('div'));\r\n        domNode.setClassName('view-layer');\r\n        domNode.setPosition('absolute');\r\n        domNode.domNode.setAttribute('role', 'presentation');\r\n        domNode.domNode.setAttribute('aria-hidden', 'true');\r\n        return domNode;\r\n    };\r\n    // ---- begin view event handlers\r\n    VisibleLinesCollection.prototype.onConfigurationChanged = function (e) {\r\n        return e.layoutInfo;\r\n    };\r\n    VisibleLinesCollection.prototype.onFlushed = function (e) {\r\n        this._linesCollection.flush();\r\n        // No need to clear the dom node because a full .innerHTML will occur in ViewLayerRenderer._render\r\n        return true;\r\n    };\r\n    VisibleLinesCollection.prototype.onLinesChanged = function (e) {\r\n        return this._linesCollection.onLinesChanged(e.fromLineNumber, e.toLineNumber);\r\n    };\r\n    VisibleLinesCollection.prototype.onLinesDeleted = function (e) {\r\n        var deleted = this._linesCollection.onLinesDeleted(e.fromLineNumber, e.toLineNumber);\r\n        if (deleted) {\r\n            // Remove from DOM\r\n            for (var i = 0, len = deleted.length; i < len; i++) {\r\n                var lineDomNode = deleted[i].getDomNode();\r\n                if (lineDomNode) {\r\n                    this.domNode.domNode.removeChild(lineDomNode);\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    VisibleLinesCollection.prototype.onLinesInserted = function (e) {\r\n        var deleted = this._linesCollection.onLinesInserted(e.fromLineNumber, e.toLineNumber);\r\n        if (deleted) {\r\n            // Remove from DOM\r\n            for (var i = 0, len = deleted.length; i < len; i++) {\r\n                var lineDomNode = deleted[i].getDomNode();\r\n                if (lineDomNode) {\r\n                    this.domNode.domNode.removeChild(lineDomNode);\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    VisibleLinesCollection.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged;\r\n    };\r\n    VisibleLinesCollection.prototype.onTokensChanged = function (e) {\r\n        return this._linesCollection.onTokensChanged(e.ranges);\r\n    };\r\n    VisibleLinesCollection.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // ---- end view event handlers\r\n    VisibleLinesCollection.prototype.getStartLineNumber = function () {\r\n        return this._linesCollection.getStartLineNumber();\r\n    };\r\n    VisibleLinesCollection.prototype.getEndLineNumber = function () {\r\n        return this._linesCollection.getEndLineNumber();\r\n    };\r\n    VisibleLinesCollection.prototype.getVisibleLine = function (lineNumber) {\r\n        return this._linesCollection.getLine(lineNumber);\r\n    };\r\n    VisibleLinesCollection.prototype.renderLines = function (viewportData) {\r\n        var inp = this._linesCollection._get();\r\n        var renderer = new ViewLayerRenderer(this.domNode.domNode, this._host, viewportData);\r\n        var ctx = {\r\n            rendLineNumberStart: inp.rendLineNumberStart,\r\n            lines: inp.lines,\r\n            linesLength: inp.lines.length\r\n        };\r\n        // Decide if this render will do a single update (single large .innerHTML) or many updates (inserting/removing dom nodes)\r\n        var resCtx = renderer.render(ctx, viewportData.startLineNumber, viewportData.endLineNumber, viewportData.relativeVerticalOffset);\r\n        this._linesCollection._set(resCtx.rendLineNumberStart, resCtx.lines);\r\n    };\r\n    return VisibleLinesCollection;\r\n}());\r\nexport { VisibleLinesCollection };\r\nvar ViewLayerRenderer = /** @class */ (function () {\r\n    function ViewLayerRenderer(domNode, host, viewportData) {\r\n        this.domNode = domNode;\r\n        this.host = host;\r\n        this.viewportData = viewportData;\r\n    }\r\n    ViewLayerRenderer.prototype.render = function (inContext, startLineNumber, stopLineNumber, deltaTop) {\r\n        var ctx = {\r\n            rendLineNumberStart: inContext.rendLineNumberStart,\r\n            lines: inContext.lines.slice(0),\r\n            linesLength: inContext.linesLength\r\n        };\r\n        if ((ctx.rendLineNumberStart + ctx.linesLength - 1 < startLineNumber) || (stopLineNumber < ctx.rendLineNumberStart)) {\r\n            // There is no overlap whatsoever\r\n            ctx.rendLineNumberStart = startLineNumber;\r\n            ctx.linesLength = stopLineNumber - startLineNumber + 1;\r\n            ctx.lines = [];\r\n            for (var x = startLineNumber; x <= stopLineNumber; x++) {\r\n                ctx.lines[x - startLineNumber] = this.host.createVisibleLine();\r\n            }\r\n            this._finishRendering(ctx, true, deltaTop);\r\n            return ctx;\r\n        }\r\n        // Update lines which will remain untouched\r\n        this._renderUntouchedLines(ctx, Math.max(startLineNumber - ctx.rendLineNumberStart, 0), Math.min(stopLineNumber - ctx.rendLineNumberStart, ctx.linesLength - 1), deltaTop, startLineNumber);\r\n        if (ctx.rendLineNumberStart > startLineNumber) {\r\n            // Insert lines before\r\n            var fromLineNumber = startLineNumber;\r\n            var toLineNumber = Math.min(stopLineNumber, ctx.rendLineNumberStart - 1);\r\n            if (fromLineNumber <= toLineNumber) {\r\n                this._insertLinesBefore(ctx, fromLineNumber, toLineNumber, deltaTop, startLineNumber);\r\n                ctx.linesLength += toLineNumber - fromLineNumber + 1;\r\n            }\r\n        }\r\n        else if (ctx.rendLineNumberStart < startLineNumber) {\r\n            // Remove lines before\r\n            var removeCnt = Math.min(ctx.linesLength, startLineNumber - ctx.rendLineNumberStart);\r\n            if (removeCnt > 0) {\r\n                this._removeLinesBefore(ctx, removeCnt);\r\n                ctx.linesLength -= removeCnt;\r\n            }\r\n        }\r\n        ctx.rendLineNumberStart = startLineNumber;\r\n        if (ctx.rendLineNumberStart + ctx.linesLength - 1 < stopLineNumber) {\r\n            // Insert lines after\r\n            var fromLineNumber = ctx.rendLineNumberStart + ctx.linesLength;\r\n            var toLineNumber = stopLineNumber;\r\n            if (fromLineNumber <= toLineNumber) {\r\n                this._insertLinesAfter(ctx, fromLineNumber, toLineNumber, deltaTop, startLineNumber);\r\n                ctx.linesLength += toLineNumber - fromLineNumber + 1;\r\n            }\r\n        }\r\n        else if (ctx.rendLineNumberStart + ctx.linesLength - 1 > stopLineNumber) {\r\n            // Remove lines after\r\n            var fromLineNumber = Math.max(0, stopLineNumber - ctx.rendLineNumberStart + 1);\r\n            var toLineNumber = ctx.linesLength - 1;\r\n            var removeCnt = toLineNumber - fromLineNumber + 1;\r\n            if (removeCnt > 0) {\r\n                this._removeLinesAfter(ctx, removeCnt);\r\n                ctx.linesLength -= removeCnt;\r\n            }\r\n        }\r\n        this._finishRendering(ctx, false, deltaTop);\r\n        return ctx;\r\n    };\r\n    ViewLayerRenderer.prototype._renderUntouchedLines = function (ctx, startIndex, endIndex, deltaTop, deltaLN) {\r\n        var rendLineNumberStart = ctx.rendLineNumberStart;\r\n        var lines = ctx.lines;\r\n        for (var i = startIndex; i <= endIndex; i++) {\r\n            var lineNumber = rendLineNumberStart + i;\r\n            lines[i].layoutLine(lineNumber, deltaTop[lineNumber - deltaLN]);\r\n        }\r\n    };\r\n    ViewLayerRenderer.prototype._insertLinesBefore = function (ctx, fromLineNumber, toLineNumber, deltaTop, deltaLN) {\r\n        var newLines = [];\r\n        var newLinesLen = 0;\r\n        for (var lineNumber = fromLineNumber; lineNumber <= toLineNumber; lineNumber++) {\r\n            newLines[newLinesLen++] = this.host.createVisibleLine();\r\n        }\r\n        ctx.lines = newLines.concat(ctx.lines);\r\n    };\r\n    ViewLayerRenderer.prototype._removeLinesBefore = function (ctx, removeCount) {\r\n        for (var i = 0; i < removeCount; i++) {\r\n            var lineDomNode = ctx.lines[i].getDomNode();\r\n            if (lineDomNode) {\r\n                this.domNode.removeChild(lineDomNode);\r\n            }\r\n        }\r\n        ctx.lines.splice(0, removeCount);\r\n    };\r\n    ViewLayerRenderer.prototype._insertLinesAfter = function (ctx, fromLineNumber, toLineNumber, deltaTop, deltaLN) {\r\n        var newLines = [];\r\n        var newLinesLen = 0;\r\n        for (var lineNumber = fromLineNumber; lineNumber <= toLineNumber; lineNumber++) {\r\n            newLines[newLinesLen++] = this.host.createVisibleLine();\r\n        }\r\n        ctx.lines = ctx.lines.concat(newLines);\r\n    };\r\n    ViewLayerRenderer.prototype._removeLinesAfter = function (ctx, removeCount) {\r\n        var removeIndex = ctx.linesLength - removeCount;\r\n        for (var i = 0; i < removeCount; i++) {\r\n            var lineDomNode = ctx.lines[removeIndex + i].getDomNode();\r\n            if (lineDomNode) {\r\n                this.domNode.removeChild(lineDomNode);\r\n            }\r\n        }\r\n        ctx.lines.splice(removeIndex, removeCount);\r\n    };\r\n    ViewLayerRenderer.prototype._finishRenderingNewLines = function (ctx, domNodeIsEmpty, newLinesHTML, wasNew) {\r\n        var lastChild = this.domNode.lastChild;\r\n        if (domNodeIsEmpty || !lastChild) {\r\n            this.domNode.innerHTML = newLinesHTML;\r\n        }\r\n        else {\r\n            lastChild.insertAdjacentHTML('afterend', newLinesHTML);\r\n        }\r\n        var currChild = this.domNode.lastChild;\r\n        for (var i = ctx.linesLength - 1; i >= 0; i--) {\r\n            var line = ctx.lines[i];\r\n            if (wasNew[i]) {\r\n                line.setDomNode(currChild);\r\n                currChild = currChild.previousSibling;\r\n            }\r\n        }\r\n    };\r\n    ViewLayerRenderer.prototype._finishRenderingInvalidLines = function (ctx, invalidLinesHTML, wasInvalid) {\r\n        var hugeDomNode = document.createElement('div');\r\n        hugeDomNode.innerHTML = invalidLinesHTML;\r\n        for (var i = 0; i < ctx.linesLength; i++) {\r\n            var line = ctx.lines[i];\r\n            if (wasInvalid[i]) {\r\n                var source = hugeDomNode.firstChild;\r\n                var lineDomNode = line.getDomNode();\r\n                lineDomNode.parentNode.replaceChild(source, lineDomNode);\r\n                line.setDomNode(source);\r\n            }\r\n        }\r\n    };\r\n    ViewLayerRenderer.prototype._finishRendering = function (ctx, domNodeIsEmpty, deltaTop) {\r\n        var sb = ViewLayerRenderer._sb;\r\n        var linesLength = ctx.linesLength;\r\n        var lines = ctx.lines;\r\n        var rendLineNumberStart = ctx.rendLineNumberStart;\r\n        var wasNew = [];\r\n        {\r\n            sb.reset();\r\n            var hadNewLine = false;\r\n            for (var i = 0; i < linesLength; i++) {\r\n                var line = lines[i];\r\n                wasNew[i] = false;\r\n                var lineDomNode = line.getDomNode();\r\n                if (lineDomNode) {\r\n                    // line is not new\r\n                    continue;\r\n                }\r\n                var renderResult = line.renderLine(i + rendLineNumberStart, deltaTop[i], this.viewportData, sb);\r\n                if (!renderResult) {\r\n                    // line does not need rendering\r\n                    continue;\r\n                }\r\n                wasNew[i] = true;\r\n                hadNewLine = true;\r\n            }\r\n            if (hadNewLine) {\r\n                this._finishRenderingNewLines(ctx, domNodeIsEmpty, sb.build(), wasNew);\r\n            }\r\n        }\r\n        {\r\n            sb.reset();\r\n            var hadInvalidLine = false;\r\n            var wasInvalid = [];\r\n            for (var i = 0; i < linesLength; i++) {\r\n                var line = lines[i];\r\n                wasInvalid[i] = false;\r\n                if (wasNew[i]) {\r\n                    // line was new\r\n                    continue;\r\n                }\r\n                var renderResult = line.renderLine(i + rendLineNumberStart, deltaTop[i], this.viewportData, sb);\r\n                if (!renderResult) {\r\n                    // line does not need rendering\r\n                    continue;\r\n                }\r\n                wasInvalid[i] = true;\r\n                hadInvalidLine = true;\r\n            }\r\n            if (hadInvalidLine) {\r\n                this._finishRenderingInvalidLines(ctx, sb.build(), wasInvalid);\r\n            }\r\n        }\r\n    };\r\n    ViewLayerRenderer._sb = createStringBuilder(100000);\r\n    return ViewLayerRenderer;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\r\nimport { Configuration } from '../config/configuration.js';\r\nimport { VisibleLinesCollection } from './viewLayer.js';\r\nimport { ViewPart } from './viewPart.js';\r\nvar ViewOverlays = /** @class */ (function (_super) {\r\n    __extends(ViewOverlays, _super);\r\n    function ViewOverlays(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._visibleLines = new VisibleLinesCollection(_this);\r\n        _this.domNode = _this._visibleLines.domNode;\r\n        _this._dynamicOverlays = [];\r\n        _this._isFocused = false;\r\n        _this.domNode.setClassName('view-overlays');\r\n        return _this;\r\n    }\r\n    ViewOverlays.prototype.shouldRender = function () {\r\n        if (_super.prototype.shouldRender.call(this)) {\r\n            return true;\r\n        }\r\n        for (var i = 0, len = this._dynamicOverlays.length; i < len; i++) {\r\n            var dynamicOverlay = this._dynamicOverlays[i];\r\n            if (dynamicOverlay.shouldRender()) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    ViewOverlays.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        for (var i = 0, len = this._dynamicOverlays.length; i < len; i++) {\r\n            var dynamicOverlay = this._dynamicOverlays[i];\r\n            dynamicOverlay.dispose();\r\n        }\r\n        this._dynamicOverlays = [];\r\n    };\r\n    ViewOverlays.prototype.getDomNode = function () {\r\n        return this.domNode;\r\n    };\r\n    // ---- begin IVisibleLinesHost\r\n    ViewOverlays.prototype.createVisibleLine = function () {\r\n        return new ViewOverlayLine(this._context.configuration, this._dynamicOverlays);\r\n    };\r\n    // ---- end IVisibleLinesHost\r\n    ViewOverlays.prototype.addDynamicOverlay = function (overlay) {\r\n        this._dynamicOverlays.push(overlay);\r\n    };\r\n    // ----- event handlers\r\n    ViewOverlays.prototype.onConfigurationChanged = function (e) {\r\n        this._visibleLines.onConfigurationChanged(e);\r\n        var startLineNumber = this._visibleLines.getStartLineNumber();\r\n        var endLineNumber = this._visibleLines.getEndLineNumber();\r\n        for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n            var line = this._visibleLines.getVisibleLine(lineNumber);\r\n            line.onConfigurationChanged(e);\r\n        }\r\n        return true;\r\n    };\r\n    ViewOverlays.prototype.onFlushed = function (e) {\r\n        return this._visibleLines.onFlushed(e);\r\n    };\r\n    ViewOverlays.prototype.onFocusChanged = function (e) {\r\n        this._isFocused = e.isFocused;\r\n        return true;\r\n    };\r\n    ViewOverlays.prototype.onLinesChanged = function (e) {\r\n        return this._visibleLines.onLinesChanged(e);\r\n    };\r\n    ViewOverlays.prototype.onLinesDeleted = function (e) {\r\n        return this._visibleLines.onLinesDeleted(e);\r\n    };\r\n    ViewOverlays.prototype.onLinesInserted = function (e) {\r\n        return this._visibleLines.onLinesInserted(e);\r\n    };\r\n    ViewOverlays.prototype.onScrollChanged = function (e) {\r\n        return this._visibleLines.onScrollChanged(e) || true;\r\n    };\r\n    ViewOverlays.prototype.onTokensChanged = function (e) {\r\n        return this._visibleLines.onTokensChanged(e);\r\n    };\r\n    ViewOverlays.prototype.onZonesChanged = function (e) {\r\n        return this._visibleLines.onZonesChanged(e);\r\n    };\r\n    // ----- end event handlers\r\n    ViewOverlays.prototype.prepareRender = function (ctx) {\r\n        var toRender = this._dynamicOverlays.filter(function (overlay) { return overlay.shouldRender(); });\r\n        for (var i = 0, len = toRender.length; i < len; i++) {\r\n            var dynamicOverlay = toRender[i];\r\n            dynamicOverlay.prepareRender(ctx);\r\n            dynamicOverlay.onDidRender();\r\n        }\r\n    };\r\n    ViewOverlays.prototype.render = function (ctx) {\r\n        // Overwriting to bypass `shouldRender` flag\r\n        this._viewOverlaysRender(ctx);\r\n        this.domNode.toggleClassName('focused', this._isFocused);\r\n    };\r\n    ViewOverlays.prototype._viewOverlaysRender = function (ctx) {\r\n        this._visibleLines.renderLines(ctx.viewportData);\r\n    };\r\n    return ViewOverlays;\r\n}(ViewPart));\r\nexport { ViewOverlays };\r\nvar ViewOverlayLine = /** @class */ (function () {\r\n    function ViewOverlayLine(configuration, dynamicOverlays) {\r\n        this._configuration = configuration;\r\n        this._lineHeight = this._configuration.editor.lineHeight;\r\n        this._dynamicOverlays = dynamicOverlays;\r\n        this._domNode = null;\r\n        this._renderedContent = null;\r\n    }\r\n    ViewOverlayLine.prototype.getDomNode = function () {\r\n        if (!this._domNode) {\r\n            return null;\r\n        }\r\n        return this._domNode.domNode;\r\n    };\r\n    ViewOverlayLine.prototype.setDomNode = function (domNode) {\r\n        this._domNode = createFastDomNode(domNode);\r\n    };\r\n    ViewOverlayLine.prototype.onContentChanged = function () {\r\n        // Nothing\r\n    };\r\n    ViewOverlayLine.prototype.onTokensChanged = function () {\r\n        // Nothing\r\n    };\r\n    ViewOverlayLine.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._lineHeight = this._configuration.editor.lineHeight;\r\n        }\r\n    };\r\n    ViewOverlayLine.prototype.renderLine = function (lineNumber, deltaTop, viewportData, sb) {\r\n        var result = '';\r\n        for (var i = 0, len = this._dynamicOverlays.length; i < len; i++) {\r\n            var dynamicOverlay = this._dynamicOverlays[i];\r\n            result += dynamicOverlay.render(viewportData.startLineNumber, lineNumber);\r\n        }\r\n        if (this._renderedContent === result) {\r\n            // No rendering needed\r\n            return false;\r\n        }\r\n        this._renderedContent = result;\r\n        sb.appendASCIIString('<div style=\"position:absolute;top:');\r\n        sb.appendASCIIString(String(deltaTop));\r\n        sb.appendASCIIString('px;width:100%;height:');\r\n        sb.appendASCIIString(String(this._lineHeight));\r\n        sb.appendASCIIString('px;\">');\r\n        sb.appendASCIIString(result);\r\n        sb.appendASCIIString('</div>');\r\n        return true;\r\n    };\r\n    ViewOverlayLine.prototype.layoutLine = function (lineNumber, deltaTop) {\r\n        if (this._domNode) {\r\n            this._domNode.setTop(deltaTop);\r\n            this._domNode.setHeight(this._lineHeight);\r\n        }\r\n    };\r\n    return ViewOverlayLine;\r\n}());\r\nexport { ViewOverlayLine };\r\nvar ContentViewOverlays = /** @class */ (function (_super) {\r\n    __extends(ContentViewOverlays, _super);\r\n    function ContentViewOverlays(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._contentWidth = _this._context.configuration.editor.layoutInfo.contentWidth;\r\n        _this.domNode.setHeight(0);\r\n        return _this;\r\n    }\r\n    // --- begin event handlers\r\n    ContentViewOverlays.prototype.onConfigurationChanged = function (e) {\r\n        if (e.layoutInfo) {\r\n            this._contentWidth = this._context.configuration.editor.layoutInfo.contentWidth;\r\n        }\r\n        return _super.prototype.onConfigurationChanged.call(this, e);\r\n    };\r\n    ContentViewOverlays.prototype.onScrollChanged = function (e) {\r\n        return _super.prototype.onScrollChanged.call(this, e) || e.scrollWidthChanged;\r\n    };\r\n    // --- end event handlers\r\n    ContentViewOverlays.prototype._viewOverlaysRender = function (ctx) {\r\n        _super.prototype._viewOverlaysRender.call(this, ctx);\r\n        this.domNode.setWidth(Math.max(ctx.scrollWidth, this._contentWidth));\r\n    };\r\n    return ContentViewOverlays;\r\n}(ViewOverlays));\r\nexport { ContentViewOverlays };\r\nvar MarginViewOverlays = /** @class */ (function (_super) {\r\n    __extends(MarginViewOverlays, _super);\r\n    function MarginViewOverlays(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._contentLeft = _this._context.configuration.editor.layoutInfo.contentLeft;\r\n        _this.domNode.setClassName('margin-view-overlays');\r\n        _this.domNode.setWidth(1);\r\n        Configuration.applyFontInfo(_this.domNode, _this._context.configuration.editor.fontInfo);\r\n        return _this;\r\n    }\r\n    MarginViewOverlays.prototype.onConfigurationChanged = function (e) {\r\n        var shouldRender = false;\r\n        if (e.fontInfo) {\r\n            Configuration.applyFontInfo(this.domNode, this._context.configuration.editor.fontInfo);\r\n            shouldRender = true;\r\n        }\r\n        if (e.layoutInfo) {\r\n            this._contentLeft = this._context.configuration.editor.layoutInfo.contentLeft;\r\n            shouldRender = true;\r\n        }\r\n        return _super.prototype.onConfigurationChanged.call(this, e) || shouldRender;\r\n    };\r\n    MarginViewOverlays.prototype.onScrollChanged = function (e) {\r\n        return _super.prototype.onScrollChanged.call(this, e) || e.scrollHeightChanged;\r\n    };\r\n    MarginViewOverlays.prototype._viewOverlaysRender = function (ctx) {\r\n        _super.prototype._viewOverlaysRender.call(this, ctx);\r\n        var height = Math.min(ctx.scrollHeight, 1000000);\r\n        this.domNode.setHeight(height);\r\n        this.domNode.setWidth(this._contentLeft);\r\n    };\r\n    return MarginViewOverlays;\r\n}(ViewOverlays));\r\nexport { MarginViewOverlays };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\r\nvar Coordinate = /** @class */ (function () {\r\n    function Coordinate(top, left) {\r\n        this.top = top;\r\n        this.left = left;\r\n    }\r\n    return Coordinate;\r\n}());\r\nvar ViewContentWidgets = /** @class */ (function (_super) {\r\n    __extends(ViewContentWidgets, _super);\r\n    function ViewContentWidgets(context, viewDomNode) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._viewDomNode = viewDomNode;\r\n        _this._widgets = {};\r\n        _this.domNode = createFastDomNode(document.createElement('div'));\r\n        PartFingerprints.write(_this.domNode, 1 /* ContentWidgets */);\r\n        _this.domNode.setClassName('contentWidgets');\r\n        _this.domNode.setPosition('absolute');\r\n        _this.domNode.setTop(0);\r\n        _this.overflowingContentWidgetsDomNode = createFastDomNode(document.createElement('div'));\r\n        PartFingerprints.write(_this.overflowingContentWidgetsDomNode, 2 /* OverflowingContentWidgets */);\r\n        _this.overflowingContentWidgetsDomNode.setClassName('overflowingContentWidgets');\r\n        return _this;\r\n    }\r\n    ViewContentWidgets.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._widgets = {};\r\n    };\r\n    // --- begin event handlers\r\n    ViewContentWidgets.prototype.onConfigurationChanged = function (e) {\r\n        var keys = Object.keys(this._widgets);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var widgetId = keys[i];\r\n            this._widgets[widgetId].onConfigurationChanged(e);\r\n        }\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onDecorationsChanged = function (e) {\r\n        // true for inline decorations that can end up relayouting text\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onLineMappingChanged = function (e) {\r\n        var keys = Object.keys(this._widgets);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var widgetId = keys[i];\r\n            this._widgets[widgetId].onLineMappingChanged(e);\r\n        }\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onScrollChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // ---- end view event handlers\r\n    ViewContentWidgets.prototype.addWidget = function (_widget) {\r\n        var myWidget = new Widget(this._context, this._viewDomNode, _widget);\r\n        this._widgets[myWidget.id] = myWidget;\r\n        if (myWidget.allowEditorOverflow) {\r\n            this.overflowingContentWidgetsDomNode.appendChild(myWidget.domNode);\r\n        }\r\n        else {\r\n            this.domNode.appendChild(myWidget.domNode);\r\n        }\r\n        this.setShouldRender();\r\n    };\r\n    ViewContentWidgets.prototype.setWidgetPosition = function (widget, position, range, preference) {\r\n        var myWidget = this._widgets[widget.getId()];\r\n        myWidget.setPosition(position, range, preference);\r\n        this.setShouldRender();\r\n    };\r\n    ViewContentWidgets.prototype.removeWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._widgets.hasOwnProperty(widgetId)) {\r\n            var myWidget = this._widgets[widgetId];\r\n            delete this._widgets[widgetId];\r\n            var domNode = myWidget.domNode.domNode;\r\n            domNode.parentNode.removeChild(domNode);\r\n            domNode.removeAttribute('monaco-visible-content-widget');\r\n            this.setShouldRender();\r\n        }\r\n    };\r\n    ViewContentWidgets.prototype.shouldSuppressMouseDownOnWidget = function (widgetId) {\r\n        if (this._widgets.hasOwnProperty(widgetId)) {\r\n            return this._widgets[widgetId].suppressMouseDown;\r\n        }\r\n        return false;\r\n    };\r\n    ViewContentWidgets.prototype.onBeforeRender = function (viewportData) {\r\n        var keys = Object.keys(this._widgets);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var widgetId = keys[i];\r\n            this._widgets[widgetId].onBeforeRender(viewportData);\r\n        }\r\n    };\r\n    ViewContentWidgets.prototype.prepareRender = function (ctx) {\r\n        var keys = Object.keys(this._widgets);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var widgetId = keys[i];\r\n            this._widgets[widgetId].prepareRender(ctx);\r\n        }\r\n    };\r\n    ViewContentWidgets.prototype.render = function (ctx) {\r\n        var keys = Object.keys(this._widgets);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var widgetId = keys[i];\r\n            this._widgets[widgetId].render(ctx);\r\n        }\r\n    };\r\n    return ViewContentWidgets;\r\n}(ViewPart));\r\nexport { ViewContentWidgets };\r\nvar Widget = /** @class */ (function () {\r\n    function Widget(context, viewDomNode, actual) {\r\n        this._context = context;\r\n        this._viewDomNode = viewDomNode;\r\n        this._actual = actual;\r\n        this.domNode = createFastDomNode(this._actual.getDomNode());\r\n        this.id = this._actual.getId();\r\n        this.allowEditorOverflow = this._actual.allowEditorOverflow || false;\r\n        this.suppressMouseDown = this._actual.suppressMouseDown || false;\r\n        this._fixedOverflowWidgets = this._context.configuration.editor.viewInfo.fixedOverflowWidgets;\r\n        this._contentWidth = this._context.configuration.editor.layoutInfo.contentWidth;\r\n        this._contentLeft = this._context.configuration.editor.layoutInfo.contentLeft;\r\n        this._lineHeight = this._context.configuration.editor.lineHeight;\r\n        this._setPosition(null, null);\r\n        this._preference = [];\r\n        this._cachedDomNodeClientWidth = -1;\r\n        this._cachedDomNodeClientHeight = -1;\r\n        this._maxWidth = this._getMaxWidth();\r\n        this._isVisible = false;\r\n        this._renderData = null;\r\n        this.domNode.setPosition((this._fixedOverflowWidgets && this.allowEditorOverflow) ? 'fixed' : 'absolute');\r\n        this.domNode.setVisibility('hidden');\r\n        this.domNode.setAttribute('widgetId', this.id);\r\n        this.domNode.setMaxWidth(this._maxWidth);\r\n    }\r\n    Widget.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._lineHeight = this._context.configuration.editor.lineHeight;\r\n        }\r\n        if (e.layoutInfo) {\r\n            this._contentLeft = this._context.configuration.editor.layoutInfo.contentLeft;\r\n            this._contentWidth = this._context.configuration.editor.layoutInfo.contentWidth;\r\n            this._maxWidth = this._getMaxWidth();\r\n        }\r\n    };\r\n    Widget.prototype.onLineMappingChanged = function (e) {\r\n        this._setPosition(this._position, this._range);\r\n    };\r\n    Widget.prototype._setPosition = function (position, range) {\r\n        this._position = position || null;\r\n        this._range = range || null;\r\n        this._viewPosition = null;\r\n        this._viewRange = null;\r\n        if (this._position) {\r\n            // Do not trust that widgets give a valid position\r\n            var validModelPosition = this._context.model.validateModelPosition(this._position);\r\n            if (this._context.model.coordinatesConverter.modelPositionIsVisible(validModelPosition)) {\r\n                this._viewPosition = this._context.model.coordinatesConverter.convertModelPositionToViewPosition(validModelPosition);\r\n            }\r\n        }\r\n        if (this._range) {\r\n            // Do not trust that widgets give a valid position\r\n            var validModelRange = this._context.model.validateModelRange(this._range);\r\n            this._viewRange = this._context.model.coordinatesConverter.convertModelRangeToViewRange(validModelRange);\r\n        }\r\n    };\r\n    Widget.prototype._getMaxWidth = function () {\r\n        return (this.allowEditorOverflow\r\n            ? window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth\r\n            : this._contentWidth);\r\n    };\r\n    Widget.prototype.setPosition = function (position, range, preference) {\r\n        this._setPosition(position, range);\r\n        this._preference = preference || null;\r\n        this._cachedDomNodeClientWidth = -1;\r\n        this._cachedDomNodeClientHeight = -1;\r\n    };\r\n    Widget.prototype._layoutBoxInViewport = function (topLeft, bottomLeft, width, height, ctx) {\r\n        // Our visible box is split horizontally by the current line => 2 boxes\r\n        // a) the box above the line\r\n        var aboveLineTop = topLeft.top;\r\n        var heightAboveLine = aboveLineTop;\r\n        // b) the box under the line\r\n        var underLineTop = bottomLeft.top + this._lineHeight;\r\n        var heightUnderLine = ctx.viewportHeight - underLineTop;\r\n        var aboveTop = aboveLineTop - height;\r\n        var fitsAbove = (heightAboveLine >= height);\r\n        var belowTop = underLineTop;\r\n        var fitsBelow = (heightUnderLine >= height);\r\n        // And its left\r\n        var actualAboveLeft = topLeft.left;\r\n        var actualBelowLeft = bottomLeft.left;\r\n        if (actualAboveLeft + width > ctx.scrollLeft + ctx.viewportWidth) {\r\n            actualAboveLeft = ctx.scrollLeft + ctx.viewportWidth - width;\r\n        }\r\n        if (actualBelowLeft + width > ctx.scrollLeft + ctx.viewportWidth) {\r\n            actualBelowLeft = ctx.scrollLeft + ctx.viewportWidth - width;\r\n        }\r\n        if (actualAboveLeft < ctx.scrollLeft) {\r\n            actualAboveLeft = ctx.scrollLeft;\r\n        }\r\n        if (actualBelowLeft < ctx.scrollLeft) {\r\n            actualBelowLeft = ctx.scrollLeft;\r\n        }\r\n        return {\r\n            fitsAbove: fitsAbove,\r\n            aboveTop: aboveTop,\r\n            aboveLeft: actualAboveLeft,\r\n            fitsBelow: fitsBelow,\r\n            belowTop: belowTop,\r\n            belowLeft: actualBelowLeft,\r\n        };\r\n    };\r\n    Widget.prototype._layoutBoxInPage = function (topLeft, bottomLeft, width, height, ctx) {\r\n        var aboveLeft0 = topLeft.left - ctx.scrollLeft;\r\n        var belowLeft0 = bottomLeft.left - ctx.scrollLeft;\r\n        if (aboveLeft0 < 0 || aboveLeft0 > this._contentWidth) {\r\n            // Don't render if position is scrolled outside viewport\r\n            return null;\r\n        }\r\n        var aboveTop = topLeft.top - height;\r\n        var belowTop = bottomLeft.top + this._lineHeight;\r\n        var aboveLeft = aboveLeft0 + this._contentLeft;\r\n        var belowLeft = belowLeft0 + this._contentLeft;\r\n        var domNodePosition = dom.getDomNodePagePosition(this._viewDomNode.domNode);\r\n        var absoluteAboveTop = domNodePosition.top + aboveTop - dom.StandardWindow.scrollY;\r\n        var absoluteBelowTop = domNodePosition.top + belowTop - dom.StandardWindow.scrollY;\r\n        var absoluteAboveLeft = domNodePosition.left + aboveLeft - dom.StandardWindow.scrollX;\r\n        var absoluteBelowLeft = domNodePosition.left + belowLeft - dom.StandardWindow.scrollX;\r\n        var INNER_WIDTH = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\r\n        var INNER_HEIGHT = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\r\n        // Leave some clearance to the bottom\r\n        var TOP_PADDING = 22;\r\n        var BOTTOM_PADDING = 22;\r\n        var fitsAbove = (absoluteAboveTop >= TOP_PADDING), fitsBelow = (absoluteBelowTop + height <= INNER_HEIGHT - BOTTOM_PADDING);\r\n        if (absoluteAboveLeft + width + 20 > INNER_WIDTH) {\r\n            var delta = absoluteAboveLeft - (INNER_WIDTH - width - 20);\r\n            absoluteAboveLeft -= delta;\r\n            aboveLeft -= delta;\r\n        }\r\n        if (absoluteBelowLeft + width + 20 > INNER_WIDTH) {\r\n            var delta = absoluteBelowLeft - (INNER_WIDTH - width - 20);\r\n            absoluteBelowLeft -= delta;\r\n            belowLeft -= delta;\r\n        }\r\n        if (absoluteAboveLeft < 0) {\r\n            var delta = absoluteAboveLeft;\r\n            absoluteAboveLeft -= delta;\r\n            aboveLeft -= delta;\r\n        }\r\n        if (absoluteBelowLeft < 0) {\r\n            var delta = absoluteBelowLeft;\r\n            absoluteBelowLeft -= delta;\r\n            belowLeft -= delta;\r\n        }\r\n        if (this._fixedOverflowWidgets) {\r\n            aboveTop = absoluteAboveTop;\r\n            belowTop = absoluteBelowTop;\r\n            aboveLeft = absoluteAboveLeft;\r\n            belowLeft = absoluteBelowLeft;\r\n        }\r\n        return { fitsAbove: fitsAbove, aboveTop: aboveTop, aboveLeft: aboveLeft, fitsBelow: fitsBelow, belowTop: belowTop, belowLeft: belowLeft };\r\n    };\r\n    Widget.prototype._prepareRenderWidgetAtExactPositionOverflowing = function (topLeft) {\r\n        return new Coordinate(topLeft.top, topLeft.left + this._contentLeft);\r\n    };\r\n    /**\r\n     * Compute `this._topLeft`\r\n     */\r\n    Widget.prototype._getTopAndBottomLeft = function (ctx) {\r\n        if (!this._viewPosition) {\r\n            return [null, null];\r\n        }\r\n        var visibleRangeForPosition = ctx.visibleRangeForPosition(this._viewPosition);\r\n        if (!visibleRangeForPosition) {\r\n            return [null, null];\r\n        }\r\n        var topForPosition = ctx.getVerticalOffsetForLineNumber(this._viewPosition.lineNumber) - ctx.scrollTop;\r\n        var topLeft = new Coordinate(topForPosition, visibleRangeForPosition.left);\r\n        var largestLineNumber = this._viewPosition.lineNumber;\r\n        var smallestLeft = visibleRangeForPosition.left;\r\n        if (this._viewRange) {\r\n            var visibleRangesForRange = ctx.linesVisibleRangesForRange(this._viewRange, false);\r\n            if (visibleRangesForRange && visibleRangesForRange.length > 0) {\r\n                for (var i = visibleRangesForRange.length - 1; i >= 0; i--) {\r\n                    var visibleRangesForLine = visibleRangesForRange[i];\r\n                    if (visibleRangesForLine.lineNumber >= largestLineNumber) {\r\n                        if (visibleRangesForLine.lineNumber > largestLineNumber) {\r\n                            largestLineNumber = visibleRangesForLine.lineNumber;\r\n                            smallestLeft = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n                        }\r\n                        for (var j = 0, lenJ = visibleRangesForLine.ranges.length; j < lenJ; j++) {\r\n                            var visibleRange = visibleRangesForLine.ranges[j];\r\n                            if (visibleRange.left < smallestLeft) {\r\n                                smallestLeft = visibleRange.left;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        var topForBottomLine = ctx.getVerticalOffsetForLineNumber(largestLineNumber) - ctx.scrollTop;\r\n        var bottomLeft = new Coordinate(topForBottomLine, smallestLeft);\r\n        return [topLeft, bottomLeft];\r\n    };\r\n    Widget.prototype._prepareRenderWidget = function (ctx) {\r\n        var _a = this._getTopAndBottomLeft(ctx), topLeft = _a[0], bottomLeft = _a[1];\r\n        if (!topLeft || !bottomLeft) {\r\n            return null;\r\n        }\r\n        if (this._cachedDomNodeClientWidth === -1 || this._cachedDomNodeClientHeight === -1) {\r\n            var domNode = this.domNode.domNode;\r\n            this._cachedDomNodeClientWidth = domNode.clientWidth;\r\n            this._cachedDomNodeClientHeight = domNode.clientHeight;\r\n        }\r\n        var placement;\r\n        if (this.allowEditorOverflow) {\r\n            placement = this._layoutBoxInPage(topLeft, bottomLeft, this._cachedDomNodeClientWidth, this._cachedDomNodeClientHeight, ctx);\r\n        }\r\n        else {\r\n            placement = this._layoutBoxInViewport(topLeft, bottomLeft, this._cachedDomNodeClientWidth, this._cachedDomNodeClientHeight, ctx);\r\n        }\r\n        // Do two passes, first for perfect fit, second picks first option\r\n        if (this._preference) {\r\n            for (var pass = 1; pass <= 2; pass++) {\r\n                for (var i = 0; i < this._preference.length; i++) {\r\n                    // placement\r\n                    var pref = this._preference[i];\r\n                    if (pref === 1 /* ABOVE */) {\r\n                        if (!placement) {\r\n                            // Widget outside of viewport\r\n                            return null;\r\n                        }\r\n                        if (pass === 2 || placement.fitsAbove) {\r\n                            return new Coordinate(placement.aboveTop, placement.aboveLeft);\r\n                        }\r\n                    }\r\n                    else if (pref === 2 /* BELOW */) {\r\n                        if (!placement) {\r\n                            // Widget outside of viewport\r\n                            return null;\r\n                        }\r\n                        if (pass === 2 || placement.fitsBelow) {\r\n                            return new Coordinate(placement.belowTop, placement.belowLeft);\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (this.allowEditorOverflow) {\r\n                            return this._prepareRenderWidgetAtExactPositionOverflowing(topLeft);\r\n                        }\r\n                        else {\r\n                            return topLeft;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    /**\r\n     * On this first pass, we ensure that the content widget (if it is in the viewport) has the max width set correctly.\r\n     */\r\n    Widget.prototype.onBeforeRender = function (viewportData) {\r\n        if (!this._viewPosition || !this._preference) {\r\n            return;\r\n        }\r\n        if (this._viewPosition.lineNumber < viewportData.startLineNumber || this._viewPosition.lineNumber > viewportData.endLineNumber) {\r\n            // Outside of viewport\r\n            return;\r\n        }\r\n        this.domNode.setMaxWidth(this._maxWidth);\r\n    };\r\n    Widget.prototype.prepareRender = function (ctx) {\r\n        this._renderData = this._prepareRenderWidget(ctx);\r\n    };\r\n    Widget.prototype.render = function (ctx) {\r\n        if (!this._renderData) {\r\n            // This widget should be invisible\r\n            if (this._isVisible) {\r\n                this.domNode.removeAttribute('monaco-visible-content-widget');\r\n                this._isVisible = false;\r\n                this.domNode.setVisibility('hidden');\r\n            }\r\n            return;\r\n        }\r\n        // This widget should be visible\r\n        if (this.allowEditorOverflow) {\r\n            this.domNode.setTop(this._renderData.top);\r\n            this.domNode.setLeft(this._renderData.left);\r\n        }\r\n        else {\r\n            this.domNode.setTop(this._renderData.top + ctx.scrollTop - ctx.bigNumbersDelta);\r\n            this.domNode.setLeft(this._renderData.left);\r\n        }\r\n        if (!this._isVisible) {\r\n            this.domNode.setVisibility('inherit');\r\n            this.domNode.setAttribute('monaco-visible-content-widget', 'true');\r\n            this._isVisible = true;\r\n        }\r\n    };\r\n    return Widget;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './currentLineHighlight.css';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { editorLineHighlight, editorLineHighlightBorder } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar CurrentLineHighlightOverlay = /** @class */ (function (_super) {\r\n    __extends(CurrentLineHighlightOverlay, _super);\r\n    function CurrentLineHighlightOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._lineHeight = _this._context.configuration.editor.lineHeight;\r\n        _this._renderLineHighlight = _this._context.configuration.editor.viewInfo.renderLineHighlight;\r\n        _this._selectionIsEmpty = true;\r\n        _this._primaryCursorLineNumber = 1;\r\n        _this._scrollWidth = 0;\r\n        _this._contentWidth = _this._context.configuration.editor.layoutInfo.contentWidth;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    CurrentLineHighlightOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    CurrentLineHighlightOverlay.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._lineHeight = this._context.configuration.editor.lineHeight;\r\n        }\r\n        if (e.viewInfo) {\r\n            this._renderLineHighlight = this._context.configuration.editor.viewInfo.renderLineHighlight;\r\n        }\r\n        if (e.layoutInfo) {\r\n            this._contentWidth = this._context.configuration.editor.layoutInfo.contentWidth;\r\n        }\r\n        return true;\r\n    };\r\n    CurrentLineHighlightOverlay.prototype.onCursorStateChanged = function (e) {\r\n        var hasChanged = false;\r\n        var primaryCursorLineNumber = e.selections[0].positionLineNumber;\r\n        if (this._primaryCursorLineNumber !== primaryCursorLineNumber) {\r\n            this._primaryCursorLineNumber = primaryCursorLineNumber;\r\n            hasChanged = true;\r\n        }\r\n        var selectionIsEmpty = e.selections[0].isEmpty();\r\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\r\n            this._selectionIsEmpty = selectionIsEmpty;\r\n            hasChanged = true;\r\n            return true;\r\n        }\r\n        return hasChanged;\r\n    };\r\n    CurrentLineHighlightOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    CurrentLineHighlightOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    CurrentLineHighlightOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    CurrentLineHighlightOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollWidthChanged;\r\n    };\r\n    CurrentLineHighlightOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    CurrentLineHighlightOverlay.prototype.prepareRender = function (ctx) {\r\n        this._scrollWidth = ctx.scrollWidth;\r\n    };\r\n    CurrentLineHighlightOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (lineNumber === this._primaryCursorLineNumber) {\r\n            if (this._shouldShowCurrentLine()) {\r\n                var paintedInMargin = this._willRenderMarginCurrentLine();\r\n                var className = 'current-line' + (paintedInMargin ? ' current-line-both' : '');\r\n                return ('<div class=\"'\r\n                    + className\r\n                    + '\" style=\"width:'\r\n                    + String(Math.max(this._scrollWidth, this._contentWidth))\r\n                    + 'px; height:'\r\n                    + String(this._lineHeight)\r\n                    + 'px;\"></div>');\r\n            }\r\n            else {\r\n                return '';\r\n            }\r\n        }\r\n        return '';\r\n    };\r\n    CurrentLineHighlightOverlay.prototype._shouldShowCurrentLine = function () {\r\n        return ((this._renderLineHighlight === 'line' || this._renderLineHighlight === 'all')\r\n            && this._selectionIsEmpty);\r\n    };\r\n    CurrentLineHighlightOverlay.prototype._willRenderMarginCurrentLine = function () {\r\n        return ((this._renderLineHighlight === 'gutter' || this._renderLineHighlight === 'all'));\r\n    };\r\n    return CurrentLineHighlightOverlay;\r\n}(DynamicViewOverlay));\r\nexport { CurrentLineHighlightOverlay };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var lineHighlight = theme.getColor(editorLineHighlight);\r\n    if (lineHighlight) {\r\n        collector.addRule(\".monaco-editor .view-overlays .current-line { background-color: \" + lineHighlight + \"; }\");\r\n    }\r\n    if (!lineHighlight || lineHighlight.isTransparent() || theme.defines(editorLineHighlightBorder)) {\r\n        var lineHighlightBorder = theme.getColor(editorLineHighlightBorder);\r\n        if (lineHighlightBorder) {\r\n            collector.addRule(\".monaco-editor .view-overlays .current-line { border: 2px solid \" + lineHighlightBorder + \"; }\");\r\n            if (theme.type === 'hc') {\r\n                collector.addRule(\".monaco-editor .view-overlays .current-line { border-width: 1px; }\");\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './currentLineMarginHighlight.css';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { editorLineHighlight, editorLineHighlightBorder } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar CurrentLineMarginHighlightOverlay = /** @class */ (function (_super) {\r\n    __extends(CurrentLineMarginHighlightOverlay, _super);\r\n    function CurrentLineMarginHighlightOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._lineHeight = _this._context.configuration.editor.lineHeight;\r\n        _this._renderLineHighlight = _this._context.configuration.editor.viewInfo.renderLineHighlight;\r\n        _this._selectionIsEmpty = true;\r\n        _this._primaryCursorLineNumber = 1;\r\n        _this._contentLeft = _this._context.configuration.editor.layoutInfo.contentLeft;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    CurrentLineMarginHighlightOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    CurrentLineMarginHighlightOverlay.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._lineHeight = this._context.configuration.editor.lineHeight;\r\n        }\r\n        if (e.viewInfo) {\r\n            this._renderLineHighlight = this._context.configuration.editor.viewInfo.renderLineHighlight;\r\n        }\r\n        if (e.layoutInfo) {\r\n            this._contentLeft = this._context.configuration.editor.layoutInfo.contentLeft;\r\n        }\r\n        return true;\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype.onCursorStateChanged = function (e) {\r\n        var hasChanged = false;\r\n        var primaryCursorLineNumber = e.selections[0].positionLineNumber;\r\n        if (this._primaryCursorLineNumber !== primaryCursorLineNumber) {\r\n            this._primaryCursorLineNumber = primaryCursorLineNumber;\r\n            hasChanged = true;\r\n        }\r\n        var selectionIsEmpty = e.selections[0].isEmpty();\r\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\r\n            this._selectionIsEmpty = selectionIsEmpty;\r\n            hasChanged = true;\r\n            return true;\r\n        }\r\n        return hasChanged;\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    CurrentLineMarginHighlightOverlay.prototype.prepareRender = function (ctx) {\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (lineNumber === this._primaryCursorLineNumber) {\r\n            var className = 'current-line';\r\n            if (this._shouldShowCurrentLine()) {\r\n                var paintedInContent = this._willRenderContentCurrentLine();\r\n                className = 'current-line current-line-margin' + (paintedInContent ? ' current-line-margin-both' : '');\r\n            }\r\n            return ('<div class=\"'\r\n                + className\r\n                + '\" style=\"width:'\r\n                + String(this._contentLeft)\r\n                + 'px; height:'\r\n                + String(this._lineHeight)\r\n                + 'px;\"></div>');\r\n        }\r\n        return '';\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype._shouldShowCurrentLine = function () {\r\n        return ((this._renderLineHighlight === 'gutter' || this._renderLineHighlight === 'all'));\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype._willRenderContentCurrentLine = function () {\r\n        return ((this._renderLineHighlight === 'line' || this._renderLineHighlight === 'all')\r\n            && this._selectionIsEmpty);\r\n    };\r\n    return CurrentLineMarginHighlightOverlay;\r\n}(DynamicViewOverlay));\r\nexport { CurrentLineMarginHighlightOverlay };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var lineHighlight = theme.getColor(editorLineHighlight);\r\n    if (lineHighlight) {\r\n        collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { background-color: \" + lineHighlight + \"; border: none; }\");\r\n    }\r\n    else {\r\n        var lineHighlightBorder = theme.getColor(editorLineHighlightBorder);\r\n        if (lineHighlightBorder) {\r\n            collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid \" + lineHighlightBorder + \"; }\");\r\n        }\r\n        if (theme.type === 'hc') {\r\n            collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }\");\r\n        }\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './decorations.css';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { HorizontalRange } from '../../../common/view/renderingContext.js';\r\nvar DecorationsOverlay = /** @class */ (function (_super) {\r\n    __extends(DecorationsOverlay, _super);\r\n    function DecorationsOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._lineHeight = _this._context.configuration.editor.lineHeight;\r\n        _this._typicalHalfwidthCharacterWidth = _this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    DecorationsOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    DecorationsOverlay.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._lineHeight = this._context.configuration.editor.lineHeight;\r\n        }\r\n        if (e.fontInfo) {\r\n            this._typicalHalfwidthCharacterWidth = this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n        }\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onDecorationsChanged = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged || e.scrollWidthChanged;\r\n    };\r\n    DecorationsOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    DecorationsOverlay.prototype.prepareRender = function (ctx) {\r\n        var _decorations = ctx.getDecorationsInViewport();\r\n        // Keep only decorations with `className`\r\n        var decorations = [], decorationsLen = 0;\r\n        for (var i = 0, len = _decorations.length; i < len; i++) {\r\n            var d = _decorations[i];\r\n            if (d.options.className) {\r\n                decorations[decorationsLen++] = d;\r\n            }\r\n        }\r\n        // Sort decorations for consistent render output\r\n        decorations = decorations.sort(function (a, b) {\r\n            if (a.options.zIndex < b.options.zIndex) {\r\n                return -1;\r\n            }\r\n            if (a.options.zIndex > b.options.zIndex) {\r\n                return 1;\r\n            }\r\n            var aClassName = a.options.className;\r\n            var bClassName = b.options.className;\r\n            if (aClassName < bClassName) {\r\n                return -1;\r\n            }\r\n            if (aClassName > bClassName) {\r\n                return 1;\r\n            }\r\n            return Range.compareRangesUsingStarts(a.range, b.range);\r\n        });\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            output[lineIndex] = '';\r\n        }\r\n        // Render first whole line decorations and then regular decorations\r\n        this._renderWholeLineDecorations(ctx, decorations, output);\r\n        this._renderNormalDecorations(ctx, decorations, output);\r\n        this._renderResult = output;\r\n    };\r\n    DecorationsOverlay.prototype._renderWholeLineDecorations = function (ctx, decorations, output) {\r\n        var lineHeight = String(this._lineHeight);\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        for (var i = 0, lenI = decorations.length; i < lenI; i++) {\r\n            var d = decorations[i];\r\n            if (!d.options.isWholeLine) {\r\n                continue;\r\n            }\r\n            var decorationOutput = ('<div class=\"cdr '\r\n                + d.options.className\r\n                + '\" style=\"left:0;width:100%;height:'\r\n                + lineHeight\r\n                + 'px;\"></div>');\r\n            var startLineNumber = Math.max(d.range.startLineNumber, visibleStartLineNumber);\r\n            var endLineNumber = Math.min(d.range.endLineNumber, visibleEndLineNumber);\r\n            for (var j = startLineNumber; j <= endLineNumber; j++) {\r\n                var lineIndex = j - visibleStartLineNumber;\r\n                output[lineIndex] += decorationOutput;\r\n            }\r\n        }\r\n    };\r\n    DecorationsOverlay.prototype._renderNormalDecorations = function (ctx, decorations, output) {\r\n        var lineHeight = String(this._lineHeight);\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var prevClassName = null;\r\n        var prevShowIfCollapsed = false;\r\n        var prevRange = null;\r\n        for (var i = 0, lenI = decorations.length; i < lenI; i++) {\r\n            var d = decorations[i];\r\n            if (d.options.isWholeLine) {\r\n                continue;\r\n            }\r\n            var className = d.options.className;\r\n            var showIfCollapsed = Boolean(d.options.showIfCollapsed);\r\n            var range = d.range;\r\n            if (showIfCollapsed && range.endColumn === 1 && range.endLineNumber !== range.startLineNumber) {\r\n                range = new Range(range.startLineNumber, range.startColumn, range.endLineNumber - 1, this._context.model.getLineMaxColumn(range.endLineNumber - 1));\r\n            }\r\n            if (prevClassName === className && prevShowIfCollapsed === showIfCollapsed && Range.areIntersectingOrTouching(prevRange, range)) {\r\n                // merge into previous decoration\r\n                prevRange = Range.plusRange(prevRange, range);\r\n                continue;\r\n            }\r\n            // flush previous decoration\r\n            if (prevClassName !== null) {\r\n                this._renderNormalDecoration(ctx, prevRange, prevClassName, prevShowIfCollapsed, lineHeight, visibleStartLineNumber, output);\r\n            }\r\n            prevClassName = className;\r\n            prevShowIfCollapsed = showIfCollapsed;\r\n            prevRange = range;\r\n        }\r\n        if (prevClassName !== null) {\r\n            this._renderNormalDecoration(ctx, prevRange, prevClassName, prevShowIfCollapsed, lineHeight, visibleStartLineNumber, output);\r\n        }\r\n    };\r\n    DecorationsOverlay.prototype._renderNormalDecoration = function (ctx, range, className, showIfCollapsed, lineHeight, visibleStartLineNumber, output) {\r\n        var linesVisibleRanges = ctx.linesVisibleRangesForRange(range, /*TODO@Alex*/ className === 'findMatch');\r\n        if (!linesVisibleRanges) {\r\n            return;\r\n        }\r\n        for (var j = 0, lenJ = linesVisibleRanges.length; j < lenJ; j++) {\r\n            var lineVisibleRanges = linesVisibleRanges[j];\r\n            var lineIndex = lineVisibleRanges.lineNumber - visibleStartLineNumber;\r\n            if (showIfCollapsed && lineVisibleRanges.ranges.length === 1) {\r\n                var singleVisibleRange = lineVisibleRanges.ranges[0];\r\n                if (singleVisibleRange.width === 0) {\r\n                    // collapsed range case => make the decoration visible by faking its width\r\n                    lineVisibleRanges.ranges[0] = new HorizontalRange(singleVisibleRange.left, this._typicalHalfwidthCharacterWidth);\r\n                }\r\n            }\r\n            for (var k = 0, lenK = lineVisibleRanges.ranges.length; k < lenK; k++) {\r\n                var visibleRange = lineVisibleRanges.ranges[k];\r\n                var decorationOutput = ('<div class=\"cdr '\r\n                    + className\r\n                    + '\" style=\"left:'\r\n                    + String(visibleRange.left)\r\n                    + 'px;width:'\r\n                    + String(visibleRange.width)\r\n                    + 'px;height:'\r\n                    + lineHeight\r\n                    + 'px;\"></div>');\r\n                output[lineIndex] += decorationOutput;\r\n            }\r\n        }\r\n    };\r\n    DecorationsOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineIndex];\r\n    };\r\n    return DecorationsOverlay;\r\n}(DynamicViewOverlay));\r\nexport { DecorationsOverlay };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../dom.js';\r\nimport { StandardKeyboardEvent } from '../keyboardEvent.js';\r\nimport { StandardMouseEvent } from '../mouseEvent.js';\r\nimport { Disposable } from '../../common/lifecycle.js';\r\nvar Widget = /** @class */ (function (_super) {\r\n    __extends(Widget, _super);\r\n    function Widget() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Widget.prototype.onclick = function (domNode, listener) {\r\n        this._register(dom.addDisposableListener(domNode, dom.EventType.CLICK, function (e) { return listener(new StandardMouseEvent(e)); }));\r\n    };\r\n    Widget.prototype.onmousedown = function (domNode, listener) {\r\n        this._register(dom.addDisposableListener(domNode, dom.EventType.MOUSE_DOWN, function (e) { return listener(new StandardMouseEvent(e)); }));\r\n    };\r\n    Widget.prototype.onmouseover = function (domNode, listener) {\r\n        this._register(dom.addDisposableListener(domNode, dom.EventType.MOUSE_OVER, function (e) { return listener(new StandardMouseEvent(e)); }));\r\n    };\r\n    Widget.prototype.onnonbubblingmouseout = function (domNode, listener) {\r\n        this._register(dom.addDisposableNonBubblingMouseOutListener(domNode, function (e) { return listener(new StandardMouseEvent(e)); }));\r\n    };\r\n    Widget.prototype.onkeydown = function (domNode, listener) {\r\n        this._register(dom.addDisposableListener(domNode, dom.EventType.KEY_DOWN, function (e) { return listener(new StandardKeyboardEvent(e)); }));\r\n    };\r\n    Widget.prototype.onkeyup = function (domNode, listener) {\r\n        this._register(dom.addDisposableListener(domNode, dom.EventType.KEY_UP, function (e) { return listener(new StandardKeyboardEvent(e)); }));\r\n    };\r\n    Widget.prototype.oninput = function (domNode, listener) {\r\n        this._register(dom.addDisposableListener(domNode, dom.EventType.INPUT, listener));\r\n    };\r\n    Widget.prototype.onblur = function (domNode, listener) {\r\n        this._register(dom.addDisposableListener(domNode, dom.EventType.BLUR, listener));\r\n    };\r\n    Widget.prototype.onfocus = function (domNode, listener) {\r\n        this._register(dom.addDisposableListener(domNode, dom.EventType.FOCUS, listener));\r\n    };\r\n    Widget.prototype.onchange = function (domNode, listener) {\r\n        this._register(dom.addDisposableListener(domNode, dom.EventType.CHANGE, listener));\r\n    };\r\n    return Widget;\r\n}(Disposable));\r\nexport { Widget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { GlobalMouseMoveMonitor, standardMouseMoveMerger } from '../../globalMouseMoveMonitor.js';\r\nimport { Widget } from '../widget.js';\r\nimport { IntervalTimer, TimeoutTimer } from '../../../common/async.js';\r\n/**\r\n * The arrow image size.\r\n */\r\nexport var ARROW_IMG_SIZE = 11;\r\nvar ScrollbarArrow = /** @class */ (function (_super) {\r\n    __extends(ScrollbarArrow, _super);\r\n    function ScrollbarArrow(opts) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onActivate = opts.onActivate;\r\n        _this.bgDomNode = document.createElement('div');\r\n        _this.bgDomNode.className = 'arrow-background';\r\n        _this.bgDomNode.style.position = 'absolute';\r\n        _this.bgDomNode.style.width = opts.bgWidth + 'px';\r\n        _this.bgDomNode.style.height = opts.bgHeight + 'px';\r\n        if (typeof opts.top !== 'undefined') {\r\n            _this.bgDomNode.style.top = '0px';\r\n        }\r\n        if (typeof opts.left !== 'undefined') {\r\n            _this.bgDomNode.style.left = '0px';\r\n        }\r\n        if (typeof opts.bottom !== 'undefined') {\r\n            _this.bgDomNode.style.bottom = '0px';\r\n        }\r\n        if (typeof opts.right !== 'undefined') {\r\n            _this.bgDomNode.style.right = '0px';\r\n        }\r\n        _this.domNode = document.createElement('div');\r\n        _this.domNode.className = opts.className;\r\n        _this.domNode.style.position = 'absolute';\r\n        _this.domNode.style.width = ARROW_IMG_SIZE + 'px';\r\n        _this.domNode.style.height = ARROW_IMG_SIZE + 'px';\r\n        if (typeof opts.top !== 'undefined') {\r\n            _this.domNode.style.top = opts.top + 'px';\r\n        }\r\n        if (typeof opts.left !== 'undefined') {\r\n            _this.domNode.style.left = opts.left + 'px';\r\n        }\r\n        if (typeof opts.bottom !== 'undefined') {\r\n            _this.domNode.style.bottom = opts.bottom + 'px';\r\n        }\r\n        if (typeof opts.right !== 'undefined') {\r\n            _this.domNode.style.right = opts.right + 'px';\r\n        }\r\n        _this._mouseMoveMonitor = _this._register(new GlobalMouseMoveMonitor());\r\n        _this.onmousedown(_this.bgDomNode, function (e) { return _this._arrowMouseDown(e); });\r\n        _this.onmousedown(_this.domNode, function (e) { return _this._arrowMouseDown(e); });\r\n        _this._mousedownRepeatTimer = _this._register(new IntervalTimer());\r\n        _this._mousedownScheduleRepeatTimer = _this._register(new TimeoutTimer());\r\n        return _this;\r\n    }\r\n    ScrollbarArrow.prototype._arrowMouseDown = function (e) {\r\n        var _this = this;\r\n        var scheduleRepeater = function () {\r\n            _this._mousedownRepeatTimer.cancelAndSet(function () { return _this._onActivate(); }, 1000 / 24);\r\n        };\r\n        this._onActivate();\r\n        this._mousedownRepeatTimer.cancel();\r\n        this._mousedownScheduleRepeatTimer.cancelAndSet(scheduleRepeater, 200);\r\n        this._mouseMoveMonitor.startMonitoring(standardMouseMoveMerger, function (mouseMoveData) {\r\n            /* Intentional empty */\r\n        }, function () {\r\n            _this._mousedownRepeatTimer.cancel();\r\n            _this._mousedownScheduleRepeatTimer.cancel();\r\n        });\r\n        e.preventDefault();\r\n    };\r\n    return ScrollbarArrow;\r\n}(Widget));\r\nexport { ScrollbarArrow };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { TimeoutTimer } from '../../../common/async.js';\r\nimport { Disposable } from '../../../common/lifecycle.js';\r\nvar ScrollbarVisibilityController = /** @class */ (function (_super) {\r\n    __extends(ScrollbarVisibilityController, _super);\r\n    function ScrollbarVisibilityController(visibility, visibleClassName, invisibleClassName) {\r\n        var _this = _super.call(this) || this;\r\n        _this._visibility = visibility;\r\n        _this._visibleClassName = visibleClassName;\r\n        _this._invisibleClassName = invisibleClassName;\r\n        _this._domNode = null;\r\n        _this._isVisible = false;\r\n        _this._isNeeded = false;\r\n        _this._shouldBeVisible = false;\r\n        _this._revealTimer = _this._register(new TimeoutTimer());\r\n        return _this;\r\n    }\r\n    // ----------------- Hide / Reveal\r\n    ScrollbarVisibilityController.prototype.applyVisibilitySetting = function (shouldBeVisible) {\r\n        if (this._visibility === 2 /* Hidden */) {\r\n            return false;\r\n        }\r\n        if (this._visibility === 3 /* Visible */) {\r\n            return true;\r\n        }\r\n        return shouldBeVisible;\r\n    };\r\n    ScrollbarVisibilityController.prototype.setShouldBeVisible = function (rawShouldBeVisible) {\r\n        var shouldBeVisible = this.applyVisibilitySetting(rawShouldBeVisible);\r\n        if (this._shouldBeVisible !== shouldBeVisible) {\r\n            this._shouldBeVisible = shouldBeVisible;\r\n            this.ensureVisibility();\r\n        }\r\n    };\r\n    ScrollbarVisibilityController.prototype.setIsNeeded = function (isNeeded) {\r\n        if (this._isNeeded !== isNeeded) {\r\n            this._isNeeded = isNeeded;\r\n            this.ensureVisibility();\r\n        }\r\n    };\r\n    ScrollbarVisibilityController.prototype.setDomNode = function (domNode) {\r\n        this._domNode = domNode;\r\n        this._domNode.setClassName(this._invisibleClassName);\r\n        // Now that the flags & the dom node are in a consistent state, ensure the Hidden/Visible configuration\r\n        this.setShouldBeVisible(false);\r\n    };\r\n    ScrollbarVisibilityController.prototype.ensureVisibility = function () {\r\n        if (!this._isNeeded) {\r\n            // Nothing to be rendered\r\n            this._hide(false);\r\n            return;\r\n        }\r\n        if (this._shouldBeVisible) {\r\n            this._reveal();\r\n        }\r\n        else {\r\n            this._hide(true);\r\n        }\r\n    };\r\n    ScrollbarVisibilityController.prototype._reveal = function () {\r\n        var _this = this;\r\n        if (this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = true;\r\n        // The CSS animation doesn't play otherwise\r\n        this._revealTimer.setIfNotSet(function () {\r\n            if (_this._domNode) {\r\n                _this._domNode.setClassName(_this._visibleClassName);\r\n            }\r\n        }, 0);\r\n    };\r\n    ScrollbarVisibilityController.prototype._hide = function (withFadeAway) {\r\n        this._revealTimer.cancel();\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = false;\r\n        if (this._domNode) {\r\n            this._domNode.setClassName(this._invisibleClassName + (withFadeAway ? ' fade' : ''));\r\n        }\r\n    };\r\n    return ScrollbarVisibilityController;\r\n}(Disposable));\r\nexport { ScrollbarVisibilityController };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../../dom.js';\r\nimport { createFastDomNode } from '../../fastDomNode.js';\r\nimport { GlobalMouseMoveMonitor, standardMouseMoveMerger } from '../../globalMouseMoveMonitor.js';\r\nimport { ScrollbarArrow } from './scrollbarArrow.js';\r\nimport { ScrollbarVisibilityController } from './scrollbarVisibilityController.js';\r\nimport { Widget } from '../widget.js';\r\nimport * as platform from '../../../common/platform.js';\r\n/**\r\n * The orthogonal distance to the slider at which dragging \"resets\". This implements \"snapping\"\r\n */\r\nvar MOUSE_DRAG_RESET_DISTANCE = 140;\r\nvar AbstractScrollbar = /** @class */ (function (_super) {\r\n    __extends(AbstractScrollbar, _super);\r\n    function AbstractScrollbar(opts) {\r\n        var _this = _super.call(this) || this;\r\n        _this._lazyRender = opts.lazyRender;\r\n        _this._host = opts.host;\r\n        _this._scrollable = opts.scrollable;\r\n        _this._scrollbarState = opts.scrollbarState;\r\n        _this._visibilityController = _this._register(new ScrollbarVisibilityController(opts.visibility, 'visible scrollbar ' + opts.extraScrollbarClassName, 'invisible scrollbar ' + opts.extraScrollbarClassName));\r\n        _this._mouseMoveMonitor = _this._register(new GlobalMouseMoveMonitor());\r\n        _this._shouldRender = true;\r\n        _this.domNode = createFastDomNode(document.createElement('div'));\r\n        _this.domNode.setAttribute('role', 'presentation');\r\n        _this.domNode.setAttribute('aria-hidden', 'true');\r\n        _this._visibilityController.setDomNode(_this.domNode);\r\n        _this.domNode.setPosition('absolute');\r\n        _this.onmousedown(_this.domNode.domNode, function (e) { return _this._domNodeMouseDown(e); });\r\n        return _this;\r\n    }\r\n    // ----------------- creation\r\n    /**\r\n     * Creates the dom node for an arrow & adds it to the container\r\n     */\r\n    AbstractScrollbar.prototype._createArrow = function (opts) {\r\n        var arrow = this._register(new ScrollbarArrow(opts));\r\n        this.domNode.domNode.appendChild(arrow.bgDomNode);\r\n        this.domNode.domNode.appendChild(arrow.domNode);\r\n    };\r\n    /**\r\n     * Creates the slider dom node, adds it to the container & hooks up the events\r\n     */\r\n    AbstractScrollbar.prototype._createSlider = function (top, left, width, height) {\r\n        var _this = this;\r\n        this.slider = createFastDomNode(document.createElement('div'));\r\n        this.slider.setClassName('slider');\r\n        this.slider.setPosition('absolute');\r\n        this.slider.setTop(top);\r\n        this.slider.setLeft(left);\r\n        if (typeof width === 'number') {\r\n            this.slider.setWidth(width);\r\n        }\r\n        if (typeof height === 'number') {\r\n            this.slider.setHeight(height);\r\n        }\r\n        this.slider.setLayerHinting(true);\r\n        this.domNode.domNode.appendChild(this.slider.domNode);\r\n        this.onmousedown(this.slider.domNode, function (e) {\r\n            if (e.leftButton) {\r\n                e.preventDefault();\r\n                _this._sliderMouseDown(e, function () { });\r\n            }\r\n        });\r\n    };\r\n    // ----------------- Update state\r\n    AbstractScrollbar.prototype._onElementSize = function (visibleSize) {\r\n        if (this._scrollbarState.setVisibleSize(visibleSize)) {\r\n            this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded());\r\n            this._shouldRender = true;\r\n            if (!this._lazyRender) {\r\n                this.render();\r\n            }\r\n        }\r\n        return this._shouldRender;\r\n    };\r\n    AbstractScrollbar.prototype._onElementScrollSize = function (elementScrollSize) {\r\n        if (this._scrollbarState.setScrollSize(elementScrollSize)) {\r\n            this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded());\r\n            this._shouldRender = true;\r\n            if (!this._lazyRender) {\r\n                this.render();\r\n            }\r\n        }\r\n        return this._shouldRender;\r\n    };\r\n    AbstractScrollbar.prototype._onElementScrollPosition = function (elementScrollPosition) {\r\n        if (this._scrollbarState.setScrollPosition(elementScrollPosition)) {\r\n            this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded());\r\n            this._shouldRender = true;\r\n            if (!this._lazyRender) {\r\n                this.render();\r\n            }\r\n        }\r\n        return this._shouldRender;\r\n    };\r\n    // ----------------- rendering\r\n    AbstractScrollbar.prototype.beginReveal = function () {\r\n        this._visibilityController.setShouldBeVisible(true);\r\n    };\r\n    AbstractScrollbar.prototype.beginHide = function () {\r\n        this._visibilityController.setShouldBeVisible(false);\r\n    };\r\n    AbstractScrollbar.prototype.render = function () {\r\n        if (!this._shouldRender) {\r\n            return;\r\n        }\r\n        this._shouldRender = false;\r\n        this._renderDomNode(this._scrollbarState.getRectangleLargeSize(), this._scrollbarState.getRectangleSmallSize());\r\n        this._updateSlider(this._scrollbarState.getSliderSize(), this._scrollbarState.getArrowSize() + this._scrollbarState.getSliderPosition());\r\n    };\r\n    // ----------------- DOM events\r\n    AbstractScrollbar.prototype._domNodeMouseDown = function (e) {\r\n        if (e.target !== this.domNode.domNode) {\r\n            return;\r\n        }\r\n        this._onMouseDown(e);\r\n    };\r\n    AbstractScrollbar.prototype.delegateMouseDown = function (e) {\r\n        var domTop = this.domNode.domNode.getClientRects()[0].top;\r\n        var sliderStart = domTop + this._scrollbarState.getSliderPosition();\r\n        var sliderStop = domTop + this._scrollbarState.getSliderPosition() + this._scrollbarState.getSliderSize();\r\n        var mousePos = this._sliderMousePosition(e);\r\n        if (sliderStart <= mousePos && mousePos <= sliderStop) {\r\n            // Act as if it was a mouse down on the slider\r\n            if (e.leftButton) {\r\n                e.preventDefault();\r\n                this._sliderMouseDown(e, function () { });\r\n            }\r\n        }\r\n        else {\r\n            // Act as if it was a mouse down on the scrollbar\r\n            this._onMouseDown(e);\r\n        }\r\n    };\r\n    AbstractScrollbar.prototype._onMouseDown = function (e) {\r\n        var offsetX;\r\n        var offsetY;\r\n        if (e.target === this.domNode.domNode && typeof e.browserEvent.offsetX === 'number' && typeof e.browserEvent.offsetY === 'number') {\r\n            offsetX = e.browserEvent.offsetX;\r\n            offsetY = e.browserEvent.offsetY;\r\n        }\r\n        else {\r\n            var domNodePosition = dom.getDomNodePagePosition(this.domNode.domNode);\r\n            offsetX = e.posx - domNodePosition.left;\r\n            offsetY = e.posy - domNodePosition.top;\r\n        }\r\n        this._setDesiredScrollPositionNow(this._scrollbarState.getDesiredScrollPositionFromOffset(this._mouseDownRelativePosition(offsetX, offsetY)));\r\n        if (e.leftButton) {\r\n            e.preventDefault();\r\n            this._sliderMouseDown(e, function () { });\r\n        }\r\n    };\r\n    AbstractScrollbar.prototype._sliderMouseDown = function (e, onDragFinished) {\r\n        var _this = this;\r\n        var initialMousePosition = this._sliderMousePosition(e);\r\n        var initialMouseOrthogonalPosition = this._sliderOrthogonalMousePosition(e);\r\n        var initialScrollbarState = this._scrollbarState.clone();\r\n        this.slider.toggleClassName('active', true);\r\n        this._mouseMoveMonitor.startMonitoring(standardMouseMoveMerger, function (mouseMoveData) {\r\n            var mouseOrthogonalPosition = _this._sliderOrthogonalMousePosition(mouseMoveData);\r\n            var mouseOrthogonalDelta = Math.abs(mouseOrthogonalPosition - initialMouseOrthogonalPosition);\r\n            if (platform.isWindows && mouseOrthogonalDelta > MOUSE_DRAG_RESET_DISTANCE) {\r\n                // The mouse has wondered away from the scrollbar => reset dragging\r\n                _this._setDesiredScrollPositionNow(initialScrollbarState.getScrollPosition());\r\n                return;\r\n            }\r\n            var mousePosition = _this._sliderMousePosition(mouseMoveData);\r\n            var mouseDelta = mousePosition - initialMousePosition;\r\n            _this._setDesiredScrollPositionNow(initialScrollbarState.getDesiredScrollPositionFromDelta(mouseDelta));\r\n        }, function () {\r\n            _this.slider.toggleClassName('active', false);\r\n            _this._host.onDragEnd();\r\n            onDragFinished();\r\n        });\r\n        this._host.onDragStart();\r\n    };\r\n    AbstractScrollbar.prototype._setDesiredScrollPositionNow = function (_desiredScrollPosition) {\r\n        var desiredScrollPosition = {};\r\n        this.writeScrollPosition(desiredScrollPosition, _desiredScrollPosition);\r\n        this._scrollable.setScrollPositionNow(desiredScrollPosition);\r\n    };\r\n    return AbstractScrollbar;\r\n}(Widget));\r\nexport { AbstractScrollbar };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/**\r\n * The minimal size of the slider (such that it can still be clickable) -- it is artificially enlarged.\r\n */\r\nvar MINIMUM_SLIDER_SIZE = 20;\r\nvar ScrollbarState = /** @class */ (function () {\r\n    function ScrollbarState(arrowSize, scrollbarSize, oppositeScrollbarSize) {\r\n        this._scrollbarSize = Math.round(scrollbarSize);\r\n        this._oppositeScrollbarSize = Math.round(oppositeScrollbarSize);\r\n        this._arrowSize = Math.round(arrowSize);\r\n        this._visibleSize = 0;\r\n        this._scrollSize = 0;\r\n        this._scrollPosition = 0;\r\n        this._computedAvailableSize = 0;\r\n        this._computedIsNeeded = false;\r\n        this._computedSliderSize = 0;\r\n        this._computedSliderRatio = 0;\r\n        this._computedSliderPosition = 0;\r\n        this._refreshComputedValues();\r\n    }\r\n    ScrollbarState.prototype.clone = function () {\r\n        var r = new ScrollbarState(this._arrowSize, this._scrollbarSize, this._oppositeScrollbarSize);\r\n        r.setVisibleSize(this._visibleSize);\r\n        r.setScrollSize(this._scrollSize);\r\n        r.setScrollPosition(this._scrollPosition);\r\n        return r;\r\n    };\r\n    ScrollbarState.prototype.setVisibleSize = function (visibleSize) {\r\n        var iVisibleSize = Math.round(visibleSize);\r\n        if (this._visibleSize !== iVisibleSize) {\r\n            this._visibleSize = iVisibleSize;\r\n            this._refreshComputedValues();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ScrollbarState.prototype.setScrollSize = function (scrollSize) {\r\n        var iScrollSize = Math.round(scrollSize);\r\n        if (this._scrollSize !== iScrollSize) {\r\n            this._scrollSize = iScrollSize;\r\n            this._refreshComputedValues();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ScrollbarState.prototype.setScrollPosition = function (scrollPosition) {\r\n        var iScrollPosition = Math.round(scrollPosition);\r\n        if (this._scrollPosition !== iScrollPosition) {\r\n            this._scrollPosition = iScrollPosition;\r\n            this._refreshComputedValues();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ScrollbarState._computeValues = function (oppositeScrollbarSize, arrowSize, visibleSize, scrollSize, scrollPosition) {\r\n        var computedAvailableSize = Math.max(0, visibleSize - oppositeScrollbarSize);\r\n        var computedRepresentableSize = Math.max(0, computedAvailableSize - 2 * arrowSize);\r\n        var computedIsNeeded = (scrollSize > 0 && scrollSize > visibleSize);\r\n        if (!computedIsNeeded) {\r\n            // There is no need for a slider\r\n            return {\r\n                computedAvailableSize: Math.round(computedAvailableSize),\r\n                computedIsNeeded: computedIsNeeded,\r\n                computedSliderSize: Math.round(computedRepresentableSize),\r\n                computedSliderRatio: 0,\r\n                computedSliderPosition: 0,\r\n            };\r\n        }\r\n        // We must artificially increase the size of the slider if needed, since the slider would be too small to grab with the mouse otherwise\r\n        var computedSliderSize = Math.round(Math.max(MINIMUM_SLIDER_SIZE, Math.floor(visibleSize * computedRepresentableSize / scrollSize)));\r\n        // The slider can move from 0 to `computedRepresentableSize` - `computedSliderSize`\r\n        // in the same way `scrollPosition` can move from 0 to `scrollSize` - `visibleSize`.\r\n        var computedSliderRatio = (computedRepresentableSize - computedSliderSize) / (scrollSize - visibleSize);\r\n        var computedSliderPosition = (scrollPosition * computedSliderRatio);\r\n        return {\r\n            computedAvailableSize: Math.round(computedAvailableSize),\r\n            computedIsNeeded: computedIsNeeded,\r\n            computedSliderSize: Math.round(computedSliderSize),\r\n            computedSliderRatio: computedSliderRatio,\r\n            computedSliderPosition: Math.round(computedSliderPosition),\r\n        };\r\n    };\r\n    ScrollbarState.prototype._refreshComputedValues = function () {\r\n        var r = ScrollbarState._computeValues(this._oppositeScrollbarSize, this._arrowSize, this._visibleSize, this._scrollSize, this._scrollPosition);\r\n        this._computedAvailableSize = r.computedAvailableSize;\r\n        this._computedIsNeeded = r.computedIsNeeded;\r\n        this._computedSliderSize = r.computedSliderSize;\r\n        this._computedSliderRatio = r.computedSliderRatio;\r\n        this._computedSliderPosition = r.computedSliderPosition;\r\n    };\r\n    ScrollbarState.prototype.getArrowSize = function () {\r\n        return this._arrowSize;\r\n    };\r\n    ScrollbarState.prototype.getScrollPosition = function () {\r\n        return this._scrollPosition;\r\n    };\r\n    ScrollbarState.prototype.getRectangleLargeSize = function () {\r\n        return this._computedAvailableSize;\r\n    };\r\n    ScrollbarState.prototype.getRectangleSmallSize = function () {\r\n        return this._scrollbarSize;\r\n    };\r\n    ScrollbarState.prototype.isNeeded = function () {\r\n        return this._computedIsNeeded;\r\n    };\r\n    ScrollbarState.prototype.getSliderSize = function () {\r\n        return this._computedSliderSize;\r\n    };\r\n    ScrollbarState.prototype.getSliderPosition = function () {\r\n        return this._computedSliderPosition;\r\n    };\r\n    /**\r\n     * Compute a desired `scrollPosition` such that `offset` ends up in the center of the slider.\r\n     * `offset` is based on the same coordinate system as the `sliderPosition`.\r\n     */\r\n    ScrollbarState.prototype.getDesiredScrollPositionFromOffset = function (offset) {\r\n        if (!this._computedIsNeeded) {\r\n            // no need for a slider\r\n            return 0;\r\n        }\r\n        var desiredSliderPosition = offset - this._arrowSize - this._computedSliderSize / 2;\r\n        return Math.round(desiredSliderPosition / this._computedSliderRatio);\r\n    };\r\n    /**\r\n     * Compute a desired `scrollPosition` such that the slider moves by `delta`.\r\n     */\r\n    ScrollbarState.prototype.getDesiredScrollPositionFromDelta = function (delta) {\r\n        if (!this._computedIsNeeded) {\r\n            // no need for a slider\r\n            return 0;\r\n        }\r\n        var desiredSliderPosition = this._computedSliderPosition + delta;\r\n        return Math.round(desiredSliderPosition / this._computedSliderRatio);\r\n    };\r\n    return ScrollbarState;\r\n}());\r\nexport { ScrollbarState };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { StandardMouseWheelEvent } from '../../mouseEvent.js';\r\nimport { AbstractScrollbar } from './abstractScrollbar.js';\r\nimport { ARROW_IMG_SIZE } from './scrollbarArrow.js';\r\nimport { ScrollbarState } from './scrollbarState.js';\r\nvar HorizontalScrollbar = /** @class */ (function (_super) {\r\n    __extends(HorizontalScrollbar, _super);\r\n    function HorizontalScrollbar(scrollable, options, host) {\r\n        var _this = _super.call(this, {\r\n            lazyRender: options.lazyRender,\r\n            host: host,\r\n            scrollbarState: new ScrollbarState((options.horizontalHasArrows ? options.arrowSize : 0), (options.horizontal === 2 /* Hidden */ ? 0 : options.horizontalScrollbarSize), (options.vertical === 2 /* Hidden */ ? 0 : options.verticalScrollbarSize)),\r\n            visibility: options.horizontal,\r\n            extraScrollbarClassName: 'horizontal',\r\n            scrollable: scrollable\r\n        }) || this;\r\n        if (options.horizontalHasArrows) {\r\n            var arrowDelta = (options.arrowSize - ARROW_IMG_SIZE) / 2;\r\n            var scrollbarDelta = (options.horizontalScrollbarSize - ARROW_IMG_SIZE) / 2;\r\n            _this._createArrow({\r\n                className: 'left-arrow',\r\n                top: scrollbarDelta,\r\n                left: arrowDelta,\r\n                bottom: void 0,\r\n                right: void 0,\r\n                bgWidth: options.arrowSize,\r\n                bgHeight: options.horizontalScrollbarSize,\r\n                onActivate: function () { return _this._host.onMouseWheel(new StandardMouseWheelEvent(null, 1, 0)); },\r\n            });\r\n            _this._createArrow({\r\n                className: 'right-arrow',\r\n                top: scrollbarDelta,\r\n                left: void 0,\r\n                bottom: void 0,\r\n                right: arrowDelta,\r\n                bgWidth: options.arrowSize,\r\n                bgHeight: options.horizontalScrollbarSize,\r\n                onActivate: function () { return _this._host.onMouseWheel(new StandardMouseWheelEvent(null, -1, 0)); },\r\n            });\r\n        }\r\n        _this._createSlider(Math.floor((options.horizontalScrollbarSize - options.horizontalSliderSize) / 2), 0, undefined, options.horizontalSliderSize);\r\n        return _this;\r\n    }\r\n    HorizontalScrollbar.prototype._updateSlider = function (sliderSize, sliderPosition) {\r\n        this.slider.setWidth(sliderSize);\r\n        this.slider.setLeft(sliderPosition);\r\n    };\r\n    HorizontalScrollbar.prototype._renderDomNode = function (largeSize, smallSize) {\r\n        this.domNode.setWidth(largeSize);\r\n        this.domNode.setHeight(smallSize);\r\n        this.domNode.setLeft(0);\r\n        this.domNode.setBottom(0);\r\n    };\r\n    HorizontalScrollbar.prototype.onDidScroll = function (e) {\r\n        this._shouldRender = this._onElementScrollSize(e.scrollWidth) || this._shouldRender;\r\n        this._shouldRender = this._onElementScrollPosition(e.scrollLeft) || this._shouldRender;\r\n        this._shouldRender = this._onElementSize(e.width) || this._shouldRender;\r\n        return this._shouldRender;\r\n    };\r\n    HorizontalScrollbar.prototype._mouseDownRelativePosition = function (offsetX, offsetY) {\r\n        return offsetX;\r\n    };\r\n    HorizontalScrollbar.prototype._sliderMousePosition = function (e) {\r\n        return e.posx;\r\n    };\r\n    HorizontalScrollbar.prototype._sliderOrthogonalMousePosition = function (e) {\r\n        return e.posy;\r\n    };\r\n    HorizontalScrollbar.prototype.writeScrollPosition = function (target, scrollPosition) {\r\n        target.scrollLeft = scrollPosition;\r\n    };\r\n    return HorizontalScrollbar;\r\n}(AbstractScrollbar));\r\nexport { HorizontalScrollbar };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { StandardMouseWheelEvent } from '../../mouseEvent.js';\r\nimport { AbstractScrollbar } from './abstractScrollbar.js';\r\nimport { ARROW_IMG_SIZE } from './scrollbarArrow.js';\r\nimport { ScrollbarState } from './scrollbarState.js';\r\nvar VerticalScrollbar = /** @class */ (function (_super) {\r\n    __extends(VerticalScrollbar, _super);\r\n    function VerticalScrollbar(scrollable, options, host) {\r\n        var _this = _super.call(this, {\r\n            lazyRender: options.lazyRender,\r\n            host: host,\r\n            scrollbarState: new ScrollbarState((options.verticalHasArrows ? options.arrowSize : 0), (options.vertical === 2 /* Hidden */ ? 0 : options.verticalScrollbarSize), \r\n            // give priority to vertical scroll bar over horizontal and let it scroll all the way to the bottom\r\n            0),\r\n            visibility: options.vertical,\r\n            extraScrollbarClassName: 'vertical',\r\n            scrollable: scrollable\r\n        }) || this;\r\n        if (options.verticalHasArrows) {\r\n            var arrowDelta = (options.arrowSize - ARROW_IMG_SIZE) / 2;\r\n            var scrollbarDelta = (options.verticalScrollbarSize - ARROW_IMG_SIZE) / 2;\r\n            _this._createArrow({\r\n                className: 'up-arrow',\r\n                top: arrowDelta,\r\n                left: scrollbarDelta,\r\n                bottom: void 0,\r\n                right: void 0,\r\n                bgWidth: options.verticalScrollbarSize,\r\n                bgHeight: options.arrowSize,\r\n                onActivate: function () { return _this._host.onMouseWheel(new StandardMouseWheelEvent(null, 0, 1)); },\r\n            });\r\n            _this._createArrow({\r\n                className: 'down-arrow',\r\n                top: void 0,\r\n                left: scrollbarDelta,\r\n                bottom: arrowDelta,\r\n                right: void 0,\r\n                bgWidth: options.verticalScrollbarSize,\r\n                bgHeight: options.arrowSize,\r\n                onActivate: function () { return _this._host.onMouseWheel(new StandardMouseWheelEvent(null, 0, -1)); },\r\n            });\r\n        }\r\n        _this._createSlider(0, Math.floor((options.verticalScrollbarSize - options.verticalSliderSize) / 2), options.verticalSliderSize, undefined);\r\n        return _this;\r\n    }\r\n    VerticalScrollbar.prototype._updateSlider = function (sliderSize, sliderPosition) {\r\n        this.slider.setHeight(sliderSize);\r\n        this.slider.setTop(sliderPosition);\r\n    };\r\n    VerticalScrollbar.prototype._renderDomNode = function (largeSize, smallSize) {\r\n        this.domNode.setWidth(smallSize);\r\n        this.domNode.setHeight(largeSize);\r\n        this.domNode.setRight(0);\r\n        this.domNode.setTop(0);\r\n    };\r\n    VerticalScrollbar.prototype.onDidScroll = function (e) {\r\n        this._shouldRender = this._onElementScrollSize(e.scrollHeight) || this._shouldRender;\r\n        this._shouldRender = this._onElementScrollPosition(e.scrollTop) || this._shouldRender;\r\n        this._shouldRender = this._onElementSize(e.height) || this._shouldRender;\r\n        return this._shouldRender;\r\n    };\r\n    VerticalScrollbar.prototype._mouseDownRelativePosition = function (offsetX, offsetY) {\r\n        return offsetY;\r\n    };\r\n    VerticalScrollbar.prototype._sliderMousePosition = function (e) {\r\n        return e.posy;\r\n    };\r\n    VerticalScrollbar.prototype._sliderOrthogonalMousePosition = function (e) {\r\n        return e.posx;\r\n    };\r\n    VerticalScrollbar.prototype.writeScrollPosition = function (target, scrollPosition) {\r\n        target.scrollTop = scrollPosition;\r\n    };\r\n    return VerticalScrollbar;\r\n}(AbstractScrollbar));\r\nexport { VerticalScrollbar };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Emitter } from './event.js';\r\nimport { Disposable } from './lifecycle.js';\r\nvar ScrollState = /** @class */ (function () {\r\n    function ScrollState(width, scrollWidth, scrollLeft, height, scrollHeight, scrollTop) {\r\n        width = width | 0;\r\n        scrollWidth = scrollWidth | 0;\r\n        scrollLeft = scrollLeft | 0;\r\n        height = height | 0;\r\n        scrollHeight = scrollHeight | 0;\r\n        scrollTop = scrollTop | 0;\r\n        if (width < 0) {\r\n            width = 0;\r\n        }\r\n        if (scrollLeft + width > scrollWidth) {\r\n            scrollLeft = scrollWidth - width;\r\n        }\r\n        if (scrollLeft < 0) {\r\n            scrollLeft = 0;\r\n        }\r\n        if (height < 0) {\r\n            height = 0;\r\n        }\r\n        if (scrollTop + height > scrollHeight) {\r\n            scrollTop = scrollHeight - height;\r\n        }\r\n        if (scrollTop < 0) {\r\n            scrollTop = 0;\r\n        }\r\n        this.width = width;\r\n        this.scrollWidth = scrollWidth;\r\n        this.scrollLeft = scrollLeft;\r\n        this.height = height;\r\n        this.scrollHeight = scrollHeight;\r\n        this.scrollTop = scrollTop;\r\n    }\r\n    ScrollState.prototype.equals = function (other) {\r\n        return (this.width === other.width\r\n            && this.scrollWidth === other.scrollWidth\r\n            && this.scrollLeft === other.scrollLeft\r\n            && this.height === other.height\r\n            && this.scrollHeight === other.scrollHeight\r\n            && this.scrollTop === other.scrollTop);\r\n    };\r\n    ScrollState.prototype.withScrollDimensions = function (update) {\r\n        return new ScrollState((typeof update.width !== 'undefined' ? update.width : this.width), (typeof update.scrollWidth !== 'undefined' ? update.scrollWidth : this.scrollWidth), this.scrollLeft, (typeof update.height !== 'undefined' ? update.height : this.height), (typeof update.scrollHeight !== 'undefined' ? update.scrollHeight : this.scrollHeight), this.scrollTop);\r\n    };\r\n    ScrollState.prototype.withScrollPosition = function (update) {\r\n        return new ScrollState(this.width, this.scrollWidth, (typeof update.scrollLeft !== 'undefined' ? update.scrollLeft : this.scrollLeft), this.height, this.scrollHeight, (typeof update.scrollTop !== 'undefined' ? update.scrollTop : this.scrollTop));\r\n    };\r\n    ScrollState.prototype.createScrollEvent = function (previous) {\r\n        var widthChanged = (this.width !== previous.width);\r\n        var scrollWidthChanged = (this.scrollWidth !== previous.scrollWidth);\r\n        var scrollLeftChanged = (this.scrollLeft !== previous.scrollLeft);\r\n        var heightChanged = (this.height !== previous.height);\r\n        var scrollHeightChanged = (this.scrollHeight !== previous.scrollHeight);\r\n        var scrollTopChanged = (this.scrollTop !== previous.scrollTop);\r\n        return {\r\n            width: this.width,\r\n            scrollWidth: this.scrollWidth,\r\n            scrollLeft: this.scrollLeft,\r\n            height: this.height,\r\n            scrollHeight: this.scrollHeight,\r\n            scrollTop: this.scrollTop,\r\n            widthChanged: widthChanged,\r\n            scrollWidthChanged: scrollWidthChanged,\r\n            scrollLeftChanged: scrollLeftChanged,\r\n            heightChanged: heightChanged,\r\n            scrollHeightChanged: scrollHeightChanged,\r\n            scrollTopChanged: scrollTopChanged,\r\n        };\r\n    };\r\n    return ScrollState;\r\n}());\r\nexport { ScrollState };\r\nvar Scrollable = /** @class */ (function (_super) {\r\n    __extends(Scrollable, _super);\r\n    function Scrollable(smoothScrollDuration, scheduleAtNextAnimationFrame) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onScroll = _this._register(new Emitter());\r\n        _this.onScroll = _this._onScroll.event;\r\n        _this._smoothScrollDuration = smoothScrollDuration;\r\n        _this._scheduleAtNextAnimationFrame = scheduleAtNextAnimationFrame;\r\n        _this._state = new ScrollState(0, 0, 0, 0, 0, 0);\r\n        _this._smoothScrolling = null;\r\n        return _this;\r\n    }\r\n    Scrollable.prototype.dispose = function () {\r\n        if (this._smoothScrolling) {\r\n            this._smoothScrolling.dispose();\r\n            this._smoothScrolling = null;\r\n        }\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    Scrollable.prototype.setSmoothScrollDuration = function (smoothScrollDuration) {\r\n        this._smoothScrollDuration = smoothScrollDuration;\r\n    };\r\n    Scrollable.prototype.validateScrollPosition = function (scrollPosition) {\r\n        return this._state.withScrollPosition(scrollPosition);\r\n    };\r\n    Scrollable.prototype.getScrollDimensions = function () {\r\n        return this._state;\r\n    };\r\n    Scrollable.prototype.setScrollDimensions = function (dimensions) {\r\n        var newState = this._state.withScrollDimensions(dimensions);\r\n        this._setState(newState);\r\n        // Validate outstanding animated scroll position target\r\n        if (this._smoothScrolling) {\r\n            this._smoothScrolling.acceptScrollDimensions(this._state);\r\n        }\r\n    };\r\n    /**\r\n     * Returns the final scroll position that the instance will have once the smooth scroll animation concludes.\r\n     * If no scroll animation is occurring, it will return the current scroll position instead.\r\n     */\r\n    Scrollable.prototype.getFutureScrollPosition = function () {\r\n        if (this._smoothScrolling) {\r\n            return this._smoothScrolling.to;\r\n        }\r\n        return this._state;\r\n    };\r\n    /**\r\n     * Returns the current scroll position.\r\n     * Note: This result might be an intermediate scroll position, as there might be an ongoing smooth scroll animation.\r\n     */\r\n    Scrollable.prototype.getCurrentScrollPosition = function () {\r\n        return this._state;\r\n    };\r\n    Scrollable.prototype.setScrollPositionNow = function (update) {\r\n        // no smooth scrolling requested\r\n        var newState = this._state.withScrollPosition(update);\r\n        // Terminate any outstanding smooth scrolling\r\n        if (this._smoothScrolling) {\r\n            this._smoothScrolling.dispose();\r\n            this._smoothScrolling = null;\r\n        }\r\n        this._setState(newState);\r\n    };\r\n    Scrollable.prototype.setScrollPositionSmooth = function (update) {\r\n        var _this = this;\r\n        if (this._smoothScrollDuration === 0) {\r\n            // Smooth scrolling not supported.\r\n            return this.setScrollPositionNow(update);\r\n        }\r\n        if (this._smoothScrolling) {\r\n            // Combine our pending scrollLeft/scrollTop with incoming scrollLeft/scrollTop\r\n            update = {\r\n                scrollLeft: (typeof update.scrollLeft === 'undefined' ? this._smoothScrolling.to.scrollLeft : update.scrollLeft),\r\n                scrollTop: (typeof update.scrollTop === 'undefined' ? this._smoothScrolling.to.scrollTop : update.scrollTop)\r\n            };\r\n            // Validate `update`\r\n            var validTarget = this._state.withScrollPosition(update);\r\n            if (this._smoothScrolling.to.scrollLeft === validTarget.scrollLeft && this._smoothScrolling.to.scrollTop === validTarget.scrollTop) {\r\n                // No need to interrupt or extend the current animation since we're going to the same place\r\n                return;\r\n            }\r\n            var newSmoothScrolling = this._smoothScrolling.combine(this._state, validTarget, this._smoothScrollDuration);\r\n            this._smoothScrolling.dispose();\r\n            this._smoothScrolling = newSmoothScrolling;\r\n        }\r\n        else {\r\n            // Validate `update`\r\n            var validTarget = this._state.withScrollPosition(update);\r\n            this._smoothScrolling = SmoothScrollingOperation.start(this._state, validTarget, this._smoothScrollDuration);\r\n        }\r\n        // Begin smooth scrolling animation\r\n        this._smoothScrolling.animationFrameDisposable = this._scheduleAtNextAnimationFrame(function () {\r\n            if (!_this._smoothScrolling) {\r\n                return;\r\n            }\r\n            _this._smoothScrolling.animationFrameDisposable = null;\r\n            _this._performSmoothScrolling();\r\n        });\r\n    };\r\n    Scrollable.prototype._performSmoothScrolling = function () {\r\n        var _this = this;\r\n        if (!this._smoothScrolling) {\r\n            return;\r\n        }\r\n        var update = this._smoothScrolling.tick();\r\n        var newState = this._state.withScrollPosition(update);\r\n        this._setState(newState);\r\n        if (update.isDone) {\r\n            this._smoothScrolling.dispose();\r\n            this._smoothScrolling = null;\r\n            return;\r\n        }\r\n        // Continue smooth scrolling animation\r\n        this._smoothScrolling.animationFrameDisposable = this._scheduleAtNextAnimationFrame(function () {\r\n            if (!_this._smoothScrolling) {\r\n                return;\r\n            }\r\n            _this._smoothScrolling.animationFrameDisposable = null;\r\n            _this._performSmoothScrolling();\r\n        });\r\n    };\r\n    Scrollable.prototype._setState = function (newState) {\r\n        var oldState = this._state;\r\n        if (oldState.equals(newState)) {\r\n            // no change\r\n            return;\r\n        }\r\n        this._state = newState;\r\n        this._onScroll.fire(this._state.createScrollEvent(oldState));\r\n    };\r\n    return Scrollable;\r\n}(Disposable));\r\nexport { Scrollable };\r\nvar SmoothScrollingUpdate = /** @class */ (function () {\r\n    function SmoothScrollingUpdate(scrollLeft, scrollTop, isDone) {\r\n        this.scrollLeft = scrollLeft;\r\n        this.scrollTop = scrollTop;\r\n        this.isDone = isDone;\r\n    }\r\n    return SmoothScrollingUpdate;\r\n}());\r\nexport { SmoothScrollingUpdate };\r\nfunction createEaseOutCubic(from, to) {\r\n    var delta = to - from;\r\n    return function (completion) {\r\n        return from + delta * easeOutCubic(completion);\r\n    };\r\n}\r\nfunction createComposed(a, b, cut) {\r\n    return function (completion) {\r\n        if (completion < cut) {\r\n            return a(completion / cut);\r\n        }\r\n        return b((completion - cut) / (1 - cut));\r\n    };\r\n}\r\nvar SmoothScrollingOperation = /** @class */ (function () {\r\n    function SmoothScrollingOperation(from, to, startTime, duration) {\r\n        this.from = from;\r\n        this.to = to;\r\n        this.duration = duration;\r\n        this._startTime = startTime;\r\n        this.animationFrameDisposable = null;\r\n        this._initAnimations();\r\n    }\r\n    SmoothScrollingOperation.prototype._initAnimations = function () {\r\n        this.scrollLeft = this._initAnimation(this.from.scrollLeft, this.to.scrollLeft, this.to.width);\r\n        this.scrollTop = this._initAnimation(this.from.scrollTop, this.to.scrollTop, this.to.height);\r\n    };\r\n    SmoothScrollingOperation.prototype._initAnimation = function (from, to, viewportSize) {\r\n        var delta = Math.abs(from - to);\r\n        if (delta > 2.5 * viewportSize) {\r\n            var stop1 = void 0, stop2 = void 0;\r\n            if (from < to) {\r\n                // scroll to 75% of the viewportSize\r\n                stop1 = from + 0.75 * viewportSize;\r\n                stop2 = to - 0.75 * viewportSize;\r\n            }\r\n            else {\r\n                stop1 = from - 0.75 * viewportSize;\r\n                stop2 = to + 0.75 * viewportSize;\r\n            }\r\n            return createComposed(createEaseOutCubic(from, stop1), createEaseOutCubic(stop2, to), 0.33);\r\n        }\r\n        return createEaseOutCubic(from, to);\r\n    };\r\n    SmoothScrollingOperation.prototype.dispose = function () {\r\n        if (this.animationFrameDisposable !== null) {\r\n            this.animationFrameDisposable.dispose();\r\n            this.animationFrameDisposable = null;\r\n        }\r\n    };\r\n    SmoothScrollingOperation.prototype.acceptScrollDimensions = function (state) {\r\n        this.to = state.withScrollPosition(this.to);\r\n        this._initAnimations();\r\n    };\r\n    SmoothScrollingOperation.prototype.tick = function () {\r\n        return this._tick(Date.now());\r\n    };\r\n    SmoothScrollingOperation.prototype._tick = function (now) {\r\n        var completion = (now - this._startTime) / this.duration;\r\n        if (completion < 1) {\r\n            var newScrollLeft = this.scrollLeft(completion);\r\n            var newScrollTop = this.scrollTop(completion);\r\n            return new SmoothScrollingUpdate(newScrollLeft, newScrollTop, false);\r\n        }\r\n        return new SmoothScrollingUpdate(this.to.scrollLeft, this.to.scrollTop, true);\r\n    };\r\n    SmoothScrollingOperation.prototype.combine = function (from, to, duration) {\r\n        return SmoothScrollingOperation.start(from, to, duration);\r\n    };\r\n    SmoothScrollingOperation.start = function (from, to, duration) {\r\n        // +10 / -10 : pretend the animation already started for a quicker response to a scroll request\r\n        duration = duration + 10;\r\n        var startTime = Date.now() - 10;\r\n        return new SmoothScrollingOperation(from, to, startTime, duration);\r\n    };\r\n    return SmoothScrollingOperation;\r\n}());\r\nexport { SmoothScrollingOperation };\r\nfunction easeInCubic(t) {\r\n    return Math.pow(t, 3);\r\n}\r\nfunction easeOutCubic(t) {\r\n    return 1 - easeInCubic(1 - t);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './media/scrollbars.css';\r\nimport * as dom from '../../dom.js';\r\nimport { createFastDomNode } from '../../fastDomNode.js';\r\nimport { StandardMouseWheelEvent } from '../../mouseEvent.js';\r\nimport { HorizontalScrollbar } from './horizontalScrollbar.js';\r\nimport { VerticalScrollbar } from './verticalScrollbar.js';\r\nimport { Widget } from '../widget.js';\r\nimport { TimeoutTimer } from '../../../common/async.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { dispose } from '../../../common/lifecycle.js';\r\nimport * as platform from '../../../common/platform.js';\r\nimport { Scrollable } from '../../../common/scrollable.js';\r\nvar HIDE_TIMEOUT = 500;\r\nvar SCROLL_WHEEL_SENSITIVITY = 50;\r\nvar SCROLL_WHEEL_SMOOTH_SCROLL_ENABLED = true;\r\nvar MouseWheelClassifierItem = /** @class */ (function () {\r\n    function MouseWheelClassifierItem(timestamp, deltaX, deltaY) {\r\n        this.timestamp = timestamp;\r\n        this.deltaX = deltaX;\r\n        this.deltaY = deltaY;\r\n        this.score = 0;\r\n    }\r\n    return MouseWheelClassifierItem;\r\n}());\r\nvar MouseWheelClassifier = /** @class */ (function () {\r\n    function MouseWheelClassifier() {\r\n        this._capacity = 5;\r\n        this._memory = [];\r\n        this._front = -1;\r\n        this._rear = -1;\r\n    }\r\n    MouseWheelClassifier.prototype.isPhysicalMouseWheel = function () {\r\n        if (this._front === -1 && this._rear === -1) {\r\n            // no elements\r\n            return false;\r\n        }\r\n        // 0.5 * last + 0.25 * before last + 0.125 * before before last + ...\r\n        var remainingInfluence = 1;\r\n        var score = 0;\r\n        var iteration = 1;\r\n        var index = this._rear;\r\n        do {\r\n            var influence = (index === this._front ? remainingInfluence : Math.pow(2, -iteration));\r\n            remainingInfluence -= influence;\r\n            score += this._memory[index].score * influence;\r\n            if (index === this._front) {\r\n                break;\r\n            }\r\n            index = (this._capacity + index - 1) % this._capacity;\r\n            iteration++;\r\n        } while (true);\r\n        return (score <= 0.5);\r\n    };\r\n    MouseWheelClassifier.prototype.accept = function (timestamp, deltaX, deltaY) {\r\n        var item = new MouseWheelClassifierItem(timestamp, deltaX, deltaY);\r\n        item.score = this._computeScore(item);\r\n        if (this._front === -1 && this._rear === -1) {\r\n            this._memory[0] = item;\r\n            this._front = 0;\r\n            this._rear = 0;\r\n        }\r\n        else {\r\n            this._rear = (this._rear + 1) % this._capacity;\r\n            if (this._rear === this._front) {\r\n                // Drop oldest\r\n                this._front = (this._front + 1) % this._capacity;\r\n            }\r\n            this._memory[this._rear] = item;\r\n        }\r\n    };\r\n    /**\r\n     * A score between 0 and 1 for `item`.\r\n     *  - a score towards 0 indicates that the source appears to be a physical mouse wheel\r\n     *  - a score towards 1 indicates that the source appears to be a touchpad or magic mouse, etc.\r\n     */\r\n    MouseWheelClassifier.prototype._computeScore = function (item) {\r\n        if (Math.abs(item.deltaX) > 0 && Math.abs(item.deltaY) > 0) {\r\n            // both axes exercised => definitely not a physical mouse wheel\r\n            return 1;\r\n        }\r\n        var score = 0.5;\r\n        var prev = (this._front === -1 && this._rear === -1 ? null : this._memory[this._rear]);\r\n        if (prev) {\r\n            // const deltaT = item.timestamp - prev.timestamp;\r\n            // if (deltaT < 1000 / 30) {\r\n            // \t// sooner than X times per second => indicator that this is not a physical mouse wheel\r\n            // \tscore += 0.25;\r\n            // }\r\n            // if (item.deltaX === prev.deltaX && item.deltaY === prev.deltaY) {\r\n            // \t// equal amplitude => indicator that this is a physical mouse wheel\r\n            // \tscore -= 0.25;\r\n            // }\r\n        }\r\n        if (Math.abs(item.deltaX - Math.round(item.deltaX)) > 0 || Math.abs(item.deltaY - Math.round(item.deltaY)) > 0) {\r\n            // non-integer deltas => indicator that this is not a physical mouse wheel\r\n            score += 0.25;\r\n        }\r\n        return Math.min(Math.max(score, 0), 1);\r\n    };\r\n    MouseWheelClassifier.INSTANCE = new MouseWheelClassifier();\r\n    return MouseWheelClassifier;\r\n}());\r\nexport { MouseWheelClassifier };\r\nvar AbstractScrollableElement = /** @class */ (function (_super) {\r\n    __extends(AbstractScrollableElement, _super);\r\n    function AbstractScrollableElement(element, options, scrollable) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onScroll = _this._register(new Emitter());\r\n        _this.onScroll = _this._onScroll.event;\r\n        element.style.overflow = 'hidden';\r\n        _this._options = resolveOptions(options);\r\n        _this._scrollable = scrollable;\r\n        _this._register(_this._scrollable.onScroll(function (e) {\r\n            _this._onDidScroll(e);\r\n            _this._onScroll.fire(e);\r\n        }));\r\n        var scrollbarHost = {\r\n            onMouseWheel: function (mouseWheelEvent) { return _this._onMouseWheel(mouseWheelEvent); },\r\n            onDragStart: function () { return _this._onDragStart(); },\r\n            onDragEnd: function () { return _this._onDragEnd(); },\r\n        };\r\n        _this._verticalScrollbar = _this._register(new VerticalScrollbar(_this._scrollable, _this._options, scrollbarHost));\r\n        _this._horizontalScrollbar = _this._register(new HorizontalScrollbar(_this._scrollable, _this._options, scrollbarHost));\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.className = 'monaco-scrollable-element ' + _this._options.className;\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._domNode.style.position = 'relative';\r\n        _this._domNode.style.overflow = 'hidden';\r\n        _this._domNode.appendChild(element);\r\n        _this._domNode.appendChild(_this._horizontalScrollbar.domNode.domNode);\r\n        _this._domNode.appendChild(_this._verticalScrollbar.domNode.domNode);\r\n        if (_this._options.useShadows) {\r\n            _this._leftShadowDomNode = createFastDomNode(document.createElement('div'));\r\n            _this._leftShadowDomNode.setClassName('shadow');\r\n            _this._domNode.appendChild(_this._leftShadowDomNode.domNode);\r\n            _this._topShadowDomNode = createFastDomNode(document.createElement('div'));\r\n            _this._topShadowDomNode.setClassName('shadow');\r\n            _this._domNode.appendChild(_this._topShadowDomNode.domNode);\r\n            _this._topLeftShadowDomNode = createFastDomNode(document.createElement('div'));\r\n            _this._topLeftShadowDomNode.setClassName('shadow top-left-corner');\r\n            _this._domNode.appendChild(_this._topLeftShadowDomNode.domNode);\r\n        }\r\n        _this._listenOnDomNode = _this._options.listenOnDomNode || _this._domNode;\r\n        _this._mouseWheelToDispose = [];\r\n        _this._setListeningToMouseWheel(_this._options.handleMouseWheel);\r\n        _this.onmouseover(_this._listenOnDomNode, function (e) { return _this._onMouseOver(e); });\r\n        _this.onnonbubblingmouseout(_this._listenOnDomNode, function (e) { return _this._onMouseOut(e); });\r\n        _this._hideTimeout = _this._register(new TimeoutTimer());\r\n        _this._isDragging = false;\r\n        _this._mouseIsOver = false;\r\n        _this._shouldRender = true;\r\n        _this._revealOnScroll = true;\r\n        return _this;\r\n    }\r\n    AbstractScrollableElement.prototype.dispose = function () {\r\n        this._mouseWheelToDispose = dispose(this._mouseWheelToDispose);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    /**\r\n     * Get the generated 'scrollable' dom node\r\n     */\r\n    AbstractScrollableElement.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    AbstractScrollableElement.prototype.getOverviewRulerLayoutInfo = function () {\r\n        return {\r\n            parent: this._domNode,\r\n            insertBefore: this._verticalScrollbar.domNode.domNode,\r\n        };\r\n    };\r\n    /**\r\n     * Delegate a mouse down event to the vertical scrollbar.\r\n     * This is to help with clicking somewhere else and having the scrollbar react.\r\n     */\r\n    AbstractScrollableElement.prototype.delegateVerticalScrollbarMouseDown = function (browserEvent) {\r\n        this._verticalScrollbar.delegateMouseDown(browserEvent);\r\n    };\r\n    AbstractScrollableElement.prototype.getScrollDimensions = function () {\r\n        return this._scrollable.getScrollDimensions();\r\n    };\r\n    AbstractScrollableElement.prototype.setScrollDimensions = function (dimensions) {\r\n        this._scrollable.setScrollDimensions(dimensions);\r\n    };\r\n    /**\r\n     * Update the class name of the scrollable element.\r\n     */\r\n    AbstractScrollableElement.prototype.updateClassName = function (newClassName) {\r\n        this._options.className = newClassName;\r\n        // Defaults are different on Macs\r\n        if (platform.isMacintosh) {\r\n            this._options.className += ' mac';\r\n        }\r\n        this._domNode.className = 'monaco-scrollable-element ' + this._options.className;\r\n    };\r\n    /**\r\n     * Update configuration options for the scrollbar.\r\n     * Really this is Editor.IEditorScrollbarOptions, but base shouldn't\r\n     * depend on Editor.\r\n     */\r\n    AbstractScrollableElement.prototype.updateOptions = function (newOptions) {\r\n        var massagedOptions = resolveOptions(newOptions);\r\n        this._options.handleMouseWheel = massagedOptions.handleMouseWheel;\r\n        this._options.mouseWheelScrollSensitivity = massagedOptions.mouseWheelScrollSensitivity;\r\n        this._setListeningToMouseWheel(this._options.handleMouseWheel);\r\n        if (!this._options.lazyRender) {\r\n            this._render();\r\n        }\r\n    };\r\n    // -------------------- mouse wheel scrolling --------------------\r\n    AbstractScrollableElement.prototype._setListeningToMouseWheel = function (shouldListen) {\r\n        var _this = this;\r\n        var isListening = (this._mouseWheelToDispose.length > 0);\r\n        if (isListening === shouldListen) {\r\n            // No change\r\n            return;\r\n        }\r\n        // Stop listening (if necessary)\r\n        this._mouseWheelToDispose = dispose(this._mouseWheelToDispose);\r\n        // Start listening (if necessary)\r\n        if (shouldListen) {\r\n            var onMouseWheel = function (browserEvent) {\r\n                var e = new StandardMouseWheelEvent(browserEvent);\r\n                _this._onMouseWheel(e);\r\n            };\r\n            this._mouseWheelToDispose.push(dom.addDisposableListener(this._listenOnDomNode, 'mousewheel', onMouseWheel));\r\n            this._mouseWheelToDispose.push(dom.addDisposableListener(this._listenOnDomNode, 'DOMMouseScroll', onMouseWheel));\r\n        }\r\n    };\r\n    AbstractScrollableElement.prototype._onMouseWheel = function (e) {\r\n        var _a;\r\n        var classifier = MouseWheelClassifier.INSTANCE;\r\n        if (SCROLL_WHEEL_SMOOTH_SCROLL_ENABLED) {\r\n            classifier.accept(Date.now(), e.deltaX, e.deltaY);\r\n        }\r\n        // console.log(`${Date.now()}, ${e.deltaY}, ${e.deltaX}`);\r\n        if (e.deltaY || e.deltaX) {\r\n            var deltaY = e.deltaY * this._options.mouseWheelScrollSensitivity;\r\n            var deltaX = e.deltaX * this._options.mouseWheelScrollSensitivity;\r\n            if (this._options.flipAxes) {\r\n                _a = [deltaX, deltaY], deltaY = _a[0], deltaX = _a[1];\r\n            }\r\n            // Convert vertical scrolling to horizontal if shift is held, this\r\n            // is handled at a higher level on Mac\r\n            var shiftConvert = !platform.isMacintosh && e.browserEvent && e.browserEvent.shiftKey;\r\n            if ((this._options.scrollYToX || shiftConvert) && !deltaX) {\r\n                deltaX = deltaY;\r\n                deltaY = 0;\r\n            }\r\n            var futureScrollPosition = this._scrollable.getFutureScrollPosition();\r\n            var desiredScrollPosition = {};\r\n            if (deltaY) {\r\n                var desiredScrollTop = futureScrollPosition.scrollTop - SCROLL_WHEEL_SENSITIVITY * deltaY;\r\n                this._verticalScrollbar.writeScrollPosition(desiredScrollPosition, desiredScrollTop);\r\n            }\r\n            if (deltaX) {\r\n                var desiredScrollLeft = futureScrollPosition.scrollLeft - SCROLL_WHEEL_SENSITIVITY * deltaX;\r\n                this._horizontalScrollbar.writeScrollPosition(desiredScrollPosition, desiredScrollLeft);\r\n            }\r\n            // Check that we are scrolling towards a location which is valid\r\n            desiredScrollPosition = this._scrollable.validateScrollPosition(desiredScrollPosition);\r\n            if (futureScrollPosition.scrollLeft !== desiredScrollPosition.scrollLeft || futureScrollPosition.scrollTop !== desiredScrollPosition.scrollTop) {\r\n                var canPerformSmoothScroll = (SCROLL_WHEEL_SMOOTH_SCROLL_ENABLED\r\n                    && this._options.mouseWheelSmoothScroll\r\n                    && classifier.isPhysicalMouseWheel());\r\n                if (canPerformSmoothScroll) {\r\n                    this._scrollable.setScrollPositionSmooth(desiredScrollPosition);\r\n                }\r\n                else {\r\n                    this._scrollable.setScrollPositionNow(desiredScrollPosition);\r\n                }\r\n                this._shouldRender = true;\r\n            }\r\n        }\r\n        if (this._options.alwaysConsumeMouseWheel || this._shouldRender) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    AbstractScrollableElement.prototype._onDidScroll = function (e) {\r\n        this._shouldRender = this._horizontalScrollbar.onDidScroll(e) || this._shouldRender;\r\n        this._shouldRender = this._verticalScrollbar.onDidScroll(e) || this._shouldRender;\r\n        if (this._options.useShadows) {\r\n            this._shouldRender = true;\r\n        }\r\n        if (this._revealOnScroll) {\r\n            this._reveal();\r\n        }\r\n        if (!this._options.lazyRender) {\r\n            this._render();\r\n        }\r\n    };\r\n    /**\r\n     * Render / mutate the DOM now.\r\n     * Should be used together with the ctor option `lazyRender`.\r\n     */\r\n    AbstractScrollableElement.prototype.renderNow = function () {\r\n        if (!this._options.lazyRender) {\r\n            throw new Error('Please use `lazyRender` together with `renderNow`!');\r\n        }\r\n        this._render();\r\n    };\r\n    AbstractScrollableElement.prototype._render = function () {\r\n        if (!this._shouldRender) {\r\n            return;\r\n        }\r\n        this._shouldRender = false;\r\n        this._horizontalScrollbar.render();\r\n        this._verticalScrollbar.render();\r\n        if (this._options.useShadows) {\r\n            var scrollState = this._scrollable.getCurrentScrollPosition();\r\n            var enableTop = scrollState.scrollTop > 0;\r\n            var enableLeft = scrollState.scrollLeft > 0;\r\n            this._leftShadowDomNode.setClassName('shadow' + (enableLeft ? ' left' : ''));\r\n            this._topShadowDomNode.setClassName('shadow' + (enableTop ? ' top' : ''));\r\n            this._topLeftShadowDomNode.setClassName('shadow top-left-corner' + (enableTop ? ' top' : '') + (enableLeft ? ' left' : ''));\r\n        }\r\n    };\r\n    // -------------------- fade in / fade out --------------------\r\n    AbstractScrollableElement.prototype._onDragStart = function () {\r\n        this._isDragging = true;\r\n        this._reveal();\r\n    };\r\n    AbstractScrollableElement.prototype._onDragEnd = function () {\r\n        this._isDragging = false;\r\n        this._hide();\r\n    };\r\n    AbstractScrollableElement.prototype._onMouseOut = function (e) {\r\n        this._mouseIsOver = false;\r\n        this._hide();\r\n    };\r\n    AbstractScrollableElement.prototype._onMouseOver = function (e) {\r\n        this._mouseIsOver = true;\r\n        this._reveal();\r\n    };\r\n    AbstractScrollableElement.prototype._reveal = function () {\r\n        this._verticalScrollbar.beginReveal();\r\n        this._horizontalScrollbar.beginReveal();\r\n        this._scheduleHide();\r\n    };\r\n    AbstractScrollableElement.prototype._hide = function () {\r\n        if (!this._mouseIsOver && !this._isDragging) {\r\n            this._verticalScrollbar.beginHide();\r\n            this._horizontalScrollbar.beginHide();\r\n        }\r\n    };\r\n    AbstractScrollableElement.prototype._scheduleHide = function () {\r\n        var _this = this;\r\n        if (!this._mouseIsOver && !this._isDragging) {\r\n            this._hideTimeout.cancelAndSet(function () { return _this._hide(); }, HIDE_TIMEOUT);\r\n        }\r\n    };\r\n    return AbstractScrollableElement;\r\n}(Widget));\r\nexport { AbstractScrollableElement };\r\nvar ScrollableElement = /** @class */ (function (_super) {\r\n    __extends(ScrollableElement, _super);\r\n    function ScrollableElement(element, options) {\r\n        var _this = this;\r\n        options = options || {};\r\n        options.mouseWheelSmoothScroll = false;\r\n        var scrollable = new Scrollable(0, function (callback) { return dom.scheduleAtNextAnimationFrame(callback); });\r\n        _this = _super.call(this, element, options, scrollable) || this;\r\n        _this._register(scrollable);\r\n        return _this;\r\n    }\r\n    ScrollableElement.prototype.setScrollPosition = function (update) {\r\n        this._scrollable.setScrollPositionNow(update);\r\n    };\r\n    ScrollableElement.prototype.getScrollPosition = function () {\r\n        return this._scrollable.getCurrentScrollPosition();\r\n    };\r\n    return ScrollableElement;\r\n}(AbstractScrollableElement));\r\nexport { ScrollableElement };\r\nvar SmoothScrollableElement = /** @class */ (function (_super) {\r\n    __extends(SmoothScrollableElement, _super);\r\n    function SmoothScrollableElement(element, options, scrollable) {\r\n        return _super.call(this, element, options, scrollable) || this;\r\n    }\r\n    return SmoothScrollableElement;\r\n}(AbstractScrollableElement));\r\nexport { SmoothScrollableElement };\r\nvar DomScrollableElement = /** @class */ (function (_super) {\r\n    __extends(DomScrollableElement, _super);\r\n    function DomScrollableElement(element, options) {\r\n        var _this = _super.call(this, element, options) || this;\r\n        _this._element = element;\r\n        _this.onScroll(function (e) {\r\n            if (e.scrollTopChanged) {\r\n                _this._element.scrollTop = e.scrollTop;\r\n            }\r\n            if (e.scrollLeftChanged) {\r\n                _this._element.scrollLeft = e.scrollLeft;\r\n            }\r\n        });\r\n        _this.scanDomNode();\r\n        return _this;\r\n    }\r\n    DomScrollableElement.prototype.scanDomNode = function () {\r\n        // widh, scrollLeft, scrollWidth, height, scrollTop, scrollHeight\r\n        this.setScrollDimensions({\r\n            width: this._element.clientWidth,\r\n            scrollWidth: this._element.scrollWidth,\r\n            height: this._element.clientHeight,\r\n            scrollHeight: this._element.scrollHeight\r\n        });\r\n        this.setScrollPosition({\r\n            scrollLeft: this._element.scrollLeft,\r\n            scrollTop: this._element.scrollTop,\r\n        });\r\n    };\r\n    return DomScrollableElement;\r\n}(ScrollableElement));\r\nexport { DomScrollableElement };\r\nfunction resolveOptions(opts) {\r\n    var result = {\r\n        lazyRender: (typeof opts.lazyRender !== 'undefined' ? opts.lazyRender : false),\r\n        className: (typeof opts.className !== 'undefined' ? opts.className : ''),\r\n        useShadows: (typeof opts.useShadows !== 'undefined' ? opts.useShadows : true),\r\n        handleMouseWheel: (typeof opts.handleMouseWheel !== 'undefined' ? opts.handleMouseWheel : true),\r\n        flipAxes: (typeof opts.flipAxes !== 'undefined' ? opts.flipAxes : false),\r\n        alwaysConsumeMouseWheel: (typeof opts.alwaysConsumeMouseWheel !== 'undefined' ? opts.alwaysConsumeMouseWheel : false),\r\n        scrollYToX: (typeof opts.scrollYToX !== 'undefined' ? opts.scrollYToX : false),\r\n        mouseWheelScrollSensitivity: (typeof opts.mouseWheelScrollSensitivity !== 'undefined' ? opts.mouseWheelScrollSensitivity : 1),\r\n        mouseWheelSmoothScroll: (typeof opts.mouseWheelSmoothScroll !== 'undefined' ? opts.mouseWheelSmoothScroll : true),\r\n        arrowSize: (typeof opts.arrowSize !== 'undefined' ? opts.arrowSize : 11),\r\n        listenOnDomNode: (typeof opts.listenOnDomNode !== 'undefined' ? opts.listenOnDomNode : null),\r\n        horizontal: (typeof opts.horizontal !== 'undefined' ? opts.horizontal : 1 /* Auto */),\r\n        horizontalScrollbarSize: (typeof opts.horizontalScrollbarSize !== 'undefined' ? opts.horizontalScrollbarSize : 10),\r\n        horizontalSliderSize: (typeof opts.horizontalSliderSize !== 'undefined' ? opts.horizontalSliderSize : 0),\r\n        horizontalHasArrows: (typeof opts.horizontalHasArrows !== 'undefined' ? opts.horizontalHasArrows : false),\r\n        vertical: (typeof opts.vertical !== 'undefined' ? opts.vertical : 1 /* Auto */),\r\n        verticalScrollbarSize: (typeof opts.verticalScrollbarSize !== 'undefined' ? opts.verticalScrollbarSize : 10),\r\n        verticalHasArrows: (typeof opts.verticalHasArrows !== 'undefined' ? opts.verticalHasArrows : false),\r\n        verticalSliderSize: (typeof opts.verticalSliderSize !== 'undefined' ? opts.verticalSliderSize : 0)\r\n    };\r\n    result.horizontalSliderSize = (typeof opts.horizontalSliderSize !== 'undefined' ? opts.horizontalSliderSize : result.horizontalScrollbarSize);\r\n    result.verticalSliderSize = (typeof opts.verticalSliderSize !== 'undefined' ? opts.verticalSliderSize : result.verticalScrollbarSize);\r\n    // Defaults are different on Macs\r\n    if (platform.isMacintosh) {\r\n        result.className += ' mac';\r\n    }\r\n    return result;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { SmoothScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\r\nimport { getThemeTypeSelector } from '../../../../platform/theme/common/themeService.js';\r\nvar EditorScrollbar = /** @class */ (function (_super) {\r\n    __extends(EditorScrollbar, _super);\r\n    function EditorScrollbar(context, linesContent, viewDomNode, overflowGuardDomNode) {\r\n        var _this = _super.call(this, context) || this;\r\n        var editor = _this._context.configuration.editor;\r\n        var configScrollbarOpts = editor.viewInfo.scrollbar;\r\n        var scrollbarOptions = {\r\n            listenOnDomNode: viewDomNode.domNode,\r\n            className: 'editor-scrollable' + ' ' + getThemeTypeSelector(context.theme.type),\r\n            useShadows: false,\r\n            lazyRender: true,\r\n            vertical: configScrollbarOpts.vertical,\r\n            horizontal: configScrollbarOpts.horizontal,\r\n            verticalHasArrows: configScrollbarOpts.verticalHasArrows,\r\n            horizontalHasArrows: configScrollbarOpts.horizontalHasArrows,\r\n            verticalScrollbarSize: configScrollbarOpts.verticalScrollbarSize,\r\n            verticalSliderSize: configScrollbarOpts.verticalSliderSize,\r\n            horizontalScrollbarSize: configScrollbarOpts.horizontalScrollbarSize,\r\n            horizontalSliderSize: configScrollbarOpts.horizontalSliderSize,\r\n            handleMouseWheel: configScrollbarOpts.handleMouseWheel,\r\n            arrowSize: configScrollbarOpts.arrowSize,\r\n            mouseWheelScrollSensitivity: configScrollbarOpts.mouseWheelScrollSensitivity,\r\n        };\r\n        _this.scrollbar = _this._register(new SmoothScrollableElement(linesContent.domNode, scrollbarOptions, _this._context.viewLayout.scrollable));\r\n        PartFingerprints.write(_this.scrollbar.getDomNode(), 5 /* ScrollableElement */);\r\n        _this.scrollbarDomNode = createFastDomNode(_this.scrollbar.getDomNode());\r\n        _this.scrollbarDomNode.setPosition('absolute');\r\n        _this._setLayout();\r\n        // When having a zone widget that calls .focus() on one of its dom elements,\r\n        // the browser will try desperately to reveal that dom node, unexpectedly\r\n        // changing the .scrollTop of this.linesContent\r\n        var onBrowserDesperateReveal = function (domNode, lookAtScrollTop, lookAtScrollLeft) {\r\n            var newScrollPosition = {};\r\n            if (lookAtScrollTop) {\r\n                var deltaTop = domNode.scrollTop;\r\n                if (deltaTop) {\r\n                    newScrollPosition.scrollTop = _this._context.viewLayout.getCurrentScrollTop() + deltaTop;\r\n                    domNode.scrollTop = 0;\r\n                }\r\n            }\r\n            if (lookAtScrollLeft) {\r\n                var deltaLeft = domNode.scrollLeft;\r\n                if (deltaLeft) {\r\n                    newScrollPosition.scrollLeft = _this._context.viewLayout.getCurrentScrollLeft() + deltaLeft;\r\n                    domNode.scrollLeft = 0;\r\n                }\r\n            }\r\n            _this._context.viewLayout.setScrollPositionNow(newScrollPosition);\r\n        };\r\n        // I've seen this happen both on the view dom node & on the lines content dom node.\r\n        _this._register(dom.addDisposableListener(viewDomNode.domNode, 'scroll', function (e) { return onBrowserDesperateReveal(viewDomNode.domNode, true, true); }));\r\n        _this._register(dom.addDisposableListener(linesContent.domNode, 'scroll', function (e) { return onBrowserDesperateReveal(linesContent.domNode, true, false); }));\r\n        _this._register(dom.addDisposableListener(overflowGuardDomNode.domNode, 'scroll', function (e) { return onBrowserDesperateReveal(overflowGuardDomNode.domNode, true, false); }));\r\n        _this._register(dom.addDisposableListener(_this.scrollbarDomNode.domNode, 'scroll', function (e) { return onBrowserDesperateReveal(_this.scrollbarDomNode.domNode, true, false); }));\r\n        return _this;\r\n    }\r\n    EditorScrollbar.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    EditorScrollbar.prototype._setLayout = function () {\r\n        var layoutInfo = this._context.configuration.editor.layoutInfo;\r\n        this.scrollbarDomNode.setLeft(layoutInfo.contentLeft);\r\n        var side = this._context.configuration.editor.viewInfo.minimap.side;\r\n        if (side === 'right') {\r\n            this.scrollbarDomNode.setWidth(layoutInfo.contentWidth + layoutInfo.minimapWidth);\r\n        }\r\n        else {\r\n            this.scrollbarDomNode.setWidth(layoutInfo.contentWidth);\r\n        }\r\n        this.scrollbarDomNode.setHeight(layoutInfo.contentHeight);\r\n    };\r\n    EditorScrollbar.prototype.getOverviewRulerLayoutInfo = function () {\r\n        return this.scrollbar.getOverviewRulerLayoutInfo();\r\n    };\r\n    EditorScrollbar.prototype.getDomNode = function () {\r\n        return this.scrollbarDomNode;\r\n    };\r\n    EditorScrollbar.prototype.delegateVerticalScrollbarMouseDown = function (browserEvent) {\r\n        this.scrollbar.delegateVerticalScrollbarMouseDown(browserEvent);\r\n    };\r\n    // --- begin event handlers\r\n    EditorScrollbar.prototype.onConfigurationChanged = function (e) {\r\n        if (e.viewInfo) {\r\n            var editor = this._context.configuration.editor;\r\n            var newOpts = {\r\n                handleMouseWheel: editor.viewInfo.scrollbar.handleMouseWheel,\r\n                mouseWheelScrollSensitivity: editor.viewInfo.scrollbar.mouseWheelScrollSensitivity\r\n            };\r\n            this.scrollbar.updateOptions(newOpts);\r\n        }\r\n        if (e.layoutInfo) {\r\n            this._setLayout();\r\n        }\r\n        return true;\r\n    };\r\n    EditorScrollbar.prototype.onScrollChanged = function (e) {\r\n        return true;\r\n    };\r\n    EditorScrollbar.prototype.onThemeChanged = function (e) {\r\n        this.scrollbar.updateClassName('editor-scrollable' + ' ' + getThemeTypeSelector(this._context.theme.type));\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    EditorScrollbar.prototype.prepareRender = function (ctx) {\r\n        // Nothing to do\r\n    };\r\n    EditorScrollbar.prototype.render = function (ctx) {\r\n        this.scrollbar.renderNow();\r\n    };\r\n    return EditorScrollbar;\r\n}(ViewPart));\r\nexport { EditorScrollbar };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './glyphMargin.css';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nvar DecorationToRender = /** @class */ (function () {\r\n    function DecorationToRender(startLineNumber, endLineNumber, className) {\r\n        this.startLineNumber = +startLineNumber;\r\n        this.endLineNumber = +endLineNumber;\r\n        this.className = String(className);\r\n    }\r\n    return DecorationToRender;\r\n}());\r\nexport { DecorationToRender };\r\nvar DedupOverlay = /** @class */ (function (_super) {\r\n    __extends(DedupOverlay, _super);\r\n    function DedupOverlay() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DedupOverlay.prototype._render = function (visibleStartLineNumber, visibleEndLineNumber, decorations) {\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            output[lineIndex] = [];\r\n        }\r\n        if (decorations.length === 0) {\r\n            return output;\r\n        }\r\n        decorations.sort(function (a, b) {\r\n            if (a.className === b.className) {\r\n                if (a.startLineNumber === b.startLineNumber) {\r\n                    return a.endLineNumber - b.endLineNumber;\r\n                }\r\n                return a.startLineNumber - b.startLineNumber;\r\n            }\r\n            return (a.className < b.className ? -1 : 1);\r\n        });\r\n        var prevClassName = null;\r\n        var prevEndLineIndex = 0;\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var d = decorations[i];\r\n            var className = d.className;\r\n            var startLineIndex = Math.max(d.startLineNumber, visibleStartLineNumber) - visibleStartLineNumber;\r\n            var endLineIndex = Math.min(d.endLineNumber, visibleEndLineNumber) - visibleStartLineNumber;\r\n            if (prevClassName === className) {\r\n                startLineIndex = Math.max(prevEndLineIndex + 1, startLineIndex);\r\n                prevEndLineIndex = Math.max(prevEndLineIndex, endLineIndex);\r\n            }\r\n            else {\r\n                prevClassName = className;\r\n                prevEndLineIndex = endLineIndex;\r\n            }\r\n            for (var i_1 = startLineIndex; i_1 <= prevEndLineIndex; i_1++) {\r\n                output[i_1].push(prevClassName);\r\n            }\r\n        }\r\n        return output;\r\n    };\r\n    return DedupOverlay;\r\n}(DynamicViewOverlay));\r\nexport { DedupOverlay };\r\nvar GlyphMarginOverlay = /** @class */ (function (_super) {\r\n    __extends(GlyphMarginOverlay, _super);\r\n    function GlyphMarginOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._lineHeight = _this._context.configuration.editor.lineHeight;\r\n        _this._glyphMargin = _this._context.configuration.editor.viewInfo.glyphMargin;\r\n        _this._glyphMarginLeft = _this._context.configuration.editor.layoutInfo.glyphMarginLeft;\r\n        _this._glyphMarginWidth = _this._context.configuration.editor.layoutInfo.glyphMarginWidth;\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    GlyphMarginOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    GlyphMarginOverlay.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._lineHeight = this._context.configuration.editor.lineHeight;\r\n        }\r\n        if (e.viewInfo) {\r\n            this._glyphMargin = this._context.configuration.editor.viewInfo.glyphMargin;\r\n        }\r\n        if (e.layoutInfo) {\r\n            this._glyphMarginLeft = this._context.configuration.editor.layoutInfo.glyphMarginLeft;\r\n            this._glyphMarginWidth = this._context.configuration.editor.layoutInfo.glyphMarginWidth;\r\n        }\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onDecorationsChanged = function (e) {\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged;\r\n    };\r\n    GlyphMarginOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    GlyphMarginOverlay.prototype._getDecorations = function (ctx) {\r\n        var decorations = ctx.getDecorationsInViewport();\r\n        var r = [], rLen = 0;\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var d = decorations[i];\r\n            var glyphMarginClassName = d.options.glyphMarginClassName;\r\n            if (glyphMarginClassName) {\r\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.endLineNumber, glyphMarginClassName);\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n    GlyphMarginOverlay.prototype.prepareRender = function (ctx) {\r\n        if (!this._glyphMargin) {\r\n            this._renderResult = null;\r\n            return;\r\n        }\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var toRender = this._render(visibleStartLineNumber, visibleEndLineNumber, this._getDecorations(ctx));\r\n        var lineHeight = this._lineHeight.toString();\r\n        var left = this._glyphMarginLeft.toString();\r\n        var width = this._glyphMarginWidth.toString();\r\n        var common = '\" style=\"left:' + left + 'px;width:' + width + 'px' + ';height:' + lineHeight + 'px;\"></div>';\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            var classNames = toRender[lineIndex];\r\n            if (classNames.length === 0) {\r\n                output[lineIndex] = '';\r\n            }\r\n            else {\r\n                output[lineIndex] = ('<div class=\"cgmr '\r\n                    + classNames.join(' ')\r\n                    + common);\r\n            }\r\n        }\r\n        this._renderResult = output;\r\n    };\r\n    GlyphMarginOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineIndex];\r\n    };\r\n    return GlyphMarginOverlay;\r\n}(DedupOverlay));\r\nexport { GlyphMarginOverlay };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './indentGuides.css';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { editorActiveIndentGuides, editorIndentGuides } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar IndentGuidesOverlay = /** @class */ (function (_super) {\r\n    __extends(IndentGuidesOverlay, _super);\r\n    function IndentGuidesOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._primaryLineNumber = 0;\r\n        _this._lineHeight = _this._context.configuration.editor.lineHeight;\r\n        _this._spaceWidth = _this._context.configuration.editor.fontInfo.spaceWidth;\r\n        _this._enabled = _this._context.configuration.editor.viewInfo.renderIndentGuides;\r\n        _this._activeIndentEnabled = _this._context.configuration.editor.viewInfo.highlightActiveIndentGuide;\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    IndentGuidesOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    IndentGuidesOverlay.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._lineHeight = this._context.configuration.editor.lineHeight;\r\n        }\r\n        if (e.fontInfo) {\r\n            this._spaceWidth = this._context.configuration.editor.fontInfo.spaceWidth;\r\n        }\r\n        if (e.viewInfo) {\r\n            this._enabled = this._context.configuration.editor.viewInfo.renderIndentGuides;\r\n            this._activeIndentEnabled = this._context.configuration.editor.viewInfo.highlightActiveIndentGuide;\r\n        }\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onCursorStateChanged = function (e) {\r\n        var selection = e.selections[0];\r\n        var newPrimaryLineNumber = selection.isEmpty() ? selection.positionLineNumber : 0;\r\n        if (this._primaryLineNumber !== newPrimaryLineNumber) {\r\n            this._primaryLineNumber = newPrimaryLineNumber;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    IndentGuidesOverlay.prototype.onDecorationsChanged = function (e) {\r\n        // true for inline decorations\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged; // || e.scrollWidthChanged;\r\n    };\r\n    IndentGuidesOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onLanguageConfigurationChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    IndentGuidesOverlay.prototype.prepareRender = function (ctx) {\r\n        if (!this._enabled) {\r\n            this._renderResult = null;\r\n            return;\r\n        }\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var tabSize = this._context.model.getTabSize();\r\n        var tabWidth = tabSize * this._spaceWidth;\r\n        var scrollWidth = ctx.scrollWidth;\r\n        var lineHeight = this._lineHeight;\r\n        var indentGuideWidth = tabWidth;\r\n        var indents = this._context.model.getLinesIndentGuides(visibleStartLineNumber, visibleEndLineNumber);\r\n        var activeIndentStartLineNumber = 0;\r\n        var activeIndentEndLineNumber = 0;\r\n        var activeIndentLevel = 0;\r\n        if (this._activeIndentEnabled && this._primaryLineNumber) {\r\n            var activeIndentInfo = this._context.model.getActiveIndentGuide(this._primaryLineNumber, visibleStartLineNumber, visibleEndLineNumber);\r\n            activeIndentStartLineNumber = activeIndentInfo.startLineNumber;\r\n            activeIndentEndLineNumber = activeIndentInfo.endLineNumber;\r\n            activeIndentLevel = activeIndentInfo.indent;\r\n        }\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var containsActiveIndentGuide = (activeIndentStartLineNumber <= lineNumber && lineNumber <= activeIndentEndLineNumber);\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            var indent = indents[lineIndex];\r\n            var result = '';\r\n            var leftMostVisiblePosition = ctx.visibleRangeForPosition(new Position(lineNumber, 1));\r\n            var left = leftMostVisiblePosition ? leftMostVisiblePosition.left : 0;\r\n            for (var i = 1; i <= indent; i++) {\r\n                var className = (containsActiveIndentGuide && i === activeIndentLevel ? 'cigra' : 'cigr');\r\n                result += \"<div class=\\\"\" + className + \"\\\" style=\\\"left:\" + left + \"px;height:\" + lineHeight + \"px;width:\" + indentGuideWidth + \"px\\\"></div>\";\r\n                left += tabWidth;\r\n                if (left > scrollWidth) {\r\n                    break;\r\n                }\r\n            }\r\n            output[lineIndex] = result;\r\n        }\r\n        this._renderResult = output;\r\n    };\r\n    IndentGuidesOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineIndex];\r\n    };\r\n    return IndentGuidesOverlay;\r\n}(DynamicViewOverlay));\r\nexport { IndentGuidesOverlay };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var editorIndentGuidesColor = theme.getColor(editorIndentGuides);\r\n    if (editorIndentGuidesColor) {\r\n        collector.addRule(\".monaco-editor .lines-content .cigr { box-shadow: 1px 0 0 0 \" + editorIndentGuidesColor + \" inset; }\");\r\n    }\r\n    var editorActiveIndentGuidesColor = theme.getColor(editorActiveIndentGuides) || editorIndentGuidesColor;\r\n    if (editorActiveIndentGuidesColor) {\r\n        collector.addRule(\".monaco-editor .lines-content .cigra { box-shadow: 1px 0 0 0 \" + editorActiveIndentGuidesColor + \" inset; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './viewLines.css';\r\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\r\nimport { Configuration } from '../../config/configuration.js';\r\nimport { VisibleLinesCollection } from '../../view/viewLayer.js';\r\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\r\nimport { DomReadingContext, ViewLine, ViewLineOptions } from './viewLine.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { LineVisibleRanges } from '../../../common/view/renderingContext.js';\r\nvar LastRenderedData = /** @class */ (function () {\r\n    function LastRenderedData() {\r\n        this._currentVisibleRange = new Range(1, 1, 1, 1);\r\n    }\r\n    LastRenderedData.prototype.getCurrentVisibleRange = function () {\r\n        return this._currentVisibleRange;\r\n    };\r\n    LastRenderedData.prototype.setCurrentVisibleRange = function (currentVisibleRange) {\r\n        this._currentVisibleRange = currentVisibleRange;\r\n    };\r\n    return LastRenderedData;\r\n}());\r\nvar HorizontalRevealRequest = /** @class */ (function () {\r\n    function HorizontalRevealRequest(lineNumber, startColumn, endColumn, startScrollTop, stopScrollTop, scrollType) {\r\n        this.lineNumber = lineNumber;\r\n        this.startColumn = startColumn;\r\n        this.endColumn = endColumn;\r\n        this.startScrollTop = startScrollTop;\r\n        this.stopScrollTop = stopScrollTop;\r\n        this.scrollType = scrollType;\r\n    }\r\n    return HorizontalRevealRequest;\r\n}());\r\nvar ViewLines = /** @class */ (function (_super) {\r\n    __extends(ViewLines, _super);\r\n    function ViewLines(context, linesContent) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._linesContent = linesContent;\r\n        _this._textRangeRestingSpot = document.createElement('div');\r\n        _this._visibleLines = new VisibleLinesCollection(_this);\r\n        _this.domNode = _this._visibleLines.domNode;\r\n        var conf = _this._context.configuration;\r\n        _this._lineHeight = conf.editor.lineHeight;\r\n        _this._typicalHalfwidthCharacterWidth = conf.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n        _this._isViewportWrapping = conf.editor.wrappingInfo.isViewportWrapping;\r\n        _this._revealHorizontalRightPadding = conf.editor.viewInfo.revealHorizontalRightPadding;\r\n        _this._canUseLayerHinting = conf.editor.canUseLayerHinting;\r\n        _this._viewLineOptions = new ViewLineOptions(conf, _this._context.theme.type);\r\n        PartFingerprints.write(_this.domNode, 7 /* ViewLines */);\r\n        _this.domNode.setClassName('view-lines');\r\n        Configuration.applyFontInfo(_this.domNode, conf.editor.fontInfo);\r\n        // --- width & height\r\n        _this._maxLineWidth = 0;\r\n        _this._asyncUpdateLineWidths = new RunOnceScheduler(function () {\r\n            _this._updateLineWidthsSlow();\r\n        }, 200);\r\n        _this._lastRenderedData = new LastRenderedData();\r\n        _this._horizontalRevealRequest = null;\r\n        return _this;\r\n    }\r\n    ViewLines.prototype.dispose = function () {\r\n        this._asyncUpdateLineWidths.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ViewLines.prototype.getDomNode = function () {\r\n        return this.domNode;\r\n    };\r\n    // ---- begin IVisibleLinesHost\r\n    ViewLines.prototype.createVisibleLine = function () {\r\n        return new ViewLine(this._viewLineOptions);\r\n    };\r\n    // ---- end IVisibleLinesHost\r\n    // ---- begin view event handlers\r\n    ViewLines.prototype.onConfigurationChanged = function (e) {\r\n        this._visibleLines.onConfigurationChanged(e);\r\n        if (e.wrappingInfo) {\r\n            this._maxLineWidth = 0;\r\n        }\r\n        var conf = this._context.configuration;\r\n        if (e.lineHeight) {\r\n            this._lineHeight = conf.editor.lineHeight;\r\n        }\r\n        if (e.fontInfo) {\r\n            this._typicalHalfwidthCharacterWidth = conf.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n        }\r\n        if (e.wrappingInfo) {\r\n            this._isViewportWrapping = conf.editor.wrappingInfo.isViewportWrapping;\r\n        }\r\n        if (e.viewInfo) {\r\n            this._revealHorizontalRightPadding = conf.editor.viewInfo.revealHorizontalRightPadding;\r\n        }\r\n        if (e.canUseLayerHinting) {\r\n            this._canUseLayerHinting = conf.editor.canUseLayerHinting;\r\n        }\r\n        if (e.fontInfo) {\r\n            Configuration.applyFontInfo(this.domNode, conf.editor.fontInfo);\r\n        }\r\n        this._onOptionsMaybeChanged();\r\n        if (e.layoutInfo) {\r\n            this._maxLineWidth = 0;\r\n        }\r\n        return true;\r\n    };\r\n    ViewLines.prototype._onOptionsMaybeChanged = function () {\r\n        var conf = this._context.configuration;\r\n        var newViewLineOptions = new ViewLineOptions(conf, this._context.theme.type);\r\n        if (!this._viewLineOptions.equals(newViewLineOptions)) {\r\n            this._viewLineOptions = newViewLineOptions;\r\n            var startLineNumber = this._visibleLines.getStartLineNumber();\r\n            var endLineNumber = this._visibleLines.getEndLineNumber();\r\n            for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n                var line = this._visibleLines.getVisibleLine(lineNumber);\r\n                line.onOptionsChanged(this._viewLineOptions);\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ViewLines.prototype.onCursorStateChanged = function (e) {\r\n        var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n        var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n        var r = false;\r\n        for (var lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\r\n            r = this._visibleLines.getVisibleLine(lineNumber).onSelectionChanged() || r;\r\n        }\r\n        return r;\r\n    };\r\n    ViewLines.prototype.onDecorationsChanged = function (e) {\r\n        if (true /*e.inlineDecorationsChanged*/) {\r\n            var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n            var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n            for (var lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\r\n                this._visibleLines.getVisibleLine(lineNumber).onDecorationsChanged();\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    ViewLines.prototype.onFlushed = function (e) {\r\n        var shouldRender = this._visibleLines.onFlushed(e);\r\n        this._maxLineWidth = 0;\r\n        return shouldRender;\r\n    };\r\n    ViewLines.prototype.onLinesChanged = function (e) {\r\n        return this._visibleLines.onLinesChanged(e);\r\n    };\r\n    ViewLines.prototype.onLinesDeleted = function (e) {\r\n        return this._visibleLines.onLinesDeleted(e);\r\n    };\r\n    ViewLines.prototype.onLinesInserted = function (e) {\r\n        return this._visibleLines.onLinesInserted(e);\r\n    };\r\n    ViewLines.prototype.onRevealRangeRequest = function (e) {\r\n        // Using the future viewport here in order to handle multiple\r\n        // incoming reveal range requests that might all desire to be animated\r\n        var desiredScrollTop = this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(), e.range, e.verticalType);\r\n        // validate the new desired scroll top\r\n        var newScrollPosition = this._context.viewLayout.validateScrollPosition({ scrollTop: desiredScrollTop });\r\n        if (e.revealHorizontal) {\r\n            if (e.range.startLineNumber !== e.range.endLineNumber) {\r\n                // Two or more lines? => scroll to base (That's how you see most of the two lines)\r\n                newScrollPosition = {\r\n                    scrollTop: newScrollPosition.scrollTop,\r\n                    scrollLeft: 0\r\n                };\r\n            }\r\n            else {\r\n                // We don't necessarily know the horizontal offset of this range since the line might not be in the view...\r\n                this._horizontalRevealRequest = new HorizontalRevealRequest(e.range.startLineNumber, e.range.startColumn, e.range.endColumn, this._context.viewLayout.getCurrentScrollTop(), newScrollPosition.scrollTop, e.scrollType);\r\n            }\r\n        }\r\n        else {\r\n            this._horizontalRevealRequest = null;\r\n        }\r\n        var scrollTopDelta = Math.abs(this._context.viewLayout.getCurrentScrollTop() - newScrollPosition.scrollTop);\r\n        if (e.scrollType === 0 /* Smooth */ && scrollTopDelta > this._lineHeight) {\r\n            this._context.viewLayout.setScrollPositionSmooth(newScrollPosition);\r\n        }\r\n        else {\r\n            this._context.viewLayout.setScrollPositionNow(newScrollPosition);\r\n        }\r\n        return true;\r\n    };\r\n    ViewLines.prototype.onScrollChanged = function (e) {\r\n        if (this._horizontalRevealRequest && e.scrollLeftChanged) {\r\n            // cancel any outstanding horizontal reveal request if someone else scrolls horizontally.\r\n            this._horizontalRevealRequest = null;\r\n        }\r\n        if (this._horizontalRevealRequest && e.scrollTopChanged) {\r\n            var min = Math.min(this._horizontalRevealRequest.startScrollTop, this._horizontalRevealRequest.stopScrollTop);\r\n            var max = Math.max(this._horizontalRevealRequest.startScrollTop, this._horizontalRevealRequest.stopScrollTop);\r\n            if (e.scrollTop < min || e.scrollTop > max) {\r\n                // cancel any outstanding horizontal reveal request if someone else scrolls vertically.\r\n                this._horizontalRevealRequest = null;\r\n            }\r\n        }\r\n        this.domNode.setWidth(e.scrollWidth);\r\n        return this._visibleLines.onScrollChanged(e) || true;\r\n    };\r\n    ViewLines.prototype.onTokensChanged = function (e) {\r\n        return this._visibleLines.onTokensChanged(e);\r\n    };\r\n    ViewLines.prototype.onZonesChanged = function (e) {\r\n        this._context.viewLayout.onMaxLineWidthChanged(this._maxLineWidth);\r\n        return this._visibleLines.onZonesChanged(e);\r\n    };\r\n    ViewLines.prototype.onThemeChanged = function (e) {\r\n        return this._onOptionsMaybeChanged();\r\n    };\r\n    // ---- end view event handlers\r\n    // ----------- HELPERS FOR OTHERS\r\n    ViewLines.prototype.getPositionFromDOMInfo = function (spanNode, offset) {\r\n        var viewLineDomNode = this._getViewLineDomNode(spanNode);\r\n        if (viewLineDomNode === null) {\r\n            // Couldn't find view line node\r\n            return null;\r\n        }\r\n        var lineNumber = this._getLineNumberFor(viewLineDomNode);\r\n        if (lineNumber === -1) {\r\n            // Couldn't find view line node\r\n            return null;\r\n        }\r\n        if (lineNumber < 1 || lineNumber > this._context.model.getLineCount()) {\r\n            // lineNumber is outside range\r\n            return null;\r\n        }\r\n        if (this._context.model.getLineMaxColumn(lineNumber) === 1) {\r\n            // Line is empty\r\n            return new Position(lineNumber, 1);\r\n        }\r\n        var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n        var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n        if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\r\n            // Couldn't find line\r\n            return null;\r\n        }\r\n        var column = this._visibleLines.getVisibleLine(lineNumber).getColumnOfNodeOffset(lineNumber, spanNode, offset);\r\n        var minColumn = this._context.model.getLineMinColumn(lineNumber);\r\n        if (column < minColumn) {\r\n            column = minColumn;\r\n        }\r\n        return new Position(lineNumber, column);\r\n    };\r\n    ViewLines.prototype._getViewLineDomNode = function (node) {\r\n        while (node && node.nodeType === 1) {\r\n            if (node.className === ViewLine.CLASS_NAME) {\r\n                return node;\r\n            }\r\n            node = node.parentElement;\r\n        }\r\n        return null;\r\n    };\r\n    /**\r\n     * @returns the line number of this view line dom node.\r\n     */\r\n    ViewLines.prototype._getLineNumberFor = function (domNode) {\r\n        var startLineNumber = this._visibleLines.getStartLineNumber();\r\n        var endLineNumber = this._visibleLines.getEndLineNumber();\r\n        for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n            var line = this._visibleLines.getVisibleLine(lineNumber);\r\n            if (domNode === line.getDomNode()) {\r\n                return lineNumber;\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n    ViewLines.prototype.getLineWidth = function (lineNumber) {\r\n        var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n        var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n        if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\r\n            // Couldn't find line\r\n            return -1;\r\n        }\r\n        return this._visibleLines.getVisibleLine(lineNumber).getWidth();\r\n    };\r\n    ViewLines.prototype.linesVisibleRangesForRange = function (_range, includeNewLines) {\r\n        if (this.shouldRender()) {\r\n            // Cannot read from the DOM because it is dirty\r\n            // i.e. the model & the dom are out of sync, so I'd be reading something stale\r\n            return null;\r\n        }\r\n        var originalEndLineNumber = _range.endLineNumber;\r\n        var range = Range.intersectRanges(_range, this._lastRenderedData.getCurrentVisibleRange());\r\n        if (!range) {\r\n            return null;\r\n        }\r\n        var visibleRanges = [], visibleRangesLen = 0;\r\n        var domReadingContext = new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot);\r\n        var nextLineModelLineNumber = 0;\r\n        if (includeNewLines) {\r\n            nextLineModelLineNumber = this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new Position(range.startLineNumber, 1)).lineNumber;\r\n        }\r\n        var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n        var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n        for (var lineNumber = range.startLineNumber; lineNumber <= range.endLineNumber; lineNumber++) {\r\n            if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\r\n                continue;\r\n            }\r\n            var startColumn = lineNumber === range.startLineNumber ? range.startColumn : 1;\r\n            var endColumn = lineNumber === range.endLineNumber ? range.endColumn : this._context.model.getLineMaxColumn(lineNumber);\r\n            var visibleRangesForLine = this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(startColumn, endColumn, domReadingContext);\r\n            if (!visibleRangesForLine || visibleRangesForLine.length === 0) {\r\n                continue;\r\n            }\r\n            if (includeNewLines && lineNumber < originalEndLineNumber) {\r\n                var currentLineModelLineNumber = nextLineModelLineNumber;\r\n                nextLineModelLineNumber = this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new Position(lineNumber + 1, 1)).lineNumber;\r\n                if (currentLineModelLineNumber !== nextLineModelLineNumber) {\r\n                    visibleRangesForLine[visibleRangesForLine.length - 1].width += this._typicalHalfwidthCharacterWidth;\r\n                }\r\n            }\r\n            visibleRanges[visibleRangesLen++] = new LineVisibleRanges(lineNumber, visibleRangesForLine);\r\n        }\r\n        if (visibleRangesLen === 0) {\r\n            return null;\r\n        }\r\n        return visibleRanges;\r\n    };\r\n    ViewLines.prototype.visibleRangesForRange2 = function (_range) {\r\n        if (this.shouldRender()) {\r\n            // Cannot read from the DOM because it is dirty\r\n            // i.e. the model & the dom are out of sync, so I'd be reading something stale\r\n            return null;\r\n        }\r\n        var range = Range.intersectRanges(_range, this._lastRenderedData.getCurrentVisibleRange());\r\n        if (!range) {\r\n            return null;\r\n        }\r\n        var result = [];\r\n        var domReadingContext = new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot);\r\n        var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n        var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n        for (var lineNumber = range.startLineNumber; lineNumber <= range.endLineNumber; lineNumber++) {\r\n            if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\r\n                continue;\r\n            }\r\n            var startColumn = lineNumber === range.startLineNumber ? range.startColumn : 1;\r\n            var endColumn = lineNumber === range.endLineNumber ? range.endColumn : this._context.model.getLineMaxColumn(lineNumber);\r\n            var visibleRangesForLine = this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(startColumn, endColumn, domReadingContext);\r\n            if (!visibleRangesForLine || visibleRangesForLine.length === 0) {\r\n                continue;\r\n            }\r\n            result = result.concat(visibleRangesForLine);\r\n        }\r\n        if (result.length === 0) {\r\n            return null;\r\n        }\r\n        return result;\r\n    };\r\n    ViewLines.prototype.visibleRangeForPosition = function (position) {\r\n        var visibleRanges = this.visibleRangesForRange2(new Range(position.lineNumber, position.column, position.lineNumber, position.column));\r\n        if (!visibleRanges) {\r\n            return null;\r\n        }\r\n        return visibleRanges[0];\r\n    };\r\n    // --- implementation\r\n    ViewLines.prototype.updateLineWidths = function () {\r\n        this._updateLineWidths(false);\r\n    };\r\n    /**\r\n     * Updates the max line width if it is fast to compute.\r\n     * Returns true if all lines were taken into account.\r\n     * Returns false if some lines need to be reevaluated (in a slow fashion).\r\n     */\r\n    ViewLines.prototype._updateLineWidthsFast = function () {\r\n        return this._updateLineWidths(true);\r\n    };\r\n    ViewLines.prototype._updateLineWidthsSlow = function () {\r\n        this._updateLineWidths(false);\r\n    };\r\n    ViewLines.prototype._updateLineWidths = function (fast) {\r\n        var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n        var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n        var localMaxLineWidth = 1;\r\n        var allWidthsComputed = true;\r\n        for (var lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\r\n            var visibleLine = this._visibleLines.getVisibleLine(lineNumber);\r\n            if (fast && !visibleLine.getWidthIsFast()) {\r\n                // Cannot compute width in a fast way for this line\r\n                allWidthsComputed = false;\r\n                continue;\r\n            }\r\n            localMaxLineWidth = Math.max(localMaxLineWidth, visibleLine.getWidth());\r\n        }\r\n        if (allWidthsComputed && rendStartLineNumber === 1 && rendEndLineNumber === this._context.model.getLineCount()) {\r\n            // we know the max line width for all the lines\r\n            this._maxLineWidth = 0;\r\n        }\r\n        this._ensureMaxLineWidth(localMaxLineWidth);\r\n        return allWidthsComputed;\r\n    };\r\n    ViewLines.prototype.prepareRender = function () {\r\n        throw new Error('Not supported');\r\n    };\r\n    ViewLines.prototype.render = function () {\r\n        throw new Error('Not supported');\r\n    };\r\n    ViewLines.prototype.renderText = function (viewportData) {\r\n        // (1) render lines - ensures lines are in the DOM\r\n        this._visibleLines.renderLines(viewportData);\r\n        this._lastRenderedData.setCurrentVisibleRange(viewportData.visibleRange);\r\n        this.domNode.setWidth(this._context.viewLayout.getScrollWidth());\r\n        this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(), 1000000));\r\n        // (2) compute horizontal scroll position:\r\n        //  - this must happen after the lines are in the DOM since it might need a line that rendered just now\r\n        //  - it might change `scrollWidth` and `scrollLeft`\r\n        if (this._horizontalRevealRequest) {\r\n            var revealLineNumber = this._horizontalRevealRequest.lineNumber;\r\n            var revealStartColumn = this._horizontalRevealRequest.startColumn;\r\n            var revealEndColumn = this._horizontalRevealRequest.endColumn;\r\n            var scrollType = this._horizontalRevealRequest.scrollType;\r\n            // Check that we have the line that contains the horizontal range in the viewport\r\n            if (viewportData.startLineNumber <= revealLineNumber && revealLineNumber <= viewportData.endLineNumber) {\r\n                this._horizontalRevealRequest = null;\r\n                // allow `visibleRangesForRange2` to work\r\n                this.onDidRender();\r\n                // compute new scroll position\r\n                var newScrollLeft = this._computeScrollLeftToRevealRange(revealLineNumber, revealStartColumn, revealEndColumn);\r\n                var isViewportWrapping = this._isViewportWrapping;\r\n                if (!isViewportWrapping) {\r\n                    // ensure `scrollWidth` is large enough\r\n                    this._ensureMaxLineWidth(newScrollLeft.maxHorizontalOffset);\r\n                }\r\n                // set `scrollLeft`\r\n                if (scrollType === 0 /* Smooth */) {\r\n                    this._context.viewLayout.setScrollPositionSmooth({\r\n                        scrollLeft: newScrollLeft.scrollLeft\r\n                    });\r\n                }\r\n                else {\r\n                    this._context.viewLayout.setScrollPositionNow({\r\n                        scrollLeft: newScrollLeft.scrollLeft\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        // Update max line width (not so important, it is just so the horizontal scrollbar doesn't get too small)\r\n        if (!this._updateLineWidthsFast()) {\r\n            // Computing the width of some lines would be slow => delay it\r\n            this._asyncUpdateLineWidths.schedule();\r\n        }\r\n        // (3) handle scrolling\r\n        this._linesContent.setLayerHinting(this._canUseLayerHinting);\r\n        var adjustedScrollTop = this._context.viewLayout.getCurrentScrollTop() - viewportData.bigNumbersDelta;\r\n        this._linesContent.setTop(-adjustedScrollTop);\r\n        this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft());\r\n    };\r\n    // --- width\r\n    ViewLines.prototype._ensureMaxLineWidth = function (lineWidth) {\r\n        var iLineWidth = Math.ceil(lineWidth);\r\n        if (this._maxLineWidth < iLineWidth) {\r\n            this._maxLineWidth = iLineWidth;\r\n            this._context.viewLayout.onMaxLineWidthChanged(this._maxLineWidth);\r\n        }\r\n    };\r\n    ViewLines.prototype._computeScrollTopToRevealRange = function (viewport, range, verticalType) {\r\n        var viewportStartY = viewport.top;\r\n        var viewportHeight = viewport.height;\r\n        var viewportEndY = viewportStartY + viewportHeight;\r\n        var boxStartY;\r\n        var boxEndY;\r\n        // Have a box that includes one extra line height (for the horizontal scrollbar)\r\n        boxStartY = this._context.viewLayout.getVerticalOffsetForLineNumber(range.startLineNumber);\r\n        boxEndY = this._context.viewLayout.getVerticalOffsetForLineNumber(range.endLineNumber) + this._lineHeight;\r\n        if (verticalType === 0 /* Simple */ || verticalType === 4 /* Bottom */) {\r\n            // Reveal one line more when the last line would be covered by the scrollbar - arrow down case or revealing a line explicitly at bottom\r\n            boxEndY += this._lineHeight;\r\n        }\r\n        var newScrollTop;\r\n        if (verticalType === 1 /* Center */ || verticalType === 2 /* CenterIfOutsideViewport */) {\r\n            if (verticalType === 2 /* CenterIfOutsideViewport */ && viewportStartY <= boxStartY && boxEndY <= viewportEndY) {\r\n                // Box is already in the viewport... do nothing\r\n                newScrollTop = viewportStartY;\r\n            }\r\n            else {\r\n                // Box is outside the viewport... center it\r\n                var boxMiddleY = (boxStartY + boxEndY) / 2;\r\n                newScrollTop = Math.max(0, boxMiddleY - viewportHeight / 2);\r\n            }\r\n        }\r\n        else {\r\n            newScrollTop = this._computeMinimumScrolling(viewportStartY, viewportEndY, boxStartY, boxEndY, verticalType === 3 /* Top */, verticalType === 4 /* Bottom */);\r\n        }\r\n        return newScrollTop;\r\n    };\r\n    ViewLines.prototype._computeScrollLeftToRevealRange = function (lineNumber, startColumn, endColumn) {\r\n        var maxHorizontalOffset = 0;\r\n        var viewport = this._context.viewLayout.getCurrentViewport();\r\n        var viewportStartX = viewport.left;\r\n        var viewportEndX = viewportStartX + viewport.width;\r\n        var visibleRanges = this.visibleRangesForRange2(new Range(lineNumber, startColumn, lineNumber, endColumn));\r\n        var boxStartX = Number.MAX_VALUE;\r\n        var boxEndX = 0;\r\n        if (!visibleRanges) {\r\n            // Unknown\r\n            return {\r\n                scrollLeft: viewportStartX,\r\n                maxHorizontalOffset: maxHorizontalOffset\r\n            };\r\n        }\r\n        for (var i = 0; i < visibleRanges.length; i++) {\r\n            var visibleRange = visibleRanges[i];\r\n            if (visibleRange.left < boxStartX) {\r\n                boxStartX = visibleRange.left;\r\n            }\r\n            if (visibleRange.left + visibleRange.width > boxEndX) {\r\n                boxEndX = visibleRange.left + visibleRange.width;\r\n            }\r\n        }\r\n        maxHorizontalOffset = boxEndX;\r\n        boxStartX = Math.max(0, boxStartX - ViewLines.HORIZONTAL_EXTRA_PX);\r\n        boxEndX += this._revealHorizontalRightPadding;\r\n        var newScrollLeft = this._computeMinimumScrolling(viewportStartX, viewportEndX, boxStartX, boxEndX);\r\n        return {\r\n            scrollLeft: newScrollLeft,\r\n            maxHorizontalOffset: maxHorizontalOffset\r\n        };\r\n    };\r\n    ViewLines.prototype._computeMinimumScrolling = function (viewportStart, viewportEnd, boxStart, boxEnd, revealAtStart, revealAtEnd) {\r\n        viewportStart = viewportStart | 0;\r\n        viewportEnd = viewportEnd | 0;\r\n        boxStart = boxStart | 0;\r\n        boxEnd = boxEnd | 0;\r\n        revealAtStart = !!revealAtStart;\r\n        revealAtEnd = !!revealAtEnd;\r\n        var viewportLength = viewportEnd - viewportStart;\r\n        var boxLength = boxEnd - boxStart;\r\n        if (boxLength < viewportLength) {\r\n            // The box would fit in the viewport\r\n            if (revealAtStart) {\r\n                return boxStart;\r\n            }\r\n            if (revealAtEnd) {\r\n                return Math.max(0, boxEnd - viewportLength);\r\n            }\r\n            if (boxStart < viewportStart) {\r\n                // The box is above the viewport\r\n                return boxStart;\r\n            }\r\n            else if (boxEnd > viewportEnd) {\r\n                // The box is below the viewport\r\n                return Math.max(0, boxEnd - viewportLength);\r\n            }\r\n        }\r\n        else {\r\n            // The box would not fit in the viewport\r\n            // Reveal the beginning of the box\r\n            return boxStart;\r\n        }\r\n        return viewportStart;\r\n    };\r\n    /**\r\n     * Adds this amount of pixels to the right of lines (no-one wants to type near the edge of the viewport)\r\n     */\r\n    ViewLines.HORIZONTAL_EXTRA_PX = 30;\r\n    return ViewLines;\r\n}(ViewPart));\r\nexport { ViewLines };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './linesDecorations.css';\r\nimport { DecorationToRender, DedupOverlay } from '../glyphMargin/glyphMargin.js';\r\nvar LinesDecorationsOverlay = /** @class */ (function (_super) {\r\n    __extends(LinesDecorationsOverlay, _super);\r\n    function LinesDecorationsOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._decorationsLeft = _this._context.configuration.editor.layoutInfo.decorationsLeft;\r\n        _this._decorationsWidth = _this._context.configuration.editor.layoutInfo.decorationsWidth;\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    LinesDecorationsOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    LinesDecorationsOverlay.prototype.onConfigurationChanged = function (e) {\r\n        if (e.layoutInfo) {\r\n            this._decorationsLeft = this._context.configuration.editor.layoutInfo.decorationsLeft;\r\n            this._decorationsWidth = this._context.configuration.editor.layoutInfo.decorationsWidth;\r\n        }\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onDecorationsChanged = function (e) {\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    LinesDecorationsOverlay.prototype._getDecorations = function (ctx) {\r\n        var decorations = ctx.getDecorationsInViewport();\r\n        var r = [], rLen = 0;\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var d = decorations[i];\r\n            var linesDecorationsClassName = d.options.linesDecorationsClassName;\r\n            if (linesDecorationsClassName) {\r\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.endLineNumber, linesDecorationsClassName);\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n    LinesDecorationsOverlay.prototype.prepareRender = function (ctx) {\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var toRender = this._render(visibleStartLineNumber, visibleEndLineNumber, this._getDecorations(ctx));\r\n        var left = this._decorationsLeft.toString();\r\n        var width = this._decorationsWidth.toString();\r\n        var common = '\" style=\"left:' + left + 'px;width:' + width + 'px;\"></div>';\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            var classNames = toRender[lineIndex];\r\n            var lineOutput = '';\r\n            for (var i = 0, len = classNames.length; i < len; i++) {\r\n                lineOutput += '<div class=\"cldr ' + classNames[i] + common;\r\n            }\r\n            output[lineIndex] = lineOutput;\r\n        }\r\n        this._renderResult = output;\r\n    };\r\n    LinesDecorationsOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineNumber - startLineNumber];\r\n    };\r\n    return LinesDecorationsOverlay;\r\n}(DedupOverlay));\r\nexport { LinesDecorationsOverlay };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './marginDecorations.css';\r\nimport { DecorationToRender, DedupOverlay } from '../glyphMargin/glyphMargin.js';\r\nvar MarginViewLineDecorationsOverlay = /** @class */ (function (_super) {\r\n    __extends(MarginViewLineDecorationsOverlay, _super);\r\n    function MarginViewLineDecorationsOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    MarginViewLineDecorationsOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    MarginViewLineDecorationsOverlay.prototype.onConfigurationChanged = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onDecorationsChanged = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    MarginViewLineDecorationsOverlay.prototype._getDecorations = function (ctx) {\r\n        var decorations = ctx.getDecorationsInViewport();\r\n        var r = [], rLen = 0;\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var d = decorations[i];\r\n            var marginClassName = d.options.marginClassName;\r\n            if (marginClassName) {\r\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.endLineNumber, marginClassName);\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.prepareRender = function (ctx) {\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var toRender = this._render(visibleStartLineNumber, visibleEndLineNumber, this._getDecorations(ctx));\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            var classNames = toRender[lineIndex];\r\n            var lineOutput = '';\r\n            for (var i = 0, len = classNames.length; i < len; i++) {\r\n                lineOutput += '<div class=\"cmdr ' + classNames[i] + '\" style=\"\"></div>';\r\n            }\r\n            output[lineIndex] = lineOutput;\r\n        }\r\n        this._renderResult = output;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineNumber - startLineNumber];\r\n    };\r\n    return MarginViewLineDecorationsOverlay;\r\n}(DedupOverlay));\r\nexport { MarginViewLineDecorationsOverlay };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/**\r\n * A very VM friendly rgba datastructure.\r\n * Please don't touch unless you take a look at the IR.\r\n */\r\nvar RGBA8 = /** @class */ (function () {\r\n    function RGBA8(r, g, b, a) {\r\n        this.r = RGBA8._clamp(r);\r\n        this.g = RGBA8._clamp(g);\r\n        this.b = RGBA8._clamp(b);\r\n        this.a = RGBA8._clamp(a);\r\n    }\r\n    RGBA8._clamp = function (c) {\r\n        if (c < 0) {\r\n            return 0;\r\n        }\r\n        if (c > 255) {\r\n            return 255;\r\n        }\r\n        return c | 0;\r\n    };\r\n    RGBA8.Empty = new RGBA8(0, 0, 0, 0);\r\n    return RGBA8;\r\n}());\r\nexport { RGBA8 };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { RGBA8 } from '../core/rgba.js';\r\nimport { TokenizationRegistry } from '../modes.js';\r\nvar MinimapTokensColorTracker = /** @class */ (function () {\r\n    function MinimapTokensColorTracker() {\r\n        var _this = this;\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._updateColorMap();\r\n        TokenizationRegistry.onDidChange(function (e) {\r\n            if (e.changedColorMap) {\r\n                _this._updateColorMap();\r\n            }\r\n        });\r\n    }\r\n    MinimapTokensColorTracker.getInstance = function () {\r\n        if (!this._INSTANCE) {\r\n            this._INSTANCE = new MinimapTokensColorTracker();\r\n        }\r\n        return this._INSTANCE;\r\n    };\r\n    MinimapTokensColorTracker.prototype._updateColorMap = function () {\r\n        var colorMap = TokenizationRegistry.getColorMap();\r\n        if (!colorMap) {\r\n            this._colors = [RGBA8.Empty];\r\n            this._backgroundIsLight = true;\r\n            return;\r\n        }\r\n        this._colors = [RGBA8.Empty];\r\n        for (var colorId = 1; colorId < colorMap.length; colorId++) {\r\n            var source = colorMap[colorId].rgba;\r\n            // Use a VM friendly data-type\r\n            this._colors[colorId] = new RGBA8(source.r, source.g, source.b, Math.round(source.a * 255));\r\n        }\r\n        var backgroundLuminosity = colorMap[2 /* DefaultBackground */].getRelativeLuminance();\r\n        this._backgroundIsLight = (backgroundLuminosity >= 0.5);\r\n        this._onDidChange.fire(void 0);\r\n    };\r\n    MinimapTokensColorTracker.prototype.getColor = function (colorId) {\r\n        if (colorId < 1 || colorId >= this._colors.length) {\r\n            // background color (basically invisible)\r\n            colorId = 2 /* DefaultBackground */;\r\n        }\r\n        return this._colors[colorId];\r\n    };\r\n    MinimapTokensColorTracker.prototype.backgroundIsLight = function () {\r\n        return this._backgroundIsLight;\r\n    };\r\n    MinimapTokensColorTracker._INSTANCE = null;\r\n    return MinimapTokensColorTracker;\r\n}());\r\nexport { MinimapTokensColorTracker };\r\nvar MinimapCharRenderer = /** @class */ (function () {\r\n    function MinimapCharRenderer(x2CharData, x1CharData) {\r\n        var x2ExpectedLen = 4 /* x2_CHAR_HEIGHT */ * 2 /* x2_CHAR_WIDTH */ * 95 /* CHAR_COUNT */;\r\n        if (x2CharData.length !== x2ExpectedLen) {\r\n            throw new Error('Invalid x2CharData');\r\n        }\r\n        var x1ExpectedLen = 2 /* x1_CHAR_HEIGHT */ * 1 /* x1_CHAR_WIDTH */ * 95 /* CHAR_COUNT */;\r\n        if (x1CharData.length !== x1ExpectedLen) {\r\n            throw new Error('Invalid x1CharData');\r\n        }\r\n        this.x2charData = x2CharData;\r\n        this.x1charData = x1CharData;\r\n        this.x2charDataLight = MinimapCharRenderer.soften(x2CharData, 12 / 15);\r\n        this.x1charDataLight = MinimapCharRenderer.soften(x1CharData, 50 / 60);\r\n    }\r\n    MinimapCharRenderer.soften = function (input, ratio) {\r\n        var result = new Uint8ClampedArray(input.length);\r\n        for (var i = 0, len = input.length; i < len; i++) {\r\n            result[i] = input[i] * ratio;\r\n        }\r\n        return result;\r\n    };\r\n    MinimapCharRenderer._getChIndex = function (chCode) {\r\n        chCode -= 32 /* START_CH_CODE */;\r\n        if (chCode < 0) {\r\n            chCode += 95 /* CHAR_COUNT */;\r\n        }\r\n        return (chCode % 95 /* CHAR_COUNT */);\r\n    };\r\n    MinimapCharRenderer.prototype.x2RenderChar = function (target, dx, dy, chCode, color, backgroundColor, useLighterFont) {\r\n        if (dx + 2 /* x2_CHAR_WIDTH */ > target.width || dy + 4 /* x2_CHAR_HEIGHT */ > target.height) {\r\n            console.warn('bad render request outside image data');\r\n            return;\r\n        }\r\n        var x2CharData = useLighterFont ? this.x2charDataLight : this.x2charData;\r\n        var chIndex = MinimapCharRenderer._getChIndex(chCode);\r\n        var outWidth = target.width * 4 /* RGBA_CHANNELS_CNT */;\r\n        var backgroundR = backgroundColor.r;\r\n        var backgroundG = backgroundColor.g;\r\n        var backgroundB = backgroundColor.b;\r\n        var deltaR = color.r - backgroundR;\r\n        var deltaG = color.g - backgroundG;\r\n        var deltaB = color.b - backgroundB;\r\n        var dest = target.data;\r\n        var sourceOffset = chIndex * 4 /* x2_CHAR_HEIGHT */ * 2 /* x2_CHAR_WIDTH */;\r\n        var destOffset = dy * outWidth + dx * 4 /* RGBA_CHANNELS_CNT */;\r\n        {\r\n            var c = x2CharData[sourceOffset] / 255;\r\n            dest[destOffset + 0] = backgroundR + deltaR * c;\r\n            dest[destOffset + 1] = backgroundG + deltaG * c;\r\n            dest[destOffset + 2] = backgroundB + deltaB * c;\r\n        }\r\n        {\r\n            var c = x2CharData[sourceOffset + 1] / 255;\r\n            dest[destOffset + 4] = backgroundR + deltaR * c;\r\n            dest[destOffset + 5] = backgroundG + deltaG * c;\r\n            dest[destOffset + 6] = backgroundB + deltaB * c;\r\n        }\r\n        destOffset += outWidth;\r\n        {\r\n            var c = x2CharData[sourceOffset + 2] / 255;\r\n            dest[destOffset + 0] = backgroundR + deltaR * c;\r\n            dest[destOffset + 1] = backgroundG + deltaG * c;\r\n            dest[destOffset + 2] = backgroundB + deltaB * c;\r\n        }\r\n        {\r\n            var c = x2CharData[sourceOffset + 3] / 255;\r\n            dest[destOffset + 4] = backgroundR + deltaR * c;\r\n            dest[destOffset + 5] = backgroundG + deltaG * c;\r\n            dest[destOffset + 6] = backgroundB + deltaB * c;\r\n        }\r\n        destOffset += outWidth;\r\n        {\r\n            var c = x2CharData[sourceOffset + 4] / 255;\r\n            dest[destOffset + 0] = backgroundR + deltaR * c;\r\n            dest[destOffset + 1] = backgroundG + deltaG * c;\r\n            dest[destOffset + 2] = backgroundB + deltaB * c;\r\n        }\r\n        {\r\n            var c = x2CharData[sourceOffset + 5] / 255;\r\n            dest[destOffset + 4] = backgroundR + deltaR * c;\r\n            dest[destOffset + 5] = backgroundG + deltaG * c;\r\n            dest[destOffset + 6] = backgroundB + deltaB * c;\r\n        }\r\n        destOffset += outWidth;\r\n        {\r\n            var c = x2CharData[sourceOffset + 6] / 255;\r\n            dest[destOffset + 0] = backgroundR + deltaR * c;\r\n            dest[destOffset + 1] = backgroundG + deltaG * c;\r\n            dest[destOffset + 2] = backgroundB + deltaB * c;\r\n        }\r\n        {\r\n            var c = x2CharData[sourceOffset + 7] / 255;\r\n            dest[destOffset + 4] = backgroundR + deltaR * c;\r\n            dest[destOffset + 5] = backgroundG + deltaG * c;\r\n            dest[destOffset + 6] = backgroundB + deltaB * c;\r\n        }\r\n    };\r\n    MinimapCharRenderer.prototype.x1RenderChar = function (target, dx, dy, chCode, color, backgroundColor, useLighterFont) {\r\n        if (dx + 1 /* x1_CHAR_WIDTH */ > target.width || dy + 2 /* x1_CHAR_HEIGHT */ > target.height) {\r\n            console.warn('bad render request outside image data');\r\n            return;\r\n        }\r\n        var x1CharData = useLighterFont ? this.x1charDataLight : this.x1charData;\r\n        var chIndex = MinimapCharRenderer._getChIndex(chCode);\r\n        var outWidth = target.width * 4 /* RGBA_CHANNELS_CNT */;\r\n        var backgroundR = backgroundColor.r;\r\n        var backgroundG = backgroundColor.g;\r\n        var backgroundB = backgroundColor.b;\r\n        var deltaR = color.r - backgroundR;\r\n        var deltaG = color.g - backgroundG;\r\n        var deltaB = color.b - backgroundB;\r\n        var dest = target.data;\r\n        var sourceOffset = chIndex * 2 /* x1_CHAR_HEIGHT */ * 1 /* x1_CHAR_WIDTH */;\r\n        var destOffset = dy * outWidth + dx * 4 /* RGBA_CHANNELS_CNT */;\r\n        {\r\n            var c = x1CharData[sourceOffset] / 255;\r\n            dest[destOffset + 0] = backgroundR + deltaR * c;\r\n            dest[destOffset + 1] = backgroundG + deltaG * c;\r\n            dest[destOffset + 2] = backgroundB + deltaB * c;\r\n        }\r\n        destOffset += outWidth;\r\n        {\r\n            var c = x1CharData[sourceOffset + 1] / 255;\r\n            dest[destOffset + 0] = backgroundR + deltaR * c;\r\n            dest[destOffset + 1] = backgroundG + deltaG * c;\r\n            dest[destOffset + 2] = backgroundB + deltaB * c;\r\n        }\r\n    };\r\n    MinimapCharRenderer.prototype.x2BlockRenderChar = function (target, dx, dy, color, backgroundColor, useLighterFont) {\r\n        if (dx + 2 /* x2_CHAR_WIDTH */ > target.width || dy + 4 /* x2_CHAR_HEIGHT */ > target.height) {\r\n            console.warn('bad render request outside image data');\r\n            return;\r\n        }\r\n        var outWidth = target.width * 4 /* RGBA_CHANNELS_CNT */;\r\n        var c = 0.5;\r\n        var backgroundR = backgroundColor.r;\r\n        var backgroundG = backgroundColor.g;\r\n        var backgroundB = backgroundColor.b;\r\n        var deltaR = color.r - backgroundR;\r\n        var deltaG = color.g - backgroundG;\r\n        var deltaB = color.b - backgroundB;\r\n        var colorR = backgroundR + deltaR * c;\r\n        var colorG = backgroundG + deltaG * c;\r\n        var colorB = backgroundB + deltaB * c;\r\n        var dest = target.data;\r\n        var destOffset = dy * outWidth + dx * 4 /* RGBA_CHANNELS_CNT */;\r\n        {\r\n            dest[destOffset + 0] = colorR;\r\n            dest[destOffset + 1] = colorG;\r\n            dest[destOffset + 2] = colorB;\r\n        }\r\n        {\r\n            dest[destOffset + 4] = colorR;\r\n            dest[destOffset + 5] = colorG;\r\n            dest[destOffset + 6] = colorB;\r\n        }\r\n        destOffset += outWidth;\r\n        {\r\n            dest[destOffset + 0] = colorR;\r\n            dest[destOffset + 1] = colorG;\r\n            dest[destOffset + 2] = colorB;\r\n        }\r\n        {\r\n            dest[destOffset + 4] = colorR;\r\n            dest[destOffset + 5] = colorG;\r\n            dest[destOffset + 6] = colorB;\r\n        }\r\n        destOffset += outWidth;\r\n        {\r\n            dest[destOffset + 0] = colorR;\r\n            dest[destOffset + 1] = colorG;\r\n            dest[destOffset + 2] = colorB;\r\n        }\r\n        {\r\n            dest[destOffset + 4] = colorR;\r\n            dest[destOffset + 5] = colorG;\r\n            dest[destOffset + 6] = colorB;\r\n        }\r\n        destOffset += outWidth;\r\n        {\r\n            dest[destOffset + 0] = colorR;\r\n            dest[destOffset + 1] = colorG;\r\n            dest[destOffset + 2] = colorB;\r\n        }\r\n        {\r\n            dest[destOffset + 4] = colorR;\r\n            dest[destOffset + 5] = colorG;\r\n            dest[destOffset + 6] = colorB;\r\n        }\r\n    };\r\n    MinimapCharRenderer.prototype.x1BlockRenderChar = function (target, dx, dy, color, backgroundColor, useLighterFont) {\r\n        if (dx + 1 /* x1_CHAR_WIDTH */ > target.width || dy + 2 /* x1_CHAR_HEIGHT */ > target.height) {\r\n            console.warn('bad render request outside image data');\r\n            return;\r\n        }\r\n        var outWidth = target.width * 4 /* RGBA_CHANNELS_CNT */;\r\n        var c = 0.5;\r\n        var backgroundR = backgroundColor.r;\r\n        var backgroundG = backgroundColor.g;\r\n        var backgroundB = backgroundColor.b;\r\n        var deltaR = color.r - backgroundR;\r\n        var deltaG = color.g - backgroundG;\r\n        var deltaB = color.b - backgroundB;\r\n        var colorR = backgroundR + deltaR * c;\r\n        var colorG = backgroundG + deltaG * c;\r\n        var colorB = backgroundB + deltaB * c;\r\n        var dest = target.data;\r\n        var destOffset = dy * outWidth + dx * 4 /* RGBA_CHANNELS_CNT */;\r\n        {\r\n            dest[destOffset + 0] = colorR;\r\n            dest[destOffset + 1] = colorG;\r\n            dest[destOffset + 2] = colorB;\r\n        }\r\n        destOffset += outWidth;\r\n        {\r\n            dest[destOffset + 0] = colorR;\r\n            dest[destOffset + 1] = colorG;\r\n            dest[destOffset + 2] = colorB;\r\n        }\r\n    };\r\n    return MinimapCharRenderer;\r\n}());\r\nexport { MinimapCharRenderer };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { MinimapCharRenderer } from './minimapCharRenderer.js';\r\nfunction toUint8ClampedArrat(arr) {\r\n    var r = new Uint8ClampedArray(arr.length);\r\n    for (var i = 0, len = arr.length; i < len; i++) {\r\n        r[i] = arr[i];\r\n    }\r\n    return r;\r\n}\r\nvar minimapCharRenderer = null;\r\nexport function getOrCreateMinimapCharRenderer() {\r\n    if (!minimapCharRenderer) {\r\n        var _x1Data = toUint8ClampedArrat(x1Data);\r\n        x1Data = null;\r\n        var _x2Data = toUint8ClampedArrat(x2Data);\r\n        x2Data = null;\r\n        minimapCharRenderer = new MinimapCharRenderer(_x2Data, _x1Data);\r\n    }\r\n    return minimapCharRenderer;\r\n}\r\nvar x2Data = [\r\n    //\r\n    0, 0,\r\n    0, 0,\r\n    0, 0,\r\n    0, 0,\r\n    // !\r\n    39, 14,\r\n    39, 14,\r\n    14, 5,\r\n    29, 10,\r\n    // \"\r\n    96, 96,\r\n    29, 29,\r\n    0, 0,\r\n    0, 0,\r\n    // #\r\n    49, 113,\r\n    195, 214,\r\n    227, 166,\r\n    135, 42,\r\n    // $\r\n    40, 29,\r\n    194, 38,\r\n    75, 148,\r\n    197, 187,\r\n    // %\r\n    145, 0,\r\n    160, 61,\r\n    75, 143,\r\n    2, 183,\r\n    // &\r\n    138, 58,\r\n    163, 6,\r\n    177, 223,\r\n    197, 227,\r\n    // '\r\n    38, 13,\r\n    11, 4,\r\n    0, 0,\r\n    0, 0,\r\n    // (\r\n    10, 54,\r\n    52, 8,\r\n    62, 4,\r\n    71, 122,\r\n    // )\r\n    73, 2,\r\n    19, 40,\r\n    10, 50,\r\n    155, 36,\r\n    // *\r\n    79, 70,\r\n    145, 121,\r\n    7, 5,\r\n    0, 0,\r\n    // +\r\n    2, 1,\r\n    36, 12,\r\n    204, 166,\r\n    16, 5,\r\n    // ,\r\n    0, 0,\r\n    0, 0,\r\n    1, 0,\r\n    154, 34,\r\n    // -\r\n    0, 0,\r\n    0, 0,\r\n    96, 83,\r\n    0, 0,\r\n    // .\r\n    0, 0,\r\n    0, 0,\r\n    0, 0,\r\n    46, 34,\r\n    // /\r\n    0, 82,\r\n    2, 56,\r\n    53, 3,\r\n    146, 0,\r\n    // 0\r\n    146, 119,\r\n    152, 132,\r\n    152, 131,\r\n    145, 119,\r\n    // 1\r\n    170, 42,\r\n    15, 42,\r\n    15, 42,\r\n    172, 194,\r\n    // 2\r\n    131, 132,\r\n    0, 139,\r\n    80, 28,\r\n    227, 143,\r\n    // 3\r\n    159, 135,\r\n    15, 118,\r\n    11, 126,\r\n    171, 144,\r\n    // 4\r\n    20, 124,\r\n    88, 106,\r\n    217, 196,\r\n    0, 106,\r\n    // 5\r\n    189, 92,\r\n    168, 43,\r\n    5, 130,\r\n    164, 133,\r\n    // 6\r\n    130, 115,\r\n    183, 65,\r\n    134, 120,\r\n    141, 141,\r\n    // 7\r\n    170, 196,\r\n    2, 106,\r\n    31, 32,\r\n    105, 2,\r\n    // 8\r\n    145, 130,\r\n    116, 114,\r\n    132, 135,\r\n    138, 140,\r\n    // 9\r\n    138, 113,\r\n    147, 137,\r\n    81, 183,\r\n    129, 94,\r\n    // :\r\n    0, 0,\r\n    21, 16,\r\n    4, 3,\r\n    46, 34,\r\n    // ;\r\n    0, 0,\r\n    45, 34,\r\n    1, 0,\r\n    160, 49,\r\n    // <\r\n    0, 0,\r\n    43, 143,\r\n    203, 23,\r\n    1, 76,\r\n    // =\r\n    0, 0,\r\n    38, 28,\r\n    131, 96,\r\n    38, 28,\r\n    // >\r\n    0, 0,\r\n    168, 31,\r\n    29, 191,\r\n    98, 0,\r\n    // ?\r\n    118, 139,\r\n    5, 113,\r\n    45, 13,\r\n    37, 6,\r\n    // @\r\n    97, 115,\r\n    161, 179,\r\n    204, 105,\r\n    223, 224,\r\n    // A\r\n    83, 52,\r\n    111, 100,\r\n    184, 186,\r\n    120, 132,\r\n    // B\r\n    212, 145,\r\n    180, 139,\r\n    174, 161,\r\n    212, 182,\r\n    // C\r\n    104, 162,\r\n    131, 0,\r\n    131, 0,\r\n    104, 161,\r\n    // D\r\n    219, 120,\r\n    110, 116,\r\n    110, 116,\r\n    219, 120,\r\n    // E\r\n    207, 154,\r\n    163, 40,\r\n    147, 22,\r\n    207, 154,\r\n    // F\r\n    202, 159,\r\n    161, 47,\r\n    145, 23,\r\n    111, 0,\r\n    // G\r\n    139, 154,\r\n    144, 30,\r\n    144, 135,\r\n    139, 187,\r\n    // H\r\n    110, 110,\r\n    168, 161,\r\n    150, 145,\r\n    110, 110,\r\n    // I\r\n    185, 162,\r\n    43, 16,\r\n    43, 16,\r\n    185, 162,\r\n    // J\r\n    73, 129,\r\n    0, 110,\r\n    0, 110,\r\n    191, 87,\r\n    // K\r\n    149, 149,\r\n    236, 48,\r\n    195, 91,\r\n    146, 149,\r\n    // L\r\n    146, 0,\r\n    146, 0,\r\n    146, 0,\r\n    187, 173,\r\n    // M\r\n    200, 201,\r\n    222, 215,\r\n    172, 147,\r\n    95, 95,\r\n    // N\r\n    193, 97,\r\n    224, 129,\r\n    159, 206,\r\n    97, 192,\r\n    // O\r\n    155, 139,\r\n    153, 115,\r\n    153, 115,\r\n    156, 140,\r\n    // P\r\n    189, 158,\r\n    123, 136,\r\n    190, 64,\r\n    111, 0,\r\n    // Q\r\n    155, 139,\r\n    153, 115,\r\n    153, 114,\r\n    156, 241,\r\n    // R\r\n    197, 148,\r\n    150, 152,\r\n    170, 116,\r\n    110, 157,\r\n    // S\r\n    156, 128,\r\n    169, 14,\r\n    13, 159,\r\n    158, 149,\r\n    // T\r\n    212, 189,\r\n    43, 16,\r\n    43, 16,\r\n    43, 16,\r\n    // U\r\n    148, 110,\r\n    148, 110,\r\n    147, 109,\r\n    182, 151,\r\n    // V\r\n    133, 121,\r\n    106, 118,\r\n    114, 103,\r\n    89, 66,\r\n    // W\r\n    94, 94,\r\n    211, 188,\r\n    205, 207,\r\n    139, 168,\r\n    // X\r\n    151, 152,\r\n    87, 76,\r\n    101, 79,\r\n    151, 152,\r\n    // Y\r\n    130, 156,\r\n    125, 116,\r\n    47, 29,\r\n    43, 16,\r\n    // Z\r\n    169, 228,\r\n    11, 103,\r\n    120, 6,\r\n    230, 176,\r\n    // [\r\n    55, 49,\r\n    55, 6,\r\n    55, 6,\r\n    193, 102,\r\n    // \\\r\n    92, 0,\r\n    71, 0,\r\n    13, 30,\r\n    0, 147,\r\n    // ]\r\n    63, 43,\r\n    12, 43,\r\n    12, 43,\r\n    142, 152,\r\n    // ^\r\n    71, 53,\r\n    61, 61,\r\n    0, 0,\r\n    0, 0,\r\n    // _\r\n    0, 0,\r\n    0, 0,\r\n    0, 0,\r\n    158, 146,\r\n    // `\r\n    25, 2,\r\n    0, 0,\r\n    0, 0,\r\n    0, 0,\r\n    // a\r\n    0, 0,\r\n    107, 130,\r\n    170, 194,\r\n    176, 188,\r\n    // b\r\n    109, 0,\r\n    203, 159,\r\n    113, 111,\r\n    202, 158,\r\n    // c\r\n    0, 0,\r\n    135, 135,\r\n    114, 0,\r\n    136, 135,\r\n    // d\r\n    0, 109,\r\n    187, 190,\r\n    148, 126,\r\n    177, 187,\r\n    // e\r\n    0, 0,\r\n    149, 130,\r\n    218, 105,\r\n    169, 135,\r\n    // f\r\n    37, 113,\r\n    146, 113,\r\n    49, 13,\r\n    49, 13,\r\n    // g\r\n    0, 0,\r\n    178, 195,\r\n    147, 114,\r\n    255, 255,\r\n    // h\r\n    109, 0,\r\n    193, 149,\r\n    110, 109,\r\n    109, 109,\r\n    // i\r\n    12, 15,\r\n    125, 41,\r\n    33, 41,\r\n    144, 188,\r\n    // j\r\n    1, 6,\r\n    75, 53,\r\n    10, 53,\r\n    210, 161,\r\n    // k\r\n    110, 0,\r\n    152, 148,\r\n    210, 60,\r\n    110, 156,\r\n    // l\r\n    213, 5,\r\n    63, 5,\r\n    63, 5,\r\n    45, 111,\r\n    // m\r\n    0, 0,\r\n    232, 172,\r\n    190, 168,\r\n    190, 169,\r\n    // n\r\n    0, 0,\r\n    190, 144,\r\n    109, 109,\r\n    109, 109,\r\n    // o\r\n    0, 0,\r\n    168, 140,\r\n    148, 111,\r\n    168, 140,\r\n    // p\r\n    0, 0,\r\n    200, 151,\r\n    113, 110,\r\n    255, 158,\r\n    // q\r\n    0, 0,\r\n    184, 188,\r\n    147, 139,\r\n    186, 255,\r\n    // r\r\n    0, 0,\r\n    122, 130,\r\n    111, 0,\r\n    109, 0,\r\n    // s\r\n    0, 0,\r\n    132, 69,\r\n    109, 93,\r\n    110, 136,\r\n    // t\r\n    51, 5,\r\n    205, 103,\r\n    61, 6,\r\n    47, 106,\r\n    // u\r\n    0, 0,\r\n    110, 109,\r\n    110, 122,\r\n    155, 179,\r\n    // v\r\n    0, 0,\r\n    132, 120,\r\n    113, 114,\r\n    84, 63,\r\n    // w\r\n    0, 0,\r\n    124, 108,\r\n    202, 189,\r\n    160, 174,\r\n    // x\r\n    0, 0,\r\n    144, 142,\r\n    79, 57,\r\n    159, 146,\r\n    // y\r\n    0, 0,\r\n    138, 138,\r\n    119, 117,\r\n    255, 69,\r\n    // z\r\n    0, 0,\r\n    97, 198,\r\n    47, 38,\r\n    208, 84,\r\n    // {\r\n    23, 112,\r\n    41, 14,\r\n    157, 7,\r\n    121, 192,\r\n    // |\r\n    35, 11,\r\n    35, 11,\r\n    35, 11,\r\n    160, 61,\r\n    // }\r\n    129, 9,\r\n    40, 19,\r\n    20, 139,\r\n    236, 44,\r\n    // ~\r\n    0, 0,\r\n    15, 3,\r\n    97, 93,\r\n    0, 0,\r\n];\r\nvar x1Data = [\r\n    //\r\n    0,\r\n    0,\r\n    // !\r\n    23,\r\n    12,\r\n    // \"\r\n    53,\r\n    0,\r\n    // #\r\n    130,\r\n    127,\r\n    // $\r\n    58,\r\n    149,\r\n    // %\r\n    67,\r\n    77,\r\n    // &\r\n    72,\r\n    198,\r\n    // '\r\n    13,\r\n    0,\r\n    // (\r\n    25,\r\n    51,\r\n    // )\r\n    25,\r\n    49,\r\n    // *\r\n    94,\r\n    2,\r\n    // +\r\n    8,\r\n    64,\r\n    // ,\r\n    0,\r\n    24,\r\n    // -\r\n    0,\r\n    21,\r\n    // .\r\n    0,\r\n    9,\r\n    // /\r\n    19,\r\n    27,\r\n    // 0\r\n    126,\r\n    126,\r\n    // 1\r\n    51,\r\n    80,\r\n    // 2\r\n    72,\r\n    105,\r\n    // 3\r\n    87,\r\n    98,\r\n    // 4\r\n    73,\r\n    93,\r\n    // 5\r\n    106,\r\n    85,\r\n    // 6\r\n    111,\r\n    123,\r\n    // 7\r\n    87,\r\n    30,\r\n    // 8\r\n    116,\r\n    126,\r\n    // 9\r\n    123,\r\n    110,\r\n    // :\r\n    4,\r\n    16,\r\n    // ;\r\n    9,\r\n    28,\r\n    // <\r\n    21,\r\n    53,\r\n    // =\r\n    8,\r\n    62,\r\n    // >\r\n    23,\r\n    52,\r\n    // ?\r\n    73,\r\n    21,\r\n    // @\r\n    132,\r\n    183,\r\n    // A\r\n    78,\r\n    142,\r\n    // B\r\n    168,\r\n    175,\r\n    // C\r\n    70,\r\n    70,\r\n    // D\r\n    128,\r\n    128,\r\n    // E\r\n    123,\r\n    110,\r\n    // F\r\n    125,\r\n    43,\r\n    // G\r\n    100,\r\n    139,\r\n    // H\r\n    125,\r\n    119,\r\n    // I\r\n    78,\r\n    78,\r\n    // J\r\n    54,\r\n    77,\r\n    // K\r\n    139,\r\n    139,\r\n    // L\r\n    33,\r\n    87,\r\n    // M\r\n    201,\r\n    117,\r\n    // N\r\n    162,\r\n    149,\r\n    // O\r\n    130,\r\n    130,\r\n    // P\r\n    138,\r\n    60,\r\n    // Q\r\n    130,\r\n    172,\r\n    // R\r\n    149,\r\n    127,\r\n    // S\r\n    95,\r\n    98,\r\n    // T\r\n    95,\r\n    25,\r\n    // U\r\n    118,\r\n    135,\r\n    // V\r\n    110,\r\n    85,\r\n    // W\r\n    147,\r\n    175,\r\n    // X\r\n    105,\r\n    110,\r\n    // Y\r\n    121,\r\n    30,\r\n    // Z\r\n    101,\r\n    113,\r\n    // [\r\n    34,\r\n    68,\r\n    // \\\r\n    20,\r\n    26,\r\n    // ]\r\n    34,\r\n    68,\r\n    // ^\r\n    56,\r\n    0,\r\n    // _\r\n    0,\r\n    44,\r\n    // `\r\n    3,\r\n    0,\r\n    // a\r\n    27,\r\n    175,\r\n    // b\r\n    80,\r\n    133,\r\n    // c\r\n    31,\r\n    66,\r\n    // d\r\n    85,\r\n    147,\r\n    // e\r\n    32,\r\n    150,\r\n    // f\r\n    90,\r\n    25,\r\n    // g\r\n    45,\r\n    230,\r\n    // h\r\n    77,\r\n    101,\r\n    // i\r\n    36,\r\n    83,\r\n    // j\r\n    22,\r\n    84,\r\n    // k\r\n    71,\r\n    118,\r\n    // l\r\n    44,\r\n    44,\r\n    // m\r\n    52,\r\n    172,\r\n    // n\r\n    38,\r\n    101,\r\n    // o\r\n    35,\r\n    130,\r\n    // p\r\n    40,\r\n    197,\r\n    // q\r\n    43,\r\n    197,\r\n    // r\r\n    29,\r\n    26,\r\n    // s\r\n    23,\r\n    103,\r\n    // t\r\n    67,\r\n    44,\r\n    // u\r\n    25,\r\n    129,\r\n    // v\r\n    29,\r\n    85,\r\n    // w\r\n    27,\r\n    177,\r\n    // x\r\n    33,\r\n    97,\r\n    // y\r\n    32,\r\n    145,\r\n    // z\r\n    33,\r\n    77,\r\n    // {\r\n    38,\r\n    96,\r\n    // |\r\n    20,\r\n    55,\r\n    // }\r\n    36,\r\n    95,\r\n    // ~\r\n    2,\r\n    22,\r\n];\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './minimap.css';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { GlobalMouseMoveMonitor, standardMouseMoveMerger } from '../../../../base/browser/globalMouseMoveMonitor.js';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { RenderedLinesCollection } from '../../view/viewLayer.js';\r\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { MinimapTokensColorTracker } from '../../../common/view/minimapCharRenderer.js';\r\nimport { getOrCreateMinimapCharRenderer } from '../../../common/view/runtimeMinimapCharRenderer.js';\r\nimport * as viewEvents from '../../../common/view/viewEvents.js';\r\nimport { scrollbarShadow, scrollbarSliderActiveBackground, scrollbarSliderBackground, scrollbarSliderHoverBackground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nfunction getMinimapLineHeight(renderMinimap) {\r\n    if (renderMinimap === 2 /* Large */) {\r\n        return 4 /* x2_CHAR_HEIGHT */;\r\n    }\r\n    if (renderMinimap === 4 /* LargeBlocks */) {\r\n        return 4 /* x2_CHAR_HEIGHT */ + 2;\r\n    }\r\n    if (renderMinimap === 1 /* Small */) {\r\n        return 2 /* x1_CHAR_HEIGHT */;\r\n    }\r\n    // RenderMinimap.SmallBlocks\r\n    return 2 /* x1_CHAR_HEIGHT */ + 1;\r\n}\r\nfunction getMinimapCharWidth(renderMinimap) {\r\n    if (renderMinimap === 2 /* Large */) {\r\n        return 2 /* x2_CHAR_WIDTH */;\r\n    }\r\n    if (renderMinimap === 4 /* LargeBlocks */) {\r\n        return 2 /* x2_CHAR_WIDTH */;\r\n    }\r\n    if (renderMinimap === 1 /* Small */) {\r\n        return 1 /* x1_CHAR_WIDTH */;\r\n    }\r\n    // RenderMinimap.SmallBlocks\r\n    return 1 /* x1_CHAR_WIDTH */;\r\n}\r\n/**\r\n * The orthogonal distance to the slider at which dragging \"resets\". This implements \"snapping\"\r\n */\r\nvar MOUSE_DRAG_RESET_DISTANCE = 140;\r\nvar MinimapOptions = /** @class */ (function () {\r\n    function MinimapOptions(configuration) {\r\n        var pixelRatio = configuration.editor.pixelRatio;\r\n        var layoutInfo = configuration.editor.layoutInfo;\r\n        var viewInfo = configuration.editor.viewInfo;\r\n        var fontInfo = configuration.editor.fontInfo;\r\n        this.renderMinimap = layoutInfo.renderMinimap | 0;\r\n        this.scrollBeyondLastLine = viewInfo.scrollBeyondLastLine;\r\n        this.showSlider = viewInfo.minimap.showSlider;\r\n        this.pixelRatio = pixelRatio;\r\n        this.typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\r\n        this.lineHeight = configuration.editor.lineHeight;\r\n        this.minimapLeft = layoutInfo.minimapLeft;\r\n        this.minimapWidth = layoutInfo.minimapWidth;\r\n        this.minimapHeight = layoutInfo.height;\r\n        this.canvasInnerWidth = Math.max(1, Math.floor(pixelRatio * this.minimapWidth));\r\n        this.canvasInnerHeight = Math.max(1, Math.floor(pixelRatio * this.minimapHeight));\r\n        this.canvasOuterWidth = this.canvasInnerWidth / pixelRatio;\r\n        this.canvasOuterHeight = this.canvasInnerHeight / pixelRatio;\r\n    }\r\n    MinimapOptions.prototype.equals = function (other) {\r\n        return (this.renderMinimap === other.renderMinimap\r\n            && this.scrollBeyondLastLine === other.scrollBeyondLastLine\r\n            && this.showSlider === other.showSlider\r\n            && this.pixelRatio === other.pixelRatio\r\n            && this.typicalHalfwidthCharacterWidth === other.typicalHalfwidthCharacterWidth\r\n            && this.lineHeight === other.lineHeight\r\n            && this.minimapLeft === other.minimapLeft\r\n            && this.minimapWidth === other.minimapWidth\r\n            && this.minimapHeight === other.minimapHeight\r\n            && this.canvasInnerWidth === other.canvasInnerWidth\r\n            && this.canvasInnerHeight === other.canvasInnerHeight\r\n            && this.canvasOuterWidth === other.canvasOuterWidth\r\n            && this.canvasOuterHeight === other.canvasOuterHeight);\r\n    };\r\n    return MinimapOptions;\r\n}());\r\nvar MinimapLayout = /** @class */ (function () {\r\n    function MinimapLayout(scrollTop, scrollHeight, computedSliderRatio, sliderTop, sliderHeight, startLineNumber, endLineNumber) {\r\n        this.scrollTop = scrollTop;\r\n        this.scrollHeight = scrollHeight;\r\n        this._computedSliderRatio = computedSliderRatio;\r\n        this.sliderTop = sliderTop;\r\n        this.sliderHeight = sliderHeight;\r\n        this.startLineNumber = startLineNumber;\r\n        this.endLineNumber = endLineNumber;\r\n    }\r\n    /**\r\n     * Compute a desired `scrollPosition` such that the slider moves by `delta`.\r\n     */\r\n    MinimapLayout.prototype.getDesiredScrollTopFromDelta = function (delta) {\r\n        var desiredSliderPosition = this.sliderTop + delta;\r\n        return Math.round(desiredSliderPosition / this._computedSliderRatio);\r\n    };\r\n    MinimapLayout.create = function (options, viewportStartLineNumber, viewportEndLineNumber, viewportHeight, viewportContainsWhitespaceGaps, lineCount, scrollTop, scrollHeight, previousLayout) {\r\n        var pixelRatio = options.pixelRatio;\r\n        var minimapLineHeight = getMinimapLineHeight(options.renderMinimap);\r\n        var minimapLinesFitting = Math.floor(options.canvasInnerHeight / minimapLineHeight);\r\n        var lineHeight = options.lineHeight;\r\n        // The visible line count in a viewport can change due to a number of reasons:\r\n        //  a) with the same viewport width, different scroll positions can result in partial lines being visible:\r\n        //    e.g. for a line height of 20, and a viewport height of 600\r\n        //          * scrollTop = 0  => visible lines are [1, 30]\r\n        //          * scrollTop = 10 => visible lines are [1, 31] (with lines 1 and 31 partially visible)\r\n        //          * scrollTop = 20 => visible lines are [2, 31]\r\n        //  b) whitespace gaps might make their way in the viewport (which results in a decrease in the visible line count)\r\n        //  c) we could be in the scroll beyond last line case (which also results in a decrease in the visible line count, down to possibly only one line being visible)\r\n        // We must first establish a desirable slider height.\r\n        var sliderHeight;\r\n        if (viewportContainsWhitespaceGaps && viewportEndLineNumber !== lineCount) {\r\n            // case b) from above: there are whitespace gaps in the viewport.\r\n            // In this case, the height of the slider directly reflects the visible line count.\r\n            var viewportLineCount = viewportEndLineNumber - viewportStartLineNumber + 1;\r\n            sliderHeight = Math.floor(viewportLineCount * minimapLineHeight / pixelRatio);\r\n        }\r\n        else {\r\n            // The slider has a stable height\r\n            var expectedViewportLineCount = viewportHeight / lineHeight;\r\n            sliderHeight = Math.floor(expectedViewportLineCount * minimapLineHeight / pixelRatio);\r\n        }\r\n        var maxMinimapSliderTop;\r\n        if (options.scrollBeyondLastLine) {\r\n            // The minimap slider, when dragged all the way down, will contain the last line at its top\r\n            maxMinimapSliderTop = (lineCount - 1) * minimapLineHeight / pixelRatio;\r\n        }\r\n        else {\r\n            // The minimap slider, when dragged all the way down, will contain the last line at its bottom\r\n            maxMinimapSliderTop = Math.max(0, lineCount * minimapLineHeight / pixelRatio - sliderHeight);\r\n        }\r\n        maxMinimapSliderTop = Math.min(options.minimapHeight - sliderHeight, maxMinimapSliderTop);\r\n        // The slider can move from 0 to `maxMinimapSliderTop`\r\n        // in the same way `scrollTop` can move from 0 to `scrollHeight` - `viewportHeight`.\r\n        var computedSliderRatio = (maxMinimapSliderTop) / (scrollHeight - viewportHeight);\r\n        var sliderTop = (scrollTop * computedSliderRatio);\r\n        if (minimapLinesFitting >= lineCount) {\r\n            // All lines fit in the minimap\r\n            var startLineNumber = 1;\r\n            var endLineNumber = lineCount;\r\n            return new MinimapLayout(scrollTop, scrollHeight, computedSliderRatio, sliderTop, sliderHeight, startLineNumber, endLineNumber);\r\n        }\r\n        else {\r\n            var startLineNumber = Math.max(1, Math.floor(viewportStartLineNumber - sliderTop * pixelRatio / minimapLineHeight));\r\n            // Avoid flickering caused by a partial viewport start line\r\n            // by being consistent w.r.t. the previous layout decision\r\n            if (previousLayout && previousLayout.scrollHeight === scrollHeight) {\r\n                if (previousLayout.scrollTop > scrollTop) {\r\n                    // Scrolling up => never increase `startLineNumber`\r\n                    startLineNumber = Math.min(startLineNumber, previousLayout.startLineNumber);\r\n                }\r\n                if (previousLayout.scrollTop < scrollTop) {\r\n                    // Scrolling down => never decrease `startLineNumber`\r\n                    startLineNumber = Math.max(startLineNumber, previousLayout.startLineNumber);\r\n                }\r\n            }\r\n            var endLineNumber = Math.min(lineCount, startLineNumber + minimapLinesFitting - 1);\r\n            return new MinimapLayout(scrollTop, scrollHeight, computedSliderRatio, sliderTop, sliderHeight, startLineNumber, endLineNumber);\r\n        }\r\n    };\r\n    return MinimapLayout;\r\n}());\r\nvar MinimapLine = /** @class */ (function () {\r\n    function MinimapLine(dy) {\r\n        this.dy = dy;\r\n    }\r\n    MinimapLine.prototype.onContentChanged = function () {\r\n        this.dy = -1;\r\n    };\r\n    MinimapLine.prototype.onTokensChanged = function () {\r\n        this.dy = -1;\r\n    };\r\n    MinimapLine.INVALID = new MinimapLine(-1);\r\n    return MinimapLine;\r\n}());\r\nvar RenderData = /** @class */ (function () {\r\n    function RenderData(renderedLayout, imageData, lines) {\r\n        this.renderedLayout = renderedLayout;\r\n        this._imageData = imageData;\r\n        this._renderedLines = new RenderedLinesCollection(function () { return MinimapLine.INVALID; });\r\n        this._renderedLines._set(renderedLayout.startLineNumber, lines);\r\n    }\r\n    /**\r\n     * Check if the current RenderData matches accurately the new desired layout and no painting is needed.\r\n     */\r\n    RenderData.prototype.linesEquals = function (layout) {\r\n        if (this.renderedLayout.startLineNumber !== layout.startLineNumber) {\r\n            return false;\r\n        }\r\n        if (this.renderedLayout.endLineNumber !== layout.endLineNumber) {\r\n            return false;\r\n        }\r\n        var tmp = this._renderedLines._get();\r\n        var lines = tmp.lines;\r\n        for (var i = 0, len = lines.length; i < len; i++) {\r\n            if (lines[i].dy === -1) {\r\n                // This line is invalid\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    RenderData.prototype._get = function () {\r\n        var tmp = this._renderedLines._get();\r\n        return {\r\n            imageData: this._imageData,\r\n            rendLineNumberStart: tmp.rendLineNumberStart,\r\n            lines: tmp.lines\r\n        };\r\n    };\r\n    RenderData.prototype.onLinesChanged = function (e) {\r\n        return this._renderedLines.onLinesChanged(e.fromLineNumber, e.toLineNumber);\r\n    };\r\n    RenderData.prototype.onLinesDeleted = function (e) {\r\n        this._renderedLines.onLinesDeleted(e.fromLineNumber, e.toLineNumber);\r\n    };\r\n    RenderData.prototype.onLinesInserted = function (e) {\r\n        this._renderedLines.onLinesInserted(e.fromLineNumber, e.toLineNumber);\r\n    };\r\n    RenderData.prototype.onTokensChanged = function (e) {\r\n        return this._renderedLines.onTokensChanged(e.ranges);\r\n    };\r\n    return RenderData;\r\n}());\r\n/**\r\n * Some sort of double buffering.\r\n *\r\n * Keeps two buffers around that will be rotated for painting.\r\n * Always gives a buffer that is filled with the background color.\r\n */\r\nvar MinimapBuffers = /** @class */ (function () {\r\n    function MinimapBuffers(ctx, WIDTH, HEIGHT, background) {\r\n        this._backgroundFillData = MinimapBuffers._createBackgroundFillData(WIDTH, HEIGHT, background);\r\n        this._buffers = [\r\n            ctx.createImageData(WIDTH, HEIGHT),\r\n            ctx.createImageData(WIDTH, HEIGHT)\r\n        ];\r\n        this._lastUsedBuffer = 0;\r\n    }\r\n    MinimapBuffers.prototype.getBuffer = function () {\r\n        // rotate buffers\r\n        this._lastUsedBuffer = 1 - this._lastUsedBuffer;\r\n        var result = this._buffers[this._lastUsedBuffer];\r\n        // fill with background color\r\n        result.data.set(this._backgroundFillData);\r\n        return result;\r\n    };\r\n    MinimapBuffers._createBackgroundFillData = function (WIDTH, HEIGHT, background) {\r\n        var backgroundR = background.r;\r\n        var backgroundG = background.g;\r\n        var backgroundB = background.b;\r\n        var result = new Uint8ClampedArray(WIDTH * HEIGHT * 4);\r\n        var offset = 0;\r\n        for (var i = 0; i < HEIGHT; i++) {\r\n            for (var j = 0; j < WIDTH; j++) {\r\n                result[offset] = backgroundR;\r\n                result[offset + 1] = backgroundG;\r\n                result[offset + 2] = backgroundB;\r\n                result[offset + 3] = 255;\r\n                offset += 4;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    return MinimapBuffers;\r\n}());\r\nvar Minimap = /** @class */ (function (_super) {\r\n    __extends(Minimap, _super);\r\n    function Minimap(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._options = new MinimapOptions(_this._context.configuration);\r\n        _this._lastRenderData = null;\r\n        _this._buffers = null;\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        PartFingerprints.write(_this._domNode, 8 /* Minimap */);\r\n        _this._domNode.setClassName(_this._getMinimapDomNodeClassName());\r\n        _this._domNode.setPosition('absolute');\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._shadow = createFastDomNode(document.createElement('div'));\r\n        _this._shadow.setClassName('minimap-shadow-hidden');\r\n        _this._domNode.appendChild(_this._shadow);\r\n        _this._canvas = createFastDomNode(document.createElement('canvas'));\r\n        _this._canvas.setPosition('absolute');\r\n        _this._canvas.setLeft(0);\r\n        _this._domNode.appendChild(_this._canvas);\r\n        _this._slider = createFastDomNode(document.createElement('div'));\r\n        _this._slider.setPosition('absolute');\r\n        _this._slider.setClassName('minimap-slider');\r\n        _this._slider.setLayerHinting(true);\r\n        _this._domNode.appendChild(_this._slider);\r\n        _this._sliderHorizontal = createFastDomNode(document.createElement('div'));\r\n        _this._sliderHorizontal.setPosition('absolute');\r\n        _this._sliderHorizontal.setClassName('minimap-slider-horizontal');\r\n        _this._slider.appendChild(_this._sliderHorizontal);\r\n        _this._tokensColorTracker = MinimapTokensColorTracker.getInstance();\r\n        _this._applyLayout();\r\n        _this._mouseDownListener = dom.addStandardDisposableListener(_this._canvas.domNode, 'mousedown', function (e) {\r\n            e.preventDefault();\r\n            var renderMinimap = _this._options.renderMinimap;\r\n            if (renderMinimap === 0 /* None */) {\r\n                return;\r\n            }\r\n            if (!_this._lastRenderData) {\r\n                return;\r\n            }\r\n            var minimapLineHeight = getMinimapLineHeight(renderMinimap);\r\n            var internalOffsetY = _this._options.pixelRatio * e.browserEvent.offsetY;\r\n            var lineIndex = Math.floor(internalOffsetY / minimapLineHeight);\r\n            var lineNumber = lineIndex + _this._lastRenderData.renderedLayout.startLineNumber;\r\n            lineNumber = Math.min(lineNumber, _this._context.model.getLineCount());\r\n            _this._context.privateViewEventBus.emit(new viewEvents.ViewRevealRangeRequestEvent(new Range(lineNumber, 1, lineNumber, 1), 1 /* Center */, false, 0 /* Smooth */));\r\n        });\r\n        _this._sliderMouseMoveMonitor = new GlobalMouseMoveMonitor();\r\n        _this._sliderMouseDownListener = dom.addStandardDisposableListener(_this._slider.domNode, 'mousedown', function (e) {\r\n            e.preventDefault();\r\n            if (e.leftButton && _this._lastRenderData) {\r\n                var initialMousePosition_1 = e.posy;\r\n                var initialMouseOrthogonalPosition_1 = e.posx;\r\n                var initialSliderState_1 = _this._lastRenderData.renderedLayout;\r\n                _this._slider.toggleClassName('active', true);\r\n                _this._sliderMouseMoveMonitor.startMonitoring(standardMouseMoveMerger, function (mouseMoveData) {\r\n                    var mouseOrthogonalDelta = Math.abs(mouseMoveData.posx - initialMouseOrthogonalPosition_1);\r\n                    if (platform.isWindows && mouseOrthogonalDelta > MOUSE_DRAG_RESET_DISTANCE) {\r\n                        // The mouse has wondered away from the scrollbar => reset dragging\r\n                        _this._context.viewLayout.setScrollPositionNow({\r\n                            scrollTop: initialSliderState_1.scrollTop\r\n                        });\r\n                        return;\r\n                    }\r\n                    var mouseDelta = mouseMoveData.posy - initialMousePosition_1;\r\n                    _this._context.viewLayout.setScrollPositionNow({\r\n                        scrollTop: initialSliderState_1.getDesiredScrollTopFromDelta(mouseDelta)\r\n                    });\r\n                }, function () {\r\n                    _this._slider.toggleClassName('active', false);\r\n                });\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n    Minimap.prototype.dispose = function () {\r\n        this._mouseDownListener.dispose();\r\n        this._sliderMouseMoveMonitor.dispose();\r\n        this._sliderMouseDownListener.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    Minimap.prototype._getMinimapDomNodeClassName = function () {\r\n        if (this._options.showSlider === 'always') {\r\n            return 'minimap slider-always';\r\n        }\r\n        return 'minimap slider-mouseover';\r\n    };\r\n    Minimap.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    Minimap.prototype._applyLayout = function () {\r\n        this._domNode.setLeft(this._options.minimapLeft);\r\n        this._domNode.setWidth(this._options.minimapWidth);\r\n        this._domNode.setHeight(this._options.minimapHeight);\r\n        this._shadow.setHeight(this._options.minimapHeight);\r\n        this._canvas.setWidth(this._options.canvasOuterWidth);\r\n        this._canvas.setHeight(this._options.canvasOuterHeight);\r\n        this._canvas.domNode.width = this._options.canvasInnerWidth;\r\n        this._canvas.domNode.height = this._options.canvasInnerHeight;\r\n        this._slider.setWidth(this._options.minimapWidth);\r\n    };\r\n    Minimap.prototype._getBuffer = function () {\r\n        if (!this._buffers) {\r\n            this._buffers = new MinimapBuffers(this._canvas.domNode.getContext('2d'), this._options.canvasInnerWidth, this._options.canvasInnerHeight, this._tokensColorTracker.getColor(2 /* DefaultBackground */));\r\n        }\r\n        return this._buffers.getBuffer();\r\n    };\r\n    Minimap.prototype._onOptionsMaybeChanged = function () {\r\n        var opts = new MinimapOptions(this._context.configuration);\r\n        if (this._options.equals(opts)) {\r\n            return false;\r\n        }\r\n        this._options = opts;\r\n        this._lastRenderData = null;\r\n        this._buffers = null;\r\n        this._applyLayout();\r\n        this._domNode.setClassName(this._getMinimapDomNodeClassName());\r\n        return true;\r\n    };\r\n    // ---- begin view event handlers\r\n    Minimap.prototype.onConfigurationChanged = function (e) {\r\n        return this._onOptionsMaybeChanged();\r\n    };\r\n    Minimap.prototype.onFlushed = function (e) {\r\n        this._lastRenderData = null;\r\n        return true;\r\n    };\r\n    Minimap.prototype.onLinesChanged = function (e) {\r\n        if (this._lastRenderData) {\r\n            return this._lastRenderData.onLinesChanged(e);\r\n        }\r\n        return false;\r\n    };\r\n    Minimap.prototype.onLinesDeleted = function (e) {\r\n        if (this._lastRenderData) {\r\n            this._lastRenderData.onLinesDeleted(e);\r\n        }\r\n        return true;\r\n    };\r\n    Minimap.prototype.onLinesInserted = function (e) {\r\n        if (this._lastRenderData) {\r\n            this._lastRenderData.onLinesInserted(e);\r\n        }\r\n        return true;\r\n    };\r\n    Minimap.prototype.onScrollChanged = function (e) {\r\n        return true;\r\n    };\r\n    Minimap.prototype.onTokensChanged = function (e) {\r\n        if (this._lastRenderData) {\r\n            return this._lastRenderData.onTokensChanged(e);\r\n        }\r\n        return false;\r\n    };\r\n    Minimap.prototype.onTokensColorsChanged = function (e) {\r\n        this._lastRenderData = null;\r\n        this._buffers = null;\r\n        return true;\r\n    };\r\n    Minimap.prototype.onZonesChanged = function (e) {\r\n        this._lastRenderData = null;\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    Minimap.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    Minimap.prototype.render = function (renderingCtx) {\r\n        var renderMinimap = this._options.renderMinimap;\r\n        if (renderMinimap === 0 /* None */) {\r\n            this._shadow.setClassName('minimap-shadow-hidden');\r\n            this._sliderHorizontal.setWidth(0);\r\n            this._sliderHorizontal.setHeight(0);\r\n            return;\r\n        }\r\n        if (renderingCtx.scrollLeft + renderingCtx.viewportWidth >= renderingCtx.scrollWidth) {\r\n            this._shadow.setClassName('minimap-shadow-hidden');\r\n        }\r\n        else {\r\n            this._shadow.setClassName('minimap-shadow-visible');\r\n        }\r\n        var layout = MinimapLayout.create(this._options, renderingCtx.visibleRange.startLineNumber, renderingCtx.visibleRange.endLineNumber, renderingCtx.viewportHeight, (renderingCtx.viewportData.whitespaceViewportData.length > 0), this._context.model.getLineCount(), renderingCtx.scrollTop, renderingCtx.scrollHeight, this._lastRenderData ? this._lastRenderData.renderedLayout : null);\r\n        this._slider.setTop(layout.sliderTop);\r\n        this._slider.setHeight(layout.sliderHeight);\r\n        // Compute horizontal slider coordinates\r\n        var scrollLeftChars = renderingCtx.scrollLeft / this._options.typicalHalfwidthCharacterWidth;\r\n        var horizontalSliderLeft = Math.min(this._options.minimapWidth, Math.round(scrollLeftChars * getMinimapCharWidth(this._options.renderMinimap) / this._options.pixelRatio));\r\n        this._sliderHorizontal.setLeft(horizontalSliderLeft);\r\n        this._sliderHorizontal.setWidth(this._options.minimapWidth - horizontalSliderLeft);\r\n        this._sliderHorizontal.setTop(0);\r\n        this._sliderHorizontal.setHeight(layout.sliderHeight);\r\n        this._lastRenderData = this.renderLines(layout);\r\n    };\r\n    Minimap.prototype.renderLines = function (layout) {\r\n        var renderMinimap = this._options.renderMinimap;\r\n        var startLineNumber = layout.startLineNumber;\r\n        var endLineNumber = layout.endLineNumber;\r\n        var minimapLineHeight = getMinimapLineHeight(renderMinimap);\r\n        // Check if nothing changed w.r.t. lines from last frame\r\n        if (this._lastRenderData && this._lastRenderData.linesEquals(layout)) {\r\n            var _lastData = this._lastRenderData._get();\r\n            // Nice!! Nothing changed from last frame\r\n            return new RenderData(layout, _lastData.imageData, _lastData.lines);\r\n        }\r\n        // Oh well!! We need to repaint some lines...\r\n        var imageData = this._getBuffer();\r\n        // Render untouched lines by using last rendered data.\r\n        var _a = Minimap._renderUntouchedLines(imageData, startLineNumber, endLineNumber, minimapLineHeight, this._lastRenderData), _dirtyY1 = _a[0], _dirtyY2 = _a[1], needed = _a[2];\r\n        // Fetch rendering info from view model for rest of lines that need rendering.\r\n        var lineInfo = this._context.model.getMinimapLinesRenderingData(startLineNumber, endLineNumber, needed);\r\n        var tabSize = lineInfo.tabSize;\r\n        var background = this._tokensColorTracker.getColor(2 /* DefaultBackground */);\r\n        var useLighterFont = this._tokensColorTracker.backgroundIsLight();\r\n        // Render the rest of lines\r\n        var dy = 0;\r\n        var renderedLines = [];\r\n        for (var lineIndex = 0, lineCount = endLineNumber - startLineNumber + 1; lineIndex < lineCount; lineIndex++) {\r\n            if (needed[lineIndex]) {\r\n                Minimap._renderLine(imageData, background, useLighterFont, renderMinimap, this._tokensColorTracker, getOrCreateMinimapCharRenderer(), dy, tabSize, lineInfo.data[lineIndex]);\r\n            }\r\n            renderedLines[lineIndex] = new MinimapLine(dy);\r\n            dy += minimapLineHeight;\r\n        }\r\n        var dirtyY1 = (_dirtyY1 === -1 ? 0 : _dirtyY1);\r\n        var dirtyY2 = (_dirtyY2 === -1 ? imageData.height : _dirtyY2);\r\n        var dirtyHeight = dirtyY2 - dirtyY1;\r\n        // Finally, paint to the canvas\r\n        var ctx = this._canvas.domNode.getContext('2d');\r\n        ctx.putImageData(imageData, 0, 0, 0, dirtyY1, imageData.width, dirtyHeight);\r\n        // Save rendered data for reuse on next frame if possible\r\n        return new RenderData(layout, imageData, renderedLines);\r\n    };\r\n    Minimap._renderUntouchedLines = function (target, startLineNumber, endLineNumber, minimapLineHeight, lastRenderData) {\r\n        var needed = [];\r\n        if (!lastRenderData) {\r\n            for (var i = 0, len = endLineNumber - startLineNumber + 1; i < len; i++) {\r\n                needed[i] = true;\r\n            }\r\n            return [-1, -1, needed];\r\n        }\r\n        var _lastData = lastRenderData._get();\r\n        var lastTargetData = _lastData.imageData.data;\r\n        var lastStartLineNumber = _lastData.rendLineNumberStart;\r\n        var lastLines = _lastData.lines;\r\n        var lastLinesLength = lastLines.length;\r\n        var WIDTH = target.width;\r\n        var targetData = target.data;\r\n        var maxDestPixel = (endLineNumber - startLineNumber + 1) * minimapLineHeight * WIDTH * 4;\r\n        var dirtyPixel1 = -1; // the pixel offset up to which all the data is equal to the prev frame\r\n        var dirtyPixel2 = -1; // the pixel offset after which all the data is equal to the prev frame\r\n        var copySourceStart = -1;\r\n        var copySourceEnd = -1;\r\n        var copyDestStart = -1;\r\n        var copyDestEnd = -1;\r\n        var dest_dy = 0;\r\n        for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - startLineNumber;\r\n            var lastLineIndex = lineNumber - lastStartLineNumber;\r\n            var source_dy = (lastLineIndex >= 0 && lastLineIndex < lastLinesLength ? lastLines[lastLineIndex].dy : -1);\r\n            if (source_dy === -1) {\r\n                needed[lineIndex] = true;\r\n                dest_dy += minimapLineHeight;\r\n                continue;\r\n            }\r\n            var sourceStart = source_dy * WIDTH * 4;\r\n            var sourceEnd = (source_dy + minimapLineHeight) * WIDTH * 4;\r\n            var destStart = dest_dy * WIDTH * 4;\r\n            var destEnd = (dest_dy + minimapLineHeight) * WIDTH * 4;\r\n            if (copySourceEnd === sourceStart && copyDestEnd === destStart) {\r\n                // contiguous zone => extend copy request\r\n                copySourceEnd = sourceEnd;\r\n                copyDestEnd = destEnd;\r\n            }\r\n            else {\r\n                if (copySourceStart !== -1) {\r\n                    // flush existing copy request\r\n                    targetData.set(lastTargetData.subarray(copySourceStart, copySourceEnd), copyDestStart);\r\n                    if (dirtyPixel1 === -1 && copySourceStart === 0 && copySourceStart === copyDestStart) {\r\n                        dirtyPixel1 = copySourceEnd;\r\n                    }\r\n                    if (dirtyPixel2 === -1 && copySourceEnd === maxDestPixel && copySourceStart === copyDestStart) {\r\n                        dirtyPixel2 = copySourceStart;\r\n                    }\r\n                }\r\n                copySourceStart = sourceStart;\r\n                copySourceEnd = sourceEnd;\r\n                copyDestStart = destStart;\r\n                copyDestEnd = destEnd;\r\n            }\r\n            needed[lineIndex] = false;\r\n            dest_dy += minimapLineHeight;\r\n        }\r\n        if (copySourceStart !== -1) {\r\n            // flush existing copy request\r\n            targetData.set(lastTargetData.subarray(copySourceStart, copySourceEnd), copyDestStart);\r\n            if (dirtyPixel1 === -1 && copySourceStart === 0 && copySourceStart === copyDestStart) {\r\n                dirtyPixel1 = copySourceEnd;\r\n            }\r\n            if (dirtyPixel2 === -1 && copySourceEnd === maxDestPixel && copySourceStart === copyDestStart) {\r\n                dirtyPixel2 = copySourceStart;\r\n            }\r\n        }\r\n        var dirtyY1 = (dirtyPixel1 === -1 ? -1 : dirtyPixel1 / (WIDTH * 4));\r\n        var dirtyY2 = (dirtyPixel2 === -1 ? -1 : dirtyPixel2 / (WIDTH * 4));\r\n        return [dirtyY1, dirtyY2, needed];\r\n    };\r\n    Minimap._renderLine = function (target, backgroundColor, useLighterFont, renderMinimap, colorTracker, minimapCharRenderer, dy, tabSize, lineData) {\r\n        var content = lineData.content;\r\n        var tokens = lineData.tokens;\r\n        var charWidth = getMinimapCharWidth(renderMinimap);\r\n        var maxDx = target.width - charWidth;\r\n        var dx = 0;\r\n        var charIndex = 0;\r\n        var tabsCharDelta = 0;\r\n        for (var tokenIndex = 0, tokensLen = tokens.getCount(); tokenIndex < tokensLen; tokenIndex++) {\r\n            var tokenEndIndex = tokens.getEndOffset(tokenIndex);\r\n            var tokenColorId = tokens.getForeground(tokenIndex);\r\n            var tokenColor = colorTracker.getColor(tokenColorId);\r\n            for (; charIndex < tokenEndIndex; charIndex++) {\r\n                if (dx > maxDx) {\r\n                    // hit edge of minimap\r\n                    return;\r\n                }\r\n                var charCode = content.charCodeAt(charIndex);\r\n                if (charCode === 9 /* Tab */) {\r\n                    var insertSpacesCount = tabSize - (charIndex + tabsCharDelta) % tabSize;\r\n                    tabsCharDelta += insertSpacesCount - 1;\r\n                    // No need to render anything since tab is invisible\r\n                    dx += insertSpacesCount * charWidth;\r\n                }\r\n                else if (charCode === 32 /* Space */) {\r\n                    // No need to render anything since space is invisible\r\n                    dx += charWidth;\r\n                }\r\n                else {\r\n                    // Render twice for a full width character\r\n                    var count = strings.isFullWidthCharacter(charCode) ? 2 : 1;\r\n                    for (var i = 0; i < count; i++) {\r\n                        if (renderMinimap === 2 /* Large */) {\r\n                            minimapCharRenderer.x2RenderChar(target, dx, dy, charCode, tokenColor, backgroundColor, useLighterFont);\r\n                        }\r\n                        else if (renderMinimap === 1 /* Small */) {\r\n                            minimapCharRenderer.x1RenderChar(target, dx, dy, charCode, tokenColor, backgroundColor, useLighterFont);\r\n                        }\r\n                        else if (renderMinimap === 4 /* LargeBlocks */) {\r\n                            minimapCharRenderer.x2BlockRenderChar(target, dx, dy, tokenColor, backgroundColor, useLighterFont);\r\n                        }\r\n                        else {\r\n                            // RenderMinimap.SmallBlocks\r\n                            minimapCharRenderer.x1BlockRenderChar(target, dx, dy, tokenColor, backgroundColor, useLighterFont);\r\n                        }\r\n                        dx += charWidth;\r\n                        if (dx > maxDx) {\r\n                            // hit edge of minimap\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return Minimap;\r\n}(ViewPart));\r\nexport { Minimap };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var sliderBackground = theme.getColor(scrollbarSliderBackground);\r\n    if (sliderBackground) {\r\n        var halfSliderBackground = sliderBackground.transparent(0.5);\r\n        collector.addRule(\".monaco-editor .minimap-slider, .monaco-editor .minimap-slider .minimap-slider-horizontal { background: \" + halfSliderBackground + \"; }\");\r\n    }\r\n    var sliderHoverBackground = theme.getColor(scrollbarSliderHoverBackground);\r\n    if (sliderHoverBackground) {\r\n        var halfSliderHoverBackground = sliderHoverBackground.transparent(0.5);\r\n        collector.addRule(\".monaco-editor .minimap-slider:hover, .monaco-editor .minimap-slider:hover .minimap-slider-horizontal { background: \" + halfSliderHoverBackground + \"; }\");\r\n    }\r\n    var sliderActiveBackground = theme.getColor(scrollbarSliderActiveBackground);\r\n    if (sliderActiveBackground) {\r\n        var halfSliderActiveBackground = sliderActiveBackground.transparent(0.5);\r\n        collector.addRule(\".monaco-editor .minimap-slider.active, .monaco-editor .minimap-slider.active .minimap-slider-horizontal { background: \" + halfSliderActiveBackground + \"; }\");\r\n    }\r\n    var shadow = theme.getColor(scrollbarShadow);\r\n    if (shadow) {\r\n        collector.addRule(\".monaco-editor .minimap-shadow-visible { box-shadow: \" + shadow + \" -6px 0 6px -6px inset; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './overlayWidgets.css';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\r\nvar ViewOverlayWidgets = /** @class */ (function (_super) {\r\n    __extends(ViewOverlayWidgets, _super);\r\n    function ViewOverlayWidgets(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._widgets = {};\r\n        _this._verticalScrollbarWidth = _this._context.configuration.editor.layoutInfo.verticalScrollbarWidth;\r\n        _this._minimapWidth = _this._context.configuration.editor.layoutInfo.minimapWidth;\r\n        _this._horizontalScrollbarHeight = _this._context.configuration.editor.layoutInfo.horizontalScrollbarHeight;\r\n        _this._editorHeight = _this._context.configuration.editor.layoutInfo.height;\r\n        _this._editorWidth = _this._context.configuration.editor.layoutInfo.width;\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        PartFingerprints.write(_this._domNode, 4 /* OverlayWidgets */);\r\n        _this._domNode.setClassName('overlayWidgets');\r\n        return _this;\r\n    }\r\n    ViewOverlayWidgets.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._widgets = {};\r\n    };\r\n    ViewOverlayWidgets.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    // ---- begin view event handlers\r\n    ViewOverlayWidgets.prototype.onConfigurationChanged = function (e) {\r\n        if (e.layoutInfo) {\r\n            this._verticalScrollbarWidth = this._context.configuration.editor.layoutInfo.verticalScrollbarWidth;\r\n            this._minimapWidth = this._context.configuration.editor.layoutInfo.minimapWidth;\r\n            this._horizontalScrollbarHeight = this._context.configuration.editor.layoutInfo.horizontalScrollbarHeight;\r\n            this._editorHeight = this._context.configuration.editor.layoutInfo.height;\r\n            this._editorWidth = this._context.configuration.editor.layoutInfo.width;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    // ---- end view event handlers\r\n    ViewOverlayWidgets.prototype.addWidget = function (widget) {\r\n        var domNode = createFastDomNode(widget.getDomNode());\r\n        this._widgets[widget.getId()] = {\r\n            widget: widget,\r\n            preference: null,\r\n            domNode: domNode\r\n        };\r\n        // This is sync because a widget wants to be in the dom\r\n        domNode.setPosition('absolute');\r\n        domNode.setAttribute('widgetId', widget.getId());\r\n        this._domNode.appendChild(domNode);\r\n        this.setShouldRender();\r\n    };\r\n    ViewOverlayWidgets.prototype.setWidgetPosition = function (widget, preference) {\r\n        var widgetData = this._widgets[widget.getId()];\r\n        if (widgetData.preference === preference) {\r\n            return false;\r\n        }\r\n        widgetData.preference = preference;\r\n        this.setShouldRender();\r\n        return true;\r\n    };\r\n    ViewOverlayWidgets.prototype.removeWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._widgets.hasOwnProperty(widgetId)) {\r\n            var widgetData = this._widgets[widgetId];\r\n            var domNode = widgetData.domNode.domNode;\r\n            delete this._widgets[widgetId];\r\n            domNode.parentNode.removeChild(domNode);\r\n            this.setShouldRender();\r\n        }\r\n    };\r\n    ViewOverlayWidgets.prototype._renderWidget = function (widgetData) {\r\n        var domNode = widgetData.domNode;\r\n        if (widgetData.preference === null) {\r\n            domNode.unsetTop();\r\n            return;\r\n        }\r\n        if (widgetData.preference === 0 /* TOP_RIGHT_CORNER */) {\r\n            domNode.setTop(0);\r\n            domNode.setRight((2 * this._verticalScrollbarWidth) + this._minimapWidth);\r\n        }\r\n        else if (widgetData.preference === 1 /* BOTTOM_RIGHT_CORNER */) {\r\n            var widgetHeight = domNode.domNode.clientHeight;\r\n            domNode.setTop((this._editorHeight - widgetHeight - 2 * this._horizontalScrollbarHeight));\r\n            domNode.setRight((2 * this._verticalScrollbarWidth) + this._minimapWidth);\r\n        }\r\n        else if (widgetData.preference === 2 /* TOP_CENTER */) {\r\n            domNode.setTop(0);\r\n            domNode.domNode.style.right = '50%';\r\n        }\r\n    };\r\n    ViewOverlayWidgets.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    ViewOverlayWidgets.prototype.render = function (ctx) {\r\n        this._domNode.setWidth(this._editorWidth);\r\n        var keys = Object.keys(this._widgets);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var widgetId = keys[i];\r\n            this._renderWidget(this._widgets[widgetId]);\r\n        }\r\n    };\r\n    return ViewOverlayWidgets;\r\n}(ViewPart));\r\nexport { ViewOverlayWidgets };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { Color } from '../../../../base/common/color.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { TokenizationRegistry } from '../../../common/modes.js';\r\nimport { editorCursorForeground, editorOverviewRulerBorder } from '../../../common/view/editorColorRegistry.js';\r\nvar Settings = /** @class */ (function () {\r\n    function Settings(config, theme) {\r\n        this.lineHeight = config.editor.lineHeight;\r\n        this.pixelRatio = config.editor.pixelRatio;\r\n        this.overviewRulerLanes = config.editor.viewInfo.overviewRulerLanes;\r\n        this.renderBorder = config.editor.viewInfo.overviewRulerBorder;\r\n        var borderColor = theme.getColor(editorOverviewRulerBorder);\r\n        this.borderColor = borderColor ? borderColor.toString() : null;\r\n        this.hideCursor = config.editor.viewInfo.hideCursorInOverviewRuler;\r\n        var cursorColor = theme.getColor(editorCursorForeground);\r\n        this.cursorColor = cursorColor ? cursorColor.transparent(0.7).toString() : null;\r\n        this.themeType = theme.type;\r\n        var minimapEnabled = config.editor.viewInfo.minimap.enabled;\r\n        var minimapSide = config.editor.viewInfo.minimap.side;\r\n        var backgroundColor = (minimapEnabled ? TokenizationRegistry.getDefaultBackground() : null);\r\n        if (backgroundColor === null || minimapSide === 'left') {\r\n            this.backgroundColor = null;\r\n        }\r\n        else {\r\n            this.backgroundColor = Color.Format.CSS.formatHex(backgroundColor);\r\n        }\r\n        var position = config.editor.layoutInfo.overviewRuler;\r\n        this.top = position.top;\r\n        this.right = position.right;\r\n        this.domWidth = position.width;\r\n        this.domHeight = position.height;\r\n        this.canvasWidth = (this.domWidth * this.pixelRatio) | 0;\r\n        this.canvasHeight = (this.domHeight * this.pixelRatio) | 0;\r\n        var _a = this._initLanes(1, this.canvasWidth, this.overviewRulerLanes), x = _a[0], w = _a[1];\r\n        this.x = x;\r\n        this.w = w;\r\n    }\r\n    Settings.prototype._initLanes = function (canvasLeftOffset, canvasWidth, laneCount) {\r\n        var remainingWidth = canvasWidth - canvasLeftOffset;\r\n        if (laneCount >= 3) {\r\n            var leftWidth = Math.floor(remainingWidth / 3);\r\n            var rightWidth = Math.floor(remainingWidth / 3);\r\n            var centerWidth = remainingWidth - leftWidth - rightWidth;\r\n            var leftOffset = canvasLeftOffset;\r\n            var centerOffset = leftOffset + leftWidth;\r\n            var rightOffset = leftOffset + leftWidth + centerWidth;\r\n            return [\r\n                [\r\n                    0,\r\n                    leftOffset,\r\n                    centerOffset,\r\n                    leftOffset,\r\n                    rightOffset,\r\n                    leftOffset,\r\n                    centerOffset,\r\n                    leftOffset,\r\n                ], [\r\n                    0,\r\n                    leftWidth,\r\n                    centerWidth,\r\n                    leftWidth + centerWidth,\r\n                    rightWidth,\r\n                    leftWidth + centerWidth + rightWidth,\r\n                    centerWidth + rightWidth,\r\n                    leftWidth + centerWidth + rightWidth,\r\n                ]\r\n            ];\r\n        }\r\n        else if (laneCount === 2) {\r\n            var leftWidth = Math.floor(remainingWidth / 2);\r\n            var rightWidth = remainingWidth - leftWidth;\r\n            var leftOffset = canvasLeftOffset;\r\n            var rightOffset = leftOffset + leftWidth;\r\n            return [\r\n                [\r\n                    0,\r\n                    leftOffset,\r\n                    leftOffset,\r\n                    leftOffset,\r\n                    rightOffset,\r\n                    leftOffset,\r\n                    leftOffset,\r\n                    leftOffset,\r\n                ], [\r\n                    0,\r\n                    leftWidth,\r\n                    leftWidth,\r\n                    leftWidth,\r\n                    rightWidth,\r\n                    leftWidth + rightWidth,\r\n                    leftWidth + rightWidth,\r\n                    leftWidth + rightWidth,\r\n                ]\r\n            ];\r\n        }\r\n        else {\r\n            var offset = canvasLeftOffset;\r\n            var width = remainingWidth;\r\n            return [\r\n                [\r\n                    0,\r\n                    offset,\r\n                    offset,\r\n                    offset,\r\n                    offset,\r\n                    offset,\r\n                    offset,\r\n                    offset,\r\n                ], [\r\n                    0,\r\n                    width,\r\n                    width,\r\n                    width,\r\n                    width,\r\n                    width,\r\n                    width,\r\n                    width,\r\n                ]\r\n            ];\r\n        }\r\n    };\r\n    Settings.prototype.equals = function (other) {\r\n        return (this.lineHeight === other.lineHeight\r\n            && this.pixelRatio === other.pixelRatio\r\n            && this.overviewRulerLanes === other.overviewRulerLanes\r\n            && this.renderBorder === other.renderBorder\r\n            && this.borderColor === other.borderColor\r\n            && this.hideCursor === other.hideCursor\r\n            && this.cursorColor === other.cursorColor\r\n            && this.themeType === other.themeType\r\n            && this.backgroundColor === other.backgroundColor\r\n            && this.top === other.top\r\n            && this.right === other.right\r\n            && this.domWidth === other.domWidth\r\n            && this.domHeight === other.domHeight\r\n            && this.canvasWidth === other.canvasWidth\r\n            && this.canvasHeight === other.canvasHeight);\r\n    };\r\n    return Settings;\r\n}());\r\nvar DecorationsOverviewRuler = /** @class */ (function (_super) {\r\n    __extends(DecorationsOverviewRuler, _super);\r\n    function DecorationsOverviewRuler(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._domNode = createFastDomNode(document.createElement('canvas'));\r\n        _this._domNode.setClassName('decorationsOverviewRuler');\r\n        _this._domNode.setPosition('absolute');\r\n        _this._domNode.setLayerHinting(true);\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._updateSettings(false);\r\n        _this._tokensColorTrackerListener = TokenizationRegistry.onDidChange(function (e) {\r\n            if (e.changedColorMap) {\r\n                _this._updateSettings(true);\r\n            }\r\n        });\r\n        _this._cursorPositions = [];\r\n        return _this;\r\n    }\r\n    DecorationsOverviewRuler.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._tokensColorTrackerListener.dispose();\r\n    };\r\n    DecorationsOverviewRuler.prototype._updateSettings = function (renderNow) {\r\n        var newSettings = new Settings(this._context.configuration, this._context.theme);\r\n        if (this._settings && this._settings.equals(newSettings)) {\r\n            // nothing to do\r\n            return false;\r\n        }\r\n        this._settings = newSettings;\r\n        this._domNode.setTop(this._settings.top);\r\n        this._domNode.setRight(this._settings.right);\r\n        this._domNode.setWidth(this._settings.domWidth);\r\n        this._domNode.setHeight(this._settings.domHeight);\r\n        this._domNode.domNode.width = this._settings.canvasWidth;\r\n        this._domNode.domNode.height = this._settings.canvasHeight;\r\n        if (renderNow) {\r\n            this._render();\r\n        }\r\n        return true;\r\n    };\r\n    // ---- begin view event handlers\r\n    DecorationsOverviewRuler.prototype.onConfigurationChanged = function (e) {\r\n        return this._updateSettings(false);\r\n    };\r\n    DecorationsOverviewRuler.prototype.onCursorStateChanged = function (e) {\r\n        this._cursorPositions = [];\r\n        for (var i = 0, len = e.selections.length; i < len; i++) {\r\n            this._cursorPositions[i] = e.selections[i].getPosition();\r\n        }\r\n        this._cursorPositions.sort(Position.compare);\r\n        return true;\r\n    };\r\n    DecorationsOverviewRuler.prototype.onDecorationsChanged = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverviewRuler.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverviewRuler.prototype.onScrollChanged = function (e) {\r\n        return e.scrollHeightChanged;\r\n    };\r\n    DecorationsOverviewRuler.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverviewRuler.prototype.onThemeChanged = function (e) {\r\n        // invalidate color cache\r\n        this._context.model.invalidateOverviewRulerColorCache();\r\n        return this._updateSettings(false);\r\n    };\r\n    // ---- end view event handlers\r\n    DecorationsOverviewRuler.prototype.getDomNode = function () {\r\n        return this._domNode.domNode;\r\n    };\r\n    DecorationsOverviewRuler.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    DecorationsOverviewRuler.prototype.render = function (editorCtx) {\r\n        this._render();\r\n    };\r\n    DecorationsOverviewRuler.prototype._render = function () {\r\n        var canvasWidth = this._settings.canvasWidth;\r\n        var canvasHeight = this._settings.canvasHeight;\r\n        var lineHeight = this._settings.lineHeight;\r\n        var viewLayout = this._context.viewLayout;\r\n        var outerHeight = this._context.viewLayout.getScrollHeight();\r\n        var heightRatio = canvasHeight / outerHeight;\r\n        var decorations = this._context.model.getAllOverviewRulerDecorations(this._context.theme);\r\n        var minDecorationHeight = (6 /* MIN_DECORATION_HEIGHT */ * this._settings.pixelRatio) | 0;\r\n        var halfMinDecorationHeight = (minDecorationHeight / 2) | 0;\r\n        var canvasCtx = this._domNode.domNode.getContext('2d');\r\n        if (this._settings.backgroundColor === null) {\r\n            canvasCtx.clearRect(0, 0, canvasWidth, canvasHeight);\r\n        }\r\n        else {\r\n            canvasCtx.fillStyle = this._settings.backgroundColor;\r\n            canvasCtx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n        }\r\n        var x = this._settings.x;\r\n        var w = this._settings.w;\r\n        // Avoid flickering by always rendering the colors in the same order\r\n        // colors that don't use transparency will be sorted last (they start with #)\r\n        var colors = Object.keys(decorations);\r\n        colors.sort();\r\n        for (var cIndex = 0, cLen = colors.length; cIndex < cLen; cIndex++) {\r\n            var color = colors[cIndex];\r\n            var colorDecorations = decorations[color];\r\n            canvasCtx.fillStyle = color;\r\n            var prevLane = 0;\r\n            var prevY1 = 0;\r\n            var prevY2 = 0;\r\n            for (var i = 0, len = colorDecorations.length; i < len; i++) {\r\n                var lane = colorDecorations[3 * i];\r\n                var startLineNumber = colorDecorations[3 * i + 1];\r\n                var endLineNumber = colorDecorations[3 * i + 2];\r\n                var y1 = (viewLayout.getVerticalOffsetForLineNumber(startLineNumber) * heightRatio) | 0;\r\n                var y2 = ((viewLayout.getVerticalOffsetForLineNumber(endLineNumber) + lineHeight) * heightRatio) | 0;\r\n                var height = y2 - y1;\r\n                if (height < minDecorationHeight) {\r\n                    var yCenter = ((y1 + y2) / 2) | 0;\r\n                    if (yCenter < halfMinDecorationHeight) {\r\n                        yCenter = halfMinDecorationHeight;\r\n                    }\r\n                    else if (yCenter + halfMinDecorationHeight > canvasHeight) {\r\n                        yCenter = canvasHeight - halfMinDecorationHeight;\r\n                    }\r\n                    y1 = yCenter - halfMinDecorationHeight;\r\n                    y2 = yCenter + halfMinDecorationHeight;\r\n                }\r\n                if (y1 > prevY2 + 1 || lane !== prevLane) {\r\n                    // flush prev\r\n                    if (i !== 0) {\r\n                        canvasCtx.fillRect(x[prevLane], prevY1, w[prevLane], prevY2 - prevY1);\r\n                    }\r\n                    prevLane = lane;\r\n                    prevY1 = y1;\r\n                    prevY2 = y2;\r\n                }\r\n                else {\r\n                    // merge into prev\r\n                    if (y2 > prevY2) {\r\n                        prevY2 = y2;\r\n                    }\r\n                }\r\n            }\r\n            canvasCtx.fillRect(x[prevLane], prevY1, w[prevLane], prevY2 - prevY1);\r\n        }\r\n        // Draw cursors\r\n        if (!this._settings.hideCursor && this._settings.cursorColor) {\r\n            var cursorHeight = (2 * this._settings.pixelRatio) | 0;\r\n            var halfCursorHeight = (cursorHeight / 2) | 0;\r\n            var cursorX = this._settings.x[7 /* Full */];\r\n            var cursorW = this._settings.w[7 /* Full */];\r\n            canvasCtx.fillStyle = this._settings.cursorColor;\r\n            var prevY1 = -100;\r\n            var prevY2 = -100;\r\n            for (var i = 0, len = this._cursorPositions.length; i < len; i++) {\r\n                var cursor = this._cursorPositions[i];\r\n                var yCenter = (viewLayout.getVerticalOffsetForLineNumber(cursor.lineNumber) * heightRatio) | 0;\r\n                if (yCenter < halfCursorHeight) {\r\n                    yCenter = halfCursorHeight;\r\n                }\r\n                else if (yCenter + halfCursorHeight > canvasHeight) {\r\n                    yCenter = canvasHeight - halfCursorHeight;\r\n                }\r\n                var y1 = yCenter - halfCursorHeight;\r\n                var y2 = y1 + cursorHeight;\r\n                if (y1 > prevY2 + 1) {\r\n                    // flush prev\r\n                    if (i !== 0) {\r\n                        canvasCtx.fillRect(cursorX, prevY1, cursorW, prevY2 - prevY1);\r\n                    }\r\n                    prevY1 = y1;\r\n                    prevY2 = y2;\r\n                }\r\n                else {\r\n                    // merge into prev\r\n                    if (y2 > prevY2) {\r\n                        prevY2 = y2;\r\n                    }\r\n                }\r\n            }\r\n            canvasCtx.fillRect(cursorX, prevY1, cursorW, prevY2 - prevY1);\r\n        }\r\n        if (this._settings.renderBorder && this._settings.borderColor && this._settings.overviewRulerLanes > 0) {\r\n            canvasCtx.beginPath();\r\n            canvasCtx.lineWidth = 1;\r\n            canvasCtx.strokeStyle = this._settings.borderColor;\r\n            canvasCtx.moveTo(0, 0);\r\n            canvasCtx.lineTo(0, canvasHeight);\r\n            canvasCtx.stroke();\r\n            canvasCtx.moveTo(0, 0);\r\n            canvasCtx.lineTo(canvasWidth, 0);\r\n            canvasCtx.stroke();\r\n        }\r\n    };\r\n    return DecorationsOverviewRuler;\r\n}(ViewPart));\r\nexport { DecorationsOverviewRuler };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar ColorZone = /** @class */ (function () {\r\n    function ColorZone(from, to, colorId) {\r\n        this.from = from | 0;\r\n        this.to = to | 0;\r\n        this.colorId = colorId | 0;\r\n    }\r\n    ColorZone.compare = function (a, b) {\r\n        if (a.colorId === b.colorId) {\r\n            if (a.from === b.from) {\r\n                return a.to - b.to;\r\n            }\r\n            return a.from - b.from;\r\n        }\r\n        return a.colorId - b.colorId;\r\n    };\r\n    return ColorZone;\r\n}());\r\nexport { ColorZone };\r\n/**\r\n * A zone in the overview ruler\r\n */\r\nvar OverviewRulerZone = /** @class */ (function () {\r\n    function OverviewRulerZone(startLineNumber, endLineNumber, color) {\r\n        this.startLineNumber = startLineNumber;\r\n        this.endLineNumber = endLineNumber;\r\n        this.color = color;\r\n        this._colorZone = null;\r\n    }\r\n    OverviewRulerZone.compare = function (a, b) {\r\n        if (a.color === b.color) {\r\n            if (a.startLineNumber === b.startLineNumber) {\r\n                return a.endLineNumber - b.endLineNumber;\r\n            }\r\n            return a.startLineNumber - b.startLineNumber;\r\n        }\r\n        return a.color < b.color ? -1 : 1;\r\n    };\r\n    OverviewRulerZone.prototype.setColorZone = function (colorZone) {\r\n        this._colorZone = colorZone;\r\n    };\r\n    OverviewRulerZone.prototype.getColorZones = function () {\r\n        return this._colorZone;\r\n    };\r\n    return OverviewRulerZone;\r\n}());\r\nexport { OverviewRulerZone };\r\nvar OverviewZoneManager = /** @class */ (function () {\r\n    function OverviewZoneManager(getVerticalOffsetForLine) {\r\n        this._getVerticalOffsetForLine = getVerticalOffsetForLine;\r\n        this._zones = [];\r\n        this._colorZonesInvalid = false;\r\n        this._lineHeight = 0;\r\n        this._domWidth = 0;\r\n        this._domHeight = 0;\r\n        this._outerHeight = 0;\r\n        this._pixelRatio = 1;\r\n        this._lastAssignedId = 0;\r\n        this._color2Id = Object.create(null);\r\n        this._id2Color = [];\r\n    }\r\n    OverviewZoneManager.prototype.getId2Color = function () {\r\n        return this._id2Color;\r\n    };\r\n    OverviewZoneManager.prototype.setZones = function (newZones) {\r\n        this._zones = newZones;\r\n        this._zones.sort(OverviewRulerZone.compare);\r\n    };\r\n    OverviewZoneManager.prototype.setLineHeight = function (lineHeight) {\r\n        if (this._lineHeight === lineHeight) {\r\n            return false;\r\n        }\r\n        this._lineHeight = lineHeight;\r\n        this._colorZonesInvalid = true;\r\n        return true;\r\n    };\r\n    OverviewZoneManager.prototype.setPixelRatio = function (pixelRatio) {\r\n        this._pixelRatio = pixelRatio;\r\n        this._colorZonesInvalid = true;\r\n    };\r\n    OverviewZoneManager.prototype.getDOMWidth = function () {\r\n        return this._domWidth;\r\n    };\r\n    OverviewZoneManager.prototype.getCanvasWidth = function () {\r\n        return this._domWidth * this._pixelRatio;\r\n    };\r\n    OverviewZoneManager.prototype.setDOMWidth = function (width) {\r\n        if (this._domWidth === width) {\r\n            return false;\r\n        }\r\n        this._domWidth = width;\r\n        this._colorZonesInvalid = true;\r\n        return true;\r\n    };\r\n    OverviewZoneManager.prototype.getDOMHeight = function () {\r\n        return this._domHeight;\r\n    };\r\n    OverviewZoneManager.prototype.getCanvasHeight = function () {\r\n        return this._domHeight * this._pixelRatio;\r\n    };\r\n    OverviewZoneManager.prototype.setDOMHeight = function (height) {\r\n        if (this._domHeight === height) {\r\n            return false;\r\n        }\r\n        this._domHeight = height;\r\n        this._colorZonesInvalid = true;\r\n        return true;\r\n    };\r\n    OverviewZoneManager.prototype.getOuterHeight = function () {\r\n        return this._outerHeight;\r\n    };\r\n    OverviewZoneManager.prototype.setOuterHeight = function (outerHeight) {\r\n        if (this._outerHeight === outerHeight) {\r\n            return false;\r\n        }\r\n        this._outerHeight = outerHeight;\r\n        this._colorZonesInvalid = true;\r\n        return true;\r\n    };\r\n    OverviewZoneManager.prototype.resolveColorZones = function () {\r\n        var colorZonesInvalid = this._colorZonesInvalid;\r\n        var lineHeight = Math.floor(this._lineHeight); // @perf\r\n        var totalHeight = Math.floor(this.getCanvasHeight()); // @perf\r\n        var outerHeight = Math.floor(this._outerHeight); // @perf\r\n        var heightRatio = totalHeight / outerHeight;\r\n        var halfMinimumHeight = Math.floor(4 /* MINIMUM_HEIGHT */ * this._pixelRatio / 2);\r\n        var allColorZones = [];\r\n        for (var i = 0, len = this._zones.length; i < len; i++) {\r\n            var zone = this._zones[i];\r\n            if (!colorZonesInvalid) {\r\n                var colorZone_1 = zone.getColorZones();\r\n                if (colorZone_1) {\r\n                    allColorZones.push(colorZone_1);\r\n                    continue;\r\n                }\r\n            }\r\n            var y1 = Math.floor(heightRatio * (this._getVerticalOffsetForLine(zone.startLineNumber)));\r\n            var y2 = Math.floor(heightRatio * (this._getVerticalOffsetForLine(zone.endLineNumber) + lineHeight));\r\n            var ycenter = Math.floor((y1 + y2) / 2);\r\n            var halfHeight = (y2 - ycenter);\r\n            if (halfHeight < halfMinimumHeight) {\r\n                halfHeight = halfMinimumHeight;\r\n            }\r\n            if (ycenter - halfHeight < 0) {\r\n                ycenter = halfHeight;\r\n            }\r\n            if (ycenter + halfHeight > totalHeight) {\r\n                ycenter = totalHeight - halfHeight;\r\n            }\r\n            var color = zone.color;\r\n            var colorId = this._color2Id[color];\r\n            if (!colorId) {\r\n                colorId = (++this._lastAssignedId);\r\n                this._color2Id[color] = colorId;\r\n                this._id2Color[colorId] = color;\r\n            }\r\n            var colorZone = new ColorZone(ycenter - halfHeight, ycenter + halfHeight, colorId);\r\n            zone.setColorZone(colorZone);\r\n            allColorZones.push(colorZone);\r\n        }\r\n        this._colorZonesInvalid = false;\r\n        allColorZones.sort(ColorZone.compare);\r\n        return allColorZones;\r\n    };\r\n    return OverviewZoneManager;\r\n}());\r\nexport { OverviewZoneManager };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { OverviewZoneManager } from '../../../common/view/overviewZoneManager.js';\r\nimport { ViewEventHandler } from '../../../common/viewModel/viewEventHandler.js';\r\nvar OverviewRuler = /** @class */ (function (_super) {\r\n    __extends(OverviewRuler, _super);\r\n    function OverviewRuler(context, cssClassName) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._domNode = createFastDomNode(document.createElement('canvas'));\r\n        _this._domNode.setClassName(cssClassName);\r\n        _this._domNode.setPosition('absolute');\r\n        _this._domNode.setLayerHinting(true);\r\n        _this._zoneManager = new OverviewZoneManager(function (lineNumber) { return _this._context.viewLayout.getVerticalOffsetForLineNumber(lineNumber); });\r\n        _this._zoneManager.setDOMWidth(0);\r\n        _this._zoneManager.setDOMHeight(0);\r\n        _this._zoneManager.setOuterHeight(_this._context.viewLayout.getScrollHeight());\r\n        _this._zoneManager.setLineHeight(_this._context.configuration.editor.lineHeight);\r\n        _this._zoneManager.setPixelRatio(_this._context.configuration.editor.pixelRatio);\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    OverviewRuler.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // ---- begin view event handlers\r\n    OverviewRuler.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._zoneManager.setLineHeight(this._context.configuration.editor.lineHeight);\r\n            this._render();\r\n        }\r\n        if (e.pixelRatio) {\r\n            this._zoneManager.setPixelRatio(this._context.configuration.editor.pixelRatio);\r\n            this._domNode.setWidth(this._zoneManager.getDOMWidth());\r\n            this._domNode.setHeight(this._zoneManager.getDOMHeight());\r\n            this._domNode.domNode.width = this._zoneManager.getCanvasWidth();\r\n            this._domNode.domNode.height = this._zoneManager.getCanvasHeight();\r\n            this._render();\r\n        }\r\n        return true;\r\n    };\r\n    OverviewRuler.prototype.onFlushed = function (e) {\r\n        this._render();\r\n        return true;\r\n    };\r\n    OverviewRuler.prototype.onScrollChanged = function (e) {\r\n        if (e.scrollHeightChanged) {\r\n            this._zoneManager.setOuterHeight(e.scrollHeight);\r\n            this._render();\r\n        }\r\n        return true;\r\n    };\r\n    OverviewRuler.prototype.onZonesChanged = function (e) {\r\n        this._render();\r\n        return true;\r\n    };\r\n    // ---- end view event handlers\r\n    OverviewRuler.prototype.getDomNode = function () {\r\n        return this._domNode.domNode;\r\n    };\r\n    OverviewRuler.prototype.setLayout = function (position) {\r\n        this._domNode.setTop(position.top);\r\n        this._domNode.setRight(position.right);\r\n        var hasChanged = false;\r\n        hasChanged = this._zoneManager.setDOMWidth(position.width) || hasChanged;\r\n        hasChanged = this._zoneManager.setDOMHeight(position.height) || hasChanged;\r\n        if (hasChanged) {\r\n            this._domNode.setWidth(this._zoneManager.getDOMWidth());\r\n            this._domNode.setHeight(this._zoneManager.getDOMHeight());\r\n            this._domNode.domNode.width = this._zoneManager.getCanvasWidth();\r\n            this._domNode.domNode.height = this._zoneManager.getCanvasHeight();\r\n            this._render();\r\n        }\r\n    };\r\n    OverviewRuler.prototype.setZones = function (zones) {\r\n        this._zoneManager.setZones(zones);\r\n        this._render();\r\n    };\r\n    OverviewRuler.prototype._render = function () {\r\n        if (this._zoneManager.getOuterHeight() === 0) {\r\n            return false;\r\n        }\r\n        var width = this._zoneManager.getCanvasWidth();\r\n        var height = this._zoneManager.getCanvasHeight();\r\n        var colorZones = this._zoneManager.resolveColorZones();\r\n        var id2Color = this._zoneManager.getId2Color();\r\n        var ctx = this._domNode.domNode.getContext('2d');\r\n        ctx.clearRect(0, 0, width, height);\r\n        if (colorZones.length > 0) {\r\n            this._renderOneLane(ctx, colorZones, id2Color, width);\r\n        }\r\n        return true;\r\n    };\r\n    OverviewRuler.prototype._renderOneLane = function (ctx, colorZones, id2Color, width) {\r\n        var currentColorId = 0;\r\n        var currentFrom = 0;\r\n        var currentTo = 0;\r\n        for (var i = 0, len = colorZones.length; i < len; i++) {\r\n            var zone = colorZones[i];\r\n            var zoneColorId = zone.colorId;\r\n            var zoneFrom = zone.from;\r\n            var zoneTo = zone.to;\r\n            if (zoneColorId !== currentColorId) {\r\n                ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\r\n                currentColorId = zoneColorId;\r\n                ctx.fillStyle = id2Color[currentColorId];\r\n                currentFrom = zoneFrom;\r\n                currentTo = zoneTo;\r\n            }\r\n            else {\r\n                if (currentTo >= zoneFrom) {\r\n                    currentTo = Math.max(currentTo, zoneTo);\r\n                }\r\n                else {\r\n                    ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\r\n                    currentFrom = zoneFrom;\r\n                    currentTo = zoneTo;\r\n                }\r\n            }\r\n        }\r\n        ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\r\n    };\r\n    return OverviewRuler;\r\n}(ViewEventHandler));\r\nexport { OverviewRuler };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './rulers.css';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { editorRuler } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar Rulers = /** @class */ (function (_super) {\r\n    __extends(Rulers, _super);\r\n    function Rulers(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this.domNode = createFastDomNode(document.createElement('div'));\r\n        _this.domNode.setAttribute('role', 'presentation');\r\n        _this.domNode.setAttribute('aria-hidden', 'true');\r\n        _this.domNode.setClassName('view-rulers');\r\n        _this._renderedRulers = [];\r\n        _this._rulers = _this._context.configuration.editor.viewInfo.rulers;\r\n        _this._typicalHalfwidthCharacterWidth = _this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n        return _this;\r\n    }\r\n    Rulers.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    Rulers.prototype.onConfigurationChanged = function (e) {\r\n        if (e.viewInfo || e.layoutInfo || e.fontInfo) {\r\n            this._rulers = this._context.configuration.editor.viewInfo.rulers;\r\n            this._typicalHalfwidthCharacterWidth = this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Rulers.prototype.onScrollChanged = function (e) {\r\n        return e.scrollHeightChanged;\r\n    };\r\n    // --- end event handlers\r\n    Rulers.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    Rulers.prototype._ensureRulersCount = function () {\r\n        var currentCount = this._renderedRulers.length;\r\n        var desiredCount = this._rulers.length;\r\n        if (currentCount === desiredCount) {\r\n            // Nothing to do\r\n            return;\r\n        }\r\n        if (currentCount < desiredCount) {\r\n            var rulerWidth = this._context.model.getTabSize();\r\n            var addCount = desiredCount - currentCount;\r\n            while (addCount > 0) {\r\n                var node = createFastDomNode(document.createElement('div'));\r\n                node.setClassName('view-ruler');\r\n                node.setWidth(rulerWidth);\r\n                this.domNode.appendChild(node);\r\n                this._renderedRulers.push(node);\r\n                addCount--;\r\n            }\r\n            return;\r\n        }\r\n        var removeCount = currentCount - desiredCount;\r\n        while (removeCount > 0) {\r\n            var node = this._renderedRulers.pop();\r\n            this.domNode.removeChild(node);\r\n            removeCount--;\r\n        }\r\n    };\r\n    Rulers.prototype.render = function (ctx) {\r\n        this._ensureRulersCount();\r\n        for (var i = 0, len = this._rulers.length; i < len; i++) {\r\n            var node = this._renderedRulers[i];\r\n            node.setHeight(Math.min(ctx.scrollHeight, 1000000));\r\n            node.setLeft(this._rulers[i] * this._typicalHalfwidthCharacterWidth);\r\n        }\r\n    };\r\n    return Rulers;\r\n}(ViewPart));\r\nexport { Rulers };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var rulerColor = theme.getColor(editorRuler);\r\n    if (rulerColor) {\r\n        collector.addRule(\".monaco-editor .view-ruler { box-shadow: 1px 0 0 0 \" + rulerColor + \" inset; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './scrollDecoration.css';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { scrollbarShadow } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar ScrollDecorationViewPart = /** @class */ (function (_super) {\r\n    __extends(ScrollDecorationViewPart, _super);\r\n    function ScrollDecorationViewPart(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._scrollTop = 0;\r\n        _this._width = 0;\r\n        _this._updateWidth();\r\n        _this._shouldShow = false;\r\n        _this._useShadows = _this._context.configuration.editor.viewInfo.scrollbar.useShadows;\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        return _this;\r\n    }\r\n    ScrollDecorationViewPart.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ScrollDecorationViewPart.prototype._updateShouldShow = function () {\r\n        var newShouldShow = (this._useShadows && this._scrollTop > 0);\r\n        if (this._shouldShow !== newShouldShow) {\r\n            this._shouldShow = newShouldShow;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ScrollDecorationViewPart.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    ScrollDecorationViewPart.prototype._updateWidth = function () {\r\n        var layoutInfo = this._context.configuration.editor.layoutInfo;\r\n        var newWidth = 0;\r\n        if (layoutInfo.renderMinimap === 0 || (layoutInfo.minimapWidth > 0 && layoutInfo.minimapLeft === 0)) {\r\n            newWidth = layoutInfo.width;\r\n        }\r\n        else {\r\n            newWidth = layoutInfo.width - layoutInfo.minimapWidth - layoutInfo.verticalScrollbarWidth;\r\n        }\r\n        if (this._width !== newWidth) {\r\n            this._width = newWidth;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    // --- begin event handlers\r\n    ScrollDecorationViewPart.prototype.onConfigurationChanged = function (e) {\r\n        var shouldRender = false;\r\n        if (e.viewInfo) {\r\n            this._useShadows = this._context.configuration.editor.viewInfo.scrollbar.useShadows;\r\n        }\r\n        if (e.layoutInfo) {\r\n            shouldRender = this._updateWidth();\r\n        }\r\n        return this._updateShouldShow() || shouldRender;\r\n    };\r\n    ScrollDecorationViewPart.prototype.onScrollChanged = function (e) {\r\n        this._scrollTop = e.scrollTop;\r\n        return this._updateShouldShow();\r\n    };\r\n    // --- end event handlers\r\n    ScrollDecorationViewPart.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    ScrollDecorationViewPart.prototype.render = function (ctx) {\r\n        this._domNode.setWidth(this._width);\r\n        this._domNode.setClassName(this._shouldShow ? 'scroll-decoration' : '');\r\n    };\r\n    return ScrollDecorationViewPart;\r\n}(ViewPart));\r\nexport { ScrollDecorationViewPart };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var shadow = theme.getColor(scrollbarShadow);\r\n    if (shadow) {\r\n        collector.addRule(\".monaco-editor .scroll-decoration { box-shadow: \" + shadow + \" 0 6px 6px -6px inset; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './selections.css';\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { editorInactiveSelection, editorSelectionBackground, editorSelectionForeground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar HorizontalRangeWithStyle = /** @class */ (function () {\r\n    function HorizontalRangeWithStyle(other) {\r\n        this.left = other.left;\r\n        this.width = other.width;\r\n        this.startStyle = null;\r\n        this.endStyle = null;\r\n    }\r\n    return HorizontalRangeWithStyle;\r\n}());\r\nvar LineVisibleRangesWithStyle = /** @class */ (function () {\r\n    function LineVisibleRangesWithStyle(lineNumber, ranges) {\r\n        this.lineNumber = lineNumber;\r\n        this.ranges = ranges;\r\n    }\r\n    return LineVisibleRangesWithStyle;\r\n}());\r\nfunction toStyledRange(item) {\r\n    return new HorizontalRangeWithStyle(item);\r\n}\r\nfunction toStyled(item) {\r\n    return new LineVisibleRangesWithStyle(item.lineNumber, item.ranges.map(toStyledRange));\r\n}\r\n// TODO@Alex: Remove this once IE11 fixes Bug #524217\r\n// The problem in IE11 is that it does some sort of auto-zooming to accomodate for displays with different pixel density.\r\n// Unfortunately, this auto-zooming is buggy around dealing with rounded borders\r\nvar isIEWithZoomingIssuesNearRoundedBorders = browser.isEdgeOrIE;\r\nvar SelectionsOverlay = /** @class */ (function (_super) {\r\n    __extends(SelectionsOverlay, _super);\r\n    function SelectionsOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._previousFrameVisibleRangesWithStyle = [];\r\n        _this._context = context;\r\n        _this._lineHeight = _this._context.configuration.editor.lineHeight;\r\n        _this._roundedSelection = _this._context.configuration.editor.viewInfo.roundedSelection;\r\n        _this._typicalHalfwidthCharacterWidth = _this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n        _this._selections = [];\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    SelectionsOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    SelectionsOverlay.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._lineHeight = this._context.configuration.editor.lineHeight;\r\n        }\r\n        if (e.viewInfo) {\r\n            this._roundedSelection = this._context.configuration.editor.viewInfo.roundedSelection;\r\n        }\r\n        if (e.fontInfo) {\r\n            this._typicalHalfwidthCharacterWidth = this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n        }\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onCursorStateChanged = function (e) {\r\n        this._selections = e.selections.slice(0);\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onDecorationsChanged = function (e) {\r\n        // true for inline decorations that can end up relayouting text\r\n        return true; //e.inlineDecorationsChanged;\r\n    };\r\n    SelectionsOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged;\r\n    };\r\n    SelectionsOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    SelectionsOverlay.prototype._visibleRangesHaveGaps = function (linesVisibleRanges) {\r\n        for (var i = 0, len = linesVisibleRanges.length; i < len; i++) {\r\n            var lineVisibleRanges = linesVisibleRanges[i];\r\n            if (lineVisibleRanges.ranges.length > 1) {\r\n                // There are two ranges on the same line\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    SelectionsOverlay.prototype._enrichVisibleRangesWithStyle = function (viewport, linesVisibleRanges, previousFrame) {\r\n        var epsilon = this._typicalHalfwidthCharacterWidth / 4;\r\n        var previousFrameTop = null;\r\n        var previousFrameBottom = null;\r\n        if (previousFrame && previousFrame.length > 0 && linesVisibleRanges.length > 0) {\r\n            var topLineNumber = linesVisibleRanges[0].lineNumber;\r\n            if (topLineNumber === viewport.startLineNumber) {\r\n                for (var i = 0; !previousFrameTop && i < previousFrame.length; i++) {\r\n                    if (previousFrame[i].lineNumber === topLineNumber) {\r\n                        previousFrameTop = previousFrame[i].ranges[0];\r\n                    }\r\n                }\r\n            }\r\n            var bottomLineNumber = linesVisibleRanges[linesVisibleRanges.length - 1].lineNumber;\r\n            if (bottomLineNumber === viewport.endLineNumber) {\r\n                for (var i = previousFrame.length - 1; !previousFrameBottom && i >= 0; i--) {\r\n                    if (previousFrame[i].lineNumber === bottomLineNumber) {\r\n                        previousFrameBottom = previousFrame[i].ranges[0];\r\n                    }\r\n                }\r\n            }\r\n            if (previousFrameTop && !previousFrameTop.startStyle) {\r\n                previousFrameTop = null;\r\n            }\r\n            if (previousFrameBottom && !previousFrameBottom.startStyle) {\r\n                previousFrameBottom = null;\r\n            }\r\n        }\r\n        for (var i = 0, len = linesVisibleRanges.length; i < len; i++) {\r\n            // We know for a fact that there is precisely one range on each line\r\n            var curLineRange = linesVisibleRanges[i].ranges[0];\r\n            var curLeft = curLineRange.left;\r\n            var curRight = curLineRange.left + curLineRange.width;\r\n            var startStyle = {\r\n                top: 0 /* EXTERN */,\r\n                bottom: 0 /* EXTERN */\r\n            };\r\n            var endStyle = {\r\n                top: 0 /* EXTERN */,\r\n                bottom: 0 /* EXTERN */\r\n            };\r\n            if (i > 0) {\r\n                // Look above\r\n                var prevLeft = linesVisibleRanges[i - 1].ranges[0].left;\r\n                var prevRight = linesVisibleRanges[i - 1].ranges[0].left + linesVisibleRanges[i - 1].ranges[0].width;\r\n                if (abs(curLeft - prevLeft) < epsilon) {\r\n                    startStyle.top = 2 /* FLAT */;\r\n                }\r\n                else if (curLeft > prevLeft) {\r\n                    startStyle.top = 1 /* INTERN */;\r\n                }\r\n                if (abs(curRight - prevRight) < epsilon) {\r\n                    endStyle.top = 2 /* FLAT */;\r\n                }\r\n                else if (prevLeft < curRight && curRight < prevRight) {\r\n                    endStyle.top = 1 /* INTERN */;\r\n                }\r\n            }\r\n            else if (previousFrameTop) {\r\n                // Accept some hick-ups near the viewport edges to save on repaints\r\n                startStyle.top = previousFrameTop.startStyle.top;\r\n                endStyle.top = previousFrameTop.endStyle.top;\r\n            }\r\n            if (i + 1 < len) {\r\n                // Look below\r\n                var nextLeft = linesVisibleRanges[i + 1].ranges[0].left;\r\n                var nextRight = linesVisibleRanges[i + 1].ranges[0].left + linesVisibleRanges[i + 1].ranges[0].width;\r\n                if (abs(curLeft - nextLeft) < epsilon) {\r\n                    startStyle.bottom = 2 /* FLAT */;\r\n                }\r\n                else if (nextLeft < curLeft && curLeft < nextRight) {\r\n                    startStyle.bottom = 1 /* INTERN */;\r\n                }\r\n                if (abs(curRight - nextRight) < epsilon) {\r\n                    endStyle.bottom = 2 /* FLAT */;\r\n                }\r\n                else if (curRight < nextRight) {\r\n                    endStyle.bottom = 1 /* INTERN */;\r\n                }\r\n            }\r\n            else if (previousFrameBottom) {\r\n                // Accept some hick-ups near the viewport edges to save on repaints\r\n                startStyle.bottom = previousFrameBottom.startStyle.bottom;\r\n                endStyle.bottom = previousFrameBottom.endStyle.bottom;\r\n            }\r\n            curLineRange.startStyle = startStyle;\r\n            curLineRange.endStyle = endStyle;\r\n        }\r\n    };\r\n    SelectionsOverlay.prototype._getVisibleRangesWithStyle = function (selection, ctx, previousFrame) {\r\n        var _linesVisibleRanges = ctx.linesVisibleRangesForRange(selection, true) || [];\r\n        var linesVisibleRanges = _linesVisibleRanges.map(toStyled);\r\n        var visibleRangesHaveGaps = this._visibleRangesHaveGaps(linesVisibleRanges);\r\n        if (!isIEWithZoomingIssuesNearRoundedBorders && !visibleRangesHaveGaps && this._roundedSelection) {\r\n            this._enrichVisibleRangesWithStyle(ctx.visibleRange, linesVisibleRanges, previousFrame);\r\n        }\r\n        // The visible ranges are sorted TOP-BOTTOM and LEFT-RIGHT\r\n        return linesVisibleRanges;\r\n    };\r\n    SelectionsOverlay.prototype._createSelectionPiece = function (top, height, className, left, width) {\r\n        return ('<div class=\"cslr '\r\n            + className\r\n            + '\" style=\"top:'\r\n            + top.toString()\r\n            + 'px;left:'\r\n            + left.toString()\r\n            + 'px;width:'\r\n            + width.toString()\r\n            + 'px;height:'\r\n            + height\r\n            + 'px;\"></div>');\r\n    };\r\n    SelectionsOverlay.prototype._actualRenderOneSelection = function (output2, visibleStartLineNumber, hasMultipleSelections, visibleRanges) {\r\n        var visibleRangesHaveStyle = (visibleRanges.length > 0 && visibleRanges[0].ranges[0].startStyle);\r\n        var fullLineHeight = (this._lineHeight).toString();\r\n        var reducedLineHeight = (this._lineHeight - 1).toString();\r\n        var firstLineNumber = (visibleRanges.length > 0 ? visibleRanges[0].lineNumber : 0);\r\n        var lastLineNumber = (visibleRanges.length > 0 ? visibleRanges[visibleRanges.length - 1].lineNumber : 0);\r\n        for (var i = 0, len = visibleRanges.length; i < len; i++) {\r\n            var lineVisibleRanges = visibleRanges[i];\r\n            var lineNumber = lineVisibleRanges.lineNumber;\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            var lineHeight = hasMultipleSelections ? (lineNumber === lastLineNumber || lineNumber === firstLineNumber ? reducedLineHeight : fullLineHeight) : fullLineHeight;\r\n            var top_1 = hasMultipleSelections ? (lineNumber === firstLineNumber ? 1 : 0) : 0;\r\n            var lineOutput = '';\r\n            for (var j = 0, lenJ = lineVisibleRanges.ranges.length; j < lenJ; j++) {\r\n                var visibleRange = lineVisibleRanges.ranges[j];\r\n                if (visibleRangesHaveStyle) {\r\n                    var startStyle = visibleRange.startStyle;\r\n                    var endStyle = visibleRange.endStyle;\r\n                    if (startStyle.top === 1 /* INTERN */ || startStyle.bottom === 1 /* INTERN */) {\r\n                        // Reverse rounded corner to the left\r\n                        // First comes the selection (blue layer)\r\n                        lineOutput += this._createSelectionPiece(top_1, lineHeight, SelectionsOverlay.SELECTION_CLASS_NAME, visibleRange.left - SelectionsOverlay.ROUNDED_PIECE_WIDTH, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\r\n                        // Second comes the background (white layer) with inverse border radius\r\n                        var className_1 = SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;\r\n                        if (startStyle.top === 1 /* INTERN */) {\r\n                            className_1 += ' ' + SelectionsOverlay.SELECTION_TOP_RIGHT;\r\n                        }\r\n                        if (startStyle.bottom === 1 /* INTERN */) {\r\n                            className_1 += ' ' + SelectionsOverlay.SELECTION_BOTTOM_RIGHT;\r\n                        }\r\n                        lineOutput += this._createSelectionPiece(top_1, lineHeight, className_1, visibleRange.left - SelectionsOverlay.ROUNDED_PIECE_WIDTH, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\r\n                    }\r\n                    if (endStyle.top === 1 /* INTERN */ || endStyle.bottom === 1 /* INTERN */) {\r\n                        // Reverse rounded corner to the right\r\n                        // First comes the selection (blue layer)\r\n                        lineOutput += this._createSelectionPiece(top_1, lineHeight, SelectionsOverlay.SELECTION_CLASS_NAME, visibleRange.left + visibleRange.width, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\r\n                        // Second comes the background (white layer) with inverse border radius\r\n                        var className_2 = SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;\r\n                        if (endStyle.top === 1 /* INTERN */) {\r\n                            className_2 += ' ' + SelectionsOverlay.SELECTION_TOP_LEFT;\r\n                        }\r\n                        if (endStyle.bottom === 1 /* INTERN */) {\r\n                            className_2 += ' ' + SelectionsOverlay.SELECTION_BOTTOM_LEFT;\r\n                        }\r\n                        lineOutput += this._createSelectionPiece(top_1, lineHeight, className_2, visibleRange.left + visibleRange.width, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\r\n                    }\r\n                }\r\n                var className = SelectionsOverlay.SELECTION_CLASS_NAME;\r\n                if (visibleRangesHaveStyle) {\r\n                    var startStyle = visibleRange.startStyle;\r\n                    var endStyle = visibleRange.endStyle;\r\n                    if (startStyle.top === 0 /* EXTERN */) {\r\n                        className += ' ' + SelectionsOverlay.SELECTION_TOP_LEFT;\r\n                    }\r\n                    if (startStyle.bottom === 0 /* EXTERN */) {\r\n                        className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_LEFT;\r\n                    }\r\n                    if (endStyle.top === 0 /* EXTERN */) {\r\n                        className += ' ' + SelectionsOverlay.SELECTION_TOP_RIGHT;\r\n                    }\r\n                    if (endStyle.bottom === 0 /* EXTERN */) {\r\n                        className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_RIGHT;\r\n                    }\r\n                }\r\n                lineOutput += this._createSelectionPiece(top_1, lineHeight, className, visibleRange.left, visibleRange.width);\r\n            }\r\n            output2[lineIndex] += lineOutput;\r\n        }\r\n    };\r\n    SelectionsOverlay.prototype.prepareRender = function (ctx) {\r\n        var output = [];\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            output[lineIndex] = '';\r\n        }\r\n        var thisFrameVisibleRangesWithStyle = [];\r\n        for (var i = 0, len = this._selections.length; i < len; i++) {\r\n            var selection = this._selections[i];\r\n            if (selection.isEmpty()) {\r\n                thisFrameVisibleRangesWithStyle[i] = null;\r\n                continue;\r\n            }\r\n            var visibleRangesWithStyle = this._getVisibleRangesWithStyle(selection, ctx, this._previousFrameVisibleRangesWithStyle[i]);\r\n            thisFrameVisibleRangesWithStyle[i] = visibleRangesWithStyle;\r\n            this._actualRenderOneSelection(output, visibleStartLineNumber, this._selections.length > 1, visibleRangesWithStyle);\r\n        }\r\n        this._previousFrameVisibleRangesWithStyle = thisFrameVisibleRangesWithStyle;\r\n        this._renderResult = output;\r\n    };\r\n    SelectionsOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineIndex];\r\n    };\r\n    SelectionsOverlay.SELECTION_CLASS_NAME = 'selected-text';\r\n    SelectionsOverlay.SELECTION_TOP_LEFT = 'top-left-radius';\r\n    SelectionsOverlay.SELECTION_BOTTOM_LEFT = 'bottom-left-radius';\r\n    SelectionsOverlay.SELECTION_TOP_RIGHT = 'top-right-radius';\r\n    SelectionsOverlay.SELECTION_BOTTOM_RIGHT = 'bottom-right-radius';\r\n    SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME = 'monaco-editor-background';\r\n    SelectionsOverlay.ROUNDED_PIECE_WIDTH = 10;\r\n    return SelectionsOverlay;\r\n}(DynamicViewOverlay));\r\nexport { SelectionsOverlay };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var editorSelectionColor = theme.getColor(editorSelectionBackground);\r\n    if (editorSelectionColor) {\r\n        collector.addRule(\".monaco-editor .focused .selected-text { background-color: \" + editorSelectionColor + \"; }\");\r\n    }\r\n    var editorInactiveSelectionColor = theme.getColor(editorInactiveSelection);\r\n    if (editorInactiveSelectionColor) {\r\n        collector.addRule(\".monaco-editor .selected-text { background-color: \" + editorInactiveSelectionColor + \"; }\");\r\n    }\r\n    var editorSelectionForegroundColor = theme.getColor(editorSelectionForeground);\r\n    if (editorSelectionForegroundColor) {\r\n        collector.addRule(\".monaco-editor .view-line span.inline-selected-text { color: \" + editorSelectionForegroundColor + \"; }\");\r\n    }\r\n});\r\nfunction abs(n) {\r\n    return n < 0 ? -n : n;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { Configuration } from '../../config/configuration.js';\r\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nvar ViewCursorRenderData = /** @class */ (function () {\r\n    function ViewCursorRenderData(top, left, width, height, textContent, textContentClassName) {\r\n        this.top = top;\r\n        this.left = left;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.textContent = textContent;\r\n        this.textContentClassName = textContentClassName;\r\n    }\r\n    return ViewCursorRenderData;\r\n}());\r\nvar ViewCursor = /** @class */ (function () {\r\n    function ViewCursor(context) {\r\n        this._context = context;\r\n        this._cursorStyle = this._context.configuration.editor.viewInfo.cursorStyle;\r\n        this._lineHeight = this._context.configuration.editor.lineHeight;\r\n        this._typicalHalfwidthCharacterWidth = this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n        this._lineCursorWidth = Math.min(this._context.configuration.editor.viewInfo.cursorWidth, this._typicalHalfwidthCharacterWidth);\r\n        this._isVisible = true;\r\n        // Create the dom node\r\n        this._domNode = createFastDomNode(document.createElement('div'));\r\n        this._domNode.setClassName('cursor');\r\n        this._domNode.setHeight(this._lineHeight);\r\n        this._domNode.setTop(0);\r\n        this._domNode.setLeft(0);\r\n        Configuration.applyFontInfo(this._domNode, this._context.configuration.editor.fontInfo);\r\n        this._domNode.setDisplay('none');\r\n        this.updatePosition(new Position(1, 1));\r\n        this._lastRenderedContent = '';\r\n        this._renderData = null;\r\n    }\r\n    ViewCursor.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    ViewCursor.prototype.getPosition = function () {\r\n        return this._position;\r\n    };\r\n    ViewCursor.prototype.show = function () {\r\n        if (!this._isVisible) {\r\n            this._domNode.setVisibility('inherit');\r\n            this._isVisible = true;\r\n        }\r\n    };\r\n    ViewCursor.prototype.hide = function () {\r\n        if (this._isVisible) {\r\n            this._domNode.setVisibility('hidden');\r\n            this._isVisible = false;\r\n        }\r\n    };\r\n    ViewCursor.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._lineHeight = this._context.configuration.editor.lineHeight;\r\n        }\r\n        if (e.fontInfo) {\r\n            Configuration.applyFontInfo(this._domNode, this._context.configuration.editor.fontInfo);\r\n            this._typicalHalfwidthCharacterWidth = this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n        }\r\n        if (e.viewInfo) {\r\n            this._cursorStyle = this._context.configuration.editor.viewInfo.cursorStyle;\r\n            this._lineCursorWidth = Math.min(this._context.configuration.editor.viewInfo.cursorWidth, this._typicalHalfwidthCharacterWidth);\r\n        }\r\n        return true;\r\n    };\r\n    ViewCursor.prototype.onCursorPositionChanged = function (position) {\r\n        this.updatePosition(position);\r\n        return true;\r\n    };\r\n    ViewCursor.prototype._prepareRender = function (ctx) {\r\n        var textContent = '';\r\n        var textContentClassName = '';\r\n        if (this._cursorStyle === TextEditorCursorStyle.Line || this._cursorStyle === TextEditorCursorStyle.LineThin) {\r\n            var visibleRange = ctx.visibleRangeForPosition(this._position);\r\n            if (!visibleRange) {\r\n                // Outside viewport\r\n                return null;\r\n            }\r\n            var width_1;\r\n            if (this._cursorStyle === TextEditorCursorStyle.Line) {\r\n                width_1 = dom.computeScreenAwareSize(this._lineCursorWidth > 0 ? this._lineCursorWidth : 2);\r\n                if (width_1 > 2) {\r\n                    var lineContent = this._context.model.getLineContent(this._position.lineNumber);\r\n                    textContent = lineContent.charAt(this._position.column - 1);\r\n                }\r\n            }\r\n            else {\r\n                width_1 = dom.computeScreenAwareSize(1);\r\n            }\r\n            var left = visibleRange.left;\r\n            if (width_1 >= 2 && left >= 1) {\r\n                // try to center cursor\r\n                left -= 1;\r\n            }\r\n            var top_1 = ctx.getVerticalOffsetForLineNumber(this._position.lineNumber) - ctx.bigNumbersDelta;\r\n            return new ViewCursorRenderData(top_1, left, width_1, this._lineHeight, textContent, textContentClassName);\r\n        }\r\n        var visibleRangeForCharacter = ctx.linesVisibleRangesForRange(new Range(this._position.lineNumber, this._position.column, this._position.lineNumber, this._position.column + 1), false);\r\n        if (!visibleRangeForCharacter || visibleRangeForCharacter.length === 0 || visibleRangeForCharacter[0].ranges.length === 0) {\r\n            // Outside viewport\r\n            return null;\r\n        }\r\n        var range = visibleRangeForCharacter[0].ranges[0];\r\n        var width = range.width < 1 ? this._typicalHalfwidthCharacterWidth : range.width;\r\n        if (this._cursorStyle === TextEditorCursorStyle.Block) {\r\n            var lineData = this._context.model.getViewLineData(this._position.lineNumber);\r\n            textContent = lineData.content.charAt(this._position.column - 1);\r\n            if (strings.isHighSurrogate(lineData.content.charCodeAt(this._position.column - 1))) {\r\n                textContent += lineData.content.charAt(this._position.column);\r\n            }\r\n            var tokenIndex = lineData.tokens.findTokenIndexAtOffset(this._position.column - 1);\r\n            textContentClassName = lineData.tokens.getClassName(tokenIndex);\r\n        }\r\n        var top = ctx.getVerticalOffsetForLineNumber(this._position.lineNumber) - ctx.bigNumbersDelta;\r\n        var height = this._lineHeight;\r\n        // Underline might interfere with clicking\r\n        if (this._cursorStyle === TextEditorCursorStyle.Underline || this._cursorStyle === TextEditorCursorStyle.UnderlineThin) {\r\n            top += this._lineHeight - 2;\r\n            height = 2;\r\n        }\r\n        return new ViewCursorRenderData(top, range.left, width, height, textContent, textContentClassName);\r\n    };\r\n    ViewCursor.prototype.prepareRender = function (ctx) {\r\n        this._renderData = this._prepareRender(ctx);\r\n    };\r\n    ViewCursor.prototype.render = function (ctx) {\r\n        if (!this._renderData) {\r\n            this._domNode.setDisplay('none');\r\n            return null;\r\n        }\r\n        if (this._lastRenderedContent !== this._renderData.textContent) {\r\n            this._lastRenderedContent = this._renderData.textContent;\r\n            this._domNode.domNode.textContent = this._lastRenderedContent;\r\n        }\r\n        this._domNode.setClassName('cursor ' + this._renderData.textContentClassName);\r\n        this._domNode.setDisplay('block');\r\n        this._domNode.setTop(this._renderData.top);\r\n        this._domNode.setLeft(this._renderData.left);\r\n        this._domNode.setWidth(this._renderData.width);\r\n        this._domNode.setLineHeight(this._renderData.height);\r\n        this._domNode.setHeight(this._renderData.height);\r\n        return {\r\n            domNode: this._domNode.domNode,\r\n            position: this._position,\r\n            contentLeft: this._renderData.left,\r\n            height: this._renderData.height,\r\n            width: 2\r\n        };\r\n    };\r\n    ViewCursor.prototype.updatePosition = function (newPosition) {\r\n        this._position = newPosition;\r\n    };\r\n    return ViewCursor;\r\n}());\r\nexport { ViewCursor };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './viewCursors.css';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { IntervalTimer, TimeoutTimer } from '../../../../base/common/async.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { ViewCursor } from './viewCursor.js';\r\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\r\nimport { editorCursorBackground, editorCursorForeground } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar ViewCursors = /** @class */ (function (_super) {\r\n    __extends(ViewCursors, _super);\r\n    function ViewCursors(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._readOnly = _this._context.configuration.editor.readOnly;\r\n        _this._cursorBlinking = _this._context.configuration.editor.viewInfo.cursorBlinking;\r\n        _this._cursorStyle = _this._context.configuration.editor.viewInfo.cursorStyle;\r\n        _this._selectionIsEmpty = true;\r\n        _this._primaryCursor = new ViewCursor(_this._context);\r\n        _this._secondaryCursors = [];\r\n        _this._renderData = [];\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._updateDomClassName();\r\n        _this._domNode.appendChild(_this._primaryCursor.getDomNode());\r\n        _this._startCursorBlinkAnimation = new TimeoutTimer();\r\n        _this._cursorFlatBlinkInterval = new IntervalTimer();\r\n        _this._blinkingEnabled = false;\r\n        _this._editorHasFocus = false;\r\n        _this._updateBlinking();\r\n        return _this;\r\n    }\r\n    ViewCursors.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._startCursorBlinkAnimation.dispose();\r\n        this._cursorFlatBlinkInterval.dispose();\r\n    };\r\n    ViewCursors.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    // --- begin event handlers\r\n    ViewCursors.prototype.onConfigurationChanged = function (e) {\r\n        if (e.readOnly) {\r\n            this._readOnly = this._context.configuration.editor.readOnly;\r\n        }\r\n        if (e.viewInfo) {\r\n            this._cursorBlinking = this._context.configuration.editor.viewInfo.cursorBlinking;\r\n            this._cursorStyle = this._context.configuration.editor.viewInfo.cursorStyle;\r\n        }\r\n        this._primaryCursor.onConfigurationChanged(e);\r\n        this._updateBlinking();\r\n        if (e.viewInfo) {\r\n            this._updateDomClassName();\r\n        }\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].onConfigurationChanged(e);\r\n        }\r\n        return true;\r\n    };\r\n    ViewCursors.prototype._onCursorPositionChanged = function (position, secondaryPositions) {\r\n        this._primaryCursor.onCursorPositionChanged(position);\r\n        this._updateBlinking();\r\n        if (this._secondaryCursors.length < secondaryPositions.length) {\r\n            // Create new cursors\r\n            var addCnt = secondaryPositions.length - this._secondaryCursors.length;\r\n            for (var i = 0; i < addCnt; i++) {\r\n                var newCursor = new ViewCursor(this._context);\r\n                this._domNode.domNode.insertBefore(newCursor.getDomNode().domNode, this._primaryCursor.getDomNode().domNode.nextSibling);\r\n                this._secondaryCursors.push(newCursor);\r\n            }\r\n        }\r\n        else if (this._secondaryCursors.length > secondaryPositions.length) {\r\n            // Remove some cursors\r\n            var removeCnt = this._secondaryCursors.length - secondaryPositions.length;\r\n            for (var i = 0; i < removeCnt; i++) {\r\n                this._domNode.removeChild(this._secondaryCursors[0].getDomNode());\r\n                this._secondaryCursors.splice(0, 1);\r\n            }\r\n        }\r\n        for (var i = 0; i < secondaryPositions.length; i++) {\r\n            this._secondaryCursors[i].onCursorPositionChanged(secondaryPositions[i]);\r\n        }\r\n    };\r\n    ViewCursors.prototype.onCursorStateChanged = function (e) {\r\n        var positions = [];\r\n        for (var i = 0, len = e.selections.length; i < len; i++) {\r\n            positions[i] = e.selections[i].getPosition();\r\n        }\r\n        this._onCursorPositionChanged(positions[0], positions.slice(1));\r\n        var selectionIsEmpty = e.selections[0].isEmpty();\r\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\r\n            this._selectionIsEmpty = selectionIsEmpty;\r\n            this._updateDomClassName();\r\n        }\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onDecorationsChanged = function (e) {\r\n        // true for inline decorations that can end up relayouting text\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onFocusChanged = function (e) {\r\n        this._editorHasFocus = e.isFocused;\r\n        this._updateBlinking();\r\n        return false;\r\n    };\r\n    ViewCursors.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onScrollChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onTokensChanged = function (e) {\r\n        var shouldRender = function (position) {\r\n            for (var i = 0, len = e.ranges.length; i < len; i++) {\r\n                if (e.ranges[i].fromLineNumber <= position.lineNumber && position.lineNumber <= e.ranges[i].toLineNumber) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        if (shouldRender(this._primaryCursor.getPosition())) {\r\n            return true;\r\n        }\r\n        for (var i = 0; i < this._secondaryCursors.length; i++) {\r\n            if (shouldRender(this._secondaryCursors[i].getPosition())) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    ViewCursors.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    // ---- blinking logic\r\n    ViewCursors.prototype._getCursorBlinking = function () {\r\n        if (!this._editorHasFocus) {\r\n            return 0 /* Hidden */;\r\n        }\r\n        if (this._readOnly) {\r\n            return 5 /* Solid */;\r\n        }\r\n        return this._cursorBlinking;\r\n    };\r\n    ViewCursors.prototype._updateBlinking = function () {\r\n        var _this = this;\r\n        this._startCursorBlinkAnimation.cancel();\r\n        this._cursorFlatBlinkInterval.cancel();\r\n        var blinkingStyle = this._getCursorBlinking();\r\n        // hidden and solid are special as they involve no animations\r\n        var isHidden = (blinkingStyle === 0 /* Hidden */);\r\n        var isSolid = (blinkingStyle === 5 /* Solid */);\r\n        if (isHidden) {\r\n            this._hide();\r\n        }\r\n        else {\r\n            this._show();\r\n        }\r\n        this._blinkingEnabled = false;\r\n        this._updateDomClassName();\r\n        if (!isHidden && !isSolid) {\r\n            if (blinkingStyle === 1 /* Blink */) {\r\n                // flat blinking is handled by JavaScript to save battery life due to Chromium step timing issue https://bugs.chromium.org/p/chromium/issues/detail?id=361587\r\n                this._cursorFlatBlinkInterval.cancelAndSet(function () {\r\n                    if (_this._isVisible) {\r\n                        _this._hide();\r\n                    }\r\n                    else {\r\n                        _this._show();\r\n                    }\r\n                }, ViewCursors.BLINK_INTERVAL);\r\n            }\r\n            else {\r\n                this._startCursorBlinkAnimation.setIfNotSet(function () {\r\n                    _this._blinkingEnabled = true;\r\n                    _this._updateDomClassName();\r\n                }, ViewCursors.BLINK_INTERVAL);\r\n            }\r\n        }\r\n    };\r\n    // --- end blinking logic\r\n    ViewCursors.prototype._updateDomClassName = function () {\r\n        this._domNode.setClassName(this._getClassName());\r\n    };\r\n    ViewCursors.prototype._getClassName = function () {\r\n        var result = 'cursors-layer';\r\n        if (!this._selectionIsEmpty) {\r\n            result += ' has-selection';\r\n        }\r\n        switch (this._cursorStyle) {\r\n            case TextEditorCursorStyle.Line:\r\n                result += ' cursor-line-style';\r\n                break;\r\n            case TextEditorCursorStyle.Block:\r\n                result += ' cursor-block-style';\r\n                break;\r\n            case TextEditorCursorStyle.Underline:\r\n                result += ' cursor-underline-style';\r\n                break;\r\n            case TextEditorCursorStyle.LineThin:\r\n                result += ' cursor-line-thin-style';\r\n                break;\r\n            case TextEditorCursorStyle.BlockOutline:\r\n                result += ' cursor-block-outline-style';\r\n                break;\r\n            case TextEditorCursorStyle.UnderlineThin:\r\n                result += ' cursor-underline-thin-style';\r\n                break;\r\n            default:\r\n                result += ' cursor-line-style';\r\n        }\r\n        if (this._blinkingEnabled) {\r\n            switch (this._getCursorBlinking()) {\r\n                case 1 /* Blink */:\r\n                    result += ' cursor-blink';\r\n                    break;\r\n                case 2 /* Smooth */:\r\n                    result += ' cursor-smooth';\r\n                    break;\r\n                case 3 /* Phase */:\r\n                    result += ' cursor-phase';\r\n                    break;\r\n                case 4 /* Expand */:\r\n                    result += ' cursor-expand';\r\n                    break;\r\n                case 5 /* Solid */:\r\n                    result += ' cursor-solid';\r\n                    break;\r\n                default:\r\n                    result += ' cursor-solid';\r\n            }\r\n        }\r\n        else {\r\n            result += ' cursor-solid';\r\n        }\r\n        return result;\r\n    };\r\n    ViewCursors.prototype._show = function () {\r\n        this._primaryCursor.show();\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].show();\r\n        }\r\n        this._isVisible = true;\r\n    };\r\n    ViewCursors.prototype._hide = function () {\r\n        this._primaryCursor.hide();\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].hide();\r\n        }\r\n        this._isVisible = false;\r\n    };\r\n    // ---- IViewPart implementation\r\n    ViewCursors.prototype.prepareRender = function (ctx) {\r\n        this._primaryCursor.prepareRender(ctx);\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].prepareRender(ctx);\r\n        }\r\n    };\r\n    ViewCursors.prototype.render = function (ctx) {\r\n        var renderData = [], renderDataLen = 0;\r\n        var primaryRenderData = this._primaryCursor.render(ctx);\r\n        if (primaryRenderData) {\r\n            renderData[renderDataLen++] = primaryRenderData;\r\n        }\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            var secondaryRenderData = this._secondaryCursors[i].render(ctx);\r\n            if (secondaryRenderData) {\r\n                renderData[renderDataLen++] = secondaryRenderData;\r\n            }\r\n        }\r\n        this._renderData = renderData;\r\n    };\r\n    ViewCursors.prototype.getLastRenderData = function () {\r\n        return this._renderData;\r\n    };\r\n    ViewCursors.BLINK_INTERVAL = 500;\r\n    return ViewCursors;\r\n}(ViewPart));\r\nexport { ViewCursors };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var caret = theme.getColor(editorCursorForeground);\r\n    if (caret) {\r\n        var caretBackground = theme.getColor(editorCursorBackground);\r\n        if (!caretBackground) {\r\n            caretBackground = caret.opposite();\r\n        }\r\n        collector.addRule(\".monaco-editor .cursor { background-color: \" + caret + \"; border-color: \" + caret + \"; color: \" + caretBackground + \"; }\");\r\n        if (theme.type === 'hc') {\r\n            collector.addRule(\".monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid \" + caretBackground + \"; border-right: 1px solid \" + caretBackground + \"; }\");\r\n        }\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nvar ViewZones = /** @class */ (function (_super) {\r\n    __extends(ViewZones, _super);\r\n    function ViewZones(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._lineHeight = _this._context.configuration.editor.lineHeight;\r\n        _this._contentWidth = _this._context.configuration.editor.layoutInfo.contentWidth;\r\n        _this._contentLeft = _this._context.configuration.editor.layoutInfo.contentLeft;\r\n        _this.domNode = createFastDomNode(document.createElement('div'));\r\n        _this.domNode.setClassName('view-zones');\r\n        _this.domNode.setPosition('absolute');\r\n        _this.domNode.setAttribute('role', 'presentation');\r\n        _this.domNode.setAttribute('aria-hidden', 'true');\r\n        _this.marginDomNode = createFastDomNode(document.createElement('div'));\r\n        _this.marginDomNode.setClassName('margin-view-zones');\r\n        _this.marginDomNode.setPosition('absolute');\r\n        _this.marginDomNode.setAttribute('role', 'presentation');\r\n        _this.marginDomNode.setAttribute('aria-hidden', 'true');\r\n        _this._zones = {};\r\n        return _this;\r\n    }\r\n    ViewZones.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._zones = {};\r\n    };\r\n    // ---- begin view event handlers\r\n    ViewZones.prototype._recomputeWhitespacesProps = function () {\r\n        var hadAChange = false;\r\n        var keys = Object.keys(this._zones);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var id = keys[i];\r\n            var zone = this._zones[id];\r\n            var props = this._computeWhitespaceProps(zone.delegate);\r\n            if (this._context.viewLayout.changeWhitespace(parseInt(id, 10), props.afterViewLineNumber, props.heightInPx)) {\r\n                this._safeCallOnComputedHeight(zone.delegate, props.heightInPx);\r\n                hadAChange = true;\r\n            }\r\n        }\r\n        return hadAChange;\r\n    };\r\n    ViewZones.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._lineHeight = this._context.configuration.editor.lineHeight;\r\n            return this._recomputeWhitespacesProps();\r\n        }\r\n        if (e.layoutInfo) {\r\n            this._contentWidth = this._context.configuration.editor.layoutInfo.contentWidth;\r\n            this._contentLeft = this._context.configuration.editor.layoutInfo.contentLeft;\r\n        }\r\n        return true;\r\n    };\r\n    ViewZones.prototype.onLineMappingChanged = function (e) {\r\n        var hadAChange = this._recomputeWhitespacesProps();\r\n        if (hadAChange) {\r\n            this._context.viewLayout.onHeightMaybeChanged();\r\n        }\r\n        return hadAChange;\r\n    };\r\n    ViewZones.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    ViewZones.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged || e.scrollWidthChanged;\r\n    };\r\n    ViewZones.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewZones.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    // ---- end view event handlers\r\n    ViewZones.prototype._getZoneOrdinal = function (zone) {\r\n        if (typeof zone.afterColumn !== 'undefined') {\r\n            return zone.afterColumn;\r\n        }\r\n        return 10000;\r\n    };\r\n    ViewZones.prototype._computeWhitespaceProps = function (zone) {\r\n        if (zone.afterLineNumber === 0) {\r\n            return {\r\n                afterViewLineNumber: 0,\r\n                heightInPx: this._heightInPixels(zone),\r\n                minWidthInPx: this._minWidthInPixels(zone)\r\n            };\r\n        }\r\n        var zoneAfterModelPosition;\r\n        if (typeof zone.afterColumn !== 'undefined') {\r\n            zoneAfterModelPosition = this._context.model.validateModelPosition({\r\n                lineNumber: zone.afterLineNumber,\r\n                column: zone.afterColumn\r\n            });\r\n        }\r\n        else {\r\n            var validAfterLineNumber = this._context.model.validateModelPosition({\r\n                lineNumber: zone.afterLineNumber,\r\n                column: 1\r\n            }).lineNumber;\r\n            zoneAfterModelPosition = new Position(validAfterLineNumber, this._context.model.getModelLineMaxColumn(validAfterLineNumber));\r\n        }\r\n        var zoneBeforeModelPosition;\r\n        if (zoneAfterModelPosition.column === this._context.model.getModelLineMaxColumn(zoneAfterModelPosition.lineNumber)) {\r\n            zoneBeforeModelPosition = this._context.model.validateModelPosition({\r\n                lineNumber: zoneAfterModelPosition.lineNumber + 1,\r\n                column: 1\r\n            });\r\n        }\r\n        else {\r\n            zoneBeforeModelPosition = this._context.model.validateModelPosition({\r\n                lineNumber: zoneAfterModelPosition.lineNumber,\r\n                column: zoneAfterModelPosition.column + 1\r\n            });\r\n        }\r\n        var viewPosition = this._context.model.coordinatesConverter.convertModelPositionToViewPosition(zoneAfterModelPosition);\r\n        var isVisible = this._context.model.coordinatesConverter.modelPositionIsVisible(zoneBeforeModelPosition);\r\n        return {\r\n            afterViewLineNumber: viewPosition.lineNumber,\r\n            heightInPx: (isVisible ? this._heightInPixels(zone) : 0),\r\n            minWidthInPx: this._minWidthInPixels(zone)\r\n        };\r\n    };\r\n    ViewZones.prototype.addZone = function (zone) {\r\n        var props = this._computeWhitespaceProps(zone);\r\n        var whitespaceId = this._context.viewLayout.addWhitespace(props.afterViewLineNumber, this._getZoneOrdinal(zone), props.heightInPx, props.minWidthInPx);\r\n        var myZone = {\r\n            whitespaceId: whitespaceId,\r\n            delegate: zone,\r\n            isVisible: false,\r\n            domNode: createFastDomNode(zone.domNode),\r\n            marginDomNode: zone.marginDomNode ? createFastDomNode(zone.marginDomNode) : null\r\n        };\r\n        this._safeCallOnComputedHeight(myZone.delegate, props.heightInPx);\r\n        myZone.domNode.setPosition('absolute');\r\n        myZone.domNode.domNode.style.width = '100%';\r\n        myZone.domNode.setDisplay('none');\r\n        myZone.domNode.setAttribute('monaco-view-zone', myZone.whitespaceId.toString());\r\n        this.domNode.appendChild(myZone.domNode);\r\n        if (myZone.marginDomNode) {\r\n            myZone.marginDomNode.setPosition('absolute');\r\n            myZone.marginDomNode.domNode.style.width = '100%';\r\n            myZone.marginDomNode.setDisplay('none');\r\n            myZone.marginDomNode.setAttribute('monaco-view-zone', myZone.whitespaceId.toString());\r\n            this.marginDomNode.appendChild(myZone.marginDomNode);\r\n        }\r\n        this._zones[myZone.whitespaceId.toString()] = myZone;\r\n        this.setShouldRender();\r\n        return myZone.whitespaceId;\r\n    };\r\n    ViewZones.prototype.removeZone = function (id) {\r\n        if (this._zones.hasOwnProperty(id.toString())) {\r\n            var zone = this._zones[id.toString()];\r\n            delete this._zones[id.toString()];\r\n            this._context.viewLayout.removeWhitespace(zone.whitespaceId);\r\n            zone.domNode.removeAttribute('monaco-visible-view-zone');\r\n            zone.domNode.removeAttribute('monaco-view-zone');\r\n            zone.domNode.domNode.parentNode.removeChild(zone.domNode.domNode);\r\n            if (zone.marginDomNode) {\r\n                zone.marginDomNode.removeAttribute('monaco-visible-view-zone');\r\n                zone.marginDomNode.removeAttribute('monaco-view-zone');\r\n                zone.marginDomNode.domNode.parentNode.removeChild(zone.marginDomNode.domNode);\r\n            }\r\n            this.setShouldRender();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ViewZones.prototype.layoutZone = function (id) {\r\n        var changed = false;\r\n        if (this._zones.hasOwnProperty(id.toString())) {\r\n            var zone = this._zones[id.toString()];\r\n            var props = this._computeWhitespaceProps(zone.delegate);\r\n            // let newOrdinal = this._getZoneOrdinal(zone.delegate);\r\n            changed = this._context.viewLayout.changeWhitespace(zone.whitespaceId, props.afterViewLineNumber, props.heightInPx) || changed;\r\n            // TODO@Alex: change `newOrdinal` too\r\n            if (changed) {\r\n                this._safeCallOnComputedHeight(zone.delegate, props.heightInPx);\r\n                this.setShouldRender();\r\n            }\r\n        }\r\n        return changed;\r\n    };\r\n    ViewZones.prototype.shouldSuppressMouseDownOnViewZone = function (id) {\r\n        if (this._zones.hasOwnProperty(id.toString())) {\r\n            var zone = this._zones[id.toString()];\r\n            return Boolean(zone.delegate.suppressMouseDown);\r\n        }\r\n        return false;\r\n    };\r\n    ViewZones.prototype._heightInPixels = function (zone) {\r\n        if (typeof zone.heightInPx === 'number') {\r\n            return zone.heightInPx;\r\n        }\r\n        if (typeof zone.heightInLines === 'number') {\r\n            return this._lineHeight * zone.heightInLines;\r\n        }\r\n        return this._lineHeight;\r\n    };\r\n    ViewZones.prototype._minWidthInPixels = function (zone) {\r\n        if (typeof zone.minWidthInPx === 'number') {\r\n            return zone.minWidthInPx;\r\n        }\r\n        return 0;\r\n    };\r\n    ViewZones.prototype._safeCallOnComputedHeight = function (zone, height) {\r\n        if (typeof zone.onComputedHeight === 'function') {\r\n            try {\r\n                zone.onComputedHeight(height);\r\n            }\r\n            catch (e) {\r\n                onUnexpectedError(e);\r\n            }\r\n        }\r\n    };\r\n    ViewZones.prototype._safeCallOnDomNodeTop = function (zone, top) {\r\n        if (typeof zone.onDomNodeTop === 'function') {\r\n            try {\r\n                zone.onDomNodeTop(top);\r\n            }\r\n            catch (e) {\r\n                onUnexpectedError(e);\r\n            }\r\n        }\r\n    };\r\n    ViewZones.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    ViewZones.prototype.render = function (ctx) {\r\n        var visibleWhitespaces = ctx.viewportData.whitespaceViewportData;\r\n        var visibleZones = {};\r\n        var hasVisibleZone = false;\r\n        for (var i = 0, len = visibleWhitespaces.length; i < len; i++) {\r\n            visibleZones[visibleWhitespaces[i].id.toString()] = visibleWhitespaces[i];\r\n            hasVisibleZone = true;\r\n        }\r\n        var keys = Object.keys(this._zones);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var id = keys[i];\r\n            var zone = this._zones[id];\r\n            var newTop = 0;\r\n            var newHeight = 0;\r\n            var newDisplay = 'none';\r\n            if (visibleZones.hasOwnProperty(id)) {\r\n                newTop = visibleZones[id].verticalOffset - ctx.bigNumbersDelta;\r\n                newHeight = visibleZones[id].height;\r\n                newDisplay = 'block';\r\n                // zone is visible\r\n                if (!zone.isVisible) {\r\n                    zone.domNode.setAttribute('monaco-visible-view-zone', 'true');\r\n                    zone.isVisible = true;\r\n                }\r\n                this._safeCallOnDomNodeTop(zone.delegate, ctx.getScrolledTopFromAbsoluteTop(visibleZones[id].verticalOffset));\r\n            }\r\n            else {\r\n                if (zone.isVisible) {\r\n                    zone.domNode.removeAttribute('monaco-visible-view-zone');\r\n                    zone.isVisible = false;\r\n                }\r\n                this._safeCallOnDomNodeTop(zone.delegate, ctx.getScrolledTopFromAbsoluteTop(-1000000));\r\n            }\r\n            zone.domNode.setTop(newTop);\r\n            zone.domNode.setHeight(newHeight);\r\n            zone.domNode.setDisplay(newDisplay);\r\n            if (zone.marginDomNode) {\r\n                zone.marginDomNode.setTop(newTop);\r\n                zone.marginDomNode.setHeight(newHeight);\r\n                zone.marginDomNode.setDisplay(newDisplay);\r\n            }\r\n        }\r\n        if (hasVisibleZone) {\r\n            this.domNode.setWidth(Math.max(ctx.scrollWidth, this._contentWidth));\r\n            this.marginDomNode.setWidth(this._contentLeft);\r\n        }\r\n    };\r\n    return ViewZones;\r\n}(ViewPart));\r\nexport { ViewZones };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar ViewContext = /** @class */ (function () {\r\n    function ViewContext(configuration, theme, model, privateViewEventBus) {\r\n        this.configuration = configuration;\r\n        this.theme = theme;\r\n        this.model = model;\r\n        this.viewLayout = model.viewLayout;\r\n        this.privateViewEventBus = privateViewEventBus;\r\n    }\r\n    ViewContext.prototype.addEventHandler = function (eventHandler) {\r\n        this.privateViewEventBus.addEventHandler(eventHandler);\r\n    };\r\n    ViewContext.prototype.removeEventHandler = function (eventHandler) {\r\n        this.privateViewEventBus.removeEventHandler(eventHandler);\r\n    };\r\n    return ViewContext;\r\n}());\r\nexport { ViewContext };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar ViewEventDispatcher = /** @class */ (function () {\r\n    function ViewEventDispatcher(eventHandlerGateKeeper) {\r\n        this._eventHandlerGateKeeper = eventHandlerGateKeeper;\r\n        this._eventHandlers = [];\r\n        this._eventQueue = null;\r\n        this._isConsumingQueue = false;\r\n    }\r\n    ViewEventDispatcher.prototype.addEventHandler = function (eventHandler) {\r\n        for (var i = 0, len = this._eventHandlers.length; i < len; i++) {\r\n            if (this._eventHandlers[i] === eventHandler) {\r\n                console.warn('Detected duplicate listener in ViewEventDispatcher', eventHandler);\r\n            }\r\n        }\r\n        this._eventHandlers.push(eventHandler);\r\n    };\r\n    ViewEventDispatcher.prototype.removeEventHandler = function (eventHandler) {\r\n        for (var i = 0; i < this._eventHandlers.length; i++) {\r\n            if (this._eventHandlers[i] === eventHandler) {\r\n                this._eventHandlers.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    ViewEventDispatcher.prototype.emit = function (event) {\r\n        if (this._eventQueue) {\r\n            this._eventQueue.push(event);\r\n        }\r\n        else {\r\n            this._eventQueue = [event];\r\n        }\r\n        if (!this._isConsumingQueue) {\r\n            this.consumeQueue();\r\n        }\r\n    };\r\n    ViewEventDispatcher.prototype.emitMany = function (events) {\r\n        if (this._eventQueue) {\r\n            this._eventQueue = this._eventQueue.concat(events);\r\n        }\r\n        else {\r\n            this._eventQueue = events;\r\n        }\r\n        if (!this._isConsumingQueue) {\r\n            this.consumeQueue();\r\n        }\r\n    };\r\n    ViewEventDispatcher.prototype.consumeQueue = function () {\r\n        var _this = this;\r\n        this._eventHandlerGateKeeper(function () {\r\n            try {\r\n                _this._isConsumingQueue = true;\r\n                _this._doConsumeQueue();\r\n            }\r\n            finally {\r\n                _this._isConsumingQueue = false;\r\n            }\r\n        });\r\n    };\r\n    ViewEventDispatcher.prototype._doConsumeQueue = function () {\r\n        while (this._eventQueue) {\r\n            // Empty event queue, as events might come in while sending these off\r\n            var events = this._eventQueue;\r\n            this._eventQueue = null;\r\n            // Use a clone of the event handlers list, as they might remove themselves\r\n            var eventHandlers = this._eventHandlers.slice(0);\r\n            for (var i = 0, len = eventHandlers.length; i < len; i++) {\r\n                eventHandlers[i].handleEvents(events);\r\n            }\r\n        }\r\n    };\r\n    return ViewEventDispatcher;\r\n}());\r\nexport { ViewEventDispatcher };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../core/range.js';\r\n/**\r\n * Contains all data needed to render at a specific viewport.\r\n */\r\nvar ViewportData = /** @class */ (function () {\r\n    function ViewportData(selections, partialData, whitespaceViewportData, model) {\r\n        this.selections = selections;\r\n        this.startLineNumber = partialData.startLineNumber | 0;\r\n        this.endLineNumber = partialData.endLineNumber | 0;\r\n        this.relativeVerticalOffset = partialData.relativeVerticalOffset;\r\n        this.bigNumbersDelta = partialData.bigNumbersDelta | 0;\r\n        this.whitespaceViewportData = whitespaceViewportData;\r\n        this._model = model;\r\n        this.visibleRange = new Range(partialData.startLineNumber, this._model.getLineMinColumn(partialData.startLineNumber), partialData.endLineNumber, this._model.getLineMaxColumn(partialData.endLineNumber));\r\n    }\r\n    ViewportData.prototype.getViewLineRenderingData = function (lineNumber) {\r\n        return this._model.getViewLineRenderingData(this.visibleRange, lineNumber);\r\n    };\r\n    ViewportData.prototype.getDecorationsInViewport = function () {\r\n        return this._model.getDecorationsInViewport(this.visibleRange);\r\n    };\r\n    return ViewportData;\r\n}());\r\nexport { ViewportData };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { PointerHandler } from '../controller/pointerHandler.js';\r\nimport { TextAreaHandler } from '../controller/textAreaHandler.js';\r\nimport { ViewController } from './viewController.js';\r\nimport { ContentViewOverlays, MarginViewOverlays } from './viewOverlays.js';\r\nimport { PartFingerprints } from './viewPart.js';\r\nimport { ViewContentWidgets } from '../viewParts/contentWidgets/contentWidgets.js';\r\nimport { CurrentLineHighlightOverlay } from '../viewParts/currentLineHighlight/currentLineHighlight.js';\r\nimport { CurrentLineMarginHighlightOverlay } from '../viewParts/currentLineMarginHighlight/currentLineMarginHighlight.js';\r\nimport { DecorationsOverlay } from '../viewParts/decorations/decorations.js';\r\nimport { EditorScrollbar } from '../viewParts/editorScrollbar/editorScrollbar.js';\r\nimport { GlyphMarginOverlay } from '../viewParts/glyphMargin/glyphMargin.js';\r\nimport { IndentGuidesOverlay } from '../viewParts/indentGuides/indentGuides.js';\r\nimport { LineNumbersOverlay } from '../viewParts/lineNumbers/lineNumbers.js';\r\nimport { ViewLines } from '../viewParts/lines/viewLines.js';\r\nimport { LinesDecorationsOverlay } from '../viewParts/linesDecorations/linesDecorations.js';\r\nimport { Margin } from '../viewParts/margin/margin.js';\r\nimport { MarginViewLineDecorationsOverlay } from '../viewParts/marginDecorations/marginDecorations.js';\r\nimport { Minimap } from '../viewParts/minimap/minimap.js';\r\nimport { ViewOverlayWidgets } from '../viewParts/overlayWidgets/overlayWidgets.js';\r\nimport { DecorationsOverviewRuler } from '../viewParts/overviewRuler/decorationsOverviewRuler.js';\r\nimport { OverviewRuler } from '../viewParts/overviewRuler/overviewRuler.js';\r\nimport { Rulers } from '../viewParts/rulers/rulers.js';\r\nimport { ScrollDecorationViewPart } from '../viewParts/scrollDecoration/scrollDecoration.js';\r\nimport { SelectionsOverlay } from '../viewParts/selections/selections.js';\r\nimport { ViewCursors } from '../viewParts/viewCursors/viewCursors.js';\r\nimport { ViewZones } from '../viewParts/viewZones/viewZones.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { RenderingContext } from '../../common/view/renderingContext.js';\r\nimport { ViewContext } from '../../common/view/viewContext.js';\r\nimport { ViewEventDispatcher } from '../../common/view/viewEventDispatcher.js';\r\nimport * as viewEvents from '../../common/view/viewEvents.js';\r\nimport { ViewportData } from '../../common/viewLayout/viewLinesViewportData.js';\r\nimport { ViewEventHandler } from '../../common/viewModel/viewEventHandler.js';\r\nimport { getThemeTypeSelector } from '../../../platform/theme/common/themeService.js';\r\nvar invalidFunc = function () { throw new Error(\"Invalid change accessor\"); };\r\nvar View = /** @class */ (function (_super) {\r\n    __extends(View, _super);\r\n    function View(commandDelegate, configuration, themeService, model, cursor, outgoingEvents) {\r\n        var _this = _super.call(this) || this;\r\n        _this._cursor = cursor;\r\n        _this._renderAnimationFrame = null;\r\n        _this.outgoingEvents = outgoingEvents;\r\n        var viewController = new ViewController(configuration, model, _this.outgoingEvents, commandDelegate);\r\n        // The event dispatcher will always go through _renderOnce before dispatching any events\r\n        _this.eventDispatcher = new ViewEventDispatcher(function (callback) { return _this._renderOnce(callback); });\r\n        // Ensure the view is the first event handler in order to update the layout\r\n        _this.eventDispatcher.addEventHandler(_this);\r\n        // The view context is passed on to most classes (basically to reduce param. counts in ctors)\r\n        _this._context = new ViewContext(configuration, themeService.getTheme(), model, _this.eventDispatcher);\r\n        _this._register(themeService.onThemeChange(function (theme) {\r\n            _this._context.theme = theme;\r\n            _this.eventDispatcher.emit(new viewEvents.ViewThemeChangedEvent());\r\n            _this.render(true, false);\r\n        }));\r\n        _this.viewParts = [];\r\n        // Keyboard handler\r\n        _this._textAreaHandler = new TextAreaHandler(_this._context, viewController, _this.createTextAreaHandlerHelper());\r\n        _this.viewParts.push(_this._textAreaHandler);\r\n        _this.createViewParts();\r\n        _this._setLayout();\r\n        // Pointer handler\r\n        _this.pointerHandler = new PointerHandler(_this._context, viewController, _this.createPointerHandlerHelper());\r\n        _this._register(model.addEventListener(function (events) {\r\n            _this.eventDispatcher.emitMany(events);\r\n        }));\r\n        _this._register(_this._cursor.addEventListener(function (events) {\r\n            _this.eventDispatcher.emitMany(events);\r\n        }));\r\n        return _this;\r\n    }\r\n    View.prototype.createViewParts = function () {\r\n        // These two dom nodes must be constructed up front, since references are needed in the layout provider (scrolling & co.)\r\n        this.linesContent = createFastDomNode(document.createElement('div'));\r\n        this.linesContent.setClassName('lines-content' + ' monaco-editor-background');\r\n        this.linesContent.setPosition('absolute');\r\n        this.domNode = createFastDomNode(document.createElement('div'));\r\n        this.domNode.setClassName(this.getEditorClassName());\r\n        this.overflowGuardContainer = createFastDomNode(document.createElement('div'));\r\n        PartFingerprints.write(this.overflowGuardContainer, 3 /* OverflowGuard */);\r\n        this.overflowGuardContainer.setClassName('overflow-guard');\r\n        this._scrollbar = new EditorScrollbar(this._context, this.linesContent, this.domNode, this.overflowGuardContainer);\r\n        this.viewParts.push(this._scrollbar);\r\n        // View Lines\r\n        this.viewLines = new ViewLines(this._context, this.linesContent);\r\n        // View Zones\r\n        this.viewZones = new ViewZones(this._context);\r\n        this.viewParts.push(this.viewZones);\r\n        // Decorations overview ruler\r\n        var decorationsOverviewRuler = new DecorationsOverviewRuler(this._context);\r\n        this.viewParts.push(decorationsOverviewRuler);\r\n        var scrollDecoration = new ScrollDecorationViewPart(this._context);\r\n        this.viewParts.push(scrollDecoration);\r\n        var contentViewOverlays = new ContentViewOverlays(this._context);\r\n        this.viewParts.push(contentViewOverlays);\r\n        contentViewOverlays.addDynamicOverlay(new CurrentLineHighlightOverlay(this._context));\r\n        contentViewOverlays.addDynamicOverlay(new SelectionsOverlay(this._context));\r\n        contentViewOverlays.addDynamicOverlay(new IndentGuidesOverlay(this._context));\r\n        contentViewOverlays.addDynamicOverlay(new DecorationsOverlay(this._context));\r\n        var marginViewOverlays = new MarginViewOverlays(this._context);\r\n        this.viewParts.push(marginViewOverlays);\r\n        marginViewOverlays.addDynamicOverlay(new CurrentLineMarginHighlightOverlay(this._context));\r\n        marginViewOverlays.addDynamicOverlay(new GlyphMarginOverlay(this._context));\r\n        marginViewOverlays.addDynamicOverlay(new MarginViewLineDecorationsOverlay(this._context));\r\n        marginViewOverlays.addDynamicOverlay(new LinesDecorationsOverlay(this._context));\r\n        marginViewOverlays.addDynamicOverlay(new LineNumbersOverlay(this._context));\r\n        var margin = new Margin(this._context);\r\n        margin.getDomNode().appendChild(this.viewZones.marginDomNode);\r\n        margin.getDomNode().appendChild(marginViewOverlays.getDomNode());\r\n        this.viewParts.push(margin);\r\n        // Content widgets\r\n        this.contentWidgets = new ViewContentWidgets(this._context, this.domNode);\r\n        this.viewParts.push(this.contentWidgets);\r\n        this.viewCursors = new ViewCursors(this._context);\r\n        this.viewParts.push(this.viewCursors);\r\n        // Overlay widgets\r\n        this.overlayWidgets = new ViewOverlayWidgets(this._context);\r\n        this.viewParts.push(this.overlayWidgets);\r\n        var rulers = new Rulers(this._context);\r\n        this.viewParts.push(rulers);\r\n        var minimap = new Minimap(this._context);\r\n        this.viewParts.push(minimap);\r\n        // -------------- Wire dom nodes up\r\n        if (decorationsOverviewRuler) {\r\n            var overviewRulerData = this._scrollbar.getOverviewRulerLayoutInfo();\r\n            overviewRulerData.parent.insertBefore(decorationsOverviewRuler.getDomNode(), overviewRulerData.insertBefore);\r\n        }\r\n        this.linesContent.appendChild(contentViewOverlays.getDomNode());\r\n        this.linesContent.appendChild(rulers.domNode);\r\n        this.linesContent.appendChild(this.viewZones.domNode);\r\n        this.linesContent.appendChild(this.viewLines.getDomNode());\r\n        this.linesContent.appendChild(this.contentWidgets.domNode);\r\n        this.linesContent.appendChild(this.viewCursors.getDomNode());\r\n        this.overflowGuardContainer.appendChild(margin.getDomNode());\r\n        this.overflowGuardContainer.appendChild(this._scrollbar.getDomNode());\r\n        this.overflowGuardContainer.appendChild(scrollDecoration.getDomNode());\r\n        this.overflowGuardContainer.appendChild(this._textAreaHandler.textArea);\r\n        this.overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover);\r\n        this.overflowGuardContainer.appendChild(this.overlayWidgets.getDomNode());\r\n        this.overflowGuardContainer.appendChild(minimap.getDomNode());\r\n        this.domNode.appendChild(this.overflowGuardContainer);\r\n        this.domNode.appendChild(this.contentWidgets.overflowingContentWidgetsDomNode);\r\n    };\r\n    View.prototype._flushAccumulatedAndRenderNow = function () {\r\n        this._renderNow();\r\n    };\r\n    View.prototype.createPointerHandlerHelper = function () {\r\n        var _this = this;\r\n        return {\r\n            viewDomNode: this.domNode.domNode,\r\n            linesContentDomNode: this.linesContent.domNode,\r\n            focusTextArea: function () {\r\n                _this.focus();\r\n            },\r\n            getLastViewCursorsRenderData: function () {\r\n                return _this.viewCursors.getLastRenderData() || [];\r\n            },\r\n            shouldSuppressMouseDownOnViewZone: function (viewZoneId) {\r\n                return _this.viewZones.shouldSuppressMouseDownOnViewZone(viewZoneId);\r\n            },\r\n            shouldSuppressMouseDownOnWidget: function (widgetId) {\r\n                return _this.contentWidgets.shouldSuppressMouseDownOnWidget(widgetId);\r\n            },\r\n            getPositionFromDOMInfo: function (spanNode, offset) {\r\n                _this._flushAccumulatedAndRenderNow();\r\n                return _this.viewLines.getPositionFromDOMInfo(spanNode, offset);\r\n            },\r\n            visibleRangeForPosition2: function (lineNumber, column) {\r\n                _this._flushAccumulatedAndRenderNow();\r\n                return _this.viewLines.visibleRangeForPosition(new Position(lineNumber, column));\r\n            },\r\n            getLineWidth: function (lineNumber) {\r\n                _this._flushAccumulatedAndRenderNow();\r\n                return _this.viewLines.getLineWidth(lineNumber);\r\n            }\r\n        };\r\n    };\r\n    View.prototype.createTextAreaHandlerHelper = function () {\r\n        var _this = this;\r\n        return {\r\n            visibleRangeForPositionRelativeToEditor: function (lineNumber, column) {\r\n                _this._flushAccumulatedAndRenderNow();\r\n                return _this.viewLines.visibleRangeForPosition(new Position(lineNumber, column));\r\n            }\r\n        };\r\n    };\r\n    View.prototype._setLayout = function () {\r\n        var layoutInfo = this._context.configuration.editor.layoutInfo;\r\n        this.domNode.setWidth(layoutInfo.width);\r\n        this.domNode.setHeight(layoutInfo.height);\r\n        this.overflowGuardContainer.setWidth(layoutInfo.width);\r\n        this.overflowGuardContainer.setHeight(layoutInfo.height);\r\n        this.linesContent.setWidth(1000000);\r\n        this.linesContent.setHeight(1000000);\r\n    };\r\n    View.prototype.getEditorClassName = function () {\r\n        var focused = this._textAreaHandler.isFocused() ? ' focused' : '';\r\n        return this._context.configuration.editor.editorClassName + ' ' + getThemeTypeSelector(this._context.theme.type) + focused;\r\n    };\r\n    // --- begin event handlers\r\n    View.prototype.onConfigurationChanged = function (e) {\r\n        if (e.editorClassName) {\r\n            this.domNode.setClassName(this.getEditorClassName());\r\n        }\r\n        if (e.layoutInfo) {\r\n            this._setLayout();\r\n        }\r\n        return false;\r\n    };\r\n    View.prototype.onFocusChanged = function (e) {\r\n        this.domNode.setClassName(this.getEditorClassName());\r\n        this._context.model.setHasFocus(e.isFocused);\r\n        if (e.isFocused) {\r\n            this.outgoingEvents.emitViewFocusGained();\r\n        }\r\n        else {\r\n            this.outgoingEvents.emitViewFocusLost();\r\n        }\r\n        return false;\r\n    };\r\n    View.prototype.onScrollChanged = function (e) {\r\n        this.outgoingEvents.emitScrollChanged(e);\r\n        return false;\r\n    };\r\n    View.prototype.onThemeChanged = function (e) {\r\n        this.domNode.setClassName(this.getEditorClassName());\r\n        return false;\r\n    };\r\n    // --- end event handlers\r\n    View.prototype.dispose = function () {\r\n        if (this._renderAnimationFrame !== null) {\r\n            this._renderAnimationFrame.dispose();\r\n            this._renderAnimationFrame = null;\r\n        }\r\n        this.eventDispatcher.removeEventHandler(this);\r\n        this.outgoingEvents.dispose();\r\n        this.pointerHandler.dispose();\r\n        this.viewLines.dispose();\r\n        // Destroy view parts\r\n        for (var i = 0, len = this.viewParts.length; i < len; i++) {\r\n            this.viewParts[i].dispose();\r\n        }\r\n        this.viewParts = [];\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    View.prototype._renderOnce = function (callback) {\r\n        var r = safeInvokeNoArg(callback);\r\n        this._scheduleRender();\r\n        return r;\r\n    };\r\n    View.prototype._scheduleRender = function () {\r\n        if (this._renderAnimationFrame === null) {\r\n            this._renderAnimationFrame = dom.runAtThisOrScheduleAtNextAnimationFrame(this._onRenderScheduled.bind(this), 100);\r\n        }\r\n    };\r\n    View.prototype._onRenderScheduled = function () {\r\n        this._renderAnimationFrame = null;\r\n        this._flushAccumulatedAndRenderNow();\r\n    };\r\n    View.prototype._renderNow = function () {\r\n        var _this = this;\r\n        safeInvokeNoArg(function () { return _this._actualRender(); });\r\n    };\r\n    View.prototype._getViewPartsToRender = function () {\r\n        var result = [], resultLen = 0;\r\n        for (var i = 0, len = this.viewParts.length; i < len; i++) {\r\n            var viewPart = this.viewParts[i];\r\n            if (viewPart.shouldRender()) {\r\n                result[resultLen++] = viewPart;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    View.prototype._actualRender = function () {\r\n        if (!dom.isInDOM(this.domNode.domNode)) {\r\n            return;\r\n        }\r\n        var viewPartsToRender = this._getViewPartsToRender();\r\n        if (!this.viewLines.shouldRender() && viewPartsToRender.length === 0) {\r\n            // Nothing to render\r\n            return;\r\n        }\r\n        var partialViewportData = this._context.viewLayout.getLinesViewportData();\r\n        this._context.model.setViewport(partialViewportData.startLineNumber, partialViewportData.endLineNumber, partialViewportData.centeredLineNumber);\r\n        var viewportData = new ViewportData(this._cursor.getViewSelections(), partialViewportData, this._context.viewLayout.getWhitespaceViewportData(), this._context.model);\r\n        if (this.contentWidgets.shouldRender()) {\r\n            // Give the content widgets a chance to set their max width before a possible synchronous layout\r\n            this.contentWidgets.onBeforeRender(viewportData);\r\n        }\r\n        if (this.viewLines.shouldRender()) {\r\n            this.viewLines.renderText(viewportData);\r\n            this.viewLines.onDidRender();\r\n            // Rendering of viewLines might cause scroll events to occur, so collect view parts to render again\r\n            viewPartsToRender = this._getViewPartsToRender();\r\n        }\r\n        var renderingContext = new RenderingContext(this._context.viewLayout, viewportData, this.viewLines);\r\n        // Render the rest of the parts\r\n        for (var i = 0, len = viewPartsToRender.length; i < len; i++) {\r\n            var viewPart = viewPartsToRender[i];\r\n            viewPart.prepareRender(renderingContext);\r\n        }\r\n        for (var i = 0, len = viewPartsToRender.length; i < len; i++) {\r\n            var viewPart = viewPartsToRender[i];\r\n            viewPart.render(renderingContext);\r\n            viewPart.onDidRender();\r\n        }\r\n    };\r\n    // --- BEGIN CodeEditor helpers\r\n    View.prototype.delegateVerticalScrollbarMouseDown = function (browserEvent) {\r\n        this._scrollbar.delegateVerticalScrollbarMouseDown(browserEvent);\r\n    };\r\n    View.prototype.restoreState = function (scrollPosition) {\r\n        this._context.viewLayout.setScrollPositionNow({ scrollTop: scrollPosition.scrollTop });\r\n        this._renderNow();\r\n        this.viewLines.updateLineWidths();\r\n        this._context.viewLayout.setScrollPositionNow({ scrollLeft: scrollPosition.scrollLeft });\r\n    };\r\n    View.prototype.getOffsetForColumn = function (modelLineNumber, modelColumn) {\r\n        var modelPosition = this._context.model.validateModelPosition({\r\n            lineNumber: modelLineNumber,\r\n            column: modelColumn\r\n        });\r\n        var viewPosition = this._context.model.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\r\n        this._flushAccumulatedAndRenderNow();\r\n        var visibleRange = this.viewLines.visibleRangeForPosition(new Position(viewPosition.lineNumber, viewPosition.column));\r\n        if (!visibleRange) {\r\n            return -1;\r\n        }\r\n        return visibleRange.left;\r\n    };\r\n    View.prototype.getTargetAtClientPoint = function (clientX, clientY) {\r\n        return this.pointerHandler.getTargetAtClientPoint(clientX, clientY);\r\n    };\r\n    View.prototype.createOverviewRuler = function (cssClassName) {\r\n        return new OverviewRuler(this._context, cssClassName);\r\n    };\r\n    View.prototype.change = function (callback) {\r\n        var _this = this;\r\n        var zonesHaveChanged = false;\r\n        this._renderOnce(function () {\r\n            var changeAccessor = {\r\n                addZone: function (zone) {\r\n                    zonesHaveChanged = true;\r\n                    return _this.viewZones.addZone(zone);\r\n                },\r\n                removeZone: function (id) {\r\n                    if (!id) {\r\n                        return;\r\n                    }\r\n                    zonesHaveChanged = _this.viewZones.removeZone(id) || zonesHaveChanged;\r\n                },\r\n                layoutZone: function (id) {\r\n                    if (!id) {\r\n                        return;\r\n                    }\r\n                    zonesHaveChanged = _this.viewZones.layoutZone(id) || zonesHaveChanged;\r\n                }\r\n            };\r\n            safeInvoke1Arg(callback, changeAccessor);\r\n            // Invalidate changeAccessor\r\n            changeAccessor.addZone = invalidFunc;\r\n            changeAccessor.removeZone = invalidFunc;\r\n            changeAccessor.layoutZone = invalidFunc;\r\n            if (zonesHaveChanged) {\r\n                _this._context.viewLayout.onHeightMaybeChanged();\r\n                _this._context.privateViewEventBus.emit(new viewEvents.ViewZonesChangedEvent());\r\n            }\r\n        });\r\n        return zonesHaveChanged;\r\n    };\r\n    View.prototype.render = function (now, everything) {\r\n        if (everything) {\r\n            // Force everything to render...\r\n            this.viewLines.forceShouldRender();\r\n            for (var i = 0, len = this.viewParts.length; i < len; i++) {\r\n                var viewPart = this.viewParts[i];\r\n                viewPart.forceShouldRender();\r\n            }\r\n        }\r\n        if (now) {\r\n            this._flushAccumulatedAndRenderNow();\r\n        }\r\n        else {\r\n            this._scheduleRender();\r\n        }\r\n    };\r\n    View.prototype.focus = function () {\r\n        this._textAreaHandler.focusTextArea();\r\n    };\r\n    View.prototype.isFocused = function () {\r\n        return this._textAreaHandler.isFocused();\r\n    };\r\n    View.prototype.addContentWidget = function (widgetData) {\r\n        this.contentWidgets.addWidget(widgetData.widget);\r\n        this.layoutContentWidget(widgetData);\r\n        this._scheduleRender();\r\n    };\r\n    View.prototype.layoutContentWidget = function (widgetData) {\r\n        var newPosition = widgetData.position ? widgetData.position.position : null;\r\n        var newRange = widgetData.position ? widgetData.position.range : null;\r\n        var newPreference = widgetData.position ? widgetData.position.preference : null;\r\n        this.contentWidgets.setWidgetPosition(widgetData.widget, newPosition, newRange, newPreference);\r\n        this._scheduleRender();\r\n    };\r\n    View.prototype.removeContentWidget = function (widgetData) {\r\n        this.contentWidgets.removeWidget(widgetData.widget);\r\n        this._scheduleRender();\r\n    };\r\n    View.prototype.addOverlayWidget = function (widgetData) {\r\n        this.overlayWidgets.addWidget(widgetData.widget);\r\n        this.layoutOverlayWidget(widgetData);\r\n        this._scheduleRender();\r\n    };\r\n    View.prototype.layoutOverlayWidget = function (widgetData) {\r\n        var newPreference = widgetData.position ? widgetData.position.preference : null;\r\n        var shouldRender = this.overlayWidgets.setWidgetPosition(widgetData.widget, newPreference);\r\n        if (shouldRender) {\r\n            this._scheduleRender();\r\n        }\r\n    };\r\n    View.prototype.removeOverlayWidget = function (widgetData) {\r\n        this.overlayWidgets.removeWidget(widgetData.widget);\r\n        this._scheduleRender();\r\n    };\r\n    return View;\r\n}(ViewEventHandler));\r\nexport { View };\r\nfunction safeInvokeNoArg(func) {\r\n    try {\r\n        return func();\r\n    }\r\n    catch (e) {\r\n        onUnexpectedError(e);\r\n    }\r\n}\r\nfunction safeInvoke1Arg(func, arg1) {\r\n    try {\r\n        return func(arg1);\r\n    }\r\n    catch (e) {\r\n        onUnexpectedError(e);\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { MouseTarget } from '../controller/mouseTarget.js';\r\nvar ViewOutgoingEvents = /** @class */ (function (_super) {\r\n    __extends(ViewOutgoingEvents, _super);\r\n    function ViewOutgoingEvents(viewModel) {\r\n        var _this = _super.call(this) || this;\r\n        _this.onDidScroll = null;\r\n        _this.onDidGainFocus = null;\r\n        _this.onDidLoseFocus = null;\r\n        _this.onKeyDown = null;\r\n        _this.onKeyUp = null;\r\n        _this.onContextMenu = null;\r\n        _this.onMouseMove = null;\r\n        _this.onMouseLeave = null;\r\n        _this.onMouseUp = null;\r\n        _this.onMouseDown = null;\r\n        _this.onMouseDrag = null;\r\n        _this.onMouseDrop = null;\r\n        _this._viewModel = viewModel;\r\n        return _this;\r\n    }\r\n    ViewOutgoingEvents.prototype.emitScrollChanged = function (e) {\r\n        if (this.onDidScroll) {\r\n            this.onDidScroll(e);\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype.emitViewFocusGained = function () {\r\n        if (this.onDidGainFocus) {\r\n            this.onDidGainFocus(void 0);\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype.emitViewFocusLost = function () {\r\n        if (this.onDidLoseFocus) {\r\n            this.onDidLoseFocus(void 0);\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype.emitKeyDown = function (e) {\r\n        if (this.onKeyDown) {\r\n            this.onKeyDown(e);\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype.emitKeyUp = function (e) {\r\n        if (this.onKeyUp) {\r\n            this.onKeyUp(e);\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype.emitContextMenu = function (e) {\r\n        if (this.onContextMenu) {\r\n            this.onContextMenu(this._convertViewToModelMouseEvent(e));\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype.emitMouseMove = function (e) {\r\n        if (this.onMouseMove) {\r\n            this.onMouseMove(this._convertViewToModelMouseEvent(e));\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype.emitMouseLeave = function (e) {\r\n        if (this.onMouseLeave) {\r\n            this.onMouseLeave(this._convertViewToModelMouseEvent(e));\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype.emitMouseUp = function (e) {\r\n        if (this.onMouseUp) {\r\n            this.onMouseUp(this._convertViewToModelMouseEvent(e));\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype.emitMouseDown = function (e) {\r\n        if (this.onMouseDown) {\r\n            this.onMouseDown(this._convertViewToModelMouseEvent(e));\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype.emitMouseDrag = function (e) {\r\n        if (this.onMouseDrag) {\r\n            this.onMouseDrag(this._convertViewToModelMouseEvent(e));\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype.emitMouseDrop = function (e) {\r\n        if (this.onMouseDrop) {\r\n            this.onMouseDrop(this._convertViewToModelMouseEvent(e));\r\n        }\r\n    };\r\n    ViewOutgoingEvents.prototype._convertViewToModelMouseEvent = function (e) {\r\n        if (e.target) {\r\n            return {\r\n                event: e.event,\r\n                target: this._convertViewToModelMouseTarget(e.target)\r\n            };\r\n        }\r\n        return e;\r\n    };\r\n    ViewOutgoingEvents.prototype._convertViewToModelMouseTarget = function (target) {\r\n        return new ExternalMouseTarget(target.element, target.type, target.mouseColumn, target.position ? this._convertViewToModelPosition(target.position) : null, target.range ? this._convertViewToModelRange(target.range) : null, target.detail);\r\n    };\r\n    ViewOutgoingEvents.prototype._convertViewToModelPosition = function (viewPosition) {\r\n        return this._viewModel.coordinatesConverter.convertViewPositionToModelPosition(viewPosition);\r\n    };\r\n    ViewOutgoingEvents.prototype._convertViewToModelRange = function (viewRange) {\r\n        return this._viewModel.coordinatesConverter.convertViewRangeToModelRange(viewRange);\r\n    };\r\n    return ViewOutgoingEvents;\r\n}(Disposable));\r\nexport { ViewOutgoingEvents };\r\nvar ExternalMouseTarget = /** @class */ (function () {\r\n    function ExternalMouseTarget(element, type, mouseColumn, position, range, detail) {\r\n        this.element = element;\r\n        this.type = type;\r\n        this.mouseColumn = mouseColumn;\r\n        this.position = position;\r\n        this.range = range;\r\n        this.detail = detail;\r\n    }\r\n    ExternalMouseTarget.prototype.toString = function () {\r\n        return MouseTarget.toString(this);\r\n    };\r\n    return ExternalMouseTarget;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { CursorState, SingleCursorState } from './cursorCommon.js';\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nimport { Selection } from '../core/selection.js';\r\nvar OneCursor = /** @class */ (function () {\r\n    function OneCursor(context) {\r\n        this._selTrackedRange = null;\r\n        this._trackSelection = true;\r\n        this._setState(context, new SingleCursorState(new Range(1, 1, 1, 1), 0, new Position(1, 1), 0), new SingleCursorState(new Range(1, 1, 1, 1), 0, new Position(1, 1), 0));\r\n    }\r\n    OneCursor.prototype.dispose = function (context) {\r\n        this._removeTrackedRange(context);\r\n    };\r\n    OneCursor.prototype.startTrackingSelection = function (context) {\r\n        this._trackSelection = true;\r\n        this._updateTrackedRange(context);\r\n    };\r\n    OneCursor.prototype.stopTrackingSelection = function (context) {\r\n        this._trackSelection = false;\r\n        this._removeTrackedRange(context);\r\n    };\r\n    OneCursor.prototype._updateTrackedRange = function (context) {\r\n        if (!this._trackSelection) {\r\n            // don't track the selection\r\n            return;\r\n        }\r\n        this._selTrackedRange = context.model._setTrackedRange(this._selTrackedRange, this.modelState.selection, 0 /* AlwaysGrowsWhenTypingAtEdges */);\r\n    };\r\n    OneCursor.prototype._removeTrackedRange = function (context) {\r\n        this._selTrackedRange = context.model._setTrackedRange(this._selTrackedRange, null, 0 /* AlwaysGrowsWhenTypingAtEdges */);\r\n    };\r\n    OneCursor.prototype.asCursorState = function () {\r\n        return new CursorState(this.modelState, this.viewState);\r\n    };\r\n    OneCursor.prototype.readSelectionFromMarkers = function (context) {\r\n        var range = context.model._getTrackedRange(this._selTrackedRange);\r\n        if (this.modelState.selection.getDirection() === 0 /* LTR */) {\r\n            return new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\r\n        }\r\n        return new Selection(range.endLineNumber, range.endColumn, range.startLineNumber, range.startColumn);\r\n    };\r\n    OneCursor.prototype.ensureValidState = function (context) {\r\n        this._setState(context, this.modelState, this.viewState);\r\n    };\r\n    OneCursor.prototype.setState = function (context, modelState, viewState) {\r\n        this._setState(context, modelState, viewState);\r\n    };\r\n    OneCursor.prototype._setState = function (context, modelState, viewState) {\r\n        if (!modelState) {\r\n            if (!viewState) {\r\n                return;\r\n            }\r\n            // We only have the view state => compute the model state\r\n            var selectionStart = context.model.validateRange(context.convertViewRangeToModelRange(viewState.selectionStart));\r\n            var position = context.model.validatePosition(context.convertViewPositionToModelPosition(viewState.position.lineNumber, viewState.position.column));\r\n            modelState = new SingleCursorState(selectionStart, viewState.selectionStartLeftoverVisibleColumns, position, viewState.leftoverVisibleColumns);\r\n        }\r\n        else {\r\n            // Validate new model state\r\n            var selectionStart = context.model.validateRange(modelState.selectionStart);\r\n            var selectionStartLeftoverVisibleColumns = modelState.selectionStart.equalsRange(selectionStart) ? modelState.selectionStartLeftoverVisibleColumns : 0;\r\n            var position = context.model.validatePosition(modelState.position);\r\n            var leftoverVisibleColumns = modelState.position.equals(position) ? modelState.leftoverVisibleColumns : 0;\r\n            modelState = new SingleCursorState(selectionStart, selectionStartLeftoverVisibleColumns, position, leftoverVisibleColumns);\r\n        }\r\n        if (!viewState) {\r\n            // We only have the model state => compute the view state\r\n            var viewSelectionStart1 = context.convertModelPositionToViewPosition(new Position(modelState.selectionStart.startLineNumber, modelState.selectionStart.startColumn));\r\n            var viewSelectionStart2 = context.convertModelPositionToViewPosition(new Position(modelState.selectionStart.endLineNumber, modelState.selectionStart.endColumn));\r\n            var viewSelectionStart = new Range(viewSelectionStart1.lineNumber, viewSelectionStart1.column, viewSelectionStart2.lineNumber, viewSelectionStart2.column);\r\n            var viewPosition = context.convertModelPositionToViewPosition(modelState.position);\r\n            viewState = new SingleCursorState(viewSelectionStart, modelState.selectionStartLeftoverVisibleColumns, viewPosition, modelState.leftoverVisibleColumns);\r\n        }\r\n        else {\r\n            // Validate new view state\r\n            var viewSelectionStart = context.validateViewRange(viewState.selectionStart, modelState.selectionStart);\r\n            var viewPosition = context.validateViewPosition(viewState.position, modelState.position);\r\n            viewState = new SingleCursorState(viewSelectionStart, modelState.selectionStartLeftoverVisibleColumns, viewPosition, modelState.leftoverVisibleColumns);\r\n        }\r\n        this.modelState = modelState;\r\n        this.viewState = viewState;\r\n        this._updateTrackedRange(context);\r\n    };\r\n    return OneCursor;\r\n}());\r\nexport { OneCursor };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { CursorState } from './cursorCommon.js';\r\nimport { OneCursor } from './oneCursor.js';\r\nimport { Selection } from '../core/selection.js';\r\nvar CursorCollection = /** @class */ (function () {\r\n    function CursorCollection(context) {\r\n        this.context = context;\r\n        this.primaryCursor = new OneCursor(context);\r\n        this.secondaryCursors = [];\r\n        this.lastAddedCursorIndex = 0;\r\n    }\r\n    CursorCollection.prototype.dispose = function () {\r\n        this.primaryCursor.dispose(this.context);\r\n        this.killSecondaryCursors();\r\n    };\r\n    CursorCollection.prototype.startTrackingSelections = function () {\r\n        this.primaryCursor.startTrackingSelection(this.context);\r\n        for (var i = 0, len = this.secondaryCursors.length; i < len; i++) {\r\n            this.secondaryCursors[i].startTrackingSelection(this.context);\r\n        }\r\n    };\r\n    CursorCollection.prototype.stopTrackingSelections = function () {\r\n        this.primaryCursor.stopTrackingSelection(this.context);\r\n        for (var i = 0, len = this.secondaryCursors.length; i < len; i++) {\r\n            this.secondaryCursors[i].stopTrackingSelection(this.context);\r\n        }\r\n    };\r\n    CursorCollection.prototype.updateContext = function (context) {\r\n        this.context = context;\r\n    };\r\n    CursorCollection.prototype.ensureValidState = function () {\r\n        this.primaryCursor.ensureValidState(this.context);\r\n        for (var i = 0, len = this.secondaryCursors.length; i < len; i++) {\r\n            this.secondaryCursors[i].ensureValidState(this.context);\r\n        }\r\n    };\r\n    CursorCollection.prototype.readSelectionFromMarkers = function () {\r\n        var result = [];\r\n        result[0] = this.primaryCursor.readSelectionFromMarkers(this.context);\r\n        for (var i = 0, len = this.secondaryCursors.length; i < len; i++) {\r\n            result[i + 1] = this.secondaryCursors[i].readSelectionFromMarkers(this.context);\r\n        }\r\n        return result;\r\n    };\r\n    CursorCollection.prototype.getAll = function () {\r\n        var result = [];\r\n        result[0] = this.primaryCursor.asCursorState();\r\n        for (var i = 0, len = this.secondaryCursors.length; i < len; i++) {\r\n            result[i + 1] = this.secondaryCursors[i].asCursorState();\r\n        }\r\n        return result;\r\n    };\r\n    CursorCollection.prototype.getViewPositions = function () {\r\n        var result = [];\r\n        result[0] = this.primaryCursor.viewState.position;\r\n        for (var i = 0, len = this.secondaryCursors.length; i < len; i++) {\r\n            result[i + 1] = this.secondaryCursors[i].viewState.position;\r\n        }\r\n        return result;\r\n    };\r\n    CursorCollection.prototype.getSelections = function () {\r\n        var result = [];\r\n        result[0] = this.primaryCursor.modelState.selection;\r\n        for (var i = 0, len = this.secondaryCursors.length; i < len; i++) {\r\n            result[i + 1] = this.secondaryCursors[i].modelState.selection;\r\n        }\r\n        return result;\r\n    };\r\n    CursorCollection.prototype.getViewSelections = function () {\r\n        var result = [];\r\n        result[0] = this.primaryCursor.viewState.selection;\r\n        for (var i = 0, len = this.secondaryCursors.length; i < len; i++) {\r\n            result[i + 1] = this.secondaryCursors[i].viewState.selection;\r\n        }\r\n        return result;\r\n    };\r\n    CursorCollection.prototype.setSelections = function (selections) {\r\n        this.setStates(CursorState.fromModelSelections(selections));\r\n    };\r\n    CursorCollection.prototype.getPrimaryCursor = function () {\r\n        return this.primaryCursor.asCursorState();\r\n    };\r\n    CursorCollection.prototype.setStates = function (states) {\r\n        if (states === null) {\r\n            return;\r\n        }\r\n        this.primaryCursor.setState(this.context, states[0].modelState, states[0].viewState);\r\n        this._setSecondaryStates(states.slice(1));\r\n    };\r\n    /**\r\n     * Creates or disposes secondary cursors as necessary to match the number of `secondarySelections`.\r\n     */\r\n    CursorCollection.prototype._setSecondaryStates = function (secondaryStates) {\r\n        var secondaryCursorsLength = this.secondaryCursors.length;\r\n        var secondaryStatesLength = secondaryStates.length;\r\n        if (secondaryCursorsLength < secondaryStatesLength) {\r\n            var createCnt = secondaryStatesLength - secondaryCursorsLength;\r\n            for (var i = 0; i < createCnt; i++) {\r\n                this._addSecondaryCursor();\r\n            }\r\n        }\r\n        else if (secondaryCursorsLength > secondaryStatesLength) {\r\n            var removeCnt = secondaryCursorsLength - secondaryStatesLength;\r\n            for (var i = 0; i < removeCnt; i++) {\r\n                this._removeSecondaryCursor(this.secondaryCursors.length - 1);\r\n            }\r\n        }\r\n        for (var i = 0; i < secondaryStatesLength; i++) {\r\n            this.secondaryCursors[i].setState(this.context, secondaryStates[i].modelState, secondaryStates[i].viewState);\r\n        }\r\n    };\r\n    CursorCollection.prototype.killSecondaryCursors = function () {\r\n        this._setSecondaryStates([]);\r\n    };\r\n    CursorCollection.prototype._addSecondaryCursor = function () {\r\n        this.secondaryCursors.push(new OneCursor(this.context));\r\n        this.lastAddedCursorIndex = this.secondaryCursors.length;\r\n    };\r\n    CursorCollection.prototype.getLastAddedCursorIndex = function () {\r\n        if (this.secondaryCursors.length === 0 || this.lastAddedCursorIndex === 0) {\r\n            return 0;\r\n        }\r\n        return this.lastAddedCursorIndex;\r\n    };\r\n    CursorCollection.prototype._removeSecondaryCursor = function (removeIndex) {\r\n        if (this.lastAddedCursorIndex >= removeIndex + 1) {\r\n            this.lastAddedCursorIndex--;\r\n        }\r\n        this.secondaryCursors[removeIndex].dispose(this.context);\r\n        this.secondaryCursors.splice(removeIndex, 1);\r\n    };\r\n    CursorCollection.prototype._getAll = function () {\r\n        var result = [];\r\n        result[0] = this.primaryCursor;\r\n        for (var i = 0, len = this.secondaryCursors.length; i < len; i++) {\r\n            result[i + 1] = this.secondaryCursors[i];\r\n        }\r\n        return result;\r\n    };\r\n    CursorCollection.prototype.normalize = function () {\r\n        if (this.secondaryCursors.length === 0) {\r\n            return;\r\n        }\r\n        var cursors = this._getAll();\r\n        var sortedCursors = [];\r\n        for (var i = 0, len = cursors.length; i < len; i++) {\r\n            sortedCursors.push({\r\n                index: i,\r\n                selection: cursors[i].modelState.selection,\r\n            });\r\n        }\r\n        sortedCursors.sort(function (a, b) {\r\n            if (a.selection.startLineNumber === b.selection.startLineNumber) {\r\n                return a.selection.startColumn - b.selection.startColumn;\r\n            }\r\n            return a.selection.startLineNumber - b.selection.startLineNumber;\r\n        });\r\n        for (var sortedCursorIndex = 0; sortedCursorIndex < sortedCursors.length - 1; sortedCursorIndex++) {\r\n            var current = sortedCursors[sortedCursorIndex];\r\n            var next = sortedCursors[sortedCursorIndex + 1];\r\n            var currentSelection = current.selection;\r\n            var nextSelection = next.selection;\r\n            if (!this.context.config.multiCursorMergeOverlapping) {\r\n                continue;\r\n            }\r\n            var shouldMergeCursors = void 0;\r\n            if (nextSelection.isEmpty() || currentSelection.isEmpty()) {\r\n                // Merge touching cursors if one of them is collapsed\r\n                shouldMergeCursors = nextSelection.getStartPosition().isBeforeOrEqual(currentSelection.getEndPosition());\r\n            }\r\n            else {\r\n                // Merge only overlapping cursors (i.e. allow touching ranges)\r\n                shouldMergeCursors = nextSelection.getStartPosition().isBefore(currentSelection.getEndPosition());\r\n            }\r\n            if (shouldMergeCursors) {\r\n                var winnerSortedCursorIndex = current.index < next.index ? sortedCursorIndex : sortedCursorIndex + 1;\r\n                var looserSortedCursorIndex = current.index < next.index ? sortedCursorIndex + 1 : sortedCursorIndex;\r\n                var looserIndex = sortedCursors[looserSortedCursorIndex].index;\r\n                var winnerIndex = sortedCursors[winnerSortedCursorIndex].index;\r\n                var looserSelection = sortedCursors[looserSortedCursorIndex].selection;\r\n                var winnerSelection = sortedCursors[winnerSortedCursorIndex].selection;\r\n                if (!looserSelection.equalsSelection(winnerSelection)) {\r\n                    var resultingRange = looserSelection.plusRange(winnerSelection);\r\n                    var looserSelectionIsLTR = (looserSelection.selectionStartLineNumber === looserSelection.startLineNumber && looserSelection.selectionStartColumn === looserSelection.startColumn);\r\n                    var winnerSelectionIsLTR = (winnerSelection.selectionStartLineNumber === winnerSelection.startLineNumber && winnerSelection.selectionStartColumn === winnerSelection.startColumn);\r\n                    // Give more importance to the last added cursor (think Ctrl-dragging + hitting another cursor)\r\n                    var resultingSelectionIsLTR = void 0;\r\n                    if (looserIndex === this.lastAddedCursorIndex) {\r\n                        resultingSelectionIsLTR = looserSelectionIsLTR;\r\n                        this.lastAddedCursorIndex = winnerIndex;\r\n                    }\r\n                    else {\r\n                        // Winner takes it all\r\n                        resultingSelectionIsLTR = winnerSelectionIsLTR;\r\n                    }\r\n                    var resultingSelection = void 0;\r\n                    if (resultingSelectionIsLTR) {\r\n                        resultingSelection = new Selection(resultingRange.startLineNumber, resultingRange.startColumn, resultingRange.endLineNumber, resultingRange.endColumn);\r\n                    }\r\n                    else {\r\n                        resultingSelection = new Selection(resultingRange.endLineNumber, resultingRange.endColumn, resultingRange.startLineNumber, resultingRange.startColumn);\r\n                    }\r\n                    sortedCursors[winnerSortedCursorIndex].selection = resultingSelection;\r\n                    var resultingState = CursorState.fromModelSelection(resultingSelection);\r\n                    cursors[winnerIndex].setState(this.context, resultingState.modelState, resultingState.viewState);\r\n                }\r\n                for (var j = 0; j < sortedCursors.length; j++) {\r\n                    if (sortedCursors[j].index > looserIndex) {\r\n                        sortedCursors[j].index--;\r\n                    }\r\n                }\r\n                cursors.splice(looserIndex, 1);\r\n                sortedCursors.splice(looserSortedCursorIndex, 1);\r\n                this._removeSecondaryCursor(looserIndex - 1);\r\n                sortedCursorIndex--;\r\n            }\r\n        }\r\n    };\r\n    return CursorCollection;\r\n}());\r\nexport { CursorCollection };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { CursorCollection } from './cursorCollection.js';\r\nimport { CursorColumns, CursorConfiguration, CursorContext, CursorState, EditOperationResult } from './cursorCommon.js';\r\nimport { DeleteOperations } from './cursorDeleteOperations.js';\r\nimport { TypeOperations } from './cursorTypeOperations.js';\r\nimport { Range } from '../core/range.js';\r\nimport { Selection } from '../core/selection.js';\r\nimport * as editorCommon from '../editorCommon.js';\r\nimport * as viewEvents from '../view/viewEvents.js';\r\nfunction containsLineMappingChanged(events) {\r\n    for (var i = 0, len = events.length; i < len; i++) {\r\n        if (events[i].type === 6 /* ViewLineMappingChanged */) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nvar CursorStateChangedEvent = /** @class */ (function () {\r\n    function CursorStateChangedEvent(selections, source, reason) {\r\n        this.selections = selections;\r\n        this.source = source;\r\n        this.reason = reason;\r\n    }\r\n    return CursorStateChangedEvent;\r\n}());\r\nexport { CursorStateChangedEvent };\r\n/**\r\n * A snapshot of the cursor and the model state\r\n */\r\nvar CursorModelState = /** @class */ (function () {\r\n    function CursorModelState(model, cursor) {\r\n        this.modelVersionId = model.getVersionId();\r\n        this.cursorState = cursor.getAll();\r\n    }\r\n    CursorModelState.prototype.equals = function (other) {\r\n        if (!other) {\r\n            return false;\r\n        }\r\n        if (this.modelVersionId !== other.modelVersionId) {\r\n            return false;\r\n        }\r\n        if (this.cursorState.length !== other.cursorState.length) {\r\n            return false;\r\n        }\r\n        for (var i = 0, len = this.cursorState.length; i < len; i++) {\r\n            if (!this.cursorState[i].equals(other.cursorState[i])) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    return CursorModelState;\r\n}());\r\nexport { CursorModelState };\r\nvar Cursor = /** @class */ (function (_super) {\r\n    __extends(Cursor, _super);\r\n    function Cursor(configuration, model, viewModel) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onDidReachMaxCursorCount = _this._register(new Emitter());\r\n        _this.onDidReachMaxCursorCount = _this._onDidReachMaxCursorCount.event;\r\n        _this._onDidAttemptReadOnlyEdit = _this._register(new Emitter());\r\n        _this.onDidAttemptReadOnlyEdit = _this._onDidAttemptReadOnlyEdit.event;\r\n        _this._onDidChange = _this._register(new Emitter());\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        _this._configuration = configuration;\r\n        _this._model = model;\r\n        _this._knownModelVersionId = _this._model.getVersionId();\r\n        _this._viewModel = viewModel;\r\n        _this.context = new CursorContext(_this._configuration, _this._model, _this._viewModel);\r\n        _this._cursors = new CursorCollection(_this.context);\r\n        _this._isHandling = false;\r\n        _this._isDoingComposition = false;\r\n        _this._columnSelectData = null;\r\n        _this._prevEditOperationType = 0 /* Other */;\r\n        _this._register(_this._model.onDidChangeRawContent(function (e) {\r\n            _this._knownModelVersionId = e.versionId;\r\n            if (_this._isHandling) {\r\n                return;\r\n            }\r\n            var hadFlushEvent = e.containsEvent(1 /* Flush */);\r\n            _this._onModelContentChanged(hadFlushEvent);\r\n        }));\r\n        _this._register(viewModel.addEventListener(function (events) {\r\n            if (!containsLineMappingChanged(events)) {\r\n                return;\r\n            }\r\n            if (_this._knownModelVersionId !== _this._model.getVersionId()) {\r\n                // There are model change events that I didn't yet receive.\r\n                //\r\n                // This can happen when editing the model, and the view model receives the change events first,\r\n                // and the view model emits line mapping changed events, all before the cursor gets a chance to\r\n                // recover from markers.\r\n                //\r\n                // The model change listener above will be called soon and we'll ensure a valid cursor state there.\r\n                return;\r\n            }\r\n            // Ensure valid state\r\n            _this.setStates('viewModel', 0 /* NotSet */, _this.getAll());\r\n        }));\r\n        var updateCursorContext = function () {\r\n            _this.context = new CursorContext(_this._configuration, _this._model, _this._viewModel);\r\n            _this._cursors.updateContext(_this.context);\r\n        };\r\n        _this._register(_this._model.onDidChangeLanguage(function (e) {\r\n            updateCursorContext();\r\n        }));\r\n        _this._register(_this._model.onDidChangeLanguageConfiguration(function () {\r\n            updateCursorContext();\r\n        }));\r\n        _this._register(_this._model.onDidChangeOptions(function () {\r\n            updateCursorContext();\r\n        }));\r\n        _this._register(_this._configuration.onDidChange(function (e) {\r\n            if (CursorConfiguration.shouldRecreate(e)) {\r\n                updateCursorContext();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    Cursor.prototype.dispose = function () {\r\n        this._cursors.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // ------ some getters/setters\r\n    Cursor.prototype.getPrimaryCursor = function () {\r\n        return this._cursors.getPrimaryCursor();\r\n    };\r\n    Cursor.prototype.getLastAddedCursorIndex = function () {\r\n        return this._cursors.getLastAddedCursorIndex();\r\n    };\r\n    Cursor.prototype.getAll = function () {\r\n        return this._cursors.getAll();\r\n    };\r\n    Cursor.prototype.setStates = function (source, reason, states) {\r\n        if (states !== null && states.length > Cursor.MAX_CURSOR_COUNT) {\r\n            states = states.slice(0, Cursor.MAX_CURSOR_COUNT);\r\n            this._onDidReachMaxCursorCount.fire(void 0);\r\n        }\r\n        var oldState = new CursorModelState(this._model, this);\r\n        this._cursors.setStates(states);\r\n        this._cursors.normalize();\r\n        this._columnSelectData = null;\r\n        this._emitStateChangedIfNecessary(source, reason, oldState);\r\n    };\r\n    Cursor.prototype.setColumnSelectData = function (columnSelectData) {\r\n        this._columnSelectData = columnSelectData;\r\n    };\r\n    Cursor.prototype.reveal = function (horizontal, target, scrollType) {\r\n        this._revealRange(target, 0 /* Simple */, horizontal, scrollType);\r\n    };\r\n    Cursor.prototype.revealRange = function (revealHorizontal, viewRange, verticalType, scrollType) {\r\n        this.emitCursorRevealRange(viewRange, verticalType, revealHorizontal, scrollType);\r\n    };\r\n    Cursor.prototype.scrollTo = function (desiredScrollTop) {\r\n        this._viewModel.viewLayout.setScrollPositionSmooth({\r\n            scrollTop: desiredScrollTop\r\n        });\r\n    };\r\n    Cursor.prototype.saveState = function () {\r\n        var result = [];\r\n        var selections = this._cursors.getSelections();\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            result.push({\r\n                inSelectionMode: !selection.isEmpty(),\r\n                selectionStart: {\r\n                    lineNumber: selection.selectionStartLineNumber,\r\n                    column: selection.selectionStartColumn,\r\n                },\r\n                position: {\r\n                    lineNumber: selection.positionLineNumber,\r\n                    column: selection.positionColumn,\r\n                }\r\n            });\r\n        }\r\n        return result;\r\n    };\r\n    Cursor.prototype.restoreState = function (states) {\r\n        var desiredSelections = [];\r\n        for (var i = 0, len = states.length; i < len; i++) {\r\n            var state = states[i];\r\n            var positionLineNumber = 1;\r\n            var positionColumn = 1;\r\n            // Avoid missing properties on the literal\r\n            if (state.position && state.position.lineNumber) {\r\n                positionLineNumber = state.position.lineNumber;\r\n            }\r\n            if (state.position && state.position.column) {\r\n                positionColumn = state.position.column;\r\n            }\r\n            var selectionStartLineNumber = positionLineNumber;\r\n            var selectionStartColumn = positionColumn;\r\n            // Avoid missing properties on the literal\r\n            if (state.selectionStart && state.selectionStart.lineNumber) {\r\n                selectionStartLineNumber = state.selectionStart.lineNumber;\r\n            }\r\n            if (state.selectionStart && state.selectionStart.column) {\r\n                selectionStartColumn = state.selectionStart.column;\r\n            }\r\n            desiredSelections.push({\r\n                selectionStartLineNumber: selectionStartLineNumber,\r\n                selectionStartColumn: selectionStartColumn,\r\n                positionLineNumber: positionLineNumber,\r\n                positionColumn: positionColumn\r\n            });\r\n        }\r\n        this.setStates('restoreState', 0 /* NotSet */, CursorState.fromModelSelections(desiredSelections));\r\n        this.reveal(true, 0 /* Primary */, 1 /* Immediate */);\r\n    };\r\n    Cursor.prototype._onModelContentChanged = function (hadFlushEvent) {\r\n        this._prevEditOperationType = 0 /* Other */;\r\n        if (hadFlushEvent) {\r\n            // a model.setValue() was called\r\n            this._cursors.dispose();\r\n            this._cursors = new CursorCollection(this.context);\r\n            this._emitStateChangedIfNecessary('model', 1 /* ContentFlush */, null);\r\n        }\r\n        else {\r\n            var selectionsFromMarkers = this._cursors.readSelectionFromMarkers();\r\n            this.setStates('modelChange', 2 /* RecoverFromMarkers */, CursorState.fromModelSelections(selectionsFromMarkers));\r\n        }\r\n    };\r\n    Cursor.prototype.getSelection = function () {\r\n        return this._cursors.getPrimaryCursor().modelState.selection;\r\n    };\r\n    Cursor.prototype.getColumnSelectData = function () {\r\n        if (this._columnSelectData) {\r\n            return this._columnSelectData;\r\n        }\r\n        var primaryCursor = this._cursors.getPrimaryCursor();\r\n        var primaryPos = primaryCursor.viewState.position;\r\n        return {\r\n            toViewLineNumber: primaryPos.lineNumber,\r\n            toViewVisualColumn: CursorColumns.visibleColumnFromColumn2(this.context.config, this.context.viewModel, primaryPos)\r\n        };\r\n    };\r\n    Cursor.prototype.getSelections = function () {\r\n        return this._cursors.getSelections();\r\n    };\r\n    Cursor.prototype.getViewSelections = function () {\r\n        return this._cursors.getViewSelections();\r\n    };\r\n    Cursor.prototype.getPosition = function () {\r\n        return this._cursors.getPrimaryCursor().modelState.position;\r\n    };\r\n    Cursor.prototype.setSelections = function (source, selections) {\r\n        this.setStates(source, 0 /* NotSet */, CursorState.fromModelSelections(selections));\r\n    };\r\n    Cursor.prototype.getPrevEditOperationType = function () {\r\n        return this._prevEditOperationType;\r\n    };\r\n    Cursor.prototype.setPrevEditOperationType = function (type) {\r\n        this._prevEditOperationType = type;\r\n    };\r\n    // ------ auxiliary handling logic\r\n    Cursor.prototype._executeEditOperation = function (opResult) {\r\n        if (!opResult) {\r\n            // Nothing to execute\r\n            return;\r\n        }\r\n        if (opResult.shouldPushStackElementBefore) {\r\n            this._model.pushStackElement();\r\n        }\r\n        var result = CommandExecutor.executeCommands(this._model, this._cursors.getSelections(), opResult.commands);\r\n        if (result) {\r\n            // The commands were applied correctly\r\n            this._interpretCommandResult(result);\r\n            this._prevEditOperationType = opResult.type;\r\n        }\r\n        if (opResult.shouldPushStackElementAfter) {\r\n            this._model.pushStackElement();\r\n        }\r\n    };\r\n    Cursor.prototype._interpretCommandResult = function (cursorState) {\r\n        if (!cursorState || cursorState.length === 0) {\r\n            cursorState = this._cursors.readSelectionFromMarkers();\r\n        }\r\n        this._columnSelectData = null;\r\n        this._cursors.setSelections(cursorState);\r\n        this._cursors.normalize();\r\n    };\r\n    // -----------------------------------------------------------------------------------------------------------\r\n    // ----- emitting events\r\n    Cursor.prototype._emitStateChangedIfNecessary = function (source, reason, oldState) {\r\n        var newState = new CursorModelState(this._model, this);\r\n        if (newState.equals(oldState)) {\r\n            return false;\r\n        }\r\n        var selections = this._cursors.getSelections();\r\n        var viewSelections = this._cursors.getViewSelections();\r\n        // Let the view get the event first.\r\n        try {\r\n            var eventsCollector = this._beginEmit();\r\n            eventsCollector.emit(new viewEvents.ViewCursorStateChangedEvent(viewSelections));\r\n        }\r\n        finally {\r\n            this._endEmit();\r\n        }\r\n        // Only after the view has been notified, let the rest of the world know...\r\n        if (!oldState\r\n            || oldState.cursorState.length !== newState.cursorState.length\r\n            || newState.cursorState.some(function (newCursorState, i) { return !newCursorState.modelState.equals(oldState.cursorState[i].modelState); })) {\r\n            this._onDidChange.fire(new CursorStateChangedEvent(selections, source || 'keyboard', reason));\r\n        }\r\n        return true;\r\n    };\r\n    Cursor.prototype._revealRange = function (revealTarget, verticalType, revealHorizontal, scrollType) {\r\n        var viewPositions = this._cursors.getViewPositions();\r\n        var viewPosition = viewPositions[0];\r\n        if (revealTarget === 1 /* TopMost */) {\r\n            for (var i = 1; i < viewPositions.length; i++) {\r\n                if (viewPositions[i].isBefore(viewPosition)) {\r\n                    viewPosition = viewPositions[i];\r\n                }\r\n            }\r\n        }\r\n        else if (revealTarget === 2 /* BottomMost */) {\r\n            for (var i = 1; i < viewPositions.length; i++) {\r\n                if (viewPosition.isBeforeOrEqual(viewPositions[i])) {\r\n                    viewPosition = viewPositions[i];\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (viewPositions.length > 1) {\r\n                // no revealing!\r\n                return;\r\n            }\r\n        }\r\n        var viewRange = new Range(viewPosition.lineNumber, viewPosition.column, viewPosition.lineNumber, viewPosition.column);\r\n        this.emitCursorRevealRange(viewRange, verticalType, revealHorizontal, scrollType);\r\n    };\r\n    Cursor.prototype.emitCursorRevealRange = function (viewRange, verticalType, revealHorizontal, scrollType) {\r\n        try {\r\n            var eventsCollector = this._beginEmit();\r\n            eventsCollector.emit(new viewEvents.ViewRevealRangeRequestEvent(viewRange, verticalType, revealHorizontal, scrollType));\r\n        }\r\n        finally {\r\n            this._endEmit();\r\n        }\r\n    };\r\n    // -----------------------------------------------------------------------------------------------------------\r\n    // ----- handlers beyond this point\r\n    Cursor.prototype.trigger = function (source, handlerId, payload) {\r\n        var H = editorCommon.Handler;\r\n        if (handlerId === H.CompositionStart) {\r\n            this._isDoingComposition = true;\r\n            return;\r\n        }\r\n        if (handlerId === H.CompositionEnd) {\r\n            this._isDoingComposition = false;\r\n        }\r\n        if (this._configuration.editor.readOnly) {\r\n            // All the remaining handlers will try to edit the model,\r\n            // but we cannot edit when read only...\r\n            this._onDidAttemptReadOnlyEdit.fire(void 0);\r\n            return;\r\n        }\r\n        var oldState = new CursorModelState(this._model, this);\r\n        var cursorChangeReason = 0 /* NotSet */;\r\n        if (handlerId !== H.Undo && handlerId !== H.Redo) {\r\n            // TODO@Alex: if the undo/redo stack contains non-null selections\r\n            // it would also be OK to stop tracking selections here\r\n            this._cursors.stopTrackingSelections();\r\n        }\r\n        // ensure valid state on all cursors\r\n        this._cursors.ensureValidState();\r\n        this._isHandling = true;\r\n        try {\r\n            switch (handlerId) {\r\n                case H.Type:\r\n                    this._type(source, payload.text);\r\n                    break;\r\n                case H.ReplacePreviousChar:\r\n                    this._replacePreviousChar(payload.text, payload.replaceCharCnt);\r\n                    break;\r\n                case H.Paste:\r\n                    cursorChangeReason = 4 /* Paste */;\r\n                    this._paste(payload.text, payload.pasteOnNewLine, payload.multicursorText);\r\n                    break;\r\n                case H.Cut:\r\n                    this._cut();\r\n                    break;\r\n                case H.Undo:\r\n                    cursorChangeReason = 5 /* Undo */;\r\n                    this._interpretCommandResult(this._model.undo());\r\n                    break;\r\n                case H.Redo:\r\n                    cursorChangeReason = 6 /* Redo */;\r\n                    this._interpretCommandResult(this._model.redo());\r\n                    break;\r\n                case H.ExecuteCommand:\r\n                    this._externalExecuteCommand(payload);\r\n                    break;\r\n                case H.ExecuteCommands:\r\n                    this._externalExecuteCommands(payload);\r\n                    break;\r\n                case H.CompositionEnd:\r\n                    this._interpretCompositionEnd(source);\r\n                    break;\r\n            }\r\n        }\r\n        catch (err) {\r\n            onUnexpectedError(err);\r\n        }\r\n        this._isHandling = false;\r\n        if (handlerId !== H.Undo && handlerId !== H.Redo) {\r\n            this._cursors.startTrackingSelections();\r\n        }\r\n        if (this._emitStateChangedIfNecessary(source, cursorChangeReason, oldState)) {\r\n            this._revealRange(0 /* Primary */, 0 /* Simple */, true, 0 /* Smooth */);\r\n        }\r\n    };\r\n    Cursor.prototype._interpretCompositionEnd = function (source) {\r\n        if (!this._isDoingComposition && source === 'keyboard') {\r\n            // composition finishes, let's check if we need to auto complete if necessary.\r\n            this._executeEditOperation(TypeOperations.compositionEndWithInterceptors(this._prevEditOperationType, this.context.config, this.context.model, this.getSelections()));\r\n        }\r\n    };\r\n    Cursor.prototype._type = function (source, text) {\r\n        if (!this._isDoingComposition && source === 'keyboard') {\r\n            // If this event is coming straight from the keyboard, look for electric characters and enter\r\n            for (var i = 0, len = text.length; i < len; i++) {\r\n                var charCode = text.charCodeAt(i);\r\n                var chr = void 0;\r\n                if (strings.isHighSurrogate(charCode) && i + 1 < len) {\r\n                    chr = text.charAt(i) + text.charAt(i + 1);\r\n                    i++;\r\n                }\r\n                else {\r\n                    chr = text.charAt(i);\r\n                }\r\n                // Here we must interpret each typed character individually, that's why we create a new context\r\n                this._executeEditOperation(TypeOperations.typeWithInterceptors(this._prevEditOperationType, this.context.config, this.context.model, this.getSelections(), chr));\r\n            }\r\n        }\r\n        else {\r\n            this._executeEditOperation(TypeOperations.typeWithoutInterceptors(this._prevEditOperationType, this.context.config, this.context.model, this.getSelections(), text));\r\n        }\r\n    };\r\n    Cursor.prototype._replacePreviousChar = function (text, replaceCharCnt) {\r\n        this._executeEditOperation(TypeOperations.replacePreviousChar(this._prevEditOperationType, this.context.config, this.context.model, this.getSelections(), text, replaceCharCnt));\r\n    };\r\n    Cursor.prototype._paste = function (text, pasteOnNewLine, multicursorText) {\r\n        this._executeEditOperation(TypeOperations.paste(this.context.config, this.context.model, this.getSelections(), text, pasteOnNewLine, multicursorText));\r\n    };\r\n    Cursor.prototype._cut = function () {\r\n        this._executeEditOperation(DeleteOperations.cut(this.context.config, this.context.model, this.getSelections()));\r\n    };\r\n    Cursor.prototype._externalExecuteCommand = function (command) {\r\n        this._cursors.killSecondaryCursors();\r\n        this._executeEditOperation(new EditOperationResult(0 /* Other */, [command], {\r\n            shouldPushStackElementBefore: false,\r\n            shouldPushStackElementAfter: false\r\n        }));\r\n    };\r\n    Cursor.prototype._externalExecuteCommands = function (commands) {\r\n        this._executeEditOperation(new EditOperationResult(0 /* Other */, commands, {\r\n            shouldPushStackElementBefore: false,\r\n            shouldPushStackElementAfter: false\r\n        }));\r\n    };\r\n    Cursor.MAX_CURSOR_COUNT = 10000;\r\n    return Cursor;\r\n}(viewEvents.ViewEventEmitter));\r\nexport { Cursor };\r\nvar CommandExecutor = /** @class */ (function () {\r\n    function CommandExecutor() {\r\n    }\r\n    CommandExecutor.executeCommands = function (model, selectionsBefore, commands) {\r\n        var ctx = {\r\n            model: model,\r\n            selectionsBefore: selectionsBefore,\r\n            trackedRanges: [],\r\n            trackedRangesDirection: []\r\n        };\r\n        var result = this._innerExecuteCommands(ctx, commands);\r\n        for (var i = 0, len = ctx.trackedRanges.length; i < len; i++) {\r\n            ctx.model._setTrackedRange(ctx.trackedRanges[i], null, 0 /* AlwaysGrowsWhenTypingAtEdges */);\r\n        }\r\n        return result;\r\n    };\r\n    CommandExecutor._innerExecuteCommands = function (ctx, commands) {\r\n        if (this._arrayIsEmpty(commands)) {\r\n            return null;\r\n        }\r\n        var commandsData = this._getEditOperations(ctx, commands);\r\n        if (commandsData.operations.length === 0) {\r\n            return null;\r\n        }\r\n        var rawOperations = commandsData.operations;\r\n        var loserCursorsMap = this._getLoserCursorMap(rawOperations);\r\n        if (loserCursorsMap.hasOwnProperty('0')) {\r\n            // These commands are very messed up\r\n            console.warn('Ignoring commands');\r\n            return null;\r\n        }\r\n        // Remove operations belonging to losing cursors\r\n        var filteredOperations = [];\r\n        for (var i = 0, len = rawOperations.length; i < len; i++) {\r\n            if (!loserCursorsMap.hasOwnProperty(rawOperations[i].identifier.major.toString())) {\r\n                filteredOperations.push(rawOperations[i]);\r\n            }\r\n        }\r\n        // TODO@Alex: find a better way to do this.\r\n        // give the hint that edit operations are tracked to the model\r\n        if (commandsData.hadTrackedEditOperation && filteredOperations.length > 0) {\r\n            filteredOperations[0]._isTracked = true;\r\n        }\r\n        var selectionsAfter = ctx.model.pushEditOperations(ctx.selectionsBefore, filteredOperations, function (inverseEditOperations) {\r\n            var groupedInverseEditOperations = [];\r\n            for (var i = 0; i < ctx.selectionsBefore.length; i++) {\r\n                groupedInverseEditOperations[i] = [];\r\n            }\r\n            for (var i = 0; i < inverseEditOperations.length; i++) {\r\n                var op = inverseEditOperations[i];\r\n                if (!op.identifier) {\r\n                    // perhaps auto whitespace trim edits\r\n                    continue;\r\n                }\r\n                groupedInverseEditOperations[op.identifier.major].push(op);\r\n            }\r\n            var minorBasedSorter = function (a, b) {\r\n                return a.identifier.minor - b.identifier.minor;\r\n            };\r\n            var cursorSelections = [];\r\n            var _loop_1 = function (i) {\r\n                if (groupedInverseEditOperations[i].length > 0) {\r\n                    groupedInverseEditOperations[i].sort(minorBasedSorter);\r\n                    cursorSelections[i] = commands[i].computeCursorState(ctx.model, {\r\n                        getInverseEditOperations: function () {\r\n                            return groupedInverseEditOperations[i];\r\n                        },\r\n                        getTrackedSelection: function (id) {\r\n                            var idx = parseInt(id, 10);\r\n                            var range = ctx.model._getTrackedRange(ctx.trackedRanges[idx]);\r\n                            if (ctx.trackedRangesDirection[idx] === 0 /* LTR */) {\r\n                                return new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\r\n                            }\r\n                            return new Selection(range.endLineNumber, range.endColumn, range.startLineNumber, range.startColumn);\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    cursorSelections[i] = ctx.selectionsBefore[i];\r\n                }\r\n            };\r\n            for (var i = 0; i < ctx.selectionsBefore.length; i++) {\r\n                _loop_1(i);\r\n            }\r\n            return cursorSelections;\r\n        });\r\n        if (!selectionsAfter) {\r\n            selectionsAfter = ctx.selectionsBefore;\r\n        }\r\n        // Extract losing cursors\r\n        var losingCursors = [];\r\n        for (var losingCursorIndex in loserCursorsMap) {\r\n            if (loserCursorsMap.hasOwnProperty(losingCursorIndex)) {\r\n                losingCursors.push(parseInt(losingCursorIndex, 10));\r\n            }\r\n        }\r\n        // Sort losing cursors descending\r\n        losingCursors.sort(function (a, b) {\r\n            return b - a;\r\n        });\r\n        // Remove losing cursors\r\n        for (var i = 0; i < losingCursors.length; i++) {\r\n            selectionsAfter.splice(losingCursors[i], 1);\r\n        }\r\n        return selectionsAfter;\r\n    };\r\n    CommandExecutor._arrayIsEmpty = function (commands) {\r\n        for (var i = 0, len = commands.length; i < len; i++) {\r\n            if (commands[i]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    CommandExecutor._getEditOperations = function (ctx, commands) {\r\n        var operations = [];\r\n        var hadTrackedEditOperation = false;\r\n        for (var i = 0, len = commands.length; i < len; i++) {\r\n            var command = commands[i];\r\n            if (command) {\r\n                var r = this._getEditOperationsFromCommand(ctx, i, command);\r\n                operations = operations.concat(r.operations);\r\n                hadTrackedEditOperation = hadTrackedEditOperation || r.hadTrackedEditOperation;\r\n            }\r\n        }\r\n        return {\r\n            operations: operations,\r\n            hadTrackedEditOperation: hadTrackedEditOperation\r\n        };\r\n    };\r\n    CommandExecutor._getEditOperationsFromCommand = function (ctx, majorIdentifier, command) {\r\n        // This method acts as a transaction, if the command fails\r\n        // everything it has done is ignored\r\n        var operations = [];\r\n        var operationMinor = 0;\r\n        var addEditOperation = function (selection, text) {\r\n            if (selection.isEmpty() && text === '') {\r\n                // This command wants to add a no-op => no thank you\r\n                return;\r\n            }\r\n            operations.push({\r\n                identifier: {\r\n                    major: majorIdentifier,\r\n                    minor: operationMinor++\r\n                },\r\n                range: selection,\r\n                text: text,\r\n                forceMoveMarkers: false,\r\n                isAutoWhitespaceEdit: command.insertsAutoWhitespace\r\n            });\r\n        };\r\n        var hadTrackedEditOperation = false;\r\n        var addTrackedEditOperation = function (selection, text) {\r\n            hadTrackedEditOperation = true;\r\n            addEditOperation(selection, text);\r\n        };\r\n        var trackSelection = function (selection, trackPreviousOnEmpty) {\r\n            var stickiness;\r\n            if (selection.isEmpty()) {\r\n                if (typeof trackPreviousOnEmpty === 'boolean') {\r\n                    if (trackPreviousOnEmpty) {\r\n                        stickiness = 2 /* GrowsOnlyWhenTypingBefore */;\r\n                    }\r\n                    else {\r\n                        stickiness = 3 /* GrowsOnlyWhenTypingAfter */;\r\n                    }\r\n                }\r\n                else {\r\n                    // Try to lock it with surrounding text\r\n                    var maxLineColumn = ctx.model.getLineMaxColumn(selection.startLineNumber);\r\n                    if (selection.startColumn === maxLineColumn) {\r\n                        stickiness = 2 /* GrowsOnlyWhenTypingBefore */;\r\n                    }\r\n                    else {\r\n                        stickiness = 3 /* GrowsOnlyWhenTypingAfter */;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                stickiness = 1 /* NeverGrowsWhenTypingAtEdges */;\r\n            }\r\n            var l = ctx.trackedRanges.length;\r\n            var id = ctx.model._setTrackedRange(null, selection, stickiness);\r\n            ctx.trackedRanges[l] = id;\r\n            ctx.trackedRangesDirection[l] = selection.getDirection();\r\n            return l.toString();\r\n        };\r\n        var editOperationBuilder = {\r\n            addEditOperation: addEditOperation,\r\n            addTrackedEditOperation: addTrackedEditOperation,\r\n            trackSelection: trackSelection\r\n        };\r\n        try {\r\n            command.getEditOperations(ctx.model, editOperationBuilder);\r\n        }\r\n        catch (e) {\r\n            e.friendlyMessage = nls.localize('corrupt.commands', \"Unexpected exception while executing command.\");\r\n            onUnexpectedError(e);\r\n            return {\r\n                operations: [],\r\n                hadTrackedEditOperation: false\r\n            };\r\n        }\r\n        return {\r\n            operations: operations,\r\n            hadTrackedEditOperation: hadTrackedEditOperation\r\n        };\r\n    };\r\n    CommandExecutor._getLoserCursorMap = function (operations) {\r\n        // This is destructive on the array\r\n        operations = operations.slice(0);\r\n        // Sort operations with last one first\r\n        operations.sort(function (a, b) {\r\n            // Note the minus!\r\n            return -(Range.compareRangesUsingEnds(a.range, b.range));\r\n        });\r\n        // Operations can not overlap!\r\n        var loserCursorsMap = {};\r\n        for (var i = 1; i < operations.length; i++) {\r\n            var previousOp = operations[i - 1];\r\n            var currentOp = operations[i];\r\n            if (previousOp.range.getStartPosition().isBefore(currentOp.range.getEndPosition())) {\r\n                var loserMajor = void 0;\r\n                if (previousOp.identifier.major > currentOp.identifier.major) {\r\n                    // previousOp loses the battle\r\n                    loserMajor = previousOp.identifier.major;\r\n                }\r\n                else {\r\n                    loserMajor = currentOp.identifier.major;\r\n                }\r\n                loserCursorsMap[loserMajor.toString()] = true;\r\n                for (var j = 0; j < operations.length; j++) {\r\n                    if (operations[j].identifier.major === loserMajor) {\r\n                        operations.splice(j, 1);\r\n                        if (j < i) {\r\n                            i--;\r\n                        }\r\n                        j--;\r\n                    }\r\n                }\r\n                if (i > 0) {\r\n                    i--;\r\n                }\r\n            }\r\n        }\r\n        return loserCursorsMap;\r\n    };\r\n    return CommandExecutor;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar InternalEditorAction = /** @class */ (function () {\r\n    function InternalEditorAction(id, label, alias, precondition, run, contextKeyService) {\r\n        this.id = id;\r\n        this.label = label;\r\n        this.alias = alias;\r\n        this._precondition = precondition;\r\n        this._run = run;\r\n        this._contextKeyService = contextKeyService;\r\n    }\r\n    InternalEditorAction.prototype.isSupported = function () {\r\n        return this._contextKeyService.contextMatchesRules(this._precondition);\r\n    };\r\n    InternalEditorAction.prototype.run = function () {\r\n        if (!this.isSupported()) {\r\n            return Promise.resolve(void 0);\r\n        }\r\n        var r = this._run();\r\n        return r ? r : Promise.resolve(void 0);\r\n    };\r\n    return InternalEditorAction;\r\n}());\r\nexport { InternalEditorAction };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { LineTokens } from '../core/lineTokens.js';\r\nimport { NULL_STATE, nullTokenize2 } from './nullMode.js';\r\nvar fallback = {\r\n    getInitialState: function () { return NULL_STATE; },\r\n    tokenize2: function (buffer, state, deltaOffset) { return nullTokenize2(0 /* Null */, buffer, state, deltaOffset); }\r\n};\r\nexport function tokenizeToString(text, tokenizationSupport) {\r\n    if (tokenizationSupport === void 0) { tokenizationSupport = fallback; }\r\n    return _tokenizeToString(text, tokenizationSupport || fallback);\r\n}\r\nexport function tokenizeLineToHTML(text, viewLineTokens, colorMap, startOffset, endOffset, tabSize) {\r\n    var result = \"<div>\";\r\n    var charIndex = startOffset;\r\n    var tabsCharDelta = 0;\r\n    for (var tokenIndex = 0, tokenCount = viewLineTokens.getCount(); tokenIndex < tokenCount; tokenIndex++) {\r\n        var tokenEndIndex = viewLineTokens.getEndOffset(tokenIndex);\r\n        if (tokenEndIndex <= startOffset) {\r\n            continue;\r\n        }\r\n        var partContent = '';\r\n        for (; charIndex < tokenEndIndex && charIndex < endOffset; charIndex++) {\r\n            var charCode = text.charCodeAt(charIndex);\r\n            switch (charCode) {\r\n                case 9 /* Tab */:\r\n                    var insertSpacesCount = tabSize - (charIndex + tabsCharDelta) % tabSize;\r\n                    tabsCharDelta += insertSpacesCount - 1;\r\n                    while (insertSpacesCount > 0) {\r\n                        partContent += '&nbsp;';\r\n                        insertSpacesCount--;\r\n                    }\r\n                    break;\r\n                case 60 /* LessThan */:\r\n                    partContent += '&lt;';\r\n                    break;\r\n                case 62 /* GreaterThan */:\r\n                    partContent += '&gt;';\r\n                    break;\r\n                case 38 /* Ampersand */:\r\n                    partContent += '&amp;';\r\n                    break;\r\n                case 0 /* Null */:\r\n                    partContent += '&#00;';\r\n                    break;\r\n                case 65279 /* UTF8_BOM */:\r\n                case 8232 /* LINE_SEPARATOR_2028 */:\r\n                    partContent += '\\ufffd';\r\n                    break;\r\n                case 13 /* CarriageReturn */:\r\n                    // zero width space, because carriage return would introduce a line break\r\n                    partContent += '&#8203';\r\n                    break;\r\n                default:\r\n                    partContent += String.fromCharCode(charCode);\r\n            }\r\n        }\r\n        result += \"<span style=\\\"\" + viewLineTokens.getInlineStyle(tokenIndex, colorMap) + \"\\\">\" + partContent + \"</span>\";\r\n        if (tokenEndIndex > endOffset || charIndex >= endOffset) {\r\n            break;\r\n        }\r\n    }\r\n    result += \"</div>\";\r\n    return result;\r\n}\r\nfunction _tokenizeToString(text, tokenizationSupport) {\r\n    var result = \"<div class=\\\"monaco-tokenized-source\\\">\";\r\n    var lines = text.split(/\\r\\n|\\r|\\n/);\r\n    var currentState = tokenizationSupport.getInitialState();\r\n    for (var i = 0, len = lines.length; i < len; i++) {\r\n        var line = lines[i];\r\n        if (i > 0) {\r\n            result += \"<br/>\";\r\n        }\r\n        var tokenizationResult = tokenizationSupport.tokenize2(line, currentState, 0);\r\n        LineTokens.convertToEndOffset(tokenizationResult.tokens, line.length);\r\n        var lineTokens = new LineTokens(tokenizationResult.tokens, line);\r\n        var viewLineTokens = lineTokens.inflate();\r\n        var startOffset = 0;\r\n        for (var j = 0, lenJ = viewLineTokens.getCount(); j < lenJ; j++) {\r\n            var type = viewLineTokens.getClassName(j);\r\n            var endIndex = viewLineTokens.getEndOffset(j);\r\n            result += \"<span class=\\\"\" + type + \"\\\">\" + strings.escape(line.substring(startOffset, endIndex)) + \"</span>\";\r\n            startOffset = endIndex;\r\n        }\r\n        currentState = tokenizationResult.endState;\r\n    }\r\n    result += \"</div>\";\r\n    return result;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/**\r\n * Represent whitespaces in between lines and provide fast CRUD management methods.\r\n * The whitespaces are sorted ascending by `afterLineNumber`.\r\n */\r\nvar WhitespaceComputer = /** @class */ (function () {\r\n    function WhitespaceComputer() {\r\n        this._heights = [];\r\n        this._minWidths = [];\r\n        this._ids = [];\r\n        this._afterLineNumbers = [];\r\n        this._ordinals = [];\r\n        this._prefixSum = [];\r\n        this._prefixSumValidIndex = -1;\r\n        this._whitespaceId2Index = {};\r\n        this._lastWhitespaceId = 0;\r\n        this._minWidth = -1; /* marker for not being computed */\r\n    }\r\n    /**\r\n     * Find the insertion index for a new value inside a sorted array of values.\r\n     * If the value is already present in the sorted array, the insertion index will be after the already existing value.\r\n     */\r\n    WhitespaceComputer.findInsertionIndex = function (sortedArray, value, ordinals, valueOrdinal) {\r\n        var low = 0;\r\n        var high = sortedArray.length;\r\n        while (low < high) {\r\n            var mid = ((low + high) >>> 1);\r\n            if (value === sortedArray[mid]) {\r\n                if (valueOrdinal < ordinals[mid]) {\r\n                    high = mid;\r\n                }\r\n                else {\r\n                    low = mid + 1;\r\n                }\r\n            }\r\n            else if (value < sortedArray[mid]) {\r\n                high = mid;\r\n            }\r\n            else {\r\n                low = mid + 1;\r\n            }\r\n        }\r\n        return low;\r\n    };\r\n    /**\r\n     * Insert a new whitespace of a certain height after a line number.\r\n     * The whitespace has a \"sticky\" characteristic.\r\n     * Irrespective of edits above or below `afterLineNumber`, the whitespace will follow the initial line.\r\n     *\r\n     * @param afterLineNumber The conceptual position of this whitespace. The whitespace will follow this line as best as possible even when deleting/inserting lines above/below.\r\n     * @param heightInPx The height of the whitespace, in pixels.\r\n     * @return An id that can be used later to mutate or delete the whitespace\r\n     */\r\n    WhitespaceComputer.prototype.insertWhitespace = function (afterLineNumber, ordinal, heightInPx, minWidth) {\r\n        afterLineNumber = afterLineNumber | 0;\r\n        ordinal = ordinal | 0;\r\n        heightInPx = heightInPx | 0;\r\n        minWidth = minWidth | 0;\r\n        var id = (++this._lastWhitespaceId);\r\n        var insertionIndex = WhitespaceComputer.findInsertionIndex(this._afterLineNumbers, afterLineNumber, this._ordinals, ordinal);\r\n        this._insertWhitespaceAtIndex(id, insertionIndex, afterLineNumber, ordinal, heightInPx, minWidth);\r\n        this._minWidth = -1; /* marker for not being computed */\r\n        return id;\r\n    };\r\n    WhitespaceComputer.prototype._insertWhitespaceAtIndex = function (id, insertIndex, afterLineNumber, ordinal, heightInPx, minWidth) {\r\n        id = id | 0;\r\n        insertIndex = insertIndex | 0;\r\n        afterLineNumber = afterLineNumber | 0;\r\n        ordinal = ordinal | 0;\r\n        heightInPx = heightInPx | 0;\r\n        minWidth = minWidth | 0;\r\n        this._heights.splice(insertIndex, 0, heightInPx);\r\n        this._minWidths.splice(insertIndex, 0, minWidth);\r\n        this._ids.splice(insertIndex, 0, id);\r\n        this._afterLineNumbers.splice(insertIndex, 0, afterLineNumber);\r\n        this._ordinals.splice(insertIndex, 0, ordinal);\r\n        this._prefixSum.splice(insertIndex, 0, 0);\r\n        var keys = Object.keys(this._whitespaceId2Index);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var sid = keys[i];\r\n            var oldIndex = this._whitespaceId2Index[sid];\r\n            if (oldIndex >= insertIndex) {\r\n                this._whitespaceId2Index[sid] = oldIndex + 1;\r\n            }\r\n        }\r\n        this._whitespaceId2Index[id.toString()] = insertIndex;\r\n        this._prefixSumValidIndex = Math.min(this._prefixSumValidIndex, insertIndex - 1);\r\n    };\r\n    /**\r\n     * Change properties associated with a certain whitespace.\r\n     */\r\n    WhitespaceComputer.prototype.changeWhitespace = function (id, newAfterLineNumber, newHeight) {\r\n        id = id | 0;\r\n        newAfterLineNumber = newAfterLineNumber | 0;\r\n        newHeight = newHeight | 0;\r\n        var hasChanges = false;\r\n        hasChanges = this.changeWhitespaceHeight(id, newHeight) || hasChanges;\r\n        hasChanges = this.changeWhitespaceAfterLineNumber(id, newAfterLineNumber) || hasChanges;\r\n        return hasChanges;\r\n    };\r\n    /**\r\n     * Change the height of an existing whitespace\r\n     *\r\n     * @param id The whitespace to change\r\n     * @param newHeightInPx The new height of the whitespace, in pixels\r\n     * @return Returns true if the whitespace is found and if the new height is different than the old height\r\n     */\r\n    WhitespaceComputer.prototype.changeWhitespaceHeight = function (id, newHeightInPx) {\r\n        id = id | 0;\r\n        newHeightInPx = newHeightInPx | 0;\r\n        var sid = id.toString();\r\n        if (this._whitespaceId2Index.hasOwnProperty(sid)) {\r\n            var index = this._whitespaceId2Index[sid];\r\n            if (this._heights[index] !== newHeightInPx) {\r\n                this._heights[index] = newHeightInPx;\r\n                this._prefixSumValidIndex = Math.min(this._prefixSumValidIndex, index - 1);\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * Change the line number after which an existing whitespace flows.\r\n     *\r\n     * @param id The whitespace to change\r\n     * @param newAfterLineNumber The new line number the whitespace will follow\r\n     * @return Returns true if the whitespace is found and if the new line number is different than the old line number\r\n     */\r\n    WhitespaceComputer.prototype.changeWhitespaceAfterLineNumber = function (id, newAfterLineNumber) {\r\n        id = id | 0;\r\n        newAfterLineNumber = newAfterLineNumber | 0;\r\n        var sid = id.toString();\r\n        if (this._whitespaceId2Index.hasOwnProperty(sid)) {\r\n            var index = this._whitespaceId2Index[sid];\r\n            if (this._afterLineNumbers[index] !== newAfterLineNumber) {\r\n                // `afterLineNumber` changed for this whitespace\r\n                // Record old ordinal\r\n                var ordinal = this._ordinals[index];\r\n                // Record old height\r\n                var heightInPx = this._heights[index];\r\n                // Record old min width\r\n                var minWidth = this._minWidths[index];\r\n                // Since changing `afterLineNumber` can trigger a reordering, we're gonna remove this whitespace\r\n                this.removeWhitespace(id);\r\n                // And add it again\r\n                var insertionIndex = WhitespaceComputer.findInsertionIndex(this._afterLineNumbers, newAfterLineNumber, this._ordinals, ordinal);\r\n                this._insertWhitespaceAtIndex(id, insertionIndex, newAfterLineNumber, ordinal, heightInPx, minWidth);\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * Remove an existing whitespace.\r\n     *\r\n     * @param id The whitespace to remove\r\n     * @return Returns true if the whitespace is found and it is removed.\r\n     */\r\n    WhitespaceComputer.prototype.removeWhitespace = function (id) {\r\n        id = id | 0;\r\n        var sid = id.toString();\r\n        if (this._whitespaceId2Index.hasOwnProperty(sid)) {\r\n            var index = this._whitespaceId2Index[sid];\r\n            delete this._whitespaceId2Index[sid];\r\n            this._removeWhitespaceAtIndex(index);\r\n            this._minWidth = -1; /* marker for not being computed */\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    WhitespaceComputer.prototype._removeWhitespaceAtIndex = function (removeIndex) {\r\n        removeIndex = removeIndex | 0;\r\n        this._heights.splice(removeIndex, 1);\r\n        this._minWidths.splice(removeIndex, 1);\r\n        this._ids.splice(removeIndex, 1);\r\n        this._afterLineNumbers.splice(removeIndex, 1);\r\n        this._ordinals.splice(removeIndex, 1);\r\n        this._prefixSum.splice(removeIndex, 1);\r\n        this._prefixSumValidIndex = Math.min(this._prefixSumValidIndex, removeIndex - 1);\r\n        var keys = Object.keys(this._whitespaceId2Index);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var sid = keys[i];\r\n            var oldIndex = this._whitespaceId2Index[sid];\r\n            if (oldIndex >= removeIndex) {\r\n                this._whitespaceId2Index[sid] = oldIndex - 1;\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Notify the computer that lines have been deleted (a continuous zone of lines).\r\n     * This gives it a chance to update `afterLineNumber` for whitespaces, giving the \"sticky\" characteristic.\r\n     *\r\n     * @param fromLineNumber The line number at which the deletion started, inclusive\r\n     * @param toLineNumber The line number at which the deletion ended, inclusive\r\n     */\r\n    WhitespaceComputer.prototype.onLinesDeleted = function (fromLineNumber, toLineNumber) {\r\n        fromLineNumber = fromLineNumber | 0;\r\n        toLineNumber = toLineNumber | 0;\r\n        for (var i = 0, len = this._afterLineNumbers.length; i < len; i++) {\r\n            var afterLineNumber = this._afterLineNumbers[i];\r\n            if (fromLineNumber <= afterLineNumber && afterLineNumber <= toLineNumber) {\r\n                // The line this whitespace was after has been deleted\r\n                //  => move whitespace to before first deleted line\r\n                this._afterLineNumbers[i] = fromLineNumber - 1;\r\n            }\r\n            else if (afterLineNumber > toLineNumber) {\r\n                // The line this whitespace was after has been moved up\r\n                //  => move whitespace up\r\n                this._afterLineNumbers[i] -= (toLineNumber - fromLineNumber + 1);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Notify the computer that lines have been inserted (a continuous zone of lines).\r\n     * This gives it a chance to update `afterLineNumber` for whitespaces, giving the \"sticky\" characteristic.\r\n     *\r\n     * @param fromLineNumber The line number at which the insertion started, inclusive\r\n     * @param toLineNumber The line number at which the insertion ended, inclusive.\r\n     */\r\n    WhitespaceComputer.prototype.onLinesInserted = function (fromLineNumber, toLineNumber) {\r\n        fromLineNumber = fromLineNumber | 0;\r\n        toLineNumber = toLineNumber | 0;\r\n        for (var i = 0, len = this._afterLineNumbers.length; i < len; i++) {\r\n            var afterLineNumber = this._afterLineNumbers[i];\r\n            if (fromLineNumber <= afterLineNumber) {\r\n                this._afterLineNumbers[i] += (toLineNumber - fromLineNumber + 1);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Get the sum of all the whitespaces.\r\n     */\r\n    WhitespaceComputer.prototype.getTotalHeight = function () {\r\n        if (this._heights.length === 0) {\r\n            return 0;\r\n        }\r\n        return this.getAccumulatedHeight(this._heights.length - 1);\r\n    };\r\n    /**\r\n     * Return the sum of the heights of the whitespaces at [0..index].\r\n     * This includes the whitespace at `index`.\r\n     *\r\n     * @param index The index of the whitespace.\r\n     * @return The sum of the heights of all whitespaces before the one at `index`, including the one at `index`.\r\n     */\r\n    WhitespaceComputer.prototype.getAccumulatedHeight = function (index) {\r\n        index = index | 0;\r\n        var startIndex = Math.max(0, this._prefixSumValidIndex + 1);\r\n        if (startIndex === 0) {\r\n            this._prefixSum[0] = this._heights[0];\r\n            startIndex++;\r\n        }\r\n        for (var i = startIndex; i <= index; i++) {\r\n            this._prefixSum[i] = this._prefixSum[i - 1] + this._heights[i];\r\n        }\r\n        this._prefixSumValidIndex = Math.max(this._prefixSumValidIndex, index);\r\n        return this._prefixSum[index];\r\n    };\r\n    /**\r\n     * Find all whitespaces with `afterLineNumber` < `lineNumber` and return the sum of their heights.\r\n     *\r\n     * @param lineNumber The line number whitespaces should be before.\r\n     * @return The sum of the heights of the whitespaces before `lineNumber`.\r\n     */\r\n    WhitespaceComputer.prototype.getAccumulatedHeightBeforeLineNumber = function (lineNumber) {\r\n        lineNumber = lineNumber | 0;\r\n        var lastWhitespaceBeforeLineNumber = this._findLastWhitespaceBeforeLineNumber(lineNumber);\r\n        if (lastWhitespaceBeforeLineNumber === -1) {\r\n            return 0;\r\n        }\r\n        return this.getAccumulatedHeight(lastWhitespaceBeforeLineNumber);\r\n    };\r\n    WhitespaceComputer.prototype._findLastWhitespaceBeforeLineNumber = function (lineNumber) {\r\n        lineNumber = lineNumber | 0;\r\n        // Find the whitespace before line number\r\n        var afterLineNumbers = this._afterLineNumbers;\r\n        var low = 0;\r\n        var high = afterLineNumbers.length - 1;\r\n        while (low <= high) {\r\n            var delta = (high - low) | 0;\r\n            var halfDelta = (delta / 2) | 0;\r\n            var mid = (low + halfDelta) | 0;\r\n            if (afterLineNumbers[mid] < lineNumber) {\r\n                if (mid + 1 >= afterLineNumbers.length || afterLineNumbers[mid + 1] >= lineNumber) {\r\n                    return mid;\r\n                }\r\n                else {\r\n                    low = (mid + 1) | 0;\r\n                }\r\n            }\r\n            else {\r\n                high = (mid - 1) | 0;\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n    WhitespaceComputer.prototype._findFirstWhitespaceAfterLineNumber = function (lineNumber) {\r\n        lineNumber = lineNumber | 0;\r\n        var lastWhitespaceBeforeLineNumber = this._findLastWhitespaceBeforeLineNumber(lineNumber);\r\n        var firstWhitespaceAfterLineNumber = lastWhitespaceBeforeLineNumber + 1;\r\n        if (firstWhitespaceAfterLineNumber < this._heights.length) {\r\n            return firstWhitespaceAfterLineNumber;\r\n        }\r\n        return -1;\r\n    };\r\n    /**\r\n     * Find the index of the first whitespace which has `afterLineNumber` >= `lineNumber`.\r\n     * @return The index of the first whitespace with `afterLineNumber` >= `lineNumber` or -1 if no whitespace is found.\r\n     */\r\n    WhitespaceComputer.prototype.getFirstWhitespaceIndexAfterLineNumber = function (lineNumber) {\r\n        lineNumber = lineNumber | 0;\r\n        return this._findFirstWhitespaceAfterLineNumber(lineNumber);\r\n    };\r\n    /**\r\n     * The number of whitespaces.\r\n     */\r\n    WhitespaceComputer.prototype.getCount = function () {\r\n        return this._heights.length;\r\n    };\r\n    /**\r\n     * The maximum min width for all whitespaces.\r\n     */\r\n    WhitespaceComputer.prototype.getMinWidth = function () {\r\n        if (this._minWidth === -1) {\r\n            var minWidth = 0;\r\n            for (var i = 0, len = this._minWidths.length; i < len; i++) {\r\n                minWidth = Math.max(minWidth, this._minWidths[i]);\r\n            }\r\n            this._minWidth = minWidth;\r\n        }\r\n        return this._minWidth;\r\n    };\r\n    /**\r\n     * Get the `afterLineNumber` for whitespace at index `index`.\r\n     *\r\n     * @param index The index of the whitespace.\r\n     * @return `afterLineNumber` of whitespace at `index`.\r\n     */\r\n    WhitespaceComputer.prototype.getAfterLineNumberForWhitespaceIndex = function (index) {\r\n        index = index | 0;\r\n        return this._afterLineNumbers[index];\r\n    };\r\n    /**\r\n     * Get the `id` for whitespace at index `index`.\r\n     *\r\n     * @param index The index of the whitespace.\r\n     * @return `id` of whitespace at `index`.\r\n     */\r\n    WhitespaceComputer.prototype.getIdForWhitespaceIndex = function (index) {\r\n        index = index | 0;\r\n        return this._ids[index];\r\n    };\r\n    /**\r\n     * Get the `height` for whitespace at index `index`.\r\n     *\r\n     * @param index The index of the whitespace.\r\n     * @return `height` of whitespace at `index`.\r\n     */\r\n    WhitespaceComputer.prototype.getHeightForWhitespaceIndex = function (index) {\r\n        index = index | 0;\r\n        return this._heights[index];\r\n    };\r\n    /**\r\n     * Get all whitespaces.\r\n     */\r\n    WhitespaceComputer.prototype.getWhitespaces = function (deviceLineHeight) {\r\n        deviceLineHeight = deviceLineHeight | 0;\r\n        var result = [];\r\n        for (var i = 0; i < this._heights.length; i++) {\r\n            result.push({\r\n                id: this._ids[i],\r\n                afterLineNumber: this._afterLineNumbers[i],\r\n                heightInLines: this._heights[i] / deviceLineHeight\r\n            });\r\n        }\r\n        return result;\r\n    };\r\n    return WhitespaceComputer;\r\n}());\r\nexport { WhitespaceComputer };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { WhitespaceComputer } from './whitespaceComputer.js';\r\n/**\r\n * Layouting of objects that take vertical space (by having a height) and push down other objects.\r\n *\r\n * These objects are basically either text (lines) or spaces between those lines (whitespaces).\r\n * This provides commodity operations for working with lines that contain whitespace that pushes lines lower (vertically).\r\n * This is written with no knowledge of an editor in mind.\r\n */\r\nvar LinesLayout = /** @class */ (function () {\r\n    function LinesLayout(lineCount, lineHeight) {\r\n        this._lineCount = lineCount;\r\n        this._lineHeight = lineHeight;\r\n        this._whitespaces = new WhitespaceComputer();\r\n    }\r\n    /**\r\n     * Change the height of a line in pixels.\r\n     */\r\n    LinesLayout.prototype.setLineHeight = function (lineHeight) {\r\n        this._lineHeight = lineHeight;\r\n    };\r\n    /**\r\n     * Set the number of lines.\r\n     *\r\n     * @param lineCount New number of lines.\r\n     */\r\n    LinesLayout.prototype.onFlushed = function (lineCount) {\r\n        this._lineCount = lineCount;\r\n    };\r\n    /**\r\n     * Insert a new whitespace of a certain height after a line number.\r\n     * The whitespace has a \"sticky\" characteristic.\r\n     * Irrespective of edits above or below `afterLineNumber`, the whitespace will follow the initial line.\r\n     *\r\n     * @param afterLineNumber The conceptual position of this whitespace. The whitespace will follow this line as best as possible even when deleting/inserting lines above/below.\r\n     * @param heightInPx The height of the whitespace, in pixels.\r\n     * @return An id that can be used later to mutate or delete the whitespace\r\n     */\r\n    LinesLayout.prototype.insertWhitespace = function (afterLineNumber, ordinal, heightInPx, minWidth) {\r\n        return this._whitespaces.insertWhitespace(afterLineNumber, ordinal, heightInPx, minWidth);\r\n    };\r\n    /**\r\n     * Change properties associated with a certain whitespace.\r\n     */\r\n    LinesLayout.prototype.changeWhitespace = function (id, newAfterLineNumber, newHeight) {\r\n        return this._whitespaces.changeWhitespace(id, newAfterLineNumber, newHeight);\r\n    };\r\n    /**\r\n     * Remove an existing whitespace.\r\n     *\r\n     * @param id The whitespace to remove\r\n     * @return Returns true if the whitespace is found and it is removed.\r\n     */\r\n    LinesLayout.prototype.removeWhitespace = function (id) {\r\n        return this._whitespaces.removeWhitespace(id);\r\n    };\r\n    /**\r\n     * Notify the layouter that lines have been deleted (a continuous zone of lines).\r\n     *\r\n     * @param fromLineNumber The line number at which the deletion started, inclusive\r\n     * @param toLineNumber The line number at which the deletion ended, inclusive\r\n     */\r\n    LinesLayout.prototype.onLinesDeleted = function (fromLineNumber, toLineNumber) {\r\n        this._lineCount -= (toLineNumber - fromLineNumber + 1);\r\n        this._whitespaces.onLinesDeleted(fromLineNumber, toLineNumber);\r\n    };\r\n    /**\r\n     * Notify the layouter that lines have been inserted (a continuous zone of lines).\r\n     *\r\n     * @param fromLineNumber The line number at which the insertion started, inclusive\r\n     * @param toLineNumber The line number at which the insertion ended, inclusive.\r\n     */\r\n    LinesLayout.prototype.onLinesInserted = function (fromLineNumber, toLineNumber) {\r\n        this._lineCount += (toLineNumber - fromLineNumber + 1);\r\n        this._whitespaces.onLinesInserted(fromLineNumber, toLineNumber);\r\n    };\r\n    /**\r\n     * Get the sum of heights for all objects.\r\n     *\r\n     * @return The sum of heights for all objects.\r\n     */\r\n    LinesLayout.prototype.getLinesTotalHeight = function () {\r\n        var linesHeight = this._lineHeight * this._lineCount;\r\n        var whitespacesHeight = this._whitespaces.getTotalHeight();\r\n        return linesHeight + whitespacesHeight;\r\n    };\r\n    /**\r\n     * Get the vertical offset (the sum of heights for all objects above) a certain line number.\r\n     *\r\n     * @param lineNumber The line number\r\n     * @return The sum of heights for all objects above `lineNumber`.\r\n     */\r\n    LinesLayout.prototype.getVerticalOffsetForLineNumber = function (lineNumber) {\r\n        lineNumber = lineNumber | 0;\r\n        var previousLinesHeight;\r\n        if (lineNumber > 1) {\r\n            previousLinesHeight = this._lineHeight * (lineNumber - 1);\r\n        }\r\n        else {\r\n            previousLinesHeight = 0;\r\n        }\r\n        var previousWhitespacesHeight = this._whitespaces.getAccumulatedHeightBeforeLineNumber(lineNumber);\r\n        return previousLinesHeight + previousWhitespacesHeight;\r\n    };\r\n    /**\r\n     * Returns the accumulated height of whitespaces before the given line number.\r\n     *\r\n     * @param lineNumber The line number\r\n     */\r\n    LinesLayout.prototype.getWhitespaceAccumulatedHeightBeforeLineNumber = function (lineNumber) {\r\n        return this._whitespaces.getAccumulatedHeightBeforeLineNumber(lineNumber);\r\n    };\r\n    LinesLayout.prototype.getWhitespaceMinWidth = function () {\r\n        return this._whitespaces.getMinWidth();\r\n    };\r\n    /**\r\n     * Check if `verticalOffset` is below all lines.\r\n     */\r\n    LinesLayout.prototype.isAfterLines = function (verticalOffset) {\r\n        var totalHeight = this.getLinesTotalHeight();\r\n        return verticalOffset > totalHeight;\r\n    };\r\n    /**\r\n     * Find the first line number that is at or after vertical offset `verticalOffset`.\r\n     * i.e. if getVerticalOffsetForLine(line) is x and getVerticalOffsetForLine(line + 1) is y, then\r\n     * getLineNumberAtOrAfterVerticalOffset(i) = line, x <= i < y.\r\n     *\r\n     * @param verticalOffset The vertical offset to search at.\r\n     * @return The line number at or after vertical offset `verticalOffset`.\r\n     */\r\n    LinesLayout.prototype.getLineNumberAtOrAfterVerticalOffset = function (verticalOffset) {\r\n        verticalOffset = verticalOffset | 0;\r\n        if (verticalOffset < 0) {\r\n            return 1;\r\n        }\r\n        var linesCount = this._lineCount | 0;\r\n        var lineHeight = this._lineHeight;\r\n        var minLineNumber = 1;\r\n        var maxLineNumber = linesCount;\r\n        while (minLineNumber < maxLineNumber) {\r\n            var midLineNumber = ((minLineNumber + maxLineNumber) / 2) | 0;\r\n            var midLineNumberVerticalOffset = this.getVerticalOffsetForLineNumber(midLineNumber) | 0;\r\n            if (verticalOffset >= midLineNumberVerticalOffset + lineHeight) {\r\n                // vertical offset is after mid line number\r\n                minLineNumber = midLineNumber + 1;\r\n            }\r\n            else if (verticalOffset >= midLineNumberVerticalOffset) {\r\n                // Hit\r\n                return midLineNumber;\r\n            }\r\n            else {\r\n                // vertical offset is before mid line number, but mid line number could still be what we're searching for\r\n                maxLineNumber = midLineNumber;\r\n            }\r\n        }\r\n        if (minLineNumber > linesCount) {\r\n            return linesCount;\r\n        }\r\n        return minLineNumber;\r\n    };\r\n    /**\r\n     * Get all the lines and their relative vertical offsets that are positioned between `verticalOffset1` and `verticalOffset2`.\r\n     *\r\n     * @param verticalOffset1 The beginning of the viewport.\r\n     * @param verticalOffset2 The end of the viewport.\r\n     * @return A structure describing the lines positioned between `verticalOffset1` and `verticalOffset2`.\r\n     */\r\n    LinesLayout.prototype.getLinesViewportData = function (verticalOffset1, verticalOffset2) {\r\n        verticalOffset1 = verticalOffset1 | 0;\r\n        verticalOffset2 = verticalOffset2 | 0;\r\n        var lineHeight = this._lineHeight;\r\n        // Find first line number\r\n        // We don't live in a perfect world, so the line number might start before or after verticalOffset1\r\n        var startLineNumber = this.getLineNumberAtOrAfterVerticalOffset(verticalOffset1) | 0;\r\n        var startLineNumberVerticalOffset = this.getVerticalOffsetForLineNumber(startLineNumber) | 0;\r\n        var endLineNumber = this._lineCount | 0;\r\n        // Also keep track of what whitespace we've got\r\n        var whitespaceIndex = this._whitespaces.getFirstWhitespaceIndexAfterLineNumber(startLineNumber) | 0;\r\n        var whitespaceCount = this._whitespaces.getCount() | 0;\r\n        var currentWhitespaceHeight;\r\n        var currentWhitespaceAfterLineNumber;\r\n        if (whitespaceIndex === -1) {\r\n            whitespaceIndex = whitespaceCount;\r\n            currentWhitespaceAfterLineNumber = endLineNumber + 1;\r\n            currentWhitespaceHeight = 0;\r\n        }\r\n        else {\r\n            currentWhitespaceAfterLineNumber = this._whitespaces.getAfterLineNumberForWhitespaceIndex(whitespaceIndex) | 0;\r\n            currentWhitespaceHeight = this._whitespaces.getHeightForWhitespaceIndex(whitespaceIndex) | 0;\r\n        }\r\n        var currentVerticalOffset = startLineNumberVerticalOffset;\r\n        var currentLineRelativeOffset = currentVerticalOffset;\r\n        // IE (all versions) cannot handle units above about 1,533,908 px, so every 500k pixels bring numbers down\r\n        var STEP_SIZE = 500000;\r\n        var bigNumbersDelta = 0;\r\n        if (startLineNumberVerticalOffset >= STEP_SIZE) {\r\n            // Compute a delta that guarantees that lines are positioned at `lineHeight` increments\r\n            bigNumbersDelta = Math.floor(startLineNumberVerticalOffset / STEP_SIZE) * STEP_SIZE;\r\n            bigNumbersDelta = Math.floor(bigNumbersDelta / lineHeight) * lineHeight;\r\n            currentLineRelativeOffset -= bigNumbersDelta;\r\n        }\r\n        var linesOffsets = [];\r\n        var verticalCenter = verticalOffset1 + (verticalOffset2 - verticalOffset1) / 2;\r\n        var centeredLineNumber = -1;\r\n        // Figure out how far the lines go\r\n        for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n            if (centeredLineNumber === -1) {\r\n                var currentLineTop = currentVerticalOffset;\r\n                var currentLineBottom = currentVerticalOffset + lineHeight;\r\n                if ((currentLineTop <= verticalCenter && verticalCenter < currentLineBottom) || currentLineTop > verticalCenter) {\r\n                    centeredLineNumber = lineNumber;\r\n                }\r\n            }\r\n            // Count current line height in the vertical offsets\r\n            currentVerticalOffset += lineHeight;\r\n            linesOffsets[lineNumber - startLineNumber] = currentLineRelativeOffset;\r\n            // Next line starts immediately after this one\r\n            currentLineRelativeOffset += lineHeight;\r\n            while (currentWhitespaceAfterLineNumber === lineNumber) {\r\n                // Push down next line with the height of the current whitespace\r\n                currentLineRelativeOffset += currentWhitespaceHeight;\r\n                // Count current whitespace in the vertical offsets\r\n                currentVerticalOffset += currentWhitespaceHeight;\r\n                whitespaceIndex++;\r\n                if (whitespaceIndex >= whitespaceCount) {\r\n                    currentWhitespaceAfterLineNumber = endLineNumber + 1;\r\n                }\r\n                else {\r\n                    currentWhitespaceAfterLineNumber = this._whitespaces.getAfterLineNumberForWhitespaceIndex(whitespaceIndex) | 0;\r\n                    currentWhitespaceHeight = this._whitespaces.getHeightForWhitespaceIndex(whitespaceIndex) | 0;\r\n                }\r\n            }\r\n            if (currentVerticalOffset >= verticalOffset2) {\r\n                // We have covered the entire viewport area, time to stop\r\n                endLineNumber = lineNumber;\r\n                break;\r\n            }\r\n        }\r\n        if (centeredLineNumber === -1) {\r\n            centeredLineNumber = endLineNumber;\r\n        }\r\n        var endLineNumberVerticalOffset = this.getVerticalOffsetForLineNumber(endLineNumber) | 0;\r\n        var completelyVisibleStartLineNumber = startLineNumber;\r\n        var completelyVisibleEndLineNumber = endLineNumber;\r\n        if (completelyVisibleStartLineNumber < completelyVisibleEndLineNumber) {\r\n            if (startLineNumberVerticalOffset < verticalOffset1) {\r\n                completelyVisibleStartLineNumber++;\r\n            }\r\n        }\r\n        if (completelyVisibleStartLineNumber < completelyVisibleEndLineNumber) {\r\n            if (endLineNumberVerticalOffset + lineHeight > verticalOffset2) {\r\n                completelyVisibleEndLineNumber--;\r\n            }\r\n        }\r\n        return {\r\n            bigNumbersDelta: bigNumbersDelta,\r\n            startLineNumber: startLineNumber,\r\n            endLineNumber: endLineNumber,\r\n            relativeVerticalOffset: linesOffsets,\r\n            centeredLineNumber: centeredLineNumber,\r\n            completelyVisibleStartLineNumber: completelyVisibleStartLineNumber,\r\n            completelyVisibleEndLineNumber: completelyVisibleEndLineNumber\r\n        };\r\n    };\r\n    LinesLayout.prototype.getVerticalOffsetForWhitespaceIndex = function (whitespaceIndex) {\r\n        whitespaceIndex = whitespaceIndex | 0;\r\n        var afterLineNumber = this._whitespaces.getAfterLineNumberForWhitespaceIndex(whitespaceIndex);\r\n        var previousLinesHeight;\r\n        if (afterLineNumber >= 1) {\r\n            previousLinesHeight = this._lineHeight * afterLineNumber;\r\n        }\r\n        else {\r\n            previousLinesHeight = 0;\r\n        }\r\n        var previousWhitespacesHeight;\r\n        if (whitespaceIndex > 0) {\r\n            previousWhitespacesHeight = this._whitespaces.getAccumulatedHeight(whitespaceIndex - 1);\r\n        }\r\n        else {\r\n            previousWhitespacesHeight = 0;\r\n        }\r\n        return previousLinesHeight + previousWhitespacesHeight;\r\n    };\r\n    LinesLayout.prototype.getWhitespaceIndexAtOrAfterVerticallOffset = function (verticalOffset) {\r\n        verticalOffset = verticalOffset | 0;\r\n        var midWhitespaceIndex, minWhitespaceIndex = 0, maxWhitespaceIndex = this._whitespaces.getCount() - 1, midWhitespaceVerticalOffset, midWhitespaceHeight;\r\n        if (maxWhitespaceIndex < 0) {\r\n            return -1;\r\n        }\r\n        // Special case: nothing to be found\r\n        var maxWhitespaceVerticalOffset = this.getVerticalOffsetForWhitespaceIndex(maxWhitespaceIndex);\r\n        var maxWhitespaceHeight = this._whitespaces.getHeightForWhitespaceIndex(maxWhitespaceIndex);\r\n        if (verticalOffset >= maxWhitespaceVerticalOffset + maxWhitespaceHeight) {\r\n            return -1;\r\n        }\r\n        while (minWhitespaceIndex < maxWhitespaceIndex) {\r\n            midWhitespaceIndex = Math.floor((minWhitespaceIndex + maxWhitespaceIndex) / 2);\r\n            midWhitespaceVerticalOffset = this.getVerticalOffsetForWhitespaceIndex(midWhitespaceIndex);\r\n            midWhitespaceHeight = this._whitespaces.getHeightForWhitespaceIndex(midWhitespaceIndex);\r\n            if (verticalOffset >= midWhitespaceVerticalOffset + midWhitespaceHeight) {\r\n                // vertical offset is after whitespace\r\n                minWhitespaceIndex = midWhitespaceIndex + 1;\r\n            }\r\n            else if (verticalOffset >= midWhitespaceVerticalOffset) {\r\n                // Hit\r\n                return midWhitespaceIndex;\r\n            }\r\n            else {\r\n                // vertical offset is before whitespace, but midWhitespaceIndex might still be what we're searching for\r\n                maxWhitespaceIndex = midWhitespaceIndex;\r\n            }\r\n        }\r\n        return minWhitespaceIndex;\r\n    };\r\n    /**\r\n     * Get exactly the whitespace that is layouted at `verticalOffset`.\r\n     *\r\n     * @param verticalOffset The vertical offset.\r\n     * @return Precisely the whitespace that is layouted at `verticaloffset` or null.\r\n     */\r\n    LinesLayout.prototype.getWhitespaceAtVerticalOffset = function (verticalOffset) {\r\n        verticalOffset = verticalOffset | 0;\r\n        var candidateIndex = this.getWhitespaceIndexAtOrAfterVerticallOffset(verticalOffset);\r\n        if (candidateIndex < 0) {\r\n            return null;\r\n        }\r\n        if (candidateIndex >= this._whitespaces.getCount()) {\r\n            return null;\r\n        }\r\n        var candidateTop = this.getVerticalOffsetForWhitespaceIndex(candidateIndex);\r\n        if (candidateTop > verticalOffset) {\r\n            return null;\r\n        }\r\n        var candidateHeight = this._whitespaces.getHeightForWhitespaceIndex(candidateIndex);\r\n        var candidateId = this._whitespaces.getIdForWhitespaceIndex(candidateIndex);\r\n        var candidateAfterLineNumber = this._whitespaces.getAfterLineNumberForWhitespaceIndex(candidateIndex);\r\n        return {\r\n            id: candidateId,\r\n            afterLineNumber: candidateAfterLineNumber,\r\n            verticalOffset: candidateTop,\r\n            height: candidateHeight\r\n        };\r\n    };\r\n    /**\r\n     * Get a list of whitespaces that are positioned between `verticalOffset1` and `verticalOffset2`.\r\n     *\r\n     * @param verticalOffset1 The beginning of the viewport.\r\n     * @param verticalOffset2 The end of the viewport.\r\n     * @return An array with all the whitespaces in the viewport. If no whitespace is in viewport, the array is empty.\r\n     */\r\n    LinesLayout.prototype.getWhitespaceViewportData = function (verticalOffset1, verticalOffset2) {\r\n        verticalOffset1 = verticalOffset1 | 0;\r\n        verticalOffset2 = verticalOffset2 | 0;\r\n        var startIndex = this.getWhitespaceIndexAtOrAfterVerticallOffset(verticalOffset1);\r\n        var endIndex = this._whitespaces.getCount() - 1;\r\n        if (startIndex < 0) {\r\n            return [];\r\n        }\r\n        var result = [];\r\n        for (var i = startIndex; i <= endIndex; i++) {\r\n            var top_1 = this.getVerticalOffsetForWhitespaceIndex(i);\r\n            var height = this._whitespaces.getHeightForWhitespaceIndex(i);\r\n            if (top_1 >= verticalOffset2) {\r\n                break;\r\n            }\r\n            result.push({\r\n                id: this._whitespaces.getIdForWhitespaceIndex(i),\r\n                afterLineNumber: this._whitespaces.getAfterLineNumberForWhitespaceIndex(i),\r\n                verticalOffset: top_1,\r\n                height: height\r\n            });\r\n        }\r\n        return result;\r\n    };\r\n    /**\r\n     * Get all whitespaces.\r\n     */\r\n    LinesLayout.prototype.getWhitespaces = function () {\r\n        return this._whitespaces.getWhitespaces(this._lineHeight);\r\n    };\r\n    return LinesLayout;\r\n}());\r\nexport { LinesLayout };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { Scrollable } from '../../../base/common/scrollable.js';\r\nimport { LinesLayout } from './linesLayout.js';\r\nimport { Viewport } from '../viewModel/viewModel.js';\r\nvar SMOOTH_SCROLLING_TIME = 125;\r\nvar ViewLayout = /** @class */ (function (_super) {\r\n    __extends(ViewLayout, _super);\r\n    function ViewLayout(configuration, lineCount, scheduleAtNextAnimationFrame) {\r\n        var _this = _super.call(this) || this;\r\n        _this._configuration = configuration;\r\n        _this._linesLayout = new LinesLayout(lineCount, _this._configuration.editor.lineHeight);\r\n        _this.scrollable = _this._register(new Scrollable(0, scheduleAtNextAnimationFrame));\r\n        _this._configureSmoothScrollDuration();\r\n        _this.scrollable.setScrollDimensions({\r\n            width: configuration.editor.layoutInfo.contentWidth,\r\n            height: configuration.editor.layoutInfo.contentHeight\r\n        });\r\n        _this.onDidScroll = _this.scrollable.onScroll;\r\n        _this._updateHeight();\r\n        return _this;\r\n    }\r\n    ViewLayout.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ViewLayout.prototype.onHeightMaybeChanged = function () {\r\n        this._updateHeight();\r\n    };\r\n    ViewLayout.prototype._configureSmoothScrollDuration = function () {\r\n        this.scrollable.setSmoothScrollDuration(this._configuration.editor.viewInfo.smoothScrolling ? SMOOTH_SCROLLING_TIME : 0);\r\n    };\r\n    // ---- begin view event handlers\r\n    ViewLayout.prototype.onConfigurationChanged = function (e) {\r\n        if (e.lineHeight) {\r\n            this._linesLayout.setLineHeight(this._configuration.editor.lineHeight);\r\n        }\r\n        if (e.layoutInfo) {\r\n            this.scrollable.setScrollDimensions({\r\n                width: this._configuration.editor.layoutInfo.contentWidth,\r\n                height: this._configuration.editor.layoutInfo.contentHeight\r\n            });\r\n        }\r\n        if (e.viewInfo) {\r\n            this._configureSmoothScrollDuration();\r\n        }\r\n        this._updateHeight();\r\n    };\r\n    ViewLayout.prototype.onFlushed = function (lineCount) {\r\n        this._linesLayout.onFlushed(lineCount);\r\n    };\r\n    ViewLayout.prototype.onLinesDeleted = function (fromLineNumber, toLineNumber) {\r\n        this._linesLayout.onLinesDeleted(fromLineNumber, toLineNumber);\r\n    };\r\n    ViewLayout.prototype.onLinesInserted = function (fromLineNumber, toLineNumber) {\r\n        this._linesLayout.onLinesInserted(fromLineNumber, toLineNumber);\r\n    };\r\n    // ---- end view event handlers\r\n    ViewLayout.prototype._getHorizontalScrollbarHeight = function (scrollDimensions) {\r\n        if (this._configuration.editor.viewInfo.scrollbar.horizontal === 2 /* Hidden */) {\r\n            // horizontal scrollbar not visible\r\n            return 0;\r\n        }\r\n        if (scrollDimensions.width >= scrollDimensions.scrollWidth) {\r\n            // horizontal scrollbar not visible\r\n            return 0;\r\n        }\r\n        return this._configuration.editor.viewInfo.scrollbar.horizontalScrollbarSize;\r\n    };\r\n    ViewLayout.prototype._getTotalHeight = function () {\r\n        var scrollDimensions = this.scrollable.getScrollDimensions();\r\n        var result = this._linesLayout.getLinesTotalHeight();\r\n        if (this._configuration.editor.viewInfo.scrollBeyondLastLine) {\r\n            result += scrollDimensions.height - this._configuration.editor.lineHeight;\r\n        }\r\n        else {\r\n            result += this._getHorizontalScrollbarHeight(scrollDimensions);\r\n        }\r\n        return Math.max(scrollDimensions.height, result);\r\n    };\r\n    ViewLayout.prototype._updateHeight = function () {\r\n        this.scrollable.setScrollDimensions({\r\n            scrollHeight: this._getTotalHeight()\r\n        });\r\n    };\r\n    // ---- Layouting logic\r\n    ViewLayout.prototype.getCurrentViewport = function () {\r\n        var scrollDimensions = this.scrollable.getScrollDimensions();\r\n        var currentScrollPosition = this.scrollable.getCurrentScrollPosition();\r\n        return new Viewport(currentScrollPosition.scrollTop, currentScrollPosition.scrollLeft, scrollDimensions.width, scrollDimensions.height);\r\n    };\r\n    ViewLayout.prototype.getFutureViewport = function () {\r\n        var scrollDimensions = this.scrollable.getScrollDimensions();\r\n        var currentScrollPosition = this.scrollable.getFutureScrollPosition();\r\n        return new Viewport(currentScrollPosition.scrollTop, currentScrollPosition.scrollLeft, scrollDimensions.width, scrollDimensions.height);\r\n    };\r\n    ViewLayout.prototype._computeScrollWidth = function (maxLineWidth, viewportWidth) {\r\n        var isViewportWrapping = this._configuration.editor.wrappingInfo.isViewportWrapping;\r\n        if (!isViewportWrapping) {\r\n            var extraHorizontalSpace = this._configuration.editor.viewInfo.scrollBeyondLastColumn * this._configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\r\n            var whitespaceMinWidth = this._linesLayout.getWhitespaceMinWidth();\r\n            return Math.max(maxLineWidth + extraHorizontalSpace, viewportWidth, whitespaceMinWidth);\r\n        }\r\n        return Math.max(maxLineWidth, viewportWidth);\r\n    };\r\n    ViewLayout.prototype.onMaxLineWidthChanged = function (maxLineWidth) {\r\n        var newScrollWidth = this._computeScrollWidth(maxLineWidth, this.getCurrentViewport().width);\r\n        this.scrollable.setScrollDimensions({\r\n            scrollWidth: newScrollWidth\r\n        });\r\n        // The height might depend on the fact that there is a horizontal scrollbar or not\r\n        this._updateHeight();\r\n    };\r\n    // ---- view state\r\n    ViewLayout.prototype.saveState = function () {\r\n        var currentScrollPosition = this.scrollable.getFutureScrollPosition();\r\n        var scrollTop = currentScrollPosition.scrollTop;\r\n        var firstLineNumberInViewport = this._linesLayout.getLineNumberAtOrAfterVerticalOffset(scrollTop);\r\n        var whitespaceAboveFirstLine = this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(firstLineNumberInViewport);\r\n        return {\r\n            scrollTop: scrollTop,\r\n            scrollTopWithoutViewZones: scrollTop - whitespaceAboveFirstLine,\r\n            scrollLeft: currentScrollPosition.scrollLeft\r\n        };\r\n    };\r\n    // ---- IVerticalLayoutProvider\r\n    ViewLayout.prototype.addWhitespace = function (afterLineNumber, ordinal, height, minWidth) {\r\n        return this._linesLayout.insertWhitespace(afterLineNumber, ordinal, height, minWidth);\r\n    };\r\n    ViewLayout.prototype.changeWhitespace = function (id, newAfterLineNumber, newHeight) {\r\n        return this._linesLayout.changeWhitespace(id, newAfterLineNumber, newHeight);\r\n    };\r\n    ViewLayout.prototype.removeWhitespace = function (id) {\r\n        return this._linesLayout.removeWhitespace(id);\r\n    };\r\n    ViewLayout.prototype.getVerticalOffsetForLineNumber = function (lineNumber) {\r\n        return this._linesLayout.getVerticalOffsetForLineNumber(lineNumber);\r\n    };\r\n    ViewLayout.prototype.isAfterLines = function (verticalOffset) {\r\n        return this._linesLayout.isAfterLines(verticalOffset);\r\n    };\r\n    ViewLayout.prototype.getLineNumberAtVerticalOffset = function (verticalOffset) {\r\n        return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(verticalOffset);\r\n    };\r\n    ViewLayout.prototype.getWhitespaceAtVerticalOffset = function (verticalOffset) {\r\n        return this._linesLayout.getWhitespaceAtVerticalOffset(verticalOffset);\r\n    };\r\n    ViewLayout.prototype.getLinesViewportData = function () {\r\n        var visibleBox = this.getCurrentViewport();\r\n        return this._linesLayout.getLinesViewportData(visibleBox.top, visibleBox.top + visibleBox.height);\r\n    };\r\n    ViewLayout.prototype.getLinesViewportDataAtScrollTop = function (scrollTop) {\r\n        // do some minimal validations on scrollTop\r\n        var scrollDimensions = this.scrollable.getScrollDimensions();\r\n        if (scrollTop + scrollDimensions.height > scrollDimensions.scrollHeight) {\r\n            scrollTop = scrollDimensions.scrollHeight - scrollDimensions.height;\r\n        }\r\n        if (scrollTop < 0) {\r\n            scrollTop = 0;\r\n        }\r\n        return this._linesLayout.getLinesViewportData(scrollTop, scrollTop + scrollDimensions.height);\r\n    };\r\n    ViewLayout.prototype.getWhitespaceViewportData = function () {\r\n        var visibleBox = this.getCurrentViewport();\r\n        return this._linesLayout.getWhitespaceViewportData(visibleBox.top, visibleBox.top + visibleBox.height);\r\n    };\r\n    ViewLayout.prototype.getWhitespaces = function () {\r\n        return this._linesLayout.getWhitespaces();\r\n    };\r\n    // ---- IScrollingProvider\r\n    ViewLayout.prototype.getScrollWidth = function () {\r\n        var scrollDimensions = this.scrollable.getScrollDimensions();\r\n        return scrollDimensions.scrollWidth;\r\n    };\r\n    ViewLayout.prototype.getScrollHeight = function () {\r\n        var scrollDimensions = this.scrollable.getScrollDimensions();\r\n        return scrollDimensions.scrollHeight;\r\n    };\r\n    ViewLayout.prototype.getCurrentScrollLeft = function () {\r\n        var currentScrollPosition = this.scrollable.getCurrentScrollPosition();\r\n        return currentScrollPosition.scrollLeft;\r\n    };\r\n    ViewLayout.prototype.getCurrentScrollTop = function () {\r\n        var currentScrollPosition = this.scrollable.getCurrentScrollPosition();\r\n        return currentScrollPosition.scrollTop;\r\n    };\r\n    ViewLayout.prototype.validateScrollPosition = function (scrollPosition) {\r\n        return this.scrollable.validateScrollPosition(scrollPosition);\r\n    };\r\n    ViewLayout.prototype.setScrollPositionNow = function (position) {\r\n        this.scrollable.setScrollPositionNow(position);\r\n    };\r\n    ViewLayout.prototype.setScrollPositionSmooth = function (position) {\r\n        this.scrollable.setScrollPositionSmooth(position);\r\n    };\r\n    ViewLayout.prototype.deltaScrollNow = function (deltaScrollLeft, deltaScrollTop) {\r\n        var currentScrollPosition = this.scrollable.getCurrentScrollPosition();\r\n        this.scrollable.setScrollPositionNow({\r\n            scrollLeft: currentScrollPosition.scrollLeft + deltaScrollLeft,\r\n            scrollTop: currentScrollPosition.scrollTop + deltaScrollTop\r\n        });\r\n    };\r\n    return ViewLayout;\r\n}(Disposable));\r\nexport { ViewLayout };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nimport { ModelDecorationOptions } from '../model/textModel.js';\r\nimport * as viewEvents from '../view/viewEvents.js';\r\nimport { PrefixSumComputerWithCache } from './prefixSumComputer.js';\r\nimport { ViewLineData } from './viewModel.js';\r\nvar OutputPosition = /** @class */ (function () {\r\n    function OutputPosition(outputLineIndex, outputOffset) {\r\n        this.outputLineIndex = outputLineIndex;\r\n        this.outputOffset = outputOffset;\r\n    }\r\n    return OutputPosition;\r\n}());\r\nexport { OutputPosition };\r\nvar CoordinatesConverter = /** @class */ (function () {\r\n    function CoordinatesConverter(lines) {\r\n        this._lines = lines;\r\n    }\r\n    // View -> Model conversion and related methods\r\n    CoordinatesConverter.prototype.convertViewPositionToModelPosition = function (viewPosition) {\r\n        return this._lines.convertViewPositionToModelPosition(viewPosition.lineNumber, viewPosition.column);\r\n    };\r\n    CoordinatesConverter.prototype.convertViewRangeToModelRange = function (viewRange) {\r\n        var start = this._lines.convertViewPositionToModelPosition(viewRange.startLineNumber, viewRange.startColumn);\r\n        var end = this._lines.convertViewPositionToModelPosition(viewRange.endLineNumber, viewRange.endColumn);\r\n        return new Range(start.lineNumber, start.column, end.lineNumber, end.column);\r\n    };\r\n    CoordinatesConverter.prototype.validateViewPosition = function (viewPosition, expectedModelPosition) {\r\n        return this._lines.validateViewPosition(viewPosition.lineNumber, viewPosition.column, expectedModelPosition);\r\n    };\r\n    CoordinatesConverter.prototype.validateViewRange = function (viewRange, expectedModelRange) {\r\n        var validViewStart = this._lines.validateViewPosition(viewRange.startLineNumber, viewRange.startColumn, expectedModelRange.getStartPosition());\r\n        var validViewEnd = this._lines.validateViewPosition(viewRange.endLineNumber, viewRange.endColumn, expectedModelRange.getEndPosition());\r\n        return new Range(validViewStart.lineNumber, validViewStart.column, validViewEnd.lineNumber, validViewEnd.column);\r\n    };\r\n    // Model -> View conversion and related methods\r\n    CoordinatesConverter.prototype.convertModelPositionToViewPosition = function (modelPosition) {\r\n        return this._lines.convertModelPositionToViewPosition(modelPosition.lineNumber, modelPosition.column);\r\n    };\r\n    CoordinatesConverter.prototype.convertModelRangeToViewRange = function (modelRange) {\r\n        var start = this._lines.convertModelPositionToViewPosition(modelRange.startLineNumber, modelRange.startColumn);\r\n        var end = this._lines.convertModelPositionToViewPosition(modelRange.endLineNumber, modelRange.endColumn);\r\n        return new Range(start.lineNumber, start.column, end.lineNumber, end.column);\r\n    };\r\n    CoordinatesConverter.prototype.modelPositionIsVisible = function (modelPosition) {\r\n        return this._lines.modelPositionIsVisible(modelPosition.lineNumber, modelPosition.column);\r\n    };\r\n    return CoordinatesConverter;\r\n}());\r\nexport { CoordinatesConverter };\r\nvar SplitLinesCollection = /** @class */ (function () {\r\n    function SplitLinesCollection(model, linePositionMapperFactory, tabSize, wrappingColumn, columnsForFullWidthChar, wrappingIndent) {\r\n        this.model = model;\r\n        this._validModelVersionId = -1;\r\n        this.tabSize = tabSize;\r\n        this.wrappingColumn = wrappingColumn;\r\n        this.columnsForFullWidthChar = columnsForFullWidthChar;\r\n        this.wrappingIndent = wrappingIndent;\r\n        this.linePositionMapperFactory = linePositionMapperFactory;\r\n        this._constructLines(true);\r\n    }\r\n    SplitLinesCollection.prototype.dispose = function () {\r\n        this.hiddenAreasIds = this.model.deltaDecorations(this.hiddenAreasIds, []);\r\n    };\r\n    SplitLinesCollection.prototype.createCoordinatesConverter = function () {\r\n        return new CoordinatesConverter(this);\r\n    };\r\n    SplitLinesCollection.prototype._ensureValidState = function () {\r\n        var modelVersion = this.model.getVersionId();\r\n        if (modelVersion !== this._validModelVersionId) {\r\n            // This is pretty bad, it means we lost track of the model...\r\n            throw new Error(\"ViewModel is out of sync with Model!\");\r\n        }\r\n        if (this.lines.length !== this.model.getLineCount()) {\r\n            // This is pretty bad, it means we lost track of the model...\r\n            this._constructLines(false);\r\n        }\r\n    };\r\n    SplitLinesCollection.prototype._constructLines = function (resetHiddenAreas) {\r\n        var _this = this;\r\n        this.lines = [];\r\n        if (resetHiddenAreas) {\r\n            this.hiddenAreasIds = [];\r\n        }\r\n        var linesContent = this.model.getLinesContent();\r\n        var lineCount = linesContent.length;\r\n        var values = new Uint32Array(lineCount);\r\n        var hiddenAreas = this.hiddenAreasIds.map(function (areaId) { return _this.model.getDecorationRange(areaId); }).sort(Range.compareRangesUsingStarts);\r\n        var hiddenAreaStart = 1, hiddenAreaEnd = 0;\r\n        var hiddenAreaIdx = -1;\r\n        var nextLineNumberToUpdateHiddenArea = (hiddenAreaIdx + 1 < hiddenAreas.length) ? hiddenAreaEnd + 1 : lineCount + 2;\r\n        for (var i = 0; i < lineCount; i++) {\r\n            var lineNumber = i + 1;\r\n            if (lineNumber === nextLineNumberToUpdateHiddenArea) {\r\n                hiddenAreaIdx++;\r\n                hiddenAreaStart = hiddenAreas[hiddenAreaIdx].startLineNumber;\r\n                hiddenAreaEnd = hiddenAreas[hiddenAreaIdx].endLineNumber;\r\n                nextLineNumberToUpdateHiddenArea = (hiddenAreaIdx + 1 < hiddenAreas.length) ? hiddenAreaEnd + 1 : lineCount + 2;\r\n            }\r\n            var isInHiddenArea = (lineNumber >= hiddenAreaStart && lineNumber <= hiddenAreaEnd);\r\n            var line = createSplitLine(this.linePositionMapperFactory, linesContent[i], this.tabSize, this.wrappingColumn, this.columnsForFullWidthChar, this.wrappingIndent, !isInHiddenArea);\r\n            values[i] = line.getViewLineCount();\r\n            this.lines[i] = line;\r\n        }\r\n        this._validModelVersionId = this.model.getVersionId();\r\n        this.prefixSumComputer = new PrefixSumComputerWithCache(values);\r\n    };\r\n    SplitLinesCollection.prototype.getHiddenAreas = function () {\r\n        var _this = this;\r\n        return this.hiddenAreasIds.map(function (decId) {\r\n            return _this.model.getDecorationRange(decId);\r\n        });\r\n    };\r\n    SplitLinesCollection.prototype._reduceRanges = function (_ranges) {\r\n        var _this = this;\r\n        if (_ranges.length === 0) {\r\n            return [];\r\n        }\r\n        var ranges = _ranges.map(function (r) { return _this.model.validateRange(r); }).sort(Range.compareRangesUsingStarts);\r\n        var result = [];\r\n        var currentRangeStart = ranges[0].startLineNumber;\r\n        var currentRangeEnd = ranges[0].endLineNumber;\r\n        for (var i = 1, len = ranges.length; i < len; i++) {\r\n            var range = ranges[i];\r\n            if (range.startLineNumber > currentRangeEnd + 1) {\r\n                result.push(new Range(currentRangeStart, 1, currentRangeEnd, 1));\r\n                currentRangeStart = range.startLineNumber;\r\n                currentRangeEnd = range.endLineNumber;\r\n            }\r\n            else if (range.endLineNumber > currentRangeEnd) {\r\n                currentRangeEnd = range.endLineNumber;\r\n            }\r\n        }\r\n        result.push(new Range(currentRangeStart, 1, currentRangeEnd, 1));\r\n        return result;\r\n    };\r\n    SplitLinesCollection.prototype.setHiddenAreas = function (_ranges) {\r\n        var _this = this;\r\n        var newRanges = this._reduceRanges(_ranges);\r\n        // BEGIN TODO@Martin: Please stop calling this method on each model change!\r\n        var oldRanges = this.hiddenAreasIds.map(function (areaId) { return _this.model.getDecorationRange(areaId); }).sort(Range.compareRangesUsingStarts);\r\n        if (newRanges.length === oldRanges.length) {\r\n            var hasDifference = false;\r\n            for (var i = 0; i < newRanges.length; i++) {\r\n                if (!newRanges[i].equalsRange(oldRanges[i])) {\r\n                    hasDifference = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!hasDifference) {\r\n                return false;\r\n            }\r\n        }\r\n        // END TODO@Martin: Please stop calling this method on each model change!\r\n        var newDecorations = [];\r\n        for (var i = 0; i < newRanges.length; i++) {\r\n            newDecorations.push({\r\n                range: newRanges[i],\r\n                options: ModelDecorationOptions.EMPTY\r\n            });\r\n        }\r\n        this.hiddenAreasIds = this.model.deltaDecorations(this.hiddenAreasIds, newDecorations);\r\n        var hiddenAreas = newRanges;\r\n        var hiddenAreaStart = 1, hiddenAreaEnd = 0;\r\n        var hiddenAreaIdx = -1;\r\n        var nextLineNumberToUpdateHiddenArea = (hiddenAreaIdx + 1 < hiddenAreas.length) ? hiddenAreaEnd + 1 : this.lines.length + 2;\r\n        var hasVisibleLine = false;\r\n        for (var i = 0; i < this.lines.length; i++) {\r\n            var lineNumber = i + 1;\r\n            if (lineNumber === nextLineNumberToUpdateHiddenArea) {\r\n                hiddenAreaIdx++;\r\n                hiddenAreaStart = hiddenAreas[hiddenAreaIdx].startLineNumber;\r\n                hiddenAreaEnd = hiddenAreas[hiddenAreaIdx].endLineNumber;\r\n                nextLineNumberToUpdateHiddenArea = (hiddenAreaIdx + 1 < hiddenAreas.length) ? hiddenAreaEnd + 1 : this.lines.length + 2;\r\n            }\r\n            var lineChanged = false;\r\n            if (lineNumber >= hiddenAreaStart && lineNumber <= hiddenAreaEnd) {\r\n                // Line should be hidden\r\n                if (this.lines[i].isVisible()) {\r\n                    this.lines[i] = this.lines[i].setVisible(false);\r\n                    lineChanged = true;\r\n                }\r\n            }\r\n            else {\r\n                hasVisibleLine = true;\r\n                // Line should be visible\r\n                if (!this.lines[i].isVisible()) {\r\n                    this.lines[i] = this.lines[i].setVisible(true);\r\n                    lineChanged = true;\r\n                }\r\n            }\r\n            if (lineChanged) {\r\n                var newOutputLineCount = this.lines[i].getViewLineCount();\r\n                this.prefixSumComputer.changeValue(i, newOutputLineCount);\r\n            }\r\n        }\r\n        if (!hasVisibleLine) {\r\n            // Cannot have everything be hidden => reveal everything!\r\n            this.setHiddenAreas([]);\r\n        }\r\n        return true;\r\n    };\r\n    SplitLinesCollection.prototype.modelPositionIsVisible = function (modelLineNumber, _modelColumn) {\r\n        if (modelLineNumber < 1 || modelLineNumber > this.lines.length) {\r\n            // invalid arguments\r\n            return false;\r\n        }\r\n        return this.lines[modelLineNumber - 1].isVisible();\r\n    };\r\n    SplitLinesCollection.prototype.setTabSize = function (newTabSize) {\r\n        if (this.tabSize === newTabSize) {\r\n            return false;\r\n        }\r\n        this.tabSize = newTabSize;\r\n        this._constructLines(false);\r\n        return true;\r\n    };\r\n    SplitLinesCollection.prototype.setWrappingSettings = function (wrappingIndent, wrappingColumn, columnsForFullWidthChar) {\r\n        if (this.wrappingIndent === wrappingIndent && this.wrappingColumn === wrappingColumn && this.columnsForFullWidthChar === columnsForFullWidthChar) {\r\n            return false;\r\n        }\r\n        this.wrappingIndent = wrappingIndent;\r\n        this.wrappingColumn = wrappingColumn;\r\n        this.columnsForFullWidthChar = columnsForFullWidthChar;\r\n        this._constructLines(false);\r\n        return true;\r\n    };\r\n    SplitLinesCollection.prototype.onModelFlushed = function () {\r\n        this._constructLines(true);\r\n    };\r\n    SplitLinesCollection.prototype.onModelLinesDeleted = function (versionId, fromLineNumber, toLineNumber) {\r\n        if (versionId <= this._validModelVersionId) {\r\n            // Here we check for versionId in case the lines were reconstructed in the meantime.\r\n            // We don't want to apply stale change events on top of a newer read model state.\r\n            return null;\r\n        }\r\n        var outputFromLineNumber = (fromLineNumber === 1 ? 1 : this.prefixSumComputer.getAccumulatedValue(fromLineNumber - 2) + 1);\r\n        var outputToLineNumber = this.prefixSumComputer.getAccumulatedValue(toLineNumber - 1);\r\n        this.lines.splice(fromLineNumber - 1, toLineNumber - fromLineNumber + 1);\r\n        this.prefixSumComputer.removeValues(fromLineNumber - 1, toLineNumber - fromLineNumber + 1);\r\n        return new viewEvents.ViewLinesDeletedEvent(outputFromLineNumber, outputToLineNumber);\r\n    };\r\n    SplitLinesCollection.prototype.onModelLinesInserted = function (versionId, fromLineNumber, _toLineNumber, text) {\r\n        if (versionId <= this._validModelVersionId) {\r\n            // Here we check for versionId in case the lines were reconstructed in the meantime.\r\n            // We don't want to apply stale change events on top of a newer read model state.\r\n            return null;\r\n        }\r\n        var hiddenAreas = this.getHiddenAreas();\r\n        var isInHiddenArea = false;\r\n        var testPosition = new Position(fromLineNumber, 1);\r\n        for (var i = 0; i < hiddenAreas.length; i++) {\r\n            if (hiddenAreas[i].containsPosition(testPosition)) {\r\n                isInHiddenArea = true;\r\n                break;\r\n            }\r\n        }\r\n        var outputFromLineNumber = (fromLineNumber === 1 ? 1 : this.prefixSumComputer.getAccumulatedValue(fromLineNumber - 2) + 1);\r\n        var totalOutputLineCount = 0;\r\n        var insertLines = [];\r\n        var insertPrefixSumValues = new Uint32Array(text.length);\r\n        for (var i = 0, len = text.length; i < len; i++) {\r\n            var line = createSplitLine(this.linePositionMapperFactory, text[i], this.tabSize, this.wrappingColumn, this.columnsForFullWidthChar, this.wrappingIndent, !isInHiddenArea);\r\n            insertLines.push(line);\r\n            var outputLineCount = line.getViewLineCount();\r\n            totalOutputLineCount += outputLineCount;\r\n            insertPrefixSumValues[i] = outputLineCount;\r\n        }\r\n        // TODO@Alex: use arrays.arrayInsert\r\n        this.lines = this.lines.slice(0, fromLineNumber - 1).concat(insertLines).concat(this.lines.slice(fromLineNumber - 1));\r\n        this.prefixSumComputer.insertValues(fromLineNumber - 1, insertPrefixSumValues);\r\n        return new viewEvents.ViewLinesInsertedEvent(outputFromLineNumber, outputFromLineNumber + totalOutputLineCount - 1);\r\n    };\r\n    SplitLinesCollection.prototype.onModelLineChanged = function (versionId, lineNumber, newText) {\r\n        if (versionId <= this._validModelVersionId) {\r\n            // Here we check for versionId in case the lines were reconstructed in the meantime.\r\n            // We don't want to apply stale change events on top of a newer read model state.\r\n            return [false, null, null, null];\r\n        }\r\n        var lineIndex = lineNumber - 1;\r\n        var oldOutputLineCount = this.lines[lineIndex].getViewLineCount();\r\n        var isVisible = this.lines[lineIndex].isVisible();\r\n        var line = createSplitLine(this.linePositionMapperFactory, newText, this.tabSize, this.wrappingColumn, this.columnsForFullWidthChar, this.wrappingIndent, isVisible);\r\n        this.lines[lineIndex] = line;\r\n        var newOutputLineCount = this.lines[lineIndex].getViewLineCount();\r\n        var lineMappingChanged = false;\r\n        var changeFrom = 0;\r\n        var changeTo = -1;\r\n        var insertFrom = 0;\r\n        var insertTo = -1;\r\n        var deleteFrom = 0;\r\n        var deleteTo = -1;\r\n        if (oldOutputLineCount > newOutputLineCount) {\r\n            changeFrom = (lineNumber === 1 ? 1 : this.prefixSumComputer.getAccumulatedValue(lineNumber - 2) + 1);\r\n            changeTo = changeFrom + newOutputLineCount - 1;\r\n            deleteFrom = changeTo + 1;\r\n            deleteTo = deleteFrom + (oldOutputLineCount - newOutputLineCount) - 1;\r\n            lineMappingChanged = true;\r\n        }\r\n        else if (oldOutputLineCount < newOutputLineCount) {\r\n            changeFrom = (lineNumber === 1 ? 1 : this.prefixSumComputer.getAccumulatedValue(lineNumber - 2) + 1);\r\n            changeTo = changeFrom + oldOutputLineCount - 1;\r\n            insertFrom = changeTo + 1;\r\n            insertTo = insertFrom + (newOutputLineCount - oldOutputLineCount) - 1;\r\n            lineMappingChanged = true;\r\n        }\r\n        else {\r\n            changeFrom = (lineNumber === 1 ? 1 : this.prefixSumComputer.getAccumulatedValue(lineNumber - 2) + 1);\r\n            changeTo = changeFrom + newOutputLineCount - 1;\r\n        }\r\n        this.prefixSumComputer.changeValue(lineIndex, newOutputLineCount);\r\n        var viewLinesChangedEvent = (changeFrom <= changeTo ? new viewEvents.ViewLinesChangedEvent(changeFrom, changeTo) : null);\r\n        var viewLinesInsertedEvent = (insertFrom <= insertTo ? new viewEvents.ViewLinesInsertedEvent(insertFrom, insertTo) : null);\r\n        var viewLinesDeletedEvent = (deleteFrom <= deleteTo ? new viewEvents.ViewLinesDeletedEvent(deleteFrom, deleteTo) : null);\r\n        return [lineMappingChanged, viewLinesChangedEvent, viewLinesInsertedEvent, viewLinesDeletedEvent];\r\n    };\r\n    SplitLinesCollection.prototype.acceptVersionId = function (versionId) {\r\n        this._validModelVersionId = versionId;\r\n        if (this.lines.length === 1 && !this.lines[0].isVisible()) {\r\n            // At least one line must be visible => reset hidden areas\r\n            this.setHiddenAreas([]);\r\n        }\r\n    };\r\n    SplitLinesCollection.prototype.getViewLineCount = function () {\r\n        this._ensureValidState();\r\n        return this.prefixSumComputer.getTotalValue();\r\n    };\r\n    SplitLinesCollection.prototype._toValidViewLineNumber = function (viewLineNumber) {\r\n        if (viewLineNumber < 1) {\r\n            return 1;\r\n        }\r\n        var viewLineCount = this.getViewLineCount();\r\n        if (viewLineNumber > viewLineCount) {\r\n            return viewLineCount;\r\n        }\r\n        return viewLineNumber;\r\n    };\r\n    /**\r\n     * Gives a hint that a lot of requests are about to come in for these line numbers.\r\n     */\r\n    SplitLinesCollection.prototype.warmUpLookupCache = function (viewStartLineNumber, viewEndLineNumber) {\r\n        this.prefixSumComputer.warmUpCache(viewStartLineNumber - 1, viewEndLineNumber - 1);\r\n    };\r\n    SplitLinesCollection.prototype.getActiveIndentGuide = function (viewLineNumber, minLineNumber, maxLineNumber) {\r\n        this._ensureValidState();\r\n        viewLineNumber = this._toValidViewLineNumber(viewLineNumber);\r\n        minLineNumber = this._toValidViewLineNumber(minLineNumber);\r\n        maxLineNumber = this._toValidViewLineNumber(maxLineNumber);\r\n        var modelPosition = this.convertViewPositionToModelPosition(viewLineNumber, this.getViewLineMinColumn(viewLineNumber));\r\n        var modelMinPosition = this.convertViewPositionToModelPosition(minLineNumber, this.getViewLineMinColumn(minLineNumber));\r\n        var modelMaxPosition = this.convertViewPositionToModelPosition(maxLineNumber, this.getViewLineMinColumn(maxLineNumber));\r\n        var result = this.model.getActiveIndentGuide(modelPosition.lineNumber, modelMinPosition.lineNumber, modelMaxPosition.lineNumber);\r\n        var viewStartPosition = this.convertModelPositionToViewPosition(result.startLineNumber, 1);\r\n        var viewEndPosition = this.convertModelPositionToViewPosition(result.endLineNumber, this.model.getLineMaxColumn(result.endLineNumber));\r\n        return {\r\n            startLineNumber: viewStartPosition.lineNumber,\r\n            endLineNumber: viewEndPosition.lineNumber,\r\n            indent: result.indent\r\n        };\r\n    };\r\n    SplitLinesCollection.prototype.getViewLinesIndentGuides = function (viewStartLineNumber, viewEndLineNumber) {\r\n        this._ensureValidState();\r\n        viewStartLineNumber = this._toValidViewLineNumber(viewStartLineNumber);\r\n        viewEndLineNumber = this._toValidViewLineNumber(viewEndLineNumber);\r\n        var modelStart = this.convertViewPositionToModelPosition(viewStartLineNumber, this.getViewLineMinColumn(viewStartLineNumber));\r\n        var modelEnd = this.convertViewPositionToModelPosition(viewEndLineNumber, this.getViewLineMaxColumn(viewEndLineNumber));\r\n        var result = [];\r\n        var resultRepeatCount = [];\r\n        var resultRepeatOption = [];\r\n        var modelStartLineIndex = modelStart.lineNumber - 1;\r\n        var modelEndLineIndex = modelEnd.lineNumber - 1;\r\n        var reqStart = null;\r\n        for (var modelLineIndex = modelStartLineIndex; modelLineIndex <= modelEndLineIndex; modelLineIndex++) {\r\n            var line = this.lines[modelLineIndex];\r\n            if (line.isVisible()) {\r\n                var viewLineStartIndex = line.getViewLineNumberOfModelPosition(0, modelLineIndex === modelStartLineIndex ? modelStart.column : 1);\r\n                var viewLineEndIndex = line.getViewLineNumberOfModelPosition(0, this.model.getLineMaxColumn(modelLineIndex + 1));\r\n                var count = viewLineEndIndex - viewLineStartIndex + 1;\r\n                var option = 0 /* BlockNone */;\r\n                if (count > 1 && line.getViewLineMinColumn(this.model, modelLineIndex + 1, viewLineEndIndex) === 1) {\r\n                    // wrapped lines should block indent guides\r\n                    option = (viewLineStartIndex === 0 ? 1 /* BlockSubsequent */ : 2 /* BlockAll */);\r\n                }\r\n                resultRepeatCount.push(count);\r\n                resultRepeatOption.push(option);\r\n                // merge into previous request\r\n                if (reqStart === null) {\r\n                    reqStart = new Position(modelLineIndex + 1, 0);\r\n                }\r\n            }\r\n            else {\r\n                // hit invisible line => flush request\r\n                if (reqStart !== null) {\r\n                    result = result.concat(this.model.getLinesIndentGuides(reqStart.lineNumber, modelLineIndex));\r\n                    reqStart = null;\r\n                }\r\n            }\r\n        }\r\n        if (reqStart !== null) {\r\n            result = result.concat(this.model.getLinesIndentGuides(reqStart.lineNumber, modelEnd.lineNumber));\r\n            reqStart = null;\r\n        }\r\n        var viewLineCount = viewEndLineNumber - viewStartLineNumber + 1;\r\n        var viewIndents = new Array(viewLineCount);\r\n        var currIndex = 0;\r\n        for (var i = 0, len = result.length; i < len; i++) {\r\n            var value = result[i];\r\n            var count = Math.min(viewLineCount - currIndex, resultRepeatCount[i]);\r\n            var option = resultRepeatOption[i];\r\n            var blockAtIndex = void 0;\r\n            if (option === 2 /* BlockAll */) {\r\n                blockAtIndex = 0;\r\n            }\r\n            else if (option === 1 /* BlockSubsequent */) {\r\n                blockAtIndex = 1;\r\n            }\r\n            else {\r\n                blockAtIndex = count;\r\n            }\r\n            for (var j = 0; j < count; j++) {\r\n                if (j === blockAtIndex) {\r\n                    value = 0;\r\n                }\r\n                viewIndents[currIndex++] = value;\r\n            }\r\n        }\r\n        return viewIndents;\r\n    };\r\n    SplitLinesCollection.prototype.getViewLineContent = function (viewLineNumber) {\r\n        this._ensureValidState();\r\n        viewLineNumber = this._toValidViewLineNumber(viewLineNumber);\r\n        var r = this.prefixSumComputer.getIndexOf(viewLineNumber - 1);\r\n        var lineIndex = r.index;\r\n        var remainder = r.remainder;\r\n        return this.lines[lineIndex].getViewLineContent(this.model, lineIndex + 1, remainder);\r\n    };\r\n    SplitLinesCollection.prototype.getViewLineLength = function (viewLineNumber) {\r\n        this._ensureValidState();\r\n        viewLineNumber = this._toValidViewLineNumber(viewLineNumber);\r\n        var r = this.prefixSumComputer.getIndexOf(viewLineNumber - 1);\r\n        var lineIndex = r.index;\r\n        var remainder = r.remainder;\r\n        return this.lines[lineIndex].getViewLineLength(this.model, lineIndex + 1, remainder);\r\n    };\r\n    SplitLinesCollection.prototype.getViewLineMinColumn = function (viewLineNumber) {\r\n        this._ensureValidState();\r\n        viewLineNumber = this._toValidViewLineNumber(viewLineNumber);\r\n        var r = this.prefixSumComputer.getIndexOf(viewLineNumber - 1);\r\n        var lineIndex = r.index;\r\n        var remainder = r.remainder;\r\n        return this.lines[lineIndex].getViewLineMinColumn(this.model, lineIndex + 1, remainder);\r\n    };\r\n    SplitLinesCollection.prototype.getViewLineMaxColumn = function (viewLineNumber) {\r\n        this._ensureValidState();\r\n        viewLineNumber = this._toValidViewLineNumber(viewLineNumber);\r\n        var r = this.prefixSumComputer.getIndexOf(viewLineNumber - 1);\r\n        var lineIndex = r.index;\r\n        var remainder = r.remainder;\r\n        return this.lines[lineIndex].getViewLineMaxColumn(this.model, lineIndex + 1, remainder);\r\n    };\r\n    SplitLinesCollection.prototype.getViewLineData = function (viewLineNumber) {\r\n        this._ensureValidState();\r\n        viewLineNumber = this._toValidViewLineNumber(viewLineNumber);\r\n        var r = this.prefixSumComputer.getIndexOf(viewLineNumber - 1);\r\n        var lineIndex = r.index;\r\n        var remainder = r.remainder;\r\n        return this.lines[lineIndex].getViewLineData(this.model, lineIndex + 1, remainder);\r\n    };\r\n    SplitLinesCollection.prototype.getViewLinesData = function (viewStartLineNumber, viewEndLineNumber, needed) {\r\n        this._ensureValidState();\r\n        viewStartLineNumber = this._toValidViewLineNumber(viewStartLineNumber);\r\n        viewEndLineNumber = this._toValidViewLineNumber(viewEndLineNumber);\r\n        var start = this.prefixSumComputer.getIndexOf(viewStartLineNumber - 1);\r\n        var viewLineNumber = viewStartLineNumber;\r\n        var startModelLineIndex = start.index;\r\n        var startRemainder = start.remainder;\r\n        var result = [];\r\n        for (var modelLineIndex = startModelLineIndex, len = this.model.getLineCount(); modelLineIndex < len; modelLineIndex++) {\r\n            var line = this.lines[modelLineIndex];\r\n            if (!line.isVisible()) {\r\n                continue;\r\n            }\r\n            var fromViewLineIndex = (modelLineIndex === startModelLineIndex ? startRemainder : 0);\r\n            var remainingViewLineCount = line.getViewLineCount() - fromViewLineIndex;\r\n            var lastLine = false;\r\n            if (viewLineNumber + remainingViewLineCount > viewEndLineNumber) {\r\n                lastLine = true;\r\n                remainingViewLineCount = viewEndLineNumber - viewLineNumber + 1;\r\n            }\r\n            var toViewLineIndex = fromViewLineIndex + remainingViewLineCount;\r\n            line.getViewLinesData(this.model, modelLineIndex + 1, fromViewLineIndex, toViewLineIndex, viewLineNumber - viewStartLineNumber, needed, result);\r\n            viewLineNumber += remainingViewLineCount;\r\n            if (lastLine) {\r\n                break;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    SplitLinesCollection.prototype.validateViewPosition = function (viewLineNumber, viewColumn, expectedModelPosition) {\r\n        this._ensureValidState();\r\n        viewLineNumber = this._toValidViewLineNumber(viewLineNumber);\r\n        var r = this.prefixSumComputer.getIndexOf(viewLineNumber - 1);\r\n        var lineIndex = r.index;\r\n        var remainder = r.remainder;\r\n        var line = this.lines[lineIndex];\r\n        var minColumn = line.getViewLineMinColumn(this.model, lineIndex + 1, remainder);\r\n        var maxColumn = line.getViewLineMaxColumn(this.model, lineIndex + 1, remainder);\r\n        if (viewColumn < minColumn) {\r\n            viewColumn = minColumn;\r\n        }\r\n        if (viewColumn > maxColumn) {\r\n            viewColumn = maxColumn;\r\n        }\r\n        var computedModelColumn = line.getModelColumnOfViewPosition(remainder, viewColumn);\r\n        var computedModelPosition = this.model.validatePosition(new Position(lineIndex + 1, computedModelColumn));\r\n        if (computedModelPosition.equals(expectedModelPosition)) {\r\n            return new Position(viewLineNumber, viewColumn);\r\n        }\r\n        return this.convertModelPositionToViewPosition(expectedModelPosition.lineNumber, expectedModelPosition.column);\r\n    };\r\n    SplitLinesCollection.prototype.convertViewPositionToModelPosition = function (viewLineNumber, viewColumn) {\r\n        this._ensureValidState();\r\n        viewLineNumber = this._toValidViewLineNumber(viewLineNumber);\r\n        var r = this.prefixSumComputer.getIndexOf(viewLineNumber - 1);\r\n        var lineIndex = r.index;\r\n        var remainder = r.remainder;\r\n        var inputColumn = this.lines[lineIndex].getModelColumnOfViewPosition(remainder, viewColumn);\r\n        // console.log('out -> in ' + viewLineNumber + ',' + viewColumn + ' ===> ' + (lineIndex+1) + ',' + inputColumn);\r\n        return this.model.validatePosition(new Position(lineIndex + 1, inputColumn));\r\n    };\r\n    SplitLinesCollection.prototype.convertModelPositionToViewPosition = function (_modelLineNumber, _modelColumn) {\r\n        this._ensureValidState();\r\n        var validPosition = this.model.validatePosition(new Position(_modelLineNumber, _modelColumn));\r\n        var inputLineNumber = validPosition.lineNumber;\r\n        var inputColumn = validPosition.column;\r\n        var lineIndex = inputLineNumber - 1, lineIndexChanged = false;\r\n        while (lineIndex > 0 && !this.lines[lineIndex].isVisible()) {\r\n            lineIndex--;\r\n            lineIndexChanged = true;\r\n        }\r\n        if (lineIndex === 0 && !this.lines[lineIndex].isVisible()) {\r\n            // Could not reach a real line\r\n            // console.log('in -> out ' + inputLineNumber + ',' + inputColumn + ' ===> ' + 1 + ',' + 1);\r\n            return new Position(1, 1);\r\n        }\r\n        var deltaLineNumber = 1 + (lineIndex === 0 ? 0 : this.prefixSumComputer.getAccumulatedValue(lineIndex - 1));\r\n        var r;\r\n        if (lineIndexChanged) {\r\n            r = this.lines[lineIndex].getViewPositionOfModelPosition(deltaLineNumber, this.model.getLineMaxColumn(lineIndex + 1));\r\n        }\r\n        else {\r\n            r = this.lines[inputLineNumber - 1].getViewPositionOfModelPosition(deltaLineNumber, inputColumn);\r\n        }\r\n        // console.log('in -> out ' + inputLineNumber + ',' + inputColumn + ' ===> ' + r.lineNumber + ',' + r);\r\n        return r;\r\n    };\r\n    SplitLinesCollection.prototype._getViewLineNumberForModelPosition = function (inputLineNumber, inputColumn) {\r\n        var lineIndex = inputLineNumber - 1;\r\n        if (this.lines[lineIndex].isVisible()) {\r\n            // this model line is visible\r\n            var deltaLineNumber_1 = 1 + (lineIndex === 0 ? 0 : this.prefixSumComputer.getAccumulatedValue(lineIndex - 1));\r\n            return this.lines[lineIndex].getViewLineNumberOfModelPosition(deltaLineNumber_1, inputColumn);\r\n        }\r\n        // this model line is not visible\r\n        while (lineIndex > 0 && !this.lines[lineIndex].isVisible()) {\r\n            lineIndex--;\r\n        }\r\n        if (lineIndex === 0 && !this.lines[lineIndex].isVisible()) {\r\n            // Could not reach a real line\r\n            return 1;\r\n        }\r\n        var deltaLineNumber = 1 + (lineIndex === 0 ? 0 : this.prefixSumComputer.getAccumulatedValue(lineIndex - 1));\r\n        return this.lines[lineIndex].getViewLineNumberOfModelPosition(deltaLineNumber, this.model.getLineMaxColumn(lineIndex + 1));\r\n    };\r\n    SplitLinesCollection.prototype.getAllOverviewRulerDecorations = function (ownerId, filterOutValidation, theme) {\r\n        var decorations = this.model.getOverviewRulerDecorations(ownerId, filterOutValidation);\r\n        var result = new OverviewRulerDecorations();\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var decoration = decorations[i];\r\n            var opts = decoration.options.overviewRuler;\r\n            var lane = opts ? opts.position : 0;\r\n            if (lane === 0) {\r\n                continue;\r\n            }\r\n            var color = opts.getColor(theme);\r\n            var viewStartLineNumber = this._getViewLineNumberForModelPosition(decoration.range.startLineNumber, decoration.range.startColumn);\r\n            var viewEndLineNumber = this._getViewLineNumberForModelPosition(decoration.range.endLineNumber, decoration.range.endColumn);\r\n            result.accept(color, viewStartLineNumber, viewEndLineNumber, lane);\r\n        }\r\n        return result.result;\r\n    };\r\n    SplitLinesCollection.prototype.getDecorationsInRange = function (range, ownerId, filterOutValidation) {\r\n        var modelStart = this.convertViewPositionToModelPosition(range.startLineNumber, range.startColumn);\r\n        var modelEnd = this.convertViewPositionToModelPosition(range.endLineNumber, range.endColumn);\r\n        if (modelEnd.lineNumber - modelStart.lineNumber <= range.endLineNumber - range.startLineNumber) {\r\n            // most likely there are no hidden lines => fast path\r\n            // fetch decorations from column 1 to cover the case of wrapped lines that have whole line decorations at column 1\r\n            return this.model.getDecorationsInRange(new Range(modelStart.lineNumber, 1, modelEnd.lineNumber, modelEnd.column), ownerId, filterOutValidation);\r\n        }\r\n        var result = [];\r\n        var modelStartLineIndex = modelStart.lineNumber - 1;\r\n        var modelEndLineIndex = modelEnd.lineNumber - 1;\r\n        var reqStart = null;\r\n        for (var modelLineIndex = modelStartLineIndex; modelLineIndex <= modelEndLineIndex; modelLineIndex++) {\r\n            var line = this.lines[modelLineIndex];\r\n            if (line.isVisible()) {\r\n                // merge into previous request\r\n                if (reqStart === null) {\r\n                    reqStart = new Position(modelLineIndex + 1, modelLineIndex === modelStartLineIndex ? modelStart.column : 1);\r\n                }\r\n            }\r\n            else {\r\n                // hit invisible line => flush request\r\n                if (reqStart !== null) {\r\n                    var maxLineColumn = this.model.getLineMaxColumn(modelLineIndex);\r\n                    result = result.concat(this.model.getDecorationsInRange(new Range(reqStart.lineNumber, reqStart.column, modelLineIndex, maxLineColumn), ownerId, filterOutValidation));\r\n                    reqStart = null;\r\n                }\r\n            }\r\n        }\r\n        if (reqStart !== null) {\r\n            result = result.concat(this.model.getDecorationsInRange(new Range(reqStart.lineNumber, reqStart.column, modelEnd.lineNumber, modelEnd.column), ownerId, filterOutValidation));\r\n            reqStart = null;\r\n        }\r\n        result.sort(function (a, b) {\r\n            var res = Range.compareRangesUsingStarts(a.range, b.range);\r\n            if (res === 0) {\r\n                if (a.id < b.id) {\r\n                    return -1;\r\n                }\r\n                if (a.id > b.id) {\r\n                    return 1;\r\n                }\r\n                return 0;\r\n            }\r\n            return res;\r\n        });\r\n        // Eliminate duplicate decorations that might have intersected our visible ranges multiple times\r\n        var finalResult = [], finalResultLen = 0;\r\n        var prevDecId = null;\r\n        for (var i = 0, len = result.length; i < len; i++) {\r\n            var dec = result[i];\r\n            var decId = dec.id;\r\n            if (prevDecId === decId) {\r\n                // skip\r\n                continue;\r\n            }\r\n            prevDecId = decId;\r\n            finalResult[finalResultLen++] = dec;\r\n        }\r\n        return finalResult;\r\n    };\r\n    return SplitLinesCollection;\r\n}());\r\nexport { SplitLinesCollection };\r\nvar VisibleIdentitySplitLine = /** @class */ (function () {\r\n    function VisibleIdentitySplitLine() {\r\n    }\r\n    VisibleIdentitySplitLine.prototype.isVisible = function () {\r\n        return true;\r\n    };\r\n    VisibleIdentitySplitLine.prototype.setVisible = function (isVisible) {\r\n        if (isVisible) {\r\n            return this;\r\n        }\r\n        return InvisibleIdentitySplitLine.INSTANCE;\r\n    };\r\n    VisibleIdentitySplitLine.prototype.getViewLineCount = function () {\r\n        return 1;\r\n    };\r\n    VisibleIdentitySplitLine.prototype.getViewLineContent = function (model, modelLineNumber, _outputLineIndex) {\r\n        return model.getLineContent(modelLineNumber);\r\n    };\r\n    VisibleIdentitySplitLine.prototype.getViewLineLength = function (model, modelLineNumber, _outputLineIndex) {\r\n        return model.getLineLength(modelLineNumber);\r\n    };\r\n    VisibleIdentitySplitLine.prototype.getViewLineMinColumn = function (model, modelLineNumber, _outputLineIndex) {\r\n        return model.getLineMinColumn(modelLineNumber);\r\n    };\r\n    VisibleIdentitySplitLine.prototype.getViewLineMaxColumn = function (model, modelLineNumber, _outputLineIndex) {\r\n        return model.getLineMaxColumn(modelLineNumber);\r\n    };\r\n    VisibleIdentitySplitLine.prototype.getViewLineData = function (model, modelLineNumber, _outputLineIndex) {\r\n        var lineTokens = model.getLineTokens(modelLineNumber);\r\n        var lineContent = lineTokens.getLineContent();\r\n        return new ViewLineData(lineContent, false, 1, lineContent.length + 1, lineTokens.inflate());\r\n    };\r\n    VisibleIdentitySplitLine.prototype.getViewLinesData = function (model, modelLineNumber, _fromOuputLineIndex, _toOutputLineIndex, globalStartIndex, needed, result) {\r\n        if (!needed[globalStartIndex]) {\r\n            result[globalStartIndex] = null;\r\n            return;\r\n        }\r\n        result[globalStartIndex] = this.getViewLineData(model, modelLineNumber, 0);\r\n    };\r\n    VisibleIdentitySplitLine.prototype.getModelColumnOfViewPosition = function (_outputLineIndex, outputColumn) {\r\n        return outputColumn;\r\n    };\r\n    VisibleIdentitySplitLine.prototype.getViewPositionOfModelPosition = function (deltaLineNumber, inputColumn) {\r\n        return new Position(deltaLineNumber, inputColumn);\r\n    };\r\n    VisibleIdentitySplitLine.prototype.getViewLineNumberOfModelPosition = function (deltaLineNumber, _inputColumn) {\r\n        return deltaLineNumber;\r\n    };\r\n    VisibleIdentitySplitLine.INSTANCE = new VisibleIdentitySplitLine();\r\n    return VisibleIdentitySplitLine;\r\n}());\r\nvar InvisibleIdentitySplitLine = /** @class */ (function () {\r\n    function InvisibleIdentitySplitLine() {\r\n    }\r\n    InvisibleIdentitySplitLine.prototype.isVisible = function () {\r\n        return false;\r\n    };\r\n    InvisibleIdentitySplitLine.prototype.setVisible = function (isVisible) {\r\n        if (!isVisible) {\r\n            return this;\r\n        }\r\n        return VisibleIdentitySplitLine.INSTANCE;\r\n    };\r\n    InvisibleIdentitySplitLine.prototype.getViewLineCount = function () {\r\n        return 0;\r\n    };\r\n    InvisibleIdentitySplitLine.prototype.getViewLineContent = function (_model, _modelLineNumber, _outputLineIndex) {\r\n        throw new Error('Not supported');\r\n    };\r\n    InvisibleIdentitySplitLine.prototype.getViewLineLength = function (_model, _modelLineNumber, _outputLineIndex) {\r\n        throw new Error('Not supported');\r\n    };\r\n    InvisibleIdentitySplitLine.prototype.getViewLineMinColumn = function (_model, _modelLineNumber, _outputLineIndex) {\r\n        throw new Error('Not supported');\r\n    };\r\n    InvisibleIdentitySplitLine.prototype.getViewLineMaxColumn = function (_model, _modelLineNumber, _outputLineIndex) {\r\n        throw new Error('Not supported');\r\n    };\r\n    InvisibleIdentitySplitLine.prototype.getViewLineData = function (_model, _modelLineNumber, _outputLineIndex) {\r\n        throw new Error('Not supported');\r\n    };\r\n    InvisibleIdentitySplitLine.prototype.getViewLinesData = function (_model, _modelLineNumber, _fromOuputLineIndex, _toOutputLineIndex, _globalStartIndex, _needed, _result) {\r\n        throw new Error('Not supported');\r\n    };\r\n    InvisibleIdentitySplitLine.prototype.getModelColumnOfViewPosition = function (_outputLineIndex, _outputColumn) {\r\n        throw new Error('Not supported');\r\n    };\r\n    InvisibleIdentitySplitLine.prototype.getViewPositionOfModelPosition = function (_deltaLineNumber, _inputColumn) {\r\n        throw new Error('Not supported');\r\n    };\r\n    InvisibleIdentitySplitLine.prototype.getViewLineNumberOfModelPosition = function (_deltaLineNumber, _inputColumn) {\r\n        throw new Error('Not supported');\r\n    };\r\n    InvisibleIdentitySplitLine.INSTANCE = new InvisibleIdentitySplitLine();\r\n    return InvisibleIdentitySplitLine;\r\n}());\r\nvar SplitLine = /** @class */ (function () {\r\n    function SplitLine(positionMapper, isVisible) {\r\n        this.positionMapper = positionMapper;\r\n        this.wrappedIndent = this.positionMapper.getWrappedLinesIndent();\r\n        this.wrappedIndentLength = this.wrappedIndent.length;\r\n        this.outputLineCount = this.positionMapper.getOutputLineCount();\r\n        this._isVisible = isVisible;\r\n    }\r\n    SplitLine.prototype.isVisible = function () {\r\n        return this._isVisible;\r\n    };\r\n    SplitLine.prototype.setVisible = function (isVisible) {\r\n        this._isVisible = isVisible;\r\n        return this;\r\n    };\r\n    SplitLine.prototype.getViewLineCount = function () {\r\n        if (!this._isVisible) {\r\n            return 0;\r\n        }\r\n        return this.outputLineCount;\r\n    };\r\n    SplitLine.prototype.getInputStartOffsetOfOutputLineIndex = function (outputLineIndex) {\r\n        return this.positionMapper.getInputOffsetOfOutputPosition(outputLineIndex, 0);\r\n    };\r\n    SplitLine.prototype.getInputEndOffsetOfOutputLineIndex = function (model, modelLineNumber, outputLineIndex) {\r\n        if (outputLineIndex + 1 === this.outputLineCount) {\r\n            return model.getLineMaxColumn(modelLineNumber) - 1;\r\n        }\r\n        return this.positionMapper.getInputOffsetOfOutputPosition(outputLineIndex + 1, 0);\r\n    };\r\n    SplitLine.prototype.getViewLineContent = function (model, modelLineNumber, outputLineIndex) {\r\n        if (!this._isVisible) {\r\n            throw new Error('Not supported');\r\n        }\r\n        var startOffset = this.getInputStartOffsetOfOutputLineIndex(outputLineIndex);\r\n        var endOffset = this.getInputEndOffsetOfOutputLineIndex(model, modelLineNumber, outputLineIndex);\r\n        var r = model.getValueInRange({\r\n            startLineNumber: modelLineNumber,\r\n            startColumn: startOffset + 1,\r\n            endLineNumber: modelLineNumber,\r\n            endColumn: endOffset + 1\r\n        });\r\n        if (outputLineIndex > 0) {\r\n            r = this.wrappedIndent + r;\r\n        }\r\n        return r;\r\n    };\r\n    SplitLine.prototype.getViewLineLength = function (model, modelLineNumber, outputLineIndex) {\r\n        if (!this._isVisible) {\r\n            throw new Error('Not supported');\r\n        }\r\n        var startOffset = this.getInputStartOffsetOfOutputLineIndex(outputLineIndex);\r\n        var endOffset = this.getInputEndOffsetOfOutputLineIndex(model, modelLineNumber, outputLineIndex);\r\n        var r = endOffset - startOffset;\r\n        if (outputLineIndex > 0) {\r\n            r = this.wrappedIndent.length + r;\r\n        }\r\n        return r;\r\n    };\r\n    SplitLine.prototype.getViewLineMinColumn = function (_model, _modelLineNumber, outputLineIndex) {\r\n        if (!this._isVisible) {\r\n            throw new Error('Not supported');\r\n        }\r\n        if (outputLineIndex > 0) {\r\n            return this.wrappedIndentLength + 1;\r\n        }\r\n        return 1;\r\n    };\r\n    SplitLine.prototype.getViewLineMaxColumn = function (model, modelLineNumber, outputLineIndex) {\r\n        if (!this._isVisible) {\r\n            throw new Error('Not supported');\r\n        }\r\n        return this.getViewLineContent(model, modelLineNumber, outputLineIndex).length + 1;\r\n    };\r\n    SplitLine.prototype.getViewLineData = function (model, modelLineNumber, outputLineIndex) {\r\n        if (!this._isVisible) {\r\n            throw new Error('Not supported');\r\n        }\r\n        var startOffset = this.getInputStartOffsetOfOutputLineIndex(outputLineIndex);\r\n        var endOffset = this.getInputEndOffsetOfOutputLineIndex(model, modelLineNumber, outputLineIndex);\r\n        var lineContent = model.getValueInRange({\r\n            startLineNumber: modelLineNumber,\r\n            startColumn: startOffset + 1,\r\n            endLineNumber: modelLineNumber,\r\n            endColumn: endOffset + 1\r\n        });\r\n        if (outputLineIndex > 0) {\r\n            lineContent = this.wrappedIndent + lineContent;\r\n        }\r\n        var minColumn = (outputLineIndex > 0 ? this.wrappedIndentLength + 1 : 1);\r\n        var maxColumn = lineContent.length + 1;\r\n        var continuesWithWrappedLine = (outputLineIndex + 1 < this.getViewLineCount());\r\n        var deltaStartIndex = 0;\r\n        if (outputLineIndex > 0) {\r\n            deltaStartIndex = this.wrappedIndentLength;\r\n        }\r\n        var lineTokens = model.getLineTokens(modelLineNumber);\r\n        return new ViewLineData(lineContent, continuesWithWrappedLine, minColumn, maxColumn, lineTokens.sliceAndInflate(startOffset, endOffset, deltaStartIndex));\r\n    };\r\n    SplitLine.prototype.getViewLinesData = function (model, modelLineNumber, fromOuputLineIndex, toOutputLineIndex, globalStartIndex, needed, result) {\r\n        if (!this._isVisible) {\r\n            throw new Error('Not supported');\r\n        }\r\n        for (var outputLineIndex = fromOuputLineIndex; outputLineIndex < toOutputLineIndex; outputLineIndex++) {\r\n            var globalIndex = globalStartIndex + outputLineIndex - fromOuputLineIndex;\r\n            if (!needed[globalIndex]) {\r\n                result[globalIndex] = null;\r\n                continue;\r\n            }\r\n            result[globalIndex] = this.getViewLineData(model, modelLineNumber, outputLineIndex);\r\n        }\r\n    };\r\n    SplitLine.prototype.getModelColumnOfViewPosition = function (outputLineIndex, outputColumn) {\r\n        if (!this._isVisible) {\r\n            throw new Error('Not supported');\r\n        }\r\n        var adjustedColumn = outputColumn - 1;\r\n        if (outputLineIndex > 0) {\r\n            if (adjustedColumn < this.wrappedIndentLength) {\r\n                adjustedColumn = 0;\r\n            }\r\n            else {\r\n                adjustedColumn -= this.wrappedIndentLength;\r\n            }\r\n        }\r\n        return this.positionMapper.getInputOffsetOfOutputPosition(outputLineIndex, adjustedColumn) + 1;\r\n    };\r\n    SplitLine.prototype.getViewPositionOfModelPosition = function (deltaLineNumber, inputColumn) {\r\n        if (!this._isVisible) {\r\n            throw new Error('Not supported');\r\n        }\r\n        var r = this.positionMapper.getOutputPositionOfInputOffset(inputColumn - 1);\r\n        var outputLineIndex = r.outputLineIndex;\r\n        var outputColumn = r.outputOffset + 1;\r\n        if (outputLineIndex > 0) {\r\n            outputColumn += this.wrappedIndentLength;\r\n        }\r\n        //\t\tconsole.log('in -> out ' + deltaLineNumber + ',' + inputColumn + ' ===> ' + (deltaLineNumber+outputLineIndex) + ',' + outputColumn);\r\n        return new Position(deltaLineNumber + outputLineIndex, outputColumn);\r\n    };\r\n    SplitLine.prototype.getViewLineNumberOfModelPosition = function (deltaLineNumber, inputColumn) {\r\n        if (!this._isVisible) {\r\n            throw new Error('Not supported');\r\n        }\r\n        var r = this.positionMapper.getOutputPositionOfInputOffset(inputColumn - 1);\r\n        return (deltaLineNumber + r.outputLineIndex);\r\n    };\r\n    return SplitLine;\r\n}());\r\nexport { SplitLine };\r\nfunction createSplitLine(linePositionMapperFactory, text, tabSize, wrappingColumn, columnsForFullWidthChar, wrappingIndent, isVisible) {\r\n    var positionMapper = linePositionMapperFactory.createLineMapping(text, tabSize, wrappingColumn, columnsForFullWidthChar, wrappingIndent);\r\n    if (positionMapper === null) {\r\n        // No mapping needed\r\n        if (isVisible) {\r\n            return VisibleIdentitySplitLine.INSTANCE;\r\n        }\r\n        return InvisibleIdentitySplitLine.INSTANCE;\r\n    }\r\n    else {\r\n        return new SplitLine(positionMapper, isVisible);\r\n    }\r\n}\r\nvar IdentityCoordinatesConverter = /** @class */ (function () {\r\n    function IdentityCoordinatesConverter(lines) {\r\n        this._lines = lines;\r\n    }\r\n    IdentityCoordinatesConverter.prototype._validPosition = function (pos) {\r\n        return this._lines.model.validatePosition(pos);\r\n    };\r\n    IdentityCoordinatesConverter.prototype._validRange = function (range) {\r\n        return this._lines.model.validateRange(range);\r\n    };\r\n    // View -> Model conversion and related methods\r\n    IdentityCoordinatesConverter.prototype.convertViewPositionToModelPosition = function (viewPosition) {\r\n        return this._validPosition(viewPosition);\r\n    };\r\n    IdentityCoordinatesConverter.prototype.convertViewRangeToModelRange = function (viewRange) {\r\n        return this._validRange(viewRange);\r\n    };\r\n    IdentityCoordinatesConverter.prototype.validateViewPosition = function (_viewPosition, expectedModelPosition) {\r\n        return this._validPosition(expectedModelPosition);\r\n    };\r\n    IdentityCoordinatesConverter.prototype.validateViewRange = function (_viewRange, expectedModelRange) {\r\n        return this._validRange(expectedModelRange);\r\n    };\r\n    // Model -> View conversion and related methods\r\n    IdentityCoordinatesConverter.prototype.convertModelPositionToViewPosition = function (modelPosition) {\r\n        return this._validPosition(modelPosition);\r\n    };\r\n    IdentityCoordinatesConverter.prototype.convertModelRangeToViewRange = function (modelRange) {\r\n        return this._validRange(modelRange);\r\n    };\r\n    IdentityCoordinatesConverter.prototype.modelPositionIsVisible = function (modelPosition) {\r\n        var lineCount = this._lines.model.getLineCount();\r\n        if (modelPosition.lineNumber < 1 || modelPosition.lineNumber > lineCount) {\r\n            // invalid arguments\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    return IdentityCoordinatesConverter;\r\n}());\r\nexport { IdentityCoordinatesConverter };\r\nvar IdentityLinesCollection = /** @class */ (function () {\r\n    function IdentityLinesCollection(model) {\r\n        this.model = model;\r\n    }\r\n    IdentityLinesCollection.prototype.dispose = function () {\r\n    };\r\n    IdentityLinesCollection.prototype.createCoordinatesConverter = function () {\r\n        return new IdentityCoordinatesConverter(this);\r\n    };\r\n    IdentityLinesCollection.prototype.getHiddenAreas = function () {\r\n        return [];\r\n    };\r\n    IdentityLinesCollection.prototype.setHiddenAreas = function (_ranges) {\r\n        return false;\r\n    };\r\n    IdentityLinesCollection.prototype.setTabSize = function (_newTabSize) {\r\n        return false;\r\n    };\r\n    IdentityLinesCollection.prototype.setWrappingSettings = function (_wrappingIndent, _wrappingColumn, _columnsForFullWidthChar) {\r\n        return false;\r\n    };\r\n    IdentityLinesCollection.prototype.onModelFlushed = function () {\r\n    };\r\n    IdentityLinesCollection.prototype.onModelLinesDeleted = function (_versionId, fromLineNumber, toLineNumber) {\r\n        return new viewEvents.ViewLinesDeletedEvent(fromLineNumber, toLineNumber);\r\n    };\r\n    IdentityLinesCollection.prototype.onModelLinesInserted = function (_versionId, fromLineNumber, toLineNumber, _text) {\r\n        return new viewEvents.ViewLinesInsertedEvent(fromLineNumber, toLineNumber);\r\n    };\r\n    IdentityLinesCollection.prototype.onModelLineChanged = function (_versionId, lineNumber, _newText) {\r\n        return [false, new viewEvents.ViewLinesChangedEvent(lineNumber, lineNumber), null, null];\r\n    };\r\n    IdentityLinesCollection.prototype.acceptVersionId = function (_versionId) {\r\n    };\r\n    IdentityLinesCollection.prototype.getViewLineCount = function () {\r\n        return this.model.getLineCount();\r\n    };\r\n    IdentityLinesCollection.prototype.warmUpLookupCache = function (_viewStartLineNumber, _viewEndLineNumber) {\r\n    };\r\n    IdentityLinesCollection.prototype.getActiveIndentGuide = function (viewLineNumber, _minLineNumber, _maxLineNumber) {\r\n        return {\r\n            startLineNumber: viewLineNumber,\r\n            endLineNumber: viewLineNumber,\r\n            indent: 0\r\n        };\r\n    };\r\n    IdentityLinesCollection.prototype.getViewLinesIndentGuides = function (viewStartLineNumber, viewEndLineNumber) {\r\n        var viewLineCount = viewEndLineNumber - viewStartLineNumber + 1;\r\n        var result = new Array(viewLineCount);\r\n        for (var i = 0; i < viewLineCount; i++) {\r\n            result[i] = 0;\r\n        }\r\n        return result;\r\n    };\r\n    IdentityLinesCollection.prototype.getViewLineContent = function (viewLineNumber) {\r\n        return this.model.getLineContent(viewLineNumber);\r\n    };\r\n    IdentityLinesCollection.prototype.getViewLineLength = function (viewLineNumber) {\r\n        return this.model.getLineLength(viewLineNumber);\r\n    };\r\n    IdentityLinesCollection.prototype.getViewLineMinColumn = function (viewLineNumber) {\r\n        return this.model.getLineMinColumn(viewLineNumber);\r\n    };\r\n    IdentityLinesCollection.prototype.getViewLineMaxColumn = function (viewLineNumber) {\r\n        return this.model.getLineMaxColumn(viewLineNumber);\r\n    };\r\n    IdentityLinesCollection.prototype.getViewLineData = function (viewLineNumber) {\r\n        var lineTokens = this.model.getLineTokens(viewLineNumber);\r\n        var lineContent = lineTokens.getLineContent();\r\n        return new ViewLineData(lineContent, false, 1, lineContent.length + 1, lineTokens.inflate());\r\n    };\r\n    IdentityLinesCollection.prototype.getViewLinesData = function (viewStartLineNumber, viewEndLineNumber, needed) {\r\n        var lineCount = this.model.getLineCount();\r\n        viewStartLineNumber = Math.min(Math.max(1, viewStartLineNumber), lineCount);\r\n        viewEndLineNumber = Math.min(Math.max(1, viewEndLineNumber), lineCount);\r\n        var result = [];\r\n        for (var lineNumber = viewStartLineNumber; lineNumber <= viewEndLineNumber; lineNumber++) {\r\n            var idx = lineNumber - viewStartLineNumber;\r\n            if (!needed[idx]) {\r\n                result[idx] = null;\r\n            }\r\n            result[idx] = this.getViewLineData(lineNumber);\r\n        }\r\n        return result;\r\n    };\r\n    IdentityLinesCollection.prototype.getAllOverviewRulerDecorations = function (ownerId, filterOutValidation, theme) {\r\n        var decorations = this.model.getOverviewRulerDecorations(ownerId, filterOutValidation);\r\n        var result = new OverviewRulerDecorations();\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var decoration = decorations[i];\r\n            var opts = decoration.options.overviewRuler;\r\n            var lane = opts ? opts.position : 0;\r\n            if (lane === 0) {\r\n                continue;\r\n            }\r\n            var color = opts.getColor(theme);\r\n            var viewStartLineNumber = decoration.range.startLineNumber;\r\n            var viewEndLineNumber = decoration.range.endLineNumber;\r\n            result.accept(color, viewStartLineNumber, viewEndLineNumber, lane);\r\n        }\r\n        return result.result;\r\n    };\r\n    IdentityLinesCollection.prototype.getDecorationsInRange = function (range, ownerId, filterOutValidation) {\r\n        return this.model.getDecorationsInRange(range, ownerId, filterOutValidation);\r\n    };\r\n    return IdentityLinesCollection;\r\n}());\r\nexport { IdentityLinesCollection };\r\nvar OverviewRulerDecorations = /** @class */ (function () {\r\n    function OverviewRulerDecorations() {\r\n        this.result = Object.create(null);\r\n    }\r\n    OverviewRulerDecorations.prototype.accept = function (color, startLineNumber, endLineNumber, lane) {\r\n        var prev = this.result[color];\r\n        if (prev) {\r\n            var prevLane = prev[prev.length - 3];\r\n            var prevEndLineNumber = prev[prev.length - 1];\r\n            if (prevLane === lane && prevEndLineNumber + 1 >= startLineNumber) {\r\n                // merge into prev\r\n                if (endLineNumber > prevEndLineNumber) {\r\n                    prev[prev.length - 1] = endLineNumber;\r\n                }\r\n                return;\r\n            }\r\n            // push\r\n            prev.push(lane, startLineNumber, endLineNumber);\r\n        }\r\n        else {\r\n            this.result[color] = [lane, startLineNumber, endLineNumber];\r\n        }\r\n    };\r\n    return OverviewRulerDecorations;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { CharacterClassifier } from '../core/characterClassifier.js';\r\nimport { toUint32Array } from '../core/uint.js';\r\nimport { PrefixSumComputer } from './prefixSumComputer.js';\r\nimport { OutputPosition } from './splitLinesCollection.js';\r\nvar WrappingCharacterClassifier = /** @class */ (function (_super) {\r\n    __extends(WrappingCharacterClassifier, _super);\r\n    function WrappingCharacterClassifier(BREAK_BEFORE, BREAK_AFTER, BREAK_OBTRUSIVE) {\r\n        var _this = _super.call(this, 0 /* NONE */) || this;\r\n        for (var i = 0; i < BREAK_BEFORE.length; i++) {\r\n            _this.set(BREAK_BEFORE.charCodeAt(i), 1 /* BREAK_BEFORE */);\r\n        }\r\n        for (var i = 0; i < BREAK_AFTER.length; i++) {\r\n            _this.set(BREAK_AFTER.charCodeAt(i), 2 /* BREAK_AFTER */);\r\n        }\r\n        for (var i = 0; i < BREAK_OBTRUSIVE.length; i++) {\r\n            _this.set(BREAK_OBTRUSIVE.charCodeAt(i), 3 /* BREAK_OBTRUSIVE */);\r\n        }\r\n        return _this;\r\n    }\r\n    WrappingCharacterClassifier.prototype.get = function (charCode) {\r\n        // Initialize CharacterClass.BREAK_IDEOGRAPHIC for these Unicode ranges:\r\n        // 1. CJK Unified Ideographs (0x4E00 -- 0x9FFF)\r\n        // 2. CJK Unified Ideographs Extension A (0x3400 -- 0x4DBF)\r\n        // 3. Hiragana and Katakana (0x3040 -- 0x30FF)\r\n        if ((charCode >= 0x3040 && charCode <= 0x30FF)\r\n            || (charCode >= 0x3400 && charCode <= 0x4DBF)\r\n            || (charCode >= 0x4E00 && charCode <= 0x9FFF)) {\r\n            return 4 /* BREAK_IDEOGRAPHIC */;\r\n        }\r\n        return _super.prototype.get.call(this, charCode);\r\n    };\r\n    return WrappingCharacterClassifier;\r\n}(CharacterClassifier));\r\nvar CharacterHardWrappingLineMapperFactory = /** @class */ (function () {\r\n    function CharacterHardWrappingLineMapperFactory(breakBeforeChars, breakAfterChars, breakObtrusiveChars) {\r\n        this.classifier = new WrappingCharacterClassifier(breakBeforeChars, breakAfterChars, breakObtrusiveChars);\r\n    }\r\n    // TODO@Alex -> duplicated in lineCommentCommand\r\n    CharacterHardWrappingLineMapperFactory.nextVisibleColumn = function (currentVisibleColumn, tabSize, isTab, columnSize) {\r\n        currentVisibleColumn = +currentVisibleColumn; //@perf\r\n        tabSize = +tabSize; //@perf\r\n        columnSize = +columnSize; //@perf\r\n        if (isTab) {\r\n            return currentVisibleColumn + (tabSize - (currentVisibleColumn % tabSize));\r\n        }\r\n        return currentVisibleColumn + columnSize;\r\n    };\r\n    CharacterHardWrappingLineMapperFactory.prototype.createLineMapping = function (lineText, tabSize, breakingColumn, columnsForFullWidthChar, hardWrappingIndent) {\r\n        if (breakingColumn === -1) {\r\n            return null;\r\n        }\r\n        tabSize = +tabSize; //@perf\r\n        breakingColumn = +breakingColumn; //@perf\r\n        columnsForFullWidthChar = +columnsForFullWidthChar; //@perf\r\n        hardWrappingIndent = +hardWrappingIndent; //@perf\r\n        var wrappedTextIndentVisibleColumn = 0;\r\n        var wrappedTextIndent = '';\r\n        var firstNonWhitespaceIndex = -1;\r\n        if (hardWrappingIndent !== 0 /* None */) {\r\n            firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineText);\r\n            if (firstNonWhitespaceIndex !== -1) {\r\n                // Track existing indent\r\n                wrappedTextIndent = lineText.substring(0, firstNonWhitespaceIndex);\r\n                for (var i = 0; i < firstNonWhitespaceIndex; i++) {\r\n                    wrappedTextIndentVisibleColumn = CharacterHardWrappingLineMapperFactory.nextVisibleColumn(wrappedTextIndentVisibleColumn, tabSize, lineText.charCodeAt(i) === 9 /* Tab */, 1);\r\n                }\r\n                // Increase indent of continuation lines, if desired\r\n                var numberOfAdditionalTabs = 0;\r\n                if (hardWrappingIndent === 2 /* Indent */) {\r\n                    numberOfAdditionalTabs = 1;\r\n                }\r\n                else if (hardWrappingIndent === 3 /* DeepIndent */) {\r\n                    numberOfAdditionalTabs = 2;\r\n                }\r\n                for (var i = 0; i < numberOfAdditionalTabs; i++) {\r\n                    wrappedTextIndent += '\\t';\r\n                    wrappedTextIndentVisibleColumn = CharacterHardWrappingLineMapperFactory.nextVisibleColumn(wrappedTextIndentVisibleColumn, tabSize, true, 1);\r\n                }\r\n                // Force sticking to beginning of line if no character would fit except for the indentation\r\n                if (wrappedTextIndentVisibleColumn + columnsForFullWidthChar > breakingColumn) {\r\n                    wrappedTextIndent = '';\r\n                    wrappedTextIndentVisibleColumn = 0;\r\n                }\r\n            }\r\n        }\r\n        var classifier = this.classifier;\r\n        var lastBreakingOffset = 0; // Last 0-based offset in the lineText at which a break happened\r\n        var breakingLengths = []; // The length of each broken-up line text\r\n        var breakingLengthsIndex = 0; // The count of breaks already done\r\n        var visibleColumn = 0; // Visible column since the beginning of the current line\r\n        var niceBreakOffset = -1; // Last index of a character that indicates a break should happen before it (more desirable)\r\n        var niceBreakVisibleColumn = 0; // visible column if a break were to be later introduced before `niceBreakOffset`\r\n        var obtrusiveBreakOffset = -1; // Last index of a character that indicates a break should happen before it (less desirable)\r\n        var obtrusiveBreakVisibleColumn = 0; // visible column if a break were to be later introduced before `obtrusiveBreakOffset`\r\n        var len = lineText.length;\r\n        for (var i = 0; i < len; i++) {\r\n            // At this point, there is a certainty that the character before `i` fits on the current line,\r\n            // but the character at `i` might not fit\r\n            var charCode = lineText.charCodeAt(i);\r\n            var charCodeIsTab = (charCode === 9 /* Tab */);\r\n            var charCodeClass = classifier.get(charCode);\r\n            if (charCodeClass === 1 /* BREAK_BEFORE */) {\r\n                // This is a character that indicates that a break should happen before it\r\n                // Since we are certain the character before `i` fits, there's no extra checking needed,\r\n                // just mark it as a nice breaking opportunity\r\n                niceBreakOffset = i;\r\n                niceBreakVisibleColumn = wrappedTextIndentVisibleColumn;\r\n            }\r\n            // CJK breaking : before break\r\n            if (charCodeClass === 4 /* BREAK_IDEOGRAPHIC */ && i > 0) {\r\n                var prevCode = lineText.charCodeAt(i - 1);\r\n                var prevClass = classifier.get(prevCode);\r\n                if (prevClass !== 1 /* BREAK_BEFORE */) { // Kinsoku Shori: Don't break after a leading character, like an open bracket\r\n                    niceBreakOffset = i;\r\n                    niceBreakVisibleColumn = wrappedTextIndentVisibleColumn;\r\n                }\r\n            }\r\n            var charColumnSize = 1;\r\n            if (strings.isFullWidthCharacter(charCode)) {\r\n                charColumnSize = columnsForFullWidthChar;\r\n            }\r\n            // Advance visibleColumn with character at `i`\r\n            visibleColumn = CharacterHardWrappingLineMapperFactory.nextVisibleColumn(visibleColumn, tabSize, charCodeIsTab, charColumnSize);\r\n            if (visibleColumn > breakingColumn && i !== 0) {\r\n                // We need to break at least before character at `i`:\r\n                //  - break before niceBreakLastOffset if it exists (and re-establish a correct visibleColumn by using niceBreakVisibleColumn + charAt(i))\r\n                //  - otherwise, break before obtrusiveBreakLastOffset if it exists (and re-establish a correct visibleColumn by using obtrusiveBreakVisibleColumn + charAt(i))\r\n                //  - otherwise, break before i (and re-establish a correct visibleColumn by charAt(i))\r\n                var breakBeforeOffset = void 0;\r\n                var restoreVisibleColumnFrom = void 0;\r\n                if (niceBreakOffset !== -1 && niceBreakVisibleColumn <= breakingColumn) {\r\n                    // We will break before `niceBreakLastOffset`\r\n                    breakBeforeOffset = niceBreakOffset;\r\n                    restoreVisibleColumnFrom = niceBreakVisibleColumn;\r\n                }\r\n                else if (obtrusiveBreakOffset !== -1 && obtrusiveBreakVisibleColumn <= breakingColumn) {\r\n                    // We will break before `obtrusiveBreakLastOffset`\r\n                    breakBeforeOffset = obtrusiveBreakOffset;\r\n                    restoreVisibleColumnFrom = obtrusiveBreakVisibleColumn;\r\n                }\r\n                else {\r\n                    // We will break before `i`\r\n                    breakBeforeOffset = i;\r\n                    restoreVisibleColumnFrom = wrappedTextIndentVisibleColumn;\r\n                }\r\n                // Break before character at `breakBeforeOffset`\r\n                breakingLengths[breakingLengthsIndex++] = breakBeforeOffset - lastBreakingOffset;\r\n                lastBreakingOffset = breakBeforeOffset;\r\n                // Re-establish visibleColumn by taking character at `i` into account\r\n                visibleColumn = CharacterHardWrappingLineMapperFactory.nextVisibleColumn(restoreVisibleColumnFrom, tabSize, charCodeIsTab, charColumnSize);\r\n                // Reset markers\r\n                niceBreakOffset = -1;\r\n                niceBreakVisibleColumn = 0;\r\n                obtrusiveBreakOffset = -1;\r\n                obtrusiveBreakVisibleColumn = 0;\r\n            }\r\n            // At this point, there is a certainty that the character at `i` fits on the current line\r\n            if (niceBreakOffset !== -1) {\r\n                // Advance niceBreakVisibleColumn\r\n                niceBreakVisibleColumn = CharacterHardWrappingLineMapperFactory.nextVisibleColumn(niceBreakVisibleColumn, tabSize, charCodeIsTab, charColumnSize);\r\n            }\r\n            if (obtrusiveBreakOffset !== -1) {\r\n                // Advance obtrusiveBreakVisibleColumn\r\n                obtrusiveBreakVisibleColumn = CharacterHardWrappingLineMapperFactory.nextVisibleColumn(obtrusiveBreakVisibleColumn, tabSize, charCodeIsTab, charColumnSize);\r\n            }\r\n            if (charCodeClass === 2 /* BREAK_AFTER */ && (hardWrappingIndent === 0 /* None */ || i >= firstNonWhitespaceIndex)) {\r\n                // This is a character that indicates that a break should happen after it\r\n                niceBreakOffset = i + 1;\r\n                niceBreakVisibleColumn = wrappedTextIndentVisibleColumn;\r\n            }\r\n            // CJK breaking : after break\r\n            if (charCodeClass === 4 /* BREAK_IDEOGRAPHIC */ && i < len - 1) {\r\n                var nextCode = lineText.charCodeAt(i + 1);\r\n                var nextClass = classifier.get(nextCode);\r\n                if (nextClass !== 2 /* BREAK_AFTER */) { // Kinsoku Shori: Don't break before a trailing character, like a period\r\n                    niceBreakOffset = i + 1;\r\n                    niceBreakVisibleColumn = wrappedTextIndentVisibleColumn;\r\n                }\r\n            }\r\n            if (charCodeClass === 3 /* BREAK_OBTRUSIVE */) {\r\n                // This is an obtrusive character that indicates that a break should happen after it\r\n                obtrusiveBreakOffset = i + 1;\r\n                obtrusiveBreakVisibleColumn = wrappedTextIndentVisibleColumn;\r\n            }\r\n        }\r\n        if (breakingLengthsIndex === 0) {\r\n            return null;\r\n        }\r\n        // Add last segment\r\n        breakingLengths[breakingLengthsIndex++] = len - lastBreakingOffset;\r\n        return new CharacterHardWrappingLineMapping(new PrefixSumComputer(toUint32Array(breakingLengths)), wrappedTextIndent);\r\n    };\r\n    return CharacterHardWrappingLineMapperFactory;\r\n}());\r\nexport { CharacterHardWrappingLineMapperFactory };\r\nvar CharacterHardWrappingLineMapping = /** @class */ (function () {\r\n    function CharacterHardWrappingLineMapping(prefixSums, wrappedLinesIndent) {\r\n        this._prefixSums = prefixSums;\r\n        this._wrappedLinesIndent = wrappedLinesIndent;\r\n    }\r\n    CharacterHardWrappingLineMapping.prototype.getOutputLineCount = function () {\r\n        return this._prefixSums.getCount();\r\n    };\r\n    CharacterHardWrappingLineMapping.prototype.getWrappedLinesIndent = function () {\r\n        return this._wrappedLinesIndent;\r\n    };\r\n    CharacterHardWrappingLineMapping.prototype.getInputOffsetOfOutputPosition = function (outputLineIndex, outputOffset) {\r\n        if (outputLineIndex === 0) {\r\n            return outputOffset;\r\n        }\r\n        else {\r\n            return this._prefixSums.getAccumulatedValue(outputLineIndex - 1) + outputOffset;\r\n        }\r\n    };\r\n    CharacterHardWrappingLineMapping.prototype.getOutputPositionOfInputOffset = function (inputOffset) {\r\n        var r = this._prefixSums.getIndexOf(inputOffset);\r\n        return new OutputPosition(r.index, r.remainder);\r\n    };\r\n    return CharacterHardWrappingLineMapping;\r\n}());\r\nexport { CharacterHardWrappingLineMapping };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nimport { InlineDecoration, ViewModelDecoration } from './viewModel.js';\r\nvar ViewModelDecorations = /** @class */ (function () {\r\n    function ViewModelDecorations(editorId, model, configuration, linesCollection, coordinatesConverter) {\r\n        this.editorId = editorId;\r\n        this.model = model;\r\n        this.configuration = configuration;\r\n        this._linesCollection = linesCollection;\r\n        this._coordinatesConverter = coordinatesConverter;\r\n        this._decorationsCache = Object.create(null);\r\n        this._clearCachedModelDecorationsResolver();\r\n    }\r\n    ViewModelDecorations.prototype._clearCachedModelDecorationsResolver = function () {\r\n        this._cachedModelDecorationsResolver = null;\r\n        this._cachedModelDecorationsResolverViewRange = null;\r\n    };\r\n    ViewModelDecorations.prototype.dispose = function () {\r\n        this._decorationsCache = Object.create(null);\r\n        this._clearCachedModelDecorationsResolver();\r\n    };\r\n    ViewModelDecorations.prototype.reset = function () {\r\n        this._decorationsCache = Object.create(null);\r\n        this._clearCachedModelDecorationsResolver();\r\n    };\r\n    ViewModelDecorations.prototype.onModelDecorationsChanged = function () {\r\n        this._decorationsCache = Object.create(null);\r\n        this._clearCachedModelDecorationsResolver();\r\n    };\r\n    ViewModelDecorations.prototype.onLineMappingChanged = function () {\r\n        this._decorationsCache = Object.create(null);\r\n        this._clearCachedModelDecorationsResolver();\r\n    };\r\n    ViewModelDecorations.prototype._getOrCreateViewModelDecoration = function (modelDecoration) {\r\n        var id = modelDecoration.id;\r\n        var r = this._decorationsCache[id];\r\n        if (!r) {\r\n            var modelRange = modelDecoration.range;\r\n            var options = modelDecoration.options;\r\n            var viewRange = void 0;\r\n            if (options.isWholeLine) {\r\n                var start = this._coordinatesConverter.convertModelPositionToViewPosition(new Position(modelRange.startLineNumber, 1));\r\n                var end = this._coordinatesConverter.convertModelPositionToViewPosition(new Position(modelRange.endLineNumber, this.model.getLineMaxColumn(modelRange.endLineNumber)));\r\n                viewRange = new Range(start.lineNumber, start.column, end.lineNumber, end.column);\r\n            }\r\n            else {\r\n                viewRange = this._coordinatesConverter.convertModelRangeToViewRange(modelRange);\r\n            }\r\n            r = new ViewModelDecoration(viewRange, options);\r\n            this._decorationsCache[id] = r;\r\n        }\r\n        return r;\r\n    };\r\n    ViewModelDecorations.prototype.getDecorationsViewportData = function (viewRange) {\r\n        var cacheIsValid = true;\r\n        cacheIsValid = cacheIsValid && (this._cachedModelDecorationsResolver !== null);\r\n        cacheIsValid = cacheIsValid && (viewRange.equalsRange(this._cachedModelDecorationsResolverViewRange));\r\n        if (!cacheIsValid) {\r\n            this._cachedModelDecorationsResolver = this._getDecorationsViewportData(viewRange);\r\n            this._cachedModelDecorationsResolverViewRange = viewRange;\r\n        }\r\n        return this._cachedModelDecorationsResolver;\r\n    };\r\n    ViewModelDecorations.prototype._getDecorationsViewportData = function (viewportRange) {\r\n        var modelDecorations = this._linesCollection.getDecorationsInRange(viewportRange, this.editorId, this.configuration.editor.readOnly);\r\n        var startLineNumber = viewportRange.startLineNumber;\r\n        var endLineNumber = viewportRange.endLineNumber;\r\n        var decorationsInViewport = [], decorationsInViewportLen = 0;\r\n        var inlineDecorations = [];\r\n        for (var j = startLineNumber; j <= endLineNumber; j++) {\r\n            inlineDecorations[j - startLineNumber] = [];\r\n        }\r\n        for (var i = 0, len = modelDecorations.length; i < len; i++) {\r\n            var modelDecoration = modelDecorations[i];\r\n            var decorationOptions = modelDecoration.options;\r\n            var viewModelDecoration = this._getOrCreateViewModelDecoration(modelDecoration);\r\n            var viewRange = viewModelDecoration.range;\r\n            decorationsInViewport[decorationsInViewportLen++] = viewModelDecoration;\r\n            if (decorationOptions.inlineClassName) {\r\n                var inlineDecoration = new InlineDecoration(viewRange, decorationOptions.inlineClassName, decorationOptions.inlineClassNameAffectsLetterSpacing ? 3 /* RegularAffectingLetterSpacing */ : 0 /* Regular */);\r\n                var intersectedStartLineNumber = Math.max(startLineNumber, viewRange.startLineNumber);\r\n                var intersectedEndLineNumber = Math.min(endLineNumber, viewRange.endLineNumber);\r\n                for (var j = intersectedStartLineNumber; j <= intersectedEndLineNumber; j++) {\r\n                    inlineDecorations[j - startLineNumber].push(inlineDecoration);\r\n                }\r\n            }\r\n            if (decorationOptions.beforeContentClassName) {\r\n                if (startLineNumber <= viewRange.startLineNumber && viewRange.startLineNumber <= endLineNumber) {\r\n                    var inlineDecoration = new InlineDecoration(new Range(viewRange.startLineNumber, viewRange.startColumn, viewRange.startLineNumber, viewRange.startColumn), decorationOptions.beforeContentClassName, 1 /* Before */);\r\n                    inlineDecorations[viewRange.startLineNumber - startLineNumber].push(inlineDecoration);\r\n                }\r\n            }\r\n            if (decorationOptions.afterContentClassName) {\r\n                if (startLineNumber <= viewRange.endLineNumber && viewRange.endLineNumber <= endLineNumber) {\r\n                    var inlineDecoration = new InlineDecoration(new Range(viewRange.endLineNumber, viewRange.endColumn, viewRange.endLineNumber, viewRange.endColumn), decorationOptions.afterContentClassName, 2 /* After */);\r\n                    inlineDecorations[viewRange.endLineNumber - startLineNumber].push(inlineDecoration);\r\n                }\r\n            }\r\n        }\r\n        return {\r\n            decorations: decorationsInViewport,\r\n            inlineDecorations: inlineDecorations\r\n        };\r\n    };\r\n    return ViewModelDecorations;\r\n}());\r\nexport { ViewModelDecorations };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Color } from '../../../base/common/color.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Position } from '../core/position.js';\r\nimport { Range } from '../core/range.js';\r\nimport { TokenizationRegistry } from '../modes.js';\r\nimport { tokenizeLineToHTML } from '../modes/textToHtmlTokenizer.js';\r\nimport { MinimapTokensColorTracker } from '../view/minimapCharRenderer.js';\r\nimport * as viewEvents from '../view/viewEvents.js';\r\nimport { ViewLayout } from '../viewLayout/viewLayout.js';\r\nimport { CharacterHardWrappingLineMapperFactory } from './characterHardWrappingLineMapper.js';\r\nimport { IdentityLinesCollection, SplitLinesCollection } from './splitLinesCollection.js';\r\nimport { MinimapLinesRenderingData, ViewLineRenderingData } from './viewModel.js';\r\nimport { ViewModelDecorations } from './viewModelDecorations.js';\r\nvar USE_IDENTITY_LINES_COLLECTION = true;\r\nvar ViewModel = /** @class */ (function (_super) {\r\n    __extends(ViewModel, _super);\r\n    function ViewModel(editorId, configuration, model, scheduleAtNextAnimationFrame) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editorId = editorId;\r\n        _this.configuration = configuration;\r\n        _this.model = model;\r\n        _this.hasFocus = false;\r\n        _this.viewportStartLine = -1;\r\n        _this.viewportStartLineTrackedRange = null;\r\n        _this.viewportStartLineDelta = 0;\r\n        if (USE_IDENTITY_LINES_COLLECTION && _this.model.isTooLargeForTokenization()) {\r\n            _this.lines = new IdentityLinesCollection(_this.model);\r\n        }\r\n        else {\r\n            var conf = _this.configuration.editor;\r\n            var hardWrappingLineMapperFactory = new CharacterHardWrappingLineMapperFactory(conf.wrappingInfo.wordWrapBreakBeforeCharacters, conf.wrappingInfo.wordWrapBreakAfterCharacters, conf.wrappingInfo.wordWrapBreakObtrusiveCharacters);\r\n            _this.lines = new SplitLinesCollection(_this.model, hardWrappingLineMapperFactory, _this.model.getOptions().tabSize, conf.wrappingInfo.wrappingColumn, conf.fontInfo.typicalFullwidthCharacterWidth / conf.fontInfo.typicalHalfwidthCharacterWidth, conf.wrappingInfo.wrappingIndent);\r\n        }\r\n        _this.coordinatesConverter = _this.lines.createCoordinatesConverter();\r\n        _this.viewLayout = _this._register(new ViewLayout(_this.configuration, _this.getLineCount(), scheduleAtNextAnimationFrame));\r\n        _this._register(_this.viewLayout.onDidScroll(function (e) {\r\n            try {\r\n                var eventsCollector = _this._beginEmit();\r\n                eventsCollector.emit(new viewEvents.ViewScrollChangedEvent(e));\r\n            }\r\n            finally {\r\n                _this._endEmit();\r\n            }\r\n        }));\r\n        _this.decorations = new ViewModelDecorations(_this.editorId, _this.model, _this.configuration, _this.lines, _this.coordinatesConverter);\r\n        _this._registerModelEvents();\r\n        _this._register(_this.configuration.onDidChange(function (e) {\r\n            try {\r\n                var eventsCollector = _this._beginEmit();\r\n                _this._onConfigurationChanged(eventsCollector, e);\r\n            }\r\n            finally {\r\n                _this._endEmit();\r\n            }\r\n        }));\r\n        _this._register(MinimapTokensColorTracker.getInstance().onDidChange(function () {\r\n            try {\r\n                var eventsCollector = _this._beginEmit();\r\n                eventsCollector.emit(new viewEvents.ViewTokensColorsChangedEvent());\r\n            }\r\n            finally {\r\n                _this._endEmit();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    ViewModel.prototype.dispose = function () {\r\n        // First remove listeners, as disposing the lines might end up sending\r\n        // model decoration changed events ... and we no longer care about them ...\r\n        _super.prototype.dispose.call(this);\r\n        this.decorations.dispose();\r\n        this.lines.dispose();\r\n        this.viewportStartLineTrackedRange = this.model._setTrackedRange(this.viewportStartLineTrackedRange, null, 1 /* NeverGrowsWhenTypingAtEdges */);\r\n    };\r\n    ViewModel.prototype.setHasFocus = function (hasFocus) {\r\n        this.hasFocus = hasFocus;\r\n    };\r\n    ViewModel.prototype._onConfigurationChanged = function (eventsCollector, e) {\r\n        // We might need to restore the current centered view range, so save it (if available)\r\n        var previousViewportStartModelPosition = null;\r\n        if (this.viewportStartLine !== -1) {\r\n            var previousViewportStartViewPosition = new Position(this.viewportStartLine, this.getLineMinColumn(this.viewportStartLine));\r\n            previousViewportStartModelPosition = this.coordinatesConverter.convertViewPositionToModelPosition(previousViewportStartViewPosition);\r\n        }\r\n        var restorePreviousViewportStart = false;\r\n        var conf = this.configuration.editor;\r\n        if (this.lines.setWrappingSettings(conf.wrappingInfo.wrappingIndent, conf.wrappingInfo.wrappingColumn, conf.fontInfo.typicalFullwidthCharacterWidth / conf.fontInfo.typicalHalfwidthCharacterWidth)) {\r\n            eventsCollector.emit(new viewEvents.ViewFlushedEvent());\r\n            eventsCollector.emit(new viewEvents.ViewLineMappingChangedEvent());\r\n            eventsCollector.emit(new viewEvents.ViewDecorationsChangedEvent());\r\n            this.decorations.onLineMappingChanged();\r\n            this.viewLayout.onFlushed(this.getLineCount());\r\n            if (this.viewLayout.getCurrentScrollTop() !== 0) {\r\n                // Never change the scroll position from 0 to something else...\r\n                restorePreviousViewportStart = true;\r\n            }\r\n        }\r\n        if (e.readOnly) {\r\n            // Must read again all decorations due to readOnly filtering\r\n            this.decorations.reset();\r\n            eventsCollector.emit(new viewEvents.ViewDecorationsChangedEvent());\r\n        }\r\n        eventsCollector.emit(new viewEvents.ViewConfigurationChangedEvent(e));\r\n        this.viewLayout.onConfigurationChanged(e);\r\n        if (restorePreviousViewportStart && previousViewportStartModelPosition) {\r\n            var viewPosition = this.coordinatesConverter.convertModelPositionToViewPosition(previousViewportStartModelPosition);\r\n            var viewPositionTop = this.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\r\n            this.viewLayout.setScrollPositionNow({ scrollTop: viewPositionTop + this.viewportStartLineDelta });\r\n        }\r\n    };\r\n    ViewModel.prototype._registerModelEvents = function () {\r\n        var _this = this;\r\n        this._register(this.model.onDidChangeRawContentFast(function (e) {\r\n            try {\r\n                var eventsCollector = _this._beginEmit();\r\n                var hadOtherModelChange = false;\r\n                var hadModelLineChangeThatChangedLineMapping = false;\r\n                var changes = e.changes;\r\n                var versionId = e.versionId;\r\n                for (var j = 0, lenJ = changes.length; j < lenJ; j++) {\r\n                    var change = changes[j];\r\n                    switch (change.changeType) {\r\n                        case 1 /* Flush */: {\r\n                            _this.lines.onModelFlushed();\r\n                            eventsCollector.emit(new viewEvents.ViewFlushedEvent());\r\n                            _this.decorations.reset();\r\n                            _this.viewLayout.onFlushed(_this.getLineCount());\r\n                            hadOtherModelChange = true;\r\n                            break;\r\n                        }\r\n                        case 3 /* LinesDeleted */: {\r\n                            var linesDeletedEvent = _this.lines.onModelLinesDeleted(versionId, change.fromLineNumber, change.toLineNumber);\r\n                            if (linesDeletedEvent !== null) {\r\n                                eventsCollector.emit(linesDeletedEvent);\r\n                                _this.viewLayout.onLinesDeleted(linesDeletedEvent.fromLineNumber, linesDeletedEvent.toLineNumber);\r\n                            }\r\n                            hadOtherModelChange = true;\r\n                            break;\r\n                        }\r\n                        case 4 /* LinesInserted */: {\r\n                            var linesInsertedEvent = _this.lines.onModelLinesInserted(versionId, change.fromLineNumber, change.toLineNumber, change.detail);\r\n                            if (linesInsertedEvent !== null) {\r\n                                eventsCollector.emit(linesInsertedEvent);\r\n                                _this.viewLayout.onLinesInserted(linesInsertedEvent.fromLineNumber, linesInsertedEvent.toLineNumber);\r\n                            }\r\n                            hadOtherModelChange = true;\r\n                            break;\r\n                        }\r\n                        case 2 /* LineChanged */: {\r\n                            var _a = _this.lines.onModelLineChanged(versionId, change.lineNumber, change.detail), lineMappingChanged = _a[0], linesChangedEvent = _a[1], linesInsertedEvent = _a[2], linesDeletedEvent = _a[3];\r\n                            hadModelLineChangeThatChangedLineMapping = lineMappingChanged;\r\n                            if (linesChangedEvent) {\r\n                                eventsCollector.emit(linesChangedEvent);\r\n                            }\r\n                            if (linesInsertedEvent) {\r\n                                eventsCollector.emit(linesInsertedEvent);\r\n                                _this.viewLayout.onLinesInserted(linesInsertedEvent.fromLineNumber, linesInsertedEvent.toLineNumber);\r\n                            }\r\n                            if (linesDeletedEvent) {\r\n                                eventsCollector.emit(linesDeletedEvent);\r\n                                _this.viewLayout.onLinesDeleted(linesDeletedEvent.fromLineNumber, linesDeletedEvent.toLineNumber);\r\n                            }\r\n                            break;\r\n                        }\r\n                        case 5 /* EOLChanged */: {\r\n                            // Nothing to do. The new version will be accepted below\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                _this.lines.acceptVersionId(versionId);\r\n                _this.viewLayout.onHeightMaybeChanged();\r\n                if (!hadOtherModelChange && hadModelLineChangeThatChangedLineMapping) {\r\n                    eventsCollector.emit(new viewEvents.ViewLineMappingChangedEvent());\r\n                    eventsCollector.emit(new viewEvents.ViewDecorationsChangedEvent());\r\n                    _this.decorations.onLineMappingChanged();\r\n                }\r\n            }\r\n            finally {\r\n                _this._endEmit();\r\n            }\r\n            // Update the configuration and reset the centered view line\r\n            _this.viewportStartLine = -1;\r\n            _this.configuration.setMaxLineNumber(_this.model.getLineCount());\r\n            // Recover viewport\r\n            if (!_this.hasFocus && _this.model.getAttachedEditorCount() >= 2 && _this.viewportStartLineTrackedRange) {\r\n                var modelRange = _this.model._getTrackedRange(_this.viewportStartLineTrackedRange);\r\n                if (modelRange) {\r\n                    var viewPosition = _this.coordinatesConverter.convertModelPositionToViewPosition(modelRange.getStartPosition());\r\n                    var viewPositionTop = _this.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\r\n                    _this.viewLayout.setScrollPositionNow({ scrollTop: viewPositionTop + _this.viewportStartLineDelta });\r\n                }\r\n            }\r\n        }));\r\n        this._register(this.model.onDidChangeTokens(function (e) {\r\n            var viewRanges = [];\r\n            for (var j = 0, lenJ = e.ranges.length; j < lenJ; j++) {\r\n                var modelRange = e.ranges[j];\r\n                var viewStartLineNumber = _this.coordinatesConverter.convertModelPositionToViewPosition(new Position(modelRange.fromLineNumber, 1)).lineNumber;\r\n                var viewEndLineNumber = _this.coordinatesConverter.convertModelPositionToViewPosition(new Position(modelRange.toLineNumber, _this.model.getLineMaxColumn(modelRange.toLineNumber))).lineNumber;\r\n                viewRanges[j] = {\r\n                    fromLineNumber: viewStartLineNumber,\r\n                    toLineNumber: viewEndLineNumber\r\n                };\r\n            }\r\n            try {\r\n                var eventsCollector = _this._beginEmit();\r\n                eventsCollector.emit(new viewEvents.ViewTokensChangedEvent(viewRanges));\r\n            }\r\n            finally {\r\n                _this._endEmit();\r\n            }\r\n        }));\r\n        this._register(this.model.onDidChangeLanguageConfiguration(function (e) {\r\n            try {\r\n                var eventsCollector = _this._beginEmit();\r\n                eventsCollector.emit(new viewEvents.ViewLanguageConfigurationEvent());\r\n            }\r\n            finally {\r\n                _this._endEmit();\r\n            }\r\n        }));\r\n        this._register(this.model.onDidChangeOptions(function (e) {\r\n            // A tab size change causes a line mapping changed event => all view parts will repaint OK, no further event needed here\r\n            if (_this.lines.setTabSize(_this.model.getOptions().tabSize)) {\r\n                _this.decorations.onLineMappingChanged();\r\n                _this.viewLayout.onFlushed(_this.getLineCount());\r\n                try {\r\n                    var eventsCollector = _this._beginEmit();\r\n                    eventsCollector.emit(new viewEvents.ViewFlushedEvent());\r\n                    eventsCollector.emit(new viewEvents.ViewLineMappingChangedEvent());\r\n                    eventsCollector.emit(new viewEvents.ViewDecorationsChangedEvent());\r\n                }\r\n                finally {\r\n                    _this._endEmit();\r\n                }\r\n            }\r\n        }));\r\n        this._register(this.model.onDidChangeDecorations(function (e) {\r\n            _this.decorations.onModelDecorationsChanged();\r\n            try {\r\n                var eventsCollector = _this._beginEmit();\r\n                eventsCollector.emit(new viewEvents.ViewDecorationsChangedEvent());\r\n            }\r\n            finally {\r\n                _this._endEmit();\r\n            }\r\n        }));\r\n    };\r\n    ViewModel.prototype.setHiddenAreas = function (ranges) {\r\n        try {\r\n            var eventsCollector = this._beginEmit();\r\n            var lineMappingChanged = this.lines.setHiddenAreas(ranges);\r\n            if (lineMappingChanged) {\r\n                eventsCollector.emit(new viewEvents.ViewFlushedEvent());\r\n                eventsCollector.emit(new viewEvents.ViewLineMappingChangedEvent());\r\n                eventsCollector.emit(new viewEvents.ViewDecorationsChangedEvent());\r\n                this.decorations.onLineMappingChanged();\r\n                this.viewLayout.onFlushed(this.getLineCount());\r\n                this.viewLayout.onHeightMaybeChanged();\r\n            }\r\n        }\r\n        finally {\r\n            this._endEmit();\r\n        }\r\n    };\r\n    ViewModel.prototype.getVisibleRanges = function () {\r\n        var visibleViewRange = this.getCompletelyVisibleViewRange();\r\n        var visibleRange = this.coordinatesConverter.convertViewRangeToModelRange(visibleViewRange);\r\n        var hiddenAreas = this.lines.getHiddenAreas();\r\n        if (hiddenAreas.length === 0) {\r\n            return [visibleRange];\r\n        }\r\n        var result = [], resultLen = 0;\r\n        var startLineNumber = visibleRange.startLineNumber;\r\n        var startColumn = visibleRange.startColumn;\r\n        var endLineNumber = visibleRange.endLineNumber;\r\n        var endColumn = visibleRange.endColumn;\r\n        for (var i = 0, len = hiddenAreas.length; i < len; i++) {\r\n            var hiddenStartLineNumber = hiddenAreas[i].startLineNumber;\r\n            var hiddenEndLineNumber = hiddenAreas[i].endLineNumber;\r\n            if (hiddenEndLineNumber < startLineNumber) {\r\n                continue;\r\n            }\r\n            if (hiddenStartLineNumber > endLineNumber) {\r\n                continue;\r\n            }\r\n            if (startLineNumber < hiddenStartLineNumber) {\r\n                result[resultLen++] = new Range(startLineNumber, startColumn, hiddenStartLineNumber - 1, this.model.getLineMaxColumn(hiddenStartLineNumber - 1));\r\n            }\r\n            startLineNumber = hiddenEndLineNumber + 1;\r\n            startColumn = 1;\r\n        }\r\n        if (startLineNumber < endLineNumber || (startLineNumber === endLineNumber && startColumn < endColumn)) {\r\n            result[resultLen++] = new Range(startLineNumber, startColumn, endLineNumber, endColumn);\r\n        }\r\n        return result;\r\n    };\r\n    ViewModel.prototype.getCompletelyVisibleViewRange = function () {\r\n        var partialData = this.viewLayout.getLinesViewportData();\r\n        var startViewLineNumber = partialData.completelyVisibleStartLineNumber;\r\n        var endViewLineNumber = partialData.completelyVisibleEndLineNumber;\r\n        return new Range(startViewLineNumber, this.getLineMinColumn(startViewLineNumber), endViewLineNumber, this.getLineMaxColumn(endViewLineNumber));\r\n    };\r\n    ViewModel.prototype.getCompletelyVisibleViewRangeAtScrollTop = function (scrollTop) {\r\n        var partialData = this.viewLayout.getLinesViewportDataAtScrollTop(scrollTop);\r\n        var startViewLineNumber = partialData.completelyVisibleStartLineNumber;\r\n        var endViewLineNumber = partialData.completelyVisibleEndLineNumber;\r\n        return new Range(startViewLineNumber, this.getLineMinColumn(startViewLineNumber), endViewLineNumber, this.getLineMaxColumn(endViewLineNumber));\r\n    };\r\n    ViewModel.prototype.saveState = function () {\r\n        var compatViewState = this.viewLayout.saveState();\r\n        var scrollTop = compatViewState.scrollTop;\r\n        var firstViewLineNumber = this.viewLayout.getLineNumberAtVerticalOffset(scrollTop);\r\n        var firstPosition = this.coordinatesConverter.convertViewPositionToModelPosition(new Position(firstViewLineNumber, this.getLineMinColumn(firstViewLineNumber)));\r\n        var firstPositionDeltaTop = this.viewLayout.getVerticalOffsetForLineNumber(firstViewLineNumber) - scrollTop;\r\n        return {\r\n            scrollLeft: compatViewState.scrollLeft,\r\n            firstPosition: firstPosition,\r\n            firstPositionDeltaTop: firstPositionDeltaTop\r\n        };\r\n    };\r\n    ViewModel.prototype.reduceRestoreState = function (state) {\r\n        if (typeof state.firstPosition === 'undefined') {\r\n            // This is a view state serialized by an older version\r\n            return this._reduceRestoreStateCompatibility(state);\r\n        }\r\n        var modelPosition = this.model.validatePosition(state.firstPosition);\r\n        var viewPosition = this.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\r\n        var scrollTop = this.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber) - state.firstPositionDeltaTop;\r\n        return {\r\n            scrollLeft: state.scrollLeft,\r\n            scrollTop: scrollTop\r\n        };\r\n    };\r\n    ViewModel.prototype._reduceRestoreStateCompatibility = function (state) {\r\n        return {\r\n            scrollLeft: state.scrollLeft,\r\n            scrollTop: state.scrollTopWithoutViewZones\r\n        };\r\n    };\r\n    ViewModel.prototype.getTabSize = function () {\r\n        return this.model.getOptions().tabSize;\r\n    };\r\n    ViewModel.prototype.getLineCount = function () {\r\n        return this.lines.getViewLineCount();\r\n    };\r\n    /**\r\n     * Gives a hint that a lot of requests are about to come in for these line numbers.\r\n     */\r\n    ViewModel.prototype.setViewport = function (startLineNumber, endLineNumber, centeredLineNumber) {\r\n        this.lines.warmUpLookupCache(startLineNumber, endLineNumber);\r\n        this.viewportStartLine = startLineNumber;\r\n        var position = this.coordinatesConverter.convertViewPositionToModelPosition(new Position(startLineNumber, this.getLineMinColumn(startLineNumber)));\r\n        this.viewportStartLineTrackedRange = this.model._setTrackedRange(this.viewportStartLineTrackedRange, new Range(position.lineNumber, position.column, position.lineNumber, position.column), 1 /* NeverGrowsWhenTypingAtEdges */);\r\n        var viewportStartLineTop = this.viewLayout.getVerticalOffsetForLineNumber(startLineNumber);\r\n        var scrollTop = this.viewLayout.getCurrentScrollTop();\r\n        this.viewportStartLineDelta = scrollTop - viewportStartLineTop;\r\n    };\r\n    ViewModel.prototype.getActiveIndentGuide = function (lineNumber, minLineNumber, maxLineNumber) {\r\n        return this.lines.getActiveIndentGuide(lineNumber, minLineNumber, maxLineNumber);\r\n    };\r\n    ViewModel.prototype.getLinesIndentGuides = function (startLineNumber, endLineNumber) {\r\n        return this.lines.getViewLinesIndentGuides(startLineNumber, endLineNumber);\r\n    };\r\n    ViewModel.prototype.getLineContent = function (lineNumber) {\r\n        return this.lines.getViewLineContent(lineNumber);\r\n    };\r\n    ViewModel.prototype.getLineLength = function (lineNumber) {\r\n        return this.lines.getViewLineLength(lineNumber);\r\n    };\r\n    ViewModel.prototype.getLineMinColumn = function (lineNumber) {\r\n        return this.lines.getViewLineMinColumn(lineNumber);\r\n    };\r\n    ViewModel.prototype.getLineMaxColumn = function (lineNumber) {\r\n        return this.lines.getViewLineMaxColumn(lineNumber);\r\n    };\r\n    ViewModel.prototype.getLineFirstNonWhitespaceColumn = function (lineNumber) {\r\n        var result = strings.firstNonWhitespaceIndex(this.getLineContent(lineNumber));\r\n        if (result === -1) {\r\n            return 0;\r\n        }\r\n        return result + 1;\r\n    };\r\n    ViewModel.prototype.getLineLastNonWhitespaceColumn = function (lineNumber) {\r\n        var result = strings.lastNonWhitespaceIndex(this.getLineContent(lineNumber));\r\n        if (result === -1) {\r\n            return 0;\r\n        }\r\n        return result + 2;\r\n    };\r\n    ViewModel.prototype.getDecorationsInViewport = function (visibleRange) {\r\n        return this.decorations.getDecorationsViewportData(visibleRange).decorations;\r\n    };\r\n    ViewModel.prototype.getViewLineRenderingData = function (visibleRange, lineNumber) {\r\n        var mightContainRTL = this.model.mightContainRTL();\r\n        var mightContainNonBasicASCII = this.model.mightContainNonBasicASCII();\r\n        var tabSize = this.getTabSize();\r\n        var lineData = this.lines.getViewLineData(lineNumber);\r\n        var allInlineDecorations = this.decorations.getDecorationsViewportData(visibleRange).inlineDecorations;\r\n        var inlineDecorations = allInlineDecorations[lineNumber - visibleRange.startLineNumber];\r\n        return new ViewLineRenderingData(lineData.minColumn, lineData.maxColumn, lineData.content, lineData.continuesWithWrappedLine, mightContainRTL, mightContainNonBasicASCII, lineData.tokens, inlineDecorations, tabSize);\r\n    };\r\n    ViewModel.prototype.getViewLineData = function (lineNumber) {\r\n        return this.lines.getViewLineData(lineNumber);\r\n    };\r\n    ViewModel.prototype.getMinimapLinesRenderingData = function (startLineNumber, endLineNumber, needed) {\r\n        var result = this.lines.getViewLinesData(startLineNumber, endLineNumber, needed);\r\n        return new MinimapLinesRenderingData(this.getTabSize(), result);\r\n    };\r\n    ViewModel.prototype.getAllOverviewRulerDecorations = function (theme) {\r\n        return this.lines.getAllOverviewRulerDecorations(this.editorId, this.configuration.editor.readOnly, theme);\r\n    };\r\n    ViewModel.prototype.invalidateOverviewRulerColorCache = function () {\r\n        var decorations = this.model.getOverviewRulerDecorations();\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var decoration = decorations[i];\r\n            var opts = decoration.options.overviewRuler;\r\n            if (opts) {\r\n                opts.invalidateCachedColor();\r\n            }\r\n        }\r\n    };\r\n    ViewModel.prototype.getValueInRange = function (range, eol) {\r\n        var modelRange = this.coordinatesConverter.convertViewRangeToModelRange(range);\r\n        return this.model.getValueInRange(modelRange, eol);\r\n    };\r\n    ViewModel.prototype.getModelLineMaxColumn = function (modelLineNumber) {\r\n        return this.model.getLineMaxColumn(modelLineNumber);\r\n    };\r\n    ViewModel.prototype.validateModelPosition = function (position) {\r\n        return this.model.validatePosition(position);\r\n    };\r\n    ViewModel.prototype.validateModelRange = function (range) {\r\n        return this.model.validateRange(range);\r\n    };\r\n    ViewModel.prototype.deduceModelPositionRelativeToViewPosition = function (viewAnchorPosition, deltaOffset, lineFeedCnt) {\r\n        var modelAnchor = this.coordinatesConverter.convertViewPositionToModelPosition(viewAnchorPosition);\r\n        if (this.model.getEOL().length === 2) {\r\n            // This model uses CRLF, so the delta must take that into account\r\n            if (deltaOffset < 0) {\r\n                deltaOffset -= lineFeedCnt;\r\n            }\r\n            else {\r\n                deltaOffset += lineFeedCnt;\r\n            }\r\n        }\r\n        var modelAnchorOffset = this.model.getOffsetAt(modelAnchor);\r\n        var resultOffset = modelAnchorOffset + deltaOffset;\r\n        return this.model.getPositionAt(resultOffset);\r\n    };\r\n    ViewModel.prototype.getEOL = function () {\r\n        return this.model.getEOL();\r\n    };\r\n    ViewModel.prototype.getPlainTextToCopy = function (ranges, emptySelectionClipboard, forceCRLF) {\r\n        var _this = this;\r\n        var newLineCharacter = forceCRLF ? '\\r\\n' : this.model.getEOL();\r\n        ranges = ranges.slice(0);\r\n        ranges.sort(Range.compareRangesUsingStarts);\r\n        var nonEmptyRanges = ranges.filter(function (r) { return !r.isEmpty(); });\r\n        if (nonEmptyRanges.length === 0) {\r\n            if (!emptySelectionClipboard) {\r\n                return '';\r\n            }\r\n            var modelLineNumbers = ranges.map(function (r) {\r\n                var viewLineStart = new Position(r.startLineNumber, 1);\r\n                return _this.coordinatesConverter.convertViewPositionToModelPosition(viewLineStart).lineNumber;\r\n            });\r\n            var result_1 = '';\r\n            for (var i = 0; i < modelLineNumbers.length; i++) {\r\n                if (i > 0 && modelLineNumbers[i - 1] === modelLineNumbers[i]) {\r\n                    continue;\r\n                }\r\n                result_1 += this.model.getLineContent(modelLineNumbers[i]) + newLineCharacter;\r\n            }\r\n            return result_1;\r\n        }\r\n        var result = [];\r\n        for (var i = 0; i < nonEmptyRanges.length; i++) {\r\n            result.push(this.getValueInRange(nonEmptyRanges[i], forceCRLF ? 2 /* CRLF */ : 0 /* TextDefined */));\r\n        }\r\n        return result.length === 1 ? result[0] : result;\r\n    };\r\n    ViewModel.prototype.getHTMLToCopy = function (viewRanges, emptySelectionClipboard) {\r\n        if (this.model.getLanguageIdentifier().id === 1 /* PlainText */) {\r\n            return null;\r\n        }\r\n        if (viewRanges.length !== 1) {\r\n            // no multiple selection support at this time\r\n            return null;\r\n        }\r\n        var range = this.coordinatesConverter.convertViewRangeToModelRange(viewRanges[0]);\r\n        if (range.isEmpty()) {\r\n            if (!emptySelectionClipboard) {\r\n                // nothing to copy\r\n                return null;\r\n            }\r\n            var lineNumber = range.startLineNumber;\r\n            range = new Range(lineNumber, this.model.getLineMinColumn(lineNumber), lineNumber, this.model.getLineMaxColumn(lineNumber));\r\n        }\r\n        var fontInfo = this.configuration.editor.fontInfo;\r\n        var colorMap = this._getColorMap();\r\n        return (\"<div style=\\\"\"\r\n            + (\"color: \" + colorMap[1 /* DefaultForeground */] + \";\")\r\n            + (\"background-color: \" + colorMap[2 /* DefaultBackground */] + \";\")\r\n            + (\"font-family: \" + fontInfo.fontFamily + \";\")\r\n            + (\"font-weight: \" + fontInfo.fontWeight + \";\")\r\n            + (\"font-size: \" + fontInfo.fontSize + \"px;\")\r\n            + (\"line-height: \" + fontInfo.lineHeight + \"px;\")\r\n            + \"white-space: pre;\"\r\n            + \"\\\">\"\r\n            + this._getHTMLToCopy(range, colorMap)\r\n            + '</div>');\r\n    };\r\n    ViewModel.prototype._getHTMLToCopy = function (modelRange, colorMap) {\r\n        var startLineNumber = modelRange.startLineNumber;\r\n        var startColumn = modelRange.startColumn;\r\n        var endLineNumber = modelRange.endLineNumber;\r\n        var endColumn = modelRange.endColumn;\r\n        var tabSize = this.getTabSize();\r\n        var result = '';\r\n        for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n            var lineTokens = this.model.getLineTokens(lineNumber);\r\n            var lineContent = lineTokens.getLineContent();\r\n            var startOffset = (lineNumber === startLineNumber ? startColumn - 1 : 0);\r\n            var endOffset = (lineNumber === endLineNumber ? endColumn - 1 : lineContent.length);\r\n            if (lineContent === '') {\r\n                result += '<br>';\r\n            }\r\n            else {\r\n                result += tokenizeLineToHTML(lineContent, lineTokens.inflate(), colorMap, startOffset, endOffset, tabSize);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    ViewModel.prototype._getColorMap = function () {\r\n        var colorMap = TokenizationRegistry.getColorMap();\r\n        var result = ['#000000'];\r\n        if (colorMap) {\r\n            for (var i = 1, len = colorMap.length; i < len; i++) {\r\n                result[i] = Color.Format.CSS.formatHex(colorMap[i]);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    return ViewModel;\r\n}(viewEvents.ViewEventEmitter));\r\nexport { ViewModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar ServiceCollection = /** @class */ (function () {\r\n    function ServiceCollection() {\r\n        var entries = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            entries[_i] = arguments[_i];\r\n        }\r\n        this._entries = new Map();\r\n        for (var _a = 0, entries_1 = entries; _a < entries_1.length; _a++) {\r\n            var _b = entries_1[_a], id = _b[0], service = _b[1];\r\n            this.set(id, service);\r\n        }\r\n    }\r\n    ServiceCollection.prototype.set = function (id, instanceOrDescriptor) {\r\n        var result = this._entries.get(id);\r\n        this._entries.set(id, instanceOrDescriptor);\r\n        return result;\r\n    };\r\n    ServiceCollection.prototype.has = function (id) {\r\n        return this._entries.has(id);\r\n    };\r\n    ServiceCollection.prototype.get = function (id) {\r\n        return this._entries.get(id);\r\n    };\r\n    return ServiceCollection;\r\n}());\r\nexport { ServiceCollection };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './media/editor.css';\r\nimport './media/tokens.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable, dispose } from '../../../base/common/lifecycle.js';\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport { Configuration } from '../config/configuration.js';\r\nimport { EditorExtensionsRegistry } from '../editorExtensions.js';\r\nimport { ICodeEditorService } from '../services/codeEditorService.js';\r\nimport { View } from '../view/viewImpl.js';\r\nimport { ViewOutgoingEvents } from '../view/viewOutgoingEvents.js';\r\nimport { Cursor } from '../../common/controller/cursor.js';\r\nimport { CursorColumns } from '../../common/controller/cursorCommon.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { InternalEditorAction } from '../../common/editorAction.js';\r\nimport * as editorCommon from '../../common/editorCommon.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { editorErrorBorder, editorErrorForeground, editorHintBorder, editorHintForeground, editorInfoBorder, editorInfoForeground, editorUnnecessaryCodeBorder, editorUnnecessaryCodeOpacity, editorWarningBorder, editorWarningForeground } from '../../common/view/editorColorRegistry.js';\r\nimport { ViewModel } from '../../common/viewModel/viewModelImpl.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nvar EDITOR_ID = 0;\r\nvar SHOW_UNUSED_ENABLED_CLASS = 'showUnused';\r\nvar ModelData = /** @class */ (function () {\r\n    function ModelData(model, viewModel, cursor, view, hasRealView, listenersToRemove) {\r\n        this.model = model;\r\n        this.viewModel = viewModel;\r\n        this.cursor = cursor;\r\n        this.view = view;\r\n        this.hasRealView = hasRealView;\r\n        this.listenersToRemove = listenersToRemove;\r\n    }\r\n    ModelData.prototype.dispose = function () {\r\n        dispose(this.listenersToRemove);\r\n        this.model.onBeforeDetached();\r\n        if (this.hasRealView) {\r\n            this.view.dispose();\r\n        }\r\n        this.cursor.dispose();\r\n        this.viewModel.dispose();\r\n    };\r\n    return ModelData;\r\n}());\r\nvar CodeEditorWidget = /** @class */ (function (_super) {\r\n    __extends(CodeEditorWidget, _super);\r\n    function CodeEditorWidget(domElement, options, codeEditorWidgetOptions, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService) {\r\n        var _this = _super.call(this) || this;\r\n        //#region Eventing\r\n        _this._onDidDispose = _this._register(new Emitter());\r\n        _this.onDidDispose = _this._onDidDispose.event;\r\n        _this._onDidChangeModelContent = _this._register(new Emitter());\r\n        _this.onDidChangeModelContent = _this._onDidChangeModelContent.event;\r\n        _this._onDidChangeModelLanguage = _this._register(new Emitter());\r\n        _this.onDidChangeModelLanguage = _this._onDidChangeModelLanguage.event;\r\n        _this._onDidChangeModelLanguageConfiguration = _this._register(new Emitter());\r\n        _this.onDidChangeModelLanguageConfiguration = _this._onDidChangeModelLanguageConfiguration.event;\r\n        _this._onDidChangeModelOptions = _this._register(new Emitter());\r\n        _this.onDidChangeModelOptions = _this._onDidChangeModelOptions.event;\r\n        _this._onDidChangeModelDecorations = _this._register(new Emitter());\r\n        _this.onDidChangeModelDecorations = _this._onDidChangeModelDecorations.event;\r\n        _this._onDidChangeConfiguration = _this._register(new Emitter());\r\n        _this.onDidChangeConfiguration = _this._onDidChangeConfiguration.event;\r\n        _this._onDidChangeModel = _this._register(new Emitter());\r\n        _this.onDidChangeModel = _this._onDidChangeModel.event;\r\n        _this._onDidChangeCursorPosition = _this._register(new Emitter());\r\n        _this.onDidChangeCursorPosition = _this._onDidChangeCursorPosition.event;\r\n        _this._onDidChangeCursorSelection = _this._register(new Emitter());\r\n        _this.onDidChangeCursorSelection = _this._onDidChangeCursorSelection.event;\r\n        _this._onDidAttemptReadOnlyEdit = _this._register(new Emitter());\r\n        _this.onDidAttemptReadOnlyEdit = _this._onDidAttemptReadOnlyEdit.event;\r\n        _this._onDidLayoutChange = _this._register(new Emitter());\r\n        _this.onDidLayoutChange = _this._onDidLayoutChange.event;\r\n        _this._editorTextFocus = _this._register(new BooleanEventEmitter());\r\n        _this.onDidFocusEditorText = _this._editorTextFocus.onDidChangeToTrue;\r\n        _this.onDidBlurEditorText = _this._editorTextFocus.onDidChangeToFalse;\r\n        _this._editorWidgetFocus = _this._register(new BooleanEventEmitter());\r\n        _this.onDidFocusEditorWidget = _this._editorWidgetFocus.onDidChangeToTrue;\r\n        _this.onDidBlurEditorWidget = _this._editorWidgetFocus.onDidChangeToFalse;\r\n        _this._onWillType = _this._register(new Emitter());\r\n        _this.onWillType = _this._onWillType.event;\r\n        _this._onDidType = _this._register(new Emitter());\r\n        _this.onDidType = _this._onDidType.event;\r\n        _this._onCompositionStart = _this._register(new Emitter());\r\n        _this.onCompositionStart = _this._onCompositionStart.event;\r\n        _this._onCompositionEnd = _this._register(new Emitter());\r\n        _this.onCompositionEnd = _this._onCompositionEnd.event;\r\n        _this._onDidPaste = _this._register(new Emitter());\r\n        _this.onDidPaste = _this._onDidPaste.event;\r\n        _this._onMouseUp = _this._register(new Emitter());\r\n        _this.onMouseUp = _this._onMouseUp.event;\r\n        _this._onMouseDown = _this._register(new Emitter());\r\n        _this.onMouseDown = _this._onMouseDown.event;\r\n        _this._onMouseDrag = _this._register(new Emitter());\r\n        _this.onMouseDrag = _this._onMouseDrag.event;\r\n        _this._onMouseDrop = _this._register(new Emitter());\r\n        _this.onMouseDrop = _this._onMouseDrop.event;\r\n        _this._onContextMenu = _this._register(new Emitter());\r\n        _this.onContextMenu = _this._onContextMenu.event;\r\n        _this._onMouseMove = _this._register(new Emitter());\r\n        _this.onMouseMove = _this._onMouseMove.event;\r\n        _this._onMouseLeave = _this._register(new Emitter());\r\n        _this.onMouseLeave = _this._onMouseLeave.event;\r\n        _this._onKeyUp = _this._register(new Emitter());\r\n        _this.onKeyUp = _this._onKeyUp.event;\r\n        _this._onKeyDown = _this._register(new Emitter());\r\n        _this.onKeyDown = _this._onKeyDown.event;\r\n        _this._onDidScrollChange = _this._register(new Emitter());\r\n        _this.onDidScrollChange = _this._onDidScrollChange.event;\r\n        _this._onDidChangeViewZones = _this._register(new Emitter());\r\n        _this.onDidChangeViewZones = _this._onDidChangeViewZones.event;\r\n        _this._domElement = domElement;\r\n        _this._id = (++EDITOR_ID);\r\n        _this._decorationTypeKeysToIds = {};\r\n        _this._decorationTypeSubtypes = {};\r\n        _this.isSimpleWidget = codeEditorWidgetOptions.isSimpleWidget || false;\r\n        _this._telemetryData = codeEditorWidgetOptions.telemetryData || null;\r\n        options = options || {};\r\n        _this._configuration = _this._register(_this._createConfiguration(options));\r\n        _this._register(_this._configuration.onDidChange(function (e) {\r\n            _this._onDidChangeConfiguration.fire(e);\r\n            if (e.layoutInfo) {\r\n                _this._onDidLayoutChange.fire(_this._configuration.editor.layoutInfo);\r\n            }\r\n            if (_this._configuration.editor.showUnused) {\r\n                _this._domElement.classList.add(SHOW_UNUSED_ENABLED_CLASS);\r\n            }\r\n            else {\r\n                _this._domElement.classList.remove(SHOW_UNUSED_ENABLED_CLASS);\r\n            }\r\n        }));\r\n        _this._contextKeyService = _this._register(contextKeyService.createScoped(_this._domElement));\r\n        _this._notificationService = notificationService;\r\n        _this._codeEditorService = codeEditorService;\r\n        _this._commandService = commandService;\r\n        _this._themeService = themeService;\r\n        _this._register(new EditorContextKeysManager(_this, _this._contextKeyService));\r\n        _this._register(new EditorModeContext(_this, _this._contextKeyService));\r\n        _this._instantiationService = instantiationService.createChild(new ServiceCollection([IContextKeyService, _this._contextKeyService]));\r\n        _this._attachModel(null);\r\n        _this._contributions = {};\r\n        _this._actions = {};\r\n        _this._focusTracker = new CodeEditorWidgetFocusTracker(domElement);\r\n        _this._focusTracker.onChange(function () {\r\n            _this._editorWidgetFocus.setValue(_this._focusTracker.hasFocus());\r\n        });\r\n        _this._contentWidgets = {};\r\n        _this._overlayWidgets = {};\r\n        var contributions;\r\n        if (Array.isArray(codeEditorWidgetOptions.contributions)) {\r\n            contributions = codeEditorWidgetOptions.contributions;\r\n        }\r\n        else {\r\n            contributions = EditorExtensionsRegistry.getEditorContributions();\r\n        }\r\n        for (var i = 0, len = contributions.length; i < len; i++) {\r\n            var ctor = contributions[i];\r\n            try {\r\n                var contribution = _this._instantiationService.createInstance(ctor, _this);\r\n                _this._contributions[contribution.getId()] = contribution;\r\n            }\r\n            catch (err) {\r\n                onUnexpectedError(err);\r\n            }\r\n        }\r\n        EditorExtensionsRegistry.getEditorActions().forEach(function (action) {\r\n            var internalAction = new InternalEditorAction(action.id, action.label, action.alias, action.precondition, function () {\r\n                return _this._instantiationService.invokeFunction(function (accessor) {\r\n                    return Promise.resolve(action.runEditorCommand(accessor, _this, null));\r\n                });\r\n            }, _this._contextKeyService);\r\n            _this._actions[internalAction.id] = internalAction;\r\n        });\r\n        _this._codeEditorService.addCodeEditor(_this);\r\n        return _this;\r\n    }\r\n    CodeEditorWidget.prototype._createConfiguration = function (options) {\r\n        return new Configuration(options, this._domElement);\r\n    };\r\n    CodeEditorWidget.prototype.getId = function () {\r\n        return this.getEditorType() + ':' + this._id;\r\n    };\r\n    CodeEditorWidget.prototype.getEditorType = function () {\r\n        return editorCommon.EditorType.ICodeEditor;\r\n    };\r\n    CodeEditorWidget.prototype.dispose = function () {\r\n        this._codeEditorService.removeCodeEditor(this);\r\n        this._focusTracker.dispose();\r\n        var keys = Object.keys(this._contributions);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var contributionId = keys[i];\r\n            this._contributions[contributionId].dispose();\r\n        }\r\n        this._removeDecorationTypes();\r\n        this._postDetachModelCleanup(this._detachModel());\r\n        this._onDidDispose.fire();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    CodeEditorWidget.prototype.invokeWithinContext = function (fn) {\r\n        return this._instantiationService.invokeFunction(fn);\r\n    };\r\n    CodeEditorWidget.prototype.updateOptions = function (newOptions) {\r\n        this._configuration.updateOptions(newOptions);\r\n    };\r\n    CodeEditorWidget.prototype.getConfiguration = function () {\r\n        return this._configuration.editor;\r\n    };\r\n    CodeEditorWidget.prototype.getRawConfiguration = function () {\r\n        return this._configuration.getRawOptions();\r\n    };\r\n    CodeEditorWidget.prototype.getValue = function (options) {\r\n        if (options === void 0) { options = null; }\r\n        if (!this._modelData) {\r\n            return '';\r\n        }\r\n        var preserveBOM = (options && options.preserveBOM) ? true : false;\r\n        var eolPreference = 0 /* TextDefined */;\r\n        if (options && options.lineEnding && options.lineEnding === '\\n') {\r\n            eolPreference = 1 /* LF */;\r\n        }\r\n        else if (options && options.lineEnding && options.lineEnding === '\\r\\n') {\r\n            eolPreference = 2 /* CRLF */;\r\n        }\r\n        return this._modelData.model.getValue(eolPreference, preserveBOM);\r\n    };\r\n    CodeEditorWidget.prototype.setValue = function (newValue) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.model.setValue(newValue);\r\n    };\r\n    CodeEditorWidget.prototype.getModel = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.model;\r\n    };\r\n    CodeEditorWidget.prototype.setModel = function (model) {\r\n        if (model === void 0) { model = null; }\r\n        if (this._modelData === null && model === null) {\r\n            // Current model is the new model\r\n            return;\r\n        }\r\n        if (this._modelData && this._modelData.model === model) {\r\n            // Current model is the new model\r\n            return;\r\n        }\r\n        var detachedModel = this._detachModel();\r\n        this._attachModel(model);\r\n        var e = {\r\n            oldModelUrl: detachedModel ? detachedModel.uri : null,\r\n            newModelUrl: model ? model.uri : null\r\n        };\r\n        this._removeDecorationTypes();\r\n        this._onDidChangeModel.fire(e);\r\n        this._postDetachModelCleanup(detachedModel);\r\n    };\r\n    CodeEditorWidget.prototype._removeDecorationTypes = function () {\r\n        this._decorationTypeKeysToIds = {};\r\n        if (this._decorationTypeSubtypes) {\r\n            for (var decorationType in this._decorationTypeSubtypes) {\r\n                var subTypes = this._decorationTypeSubtypes[decorationType];\r\n                for (var subType in subTypes) {\r\n                    this._removeDecorationType(decorationType + '-' + subType);\r\n                }\r\n            }\r\n            this._decorationTypeSubtypes = {};\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.getVisibleRanges = function () {\r\n        if (!this._modelData) {\r\n            return [];\r\n        }\r\n        return this._modelData.viewModel.getVisibleRanges();\r\n    };\r\n    CodeEditorWidget.prototype.getWhitespaces = function () {\r\n        if (!this._modelData) {\r\n            return [];\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getWhitespaces();\r\n    };\r\n    CodeEditorWidget._getVerticalOffsetForPosition = function (modelData, modelLineNumber, modelColumn) {\r\n        var modelPosition = modelData.model.validatePosition({\r\n            lineNumber: modelLineNumber,\r\n            column: modelColumn\r\n        });\r\n        var viewPosition = modelData.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\r\n        return modelData.viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\r\n    };\r\n    CodeEditorWidget.prototype.getTopForLineNumber = function (lineNumber) {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, 1);\r\n    };\r\n    CodeEditorWidget.prototype.getTopForPosition = function (lineNumber, column) {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, column);\r\n    };\r\n    CodeEditorWidget.prototype.setHiddenAreas = function (ranges) {\r\n        if (this._modelData) {\r\n            this._modelData.viewModel.setHiddenAreas(ranges.map(function (r) { return Range.lift(r); }));\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.getVisibleColumnFromPosition = function (rawPosition) {\r\n        if (!this._modelData) {\r\n            return rawPosition.column;\r\n        }\r\n        var position = this._modelData.model.validatePosition(rawPosition);\r\n        var tabSize = this._modelData.model.getOptions().tabSize;\r\n        return CursorColumns.visibleColumnFromColumn(this._modelData.model.getLineContent(position.lineNumber), position.column, tabSize) + 1;\r\n    };\r\n    CodeEditorWidget.prototype.getPosition = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.cursor.getPosition();\r\n    };\r\n    CodeEditorWidget.prototype.setPosition = function (position) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (!Position.isIPosition(position)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._modelData.cursor.setSelections('api', [{\r\n                selectionStartLineNumber: position.lineNumber,\r\n                selectionStartColumn: position.column,\r\n                positionLineNumber: position.lineNumber,\r\n                positionColumn: position.column\r\n            }]);\r\n    };\r\n    CodeEditorWidget.prototype._sendRevealRange = function (modelRange, verticalType, revealHorizontal, scrollType) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (!Range.isIRange(modelRange)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        var validatedModelRange = this._modelData.model.validateRange(modelRange);\r\n        var viewRange = this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(validatedModelRange);\r\n        this._modelData.cursor.emitCursorRevealRange(viewRange, verticalType, revealHorizontal, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealLine = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLine(lineNumber, 0 /* Simple */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealLineInCenter = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLine(lineNumber, 1 /* Center */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealLineInCenterIfOutsideViewport = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLine(lineNumber, 2 /* CenterIfOutsideViewport */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype._revealLine = function (lineNumber, revealType, scrollType) {\r\n        if (typeof lineNumber !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(new Range(lineNumber, 1, lineNumber, 1), revealType, false, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealPosition = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealPosition(position, 0 /* Simple */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealPositionInCenter = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealPosition(position, 1 /* Center */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealPositionInCenterIfOutsideViewport = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealPosition(position, 2 /* CenterIfOutsideViewport */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype._revealPosition = function (position, verticalType, revealHorizontal, scrollType) {\r\n        if (!Position.isIPosition(position)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(new Range(position.lineNumber, position.column, position.lineNumber, position.column), verticalType, revealHorizontal, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.getSelection = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.cursor.getSelection();\r\n    };\r\n    CodeEditorWidget.prototype.getSelections = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.cursor.getSelections();\r\n    };\r\n    CodeEditorWidget.prototype.setSelection = function (something) {\r\n        var isSelection = Selection.isISelection(something);\r\n        var isRange = Range.isIRange(something);\r\n        if (!isSelection && !isRange) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        if (isSelection) {\r\n            this._setSelectionImpl(something);\r\n        }\r\n        else if (isRange) {\r\n            // act as if it was an IRange\r\n            var selection = {\r\n                selectionStartLineNumber: something.startLineNumber,\r\n                selectionStartColumn: something.startColumn,\r\n                positionLineNumber: something.endLineNumber,\r\n                positionColumn: something.endColumn\r\n            };\r\n            this._setSelectionImpl(selection);\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype._setSelectionImpl = function (sel) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        var selection = new Selection(sel.selectionStartLineNumber, sel.selectionStartColumn, sel.positionLineNumber, sel.positionColumn);\r\n        this._modelData.cursor.setSelections('api', [selection]);\r\n    };\r\n    CodeEditorWidget.prototype.revealLines = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLines(startLineNumber, endLineNumber, 0 /* Simple */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealLinesInCenter = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLines(startLineNumber, endLineNumber, 1 /* Center */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealLinesInCenterIfOutsideViewport = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealLines(startLineNumber, endLineNumber, 2 /* CenterIfOutsideViewport */, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype._revealLines = function (startLineNumber, endLineNumber, verticalType, scrollType) {\r\n        if (typeof startLineNumber !== 'number' || typeof endLineNumber !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(new Range(startLineNumber, 1, endLineNumber, 1), verticalType, false, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealRange = function (range, scrollType, revealVerticalInCenter, revealHorizontal) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        if (revealVerticalInCenter === void 0) { revealVerticalInCenter = false; }\r\n        if (revealHorizontal === void 0) { revealHorizontal = true; }\r\n        this._revealRange(range, revealVerticalInCenter ? 1 /* Center */ : 0 /* Simple */, revealHorizontal, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealRangeInCenter = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealRange(range, 1 /* Center */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealRangeInCenterIfOutsideViewport = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealRange(range, 2 /* CenterIfOutsideViewport */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.revealRangeAtTop = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this._revealRange(range, 3 /* Top */, true, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype._revealRange = function (range, verticalType, revealHorizontal, scrollType) {\r\n        if (!Range.isIRange(range)) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._sendRevealRange(Range.lift(range), verticalType, revealHorizontal, scrollType);\r\n    };\r\n    CodeEditorWidget.prototype.setSelections = function (ranges, source) {\r\n        if (source === void 0) { source = 'api'; }\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (!ranges || ranges.length === 0) {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        for (var i = 0, len = ranges.length; i < len; i++) {\r\n            if (!Selection.isISelection(ranges[i])) {\r\n                throw new Error('Invalid arguments');\r\n            }\r\n        }\r\n        this._modelData.cursor.setSelections(source, ranges);\r\n    };\r\n    CodeEditorWidget.prototype.getScrollWidth = function () {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getScrollWidth();\r\n    };\r\n    CodeEditorWidget.prototype.getScrollLeft = function () {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getCurrentScrollLeft();\r\n    };\r\n    CodeEditorWidget.prototype.getScrollHeight = function () {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getScrollHeight();\r\n    };\r\n    CodeEditorWidget.prototype.getScrollTop = function () {\r\n        if (!this._modelData) {\r\n            return -1;\r\n        }\r\n        return this._modelData.viewModel.viewLayout.getCurrentScrollTop();\r\n    };\r\n    CodeEditorWidget.prototype.setScrollLeft = function (newScrollLeft) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (typeof newScrollLeft !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._modelData.viewModel.viewLayout.setScrollPositionNow({\r\n            scrollLeft: newScrollLeft\r\n        });\r\n    };\r\n    CodeEditorWidget.prototype.setScrollTop = function (newScrollTop) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (typeof newScrollTop !== 'number') {\r\n            throw new Error('Invalid arguments');\r\n        }\r\n        this._modelData.viewModel.viewLayout.setScrollPositionNow({\r\n            scrollTop: newScrollTop\r\n        });\r\n    };\r\n    CodeEditorWidget.prototype.setScrollPosition = function (position) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.viewModel.viewLayout.setScrollPositionNow(position);\r\n    };\r\n    CodeEditorWidget.prototype.saveViewState = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        var contributionsState = {};\r\n        var keys = Object.keys(this._contributions);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var id = keys[i];\r\n            var contribution = this._contributions[id];\r\n            if (typeof contribution.saveViewState === 'function') {\r\n                contributionsState[id] = contribution.saveViewState();\r\n            }\r\n        }\r\n        var cursorState = this._modelData.cursor.saveState();\r\n        var viewState = this._modelData.viewModel.saveState();\r\n        return {\r\n            cursorState: cursorState,\r\n            viewState: viewState,\r\n            contributionsState: contributionsState\r\n        };\r\n    };\r\n    CodeEditorWidget.prototype.restoreViewState = function (s) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        if (s && s.cursorState && s.viewState) {\r\n            var codeEditorState = s;\r\n            var cursorState = codeEditorState.cursorState;\r\n            if (Array.isArray(cursorState)) {\r\n                this._modelData.cursor.restoreState(cursorState);\r\n            }\r\n            else {\r\n                // Backwards compatibility\r\n                this._modelData.cursor.restoreState([cursorState]);\r\n            }\r\n            var contributionsState = s.contributionsState || {};\r\n            var keys = Object.keys(this._contributions);\r\n            for (var i = 0, len = keys.length; i < len; i++) {\r\n                var id = keys[i];\r\n                var contribution = this._contributions[id];\r\n                if (typeof contribution.restoreViewState === 'function') {\r\n                    contribution.restoreViewState(contributionsState[id]);\r\n                }\r\n            }\r\n            var reducedState = this._modelData.viewModel.reduceRestoreState(s.viewState);\r\n            var linesViewportData = this._modelData.viewModel.viewLayout.getLinesViewportDataAtScrollTop(reducedState.scrollTop);\r\n            var startPosition = this._modelData.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position(linesViewportData.startLineNumber, 1));\r\n            var endPosition = this._modelData.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position(linesViewportData.endLineNumber, 1));\r\n            this._modelData.model.tokenizeViewport(startPosition.lineNumber, endPosition.lineNumber);\r\n            this._modelData.view.restoreState(reducedState);\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.getContribution = function (id) {\r\n        return (this._contributions[id] || null);\r\n    };\r\n    CodeEditorWidget.prototype.getActions = function () {\r\n        var result = [];\r\n        var keys = Object.keys(this._actions);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var id = keys[i];\r\n            result.push(this._actions[id]);\r\n        }\r\n        return result;\r\n    };\r\n    CodeEditorWidget.prototype.getSupportedActions = function () {\r\n        var result = this.getActions();\r\n        result = result.filter(function (action) { return action.isSupported(); });\r\n        return result;\r\n    };\r\n    CodeEditorWidget.prototype.getAction = function (id) {\r\n        return this._actions[id] || null;\r\n    };\r\n    CodeEditorWidget.prototype.trigger = function (source, handlerId, payload) {\r\n        payload = payload || {};\r\n        // Special case for typing\r\n        if (handlerId === editorCommon.Handler.Type) {\r\n            if (!this._modelData || typeof payload.text !== 'string' || payload.text.length === 0) {\r\n                // nothing to do\r\n                return;\r\n            }\r\n            if (source === 'keyboard') {\r\n                this._onWillType.fire(payload.text);\r\n            }\r\n            this._modelData.cursor.trigger(source, handlerId, payload);\r\n            if (source === 'keyboard') {\r\n                this._onDidType.fire(payload.text);\r\n            }\r\n            return;\r\n        }\r\n        // Special case for pasting\r\n        if (handlerId === editorCommon.Handler.Paste) {\r\n            if (!this._modelData || typeof payload.text !== 'string' || payload.text.length === 0) {\r\n                // nothing to do\r\n                return;\r\n            }\r\n            var startPosition = this._modelData.cursor.getSelection().getStartPosition();\r\n            this._modelData.cursor.trigger(source, handlerId, payload);\r\n            var endPosition = this._modelData.cursor.getSelection().getStartPosition();\r\n            if (source === 'keyboard') {\r\n                this._onDidPaste.fire(new Range(startPosition.lineNumber, startPosition.column, endPosition.lineNumber, endPosition.column));\r\n            }\r\n            return;\r\n        }\r\n        if (handlerId === editorCommon.Handler.CompositionStart) {\r\n            this._onCompositionStart.fire();\r\n        }\r\n        if (handlerId === editorCommon.Handler.CompositionEnd) {\r\n            this._onCompositionEnd.fire();\r\n        }\r\n        var action = this.getAction(handlerId);\r\n        if (action) {\r\n            Promise.resolve(action.run()).then(null, onUnexpectedError);\r\n            return;\r\n        }\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        if (this._triggerEditorCommand(source, handlerId, payload)) {\r\n            return;\r\n        }\r\n        this._modelData.cursor.trigger(source, handlerId, payload);\r\n    };\r\n    CodeEditorWidget.prototype._triggerEditorCommand = function (source, handlerId, payload) {\r\n        var _this = this;\r\n        var command = EditorExtensionsRegistry.getEditorCommand(handlerId);\r\n        if (command) {\r\n            payload = payload || {};\r\n            payload.source = source;\r\n            this._instantiationService.invokeFunction(function (accessor) {\r\n                Promise.resolve(command.runEditorCommand(accessor, _this, payload)).then(null, onUnexpectedError);\r\n            });\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CodeEditorWidget.prototype._getCursors = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.cursor;\r\n    };\r\n    CodeEditorWidget.prototype.pushUndoStop = function () {\r\n        if (!this._modelData) {\r\n            return false;\r\n        }\r\n        if (this._configuration.editor.readOnly) {\r\n            // read only editor => sorry!\r\n            return false;\r\n        }\r\n        this._modelData.model.pushStackElement();\r\n        return true;\r\n    };\r\n    CodeEditorWidget.prototype.executeEdits = function (source, edits, endCursorState) {\r\n        if (!this._modelData) {\r\n            return false;\r\n        }\r\n        if (this._configuration.editor.readOnly) {\r\n            // read only editor => sorry!\r\n            return false;\r\n        }\r\n        this._modelData.model.pushEditOperations(this._modelData.cursor.getSelections(), edits, function () {\r\n            return endCursorState ? endCursorState : null;\r\n        });\r\n        if (endCursorState) {\r\n            this._modelData.cursor.setSelections(source, endCursorState);\r\n        }\r\n        return true;\r\n    };\r\n    CodeEditorWidget.prototype.executeCommand = function (source, command) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.cursor.trigger(source, editorCommon.Handler.ExecuteCommand, command);\r\n    };\r\n    CodeEditorWidget.prototype.executeCommands = function (source, commands) {\r\n        if (!this._modelData) {\r\n            return;\r\n        }\r\n        this._modelData.cursor.trigger(source, editorCommon.Handler.ExecuteCommands, commands);\r\n    };\r\n    CodeEditorWidget.prototype.changeDecorations = function (callback) {\r\n        if (!this._modelData) {\r\n            // callback will not be called\r\n            return null;\r\n        }\r\n        return this._modelData.model.changeDecorations(callback, this._id);\r\n    };\r\n    CodeEditorWidget.prototype.getLineDecorations = function (lineNumber) {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        return this._modelData.model.getLineDecorations(lineNumber, this._id, this._configuration.editor.readOnly);\r\n    };\r\n    CodeEditorWidget.prototype.deltaDecorations = function (oldDecorations, newDecorations) {\r\n        if (!this._modelData) {\r\n            return [];\r\n        }\r\n        if (oldDecorations.length === 0 && newDecorations.length === 0) {\r\n            return oldDecorations;\r\n        }\r\n        return this._modelData.model.deltaDecorations(oldDecorations, newDecorations, this._id);\r\n    };\r\n    CodeEditorWidget.prototype.removeDecorations = function (decorationTypeKey) {\r\n        // remove decorations for type and sub type\r\n        var oldDecorationsIds = this._decorationTypeKeysToIds[decorationTypeKey];\r\n        if (oldDecorationsIds) {\r\n            this.deltaDecorations(oldDecorationsIds, []);\r\n        }\r\n        if (this._decorationTypeKeysToIds.hasOwnProperty(decorationTypeKey)) {\r\n            delete this._decorationTypeKeysToIds[decorationTypeKey];\r\n        }\r\n        if (this._decorationTypeSubtypes.hasOwnProperty(decorationTypeKey)) {\r\n            delete this._decorationTypeSubtypes[decorationTypeKey];\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.getLayoutInfo = function () {\r\n        return this._configuration.editor.layoutInfo;\r\n    };\r\n    CodeEditorWidget.prototype.createOverviewRuler = function (cssClassName) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        return this._modelData.view.createOverviewRuler(cssClassName);\r\n    };\r\n    CodeEditorWidget.prototype.getDomNode = function () {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        return this._modelData.view.domNode.domNode;\r\n    };\r\n    CodeEditorWidget.prototype.delegateVerticalScrollbarMouseDown = function (browserEvent) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.delegateVerticalScrollbarMouseDown(browserEvent);\r\n    };\r\n    CodeEditorWidget.prototype.layout = function (dimension) {\r\n        this._configuration.observeReferenceElement(dimension);\r\n        this.render();\r\n    };\r\n    CodeEditorWidget.prototype.focus = function () {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.focus();\r\n    };\r\n    CodeEditorWidget.prototype.hasTextFocus = function () {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return false;\r\n        }\r\n        return this._modelData.view.isFocused();\r\n    };\r\n    CodeEditorWidget.prototype.hasWidgetFocus = function () {\r\n        return this._focusTracker && this._focusTracker.hasFocus();\r\n    };\r\n    CodeEditorWidget.prototype.addContentWidget = function (widget) {\r\n        var widgetData = {\r\n            widget: widget,\r\n            position: widget.getPosition()\r\n        };\r\n        if (this._contentWidgets.hasOwnProperty(widget.getId())) {\r\n            console.warn('Overwriting a content widget with the same id.');\r\n        }\r\n        this._contentWidgets[widget.getId()] = widgetData;\r\n        if (this._modelData && this._modelData.hasRealView) {\r\n            this._modelData.view.addContentWidget(widgetData);\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.layoutContentWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._contentWidgets.hasOwnProperty(widgetId)) {\r\n            var widgetData = this._contentWidgets[widgetId];\r\n            widgetData.position = widget.getPosition();\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.layoutContentWidget(widgetData);\r\n            }\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.removeContentWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._contentWidgets.hasOwnProperty(widgetId)) {\r\n            var widgetData = this._contentWidgets[widgetId];\r\n            delete this._contentWidgets[widgetId];\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.removeContentWidget(widgetData);\r\n            }\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.addOverlayWidget = function (widget) {\r\n        var widgetData = {\r\n            widget: widget,\r\n            position: widget.getPosition()\r\n        };\r\n        if (this._overlayWidgets.hasOwnProperty(widget.getId())) {\r\n            console.warn('Overwriting an overlay widget with the same id.');\r\n        }\r\n        this._overlayWidgets[widget.getId()] = widgetData;\r\n        if (this._modelData && this._modelData.hasRealView) {\r\n            this._modelData.view.addOverlayWidget(widgetData);\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.layoutOverlayWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._overlayWidgets.hasOwnProperty(widgetId)) {\r\n            var widgetData = this._overlayWidgets[widgetId];\r\n            widgetData.position = widget.getPosition();\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.layoutOverlayWidget(widgetData);\r\n            }\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.removeOverlayWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._overlayWidgets.hasOwnProperty(widgetId)) {\r\n            var widgetData = this._overlayWidgets[widgetId];\r\n            delete this._overlayWidgets[widgetId];\r\n            if (this._modelData && this._modelData.hasRealView) {\r\n                this._modelData.view.removeOverlayWidget(widgetData);\r\n            }\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.changeViewZones = function (callback) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        var hasChanges = this._modelData.view.change(callback);\r\n        if (hasChanges) {\r\n            this._onDidChangeViewZones.fire();\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype.getTargetAtClientPoint = function (clientX, clientY) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        return this._modelData.view.getTargetAtClientPoint(clientX, clientY);\r\n    };\r\n    CodeEditorWidget.prototype.getScrolledVisiblePosition = function (rawPosition) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return null;\r\n        }\r\n        var position = this._modelData.model.validatePosition(rawPosition);\r\n        var layoutInfo = this._configuration.editor.layoutInfo;\r\n        var top = CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, position.lineNumber, position.column) - this.getScrollTop();\r\n        var left = this._modelData.view.getOffsetForColumn(position.lineNumber, position.column) + layoutInfo.glyphMarginWidth + layoutInfo.lineNumbersWidth + layoutInfo.decorationsWidth - this.getScrollLeft();\r\n        return {\r\n            top: top,\r\n            left: left,\r\n            height: this._configuration.editor.lineHeight\r\n        };\r\n    };\r\n    CodeEditorWidget.prototype.getOffsetForColumn = function (lineNumber, column) {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return -1;\r\n        }\r\n        return this._modelData.view.getOffsetForColumn(lineNumber, column);\r\n    };\r\n    CodeEditorWidget.prototype.render = function () {\r\n        if (!this._modelData || !this._modelData.hasRealView) {\r\n            return;\r\n        }\r\n        this._modelData.view.render(true, false);\r\n    };\r\n    CodeEditorWidget.prototype.applyFontInfo = function (target) {\r\n        Configuration.applyFontInfoSlow(target, this._configuration.editor.fontInfo);\r\n    };\r\n    CodeEditorWidget.prototype._attachModel = function (model) {\r\n        var _this = this;\r\n        if (!model) {\r\n            this._modelData = null;\r\n            return;\r\n        }\r\n        var listenersToRemove = [];\r\n        this._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\r\n        this._configuration.setIsDominatedByLongLines(model.isDominatedByLongLines());\r\n        this._configuration.setMaxLineNumber(model.getLineCount());\r\n        model.onBeforeAttached();\r\n        var viewModel = new ViewModel(this._id, this._configuration, model, function (callback) { return dom.scheduleAtNextAnimationFrame(callback); });\r\n        listenersToRemove.push(model.onDidChangeDecorations(function (e) { return _this._onDidChangeModelDecorations.fire(e); }));\r\n        listenersToRemove.push(model.onDidChangeLanguage(function (e) {\r\n            _this._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\r\n            _this._onDidChangeModelLanguage.fire(e);\r\n        }));\r\n        listenersToRemove.push(model.onDidChangeLanguageConfiguration(function (e) { return _this._onDidChangeModelLanguageConfiguration.fire(e); }));\r\n        listenersToRemove.push(model.onDidChangeContent(function (e) { return _this._onDidChangeModelContent.fire(e); }));\r\n        listenersToRemove.push(model.onDidChangeOptions(function (e) { return _this._onDidChangeModelOptions.fire(e); }));\r\n        // Someone might destroy the model from under the editor, so prevent any exceptions by setting a null model\r\n        listenersToRemove.push(model.onWillDispose(function () { return _this.setModel(null); }));\r\n        var cursor = new Cursor(this._configuration, model, viewModel);\r\n        listenersToRemove.push(cursor.onDidReachMaxCursorCount(function () {\r\n            _this._notificationService.warn(nls.localize('cursors.maximum', \"The number of cursors has been limited to {0}.\", Cursor.MAX_CURSOR_COUNT));\r\n        }));\r\n        listenersToRemove.push(cursor.onDidAttemptReadOnlyEdit(function () {\r\n            _this._onDidAttemptReadOnlyEdit.fire(void 0);\r\n        }));\r\n        listenersToRemove.push(cursor.onDidChange(function (e) {\r\n            var positions = [];\r\n            for (var i = 0, len = e.selections.length; i < len; i++) {\r\n                positions[i] = e.selections[i].getPosition();\r\n            }\r\n            var e1 = {\r\n                position: positions[0],\r\n                secondaryPositions: positions.slice(1),\r\n                reason: e.reason,\r\n                source: e.source\r\n            };\r\n            _this._onDidChangeCursorPosition.fire(e1);\r\n            var e2 = {\r\n                selection: e.selections[0],\r\n                secondarySelections: e.selections.slice(1),\r\n                source: e.source,\r\n                reason: e.reason\r\n            };\r\n            _this._onDidChangeCursorSelection.fire(e2);\r\n        }));\r\n        var _a = this._createView(viewModel, cursor), view = _a[0], hasRealView = _a[1];\r\n        if (hasRealView) {\r\n            this._domElement.appendChild(view.domNode.domNode);\r\n            var keys = Object.keys(this._contentWidgets);\r\n            for (var i = 0, len = keys.length; i < len; i++) {\r\n                var widgetId = keys[i];\r\n                view.addContentWidget(this._contentWidgets[widgetId]);\r\n            }\r\n            keys = Object.keys(this._overlayWidgets);\r\n            for (var i = 0, len = keys.length; i < len; i++) {\r\n                var widgetId = keys[i];\r\n                view.addOverlayWidget(this._overlayWidgets[widgetId]);\r\n            }\r\n            view.render(false, true);\r\n            view.domNode.domNode.setAttribute('data-uri', model.uri.toString());\r\n        }\r\n        this._modelData = new ModelData(model, viewModel, cursor, view, hasRealView, listenersToRemove);\r\n    };\r\n    CodeEditorWidget.prototype._createView = function (viewModel, cursor) {\r\n        var _this = this;\r\n        var commandDelegate;\r\n        if (this.isSimpleWidget) {\r\n            commandDelegate = {\r\n                executeEditorCommand: function (editorCommand, args) {\r\n                    editorCommand.runCoreEditorCommand(cursor, args);\r\n                },\r\n                paste: function (source, text, pasteOnNewLine, multicursorText) {\r\n                    _this.trigger(source, editorCommon.Handler.Paste, { text: text, pasteOnNewLine: pasteOnNewLine, multicursorText: multicursorText });\r\n                },\r\n                type: function (source, text) {\r\n                    _this.trigger(source, editorCommon.Handler.Type, { text: text });\r\n                },\r\n                replacePreviousChar: function (source, text, replaceCharCnt) {\r\n                    _this.trigger(source, editorCommon.Handler.ReplacePreviousChar, { text: text, replaceCharCnt: replaceCharCnt });\r\n                },\r\n                compositionStart: function (source) {\r\n                    _this.trigger(source, editorCommon.Handler.CompositionStart, undefined);\r\n                },\r\n                compositionEnd: function (source) {\r\n                    _this.trigger(source, editorCommon.Handler.CompositionEnd, undefined);\r\n                },\r\n                cut: function (source) {\r\n                    _this.trigger(source, editorCommon.Handler.Cut, undefined);\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            commandDelegate = {\r\n                executeEditorCommand: function (editorCommand, args) {\r\n                    editorCommand.runCoreEditorCommand(cursor, args);\r\n                },\r\n                paste: function (source, text, pasteOnNewLine, multicursorText) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.Paste, {\r\n                        text: text,\r\n                        pasteOnNewLine: pasteOnNewLine,\r\n                        multicursorText: multicursorText\r\n                    });\r\n                },\r\n                type: function (source, text) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.Type, {\r\n                        text: text\r\n                    });\r\n                },\r\n                replacePreviousChar: function (source, text, replaceCharCnt) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.ReplacePreviousChar, {\r\n                        text: text,\r\n                        replaceCharCnt: replaceCharCnt\r\n                    });\r\n                },\r\n                compositionStart: function (source) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.CompositionStart, {});\r\n                },\r\n                compositionEnd: function (source) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.CompositionEnd, {});\r\n                },\r\n                cut: function (source) {\r\n                    _this._commandService.executeCommand(editorCommon.Handler.Cut, {});\r\n                }\r\n            };\r\n        }\r\n        var viewOutgoingEvents = new ViewOutgoingEvents(viewModel);\r\n        viewOutgoingEvents.onDidGainFocus = function () {\r\n            _this._editorTextFocus.setValue(true);\r\n            // In IE, the focus is not synchronous, so we give it a little help\r\n            _this._editorWidgetFocus.setValue(true);\r\n        };\r\n        viewOutgoingEvents.onDidScroll = function (e) { return _this._onDidScrollChange.fire(e); };\r\n        viewOutgoingEvents.onDidLoseFocus = function () { return _this._editorTextFocus.setValue(false); };\r\n        viewOutgoingEvents.onContextMenu = function (e) { return _this._onContextMenu.fire(e); };\r\n        viewOutgoingEvents.onMouseDown = function (e) { return _this._onMouseDown.fire(e); };\r\n        viewOutgoingEvents.onMouseUp = function (e) { return _this._onMouseUp.fire(e); };\r\n        viewOutgoingEvents.onMouseDrag = function (e) { return _this._onMouseDrag.fire(e); };\r\n        viewOutgoingEvents.onMouseDrop = function (e) { return _this._onMouseDrop.fire(e); };\r\n        viewOutgoingEvents.onKeyUp = function (e) { return _this._onKeyUp.fire(e); };\r\n        viewOutgoingEvents.onMouseMove = function (e) { return _this._onMouseMove.fire(e); };\r\n        viewOutgoingEvents.onMouseLeave = function (e) { return _this._onMouseLeave.fire(e); };\r\n        viewOutgoingEvents.onKeyDown = function (e) { return _this._onKeyDown.fire(e); };\r\n        var view = new View(commandDelegate, this._configuration, this._themeService, viewModel, cursor, viewOutgoingEvents);\r\n        return [view, true];\r\n    };\r\n    CodeEditorWidget.prototype._postDetachModelCleanup = function (detachedModel) {\r\n        if (detachedModel) {\r\n            detachedModel.removeAllDecorationsWithOwnerId(this._id);\r\n        }\r\n    };\r\n    CodeEditorWidget.prototype._detachModel = function () {\r\n        if (!this._modelData) {\r\n            return null;\r\n        }\r\n        var model = this._modelData.model;\r\n        var removeDomNode = this._modelData.hasRealView ? this._modelData.view.domNode.domNode : null;\r\n        this._modelData.dispose();\r\n        this._modelData = null;\r\n        this._domElement.removeAttribute('data-mode-id');\r\n        if (removeDomNode) {\r\n            this._domElement.removeChild(removeDomNode);\r\n        }\r\n        return model;\r\n    };\r\n    CodeEditorWidget.prototype._removeDecorationType = function (key) {\r\n        this._codeEditorService.removeDecorationType(key);\r\n    };\r\n    /* __GDPR__FRAGMENT__\r\n        \"EditorTelemetryData\" : {}\r\n    */\r\n    CodeEditorWidget.prototype.getTelemetryData = function () {\r\n        return this._telemetryData;\r\n    };\r\n    CodeEditorWidget.prototype.hasModel = function () {\r\n        return (this._modelData !== null);\r\n    };\r\n    CodeEditorWidget = __decorate([\r\n        __param(3, IInstantiationService),\r\n        __param(4, ICodeEditorService),\r\n        __param(5, ICommandService),\r\n        __param(6, IContextKeyService),\r\n        __param(7, IThemeService),\r\n        __param(8, INotificationService)\r\n    ], CodeEditorWidget);\r\n    return CodeEditorWidget;\r\n}(Disposable));\r\nexport { CodeEditorWidget };\r\nvar BooleanEventEmitter = /** @class */ (function (_super) {\r\n    __extends(BooleanEventEmitter, _super);\r\n    function BooleanEventEmitter() {\r\n        var _this = _super.call(this) || this;\r\n        _this._onDidChangeToTrue = _this._register(new Emitter());\r\n        _this.onDidChangeToTrue = _this._onDidChangeToTrue.event;\r\n        _this._onDidChangeToFalse = _this._register(new Emitter());\r\n        _this.onDidChangeToFalse = _this._onDidChangeToFalse.event;\r\n        _this._value = 0 /* NotSet */;\r\n        return _this;\r\n    }\r\n    BooleanEventEmitter.prototype.setValue = function (_value) {\r\n        var value = (_value ? 2 /* True */ : 1 /* False */);\r\n        if (this._value === value) {\r\n            return;\r\n        }\r\n        this._value = value;\r\n        if (this._value === 2 /* True */) {\r\n            this._onDidChangeToTrue.fire();\r\n        }\r\n        else if (this._value === 1 /* False */) {\r\n            this._onDidChangeToFalse.fire();\r\n        }\r\n    };\r\n    return BooleanEventEmitter;\r\n}(Disposable));\r\nexport { BooleanEventEmitter };\r\nvar EditorContextKeysManager = /** @class */ (function (_super) {\r\n    __extends(EditorContextKeysManager, _super);\r\n    function EditorContextKeysManager(editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        contextKeyService.createKey('editorId', editor.getId());\r\n        _this._editorFocus = EditorContextKeys.focus.bindTo(contextKeyService);\r\n        _this._textInputFocus = EditorContextKeys.textInputFocus.bindTo(contextKeyService);\r\n        _this._editorTextFocus = EditorContextKeys.editorTextFocus.bindTo(contextKeyService);\r\n        _this._editorTabMovesFocus = EditorContextKeys.tabMovesFocus.bindTo(contextKeyService);\r\n        _this._editorReadonly = EditorContextKeys.readOnly.bindTo(contextKeyService);\r\n        _this._hasMultipleSelections = EditorContextKeys.hasMultipleSelections.bindTo(contextKeyService);\r\n        _this._hasNonEmptySelection = EditorContextKeys.hasNonEmptySelection.bindTo(contextKeyService);\r\n        _this._canUndo = EditorContextKeys.canUndo.bindTo(contextKeyService);\r\n        _this._canRedo = EditorContextKeys.canRedo.bindTo(contextKeyService);\r\n        _this._register(_this._editor.onDidChangeConfiguration(function () { return _this._updateFromConfig(); }));\r\n        _this._register(_this._editor.onDidChangeCursorSelection(function () { return _this._updateFromSelection(); }));\r\n        _this._register(_this._editor.onDidFocusEditorWidget(function () { return _this._updateFromFocus(); }));\r\n        _this._register(_this._editor.onDidBlurEditorWidget(function () { return _this._updateFromFocus(); }));\r\n        _this._register(_this._editor.onDidFocusEditorText(function () { return _this._updateFromFocus(); }));\r\n        _this._register(_this._editor.onDidBlurEditorText(function () { return _this._updateFromFocus(); }));\r\n        _this._register(_this._editor.onDidChangeModel(function () { return _this._updateFromModel(); }));\r\n        _this._register(_this._editor.onDidChangeConfiguration(function () { return _this._updateFromModel(); }));\r\n        _this._updateFromConfig();\r\n        _this._updateFromSelection();\r\n        _this._updateFromFocus();\r\n        _this._updateFromModel();\r\n        return _this;\r\n    }\r\n    EditorContextKeysManager.prototype._updateFromConfig = function () {\r\n        var config = this._editor.getConfiguration();\r\n        this._editorTabMovesFocus.set(config.tabFocusMode);\r\n        this._editorReadonly.set(config.readOnly);\r\n    };\r\n    EditorContextKeysManager.prototype._updateFromSelection = function () {\r\n        var selections = this._editor.getSelections();\r\n        if (!selections) {\r\n            this._hasMultipleSelections.reset();\r\n            this._hasNonEmptySelection.reset();\r\n        }\r\n        else {\r\n            this._hasMultipleSelections.set(selections.length > 1);\r\n            this._hasNonEmptySelection.set(selections.some(function (s) { return !s.isEmpty(); }));\r\n        }\r\n    };\r\n    EditorContextKeysManager.prototype._updateFromFocus = function () {\r\n        this._editorFocus.set(this._editor.hasWidgetFocus() && !this._editor.isSimpleWidget);\r\n        this._editorTextFocus.set(this._editor.hasTextFocus() && !this._editor.isSimpleWidget);\r\n        this._textInputFocus.set(this._editor.hasTextFocus());\r\n    };\r\n    EditorContextKeysManager.prototype._updateFromModel = function () {\r\n        var model = this._editor.getModel();\r\n        this._canUndo.set(Boolean(model && model.canUndo()));\r\n        this._canRedo.set(Boolean(model && model.canRedo()));\r\n    };\r\n    return EditorContextKeysManager;\r\n}(Disposable));\r\nvar EditorModeContext = /** @class */ (function (_super) {\r\n    __extends(EditorModeContext, _super);\r\n    function EditorModeContext(editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._langId = EditorContextKeys.languageId.bindTo(contextKeyService);\r\n        _this._hasCompletionItemProvider = EditorContextKeys.hasCompletionItemProvider.bindTo(contextKeyService);\r\n        _this._hasCodeActionsProvider = EditorContextKeys.hasCodeActionsProvider.bindTo(contextKeyService);\r\n        _this._hasCodeLensProvider = EditorContextKeys.hasCodeLensProvider.bindTo(contextKeyService);\r\n        _this._hasDefinitionProvider = EditorContextKeys.hasDefinitionProvider.bindTo(contextKeyService);\r\n        _this._hasImplementationProvider = EditorContextKeys.hasImplementationProvider.bindTo(contextKeyService);\r\n        _this._hasTypeDefinitionProvider = EditorContextKeys.hasTypeDefinitionProvider.bindTo(contextKeyService);\r\n        _this._hasHoverProvider = EditorContextKeys.hasHoverProvider.bindTo(contextKeyService);\r\n        _this._hasDocumentHighlightProvider = EditorContextKeys.hasDocumentHighlightProvider.bindTo(contextKeyService);\r\n        _this._hasDocumentSymbolProvider = EditorContextKeys.hasDocumentSymbolProvider.bindTo(contextKeyService);\r\n        _this._hasReferenceProvider = EditorContextKeys.hasReferenceProvider.bindTo(contextKeyService);\r\n        _this._hasRenameProvider = EditorContextKeys.hasRenameProvider.bindTo(contextKeyService);\r\n        _this._hasDocumentFormattingProvider = EditorContextKeys.hasDocumentFormattingProvider.bindTo(contextKeyService);\r\n        _this._hasDocumentSelectionFormattingProvider = EditorContextKeys.hasDocumentSelectionFormattingProvider.bindTo(contextKeyService);\r\n        _this._hasSignatureHelpProvider = EditorContextKeys.hasSignatureHelpProvider.bindTo(contextKeyService);\r\n        _this._isInWalkThrough = EditorContextKeys.isInEmbeddedEditor.bindTo(contextKeyService);\r\n        var update = function () { return _this._update(); };\r\n        // update when model/mode changes\r\n        _this._register(editor.onDidChangeModel(update));\r\n        _this._register(editor.onDidChangeModelLanguage(update));\r\n        // update when registries change\r\n        _this._register(modes.CompletionProviderRegistry.onDidChange(update));\r\n        _this._register(modes.CodeActionProviderRegistry.onDidChange(update));\r\n        _this._register(modes.CodeLensProviderRegistry.onDidChange(update));\r\n        _this._register(modes.DefinitionProviderRegistry.onDidChange(update));\r\n        _this._register(modes.ImplementationProviderRegistry.onDidChange(update));\r\n        _this._register(modes.TypeDefinitionProviderRegistry.onDidChange(update));\r\n        _this._register(modes.HoverProviderRegistry.onDidChange(update));\r\n        _this._register(modes.DocumentHighlightProviderRegistry.onDidChange(update));\r\n        _this._register(modes.DocumentSymbolProviderRegistry.onDidChange(update));\r\n        _this._register(modes.ReferenceProviderRegistry.onDidChange(update));\r\n        _this._register(modes.RenameProviderRegistry.onDidChange(update));\r\n        _this._register(modes.DocumentFormattingEditProviderRegistry.onDidChange(update));\r\n        _this._register(modes.DocumentRangeFormattingEditProviderRegistry.onDidChange(update));\r\n        _this._register(modes.SignatureHelpProviderRegistry.onDidChange(update));\r\n        update();\r\n        return _this;\r\n    }\r\n    EditorModeContext.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    EditorModeContext.prototype.reset = function () {\r\n        this._langId.reset();\r\n        this._hasCompletionItemProvider.reset();\r\n        this._hasCodeActionsProvider.reset();\r\n        this._hasCodeLensProvider.reset();\r\n        this._hasDefinitionProvider.reset();\r\n        this._hasImplementationProvider.reset();\r\n        this._hasTypeDefinitionProvider.reset();\r\n        this._hasHoverProvider.reset();\r\n        this._hasDocumentHighlightProvider.reset();\r\n        this._hasDocumentSymbolProvider.reset();\r\n        this._hasReferenceProvider.reset();\r\n        this._hasRenameProvider.reset();\r\n        this._hasDocumentFormattingProvider.reset();\r\n        this._hasDocumentSelectionFormattingProvider.reset();\r\n        this._hasSignatureHelpProvider.reset();\r\n        this._isInWalkThrough.reset();\r\n    };\r\n    EditorModeContext.prototype._update = function () {\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        this._langId.set(model.getLanguageIdentifier().language);\r\n        this._hasCompletionItemProvider.set(modes.CompletionProviderRegistry.has(model));\r\n        this._hasCodeActionsProvider.set(modes.CodeActionProviderRegistry.has(model));\r\n        this._hasCodeLensProvider.set(modes.CodeLensProviderRegistry.has(model));\r\n        this._hasDefinitionProvider.set(modes.DefinitionProviderRegistry.has(model));\r\n        this._hasImplementationProvider.set(modes.ImplementationProviderRegistry.has(model));\r\n        this._hasTypeDefinitionProvider.set(modes.TypeDefinitionProviderRegistry.has(model));\r\n        this._hasHoverProvider.set(modes.HoverProviderRegistry.has(model));\r\n        this._hasDocumentHighlightProvider.set(modes.DocumentHighlightProviderRegistry.has(model));\r\n        this._hasDocumentSymbolProvider.set(modes.DocumentSymbolProviderRegistry.has(model));\r\n        this._hasReferenceProvider.set(modes.ReferenceProviderRegistry.has(model));\r\n        this._hasRenameProvider.set(modes.RenameProviderRegistry.has(model));\r\n        this._hasSignatureHelpProvider.set(modes.SignatureHelpProviderRegistry.has(model));\r\n        this._hasDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.has(model) || modes.DocumentRangeFormattingEditProviderRegistry.has(model));\r\n        this._hasDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.has(model));\r\n        this._isInWalkThrough.set(model.uri.scheme === Schemas.walkThroughSnippet);\r\n    };\r\n    return EditorModeContext;\r\n}(Disposable));\r\nexport { EditorModeContext };\r\nvar CodeEditorWidgetFocusTracker = /** @class */ (function (_super) {\r\n    __extends(CodeEditorWidgetFocusTracker, _super);\r\n    function CodeEditorWidgetFocusTracker(domElement) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onChange = _this._register(new Emitter());\r\n        _this.onChange = _this._onChange.event;\r\n        _this._hasFocus = false;\r\n        _this._domFocusTracker = _this._register(dom.trackFocus(domElement));\r\n        _this._register(_this._domFocusTracker.onDidFocus(function () {\r\n            _this._hasFocus = true;\r\n            _this._onChange.fire(void 0);\r\n        }));\r\n        _this._register(_this._domFocusTracker.onDidBlur(function () {\r\n            _this._hasFocus = false;\r\n            _this._onChange.fire(void 0);\r\n        }));\r\n        return _this;\r\n    }\r\n    CodeEditorWidgetFocusTracker.prototype.hasFocus = function () {\r\n        return this._hasFocus;\r\n    };\r\n    return CodeEditorWidgetFocusTracker;\r\n}(Disposable));\r\nvar squigglyStart = encodeURIComponent(\"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='\");\r\nvar squigglyEnd = encodeURIComponent(\"'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>\");\r\nfunction getSquigglySVGData(color) {\r\n    return squigglyStart + encodeURIComponent(color.toString()) + squigglyEnd;\r\n}\r\nvar dotdotdotStart = encodeURIComponent(\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" height=\\\"3\\\" width=\\\"12\\\"><g fill=\\\"\");\r\nvar dotdotdotEnd = encodeURIComponent(\"\\\"><circle cx=\\\"1\\\" cy=\\\"1\\\" r=\\\"1\\\"/><circle cx=\\\"5\\\" cy=\\\"1\\\" r=\\\"1\\\"/><circle cx=\\\"9\\\" cy=\\\"1\\\" r=\\\"1\\\"/></g></svg>\");\r\nfunction getDotDotDotSVGData(color) {\r\n    return dotdotdotStart + encodeURIComponent(color.toString()) + dotdotdotEnd;\r\n}\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var errorBorderColor = theme.getColor(editorErrorBorder);\r\n    if (errorBorderColor) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-error\" /* EditorErrorDecoration */ + \" { border-bottom: 4px double \" + errorBorderColor + \"; }\");\r\n    }\r\n    var errorForeground = theme.getColor(editorErrorForeground);\r\n    if (errorForeground) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-error\" /* EditorErrorDecoration */ + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(errorForeground) + \"\\\") repeat-x bottom left; }\");\r\n    }\r\n    var warningBorderColor = theme.getColor(editorWarningBorder);\r\n    if (warningBorderColor) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-warning\" /* EditorWarningDecoration */ + \" { border-bottom: 4px double \" + warningBorderColor + \"; }\");\r\n    }\r\n    var warningForeground = theme.getColor(editorWarningForeground);\r\n    if (warningForeground) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-warning\" /* EditorWarningDecoration */ + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(warningForeground) + \"\\\") repeat-x bottom left; }\");\r\n    }\r\n    var infoBorderColor = theme.getColor(editorInfoBorder);\r\n    if (infoBorderColor) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-info\" /* EditorInfoDecoration */ + \" { border-bottom: 4px double \" + infoBorderColor + \"; }\");\r\n    }\r\n    var infoForeground = theme.getColor(editorInfoForeground);\r\n    if (infoForeground) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-info\" /* EditorInfoDecoration */ + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(infoForeground) + \"\\\") repeat-x bottom left; }\");\r\n    }\r\n    var hintBorderColor = theme.getColor(editorHintBorder);\r\n    if (hintBorderColor) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-hint\" /* EditorHintDecoration */ + \" { border-bottom: 2px dotted \" + hintBorderColor + \"; }\");\r\n    }\r\n    var hintForeground = theme.getColor(editorHintForeground);\r\n    if (hintForeground) {\r\n        collector.addRule(\".monaco-editor .\" + \"squiggly-hint\" /* EditorHintDecoration */ + \" { background: url(\\\"data:image/svg+xml,\" + getDotDotDotSVGData(hintForeground) + \"\\\") no-repeat bottom left; }\");\r\n    }\r\n    var unnecessaryForeground = theme.getColor(editorUnnecessaryCodeOpacity);\r\n    if (unnecessaryForeground) {\r\n        collector.addRule(\".\" + SHOW_UNUSED_ENABLED_CLASS + \" .monaco-editor .\" + \"squiggly-inline-unnecessary\" /* EditorUnnecessaryInlineDecoration */ + \" { opacity: \" + unnecessaryForeground.rgba.a + \"; will-change: opacity; }\"); // TODO@Ben: 'will-change: opacity' is a workaround for https://github.com/Microsoft/vscode/issues/52196\r\n    }\r\n    var unnecessaryBorder = theme.getColor(editorUnnecessaryCodeBorder);\r\n    if (unnecessaryBorder) {\r\n        collector.addRule(\".\" + SHOW_UNUSED_ENABLED_CLASS + \" .monaco-editor .\" + \"squiggly-unnecessary\" /* EditorUnnecessaryDecoration */ + \" { border-bottom: 2px dashed \" + unnecessaryBorder + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './sash.css';\r\nimport { dispose, Disposable } from '../../../common/lifecycle.js';\r\nimport { isIPad } from '../../browser.js';\r\nimport { isMacintosh } from '../../../common/platform.js';\r\nimport * as types from '../../../common/types.js';\r\nimport { EventType, Gesture } from '../../touch.js';\r\nimport { StandardMouseEvent } from '../../mouseEvent.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { getElementsByTagName, EventHelper, createStyleSheet, addDisposableListener, append, $, addClass, removeClass, toggleClass } from '../../dom.js';\r\nimport { domEvent } from '../../event.js';\r\nvar DEBUG = false;\r\nvar Sash = /** @class */ (function (_super) {\r\n    __extends(Sash, _super);\r\n    function Sash(container, layoutProvider, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this) || this;\r\n        _this._state = 3 /* Enabled */;\r\n        _this._onDidEnablementChange = _this._register(new Emitter());\r\n        _this.onDidEnablementChange = _this._onDidEnablementChange.event;\r\n        _this._onDidStart = _this._register(new Emitter());\r\n        _this.onDidStart = _this._onDidStart.event;\r\n        _this._onDidChange = _this._register(new Emitter());\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        _this._onDidReset = _this._register(new Emitter());\r\n        _this.onDidReset = _this._onDidReset.event;\r\n        _this._onDidEnd = _this._register(new Emitter());\r\n        _this.onDidEnd = _this._onDidEnd.event;\r\n        _this.linkedSash = undefined;\r\n        _this.orthogonalStartSashDisposables = [];\r\n        _this.orthogonalEndSashDisposables = [];\r\n        _this.el = append(container, $('.monaco-sash'));\r\n        if (isMacintosh) {\r\n            addClass(_this.el, 'mac');\r\n        }\r\n        _this._register(domEvent(_this.el, 'mousedown')(_this.onMouseDown, _this));\r\n        _this._register(domEvent(_this.el, 'dblclick')(_this.onMouseDoubleClick, _this));\r\n        Gesture.addTarget(_this.el);\r\n        _this._register(domEvent(_this.el, EventType.Start)(_this.onTouchStart, _this));\r\n        if (isIPad) {\r\n            // see also http://ux.stackexchange.com/questions/39023/what-is-the-optimum-button-size-of-touch-screen-applications\r\n            addClass(_this.el, 'touch');\r\n        }\r\n        _this.setOrientation(options.orientation || 0 /* VERTICAL */);\r\n        _this.hidden = false;\r\n        _this.layoutProvider = layoutProvider;\r\n        _this.orthogonalStartSash = options.orthogonalStartSash;\r\n        _this.orthogonalEndSash = options.orthogonalEndSash;\r\n        toggleClass(_this.el, 'debug', DEBUG);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Sash.prototype, \"state\", {\r\n        get: function () { return this._state; },\r\n        set: function (state) {\r\n            if (this._state === state) {\r\n                return;\r\n            }\r\n            toggleClass(this.el, 'disabled', state === 0 /* Disabled */);\r\n            toggleClass(this.el, 'minimum', state === 1 /* Minimum */);\r\n            toggleClass(this.el, 'maximum', state === 2 /* Maximum */);\r\n            this._state = state;\r\n            this._onDidEnablementChange.fire(state);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sash.prototype, \"orthogonalStartSash\", {\r\n        get: function () { return this._orthogonalStartSash; },\r\n        set: function (sash) {\r\n            this.orthogonalStartSashDisposables = dispose(this.orthogonalStartSashDisposables);\r\n            if (sash) {\r\n                sash.onDidEnablementChange(this.onOrthogonalStartSashEnablementChange, this, this.orthogonalStartSashDisposables);\r\n                this.onOrthogonalStartSashEnablementChange(sash.state);\r\n            }\r\n            else {\r\n                this.onOrthogonalStartSashEnablementChange(0 /* Disabled */);\r\n            }\r\n            this._orthogonalStartSash = sash;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sash.prototype, \"orthogonalEndSash\", {\r\n        get: function () { return this._orthogonalEndSash; },\r\n        set: function (sash) {\r\n            this.orthogonalEndSashDisposables = dispose(this.orthogonalEndSashDisposables);\r\n            if (sash) {\r\n                sash.onDidEnablementChange(this.onOrthogonalEndSashEnablementChange, this, this.orthogonalEndSashDisposables);\r\n                this.onOrthogonalEndSashEnablementChange(sash.state);\r\n            }\r\n            else {\r\n                this.onOrthogonalEndSashEnablementChange(0 /* Disabled */);\r\n            }\r\n            this._orthogonalEndSash = sash;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Sash.prototype.setOrientation = function (orientation) {\r\n        this.orientation = orientation;\r\n        if (this.orientation === 1 /* HORIZONTAL */) {\r\n            addClass(this.el, 'horizontal');\r\n            removeClass(this.el, 'vertical');\r\n        }\r\n        else {\r\n            removeClass(this.el, 'horizontal');\r\n            addClass(this.el, 'vertical');\r\n        }\r\n        if (this.layoutProvider) {\r\n            this.layout();\r\n        }\r\n    };\r\n    Sash.prototype.onMouseDown = function (e) {\r\n        var _this = this;\r\n        EventHelper.stop(e, false);\r\n        var isMultisashResize = false;\r\n        if (this.linkedSash && !e.__linkedSashEvent) {\r\n            e.__linkedSashEvent = true;\r\n            this.linkedSash.onMouseDown(e);\r\n        }\r\n        if (!e.__orthogonalSashEvent) {\r\n            var orthogonalSash = void 0;\r\n            if (this.orientation === 0 /* VERTICAL */) {\r\n                if (e.offsetY <= 4) {\r\n                    orthogonalSash = this.orthogonalStartSash;\r\n                }\r\n                else if (e.offsetY >= this.el.clientHeight - 4) {\r\n                    orthogonalSash = this.orthogonalEndSash;\r\n                }\r\n            }\r\n            else {\r\n                if (e.offsetX <= 4) {\r\n                    orthogonalSash = this.orthogonalStartSash;\r\n                }\r\n                else if (e.offsetX >= this.el.clientWidth - 4) {\r\n                    orthogonalSash = this.orthogonalEndSash;\r\n                }\r\n            }\r\n            if (orthogonalSash) {\r\n                isMultisashResize = true;\r\n                e.__orthogonalSashEvent = true;\r\n                orthogonalSash.onMouseDown(e);\r\n            }\r\n        }\r\n        if (!this.state) {\r\n            return;\r\n        }\r\n        var iframes = getElementsByTagName('iframe');\r\n        for (var _i = 0, iframes_1 = iframes; _i < iframes_1.length; _i++) {\r\n            var iframe = iframes_1[_i];\r\n            iframe.style.pointerEvents = 'none'; // disable mouse events on iframes as long as we drag the sash\r\n        }\r\n        var mouseDownEvent = new StandardMouseEvent(e);\r\n        var startX = mouseDownEvent.posx;\r\n        var startY = mouseDownEvent.posy;\r\n        var altKey = mouseDownEvent.altKey;\r\n        var startEvent = { startX: startX, currentX: startX, startY: startY, currentY: startY, altKey: altKey };\r\n        addClass(this.el, 'active');\r\n        this._onDidStart.fire(startEvent);\r\n        // fix https://github.com/Microsoft/vscode/issues/21675\r\n        var style = createStyleSheet(this.el);\r\n        var updateStyle = function () {\r\n            var cursor = '';\r\n            if (isMultisashResize) {\r\n                cursor = 'all-scroll';\r\n            }\r\n            else if (_this.orientation === 1 /* HORIZONTAL */) {\r\n                if (_this.state === 1 /* Minimum */) {\r\n                    cursor = 's-resize';\r\n                }\r\n                else if (_this.state === 2 /* Maximum */) {\r\n                    cursor = 'n-resize';\r\n                }\r\n                else {\r\n                    cursor = isMacintosh ? 'row-resize' : 'ns-resize';\r\n                }\r\n            }\r\n            else {\r\n                if (_this.state === 1 /* Minimum */) {\r\n                    cursor = 'e-resize';\r\n                }\r\n                else if (_this.state === 2 /* Maximum */) {\r\n                    cursor = 'w-resize';\r\n                }\r\n                else {\r\n                    cursor = isMacintosh ? 'col-resize' : 'ew-resize';\r\n                }\r\n            }\r\n            style.innerHTML = \"* { cursor: \" + cursor + \" !important; }\";\r\n        };\r\n        var disposables = [];\r\n        updateStyle();\r\n        if (!isMultisashResize) {\r\n            this.onDidEnablementChange(updateStyle, null, disposables);\r\n        }\r\n        var onMouseMove = function (e) {\r\n            EventHelper.stop(e, false);\r\n            var mouseMoveEvent = new StandardMouseEvent(e);\r\n            var event = { startX: startX, currentX: mouseMoveEvent.posx, startY: startY, currentY: mouseMoveEvent.posy, altKey: altKey };\r\n            _this._onDidChange.fire(event);\r\n        };\r\n        var onMouseUp = function (e) {\r\n            EventHelper.stop(e, false);\r\n            _this.el.removeChild(style);\r\n            removeClass(_this.el, 'active');\r\n            _this._onDidEnd.fire();\r\n            dispose(disposables);\r\n            var iframes = getElementsByTagName('iframe');\r\n            for (var _i = 0, iframes_2 = iframes; _i < iframes_2.length; _i++) {\r\n                var iframe = iframes_2[_i];\r\n                iframe.style.pointerEvents = 'auto';\r\n            }\r\n        };\r\n        domEvent(window, 'mousemove')(onMouseMove, null, disposables);\r\n        domEvent(window, 'mouseup')(onMouseUp, null, disposables);\r\n    };\r\n    Sash.prototype.onMouseDoubleClick = function (event) {\r\n        this._onDidReset.fire();\r\n    };\r\n    Sash.prototype.onTouchStart = function (event) {\r\n        var _this = this;\r\n        EventHelper.stop(event);\r\n        var listeners = [];\r\n        var startX = event.pageX;\r\n        var startY = event.pageY;\r\n        var altKey = event.altKey;\r\n        this._onDidStart.fire({\r\n            startX: startX,\r\n            currentX: startX,\r\n            startY: startY,\r\n            currentY: startY,\r\n            altKey: altKey\r\n        });\r\n        listeners.push(addDisposableListener(this.el, EventType.Change, function (event) {\r\n            if (types.isNumber(event.pageX) && types.isNumber(event.pageY)) {\r\n                _this._onDidChange.fire({\r\n                    startX: startX,\r\n                    currentX: event.pageX,\r\n                    startY: startY,\r\n                    currentY: event.pageY,\r\n                    altKey: altKey\r\n                });\r\n            }\r\n        }));\r\n        listeners.push(addDisposableListener(this.el, EventType.End, function (event) {\r\n            _this._onDidEnd.fire();\r\n            dispose(listeners);\r\n        }));\r\n    };\r\n    Sash.prototype.layout = function () {\r\n        var size = isIPad ? 20 : 4;\r\n        if (this.orientation === 0 /* VERTICAL */) {\r\n            var verticalProvider = this.layoutProvider;\r\n            this.el.style.left = verticalProvider.getVerticalSashLeft(this) - (size / 2) + 'px';\r\n            if (verticalProvider.getVerticalSashTop) {\r\n                this.el.style.top = verticalProvider.getVerticalSashTop(this) + 'px';\r\n            }\r\n            if (verticalProvider.getVerticalSashHeight) {\r\n                this.el.style.height = verticalProvider.getVerticalSashHeight(this) + 'px';\r\n            }\r\n        }\r\n        else {\r\n            var horizontalProvider = this.layoutProvider;\r\n            this.el.style.top = horizontalProvider.getHorizontalSashTop(this) - (size / 2) + 'px';\r\n            if (horizontalProvider.getHorizontalSashLeft) {\r\n                this.el.style.left = horizontalProvider.getHorizontalSashLeft(this) + 'px';\r\n            }\r\n            if (horizontalProvider.getHorizontalSashWidth) {\r\n                this.el.style.width = horizontalProvider.getHorizontalSashWidth(this) + 'px';\r\n            }\r\n        }\r\n    };\r\n    Sash.prototype.hide = function () {\r\n        this.hidden = true;\r\n        this.el.style.display = 'none';\r\n        this.el.setAttribute('aria-hidden', 'true');\r\n    };\r\n    Sash.prototype.onOrthogonalStartSashEnablementChange = function (state) {\r\n        toggleClass(this.el, 'orthogonal-start', state !== 0 /* Disabled */);\r\n    };\r\n    Sash.prototype.onOrthogonalEndSashEnablementChange = function (state) {\r\n        toggleClass(this.el, 'orthogonal-end', state !== 0 /* Disabled */);\r\n    };\r\n    Sash.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this.orthogonalStartSashDisposables = dispose(this.orthogonalStartSashDisposables);\r\n        this.orthogonalEndSashDisposables = dispose(this.orthogonalEndSashDisposables);\r\n        if (this.el && this.el.parentElement) {\r\n            this.el.parentElement.removeChild(this.el);\r\n        }\r\n        this.el = null; // StrictNullOverride: nulling out ok in dispose\r\n    };\r\n    return Sash;\r\n}(Disposable));\r\nexport { Sash };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nvar EditorState = /** @class */ (function () {\r\n    function EditorState(editor, flags) {\r\n        this.flags = flags;\r\n        if ((this.flags & 1 /* Value */) !== 0) {\r\n            var model = editor.getModel();\r\n            this.modelVersionId = model ? strings.format('{0}#{1}', model.uri.toString(), model.getVersionId()) : null;\r\n        }\r\n        if ((this.flags & 4 /* Position */) !== 0) {\r\n            this.position = editor.getPosition();\r\n        }\r\n        if ((this.flags & 2 /* Selection */) !== 0) {\r\n            this.selection = editor.getSelection();\r\n        }\r\n        if ((this.flags & 8 /* Scroll */) !== 0) {\r\n            this.scrollLeft = editor.getScrollLeft();\r\n            this.scrollTop = editor.getScrollTop();\r\n        }\r\n    }\r\n    EditorState.prototype._equals = function (other) {\r\n        if (!(other instanceof EditorState)) {\r\n            return false;\r\n        }\r\n        var state = other;\r\n        if (this.modelVersionId !== state.modelVersionId) {\r\n            return false;\r\n        }\r\n        if (this.scrollLeft !== state.scrollLeft || this.scrollTop !== state.scrollTop) {\r\n            return false;\r\n        }\r\n        if (!this.position && state.position || this.position && !state.position || this.position && state.position && !this.position.equals(state.position)) {\r\n            return false;\r\n        }\r\n        if (!this.selection && state.selection || this.selection && !state.selection || this.selection && state.selection && !this.selection.equalsRange(state.selection)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    EditorState.prototype.validate = function (editor) {\r\n        return this._equals(new EditorState(editor, this.flags));\r\n    };\r\n    return EditorState;\r\n}());\r\nexport { EditorState };\r\nvar StableEditorScrollState = /** @class */ (function () {\r\n    function StableEditorScrollState(_visiblePosition, _visiblePositionScrollDelta) {\r\n        this._visiblePosition = _visiblePosition;\r\n        this._visiblePositionScrollDelta = _visiblePositionScrollDelta;\r\n    }\r\n    StableEditorScrollState.capture = function (editor) {\r\n        var visiblePosition = null;\r\n        var visiblePositionScrollDelta = 0;\r\n        if (editor.getScrollTop() !== 0) {\r\n            var visibleRanges = editor.getVisibleRanges();\r\n            if (visibleRanges.length > 0) {\r\n                visiblePosition = visibleRanges[0].getStartPosition();\r\n                var visiblePositionScrollTop = editor.getTopForPosition(visiblePosition.lineNumber, visiblePosition.column);\r\n                visiblePositionScrollDelta = editor.getScrollTop() - visiblePositionScrollTop;\r\n            }\r\n        }\r\n        return new StableEditorScrollState(visiblePosition, visiblePositionScrollDelta);\r\n    };\r\n    StableEditorScrollState.prototype.restore = function (editor) {\r\n        if (this._visiblePosition) {\r\n            var visiblePositionScrollTop = editor.getTopForPosition(this._visiblePosition.lineNumber, this._visiblePosition.column);\r\n            editor.setScrollTop(visiblePositionScrollTop + this._visiblePositionScrollDelta);\r\n        }\r\n    };\r\n    return StableEditorScrollState;\r\n}());\r\nexport { StableEditorScrollState };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './actionbar.css';\r\nimport * as platform from '../../../common/platform.js';\r\nimport * as nls from '../../../../nls.js';\r\nimport { Disposable, dispose } from '../../../common/lifecycle.js';\r\nimport { Action, ActionRunner } from '../../../common/actions.js';\r\nimport * as DOM from '../../dom.js';\r\nimport * as types from '../../../common/types.js';\r\nimport { EventType, Gesture } from '../../touch.js';\r\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nvar BaseActionItem = /** @class */ (function (_super) {\r\n    __extends(BaseActionItem, _super);\r\n    function BaseActionItem(context, action, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this.options = options;\r\n        _this._context = context || _this;\r\n        _this._action = action;\r\n        if (action instanceof Action) {\r\n            _this._register(action.onDidChange(function (event) {\r\n                if (!_this.element) {\r\n                    // we have not been rendered yet, so there\r\n                    // is no point in updating the UI\r\n                    return;\r\n                }\r\n                _this.handleActionChangeEvent(event);\r\n            }));\r\n        }\r\n        return _this;\r\n    }\r\n    BaseActionItem.prototype.handleActionChangeEvent = function (event) {\r\n        if (event.enabled !== void 0) {\r\n            this.updateEnabled();\r\n        }\r\n        if (event.checked !== void 0) {\r\n            this.updateChecked();\r\n        }\r\n        if (event.class !== void 0) {\r\n            this.updateClass();\r\n        }\r\n        if (event.label !== void 0) {\r\n            this.updateLabel();\r\n            this.updateTooltip();\r\n        }\r\n        if (event.tooltip !== void 0) {\r\n            this.updateTooltip();\r\n        }\r\n    };\r\n    Object.defineProperty(BaseActionItem.prototype, \"actionRunner\", {\r\n        get: function () {\r\n            return this._actionRunner;\r\n        },\r\n        set: function (actionRunner) {\r\n            this._actionRunner = actionRunner;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    BaseActionItem.prototype.getAction = function () {\r\n        return this._action;\r\n    };\r\n    BaseActionItem.prototype.isEnabled = function () {\r\n        return this._action.enabled;\r\n    };\r\n    BaseActionItem.prototype.setActionContext = function (newContext) {\r\n        this._context = newContext;\r\n    };\r\n    BaseActionItem.prototype.render = function (container) {\r\n        var _this = this;\r\n        this.element = container;\r\n        Gesture.addTarget(container);\r\n        var enableDragging = this.options && this.options.draggable;\r\n        if (enableDragging) {\r\n            container.draggable = true;\r\n        }\r\n        this._register(DOM.addDisposableListener(this.element, EventType.Tap, function (e) { return _this.onClick(e); }));\r\n        this._register(DOM.addDisposableListener(this.element, DOM.EventType.MOUSE_DOWN, function (e) {\r\n            if (!enableDragging) {\r\n                DOM.EventHelper.stop(e, true); // do not run when dragging is on because that would disable it\r\n            }\r\n            var mouseEvent = e;\r\n            if (_this._action.enabled && mouseEvent.button === 0) {\r\n                DOM.addClass(_this.element, 'active');\r\n            }\r\n        }));\r\n        this._register(DOM.addDisposableListener(this.element, DOM.EventType.CLICK, function (e) {\r\n            DOM.EventHelper.stop(e, true);\r\n            // See https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Interact_with_the_clipboard\r\n            // > Writing to the clipboard\r\n            // > You can use the \"cut\" and \"copy\" commands without any special\r\n            // permission if you are using them in a short-lived event handler\r\n            // for a user action (for example, a click handler).\r\n            // => to get the Copy and Paste context menu actions working on Firefox,\r\n            // there should be no timeout here\r\n            if (_this.options && _this.options.isMenu) {\r\n                _this.onClick(e);\r\n            }\r\n            else {\r\n                platform.setImmediate(function () { return _this.onClick(e); });\r\n            }\r\n        }));\r\n        this._register(DOM.addDisposableListener(this.element, DOM.EventType.DBLCLICK, function (e) {\r\n            DOM.EventHelper.stop(e, true);\r\n        }));\r\n        [DOM.EventType.MOUSE_UP, DOM.EventType.MOUSE_OUT].forEach(function (event) {\r\n            _this._register(DOM.addDisposableListener(_this.element, event, function (e) {\r\n                DOM.EventHelper.stop(e);\r\n                DOM.removeClass(_this.element, 'active');\r\n            }));\r\n        });\r\n    };\r\n    BaseActionItem.prototype.onClick = function (event) {\r\n        DOM.EventHelper.stop(event, true);\r\n        var context;\r\n        if (types.isUndefinedOrNull(this._context)) {\r\n            context = event;\r\n        }\r\n        else {\r\n            context = this._context;\r\n            if (types.isObject(context)) {\r\n                context.event = event;\r\n            }\r\n        }\r\n        this._actionRunner.run(this._action, context);\r\n    };\r\n    BaseActionItem.prototype.focus = function () {\r\n        if (this.element) {\r\n            this.element.focus();\r\n            DOM.addClass(this.element, 'focused');\r\n        }\r\n    };\r\n    BaseActionItem.prototype.blur = function () {\r\n        if (this.element) {\r\n            this.element.blur();\r\n            DOM.removeClass(this.element, 'focused');\r\n        }\r\n    };\r\n    BaseActionItem.prototype.updateEnabled = function () {\r\n        // implement in subclass\r\n    };\r\n    BaseActionItem.prototype.updateLabel = function () {\r\n        // implement in subclass\r\n    };\r\n    BaseActionItem.prototype.updateTooltip = function () {\r\n        // implement in subclass\r\n    };\r\n    BaseActionItem.prototype.updateClass = function () {\r\n        // implement in subclass\r\n    };\r\n    BaseActionItem.prototype.updateChecked = function () {\r\n        // implement in subclass\r\n    };\r\n    BaseActionItem.prototype.dispose = function () {\r\n        if (this.element) {\r\n            DOM.removeNode(this.element);\r\n            this.element = null;\r\n        }\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    return BaseActionItem;\r\n}(Disposable));\r\nexport { BaseActionItem };\r\nvar Separator = /** @class */ (function (_super) {\r\n    __extends(Separator, _super);\r\n    function Separator(label) {\r\n        var _this = _super.call(this, Separator.ID, label, label ? 'separator text' : 'separator') || this;\r\n        _this.checked = false;\r\n        _this.radio = false;\r\n        _this.enabled = false;\r\n        return _this;\r\n    }\r\n    Separator.ID = 'vs.actions.separator';\r\n    return Separator;\r\n}(Action));\r\nexport { Separator };\r\nvar ActionItem = /** @class */ (function (_super) {\r\n    __extends(ActionItem, _super);\r\n    function ActionItem(context, action, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this, context, action, options) || this;\r\n        _this.options = options;\r\n        _this.options.icon = options.icon !== undefined ? options.icon : false;\r\n        _this.options.label = options.label !== undefined ? options.label : true;\r\n        _this.cssClass = '';\r\n        return _this;\r\n    }\r\n    ActionItem.prototype.render = function (container) {\r\n        _super.prototype.render.call(this, container);\r\n        this.label = DOM.append(this.element, DOM.$('a.action-label'));\r\n        if (this._action.id === Separator.ID) {\r\n            this.label.setAttribute('role', 'presentation'); // A separator is a presentation item\r\n        }\r\n        else {\r\n            if (this.options.isMenu) {\r\n                this.label.setAttribute('role', 'menuitem');\r\n            }\r\n            else {\r\n                this.label.setAttribute('role', 'button');\r\n            }\r\n        }\r\n        if (this.options.label && this.options.keybinding) {\r\n            DOM.append(this.element, DOM.$('span.keybinding')).textContent = this.options.keybinding;\r\n        }\r\n        this.updateClass();\r\n        this.updateLabel();\r\n        this.updateTooltip();\r\n        this.updateEnabled();\r\n        this.updateChecked();\r\n    };\r\n    ActionItem.prototype.focus = function () {\r\n        _super.prototype.focus.call(this);\r\n        this.label.focus();\r\n    };\r\n    ActionItem.prototype.updateLabel = function () {\r\n        if (this.options.label) {\r\n            this.label.textContent = this.getAction().label;\r\n        }\r\n    };\r\n    ActionItem.prototype.updateTooltip = function () {\r\n        var title = null;\r\n        if (this.getAction().tooltip) {\r\n            title = this.getAction().tooltip;\r\n        }\r\n        else if (!this.options.label && this.getAction().label && this.options.icon) {\r\n            title = this.getAction().label;\r\n            if (this.options.keybinding) {\r\n                title = nls.localize({ key: 'titleLabel', comment: ['action title', 'action keybinding'] }, \"{0} ({1})\", title, this.options.keybinding);\r\n            }\r\n        }\r\n        if (title) {\r\n            this.label.title = title;\r\n        }\r\n    };\r\n    ActionItem.prototype.updateClass = function () {\r\n        if (this.cssClass) {\r\n            DOM.removeClasses(this.label, this.cssClass);\r\n        }\r\n        if (this.options.icon) {\r\n            this.cssClass = this.getAction().class;\r\n            DOM.addClass(this.label, 'icon');\r\n            if (this.cssClass) {\r\n                DOM.addClasses(this.label, this.cssClass);\r\n            }\r\n            this.updateEnabled();\r\n        }\r\n        else {\r\n            DOM.removeClass(this.label, 'icon');\r\n        }\r\n    };\r\n    ActionItem.prototype.updateEnabled = function () {\r\n        if (this.getAction().enabled) {\r\n            this.label.removeAttribute('aria-disabled');\r\n            DOM.removeClass(this.element, 'disabled');\r\n            DOM.removeClass(this.label, 'disabled');\r\n            this.label.tabIndex = 0;\r\n        }\r\n        else {\r\n            this.label.setAttribute('aria-disabled', 'true');\r\n            DOM.addClass(this.element, 'disabled');\r\n            DOM.addClass(this.label, 'disabled');\r\n            DOM.removeTabIndexAndUpdateFocus(this.label);\r\n        }\r\n    };\r\n    ActionItem.prototype.updateChecked = function () {\r\n        if (this.getAction().checked) {\r\n            DOM.addClass(this.label, 'checked');\r\n        }\r\n        else {\r\n            DOM.removeClass(this.label, 'checked');\r\n        }\r\n    };\r\n    return ActionItem;\r\n}(BaseActionItem));\r\nexport { ActionItem };\r\nvar defaultOptions = {\r\n    orientation: 0 /* HORIZONTAL */,\r\n    context: null,\r\n    triggerKeys: {\r\n        keys: [3 /* Enter */, 10 /* Space */],\r\n        keyDown: false\r\n    }\r\n};\r\nvar ActionBar = /** @class */ (function (_super) {\r\n    __extends(ActionBar, _super);\r\n    function ActionBar(container, options) {\r\n        if (options === void 0) { options = defaultOptions; }\r\n        var _this = _super.call(this) || this;\r\n        _this._onDidBlur = _this._register(new Emitter());\r\n        _this._onDidCancel = _this._register(new Emitter());\r\n        _this._onDidRun = _this._register(new Emitter());\r\n        _this._onDidBeforeRun = _this._register(new Emitter());\r\n        _this.options = options;\r\n        _this._context = options.context;\r\n        _this._actionRunner = _this.options.actionRunner;\r\n        if (!_this.options.triggerKeys) {\r\n            _this.options.triggerKeys = defaultOptions.triggerKeys;\r\n        }\r\n        if (!_this._actionRunner) {\r\n            _this._actionRunner = new ActionRunner();\r\n            _this._register(_this._actionRunner);\r\n        }\r\n        _this._register(_this._actionRunner.onDidRun(function (e) { return _this._onDidRun.fire(e); }));\r\n        _this._register(_this._actionRunner.onDidBeforeRun(function (e) { return _this._onDidBeforeRun.fire(e); }));\r\n        _this.items = [];\r\n        _this.focusedItem = undefined;\r\n        _this.domNode = document.createElement('div');\r\n        _this.domNode.className = 'monaco-action-bar';\r\n        if (options.animated !== false) {\r\n            DOM.addClass(_this.domNode, 'animated');\r\n        }\r\n        var previousKey;\r\n        var nextKey;\r\n        switch (_this.options.orientation) {\r\n            case 0 /* HORIZONTAL */:\r\n                previousKey = 15 /* LeftArrow */;\r\n                nextKey = 17 /* RightArrow */;\r\n                break;\r\n            case 1 /* HORIZONTAL_REVERSE */:\r\n                previousKey = 17 /* RightArrow */;\r\n                nextKey = 15 /* LeftArrow */;\r\n                _this.domNode.className += ' reverse';\r\n                break;\r\n            case 2 /* VERTICAL */:\r\n                previousKey = 16 /* UpArrow */;\r\n                nextKey = 18 /* DownArrow */;\r\n                _this.domNode.className += ' vertical';\r\n                break;\r\n            case 3 /* VERTICAL_REVERSE */:\r\n                previousKey = 18 /* DownArrow */;\r\n                nextKey = 16 /* UpArrow */;\r\n                _this.domNode.className += ' vertical reverse';\r\n                break;\r\n        }\r\n        _this._register(DOM.addDisposableListener(_this.domNode, DOM.EventType.KEY_DOWN, function (e) {\r\n            var event = new StandardKeyboardEvent(e);\r\n            var eventHandled = true;\r\n            if (event.equals(previousKey)) {\r\n                _this.focusPrevious();\r\n            }\r\n            else if (event.equals(nextKey)) {\r\n                _this.focusNext();\r\n            }\r\n            else if (event.equals(9 /* Escape */)) {\r\n                _this.cancel();\r\n            }\r\n            else if (_this.isTriggerKeyEvent(event)) {\r\n                // Staying out of the else branch even if not triggered\r\n                if (_this.options.triggerKeys && _this.options.triggerKeys.keyDown) {\r\n                    _this.doTrigger(event);\r\n                }\r\n            }\r\n            else {\r\n                eventHandled = false;\r\n            }\r\n            if (eventHandled) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n            }\r\n        }));\r\n        _this._register(DOM.addDisposableListener(_this.domNode, DOM.EventType.KEY_UP, function (e) {\r\n            var event = new StandardKeyboardEvent(e);\r\n            // Run action on Enter/Space\r\n            if (_this.isTriggerKeyEvent(event)) {\r\n                if (!_this.options.triggerKeys.keyDown) {\r\n                    _this.doTrigger(event);\r\n                }\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n            }\r\n            // Recompute focused item\r\n            else if (event.equals(2 /* Tab */) || event.equals(1024 /* Shift */ | 2 /* Tab */)) {\r\n                _this.updateFocusedItem();\r\n            }\r\n        }));\r\n        _this.focusTracker = _this._register(DOM.trackFocus(_this.domNode));\r\n        _this._register(_this.focusTracker.onDidBlur(function () {\r\n            if (document.activeElement === _this.domNode || !DOM.isAncestor(document.activeElement, _this.domNode)) {\r\n                _this._onDidBlur.fire();\r\n                _this.focusedItem = undefined;\r\n            }\r\n        }));\r\n        _this._register(_this.focusTracker.onDidFocus(function () { return _this.updateFocusedItem(); }));\r\n        _this.actionsList = document.createElement('ul');\r\n        _this.actionsList.className = 'actions-container';\r\n        _this.actionsList.setAttribute('role', 'toolbar');\r\n        if (_this.options.ariaLabel) {\r\n            _this.actionsList.setAttribute('aria-label', _this.options.ariaLabel);\r\n        }\r\n        _this.domNode.appendChild(_this.actionsList);\r\n        container.appendChild(_this.domNode);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ActionBar.prototype, \"onDidBlur\", {\r\n        get: function () { return this._onDidBlur.event; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActionBar.prototype, \"onDidCancel\", {\r\n        get: function () { return this._onDidCancel.event; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActionBar.prototype, \"onDidRun\", {\r\n        get: function () { return this._onDidRun.event; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActionBar.prototype, \"onDidBeforeRun\", {\r\n        get: function () { return this._onDidBeforeRun.event; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ActionBar.prototype.isTriggerKeyEvent = function (event) {\r\n        var ret = false;\r\n        if (this.options.triggerKeys) {\r\n            this.options.triggerKeys.keys.forEach(function (keyCode) {\r\n                ret = ret || event.equals(keyCode);\r\n            });\r\n        }\r\n        return ret;\r\n    };\r\n    ActionBar.prototype.updateFocusedItem = function () {\r\n        for (var i = 0; i < this.actionsList.children.length; i++) {\r\n            var elem = this.actionsList.children[i];\r\n            if (DOM.isAncestor(document.activeElement, elem)) {\r\n                this.focusedItem = i;\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(ActionBar.prototype, \"context\", {\r\n        get: function () {\r\n            return this._context;\r\n        },\r\n        set: function (context) {\r\n            this._context = context;\r\n            this.items.forEach(function (i) { return i.setActionContext(context); });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ActionBar.prototype.getContainer = function () {\r\n        return this.domNode;\r\n    };\r\n    ActionBar.prototype.push = function (arg, options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = {}; }\r\n        var actions = !Array.isArray(arg) ? [arg] : arg;\r\n        var index = types.isNumber(options.index) ? options.index : null;\r\n        actions.forEach(function (action) {\r\n            var actionItemElement = document.createElement('li');\r\n            actionItemElement.className = 'action-item';\r\n            actionItemElement.setAttribute('role', 'presentation');\r\n            // Prevent native context menu on actions\r\n            _this._register(DOM.addDisposableListener(actionItemElement, DOM.EventType.CONTEXT_MENU, function (e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }));\r\n            var item = null;\r\n            if (_this.options.actionItemProvider) {\r\n                item = _this.options.actionItemProvider(action);\r\n            }\r\n            if (!item) {\r\n                item = new ActionItem(_this.context, action, options);\r\n            }\r\n            item.actionRunner = _this._actionRunner;\r\n            item.setActionContext(_this.context);\r\n            item.render(actionItemElement);\r\n            if (index === null || index < 0 || index >= _this.actionsList.children.length) {\r\n                _this.actionsList.appendChild(actionItemElement);\r\n                _this.items.push(item);\r\n            }\r\n            else {\r\n                _this.actionsList.insertBefore(actionItemElement, _this.actionsList.children[index]);\r\n                _this.items.splice(index, 0, item);\r\n                index++;\r\n            }\r\n        });\r\n    };\r\n    ActionBar.prototype.clear = function () {\r\n        this.items = dispose(this.items);\r\n        DOM.clearNode(this.actionsList);\r\n    };\r\n    ActionBar.prototype.isEmpty = function () {\r\n        return this.items.length === 0;\r\n    };\r\n    ActionBar.prototype.focus = function (selectFirst) {\r\n        if (selectFirst && typeof this.focusedItem === 'undefined') {\r\n            // Focus the first enabled item\r\n            this.focusedItem = this.items.length - 1;\r\n            this.focusNext();\r\n        }\r\n        else {\r\n            this.updateFocus();\r\n        }\r\n    };\r\n    ActionBar.prototype.focusNext = function () {\r\n        if (typeof this.focusedItem === 'undefined') {\r\n            this.focusedItem = this.items.length - 1;\r\n        }\r\n        var startIndex = this.focusedItem;\r\n        var item;\r\n        do {\r\n            this.focusedItem = (this.focusedItem + 1) % this.items.length;\r\n            item = this.items[this.focusedItem];\r\n        } while (this.focusedItem !== startIndex && !item.isEnabled());\r\n        if (this.focusedItem === startIndex && !item.isEnabled()) {\r\n            this.focusedItem = undefined;\r\n        }\r\n        this.updateFocus();\r\n    };\r\n    ActionBar.prototype.focusPrevious = function () {\r\n        if (typeof this.focusedItem === 'undefined') {\r\n            this.focusedItem = 0;\r\n        }\r\n        var startIndex = this.focusedItem;\r\n        var item;\r\n        do {\r\n            this.focusedItem = this.focusedItem - 1;\r\n            if (this.focusedItem < 0) {\r\n                this.focusedItem = this.items.length - 1;\r\n            }\r\n            item = this.items[this.focusedItem];\r\n        } while (this.focusedItem !== startIndex && !item.isEnabled());\r\n        if (this.focusedItem === startIndex && !item.isEnabled()) {\r\n            this.focusedItem = undefined;\r\n        }\r\n        this.updateFocus(true);\r\n    };\r\n    ActionBar.prototype.updateFocus = function (fromRight) {\r\n        if (typeof this.focusedItem === 'undefined') {\r\n            this.actionsList.focus();\r\n        }\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            var item = this.items[i];\r\n            var actionItem = item;\r\n            if (i === this.focusedItem) {\r\n                if (types.isFunction(actionItem.isEnabled)) {\r\n                    if (actionItem.isEnabled() && types.isFunction(actionItem.focus)) {\r\n                        actionItem.focus(fromRight);\r\n                    }\r\n                    else {\r\n                        this.actionsList.focus();\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                if (types.isFunction(actionItem.blur)) {\r\n                    actionItem.blur();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    ActionBar.prototype.doTrigger = function (event) {\r\n        if (typeof this.focusedItem === 'undefined') {\r\n            return; //nothing to focus\r\n        }\r\n        // trigger action\r\n        var actionItem = this.items[this.focusedItem];\r\n        if (actionItem instanceof BaseActionItem) {\r\n            var context_1 = (actionItem._context === null || actionItem._context === undefined) ? event : actionItem._context;\r\n            this.run(actionItem._action, context_1);\r\n        }\r\n    };\r\n    ActionBar.prototype.cancel = function () {\r\n        if (document.activeElement instanceof HTMLElement) {\r\n            document.activeElement.blur(); // remove focus from focused action\r\n        }\r\n        this._onDidCancel.fire();\r\n    };\r\n    ActionBar.prototype.run = function (action, context) {\r\n        return this._actionRunner.run(action, context);\r\n    };\r\n    ActionBar.prototype.dispose = function () {\r\n        if (this.items !== null) {\r\n            dispose(this.items);\r\n        }\r\n        this.items = null;\r\n        DOM.removeNode(this.getContainer());\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    return ActionBar;\r\n}(Disposable));\r\nexport { ActionBar };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './media/diffReview.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\r\nimport { ActionBar } from '../../../base/browser/ui/actionbar/actionbar.js';\r\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { Configuration } from '../config/configuration.js';\r\nimport { EditorAction, registerEditorAction } from '../editorExtensions.js';\r\nimport { ICodeEditorService } from '../services/codeEditorService.js';\r\nimport { LineTokens } from '../../common/core/lineTokens.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { editorLineNumbers } from '../../common/view/editorColorRegistry.js';\r\nimport { RenderLineInput, renderViewLine2 as renderViewLine } from '../../common/viewLayout/viewLineRenderer.js';\r\nimport { ViewLineRenderingData } from '../../common/viewModel/viewModel.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { scrollbarShadow } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nvar DIFF_LINES_PADDING = 3;\r\nvar DiffEntry = /** @class */ (function () {\r\n    function DiffEntry(originalLineStart, originalLineEnd, modifiedLineStart, modifiedLineEnd) {\r\n        this.originalLineStart = originalLineStart;\r\n        this.originalLineEnd = originalLineEnd;\r\n        this.modifiedLineStart = modifiedLineStart;\r\n        this.modifiedLineEnd = modifiedLineEnd;\r\n    }\r\n    DiffEntry.prototype.getType = function () {\r\n        if (this.originalLineStart === 0) {\r\n            return 1 /* Insert */;\r\n        }\r\n        if (this.modifiedLineStart === 0) {\r\n            return 2 /* Delete */;\r\n        }\r\n        return 0 /* Equal */;\r\n    };\r\n    return DiffEntry;\r\n}());\r\nvar Diff = /** @class */ (function () {\r\n    function Diff(entries) {\r\n        this.entries = entries;\r\n    }\r\n    return Diff;\r\n}());\r\nvar DiffReview = /** @class */ (function (_super) {\r\n    __extends(DiffReview, _super);\r\n    function DiffReview(diffEditor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._width = 0;\r\n        _this._diffEditor = diffEditor;\r\n        _this._isVisible = false;\r\n        _this.shadow = createFastDomNode(document.createElement('div'));\r\n        _this.shadow.setClassName('diff-review-shadow');\r\n        _this.actionBarContainer = createFastDomNode(document.createElement('div'));\r\n        _this.actionBarContainer.setClassName('diff-review-actions');\r\n        _this._actionBar = _this._register(new ActionBar(_this.actionBarContainer.domNode));\r\n        _this._actionBar.push(new Action('diffreview.close', nls.localize('label.close', \"Close\"), 'close-diff-review', true, function () {\r\n            _this.hide();\r\n            return null;\r\n        }), { label: false, icon: true });\r\n        _this.domNode = createFastDomNode(document.createElement('div'));\r\n        _this.domNode.setClassName('diff-review monaco-editor-background');\r\n        _this._content = createFastDomNode(document.createElement('div'));\r\n        _this._content.setClassName('diff-review-content');\r\n        _this.scrollbar = _this._register(new DomScrollableElement(_this._content.domNode, {}));\r\n        _this.domNode.domNode.appendChild(_this.scrollbar.getDomNode());\r\n        _this._register(diffEditor.onDidUpdateDiff(function () {\r\n            if (!_this._isVisible) {\r\n                return;\r\n            }\r\n            _this._diffs = _this._compute();\r\n            _this._render();\r\n        }));\r\n        _this._register(diffEditor.getModifiedEditor().onDidChangeCursorPosition(function () {\r\n            if (!_this._isVisible) {\r\n                return;\r\n            }\r\n            _this._render();\r\n        }));\r\n        _this._register(diffEditor.getOriginalEditor().onDidFocusEditorWidget(function () {\r\n            if (_this._isVisible) {\r\n                _this.hide();\r\n            }\r\n        }));\r\n        _this._register(diffEditor.getModifiedEditor().onDidFocusEditorWidget(function () {\r\n            if (_this._isVisible) {\r\n                _this.hide();\r\n            }\r\n        }));\r\n        _this._register(dom.addStandardDisposableListener(_this.domNode.domNode, 'click', function (e) {\r\n            e.preventDefault();\r\n            var row = dom.findParentWithClass(e.target, 'diff-review-row');\r\n            if (row) {\r\n                _this._goToRow(row);\r\n            }\r\n        }));\r\n        _this._register(dom.addStandardDisposableListener(_this.domNode.domNode, 'keydown', function (e) {\r\n            if (e.equals(18 /* DownArrow */)\r\n                || e.equals(2048 /* CtrlCmd */ | 18 /* DownArrow */)\r\n                || e.equals(512 /* Alt */ | 18 /* DownArrow */)) {\r\n                e.preventDefault();\r\n                _this._goToRow(_this._getNextRow());\r\n            }\r\n            if (e.equals(16 /* UpArrow */)\r\n                || e.equals(2048 /* CtrlCmd */ | 16 /* UpArrow */)\r\n                || e.equals(512 /* Alt */ | 16 /* UpArrow */)) {\r\n                e.preventDefault();\r\n                _this._goToRow(_this._getPrevRow());\r\n            }\r\n            if (e.equals(9 /* Escape */)\r\n                || e.equals(2048 /* CtrlCmd */ | 9 /* Escape */)\r\n                || e.equals(512 /* Alt */ | 9 /* Escape */)\r\n                || e.equals(1024 /* Shift */ | 9 /* Escape */)) {\r\n                e.preventDefault();\r\n                _this.hide();\r\n            }\r\n            if (e.equals(10 /* Space */)\r\n                || e.equals(3 /* Enter */)) {\r\n                e.preventDefault();\r\n                _this.accept();\r\n            }\r\n        }));\r\n        _this._diffs = [];\r\n        _this._currentDiff = null;\r\n        return _this;\r\n    }\r\n    DiffReview.prototype.prev = function () {\r\n        var index = 0;\r\n        if (!this._isVisible) {\r\n            this._diffs = this._compute();\r\n        }\r\n        if (this._isVisible) {\r\n            var currentIndex = -1;\r\n            for (var i = 0, len = this._diffs.length; i < len; i++) {\r\n                if (this._diffs[i] === this._currentDiff) {\r\n                    currentIndex = i;\r\n                    break;\r\n                }\r\n            }\r\n            index = (this._diffs.length + currentIndex - 1);\r\n        }\r\n        else {\r\n            index = this._findDiffIndex(this._diffEditor.getPosition());\r\n        }\r\n        if (this._diffs.length === 0) {\r\n            // Nothing to do\r\n            return;\r\n        }\r\n        index = index % this._diffs.length;\r\n        this._diffEditor.setPosition(new Position(this._diffs[index].entries[0].modifiedLineStart, 1));\r\n        this._isVisible = true;\r\n        this._diffEditor.doLayout();\r\n        this._render();\r\n        this._goToRow(this._getNextRow());\r\n    };\r\n    DiffReview.prototype.next = function () {\r\n        var index = 0;\r\n        if (!this._isVisible) {\r\n            this._diffs = this._compute();\r\n        }\r\n        if (this._isVisible) {\r\n            var currentIndex = -1;\r\n            for (var i = 0, len = this._diffs.length; i < len; i++) {\r\n                if (this._diffs[i] === this._currentDiff) {\r\n                    currentIndex = i;\r\n                    break;\r\n                }\r\n            }\r\n            index = (currentIndex + 1);\r\n        }\r\n        else {\r\n            index = this._findDiffIndex(this._diffEditor.getPosition());\r\n        }\r\n        if (this._diffs.length === 0) {\r\n            // Nothing to do\r\n            return;\r\n        }\r\n        index = index % this._diffs.length;\r\n        this._diffEditor.setPosition(new Position(this._diffs[index].entries[0].modifiedLineStart, 1));\r\n        this._isVisible = true;\r\n        this._diffEditor.doLayout();\r\n        this._render();\r\n        this._goToRow(this._getNextRow());\r\n    };\r\n    DiffReview.prototype.accept = function () {\r\n        var jumpToLineNumber = -1;\r\n        var current = this._getCurrentFocusedRow();\r\n        if (current) {\r\n            var lineNumber = parseInt(current.getAttribute('data-line'), 10);\r\n            if (!isNaN(lineNumber)) {\r\n                jumpToLineNumber = lineNumber;\r\n            }\r\n        }\r\n        this.hide();\r\n        if (jumpToLineNumber !== -1) {\r\n            this._diffEditor.setPosition(new Position(jumpToLineNumber, 1));\r\n            this._diffEditor.revealPosition(new Position(jumpToLineNumber, 1), 1 /* Immediate */);\r\n        }\r\n    };\r\n    DiffReview.prototype.hide = function () {\r\n        this._isVisible = false;\r\n        this._diffEditor.focus();\r\n        this._diffEditor.doLayout();\r\n        this._render();\r\n    };\r\n    DiffReview.prototype._getPrevRow = function () {\r\n        var current = this._getCurrentFocusedRow();\r\n        if (!current) {\r\n            return this._getFirstRow();\r\n        }\r\n        if (current.previousElementSibling) {\r\n            return current.previousElementSibling;\r\n        }\r\n        return current;\r\n    };\r\n    DiffReview.prototype._getNextRow = function () {\r\n        var current = this._getCurrentFocusedRow();\r\n        if (!current) {\r\n            return this._getFirstRow();\r\n        }\r\n        if (current.nextElementSibling) {\r\n            return current.nextElementSibling;\r\n        }\r\n        return current;\r\n    };\r\n    DiffReview.prototype._getFirstRow = function () {\r\n        return this.domNode.domNode.querySelector('.diff-review-row');\r\n    };\r\n    DiffReview.prototype._getCurrentFocusedRow = function () {\r\n        var result = document.activeElement;\r\n        if (result && /diff-review-row/.test(result.className)) {\r\n            return result;\r\n        }\r\n        return null;\r\n    };\r\n    DiffReview.prototype._goToRow = function (row) {\r\n        var prev = this._getCurrentFocusedRow();\r\n        row.tabIndex = 0;\r\n        row.focus();\r\n        if (prev && prev !== row) {\r\n            prev.tabIndex = -1;\r\n        }\r\n        this.scrollbar.scanDomNode();\r\n    };\r\n    DiffReview.prototype.isVisible = function () {\r\n        return this._isVisible;\r\n    };\r\n    DiffReview.prototype.layout = function (top, width, height) {\r\n        this._width = width;\r\n        this.shadow.setTop(top - 6);\r\n        this.shadow.setWidth(width);\r\n        this.shadow.setHeight(this._isVisible ? 6 : 0);\r\n        this.domNode.setTop(top);\r\n        this.domNode.setWidth(width);\r\n        this.domNode.setHeight(height);\r\n        this._content.setHeight(height);\r\n        this._content.setWidth(width);\r\n        if (this._isVisible) {\r\n            this.actionBarContainer.setAttribute('aria-hidden', 'false');\r\n            this.actionBarContainer.setDisplay('block');\r\n        }\r\n        else {\r\n            this.actionBarContainer.setAttribute('aria-hidden', 'true');\r\n            this.actionBarContainer.setDisplay('none');\r\n        }\r\n    };\r\n    DiffReview.prototype._compute = function () {\r\n        var lineChanges = this._diffEditor.getLineChanges();\r\n        if (!lineChanges || lineChanges.length === 0) {\r\n            return [];\r\n        }\r\n        var originalModel = this._diffEditor.getOriginalEditor().getModel();\r\n        var modifiedModel = this._diffEditor.getModifiedEditor().getModel();\r\n        if (!originalModel || !modifiedModel) {\r\n            return [];\r\n        }\r\n        return DiffReview._mergeAdjacent(lineChanges, originalModel.getLineCount(), modifiedModel.getLineCount());\r\n    };\r\n    DiffReview._mergeAdjacent = function (lineChanges, originalLineCount, modifiedLineCount) {\r\n        if (!lineChanges || lineChanges.length === 0) {\r\n            return [];\r\n        }\r\n        var diffs = [], diffsLength = 0;\r\n        for (var i = 0, len = lineChanges.length; i < len; i++) {\r\n            var lineChange = lineChanges[i];\r\n            var originalStart = lineChange.originalStartLineNumber;\r\n            var originalEnd = lineChange.originalEndLineNumber;\r\n            var modifiedStart = lineChange.modifiedStartLineNumber;\r\n            var modifiedEnd = lineChange.modifiedEndLineNumber;\r\n            var r_1 = [], rLength_1 = 0;\r\n            // Emit before anchors\r\n            {\r\n                var originalEqualAbove = (originalEnd === 0 ? originalStart : originalStart - 1);\r\n                var modifiedEqualAbove = (modifiedEnd === 0 ? modifiedStart : modifiedStart - 1);\r\n                // Make sure we don't step into the previous diff\r\n                var minOriginal = 1;\r\n                var minModified = 1;\r\n                if (i > 0) {\r\n                    var prevLineChange = lineChanges[i - 1];\r\n                    if (prevLineChange.originalEndLineNumber === 0) {\r\n                        minOriginal = prevLineChange.originalStartLineNumber + 1;\r\n                    }\r\n                    else {\r\n                        minOriginal = prevLineChange.originalEndLineNumber + 1;\r\n                    }\r\n                    if (prevLineChange.modifiedEndLineNumber === 0) {\r\n                        minModified = prevLineChange.modifiedStartLineNumber + 1;\r\n                    }\r\n                    else {\r\n                        minModified = prevLineChange.modifiedEndLineNumber + 1;\r\n                    }\r\n                }\r\n                var fromOriginal = originalEqualAbove - DIFF_LINES_PADDING + 1;\r\n                var fromModified = modifiedEqualAbove - DIFF_LINES_PADDING + 1;\r\n                if (fromOriginal < minOriginal) {\r\n                    var delta = minOriginal - fromOriginal;\r\n                    fromOriginal = fromOriginal + delta;\r\n                    fromModified = fromModified + delta;\r\n                }\r\n                if (fromModified < minModified) {\r\n                    var delta = minModified - fromModified;\r\n                    fromOriginal = fromOriginal + delta;\r\n                    fromModified = fromModified + delta;\r\n                }\r\n                r_1[rLength_1++] = new DiffEntry(fromOriginal, originalEqualAbove, fromModified, modifiedEqualAbove);\r\n            }\r\n            // Emit deleted lines\r\n            {\r\n                if (originalEnd !== 0) {\r\n                    r_1[rLength_1++] = new DiffEntry(originalStart, originalEnd, 0, 0);\r\n                }\r\n            }\r\n            // Emit inserted lines\r\n            {\r\n                if (modifiedEnd !== 0) {\r\n                    r_1[rLength_1++] = new DiffEntry(0, 0, modifiedStart, modifiedEnd);\r\n                }\r\n            }\r\n            // Emit after anchors\r\n            {\r\n                var originalEqualBelow = (originalEnd === 0 ? originalStart + 1 : originalEnd + 1);\r\n                var modifiedEqualBelow = (modifiedEnd === 0 ? modifiedStart + 1 : modifiedEnd + 1);\r\n                // Make sure we don't step into the next diff\r\n                var maxOriginal = originalLineCount;\r\n                var maxModified = modifiedLineCount;\r\n                if (i + 1 < len) {\r\n                    var nextLineChange = lineChanges[i + 1];\r\n                    if (nextLineChange.originalEndLineNumber === 0) {\r\n                        maxOriginal = nextLineChange.originalStartLineNumber;\r\n                    }\r\n                    else {\r\n                        maxOriginal = nextLineChange.originalStartLineNumber - 1;\r\n                    }\r\n                    if (nextLineChange.modifiedEndLineNumber === 0) {\r\n                        maxModified = nextLineChange.modifiedStartLineNumber;\r\n                    }\r\n                    else {\r\n                        maxModified = nextLineChange.modifiedStartLineNumber - 1;\r\n                    }\r\n                }\r\n                var toOriginal = originalEqualBelow + DIFF_LINES_PADDING - 1;\r\n                var toModified = modifiedEqualBelow + DIFF_LINES_PADDING - 1;\r\n                if (toOriginal > maxOriginal) {\r\n                    var delta = maxOriginal - toOriginal;\r\n                    toOriginal = toOriginal + delta;\r\n                    toModified = toModified + delta;\r\n                }\r\n                if (toModified > maxModified) {\r\n                    var delta = maxModified - toModified;\r\n                    toOriginal = toOriginal + delta;\r\n                    toModified = toModified + delta;\r\n                }\r\n                r_1[rLength_1++] = new DiffEntry(originalEqualBelow, toOriginal, modifiedEqualBelow, toModified);\r\n            }\r\n            diffs[diffsLength++] = new Diff(r_1);\r\n        }\r\n        // Merge adjacent diffs\r\n        var curr = diffs[0].entries;\r\n        var r = [], rLength = 0;\r\n        for (var i = 1, len = diffs.length; i < len; i++) {\r\n            var thisDiff = diffs[i].entries;\r\n            var currLast = curr[curr.length - 1];\r\n            var thisFirst = thisDiff[0];\r\n            if (currLast.getType() === 0 /* Equal */\r\n                && thisFirst.getType() === 0 /* Equal */\r\n                && thisFirst.originalLineStart <= currLast.originalLineEnd) {\r\n                // We are dealing with equal lines that overlap\r\n                curr[curr.length - 1] = new DiffEntry(currLast.originalLineStart, thisFirst.originalLineEnd, currLast.modifiedLineStart, thisFirst.modifiedLineEnd);\r\n                curr = curr.concat(thisDiff.slice(1));\r\n                continue;\r\n            }\r\n            r[rLength++] = new Diff(curr);\r\n            curr = thisDiff;\r\n        }\r\n        r[rLength++] = new Diff(curr);\r\n        return r;\r\n    };\r\n    DiffReview.prototype._findDiffIndex = function (pos) {\r\n        var lineNumber = pos.lineNumber;\r\n        for (var i = 0, len = this._diffs.length; i < len; i++) {\r\n            var diff = this._diffs[i].entries;\r\n            var lastModifiedLine = diff[diff.length - 1].modifiedLineEnd;\r\n            if (lineNumber <= lastModifiedLine) {\r\n                return i;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    DiffReview.prototype._render = function () {\r\n        var originalOpts = this._diffEditor.getOriginalEditor().getConfiguration();\r\n        var modifiedOpts = this._diffEditor.getModifiedEditor().getConfiguration();\r\n        var originalModel = this._diffEditor.getOriginalEditor().getModel();\r\n        var modifiedModel = this._diffEditor.getModifiedEditor().getModel();\r\n        var originalModelOpts = originalModel.getOptions();\r\n        var modifiedModelOpts = modifiedModel.getOptions();\r\n        if (!this._isVisible || !originalModel || !modifiedModel) {\r\n            dom.clearNode(this._content.domNode);\r\n            this._currentDiff = null;\r\n            this.scrollbar.scanDomNode();\r\n            return;\r\n        }\r\n        var pos = this._diffEditor.getPosition();\r\n        var diffIndex = this._findDiffIndex(pos);\r\n        if (this._diffs[diffIndex] === this._currentDiff) {\r\n            return;\r\n        }\r\n        this._currentDiff = this._diffs[diffIndex];\r\n        var diffs = this._diffs[diffIndex].entries;\r\n        var container = document.createElement('div');\r\n        container.className = 'diff-review-table';\r\n        container.setAttribute('role', 'list');\r\n        Configuration.applyFontInfoSlow(container, modifiedOpts.fontInfo);\r\n        var minOriginalLine = 0;\r\n        var maxOriginalLine = 0;\r\n        var minModifiedLine = 0;\r\n        var maxModifiedLine = 0;\r\n        for (var i = 0, len = diffs.length; i < len; i++) {\r\n            var diffEntry = diffs[i];\r\n            var originalLineStart = diffEntry.originalLineStart;\r\n            var originalLineEnd = diffEntry.originalLineEnd;\r\n            var modifiedLineStart = diffEntry.modifiedLineStart;\r\n            var modifiedLineEnd = diffEntry.modifiedLineEnd;\r\n            if (originalLineStart !== 0 && ((minOriginalLine === 0 || originalLineStart < minOriginalLine))) {\r\n                minOriginalLine = originalLineStart;\r\n            }\r\n            if (originalLineEnd !== 0 && ((maxOriginalLine === 0 || originalLineEnd > maxOriginalLine))) {\r\n                maxOriginalLine = originalLineEnd;\r\n            }\r\n            if (modifiedLineStart !== 0 && ((minModifiedLine === 0 || modifiedLineStart < minModifiedLine))) {\r\n                minModifiedLine = modifiedLineStart;\r\n            }\r\n            if (modifiedLineEnd !== 0 && ((maxModifiedLine === 0 || modifiedLineEnd > maxModifiedLine))) {\r\n                maxModifiedLine = modifiedLineEnd;\r\n            }\r\n        }\r\n        var header = document.createElement('div');\r\n        header.className = 'diff-review-row';\r\n        var cell = document.createElement('div');\r\n        cell.className = 'diff-review-cell diff-review-summary';\r\n        var originalChangedLinesCnt = maxOriginalLine - minOriginalLine + 1;\r\n        var modifiedChangedLinesCnt = maxModifiedLine - minModifiedLine + 1;\r\n        cell.appendChild(document.createTextNode(diffIndex + 1 + \"/\" + this._diffs.length + \": @@ -\" + minOriginalLine + \",\" + originalChangedLinesCnt + \" +\" + minModifiedLine + \",\" + modifiedChangedLinesCnt + \" @@\"));\r\n        header.setAttribute('data-line', String(minModifiedLine));\r\n        var getAriaLines = function (lines) {\r\n            if (lines === 0) {\r\n                return nls.localize('no_lines', \"no lines\");\r\n            }\r\n            else if (lines === 1) {\r\n                return nls.localize('one_line', \"1 line\");\r\n            }\r\n            else {\r\n                return nls.localize('more_lines', \"{0} lines\", lines);\r\n            }\r\n        };\r\n        var originalChangedLinesCntAria = getAriaLines(originalChangedLinesCnt);\r\n        var modifiedChangedLinesCntAria = getAriaLines(modifiedChangedLinesCnt);\r\n        header.setAttribute('aria-label', nls.localize({\r\n            key: 'header',\r\n            comment: [\r\n                'This is the ARIA label for a git diff header.',\r\n                'A git diff header looks like this: @@ -154,12 +159,39 @@.',\r\n                'That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.',\r\n                'Variables 0 and 1 refer to the diff index out of total number of diffs.',\r\n                'Variables 2 and 4 will be numbers (a line number).',\r\n                'Variables 3 and 5 will be \"no lines\", \"1 line\" or \"X lines\", localized separately.'\r\n            ]\r\n        }, \"Difference {0} of {1}: original {2}, {3}, modified {4}, {5}\", (diffIndex + 1), this._diffs.length, minOriginalLine, originalChangedLinesCntAria, minModifiedLine, modifiedChangedLinesCntAria));\r\n        header.appendChild(cell);\r\n        // @@ -504,7 +517,7 @@\r\n        header.setAttribute('role', 'listitem');\r\n        container.appendChild(header);\r\n        var modLine = minModifiedLine;\r\n        for (var i = 0, len = diffs.length; i < len; i++) {\r\n            var diffEntry = diffs[i];\r\n            DiffReview._renderSection(container, diffEntry, modLine, this._width, originalOpts, originalModel, originalModelOpts, modifiedOpts, modifiedModel, modifiedModelOpts);\r\n            if (diffEntry.modifiedLineStart !== 0) {\r\n                modLine = diffEntry.modifiedLineEnd;\r\n            }\r\n        }\r\n        dom.clearNode(this._content.domNode);\r\n        this._content.domNode.appendChild(container);\r\n        this.scrollbar.scanDomNode();\r\n    };\r\n    DiffReview._renderSection = function (dest, diffEntry, modLine, width, originalOpts, originalModel, originalModelOpts, modifiedOpts, modifiedModel, modifiedModelOpts) {\r\n        var type = diffEntry.getType();\r\n        var rowClassName = 'diff-review-row';\r\n        var lineNumbersExtraClassName = '';\r\n        var spacerClassName = 'diff-review-spacer';\r\n        switch (type) {\r\n            case 1 /* Insert */:\r\n                rowClassName = 'diff-review-row line-insert';\r\n                lineNumbersExtraClassName = ' char-insert';\r\n                spacerClassName = 'diff-review-spacer insert-sign';\r\n                break;\r\n            case 2 /* Delete */:\r\n                rowClassName = 'diff-review-row line-delete';\r\n                lineNumbersExtraClassName = ' char-delete';\r\n                spacerClassName = 'diff-review-spacer delete-sign';\r\n                break;\r\n        }\r\n        var originalLineStart = diffEntry.originalLineStart;\r\n        var originalLineEnd = diffEntry.originalLineEnd;\r\n        var modifiedLineStart = diffEntry.modifiedLineStart;\r\n        var modifiedLineEnd = diffEntry.modifiedLineEnd;\r\n        var cnt = Math.max(modifiedLineEnd - modifiedLineStart, originalLineEnd - originalLineStart);\r\n        var originalLineNumbersWidth = originalOpts.layoutInfo.glyphMarginWidth + originalOpts.layoutInfo.lineNumbersWidth;\r\n        var modifiedLineNumbersWidth = 10 + modifiedOpts.layoutInfo.glyphMarginWidth + modifiedOpts.layoutInfo.lineNumbersWidth;\r\n        for (var i = 0; i <= cnt; i++) {\r\n            var originalLine = (originalLineStart === 0 ? 0 : originalLineStart + i);\r\n            var modifiedLine = (modifiedLineStart === 0 ? 0 : modifiedLineStart + i);\r\n            var row = document.createElement('div');\r\n            row.style.minWidth = width + 'px';\r\n            row.className = rowClassName;\r\n            row.setAttribute('role', 'listitem');\r\n            if (modifiedLine !== 0) {\r\n                modLine = modifiedLine;\r\n            }\r\n            row.setAttribute('data-line', String(modLine));\r\n            var cell = document.createElement('div');\r\n            cell.className = 'diff-review-cell';\r\n            row.appendChild(cell);\r\n            var originalLineNumber = document.createElement('span');\r\n            originalLineNumber.style.width = (originalLineNumbersWidth + 'px');\r\n            originalLineNumber.style.minWidth = (originalLineNumbersWidth + 'px');\r\n            originalLineNumber.className = 'diff-review-line-number' + lineNumbersExtraClassName;\r\n            if (originalLine !== 0) {\r\n                originalLineNumber.appendChild(document.createTextNode(String(originalLine)));\r\n            }\r\n            else {\r\n                originalLineNumber.innerHTML = '&nbsp;';\r\n            }\r\n            cell.appendChild(originalLineNumber);\r\n            var modifiedLineNumber = document.createElement('span');\r\n            modifiedLineNumber.style.width = (modifiedLineNumbersWidth + 'px');\r\n            modifiedLineNumber.style.minWidth = (modifiedLineNumbersWidth + 'px');\r\n            modifiedLineNumber.style.paddingRight = '10px';\r\n            modifiedLineNumber.className = 'diff-review-line-number' + lineNumbersExtraClassName;\r\n            if (modifiedLine !== 0) {\r\n                modifiedLineNumber.appendChild(document.createTextNode(String(modifiedLine)));\r\n            }\r\n            else {\r\n                modifiedLineNumber.innerHTML = '&nbsp;';\r\n            }\r\n            cell.appendChild(modifiedLineNumber);\r\n            var spacer = document.createElement('span');\r\n            spacer.className = spacerClassName;\r\n            spacer.innerHTML = '&nbsp;&nbsp;';\r\n            cell.appendChild(spacer);\r\n            var lineContent = void 0;\r\n            if (modifiedLine !== 0) {\r\n                cell.insertAdjacentHTML('beforeend', this._renderLine(modifiedModel, modifiedOpts, modifiedModelOpts.tabSize, modifiedLine));\r\n                lineContent = modifiedModel.getLineContent(modifiedLine);\r\n            }\r\n            else {\r\n                cell.insertAdjacentHTML('beforeend', this._renderLine(originalModel, originalOpts, originalModelOpts.tabSize, originalLine));\r\n                lineContent = originalModel.getLineContent(originalLine);\r\n            }\r\n            if (lineContent.length === 0) {\r\n                lineContent = nls.localize('blankLine', \"blank\");\r\n            }\r\n            var ariaLabel = void 0;\r\n            switch (type) {\r\n                case 0 /* Equal */:\r\n                    ariaLabel = nls.localize('equalLine', \"original {0}, modified {1}: {2}\", originalLine, modifiedLine, lineContent);\r\n                    break;\r\n                case 1 /* Insert */:\r\n                    ariaLabel = nls.localize('insertLine', \"+ modified {0}: {1}\", modifiedLine, lineContent);\r\n                    break;\r\n                case 2 /* Delete */:\r\n                    ariaLabel = nls.localize('deleteLine', \"- original {0}: {1}\", originalLine, lineContent);\r\n                    break;\r\n            }\r\n            row.setAttribute('aria-label', ariaLabel);\r\n            dest.appendChild(row);\r\n        }\r\n    };\r\n    DiffReview._renderLine = function (model, config, tabSize, lineNumber) {\r\n        var lineContent = model.getLineContent(lineNumber);\r\n        var defaultMetadata = ((0 /* None */ << 11 /* FONT_STYLE_OFFSET */)\r\n            | (1 /* DefaultForeground */ << 14 /* FOREGROUND_OFFSET */)\r\n            | (2 /* DefaultBackground */ << 23 /* BACKGROUND_OFFSET */)) >>> 0;\r\n        var tokens = new Uint32Array(2);\r\n        tokens[0] = lineContent.length;\r\n        tokens[1] = defaultMetadata;\r\n        var lineTokens = new LineTokens(tokens, lineContent);\r\n        var isBasicASCII = ViewLineRenderingData.isBasicASCII(lineContent, model.mightContainNonBasicASCII());\r\n        var containsRTL = ViewLineRenderingData.containsRTL(lineContent, isBasicASCII, model.mightContainRTL());\r\n        var r = renderViewLine(new RenderLineInput((config.fontInfo.isMonospace && !config.viewInfo.disableMonospaceOptimizations), config.fontInfo.canUseHalfwidthRightwardsArrow, lineContent, false, isBasicASCII, containsRTL, 0, lineTokens, [], tabSize, config.fontInfo.spaceWidth, config.viewInfo.stopRenderingLineAfter, config.viewInfo.renderWhitespace, config.viewInfo.renderControlCharacters, config.viewInfo.fontLigatures));\r\n        return r.html;\r\n    };\r\n    return DiffReview;\r\n}(Disposable));\r\nexport { DiffReview };\r\n// theming\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var lineNumbers = theme.getColor(editorLineNumbers);\r\n    if (lineNumbers) {\r\n        collector.addRule(\".monaco-diff-editor .diff-review-line-number { color: \" + lineNumbers + \"; }\");\r\n    }\r\n    var shadow = theme.getColor(scrollbarShadow);\r\n    if (shadow) {\r\n        collector.addRule(\".monaco-diff-editor .diff-review-shadow { box-shadow: \" + shadow + \" 0 -6px 6px -6px inset; }\");\r\n    }\r\n});\r\nvar DiffReviewNext = /** @class */ (function (_super) {\r\n    __extends(DiffReviewNext, _super);\r\n    function DiffReviewNext() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.diffReview.next',\r\n            label: nls.localize('editor.action.diffReview.next', \"Go to Next Difference\"),\r\n            alias: 'Go to Next Difference',\r\n            precondition: ContextKeyExpr.has('isInDiffEditor'),\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 65 /* F7 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DiffReviewNext.prototype.run = function (accessor, editor) {\r\n        var diffEditor = findFocusedDiffEditor(accessor);\r\n        if (diffEditor) {\r\n            diffEditor.diffReviewNext();\r\n        }\r\n    };\r\n    return DiffReviewNext;\r\n}(EditorAction));\r\nvar DiffReviewPrev = /** @class */ (function (_super) {\r\n    __extends(DiffReviewPrev, _super);\r\n    function DiffReviewPrev() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.diffReview.prev',\r\n            label: nls.localize('editor.action.diffReview.prev', \"Go to Previous Difference\"),\r\n            alias: 'Go to Previous Difference',\r\n            precondition: ContextKeyExpr.has('isInDiffEditor'),\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 1024 /* Shift */ | 65 /* F7 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DiffReviewPrev.prototype.run = function (accessor, editor) {\r\n        var diffEditor = findFocusedDiffEditor(accessor);\r\n        if (diffEditor) {\r\n            diffEditor.diffReviewPrev();\r\n        }\r\n    };\r\n    return DiffReviewPrev;\r\n}(EditorAction));\r\nfunction findFocusedDiffEditor(accessor) {\r\n    var codeEditorService = accessor.get(ICodeEditorService);\r\n    var diffEditors = codeEditorService.listDiffEditors();\r\n    for (var i = 0, len = diffEditors.length; i < len; i++) {\r\n        var diffEditor = diffEditors[i];\r\n        if (diffEditor.hasWidgetFocus()) {\r\n            return diffEditor;\r\n        }\r\n    }\r\n    return null;\r\n}\r\nregisterEditorAction(DiffReviewNext);\r\nregisterEditorAction(DiffReviewPrev);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './media/diffEditor.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\r\nimport { Sash } from '../../../base/browser/ui/sash/sash.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport { Configuration } from '../config/configuration.js';\r\nimport { StableEditorScrollState } from '../core/editorState.js';\r\nimport { ICodeEditorService } from '../services/codeEditorService.js';\r\nimport { CodeEditorWidget } from './codeEditorWidget.js';\r\nimport { DiffReview } from './diffReview.js';\r\nimport * as editorOptions from '../../common/config/editorOptions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { createStringBuilder } from '../../common/core/stringBuilder.js';\r\nimport * as editorCommon from '../../common/editorCommon.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { OverviewRulerZone } from '../../common/view/overviewZoneManager.js';\r\nimport { LineDecoration } from '../../common/viewLayout/lineDecorations.js';\r\nimport { RenderLineInput, renderViewLine } from '../../common/viewLayout/viewLineRenderer.js';\r\nimport { InlineDecoration, ViewLineRenderingData } from '../../common/viewModel/viewModel.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { defaultInsertColor, defaultRemoveColor, diffBorder, diffInserted, diffInsertedOutline, diffRemoved, diffRemovedOutline, scrollbarShadow } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService, getThemeTypeSelector, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nvar VisualEditorState = /** @class */ (function () {\r\n    function VisualEditorState() {\r\n        this._zones = [];\r\n        this._zonesMap = {};\r\n        this._decorations = [];\r\n    }\r\n    VisualEditorState.prototype.getForeignViewZones = function (allViewZones) {\r\n        var _this = this;\r\n        return allViewZones.filter(function (z) { return !_this._zonesMap[String(z.id)]; });\r\n    };\r\n    VisualEditorState.prototype.clean = function (editor) {\r\n        var _this = this;\r\n        // (1) View zones\r\n        if (this._zones.length > 0) {\r\n            editor.changeViewZones(function (viewChangeAccessor) {\r\n                for (var i = 0, length_1 = _this._zones.length; i < length_1; i++) {\r\n                    viewChangeAccessor.removeZone(_this._zones[i]);\r\n                }\r\n            });\r\n        }\r\n        this._zones = [];\r\n        this._zonesMap = {};\r\n        // (2) Model decorations\r\n        this._decorations = editor.deltaDecorations(this._decorations, []);\r\n    };\r\n    VisualEditorState.prototype.apply = function (editor, overviewRuler, newDecorations, restoreScrollState) {\r\n        var _this = this;\r\n        var scrollState = restoreScrollState ? StableEditorScrollState.capture(editor) : null;\r\n        // view zones\r\n        editor.changeViewZones(function (viewChangeAccessor) {\r\n            for (var i = 0, length_2 = _this._zones.length; i < length_2; i++) {\r\n                viewChangeAccessor.removeZone(_this._zones[i]);\r\n            }\r\n            _this._zones = [];\r\n            _this._zonesMap = {};\r\n            for (var i = 0, length_3 = newDecorations.zones.length; i < length_3; i++) {\r\n                newDecorations.zones[i].suppressMouseDown = true;\r\n                var zoneId = viewChangeAccessor.addZone(newDecorations.zones[i]);\r\n                _this._zones.push(zoneId);\r\n                _this._zonesMap[String(zoneId)] = true;\r\n            }\r\n        });\r\n        if (scrollState) {\r\n            scrollState.restore(editor);\r\n        }\r\n        // decorations\r\n        this._decorations = editor.deltaDecorations(this._decorations, newDecorations.decorations);\r\n        // overview ruler\r\n        if (overviewRuler) {\r\n            overviewRuler.setZones(newDecorations.overviewZones);\r\n        }\r\n    };\r\n    return VisualEditorState;\r\n}());\r\nvar DIFF_EDITOR_ID = 0;\r\nvar DiffEditorWidget = /** @class */ (function (_super) {\r\n    __extends(DiffEditorWidget, _super);\r\n    function DiffEditorWidget(domElement, options, editorWorkerService, contextKeyService, instantiationService, codeEditorService, themeService, notificationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onDidDispose = _this._register(new Emitter());\r\n        _this.onDidDispose = _this._onDidDispose.event;\r\n        _this._onDidUpdateDiff = _this._register(new Emitter());\r\n        _this.onDidUpdateDiff = _this._onDidUpdateDiff.event;\r\n        _this._lastOriginalWarning = null;\r\n        _this._lastModifiedWarning = null;\r\n        _this._editorWorkerService = editorWorkerService;\r\n        _this._codeEditorService = codeEditorService;\r\n        _this._contextKeyService = _this._register(contextKeyService.createScoped(domElement));\r\n        _this._contextKeyService.createKey('isInDiffEditor', true);\r\n        _this._themeService = themeService;\r\n        _this._notificationService = notificationService;\r\n        _this.id = (++DIFF_EDITOR_ID);\r\n        _this._domElement = domElement;\r\n        options = options || {};\r\n        // renderSideBySide\r\n        _this._renderSideBySide = true;\r\n        if (typeof options.renderSideBySide !== 'undefined') {\r\n            _this._renderSideBySide = options.renderSideBySide;\r\n        }\r\n        // ignoreTrimWhitespace\r\n        _this._ignoreTrimWhitespace = true;\r\n        if (typeof options.ignoreTrimWhitespace !== 'undefined') {\r\n            _this._ignoreTrimWhitespace = options.ignoreTrimWhitespace;\r\n        }\r\n        // renderIndicators\r\n        _this._renderIndicators = true;\r\n        if (typeof options.renderIndicators !== 'undefined') {\r\n            _this._renderIndicators = options.renderIndicators;\r\n        }\r\n        _this._originalIsEditable = false;\r\n        if (typeof options.originalEditable !== 'undefined') {\r\n            _this._originalIsEditable = Boolean(options.originalEditable);\r\n        }\r\n        _this._updateDecorationsRunner = _this._register(new RunOnceScheduler(function () { return _this._updateDecorations(); }, 0));\r\n        _this._containerDomElement = document.createElement('div');\r\n        _this._containerDomElement.className = DiffEditorWidget._getClassName(_this._themeService.getTheme(), _this._renderSideBySide);\r\n        _this._containerDomElement.style.position = 'relative';\r\n        _this._containerDomElement.style.height = '100%';\r\n        _this._domElement.appendChild(_this._containerDomElement);\r\n        _this._overviewViewportDomElement = createFastDomNode(document.createElement('div'));\r\n        _this._overviewViewportDomElement.setClassName('diffViewport');\r\n        _this._overviewViewportDomElement.setPosition('absolute');\r\n        _this._overviewDomElement = document.createElement('div');\r\n        _this._overviewDomElement.className = 'diffOverview';\r\n        _this._overviewDomElement.style.position = 'absolute';\r\n        _this._overviewDomElement.appendChild(_this._overviewViewportDomElement.domNode);\r\n        _this._register(dom.addStandardDisposableListener(_this._overviewDomElement, 'mousedown', function (e) {\r\n            _this.modifiedEditor.delegateVerticalScrollbarMouseDown(e);\r\n        }));\r\n        _this._containerDomElement.appendChild(_this._overviewDomElement);\r\n        _this._createLeftHandSide();\r\n        _this._createRightHandSide();\r\n        _this._beginUpdateDecorationsTimeout = -1;\r\n        _this._currentlyChangingViewZones = false;\r\n        _this._diffComputationToken = 0;\r\n        _this._originalEditorState = new VisualEditorState();\r\n        _this._modifiedEditorState = new VisualEditorState();\r\n        _this._isVisible = true;\r\n        _this._isHandlingScrollEvent = false;\r\n        _this._width = 0;\r\n        _this._height = 0;\r\n        _this._reviewHeight = 0;\r\n        _this._diffComputationResult = null;\r\n        var leftContextKeyService = _this._contextKeyService.createScoped();\r\n        leftContextKeyService.createKey('isInDiffLeftEditor', true);\r\n        var leftServices = new ServiceCollection();\r\n        leftServices.set(IContextKeyService, leftContextKeyService);\r\n        var leftScopedInstantiationService = instantiationService.createChild(leftServices);\r\n        var rightContextKeyService = _this._contextKeyService.createScoped();\r\n        rightContextKeyService.createKey('isInDiffRightEditor', true);\r\n        var rightServices = new ServiceCollection();\r\n        rightServices.set(IContextKeyService, rightContextKeyService);\r\n        var rightScopedInstantiationService = instantiationService.createChild(rightServices);\r\n        _this._createLeftHandSideEditor(options, leftScopedInstantiationService);\r\n        _this._createRightHandSideEditor(options, rightScopedInstantiationService);\r\n        _this._reviewPane = new DiffReview(_this);\r\n        _this._containerDomElement.appendChild(_this._reviewPane.domNode.domNode);\r\n        _this._containerDomElement.appendChild(_this._reviewPane.shadow.domNode);\r\n        _this._containerDomElement.appendChild(_this._reviewPane.actionBarContainer.domNode);\r\n        if (options.automaticLayout) {\r\n            _this._measureDomElementToken = window.setInterval(function () { return _this._measureDomElement(false); }, 100);\r\n        }\r\n        // enableSplitViewResizing\r\n        _this._enableSplitViewResizing = true;\r\n        if (typeof options.enableSplitViewResizing !== 'undefined') {\r\n            _this._enableSplitViewResizing = options.enableSplitViewResizing;\r\n        }\r\n        if (_this._renderSideBySide) {\r\n            _this._setStrategy(new DiffEdtorWidgetSideBySide(_this._createDataSource(), _this._enableSplitViewResizing));\r\n        }\r\n        else {\r\n            _this._setStrategy(new DiffEdtorWidgetInline(_this._createDataSource(), _this._enableSplitViewResizing));\r\n        }\r\n        _this._register(themeService.onThemeChange(function (t) {\r\n            if (_this._strategy && _this._strategy.applyColors(t)) {\r\n                _this._updateDecorationsRunner.schedule();\r\n            }\r\n            _this._containerDomElement.className = DiffEditorWidget._getClassName(_this._themeService.getTheme(), _this._renderSideBySide);\r\n        }));\r\n        _this._codeEditorService.addDiffEditor(_this);\r\n        return _this;\r\n    }\r\n    DiffEditorWidget.prototype.hasWidgetFocus = function () {\r\n        return dom.isAncestor(document.activeElement, this._domElement);\r\n    };\r\n    DiffEditorWidget.prototype.diffReviewNext = function () {\r\n        this._reviewPane.next();\r\n    };\r\n    DiffEditorWidget.prototype.diffReviewPrev = function () {\r\n        this._reviewPane.prev();\r\n    };\r\n    DiffEditorWidget._getClassName = function (theme, renderSideBySide) {\r\n        var result = 'monaco-diff-editor monaco-editor-background ';\r\n        if (renderSideBySide) {\r\n            result += 'side-by-side ';\r\n        }\r\n        result += getThemeTypeSelector(theme.type);\r\n        return result;\r\n    };\r\n    DiffEditorWidget.prototype._recreateOverviewRulers = function () {\r\n        if (this._originalOverviewRuler) {\r\n            this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode());\r\n            this._originalOverviewRuler.dispose();\r\n        }\r\n        this._originalOverviewRuler = this.originalEditor.createOverviewRuler('original diffOverviewRuler');\r\n        this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode());\r\n        if (this._modifiedOverviewRuler) {\r\n            this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode());\r\n            this._modifiedOverviewRuler.dispose();\r\n        }\r\n        this._modifiedOverviewRuler = this.modifiedEditor.createOverviewRuler('modified diffOverviewRuler');\r\n        this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode());\r\n        this._layoutOverviewRulers();\r\n    };\r\n    DiffEditorWidget.prototype._createLeftHandSide = function () {\r\n        this._originalDomNode = document.createElement('div');\r\n        this._originalDomNode.className = 'editor original';\r\n        this._originalDomNode.style.position = 'absolute';\r\n        this._originalDomNode.style.height = '100%';\r\n        this._containerDomElement.appendChild(this._originalDomNode);\r\n    };\r\n    DiffEditorWidget.prototype._createRightHandSide = function () {\r\n        this._modifiedDomNode = document.createElement('div');\r\n        this._modifiedDomNode.className = 'editor modified';\r\n        this._modifiedDomNode.style.position = 'absolute';\r\n        this._modifiedDomNode.style.height = '100%';\r\n        this._containerDomElement.appendChild(this._modifiedDomNode);\r\n    };\r\n    DiffEditorWidget.prototype._createLeftHandSideEditor = function (options, instantiationService) {\r\n        var _this = this;\r\n        this.originalEditor = this._createInnerEditor(instantiationService, this._originalDomNode, this._adjustOptionsForLeftHandSide(options, this._originalIsEditable));\r\n        this._register(this.originalEditor.onDidScrollChange(function (e) {\r\n            if (_this._isHandlingScrollEvent) {\r\n                return;\r\n            }\r\n            if (!e.scrollTopChanged && !e.scrollLeftChanged && !e.scrollHeightChanged) {\r\n                return;\r\n            }\r\n            _this._isHandlingScrollEvent = true;\r\n            _this.modifiedEditor.setScrollPosition({\r\n                scrollLeft: e.scrollLeft,\r\n                scrollTop: e.scrollTop\r\n            });\r\n            _this._isHandlingScrollEvent = false;\r\n            _this._layoutOverviewViewport();\r\n        }));\r\n        this._register(this.originalEditor.onDidChangeViewZones(function () {\r\n            _this._onViewZonesChanged();\r\n        }));\r\n        this._register(this.originalEditor.onDidChangeModelContent(function () {\r\n            if (_this._isVisible) {\r\n                _this._beginUpdateDecorationsSoon();\r\n            }\r\n        }));\r\n    };\r\n    DiffEditorWidget.prototype._createRightHandSideEditor = function (options, instantiationService) {\r\n        var _this = this;\r\n        this.modifiedEditor = this._createInnerEditor(instantiationService, this._modifiedDomNode, this._adjustOptionsForRightHandSide(options));\r\n        this._register(this.modifiedEditor.onDidScrollChange(function (e) {\r\n            if (_this._isHandlingScrollEvent) {\r\n                return;\r\n            }\r\n            if (!e.scrollTopChanged && !e.scrollLeftChanged && !e.scrollHeightChanged) {\r\n                return;\r\n            }\r\n            _this._isHandlingScrollEvent = true;\r\n            _this.originalEditor.setScrollPosition({\r\n                scrollLeft: e.scrollLeft,\r\n                scrollTop: e.scrollTop\r\n            });\r\n            _this._isHandlingScrollEvent = false;\r\n            _this._layoutOverviewViewport();\r\n        }));\r\n        this._register(this.modifiedEditor.onDidChangeViewZones(function () {\r\n            _this._onViewZonesChanged();\r\n        }));\r\n        this._register(this.modifiedEditor.onDidChangeConfiguration(function (e) {\r\n            if (e.fontInfo && _this.modifiedEditor.getModel()) {\r\n                _this._onViewZonesChanged();\r\n            }\r\n        }));\r\n        this._register(this.modifiedEditor.onDidChangeModelContent(function () {\r\n            if (_this._isVisible) {\r\n                _this._beginUpdateDecorationsSoon();\r\n            }\r\n        }));\r\n    };\r\n    DiffEditorWidget.prototype._createInnerEditor = function (instantiationService, container, options) {\r\n        return instantiationService.createInstance(CodeEditorWidget, container, options, {});\r\n    };\r\n    DiffEditorWidget.prototype.dispose = function () {\r\n        this._codeEditorService.removeDiffEditor(this);\r\n        if (this._beginUpdateDecorationsTimeout !== -1) {\r\n            window.clearTimeout(this._beginUpdateDecorationsTimeout);\r\n            this._beginUpdateDecorationsTimeout = -1;\r\n        }\r\n        window.clearInterval(this._measureDomElementToken);\r\n        this._cleanViewZonesAndDecorations();\r\n        if (this._originalOverviewRuler) {\r\n            this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode());\r\n            this._originalOverviewRuler.dispose();\r\n        }\r\n        if (this._modifiedOverviewRuler) {\r\n            this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode());\r\n            this._modifiedOverviewRuler.dispose();\r\n        }\r\n        this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode);\r\n        this._containerDomElement.removeChild(this._overviewDomElement);\r\n        this._containerDomElement.removeChild(this._originalDomNode);\r\n        this.originalEditor.dispose();\r\n        this._containerDomElement.removeChild(this._modifiedDomNode);\r\n        this.modifiedEditor.dispose();\r\n        this._strategy.dispose();\r\n        this._containerDomElement.removeChild(this._reviewPane.domNode.domNode);\r\n        this._containerDomElement.removeChild(this._reviewPane.shadow.domNode);\r\n        this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode);\r\n        this._reviewPane.dispose();\r\n        this._domElement.removeChild(this._containerDomElement);\r\n        this._onDidDispose.fire();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    //------------ begin IDiffEditor methods\r\n    DiffEditorWidget.prototype.getId = function () {\r\n        return this.getEditorType() + ':' + this.id;\r\n    };\r\n    DiffEditorWidget.prototype.getEditorType = function () {\r\n        return editorCommon.EditorType.IDiffEditor;\r\n    };\r\n    DiffEditorWidget.prototype.getLineChanges = function () {\r\n        if (!this._diffComputationResult) {\r\n            return null;\r\n        }\r\n        return this._diffComputationResult.changes;\r\n    };\r\n    DiffEditorWidget.prototype.getOriginalEditor = function () {\r\n        return this.originalEditor;\r\n    };\r\n    DiffEditorWidget.prototype.getModifiedEditor = function () {\r\n        return this.modifiedEditor;\r\n    };\r\n    DiffEditorWidget.prototype.updateOptions = function (newOptions) {\r\n        // Handle side by side\r\n        var renderSideBySideChanged = false;\r\n        if (typeof newOptions.renderSideBySide !== 'undefined') {\r\n            if (this._renderSideBySide !== newOptions.renderSideBySide) {\r\n                this._renderSideBySide = newOptions.renderSideBySide;\r\n                renderSideBySideChanged = true;\r\n            }\r\n        }\r\n        var beginUpdateDecorations = false;\r\n        if (typeof newOptions.ignoreTrimWhitespace !== 'undefined') {\r\n            if (this._ignoreTrimWhitespace !== newOptions.ignoreTrimWhitespace) {\r\n                this._ignoreTrimWhitespace = newOptions.ignoreTrimWhitespace;\r\n                // Begin comparing\r\n                beginUpdateDecorations = true;\r\n            }\r\n        }\r\n        if (typeof newOptions.renderIndicators !== 'undefined') {\r\n            if (this._renderIndicators !== newOptions.renderIndicators) {\r\n                this._renderIndicators = newOptions.renderIndicators;\r\n                beginUpdateDecorations = true;\r\n            }\r\n        }\r\n        if (beginUpdateDecorations) {\r\n            this._beginUpdateDecorations();\r\n        }\r\n        if (typeof newOptions.originalEditable !== 'undefined') {\r\n            this._originalIsEditable = Boolean(newOptions.originalEditable);\r\n        }\r\n        this.modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(newOptions));\r\n        this.originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(newOptions, this._originalIsEditable));\r\n        // enableSplitViewResizing\r\n        if (typeof newOptions.enableSplitViewResizing !== 'undefined') {\r\n            this._enableSplitViewResizing = newOptions.enableSplitViewResizing;\r\n        }\r\n        this._strategy.setEnableSplitViewResizing(this._enableSplitViewResizing);\r\n        // renderSideBySide\r\n        if (renderSideBySideChanged) {\r\n            if (this._renderSideBySide) {\r\n                this._setStrategy(new DiffEdtorWidgetSideBySide(this._createDataSource(), this._enableSplitViewResizing));\r\n            }\r\n            else {\r\n                this._setStrategy(new DiffEdtorWidgetInline(this._createDataSource(), this._enableSplitViewResizing));\r\n            }\r\n            // Update class name\r\n            this._containerDomElement.className = DiffEditorWidget._getClassName(this._themeService.getTheme(), this._renderSideBySide);\r\n        }\r\n    };\r\n    DiffEditorWidget.prototype.getModel = function () {\r\n        return {\r\n            original: this.originalEditor.getModel(),\r\n            modified: this.modifiedEditor.getModel()\r\n        };\r\n    };\r\n    DiffEditorWidget.prototype.setModel = function (model) {\r\n        // Guard us against partial null model\r\n        if (model && (!model.original || !model.modified)) {\r\n            throw new Error(!model.original ? 'DiffEditorWidget.setModel: Original model is null' : 'DiffEditorWidget.setModel: Modified model is null');\r\n        }\r\n        // Remove all view zones & decorations\r\n        this._cleanViewZonesAndDecorations();\r\n        // Update code editor models\r\n        this.originalEditor.setModel(model ? model.original : null);\r\n        this.modifiedEditor.setModel(model ? model.modified : null);\r\n        this._updateDecorationsRunner.cancel();\r\n        if (model) {\r\n            this.originalEditor.setScrollTop(0);\r\n            this.modifiedEditor.setScrollTop(0);\r\n        }\r\n        // Disable any diff computations that will come in\r\n        this._diffComputationResult = null;\r\n        this._diffComputationToken++;\r\n        if (model) {\r\n            this._recreateOverviewRulers();\r\n            // Begin comparing\r\n            this._beginUpdateDecorations();\r\n        }\r\n        else {\r\n            this._diffComputationResult = null;\r\n        }\r\n        this._layoutOverviewViewport();\r\n    };\r\n    DiffEditorWidget.prototype.getDomNode = function () {\r\n        return this._domElement;\r\n    };\r\n    DiffEditorWidget.prototype.getVisibleColumnFromPosition = function (position) {\r\n        return this.modifiedEditor.getVisibleColumnFromPosition(position);\r\n    };\r\n    DiffEditorWidget.prototype.getPosition = function () {\r\n        return this.modifiedEditor.getPosition();\r\n    };\r\n    DiffEditorWidget.prototype.setPosition = function (position) {\r\n        this.modifiedEditor.setPosition(position);\r\n    };\r\n    DiffEditorWidget.prototype.revealLine = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLine(lineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealLineInCenter = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLineInCenter(lineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealLineInCenterIfOutsideViewport = function (lineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLineInCenterIfOutsideViewport(lineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealPosition = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealPosition(position, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealPositionInCenter = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealPositionInCenter(position, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealPositionInCenterIfOutsideViewport = function (position, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealPositionInCenterIfOutsideViewport(position, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.getSelection = function () {\r\n        return this.modifiedEditor.getSelection();\r\n    };\r\n    DiffEditorWidget.prototype.getSelections = function () {\r\n        return this.modifiedEditor.getSelections();\r\n    };\r\n    DiffEditorWidget.prototype.setSelection = function (something) {\r\n        this.modifiedEditor.setSelection(something);\r\n    };\r\n    DiffEditorWidget.prototype.setSelections = function (ranges) {\r\n        this.modifiedEditor.setSelections(ranges);\r\n    };\r\n    DiffEditorWidget.prototype.revealLines = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLines(startLineNumber, endLineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealLinesInCenter = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLinesInCenter(startLineNumber, endLineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealLinesInCenterIfOutsideViewport = function (startLineNumber, endLineNumber, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealLinesInCenterIfOutsideViewport(startLineNumber, endLineNumber, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealRange = function (range, scrollType, revealVerticalInCenter, revealHorizontal) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        if (revealVerticalInCenter === void 0) { revealVerticalInCenter = false; }\r\n        if (revealHorizontal === void 0) { revealHorizontal = true; }\r\n        this.modifiedEditor.revealRange(range, scrollType, revealVerticalInCenter, revealHorizontal);\r\n    };\r\n    DiffEditorWidget.prototype.revealRangeInCenter = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealRangeInCenter(range, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealRangeInCenterIfOutsideViewport = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealRangeInCenterIfOutsideViewport(range, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.revealRangeAtTop = function (range, scrollType) {\r\n        if (scrollType === void 0) { scrollType = 0 /* Smooth */; }\r\n        this.modifiedEditor.revealRangeAtTop(range, scrollType);\r\n    };\r\n    DiffEditorWidget.prototype.getSupportedActions = function () {\r\n        return this.modifiedEditor.getSupportedActions();\r\n    };\r\n    DiffEditorWidget.prototype.saveViewState = function () {\r\n        var originalViewState = this.originalEditor.saveViewState();\r\n        var modifiedViewState = this.modifiedEditor.saveViewState();\r\n        return {\r\n            original: originalViewState,\r\n            modified: modifiedViewState\r\n        };\r\n    };\r\n    DiffEditorWidget.prototype.restoreViewState = function (s) {\r\n        if (s.original && s.original) {\r\n            var diffEditorState = s;\r\n            this.originalEditor.restoreViewState(diffEditorState.original);\r\n            this.modifiedEditor.restoreViewState(diffEditorState.modified);\r\n        }\r\n    };\r\n    DiffEditorWidget.prototype.layout = function (dimension) {\r\n        this._measureDomElement(false, dimension);\r\n    };\r\n    DiffEditorWidget.prototype.focus = function () {\r\n        this.modifiedEditor.focus();\r\n    };\r\n    DiffEditorWidget.prototype.hasTextFocus = function () {\r\n        return this.originalEditor.hasTextFocus() || this.modifiedEditor.hasTextFocus();\r\n    };\r\n    DiffEditorWidget.prototype.trigger = function (source, handlerId, payload) {\r\n        this.modifiedEditor.trigger(source, handlerId, payload);\r\n    };\r\n    DiffEditorWidget.prototype.changeDecorations = function (callback) {\r\n        return this.modifiedEditor.changeDecorations(callback);\r\n    };\r\n    //------------ end IDiffEditor methods\r\n    //------------ begin layouting methods\r\n    DiffEditorWidget.prototype._measureDomElement = function (forceDoLayoutCall, dimensions) {\r\n        dimensions = dimensions || {\r\n            width: this._containerDomElement.clientWidth,\r\n            height: this._containerDomElement.clientHeight\r\n        };\r\n        if (dimensions.width <= 0) {\r\n            this._width = 0;\r\n            this._height = 0;\r\n            this._reviewHeight = 0;\r\n            return;\r\n        }\r\n        if (!forceDoLayoutCall && dimensions.width === this._width && dimensions.height === this._height) {\r\n            // Nothing has changed\r\n            return;\r\n        }\r\n        this._width = dimensions.width;\r\n        this._height = dimensions.height;\r\n        this._reviewHeight = this._reviewPane.isVisible() ? this._height : 0;\r\n        this._doLayout();\r\n    };\r\n    DiffEditorWidget.prototype._layoutOverviewRulers = function () {\r\n        var freeSpace = DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH - 2 * DiffEditorWidget.ONE_OVERVIEW_WIDTH;\r\n        var layoutInfo = this.modifiedEditor.getLayoutInfo();\r\n        if (layoutInfo) {\r\n            this._originalOverviewRuler.setLayout({\r\n                top: 0,\r\n                width: DiffEditorWidget.ONE_OVERVIEW_WIDTH,\r\n                right: freeSpace + DiffEditorWidget.ONE_OVERVIEW_WIDTH,\r\n                height: (this._height - this._reviewHeight)\r\n            });\r\n            this._modifiedOverviewRuler.setLayout({\r\n                top: 0,\r\n                right: 0,\r\n                width: DiffEditorWidget.ONE_OVERVIEW_WIDTH,\r\n                height: (this._height - this._reviewHeight)\r\n            });\r\n        }\r\n    };\r\n    //------------ end layouting methods\r\n    DiffEditorWidget.prototype._onViewZonesChanged = function () {\r\n        if (this._currentlyChangingViewZones) {\r\n            return;\r\n        }\r\n        this._updateDecorationsRunner.schedule();\r\n    };\r\n    DiffEditorWidget.prototype._beginUpdateDecorationsSoon = function () {\r\n        var _this = this;\r\n        // Clear previous timeout if necessary\r\n        if (this._beginUpdateDecorationsTimeout !== -1) {\r\n            window.clearTimeout(this._beginUpdateDecorationsTimeout);\r\n            this._beginUpdateDecorationsTimeout = -1;\r\n        }\r\n        this._beginUpdateDecorationsTimeout = window.setTimeout(function () { return _this._beginUpdateDecorations(); }, DiffEditorWidget.UPDATE_DIFF_DECORATIONS_DELAY);\r\n    };\r\n    DiffEditorWidget._equals = function (a, b) {\r\n        if (!a && !b) {\r\n            return true;\r\n        }\r\n        if (!a || !b) {\r\n            return false;\r\n        }\r\n        return (a.toString() === b.toString());\r\n    };\r\n    DiffEditorWidget.prototype._beginUpdateDecorations = function () {\r\n        var _this = this;\r\n        this._beginUpdateDecorationsTimeout = -1;\r\n        var currentOriginalModel = this.originalEditor.getModel();\r\n        var currentModifiedModel = this.modifiedEditor.getModel();\r\n        if (!currentOriginalModel || !currentModifiedModel) {\r\n            return;\r\n        }\r\n        // Prevent old diff requests to come if a new request has been initiated\r\n        // The best method would be to call cancel on the Promise, but this is not\r\n        // yet supported, so using tokens for now.\r\n        this._diffComputationToken++;\r\n        var currentToken = this._diffComputationToken;\r\n        if (!this._editorWorkerService.canComputeDiff(currentOriginalModel.uri, currentModifiedModel.uri)) {\r\n            if (!DiffEditorWidget._equals(currentOriginalModel.uri, this._lastOriginalWarning)\r\n                || !DiffEditorWidget._equals(currentModifiedModel.uri, this._lastModifiedWarning)) {\r\n                this._lastOriginalWarning = currentOriginalModel.uri;\r\n                this._lastModifiedWarning = currentModifiedModel.uri;\r\n                this._notificationService.warn(nls.localize(\"diff.tooLarge\", \"Cannot compare files because one file is too large.\"));\r\n            }\r\n            return;\r\n        }\r\n        this._editorWorkerService.computeDiff(currentOriginalModel.uri, currentModifiedModel.uri, this._ignoreTrimWhitespace).then(function (result) {\r\n            if (currentToken === _this._diffComputationToken\r\n                && currentOriginalModel === _this.originalEditor.getModel()\r\n                && currentModifiedModel === _this.modifiedEditor.getModel()) {\r\n                _this._diffComputationResult = result;\r\n                _this._updateDecorationsRunner.schedule();\r\n                _this._onDidUpdateDiff.fire();\r\n            }\r\n        }, function (error) {\r\n            if (currentToken === _this._diffComputationToken\r\n                && currentOriginalModel === _this.originalEditor.getModel()\r\n                && currentModifiedModel === _this.modifiedEditor.getModel()) {\r\n                _this._diffComputationResult = null;\r\n                _this._updateDecorationsRunner.schedule();\r\n            }\r\n        });\r\n    };\r\n    DiffEditorWidget.prototype._cleanViewZonesAndDecorations = function () {\r\n        this._originalEditorState.clean(this.originalEditor);\r\n        this._modifiedEditorState.clean(this.modifiedEditor);\r\n    };\r\n    DiffEditorWidget.prototype._updateDecorations = function () {\r\n        if (!this.originalEditor.getModel() || !this.modifiedEditor.getModel()) {\r\n            return;\r\n        }\r\n        var lineChanges = (this._diffComputationResult ? this._diffComputationResult.changes : []);\r\n        var foreignOriginal = this._originalEditorState.getForeignViewZones(this.originalEditor.getWhitespaces());\r\n        var foreignModified = this._modifiedEditorState.getForeignViewZones(this.modifiedEditor.getWhitespaces());\r\n        var diffDecorations = this._strategy.getEditorsDiffDecorations(lineChanges, this._ignoreTrimWhitespace, this._renderIndicators, foreignOriginal, foreignModified, this.originalEditor, this.modifiedEditor);\r\n        try {\r\n            this._currentlyChangingViewZones = true;\r\n            this._originalEditorState.apply(this.originalEditor, this._originalOverviewRuler, diffDecorations.original, false);\r\n            this._modifiedEditorState.apply(this.modifiedEditor, this._modifiedOverviewRuler, diffDecorations.modified, true);\r\n        }\r\n        finally {\r\n            this._currentlyChangingViewZones = false;\r\n        }\r\n    };\r\n    DiffEditorWidget.prototype._adjustOptionsForSubEditor = function (options) {\r\n        var clonedOptions = objects.deepClone(options || {});\r\n        clonedOptions.inDiffEditor = true;\r\n        clonedOptions.wordWrap = 'off';\r\n        clonedOptions.wordWrapMinified = false;\r\n        clonedOptions.automaticLayout = false;\r\n        clonedOptions.scrollbar = clonedOptions.scrollbar || {};\r\n        clonedOptions.scrollbar.vertical = 'visible';\r\n        clonedOptions.folding = false;\r\n        clonedOptions.codeLens = false;\r\n        clonedOptions.fixedOverflowWidgets = true;\r\n        // clonedOptions.lineDecorationsWidth = '2ch';\r\n        if (!clonedOptions.minimap) {\r\n            clonedOptions.minimap = {};\r\n        }\r\n        clonedOptions.minimap.enabled = false;\r\n        return clonedOptions;\r\n    };\r\n    DiffEditorWidget.prototype._adjustOptionsForLeftHandSide = function (options, isEditable) {\r\n        var result = this._adjustOptionsForSubEditor(options);\r\n        result.readOnly = !isEditable;\r\n        result.overviewRulerLanes = 1;\r\n        result.extraEditorClassName = 'original-in-monaco-diff-editor';\r\n        return result;\r\n    };\r\n    DiffEditorWidget.prototype._adjustOptionsForRightHandSide = function (options) {\r\n        var result = this._adjustOptionsForSubEditor(options);\r\n        result.revealHorizontalRightPadding = editorOptions.EDITOR_DEFAULTS.viewInfo.revealHorizontalRightPadding + DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH;\r\n        result.scrollbar.verticalHasArrows = false;\r\n        result.extraEditorClassName = 'modified-in-monaco-diff-editor';\r\n        return result;\r\n    };\r\n    DiffEditorWidget.prototype.doLayout = function () {\r\n        this._measureDomElement(true);\r\n    };\r\n    DiffEditorWidget.prototype._doLayout = function () {\r\n        var splitPoint = this._strategy.layout();\r\n        this._originalDomNode.style.width = splitPoint + 'px';\r\n        this._originalDomNode.style.left = '0px';\r\n        this._modifiedDomNode.style.width = (this._width - splitPoint) + 'px';\r\n        this._modifiedDomNode.style.left = splitPoint + 'px';\r\n        this._overviewDomElement.style.top = '0px';\r\n        this._overviewDomElement.style.height = (this._height - this._reviewHeight) + 'px';\r\n        this._overviewDomElement.style.width = DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH + 'px';\r\n        this._overviewDomElement.style.left = (this._width - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH) + 'px';\r\n        this._overviewViewportDomElement.setWidth(DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH);\r\n        this._overviewViewportDomElement.setHeight(30);\r\n        this.originalEditor.layout({ width: splitPoint, height: (this._height - this._reviewHeight) });\r\n        this.modifiedEditor.layout({ width: this._width - splitPoint - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH, height: (this._height - this._reviewHeight) });\r\n        if (this._originalOverviewRuler || this._modifiedOverviewRuler) {\r\n            this._layoutOverviewRulers();\r\n        }\r\n        this._reviewPane.layout(this._height - this._reviewHeight, this._width, this._reviewHeight);\r\n        this._layoutOverviewViewport();\r\n    };\r\n    DiffEditorWidget.prototype._layoutOverviewViewport = function () {\r\n        var layout = this._computeOverviewViewport();\r\n        if (!layout) {\r\n            this._overviewViewportDomElement.setTop(0);\r\n            this._overviewViewportDomElement.setHeight(0);\r\n        }\r\n        else {\r\n            this._overviewViewportDomElement.setTop(layout.top);\r\n            this._overviewViewportDomElement.setHeight(layout.height);\r\n        }\r\n    };\r\n    DiffEditorWidget.prototype._computeOverviewViewport = function () {\r\n        var layoutInfo = this.modifiedEditor.getLayoutInfo();\r\n        if (!layoutInfo) {\r\n            return null;\r\n        }\r\n        var scrollTop = this.modifiedEditor.getScrollTop();\r\n        var scrollHeight = this.modifiedEditor.getScrollHeight();\r\n        var computedAvailableSize = Math.max(0, layoutInfo.contentHeight);\r\n        var computedRepresentableSize = Math.max(0, computedAvailableSize - 2 * 0);\r\n        var computedRatio = scrollHeight > 0 ? (computedRepresentableSize / scrollHeight) : 0;\r\n        var computedSliderSize = Math.max(0, Math.floor(layoutInfo.contentHeight * computedRatio));\r\n        var computedSliderPosition = Math.floor(scrollTop * computedRatio);\r\n        return {\r\n            height: computedSliderSize,\r\n            top: computedSliderPosition\r\n        };\r\n    };\r\n    DiffEditorWidget.prototype._createDataSource = function () {\r\n        var _this = this;\r\n        return {\r\n            getWidth: function () {\r\n                return _this._width;\r\n            },\r\n            getHeight: function () {\r\n                return (_this._height - _this._reviewHeight);\r\n            },\r\n            getContainerDomNode: function () {\r\n                return _this._containerDomElement;\r\n            },\r\n            relayoutEditors: function () {\r\n                _this._doLayout();\r\n            },\r\n            getOriginalEditor: function () {\r\n                return _this.originalEditor;\r\n            },\r\n            getModifiedEditor: function () {\r\n                return _this.modifiedEditor;\r\n            }\r\n        };\r\n    };\r\n    DiffEditorWidget.prototype._setStrategy = function (newStrategy) {\r\n        if (this._strategy) {\r\n            this._strategy.dispose();\r\n        }\r\n        this._strategy = newStrategy;\r\n        newStrategy.applyColors(this._themeService.getTheme());\r\n        if (this._diffComputationResult) {\r\n            this._updateDecorations();\r\n        }\r\n        // Just do a layout, the strategy might need it\r\n        this._measureDomElement(true);\r\n    };\r\n    DiffEditorWidget.prototype._getLineChangeAtOrBeforeLineNumber = function (lineNumber, startLineNumberExtractor) {\r\n        var lineChanges = (this._diffComputationResult ? this._diffComputationResult.changes : []);\r\n        if (lineChanges.length === 0 || lineNumber < startLineNumberExtractor(lineChanges[0])) {\r\n            // There are no changes or `lineNumber` is before the first change\r\n            return null;\r\n        }\r\n        var min = 0, max = lineChanges.length - 1;\r\n        while (min < max) {\r\n            var mid = Math.floor((min + max) / 2);\r\n            var midStart = startLineNumberExtractor(lineChanges[mid]);\r\n            var midEnd = (mid + 1 <= max ? startLineNumberExtractor(lineChanges[mid + 1]) : Number.MAX_VALUE);\r\n            if (lineNumber < midStart) {\r\n                max = mid - 1;\r\n            }\r\n            else if (lineNumber >= midEnd) {\r\n                min = mid + 1;\r\n            }\r\n            else {\r\n                // HIT!\r\n                min = mid;\r\n                max = mid;\r\n            }\r\n        }\r\n        return lineChanges[min];\r\n    };\r\n    DiffEditorWidget.prototype._getEquivalentLineForOriginalLineNumber = function (lineNumber) {\r\n        var lineChange = this._getLineChangeAtOrBeforeLineNumber(lineNumber, function (lineChange) { return lineChange.originalStartLineNumber; });\r\n        if (!lineChange) {\r\n            return lineNumber;\r\n        }\r\n        var originalEquivalentLineNumber = lineChange.originalStartLineNumber + (lineChange.originalEndLineNumber > 0 ? -1 : 0);\r\n        var modifiedEquivalentLineNumber = lineChange.modifiedStartLineNumber + (lineChange.modifiedEndLineNumber > 0 ? -1 : 0);\r\n        var lineChangeOriginalLength = (lineChange.originalEndLineNumber > 0 ? (lineChange.originalEndLineNumber - lineChange.originalStartLineNumber + 1) : 0);\r\n        var lineChangeModifiedLength = (lineChange.modifiedEndLineNumber > 0 ? (lineChange.modifiedEndLineNumber - lineChange.modifiedStartLineNumber + 1) : 0);\r\n        var delta = lineNumber - originalEquivalentLineNumber;\r\n        if (delta <= lineChangeOriginalLength) {\r\n            return modifiedEquivalentLineNumber + Math.min(delta, lineChangeModifiedLength);\r\n        }\r\n        return modifiedEquivalentLineNumber + lineChangeModifiedLength - lineChangeOriginalLength + delta;\r\n    };\r\n    DiffEditorWidget.prototype._getEquivalentLineForModifiedLineNumber = function (lineNumber) {\r\n        var lineChange = this._getLineChangeAtOrBeforeLineNumber(lineNumber, function (lineChange) { return lineChange.modifiedStartLineNumber; });\r\n        if (!lineChange) {\r\n            return lineNumber;\r\n        }\r\n        var originalEquivalentLineNumber = lineChange.originalStartLineNumber + (lineChange.originalEndLineNumber > 0 ? -1 : 0);\r\n        var modifiedEquivalentLineNumber = lineChange.modifiedStartLineNumber + (lineChange.modifiedEndLineNumber > 0 ? -1 : 0);\r\n        var lineChangeOriginalLength = (lineChange.originalEndLineNumber > 0 ? (lineChange.originalEndLineNumber - lineChange.originalStartLineNumber + 1) : 0);\r\n        var lineChangeModifiedLength = (lineChange.modifiedEndLineNumber > 0 ? (lineChange.modifiedEndLineNumber - lineChange.modifiedStartLineNumber + 1) : 0);\r\n        var delta = lineNumber - modifiedEquivalentLineNumber;\r\n        if (delta <= lineChangeModifiedLength) {\r\n            return originalEquivalentLineNumber + Math.min(delta, lineChangeOriginalLength);\r\n        }\r\n        return originalEquivalentLineNumber + lineChangeOriginalLength - lineChangeModifiedLength + delta;\r\n    };\r\n    DiffEditorWidget.prototype.getDiffLineInformationForOriginal = function (lineNumber) {\r\n        if (!this._diffComputationResult) {\r\n            // Cannot answer that which I don't know\r\n            return null;\r\n        }\r\n        return {\r\n            equivalentLineNumber: this._getEquivalentLineForOriginalLineNumber(lineNumber)\r\n        };\r\n    };\r\n    DiffEditorWidget.prototype.getDiffLineInformationForModified = function (lineNumber) {\r\n        if (!this._diffComputationResult) {\r\n            // Cannot answer that which I don't know\r\n            return null;\r\n        }\r\n        return {\r\n            equivalentLineNumber: this._getEquivalentLineForModifiedLineNumber(lineNumber)\r\n        };\r\n    };\r\n    DiffEditorWidget.ONE_OVERVIEW_WIDTH = 15;\r\n    DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH = 30;\r\n    DiffEditorWidget.UPDATE_DIFF_DECORATIONS_DELAY = 200; // ms\r\n    DiffEditorWidget = __decorate([\r\n        __param(2, IEditorWorkerService),\r\n        __param(3, IContextKeyService),\r\n        __param(4, IInstantiationService),\r\n        __param(5, ICodeEditorService),\r\n        __param(6, IThemeService),\r\n        __param(7, INotificationService)\r\n    ], DiffEditorWidget);\r\n    return DiffEditorWidget;\r\n}(Disposable));\r\nexport { DiffEditorWidget };\r\nvar DiffEditorWidgetStyle = /** @class */ (function (_super) {\r\n    __extends(DiffEditorWidgetStyle, _super);\r\n    function DiffEditorWidgetStyle(dataSource) {\r\n        var _this = _super.call(this) || this;\r\n        _this._dataSource = dataSource;\r\n        return _this;\r\n    }\r\n    DiffEditorWidgetStyle.prototype.applyColors = function (theme) {\r\n        var newInsertColor = (theme.getColor(diffInserted) || defaultInsertColor).transparent(2);\r\n        var newRemoveColor = (theme.getColor(diffRemoved) || defaultRemoveColor).transparent(2);\r\n        var hasChanges = !newInsertColor.equals(this._insertColor) || !newRemoveColor.equals(this._removeColor);\r\n        this._insertColor = newInsertColor;\r\n        this._removeColor = newRemoveColor;\r\n        return hasChanges;\r\n    };\r\n    DiffEditorWidgetStyle.prototype.getEditorsDiffDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalWhitespaces, modifiedWhitespaces, originalEditor, modifiedEditor) {\r\n        // Get view zones\r\n        modifiedWhitespaces = modifiedWhitespaces.sort(function (a, b) {\r\n            return a.afterLineNumber - b.afterLineNumber;\r\n        });\r\n        originalWhitespaces = originalWhitespaces.sort(function (a, b) {\r\n            return a.afterLineNumber - b.afterLineNumber;\r\n        });\r\n        var zones = this._getViewZones(lineChanges, originalWhitespaces, modifiedWhitespaces, originalEditor, modifiedEditor, renderIndicators);\r\n        // Get decorations & overview ruler zones\r\n        var originalDecorations = this._getOriginalEditorDecorations(lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor);\r\n        var modifiedDecorations = this._getModifiedEditorDecorations(lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor);\r\n        return {\r\n            original: {\r\n                decorations: originalDecorations.decorations,\r\n                overviewZones: originalDecorations.overviewZones,\r\n                zones: zones.original\r\n            },\r\n            modified: {\r\n                decorations: modifiedDecorations.decorations,\r\n                overviewZones: modifiedDecorations.overviewZones,\r\n                zones: zones.modified\r\n            }\r\n        };\r\n    };\r\n    return DiffEditorWidgetStyle;\r\n}(Disposable));\r\nvar ForeignViewZonesIterator = /** @class */ (function () {\r\n    function ForeignViewZonesIterator(source) {\r\n        this._source = source;\r\n        this._index = -1;\r\n        this.advance();\r\n    }\r\n    ForeignViewZonesIterator.prototype.advance = function () {\r\n        this._index++;\r\n        if (this._index < this._source.length) {\r\n            this.current = this._source[this._index];\r\n        }\r\n        else {\r\n            this.current = null;\r\n        }\r\n    };\r\n    return ForeignViewZonesIterator;\r\n}());\r\nvar ViewZonesComputer = /** @class */ (function () {\r\n    function ViewZonesComputer(lineChanges, originalForeignVZ, modifiedForeignVZ) {\r\n        this.lineChanges = lineChanges;\r\n        this.originalForeignVZ = originalForeignVZ;\r\n        this.modifiedForeignVZ = modifiedForeignVZ;\r\n    }\r\n    ViewZonesComputer.prototype.getViewZones = function () {\r\n        var result = {\r\n            original: [],\r\n            modified: []\r\n        };\r\n        var lineChangeModifiedLength = 0;\r\n        var lineChangeOriginalLength = 0;\r\n        var originalEquivalentLineNumber = 0;\r\n        var modifiedEquivalentLineNumber = 0;\r\n        var originalEndEquivalentLineNumber = 0;\r\n        var modifiedEndEquivalentLineNumber = 0;\r\n        var sortMyViewZones = function (a, b) {\r\n            return a.afterLineNumber - b.afterLineNumber;\r\n        };\r\n        var addAndCombineIfPossible = function (destination, item) {\r\n            if (item.domNode === null && destination.length > 0) {\r\n                var lastItem = destination[destination.length - 1];\r\n                if (lastItem.afterLineNumber === item.afterLineNumber && lastItem.domNode === null) {\r\n                    lastItem.heightInLines += item.heightInLines;\r\n                    return;\r\n                }\r\n            }\r\n            destination.push(item);\r\n        };\r\n        var modifiedForeignVZ = new ForeignViewZonesIterator(this.modifiedForeignVZ);\r\n        var originalForeignVZ = new ForeignViewZonesIterator(this.originalForeignVZ);\r\n        // In order to include foreign view zones after the last line change, the for loop will iterate once more after the end of the `lineChanges` array\r\n        for (var i = 0, length_4 = this.lineChanges.length; i <= length_4; i++) {\r\n            var lineChange = (i < length_4 ? this.lineChanges[i] : null);\r\n            if (lineChange !== null) {\r\n                originalEquivalentLineNumber = lineChange.originalStartLineNumber + (lineChange.originalEndLineNumber > 0 ? -1 : 0);\r\n                modifiedEquivalentLineNumber = lineChange.modifiedStartLineNumber + (lineChange.modifiedEndLineNumber > 0 ? -1 : 0);\r\n                lineChangeOriginalLength = (lineChange.originalEndLineNumber > 0 ? (lineChange.originalEndLineNumber - lineChange.originalStartLineNumber + 1) : 0);\r\n                lineChangeModifiedLength = (lineChange.modifiedEndLineNumber > 0 ? (lineChange.modifiedEndLineNumber - lineChange.modifiedStartLineNumber + 1) : 0);\r\n                originalEndEquivalentLineNumber = Math.max(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber);\r\n                modifiedEndEquivalentLineNumber = Math.max(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber);\r\n            }\r\n            else {\r\n                // Increase to very large value to get the producing tests of foreign view zones running\r\n                originalEquivalentLineNumber += 10000000 + lineChangeOriginalLength;\r\n                modifiedEquivalentLineNumber += 10000000 + lineChangeModifiedLength;\r\n                originalEndEquivalentLineNumber = originalEquivalentLineNumber;\r\n                modifiedEndEquivalentLineNumber = modifiedEquivalentLineNumber;\r\n            }\r\n            // Each step produces view zones, and after producing them, we try to cancel them out, to avoid empty-empty view zone cases\r\n            var stepOriginal = [];\r\n            var stepModified = [];\r\n            // ---------------------------- PRODUCE VIEW ZONES\r\n            // [PRODUCE] View zone(s) in original-side due to foreign view zone(s) in modified-side\r\n            while (modifiedForeignVZ.current && modifiedForeignVZ.current.afterLineNumber <= modifiedEndEquivalentLineNumber) {\r\n                var viewZoneLineNumber = void 0;\r\n                if (modifiedForeignVZ.current.afterLineNumber <= modifiedEquivalentLineNumber) {\r\n                    viewZoneLineNumber = originalEquivalentLineNumber - modifiedEquivalentLineNumber + modifiedForeignVZ.current.afterLineNumber;\r\n                }\r\n                else {\r\n                    viewZoneLineNumber = originalEndEquivalentLineNumber;\r\n                }\r\n                var marginDomNode = null;\r\n                if (lineChange && lineChange.modifiedStartLineNumber <= modifiedForeignVZ.current.afterLineNumber && modifiedForeignVZ.current.afterLineNumber <= lineChange.modifiedEndLineNumber) {\r\n                    marginDomNode = this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion();\r\n                }\r\n                stepOriginal.push({\r\n                    afterLineNumber: viewZoneLineNumber,\r\n                    heightInLines: modifiedForeignVZ.current.heightInLines,\r\n                    domNode: null,\r\n                    marginDomNode: marginDomNode\r\n                });\r\n                modifiedForeignVZ.advance();\r\n            }\r\n            // [PRODUCE] View zone(s) in modified-side due to foreign view zone(s) in original-side\r\n            while (originalForeignVZ.current && originalForeignVZ.current.afterLineNumber <= originalEndEquivalentLineNumber) {\r\n                var viewZoneLineNumber = void 0;\r\n                if (originalForeignVZ.current.afterLineNumber <= originalEquivalentLineNumber) {\r\n                    viewZoneLineNumber = modifiedEquivalentLineNumber - originalEquivalentLineNumber + originalForeignVZ.current.afterLineNumber;\r\n                }\r\n                else {\r\n                    viewZoneLineNumber = modifiedEndEquivalentLineNumber;\r\n                }\r\n                stepModified.push({\r\n                    afterLineNumber: viewZoneLineNumber,\r\n                    heightInLines: originalForeignVZ.current.heightInLines,\r\n                    domNode: null\r\n                });\r\n                originalForeignVZ.advance();\r\n            }\r\n            if (lineChange !== null && isChangeOrInsert(lineChange)) {\r\n                var r = this._produceOriginalFromDiff(lineChange, lineChangeOriginalLength, lineChangeModifiedLength);\r\n                if (r) {\r\n                    stepOriginal.push(r);\r\n                }\r\n            }\r\n            if (lineChange !== null && isChangeOrDelete(lineChange)) {\r\n                var r = this._produceModifiedFromDiff(lineChange, lineChangeOriginalLength, lineChangeModifiedLength);\r\n                if (r) {\r\n                    stepModified.push(r);\r\n                }\r\n            }\r\n            // ---------------------------- END PRODUCE VIEW ZONES\r\n            // ---------------------------- EMIT MINIMAL VIEW ZONES\r\n            // [CANCEL & EMIT] Try to cancel view zones out\r\n            var stepOriginalIndex = 0;\r\n            var stepModifiedIndex = 0;\r\n            stepOriginal = stepOriginal.sort(sortMyViewZones);\r\n            stepModified = stepModified.sort(sortMyViewZones);\r\n            while (stepOriginalIndex < stepOriginal.length && stepModifiedIndex < stepModified.length) {\r\n                var original = stepOriginal[stepOriginalIndex];\r\n                var modified = stepModified[stepModifiedIndex];\r\n                var originalDelta = original.afterLineNumber - originalEquivalentLineNumber;\r\n                var modifiedDelta = modified.afterLineNumber - modifiedEquivalentLineNumber;\r\n                if (originalDelta < modifiedDelta) {\r\n                    addAndCombineIfPossible(result.original, original);\r\n                    stepOriginalIndex++;\r\n                }\r\n                else if (modifiedDelta < originalDelta) {\r\n                    addAndCombineIfPossible(result.modified, modified);\r\n                    stepModifiedIndex++;\r\n                }\r\n                else if (original.shouldNotShrink) {\r\n                    addAndCombineIfPossible(result.original, original);\r\n                    stepOriginalIndex++;\r\n                }\r\n                else if (modified.shouldNotShrink) {\r\n                    addAndCombineIfPossible(result.modified, modified);\r\n                    stepModifiedIndex++;\r\n                }\r\n                else {\r\n                    if (original.heightInLines >= modified.heightInLines) {\r\n                        // modified view zone gets removed\r\n                        original.heightInLines -= modified.heightInLines;\r\n                        stepModifiedIndex++;\r\n                    }\r\n                    else {\r\n                        // original view zone gets removed\r\n                        modified.heightInLines -= original.heightInLines;\r\n                        stepOriginalIndex++;\r\n                    }\r\n                }\r\n            }\r\n            // [EMIT] Remaining original view zones\r\n            while (stepOriginalIndex < stepOriginal.length) {\r\n                addAndCombineIfPossible(result.original, stepOriginal[stepOriginalIndex]);\r\n                stepOriginalIndex++;\r\n            }\r\n            // [EMIT] Remaining modified view zones\r\n            while (stepModifiedIndex < stepModified.length) {\r\n                addAndCombineIfPossible(result.modified, stepModified[stepModifiedIndex]);\r\n                stepModifiedIndex++;\r\n            }\r\n            // ---------------------------- END EMIT MINIMAL VIEW ZONES\r\n        }\r\n        var ensureDomNode = function (z) {\r\n            if (!z.domNode) {\r\n                z.domNode = createFakeLinesDiv();\r\n            }\r\n        };\r\n        result.original.forEach(ensureDomNode);\r\n        result.modified.forEach(ensureDomNode);\r\n        return result;\r\n    };\r\n    return ViewZonesComputer;\r\n}());\r\nfunction createDecoration(startLineNumber, startColumn, endLineNumber, endColumn, options) {\r\n    return {\r\n        range: new Range(startLineNumber, startColumn, endLineNumber, endColumn),\r\n        options: options\r\n    };\r\n}\r\nvar DECORATIONS = {\r\n    charDelete: ModelDecorationOptions.register({\r\n        className: 'char-delete'\r\n    }),\r\n    charDeleteWholeLine: ModelDecorationOptions.register({\r\n        className: 'char-delete',\r\n        isWholeLine: true\r\n    }),\r\n    charInsert: ModelDecorationOptions.register({\r\n        className: 'char-insert'\r\n    }),\r\n    charInsertWholeLine: ModelDecorationOptions.register({\r\n        className: 'char-insert',\r\n        isWholeLine: true\r\n    }),\r\n    lineInsert: ModelDecorationOptions.register({\r\n        className: 'line-insert',\r\n        marginClassName: 'line-insert',\r\n        isWholeLine: true\r\n    }),\r\n    lineInsertWithSign: ModelDecorationOptions.register({\r\n        className: 'line-insert',\r\n        linesDecorationsClassName: 'insert-sign',\r\n        marginClassName: 'line-insert',\r\n        isWholeLine: true\r\n    }),\r\n    lineDelete: ModelDecorationOptions.register({\r\n        className: 'line-delete',\r\n        marginClassName: 'line-delete',\r\n        isWholeLine: true\r\n    }),\r\n    lineDeleteWithSign: ModelDecorationOptions.register({\r\n        className: 'line-delete',\r\n        linesDecorationsClassName: 'delete-sign',\r\n        marginClassName: 'line-delete',\r\n        isWholeLine: true\r\n    }),\r\n    lineDeleteMargin: ModelDecorationOptions.register({\r\n        marginClassName: 'line-delete',\r\n    })\r\n};\r\nvar DiffEdtorWidgetSideBySide = /** @class */ (function (_super) {\r\n    __extends(DiffEdtorWidgetSideBySide, _super);\r\n    function DiffEdtorWidgetSideBySide(dataSource, enableSplitViewResizing) {\r\n        var _this = _super.call(this, dataSource) || this;\r\n        _this._disableSash = (enableSplitViewResizing === false);\r\n        _this._sashRatio = null;\r\n        _this._sashPosition = null;\r\n        _this._sash = _this._register(new Sash(_this._dataSource.getContainerDomNode(), _this));\r\n        if (_this._disableSash) {\r\n            _this._sash.state = 0 /* Disabled */;\r\n        }\r\n        _this._sash.onDidStart(function () { return _this.onSashDragStart(); });\r\n        _this._sash.onDidChange(function (e) { return _this.onSashDrag(e); });\r\n        _this._sash.onDidEnd(function () { return _this.onSashDragEnd(); });\r\n        _this._sash.onDidReset(function () { return _this.onSashReset(); });\r\n        return _this;\r\n    }\r\n    DiffEdtorWidgetSideBySide.prototype.setEnableSplitViewResizing = function (enableSplitViewResizing) {\r\n        var newDisableSash = (enableSplitViewResizing === false);\r\n        if (this._disableSash !== newDisableSash) {\r\n            this._disableSash = newDisableSash;\r\n            this._sash.state = this._disableSash ? 0 /* Disabled */ : 3 /* Enabled */;\r\n        }\r\n    };\r\n    DiffEdtorWidgetSideBySide.prototype.layout = function (sashRatio) {\r\n        if (sashRatio === void 0) { sashRatio = this._sashRatio; }\r\n        var w = this._dataSource.getWidth();\r\n        var contentWidth = w - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH;\r\n        var sashPosition = Math.floor((sashRatio || 0.5) * contentWidth);\r\n        var midPoint = Math.floor(0.5 * contentWidth);\r\n        sashPosition = this._disableSash ? midPoint : sashPosition || midPoint;\r\n        if (contentWidth > DiffEdtorWidgetSideBySide.MINIMUM_EDITOR_WIDTH * 2) {\r\n            if (sashPosition < DiffEdtorWidgetSideBySide.MINIMUM_EDITOR_WIDTH) {\r\n                sashPosition = DiffEdtorWidgetSideBySide.MINIMUM_EDITOR_WIDTH;\r\n            }\r\n            if (sashPosition > contentWidth - DiffEdtorWidgetSideBySide.MINIMUM_EDITOR_WIDTH) {\r\n                sashPosition = contentWidth - DiffEdtorWidgetSideBySide.MINIMUM_EDITOR_WIDTH;\r\n            }\r\n        }\r\n        else {\r\n            sashPosition = midPoint;\r\n        }\r\n        if (this._sashPosition !== sashPosition) {\r\n            this._sashPosition = sashPosition;\r\n            this._sash.layout();\r\n        }\r\n        return this._sashPosition;\r\n    };\r\n    DiffEdtorWidgetSideBySide.prototype.onSashDragStart = function () {\r\n        this._startSashPosition = this._sashPosition;\r\n    };\r\n    DiffEdtorWidgetSideBySide.prototype.onSashDrag = function (e) {\r\n        var w = this._dataSource.getWidth();\r\n        var contentWidth = w - DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH;\r\n        var sashPosition = this.layout((this._startSashPosition + (e.currentX - e.startX)) / contentWidth);\r\n        this._sashRatio = sashPosition / contentWidth;\r\n        this._dataSource.relayoutEditors();\r\n    };\r\n    DiffEdtorWidgetSideBySide.prototype.onSashDragEnd = function () {\r\n        this._sash.layout();\r\n    };\r\n    DiffEdtorWidgetSideBySide.prototype.onSashReset = function () {\r\n        this._sashRatio = 0.5;\r\n        this._dataSource.relayoutEditors();\r\n        this._sash.layout();\r\n    };\r\n    DiffEdtorWidgetSideBySide.prototype.getVerticalSashTop = function (sash) {\r\n        return 0;\r\n    };\r\n    DiffEdtorWidgetSideBySide.prototype.getVerticalSashLeft = function (sash) {\r\n        return this._sashPosition;\r\n    };\r\n    DiffEdtorWidgetSideBySide.prototype.getVerticalSashHeight = function (sash) {\r\n        return this._dataSource.getHeight();\r\n    };\r\n    DiffEdtorWidgetSideBySide.prototype._getViewZones = function (lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor) {\r\n        var c = new SideBySideViewZonesComputer(lineChanges, originalForeignVZ, modifiedForeignVZ);\r\n        return c.getViewZones();\r\n    };\r\n    DiffEdtorWidgetSideBySide.prototype._getOriginalEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\r\n        var overviewZoneColor = this._removeColor.toString();\r\n        var result = {\r\n            decorations: [],\r\n            overviewZones: []\r\n        };\r\n        var originalModel = originalEditor.getModel();\r\n        for (var i = 0, length_5 = lineChanges.length; i < length_5; i++) {\r\n            var lineChange = lineChanges[i];\r\n            if (isChangeOrDelete(lineChange)) {\r\n                result.decorations.push({\r\n                    range: new Range(lineChange.originalStartLineNumber, 1, lineChange.originalEndLineNumber, Number.MAX_VALUE),\r\n                    options: (renderIndicators ? DECORATIONS.lineDeleteWithSign : DECORATIONS.lineDelete)\r\n                });\r\n                if (!isChangeOrInsert(lineChange) || !lineChange.charChanges) {\r\n                    result.decorations.push(createDecoration(lineChange.originalStartLineNumber, 1, lineChange.originalEndLineNumber, Number.MAX_VALUE, DECORATIONS.charDeleteWholeLine));\r\n                }\r\n                result.overviewZones.push(new OverviewRulerZone(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber, overviewZoneColor));\r\n                if (lineChange.charChanges) {\r\n                    for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\r\n                        var charChange = lineChange.charChanges[j];\r\n                        if (isChangeOrDelete(charChange)) {\r\n                            if (ignoreTrimWhitespace) {\r\n                                for (var lineNumber = charChange.originalStartLineNumber; lineNumber <= charChange.originalEndLineNumber; lineNumber++) {\r\n                                    var startColumn = void 0;\r\n                                    var endColumn = void 0;\r\n                                    if (lineNumber === charChange.originalStartLineNumber) {\r\n                                        startColumn = charChange.originalStartColumn;\r\n                                    }\r\n                                    else {\r\n                                        startColumn = originalModel.getLineFirstNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    if (lineNumber === charChange.originalEndLineNumber) {\r\n                                        endColumn = charChange.originalEndColumn;\r\n                                    }\r\n                                    else {\r\n                                        endColumn = originalModel.getLineLastNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    result.decorations.push(createDecoration(lineNumber, startColumn, lineNumber, endColumn, DECORATIONS.charDelete));\r\n                                }\r\n                            }\r\n                            else {\r\n                                result.decorations.push(createDecoration(charChange.originalStartLineNumber, charChange.originalStartColumn, charChange.originalEndLineNumber, charChange.originalEndColumn, DECORATIONS.charDelete));\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    DiffEdtorWidgetSideBySide.prototype._getModifiedEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\r\n        var overviewZoneColor = this._insertColor.toString();\r\n        var result = {\r\n            decorations: [],\r\n            overviewZones: []\r\n        };\r\n        var modifiedModel = modifiedEditor.getModel();\r\n        for (var i = 0, length_6 = lineChanges.length; i < length_6; i++) {\r\n            var lineChange = lineChanges[i];\r\n            if (isChangeOrInsert(lineChange)) {\r\n                result.decorations.push({\r\n                    range: new Range(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, Number.MAX_VALUE),\r\n                    options: (renderIndicators ? DECORATIONS.lineInsertWithSign : DECORATIONS.lineInsert)\r\n                });\r\n                if (!isChangeOrDelete(lineChange) || !lineChange.charChanges) {\r\n                    result.decorations.push(createDecoration(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, Number.MAX_VALUE, DECORATIONS.charInsertWholeLine));\r\n                }\r\n                result.overviewZones.push(new OverviewRulerZone(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber, overviewZoneColor));\r\n                if (lineChange.charChanges) {\r\n                    for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\r\n                        var charChange = lineChange.charChanges[j];\r\n                        if (isChangeOrInsert(charChange)) {\r\n                            if (ignoreTrimWhitespace) {\r\n                                for (var lineNumber = charChange.modifiedStartLineNumber; lineNumber <= charChange.modifiedEndLineNumber; lineNumber++) {\r\n                                    var startColumn = void 0;\r\n                                    var endColumn = void 0;\r\n                                    if (lineNumber === charChange.modifiedStartLineNumber) {\r\n                                        startColumn = charChange.modifiedStartColumn;\r\n                                    }\r\n                                    else {\r\n                                        startColumn = modifiedModel.getLineFirstNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    if (lineNumber === charChange.modifiedEndLineNumber) {\r\n                                        endColumn = charChange.modifiedEndColumn;\r\n                                    }\r\n                                    else {\r\n                                        endColumn = modifiedModel.getLineLastNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    result.decorations.push(createDecoration(lineNumber, startColumn, lineNumber, endColumn, DECORATIONS.charInsert));\r\n                                }\r\n                            }\r\n                            else {\r\n                                result.decorations.push(createDecoration(charChange.modifiedStartLineNumber, charChange.modifiedStartColumn, charChange.modifiedEndLineNumber, charChange.modifiedEndColumn, DECORATIONS.charInsert));\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    DiffEdtorWidgetSideBySide.MINIMUM_EDITOR_WIDTH = 100;\r\n    return DiffEdtorWidgetSideBySide;\r\n}(DiffEditorWidgetStyle));\r\nvar SideBySideViewZonesComputer = /** @class */ (function (_super) {\r\n    __extends(SideBySideViewZonesComputer, _super);\r\n    function SideBySideViewZonesComputer(lineChanges, originalForeignVZ, modifiedForeignVZ) {\r\n        return _super.call(this, lineChanges, originalForeignVZ, modifiedForeignVZ) || this;\r\n    }\r\n    SideBySideViewZonesComputer.prototype._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion = function () {\r\n        return null;\r\n    };\r\n    SideBySideViewZonesComputer.prototype._produceOriginalFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\r\n        if (lineChangeModifiedLength > lineChangeOriginalLength) {\r\n            return {\r\n                afterLineNumber: Math.max(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber),\r\n                heightInLines: (lineChangeModifiedLength - lineChangeOriginalLength),\r\n                domNode: null\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    SideBySideViewZonesComputer.prototype._produceModifiedFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\r\n        if (lineChangeOriginalLength > lineChangeModifiedLength) {\r\n            return {\r\n                afterLineNumber: Math.max(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber),\r\n                heightInLines: (lineChangeOriginalLength - lineChangeModifiedLength),\r\n                domNode: null\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    return SideBySideViewZonesComputer;\r\n}(ViewZonesComputer));\r\nvar DiffEdtorWidgetInline = /** @class */ (function (_super) {\r\n    __extends(DiffEdtorWidgetInline, _super);\r\n    function DiffEdtorWidgetInline(dataSource, enableSplitViewResizing) {\r\n        var _this = _super.call(this, dataSource) || this;\r\n        _this.decorationsLeft = dataSource.getOriginalEditor().getLayoutInfo().decorationsLeft;\r\n        _this._register(dataSource.getOriginalEditor().onDidLayoutChange(function (layoutInfo) {\r\n            if (_this.decorationsLeft !== layoutInfo.decorationsLeft) {\r\n                _this.decorationsLeft = layoutInfo.decorationsLeft;\r\n                dataSource.relayoutEditors();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    DiffEdtorWidgetInline.prototype.setEnableSplitViewResizing = function (enableSplitViewResizing) {\r\n        // Nothing to do..\r\n    };\r\n    DiffEdtorWidgetInline.prototype._getViewZones = function (lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor, renderIndicators) {\r\n        var computer = new InlineViewZonesComputer(lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor, renderIndicators);\r\n        return computer.getViewZones();\r\n    };\r\n    DiffEdtorWidgetInline.prototype._getOriginalEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\r\n        var overviewZoneColor = this._removeColor.toString();\r\n        var result = {\r\n            decorations: [],\r\n            overviewZones: []\r\n        };\r\n        for (var i = 0, length_7 = lineChanges.length; i < length_7; i++) {\r\n            var lineChange = lineChanges[i];\r\n            // Add overview zones in the overview ruler\r\n            if (isChangeOrDelete(lineChange)) {\r\n                result.decorations.push({\r\n                    range: new Range(lineChange.originalStartLineNumber, 1, lineChange.originalEndLineNumber, Number.MAX_VALUE),\r\n                    options: DECORATIONS.lineDeleteMargin\r\n                });\r\n                result.overviewZones.push(new OverviewRulerZone(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber, overviewZoneColor));\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    DiffEdtorWidgetInline.prototype._getModifiedEditorDecorations = function (lineChanges, ignoreTrimWhitespace, renderIndicators, originalEditor, modifiedEditor) {\r\n        var overviewZoneColor = this._insertColor.toString();\r\n        var result = {\r\n            decorations: [],\r\n            overviewZones: []\r\n        };\r\n        var modifiedModel = modifiedEditor.getModel();\r\n        for (var i = 0, length_8 = lineChanges.length; i < length_8; i++) {\r\n            var lineChange = lineChanges[i];\r\n            // Add decorations & overview zones\r\n            if (isChangeOrInsert(lineChange)) {\r\n                result.decorations.push({\r\n                    range: new Range(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, Number.MAX_VALUE),\r\n                    options: (renderIndicators ? DECORATIONS.lineInsertWithSign : DECORATIONS.lineInsert)\r\n                });\r\n                result.overviewZones.push(new OverviewRulerZone(lineChange.modifiedStartLineNumber, lineChange.modifiedEndLineNumber, overviewZoneColor));\r\n                if (lineChange.charChanges) {\r\n                    for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\r\n                        var charChange = lineChange.charChanges[j];\r\n                        if (isChangeOrInsert(charChange)) {\r\n                            if (ignoreTrimWhitespace) {\r\n                                for (var lineNumber = charChange.modifiedStartLineNumber; lineNumber <= charChange.modifiedEndLineNumber; lineNumber++) {\r\n                                    var startColumn = void 0;\r\n                                    var endColumn = void 0;\r\n                                    if (lineNumber === charChange.modifiedStartLineNumber) {\r\n                                        startColumn = charChange.modifiedStartColumn;\r\n                                    }\r\n                                    else {\r\n                                        startColumn = modifiedModel.getLineFirstNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    if (lineNumber === charChange.modifiedEndLineNumber) {\r\n                                        endColumn = charChange.modifiedEndColumn;\r\n                                    }\r\n                                    else {\r\n                                        endColumn = modifiedModel.getLineLastNonWhitespaceColumn(lineNumber);\r\n                                    }\r\n                                    result.decorations.push(createDecoration(lineNumber, startColumn, lineNumber, endColumn, DECORATIONS.charInsert));\r\n                                }\r\n                            }\r\n                            else {\r\n                                result.decorations.push(createDecoration(charChange.modifiedStartLineNumber, charChange.modifiedStartColumn, charChange.modifiedEndLineNumber, charChange.modifiedEndColumn, DECORATIONS.charInsert));\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    result.decorations.push(createDecoration(lineChange.modifiedStartLineNumber, 1, lineChange.modifiedEndLineNumber, Number.MAX_VALUE, DECORATIONS.charInsertWholeLine));\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    DiffEdtorWidgetInline.prototype.layout = function () {\r\n        // An editor should not be smaller than 5px\r\n        return Math.max(5, this.decorationsLeft);\r\n    };\r\n    return DiffEdtorWidgetInline;\r\n}(DiffEditorWidgetStyle));\r\nvar InlineViewZonesComputer = /** @class */ (function (_super) {\r\n    __extends(InlineViewZonesComputer, _super);\r\n    function InlineViewZonesComputer(lineChanges, originalForeignVZ, modifiedForeignVZ, originalEditor, modifiedEditor, renderIndicators) {\r\n        var _this = _super.call(this, lineChanges, originalForeignVZ, modifiedForeignVZ) || this;\r\n        _this.originalModel = originalEditor.getModel();\r\n        _this.modifiedEditorConfiguration = modifiedEditor.getConfiguration();\r\n        _this.modifiedEditorTabSize = modifiedEditor.getModel().getOptions().tabSize;\r\n        _this.renderIndicators = renderIndicators;\r\n        return _this;\r\n    }\r\n    InlineViewZonesComputer.prototype._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion = function () {\r\n        var result = document.createElement('div');\r\n        result.className = 'inline-added-margin-view-zone';\r\n        return result;\r\n    };\r\n    InlineViewZonesComputer.prototype._produceOriginalFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\r\n        var marginDomNode = document.createElement('div');\r\n        marginDomNode.className = 'inline-added-margin-view-zone';\r\n        return {\r\n            afterLineNumber: Math.max(lineChange.originalStartLineNumber, lineChange.originalEndLineNumber),\r\n            heightInLines: lineChangeModifiedLength,\r\n            domNode: document.createElement('div'),\r\n            marginDomNode: marginDomNode\r\n        };\r\n    };\r\n    InlineViewZonesComputer.prototype._produceModifiedFromDiff = function (lineChange, lineChangeOriginalLength, lineChangeModifiedLength) {\r\n        var decorations = [];\r\n        if (lineChange.charChanges) {\r\n            for (var j = 0, lengthJ = lineChange.charChanges.length; j < lengthJ; j++) {\r\n                var charChange = lineChange.charChanges[j];\r\n                if (isChangeOrDelete(charChange)) {\r\n                    decorations.push(new InlineDecoration(new Range(charChange.originalStartLineNumber, charChange.originalStartColumn, charChange.originalEndLineNumber, charChange.originalEndColumn), 'char-delete', 0 /* Regular */));\r\n                }\r\n            }\r\n        }\r\n        var sb = createStringBuilder(10000);\r\n        var marginHTML = [];\r\n        var lineDecorationsWidth = this.modifiedEditorConfiguration.layoutInfo.decorationsWidth;\r\n        var lineHeight = this.modifiedEditorConfiguration.lineHeight;\r\n        var typicalHalfwidthCharacterWidth = this.modifiedEditorConfiguration.fontInfo.typicalHalfwidthCharacterWidth;\r\n        var maxCharsPerLine = 0;\r\n        for (var lineNumber = lineChange.originalStartLineNumber; lineNumber <= lineChange.originalEndLineNumber; lineNumber++) {\r\n            maxCharsPerLine = Math.max(maxCharsPerLine, this._renderOriginalLine(lineNumber - lineChange.originalStartLineNumber, this.originalModel, this.modifiedEditorConfiguration, this.modifiedEditorTabSize, lineNumber, decorations, sb));\r\n            if (this.renderIndicators) {\r\n                var index = lineNumber - lineChange.originalStartLineNumber;\r\n                marginHTML = marginHTML.concat([\r\n                    \"<div class=\\\"delete-sign\\\" style=\\\"position:absolute;top:\" + index * lineHeight + \"px;width:\" + lineDecorationsWidth + \"px;height:\" + lineHeight + \"px;right:0;\\\"></div>\"\r\n                ]);\r\n            }\r\n        }\r\n        maxCharsPerLine += this.modifiedEditorConfiguration.viewInfo.scrollBeyondLastColumn;\r\n        var domNode = document.createElement('div');\r\n        domNode.className = 'view-lines line-delete';\r\n        domNode.innerHTML = sb.build();\r\n        Configuration.applyFontInfoSlow(domNode, this.modifiedEditorConfiguration.fontInfo);\r\n        var marginDomNode = document.createElement('div');\r\n        marginDomNode.className = 'inline-deleted-margin-view-zone';\r\n        marginDomNode.innerHTML = marginHTML.join('');\r\n        Configuration.applyFontInfoSlow(marginDomNode, this.modifiedEditorConfiguration.fontInfo);\r\n        return {\r\n            shouldNotShrink: true,\r\n            afterLineNumber: (lineChange.modifiedEndLineNumber === 0 ? lineChange.modifiedStartLineNumber : lineChange.modifiedStartLineNumber - 1),\r\n            heightInLines: lineChangeOriginalLength,\r\n            minWidthInPx: (maxCharsPerLine * typicalHalfwidthCharacterWidth),\r\n            domNode: domNode,\r\n            marginDomNode: marginDomNode\r\n        };\r\n    };\r\n    InlineViewZonesComputer.prototype._renderOriginalLine = function (count, originalModel, config, tabSize, lineNumber, decorations, sb) {\r\n        var lineTokens = originalModel.getLineTokens(lineNumber);\r\n        var lineContent = lineTokens.getLineContent();\r\n        var actualDecorations = LineDecoration.filter(decorations, lineNumber, 1, lineContent.length + 1);\r\n        sb.appendASCIIString('<div class=\"view-line');\r\n        if (decorations.length === 0) {\r\n            // No char changes\r\n            sb.appendASCIIString(' char-delete');\r\n        }\r\n        sb.appendASCIIString('\" style=\"top:');\r\n        sb.appendASCIIString(String(count * config.lineHeight));\r\n        sb.appendASCIIString('px;width:1000000px;\">');\r\n        var isBasicASCII = ViewLineRenderingData.isBasicASCII(lineContent, originalModel.mightContainNonBasicASCII());\r\n        var containsRTL = ViewLineRenderingData.containsRTL(lineContent, isBasicASCII, originalModel.mightContainRTL());\r\n        var output = renderViewLine(new RenderLineInput((config.fontInfo.isMonospace && !config.viewInfo.disableMonospaceOptimizations), config.fontInfo.canUseHalfwidthRightwardsArrow, lineContent, false, isBasicASCII, containsRTL, 0, lineTokens, actualDecorations, tabSize, config.fontInfo.spaceWidth, config.viewInfo.stopRenderingLineAfter, config.viewInfo.renderWhitespace, config.viewInfo.renderControlCharacters, config.viewInfo.fontLigatures), sb);\r\n        sb.appendASCIIString('</div>');\r\n        var absoluteOffsets = output.characterMapping.getAbsoluteOffsets();\r\n        return absoluteOffsets.length > 0 ? absoluteOffsets[absoluteOffsets.length - 1] : 0;\r\n    };\r\n    return InlineViewZonesComputer;\r\n}(ViewZonesComputer));\r\nfunction isChangeOrInsert(lineChange) {\r\n    return lineChange.modifiedEndLineNumber > 0;\r\n}\r\nfunction isChangeOrDelete(lineChange) {\r\n    return lineChange.originalEndLineNumber > 0;\r\n}\r\nfunction createFakeLinesDiv() {\r\n    var r = document.createElement('div');\r\n    r.className = 'diagonal-fill';\r\n    return r;\r\n}\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var added = theme.getColor(diffInserted);\r\n    if (added) {\r\n        collector.addRule(\".monaco-editor .line-insert, .monaco-editor .char-insert { background-color: \" + added + \"; }\");\r\n        collector.addRule(\".monaco-diff-editor .line-insert, .monaco-diff-editor .char-insert { background-color: \" + added + \"; }\");\r\n        collector.addRule(\".monaco-editor .inline-added-margin-view-zone { background-color: \" + added + \"; }\");\r\n    }\r\n    var removed = theme.getColor(diffRemoved);\r\n    if (removed) {\r\n        collector.addRule(\".monaco-editor .line-delete, .monaco-editor .char-delete { background-color: \" + removed + \"; }\");\r\n        collector.addRule(\".monaco-diff-editor .line-delete, .monaco-diff-editor .char-delete { background-color: \" + removed + \"; }\");\r\n        collector.addRule(\".monaco-editor .inline-deleted-margin-view-zone { background-color: \" + removed + \"; }\");\r\n    }\r\n    var addedOutline = theme.getColor(diffInsertedOutline);\r\n    if (addedOutline) {\r\n        collector.addRule(\".monaco-editor .line-insert, .monaco-editor .char-insert { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + addedOutline + \"; }\");\r\n    }\r\n    var removedOutline = theme.getColor(diffRemovedOutline);\r\n    if (removedOutline) {\r\n        collector.addRule(\".monaco-editor .line-delete, .monaco-editor .char-delete { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + removedOutline + \"; }\");\r\n    }\r\n    var shadow = theme.getColor(scrollbarShadow);\r\n    if (shadow) {\r\n        collector.addRule(\".monaco-diff-editor.side-by-side .editor.modified { box-shadow: -6px 0 5px -5px \" + shadow + \"; }\");\r\n    }\r\n    var border = theme.getColor(diffBorder);\r\n    if (border) {\r\n        collector.addRule(\".monaco-diff-editor.side-by-side .editor.modified { border-left: 1px solid \" + border + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nexport var IStandaloneThemeService = createDecorator('themeService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nexport var IContextViewService = createDecorator('contextViewService');\r\nexport var IContextMenuService = createDecorator('contextMenuService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nexport var IKeybindingService = createDecorator('keybindingService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as browser from '../../../base/browser/browser.js';\r\nimport * as aria from '../../../base/browser/ui/aria/aria.js';\r\nimport { Disposable, combinedDisposable, toDisposable } from '../../../base/common/lifecycle.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { CodeEditorWidget } from '../../browser/widget/codeEditorWidget.js';\r\nimport { DiffEditorWidget } from '../../browser/widget/diffEditorWidget.js';\r\nimport { InternalEditorAction } from '../../common/editorAction.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { StandaloneKeybindingService, applyConfigurationValues } from './simpleServices.js';\r\nimport { IStandaloneThemeService } from '../common/standaloneThemeService.js';\r\nimport { MenuId, MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nimport { ContextKeyExpr, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IContextViewService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nvar LAST_GENERATED_COMMAND_ID = 0;\r\nvar ariaDomNodeCreated = false;\r\nfunction createAriaDomNode() {\r\n    if (ariaDomNodeCreated) {\r\n        return;\r\n    }\r\n    ariaDomNodeCreated = true;\r\n    aria.setARIAContainer(document.body);\r\n}\r\n/**\r\n * A code editor to be used both by the standalone editor and the standalone diff editor.\r\n */\r\nvar StandaloneCodeEditor = /** @class */ (function (_super) {\r\n    __extends(StandaloneCodeEditor, _super);\r\n    function StandaloneCodeEditor(domElement, options, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, themeService, notificationService) {\r\n        var _this = this;\r\n        options = options || {};\r\n        options.ariaLabel = options.ariaLabel || nls.localize('editorViewAccessibleLabel', \"Editor content\");\r\n        options.ariaLabel = options.ariaLabel + ';' + (browser.isIE\r\n            ? nls.localize('accessibilityHelpMessageIE', \"Press Ctrl+F1 for Accessibility Options.\")\r\n            : nls.localize('accessibilityHelpMessage', \"Press Alt+F1 for Accessibility Options.\"));\r\n        _this = _super.call(this, domElement, options, {}, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService) || this;\r\n        if (keybindingService instanceof StandaloneKeybindingService) {\r\n            _this._standaloneKeybindingService = keybindingService;\r\n        }\r\n        // Create the ARIA dom node as soon as the first editor is instantiated\r\n        createAriaDomNode();\r\n        return _this;\r\n    }\r\n    StandaloneCodeEditor.prototype.addCommand = function (keybinding, handler, context) {\r\n        if (!this._standaloneKeybindingService) {\r\n            console.warn('Cannot add command because the editor is configured with an unrecognized KeybindingService');\r\n            return null;\r\n        }\r\n        var commandId = 'DYNAMIC_' + (++LAST_GENERATED_COMMAND_ID);\r\n        var whenExpression = ContextKeyExpr.deserialize(context);\r\n        this._standaloneKeybindingService.addDynamicKeybinding(commandId, keybinding, handler, whenExpression);\r\n        return commandId;\r\n    };\r\n    StandaloneCodeEditor.prototype.createContextKey = function (key, defaultValue) {\r\n        return this._contextKeyService.createKey(key, defaultValue);\r\n    };\r\n    StandaloneCodeEditor.prototype.addAction = function (_descriptor) {\r\n        var _this = this;\r\n        if ((typeof _descriptor.id !== 'string') || (typeof _descriptor.label !== 'string') || (typeof _descriptor.run !== 'function')) {\r\n            throw new Error('Invalid action descriptor, `id`, `label` and `run` are required properties!');\r\n        }\r\n        if (!this._standaloneKeybindingService) {\r\n            console.warn('Cannot add keybinding because the editor is configured with an unrecognized KeybindingService');\r\n            return Disposable.None;\r\n        }\r\n        // Read descriptor options\r\n        var id = _descriptor.id;\r\n        var label = _descriptor.label;\r\n        var precondition = ContextKeyExpr.and(ContextKeyExpr.equals('editorId', this.getId()), ContextKeyExpr.deserialize(_descriptor.precondition));\r\n        var keybindings = _descriptor.keybindings;\r\n        var keybindingsWhen = ContextKeyExpr.and(precondition, ContextKeyExpr.deserialize(_descriptor.keybindingContext));\r\n        var contextMenuGroupId = _descriptor.contextMenuGroupId || null;\r\n        var contextMenuOrder = _descriptor.contextMenuOrder || 0;\r\n        var run = function () {\r\n            return Promise.resolve(_descriptor.run(_this));\r\n        };\r\n        var toDispose = [];\r\n        // Generate a unique id to allow the same descriptor.id across multiple editor instances\r\n        var uniqueId = this.getId() + ':' + id;\r\n        // Register the command\r\n        toDispose.push(CommandsRegistry.registerCommand(uniqueId, run));\r\n        // Register the context menu item\r\n        if (contextMenuGroupId) {\r\n            var menuItem = {\r\n                command: {\r\n                    id: uniqueId,\r\n                    title: label\r\n                },\r\n                when: precondition,\r\n                group: contextMenuGroupId,\r\n                order: contextMenuOrder\r\n            };\r\n            toDispose.push(MenuRegistry.appendMenuItem(MenuId.EditorContext, menuItem));\r\n        }\r\n        // Register the keybindings\r\n        if (Array.isArray(keybindings)) {\r\n            toDispose = toDispose.concat(keybindings.map(function (kb) {\r\n                return _this._standaloneKeybindingService.addDynamicKeybinding(uniqueId, kb, run, keybindingsWhen);\r\n            }));\r\n        }\r\n        // Finally, register an internal editor action\r\n        var internalAction = new InternalEditorAction(uniqueId, label, label, precondition, run, this._contextKeyService);\r\n        // Store it under the original id, such that trigger with the original id will work\r\n        this._actions[id] = internalAction;\r\n        toDispose.push(toDisposable(function () {\r\n            delete _this._actions[id];\r\n        }));\r\n        return combinedDisposable(toDispose);\r\n    };\r\n    StandaloneCodeEditor = __decorate([\r\n        __param(2, IInstantiationService),\r\n        __param(3, ICodeEditorService),\r\n        __param(4, ICommandService),\r\n        __param(5, IContextKeyService),\r\n        __param(6, IKeybindingService),\r\n        __param(7, IThemeService),\r\n        __param(8, INotificationService)\r\n    ], StandaloneCodeEditor);\r\n    return StandaloneCodeEditor;\r\n}(CodeEditorWidget));\r\nexport { StandaloneCodeEditor };\r\nvar StandaloneEditor = /** @class */ (function (_super) {\r\n    __extends(StandaloneEditor, _super);\r\n    function StandaloneEditor(domElement, options, toDispose, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, contextViewService, themeService, notificationService, configurationService) {\r\n        var _this = this;\r\n        applyConfigurationValues(configurationService, options, false);\r\n        options = options || {};\r\n        if (typeof options.theme === 'string') {\r\n            themeService.setTheme(options.theme);\r\n        }\r\n        var _model = options.model;\r\n        delete options.model;\r\n        _this = _super.call(this, domElement, options, instantiationService, codeEditorService, commandService, contextKeyService, keybindingService, themeService, notificationService) || this;\r\n        _this._contextViewService = contextViewService;\r\n        _this._configurationService = configurationService;\r\n        _this._register(toDispose);\r\n        var model;\r\n        if (typeof _model === 'undefined') {\r\n            model = self.monaco.editor.createModel(options.value || '', options.language || 'text/plain');\r\n            _this._ownsModel = true;\r\n        }\r\n        else {\r\n            model = _model;\r\n            _this._ownsModel = false;\r\n        }\r\n        _this._attachModel(model);\r\n        if (model) {\r\n            var e = {\r\n                oldModelUrl: null,\r\n                newModelUrl: model.uri\r\n            };\r\n            _this._onDidChangeModel.fire(e);\r\n        }\r\n        return _this;\r\n    }\r\n    StandaloneEditor.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    StandaloneEditor.prototype.updateOptions = function (newOptions) {\r\n        applyConfigurationValues(this._configurationService, newOptions, false);\r\n        _super.prototype.updateOptions.call(this, newOptions);\r\n    };\r\n    StandaloneEditor.prototype._attachModel = function (model) {\r\n        _super.prototype._attachModel.call(this, model);\r\n        if (this._modelData) {\r\n            this._contextViewService.setContainer(this._modelData.view.domNode.domNode);\r\n        }\r\n    };\r\n    StandaloneEditor.prototype._postDetachModelCleanup = function (detachedModel) {\r\n        _super.prototype._postDetachModelCleanup.call(this, detachedModel);\r\n        if (detachedModel && this._ownsModel) {\r\n            detachedModel.dispose();\r\n            this._ownsModel = false;\r\n        }\r\n    };\r\n    StandaloneEditor = __decorate([\r\n        __param(3, IInstantiationService),\r\n        __param(4, ICodeEditorService),\r\n        __param(5, ICommandService),\r\n        __param(6, IContextKeyService),\r\n        __param(7, IKeybindingService),\r\n        __param(8, IContextViewService),\r\n        __param(9, IStandaloneThemeService),\r\n        __param(10, INotificationService),\r\n        __param(11, IConfigurationService)\r\n    ], StandaloneEditor);\r\n    return StandaloneEditor;\r\n}(StandaloneCodeEditor));\r\nexport { StandaloneEditor };\r\nvar StandaloneDiffEditor = /** @class */ (function (_super) {\r\n    __extends(StandaloneDiffEditor, _super);\r\n    function StandaloneDiffEditor(domElement, options, toDispose, instantiationService, contextKeyService, keybindingService, contextViewService, editorWorkerService, codeEditorService, themeService, notificationService, configurationService) {\r\n        var _this = this;\r\n        applyConfigurationValues(configurationService, options, true);\r\n        options = options || {};\r\n        if (typeof options.theme === 'string') {\r\n            options.theme = themeService.setTheme(options.theme);\r\n        }\r\n        _this = _super.call(this, domElement, options, editorWorkerService, contextKeyService, instantiationService, codeEditorService, themeService, notificationService) || this;\r\n        _this._contextViewService = contextViewService;\r\n        _this._configurationService = configurationService;\r\n        _this._register(toDispose);\r\n        _this._contextViewService.setContainer(_this._containerDomElement);\r\n        return _this;\r\n    }\r\n    StandaloneDiffEditor.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    StandaloneDiffEditor.prototype.updateOptions = function (newOptions) {\r\n        applyConfigurationValues(this._configurationService, newOptions, true);\r\n        _super.prototype.updateOptions.call(this, newOptions);\r\n    };\r\n    StandaloneDiffEditor.prototype._createInnerEditor = function (instantiationService, container, options) {\r\n        return instantiationService.createInstance(StandaloneCodeEditor, container, options);\r\n    };\r\n    StandaloneDiffEditor.prototype.getOriginalEditor = function () {\r\n        return _super.prototype.getOriginalEditor.call(this);\r\n    };\r\n    StandaloneDiffEditor.prototype.getModifiedEditor = function () {\r\n        return _super.prototype.getModifiedEditor.call(this);\r\n    };\r\n    StandaloneDiffEditor.prototype.addCommand = function (keybinding, handler, context) {\r\n        return this.getModifiedEditor().addCommand(keybinding, handler, context);\r\n    };\r\n    StandaloneDiffEditor.prototype.createContextKey = function (key, defaultValue) {\r\n        return this.getModifiedEditor().createContextKey(key, defaultValue);\r\n    };\r\n    StandaloneDiffEditor.prototype.addAction = function (descriptor) {\r\n        return this.getModifiedEditor().addAction(descriptor);\r\n    };\r\n    StandaloneDiffEditor = __decorate([\r\n        __param(3, IInstantiationService),\r\n        __param(4, IContextKeyService),\r\n        __param(5, IKeybindingService),\r\n        __param(6, IContextViewService),\r\n        __param(7, IEditorWorkerService),\r\n        __param(8, ICodeEditorService),\r\n        __param(9, IStandaloneThemeService),\r\n        __param(10, INotificationService),\r\n        __param(11, IConfigurationService)\r\n    ], StandaloneDiffEditor);\r\n    return StandaloneDiffEditor;\r\n}(DiffEditorWidget));\r\nexport { StandaloneDiffEditor };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nexport var IBulkEditService = createDecorator('IWorkspaceEditService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nexport var IModeService = createDecorator('modeService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar FrankensteinMode = /** @class */ (function () {\r\n    function FrankensteinMode(languageIdentifier) {\r\n        this._languageIdentifier = languageIdentifier;\r\n    }\r\n    FrankensteinMode.prototype.getId = function () {\r\n        return this._languageIdentifier.language;\r\n    };\r\n    return FrankensteinMode;\r\n}());\r\nexport { FrankensteinMode };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as paths from './paths.js';\r\nimport * as strings from './strings.js';\r\nimport { match } from './glob.js';\r\nexport var MIME_TEXT = 'text/plain';\r\nexport var MIME_UNKNOWN = 'application/unknown';\r\nvar registeredAssociations = [];\r\nvar nonUserRegisteredAssociations = [];\r\nvar userRegisteredAssociations = [];\r\n/**\r\n * Associate a text mime to the registry.\r\n */\r\nexport function registerTextMime(association, warnOnOverwrite) {\r\n    if (warnOnOverwrite === void 0) { warnOnOverwrite = false; }\r\n    // Register\r\n    var associationItem = toTextMimeAssociationItem(association);\r\n    registeredAssociations.push(associationItem);\r\n    if (!associationItem.userConfigured) {\r\n        nonUserRegisteredAssociations.push(associationItem);\r\n    }\r\n    else {\r\n        userRegisteredAssociations.push(associationItem);\r\n    }\r\n    // Check for conflicts unless this is a user configured association\r\n    if (warnOnOverwrite && !associationItem.userConfigured) {\r\n        registeredAssociations.forEach(function (a) {\r\n            if (a.mime === associationItem.mime || a.userConfigured) {\r\n                return; // same mime or userConfigured is ok\r\n            }\r\n            if (associationItem.extension && a.extension === associationItem.extension) {\r\n                console.warn(\"Overwriting extension <<\" + associationItem.extension + \">> to now point to mime <<\" + associationItem.mime + \">>\");\r\n            }\r\n            if (associationItem.filename && a.filename === associationItem.filename) {\r\n                console.warn(\"Overwriting filename <<\" + associationItem.filename + \">> to now point to mime <<\" + associationItem.mime + \">>\");\r\n            }\r\n            if (associationItem.filepattern && a.filepattern === associationItem.filepattern) {\r\n                console.warn(\"Overwriting filepattern <<\" + associationItem.filepattern + \">> to now point to mime <<\" + associationItem.mime + \">>\");\r\n            }\r\n            if (associationItem.firstline && a.firstline === associationItem.firstline) {\r\n                console.warn(\"Overwriting firstline <<\" + associationItem.firstline + \">> to now point to mime <<\" + associationItem.mime + \">>\");\r\n            }\r\n        });\r\n    }\r\n}\r\nfunction toTextMimeAssociationItem(association) {\r\n    return {\r\n        id: association.id,\r\n        mime: association.mime,\r\n        filename: association.filename,\r\n        extension: association.extension,\r\n        filepattern: association.filepattern,\r\n        firstline: association.firstline,\r\n        userConfigured: association.userConfigured,\r\n        filenameLowercase: association.filename ? association.filename.toLowerCase() : void 0,\r\n        extensionLowercase: association.extension ? association.extension.toLowerCase() : void 0,\r\n        filepatternLowercase: association.filepattern ? association.filepattern.toLowerCase() : void 0,\r\n        filepatternOnPath: association.filepattern ? association.filepattern.indexOf(paths.sep) >= 0 : false\r\n    };\r\n}\r\n/**\r\n * Given a file, return the best matching mime type for it\r\n */\r\nexport function guessMimeTypes(path, firstLine) {\r\n    if (!path) {\r\n        return [MIME_UNKNOWN];\r\n    }\r\n    path = path.toLowerCase();\r\n    var filename = paths.basename(path);\r\n    // 1.) User configured mappings have highest priority\r\n    var configuredMime = guessMimeTypeByPath(path, filename, userRegisteredAssociations);\r\n    if (configuredMime) {\r\n        return [configuredMime, MIME_TEXT];\r\n    }\r\n    // 2.) Registered mappings have middle priority\r\n    var registeredMime = guessMimeTypeByPath(path, filename, nonUserRegisteredAssociations);\r\n    if (registeredMime) {\r\n        return [registeredMime, MIME_TEXT];\r\n    }\r\n    // 3.) Firstline has lowest priority\r\n    if (firstLine) {\r\n        var firstlineMime = guessMimeTypeByFirstline(firstLine);\r\n        if (firstlineMime) {\r\n            return [firstlineMime, MIME_TEXT];\r\n        }\r\n    }\r\n    return [MIME_UNKNOWN];\r\n}\r\nfunction guessMimeTypeByPath(path, filename, associations) {\r\n    var filenameMatch = null;\r\n    var patternMatch = null;\r\n    var extensionMatch = null;\r\n    // We want to prioritize associations based on the order they are registered so that the last registered\r\n    // association wins over all other. This is for https://github.com/Microsoft/vscode/issues/20074\r\n    for (var i = associations.length - 1; i >= 0; i--) {\r\n        var association = associations[i];\r\n        // First exact name match\r\n        if (filename === association.filenameLowercase) {\r\n            filenameMatch = association;\r\n            break; // take it!\r\n        }\r\n        // Longest pattern match\r\n        if (association.filepattern) {\r\n            if (!patternMatch || association.filepattern.length > patternMatch.filepattern.length) {\r\n                var target = association.filepatternOnPath ? path : filename; // match on full path if pattern contains path separator\r\n                if (match(association.filepatternLowercase, target)) {\r\n                    patternMatch = association;\r\n                }\r\n            }\r\n        }\r\n        // Longest extension match\r\n        if (association.extension) {\r\n            if (!extensionMatch || association.extension.length > extensionMatch.extension.length) {\r\n                if (strings.endsWith(filename, association.extensionLowercase)) {\r\n                    extensionMatch = association;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // 1.) Exact name match has second highest prio\r\n    if (filenameMatch) {\r\n        return filenameMatch.mime;\r\n    }\r\n    // 2.) Match on pattern\r\n    if (patternMatch) {\r\n        return patternMatch.mime;\r\n    }\r\n    // 3.) Match on extension comes next\r\n    if (extensionMatch) {\r\n        return extensionMatch.mime;\r\n    }\r\n    return null;\r\n}\r\nfunction guessMimeTypeByFirstline(firstLine) {\r\n    if (strings.startsWithUTF8BOM(firstLine)) {\r\n        firstLine = firstLine.substr(1);\r\n    }\r\n    if (firstLine.length > 0) {\r\n        for (var i = 0; i < registeredAssociations.length; ++i) {\r\n            var association = registeredAssociations[i];\r\n            if (!association.firstline) {\r\n                continue;\r\n            }\r\n            var matches = firstLine.match(association.firstline);\r\n            if (matches && matches.length > 0) {\r\n                return association.mime;\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { LanguageIdentifier } from '../modes.js';\r\nimport { LanguageConfigurationRegistry } from './languageConfigurationRegistry.js';\r\nimport { Registry } from '../../../platform/registry/common/platform.js';\r\n// Define extension point ids\r\nexport var Extensions = {\r\n    ModesRegistry: 'editor.modesRegistry'\r\n};\r\nvar EditorModesRegistry = /** @class */ (function () {\r\n    function EditorModesRegistry() {\r\n        this._onDidAddLanguages = new Emitter();\r\n        this.onDidAddLanguages = this._onDidAddLanguages.event;\r\n        this._languages = [];\r\n    }\r\n    // --- languages\r\n    EditorModesRegistry.prototype.registerLanguage = function (def) {\r\n        this._languages.push(def);\r\n        this._onDidAddLanguages.fire([def]);\r\n    };\r\n    EditorModesRegistry.prototype.getLanguages = function () {\r\n        return this._languages.slice(0);\r\n    };\r\n    return EditorModesRegistry;\r\n}());\r\nexport { EditorModesRegistry };\r\nexport var ModesRegistry = new EditorModesRegistry();\r\nRegistry.add(Extensions.ModesRegistry, ModesRegistry);\r\nexport var PLAINTEXT_MODE_ID = 'plaintext';\r\nexport var PLAINTEXT_LANGUAGE_IDENTIFIER = new LanguageIdentifier(PLAINTEXT_MODE_ID, 1 /* PlainText */);\r\nModesRegistry.registerLanguage({\r\n    id: PLAINTEXT_MODE_ID,\r\n    extensions: ['.txt', '.gitignore'],\r\n    aliases: [nls.localize('plainText.alias', \"Plain Text\"), 'text'],\r\n    mimetypes: ['text/plain']\r\n});\r\nLanguageConfigurationRegistry.register(PLAINTEXT_LANGUAGE_IDENTIFIER, {\r\n    brackets: [\r\n        ['(', ')'],\r\n        ['[', ']'],\r\n        ['{', '}'],\r\n    ]\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport * as mime from '../../../base/common/mime.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { LanguageIdentifier } from '../modes.js';\r\nimport { ModesRegistry } from '../modes/modesRegistry.js';\r\nimport { NULL_LANGUAGE_IDENTIFIER, NULL_MODE_ID } from '../modes/nullMode.js';\r\nimport { Extensions } from '../../../platform/configuration/common/configurationRegistry.js';\r\nimport { Registry } from '../../../platform/registry/common/platform.js';\r\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\r\nvar LanguagesRegistry = /** @class */ (function (_super) {\r\n    __extends(LanguagesRegistry, _super);\r\n    function LanguagesRegistry(useModesRegistry, warnOnOverwrite) {\r\n        if (useModesRegistry === void 0) { useModesRegistry = true; }\r\n        if (warnOnOverwrite === void 0) { warnOnOverwrite = false; }\r\n        var _this = _super.call(this) || this;\r\n        _this._onDidChange = _this._register(new Emitter());\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        _this._nextLanguageId = 1;\r\n        _this._languages = {};\r\n        _this._mimeTypesMap = {};\r\n        _this._nameMap = {};\r\n        _this._lowercaseNameMap = {};\r\n        _this._languageIds = [];\r\n        _this._warnOnOverwrite = warnOnOverwrite;\r\n        if (useModesRegistry) {\r\n            _this._registerLanguages(ModesRegistry.getLanguages());\r\n            _this._register(ModesRegistry.onDidAddLanguages(function (m) { return _this._registerLanguages(m); }));\r\n        }\r\n        return _this;\r\n    }\r\n    LanguagesRegistry.prototype._registerLanguages = function (desc) {\r\n        var _this = this;\r\n        if (desc.length === 0) {\r\n            return;\r\n        }\r\n        for (var i = 0; i < desc.length; i++) {\r\n            this._registerLanguage(desc[i]);\r\n        }\r\n        // Rebuild fast path maps\r\n        this._mimeTypesMap = {};\r\n        this._nameMap = {};\r\n        this._lowercaseNameMap = {};\r\n        Object.keys(this._languages).forEach(function (langId) {\r\n            var language = _this._languages[langId];\r\n            if (language.name) {\r\n                _this._nameMap[language.name] = language.identifier;\r\n            }\r\n            language.aliases.forEach(function (alias) {\r\n                _this._lowercaseNameMap[alias.toLowerCase()] = language.identifier;\r\n            });\r\n            language.mimetypes.forEach(function (mimetype) {\r\n                _this._mimeTypesMap[mimetype] = language.identifier;\r\n            });\r\n        });\r\n        Registry.as(Extensions.Configuration).registerOverrideIdentifiers(ModesRegistry.getLanguages().map(function (language) { return language.id; }));\r\n        this._onDidChange.fire();\r\n    };\r\n    LanguagesRegistry.prototype._registerLanguage = function (lang) {\r\n        var langId = lang.id;\r\n        var resolvedLanguage;\r\n        if (hasOwnProperty.call(this._languages, langId)) {\r\n            resolvedLanguage = this._languages[langId];\r\n        }\r\n        else {\r\n            var languageId = this._nextLanguageId++;\r\n            resolvedLanguage = {\r\n                identifier: new LanguageIdentifier(langId, languageId),\r\n                name: null,\r\n                mimetypes: [],\r\n                aliases: [],\r\n                extensions: [],\r\n                filenames: [],\r\n                configurationFiles: []\r\n            };\r\n            this._languageIds[languageId] = langId;\r\n            this._languages[langId] = resolvedLanguage;\r\n        }\r\n        this._mergeLanguage(resolvedLanguage, lang);\r\n    };\r\n    LanguagesRegistry.prototype._mergeLanguage = function (resolvedLanguage, lang) {\r\n        var _a;\r\n        var langId = lang.id;\r\n        var primaryMime = null;\r\n        if (Array.isArray(lang.mimetypes) && lang.mimetypes.length > 0) {\r\n            (_a = resolvedLanguage.mimetypes).push.apply(_a, lang.mimetypes);\r\n            primaryMime = lang.mimetypes[0];\r\n        }\r\n        if (!primaryMime) {\r\n            primaryMime = \"text/x-\" + langId;\r\n            resolvedLanguage.mimetypes.push(primaryMime);\r\n        }\r\n        if (Array.isArray(lang.extensions)) {\r\n            for (var _i = 0, _b = lang.extensions; _i < _b.length; _i++) {\r\n                var extension = _b[_i];\r\n                mime.registerTextMime({ id: langId, mime: primaryMime, extension: extension }, this._warnOnOverwrite);\r\n                resolvedLanguage.extensions.push(extension);\r\n            }\r\n        }\r\n        if (Array.isArray(lang.filenames)) {\r\n            for (var _c = 0, _d = lang.filenames; _c < _d.length; _c++) {\r\n                var filename = _d[_c];\r\n                mime.registerTextMime({ id: langId, mime: primaryMime, filename: filename }, this._warnOnOverwrite);\r\n                resolvedLanguage.filenames.push(filename);\r\n            }\r\n        }\r\n        if (Array.isArray(lang.filenamePatterns)) {\r\n            for (var _e = 0, _f = lang.filenamePatterns; _e < _f.length; _e++) {\r\n                var filenamePattern = _f[_e];\r\n                mime.registerTextMime({ id: langId, mime: primaryMime, filepattern: filenamePattern }, this._warnOnOverwrite);\r\n            }\r\n        }\r\n        if (typeof lang.firstLine === 'string' && lang.firstLine.length > 0) {\r\n            var firstLineRegexStr = lang.firstLine;\r\n            if (firstLineRegexStr.charAt(0) !== '^') {\r\n                firstLineRegexStr = '^' + firstLineRegexStr;\r\n            }\r\n            try {\r\n                var firstLineRegex = new RegExp(firstLineRegexStr);\r\n                if (!strings.regExpLeadsToEndlessLoop(firstLineRegex)) {\r\n                    mime.registerTextMime({ id: langId, mime: primaryMime, firstline: firstLineRegex }, this._warnOnOverwrite);\r\n                }\r\n            }\r\n            catch (err) {\r\n                // Most likely, the regex was bad\r\n                onUnexpectedError(err);\r\n            }\r\n        }\r\n        resolvedLanguage.aliases.push(langId);\r\n        var langAliases = null;\r\n        if (typeof lang.aliases !== 'undefined' && Array.isArray(lang.aliases)) {\r\n            if (lang.aliases.length === 0) {\r\n                // signal that this language should not get a name\r\n                langAliases = [null];\r\n            }\r\n            else {\r\n                langAliases = lang.aliases;\r\n            }\r\n        }\r\n        if (langAliases !== null) {\r\n            for (var i = 0; i < langAliases.length; i++) {\r\n                var langAlias = langAliases[i];\r\n                if (!langAlias || langAlias.length === 0) {\r\n                    continue;\r\n                }\r\n                resolvedLanguage.aliases.push(langAlias);\r\n            }\r\n        }\r\n        var containsAliases = (langAliases !== null && langAliases.length > 0);\r\n        if (containsAliases && langAliases[0] === null) {\r\n            // signal that this language should not get a name\r\n        }\r\n        else {\r\n            var bestName = (containsAliases ? langAliases[0] : null) || langId;\r\n            if (containsAliases || !resolvedLanguage.name) {\r\n                resolvedLanguage.name = bestName;\r\n            }\r\n        }\r\n        if (lang.configuration) {\r\n            resolvedLanguage.configurationFiles.push(lang.configuration);\r\n        }\r\n    };\r\n    LanguagesRegistry.prototype.isRegisteredMode = function (mimetypeOrModeId) {\r\n        // Is this a known mime type ?\r\n        if (hasOwnProperty.call(this._mimeTypesMap, mimetypeOrModeId)) {\r\n            return true;\r\n        }\r\n        // Is this a known mode id ?\r\n        return hasOwnProperty.call(this._languages, mimetypeOrModeId);\r\n    };\r\n    LanguagesRegistry.prototype.getModeIdForLanguageNameLowercase = function (languageNameLower) {\r\n        if (!hasOwnProperty.call(this._lowercaseNameMap, languageNameLower)) {\r\n            return null;\r\n        }\r\n        return this._lowercaseNameMap[languageNameLower].language;\r\n    };\r\n    LanguagesRegistry.prototype.extractModeIds = function (commaSeparatedMimetypesOrCommaSeparatedIds) {\r\n        var _this = this;\r\n        if (!commaSeparatedMimetypesOrCommaSeparatedIds) {\r\n            return [];\r\n        }\r\n        return (commaSeparatedMimetypesOrCommaSeparatedIds.\r\n            split(',').\r\n            map(function (mimeTypeOrId) { return mimeTypeOrId.trim(); }).\r\n            map(function (mimeTypeOrId) {\r\n            if (hasOwnProperty.call(_this._mimeTypesMap, mimeTypeOrId)) {\r\n                return _this._mimeTypesMap[mimeTypeOrId].language;\r\n            }\r\n            return mimeTypeOrId;\r\n        }).\r\n            filter(function (modeId) {\r\n            return hasOwnProperty.call(_this._languages, modeId);\r\n        }));\r\n    };\r\n    LanguagesRegistry.prototype.getLanguageIdentifier = function (_modeId) {\r\n        if (_modeId === NULL_MODE_ID || _modeId === 0 /* Null */) {\r\n            return NULL_LANGUAGE_IDENTIFIER;\r\n        }\r\n        var modeId;\r\n        if (typeof _modeId === 'string') {\r\n            modeId = _modeId;\r\n        }\r\n        else {\r\n            modeId = this._languageIds[_modeId];\r\n            if (!modeId) {\r\n                return null;\r\n            }\r\n        }\r\n        if (!hasOwnProperty.call(this._languages, modeId)) {\r\n            return null;\r\n        }\r\n        return this._languages[modeId].identifier;\r\n    };\r\n    LanguagesRegistry.prototype.getModeIdsFromFilepathOrFirstLine = function (filepath, firstLine) {\r\n        if (!filepath && !firstLine) {\r\n            return [];\r\n        }\r\n        var mimeTypes = mime.guessMimeTypes(filepath, firstLine);\r\n        return this.extractModeIds(mimeTypes.join(','));\r\n    };\r\n    return LanguagesRegistry;\r\n}(Disposable));\r\nexport { LanguagesRegistry };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { FrankensteinMode } from '../modes/abstractMode.js';\r\nimport { NULL_LANGUAGE_IDENTIFIER } from '../modes/nullMode.js';\r\nimport { LanguagesRegistry } from './languagesRegistry.js';\r\nvar LanguageSelection = /** @class */ (function (_super) {\r\n    __extends(LanguageSelection, _super);\r\n    function LanguageSelection(onLanguagesMaybeChanged, selector) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onDidChange = _this._register(new Emitter());\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        _this._selector = selector;\r\n        _this.languageIdentifier = _this._selector();\r\n        _this._register(onLanguagesMaybeChanged(function () { return _this._evaluate(); }));\r\n        return _this;\r\n    }\r\n    LanguageSelection.prototype._evaluate = function () {\r\n        var languageIdentifier = this._selector();\r\n        if (languageIdentifier.id === this.languageIdentifier.id) {\r\n            // no change\r\n            return;\r\n        }\r\n        this.languageIdentifier = languageIdentifier;\r\n        this._onDidChange.fire(this.languageIdentifier);\r\n    };\r\n    return LanguageSelection;\r\n}(Disposable));\r\nvar ModeServiceImpl = /** @class */ (function () {\r\n    function ModeServiceImpl(warnOnOverwrite) {\r\n        if (warnOnOverwrite === void 0) { warnOnOverwrite = false; }\r\n        var _this = this;\r\n        this._onDidCreateMode = new Emitter();\r\n        this.onDidCreateMode = this._onDidCreateMode.event;\r\n        this._onLanguagesMaybeChanged = new Emitter();\r\n        this.onLanguagesMaybeChanged = this._onLanguagesMaybeChanged.event;\r\n        this._instantiatedModes = {};\r\n        this._registry = new LanguagesRegistry(true, warnOnOverwrite);\r\n        this._registry.onDidChange(function () { return _this._onLanguagesMaybeChanged.fire(); });\r\n    }\r\n    ModeServiceImpl.prototype.isRegisteredMode = function (mimetypeOrModeId) {\r\n        return this._registry.isRegisteredMode(mimetypeOrModeId);\r\n    };\r\n    ModeServiceImpl.prototype.getModeIdForLanguageName = function (alias) {\r\n        return this._registry.getModeIdForLanguageNameLowercase(alias);\r\n    };\r\n    ModeServiceImpl.prototype.getModeIdByFilepathOrFirstLine = function (filepath, firstLine) {\r\n        var modeIds = this._registry.getModeIdsFromFilepathOrFirstLine(filepath, firstLine);\r\n        if (modeIds.length > 0) {\r\n            return modeIds[0];\r\n        }\r\n        return null;\r\n    };\r\n    ModeServiceImpl.prototype.getModeId = function (commaSeparatedMimetypesOrCommaSeparatedIds) {\r\n        var modeIds = this._registry.extractModeIds(commaSeparatedMimetypesOrCommaSeparatedIds);\r\n        if (modeIds.length > 0) {\r\n            return modeIds[0];\r\n        }\r\n        return null;\r\n    };\r\n    ModeServiceImpl.prototype.getLanguageIdentifier = function (modeId) {\r\n        return this._registry.getLanguageIdentifier(modeId);\r\n    };\r\n    // --- instantiation\r\n    ModeServiceImpl.prototype.create = function (commaSeparatedMimetypesOrCommaSeparatedIds) {\r\n        var _this = this;\r\n        return new LanguageSelection(this.onLanguagesMaybeChanged, function () {\r\n            var modeId = _this.getModeId(commaSeparatedMimetypesOrCommaSeparatedIds);\r\n            return _this._createModeAndGetLanguageIdentifier(modeId);\r\n        });\r\n    };\r\n    ModeServiceImpl.prototype.createByFilepathOrFirstLine = function (filepath, firstLine) {\r\n        var _this = this;\r\n        return new LanguageSelection(this.onLanguagesMaybeChanged, function () {\r\n            var modeId = _this.getModeIdByFilepathOrFirstLine(filepath, firstLine);\r\n            return _this._createModeAndGetLanguageIdentifier(modeId);\r\n        });\r\n    };\r\n    ModeServiceImpl.prototype._createModeAndGetLanguageIdentifier = function (modeId) {\r\n        // Fall back to plain text if no mode was found\r\n        var languageIdentifier = this.getLanguageIdentifier(modeId || 'plaintext') || NULL_LANGUAGE_IDENTIFIER;\r\n        this._getOrCreateMode(languageIdentifier.language);\r\n        return languageIdentifier;\r\n    };\r\n    ModeServiceImpl.prototype.triggerMode = function (commaSeparatedMimetypesOrCommaSeparatedIds) {\r\n        var modeId = this.getModeId(commaSeparatedMimetypesOrCommaSeparatedIds);\r\n        // Fall back to plain text if no mode was found\r\n        this._getOrCreateMode(modeId || 'plaintext');\r\n    };\r\n    ModeServiceImpl.prototype._getOrCreateMode = function (modeId) {\r\n        if (!this._instantiatedModes.hasOwnProperty(modeId)) {\r\n            var languageIdentifier = this.getLanguageIdentifier(modeId) || NULL_LANGUAGE_IDENTIFIER;\r\n            this._instantiatedModes[modeId] = new FrankensteinMode(languageIdentifier);\r\n            this._onDidCreateMode.fire(this._instantiatedModes[modeId]);\r\n        }\r\n        return this._instantiatedModes[modeId];\r\n    };\r\n    return ModeServiceImpl;\r\n}());\r\nexport { ModeServiceImpl };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { equals } from './arrays.js';\r\nvar MarkdownString = /** @class */ (function () {\r\n    function MarkdownString(value) {\r\n        if (value === void 0) { value = ''; }\r\n        this.value = value;\r\n    }\r\n    MarkdownString.prototype.appendText = function (value) {\r\n        // escape markdown syntax tokens: http://daringfireball.net/projects/markdown/syntax#backslash\r\n        this.value += value.replace(/[\\\\`*_{}[\\]()#+\\-.!]/g, '\\\\$&');\r\n        return this;\r\n    };\r\n    MarkdownString.prototype.appendMarkdown = function (value) {\r\n        this.value += value;\r\n        return this;\r\n    };\r\n    MarkdownString.prototype.appendCodeblock = function (langId, code) {\r\n        this.value += '\\n```';\r\n        this.value += langId;\r\n        this.value += '\\n';\r\n        this.value += code;\r\n        this.value += '\\n```\\n';\r\n        return this;\r\n    };\r\n    return MarkdownString;\r\n}());\r\nexport { MarkdownString };\r\nexport function isEmptyMarkdownString(oneOrMany) {\r\n    if (isMarkdownString(oneOrMany)) {\r\n        return !oneOrMany.value;\r\n    }\r\n    else if (Array.isArray(oneOrMany)) {\r\n        return oneOrMany.every(isEmptyMarkdownString);\r\n    }\r\n    else {\r\n        return true;\r\n    }\r\n}\r\nexport function isMarkdownString(thing) {\r\n    if (thing instanceof MarkdownString) {\r\n        return true;\r\n    }\r\n    else if (thing && typeof thing === 'object') {\r\n        return typeof thing.value === 'string'\r\n            && (typeof thing.isTrusted === 'boolean' || thing.isTrusted === void 0);\r\n    }\r\n    return false;\r\n}\r\nexport function markedStringsEquals(a, b) {\r\n    if (!a && !b) {\r\n        return true;\r\n    }\r\n    else if (!a || !b) {\r\n        return false;\r\n    }\r\n    else if (Array.isArray(a) && Array.isArray(b)) {\r\n        return equals(a, b, markdownStringEqual);\r\n    }\r\n    else if (isMarkdownString(a) && isMarkdownString(b)) {\r\n        return markdownStringEqual(a, b);\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\nfunction markdownStringEqual(a, b) {\r\n    if (a === b) {\r\n        return true;\r\n    }\r\n    else if (!a || !b) {\r\n        return false;\r\n    }\r\n    else {\r\n        return a.value === b.value && a.isTrusted === b.isTrusted;\r\n    }\r\n}\r\nexport function removeMarkdownEscapes(text) {\r\n    if (!text) {\r\n        return text;\r\n    }\r\n    return text.replace(/\\\\([\\\\`*_{}[\\]()#+\\-.!])/g, '$1');\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nimport { localize } from '../../../nls.js';\r\nimport Severity from '../../../base/common/severity.js';\r\nexport var MarkerSeverity;\r\n(function (MarkerSeverity) {\r\n    MarkerSeverity[MarkerSeverity[\"Hint\"] = 1] = \"Hint\";\r\n    MarkerSeverity[MarkerSeverity[\"Info\"] = 2] = \"Info\";\r\n    MarkerSeverity[MarkerSeverity[\"Warning\"] = 4] = \"Warning\";\r\n    MarkerSeverity[MarkerSeverity[\"Error\"] = 8] = \"Error\";\r\n})(MarkerSeverity || (MarkerSeverity = {}));\r\n(function (MarkerSeverity) {\r\n    function compare(a, b) {\r\n        return b - a;\r\n    }\r\n    MarkerSeverity.compare = compare;\r\n    var _displayStrings = Object.create(null);\r\n    _displayStrings[MarkerSeverity.Error] = localize('sev.error', \"Error\");\r\n    _displayStrings[MarkerSeverity.Warning] = localize('sev.warning', \"Warning\");\r\n    _displayStrings[MarkerSeverity.Info] = localize('sev.info', \"Info\");\r\n    function toString(a) {\r\n        return _displayStrings[a] || '';\r\n    }\r\n    MarkerSeverity.toString = toString;\r\n    function fromSeverity(severity) {\r\n        switch (severity) {\r\n            case Severity.Error: return MarkerSeverity.Error;\r\n            case Severity.Warning: return MarkerSeverity.Warning;\r\n            case Severity.Info: return MarkerSeverity.Info;\r\n            case Severity.Ignore: return MarkerSeverity.Hint;\r\n        }\r\n    }\r\n    MarkerSeverity.fromSeverity = fromSeverity;\r\n})(MarkerSeverity || (MarkerSeverity = {}));\r\nexport var IMarkerData;\r\n(function (IMarkerData) {\r\n    var emptyString = '';\r\n    function makeKey(markerData) {\r\n        var result = [emptyString];\r\n        if (markerData.source) {\r\n            result.push(markerData.source.replace('¦', '\\¦'));\r\n        }\r\n        else {\r\n            result.push(emptyString);\r\n        }\r\n        if (markerData.code) {\r\n            result.push(markerData.code.replace('¦', '\\¦'));\r\n        }\r\n        else {\r\n            result.push(emptyString);\r\n        }\r\n        if (markerData.severity !== void 0 && markerData.severity !== null) {\r\n            result.push(MarkerSeverity.toString(markerData.severity));\r\n        }\r\n        else {\r\n            result.push(emptyString);\r\n        }\r\n        if (markerData.message) {\r\n            result.push(markerData.message.replace('¦', '\\¦'));\r\n        }\r\n        else {\r\n            result.push(emptyString);\r\n        }\r\n        if (markerData.startLineNumber !== void 0 && markerData.startLineNumber !== null) {\r\n            result.push(markerData.startLineNumber.toString());\r\n        }\r\n        else {\r\n            result.push(emptyString);\r\n        }\r\n        if (markerData.startColumn !== void 0 && markerData.startColumn !== null) {\r\n            result.push(markerData.startColumn.toString());\r\n        }\r\n        else {\r\n            result.push(emptyString);\r\n        }\r\n        if (markerData.endLineNumber !== void 0 && markerData.endLineNumber !== null) {\r\n            result.push(markerData.endLineNumber.toString());\r\n        }\r\n        else {\r\n            result.push(emptyString);\r\n        }\r\n        if (markerData.endColumn !== void 0 && markerData.endColumn !== null) {\r\n            result.push(markerData.endColumn.toString());\r\n        }\r\n        else {\r\n            result.push(emptyString);\r\n        }\r\n        result.push(emptyString);\r\n        return result.join('¦');\r\n    }\r\n    IMarkerData.makeKey = makeKey;\r\n})(IMarkerData || (IMarkerData = {}));\r\nexport var IMarkerService = createDecorator('markerService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { isFalsyOrEmpty } from '../../../base/common/arrays.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { MarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { Disposable, dispose } from '../../../base/common/lifecycle.js';\r\nimport * as network from '../../../base/common/network.js';\r\nimport { basename } from '../../../base/common/paths.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { EDITOR_MODEL_DEFAULTS } from '../config/editorOptions.js';\r\nimport { Range } from '../core/range.js';\r\nimport { OverviewRulerLane } from '../model.js';\r\nimport { TextModel } from '../model/textModel.js';\r\nimport { PLAINTEXT_LANGUAGE_IDENTIFIER } from '../modes/modesRegistry.js';\r\nimport { ITextResourcePropertiesService } from './resourceConfiguration.js';\r\nimport { overviewRulerError, overviewRulerInfo, overviewRulerWarning } from '../view/editorColorRegistry.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nfunction MODEL_ID(resource) {\r\n    return resource.toString();\r\n}\r\nvar ModelData = /** @class */ (function () {\r\n    function ModelData(model, onWillDispose, onDidChangeLanguage) {\r\n        this.model = model;\r\n        this._languageSelection = null;\r\n        this._languageSelectionListener = null;\r\n        this._markerDecorations = [];\r\n        this._modelEventListeners = [];\r\n        this._modelEventListeners.push(model.onWillDispose(function () { return onWillDispose(model); }));\r\n        this._modelEventListeners.push(model.onDidChangeLanguage(function (e) { return onDidChangeLanguage(model, e); }));\r\n    }\r\n    ModelData.prototype._disposeLanguageSelection = function () {\r\n        if (this._languageSelectionListener) {\r\n            this._languageSelectionListener.dispose();\r\n            this._languageSelectionListener = null;\r\n        }\r\n        if (this._languageSelection) {\r\n            this._languageSelection.dispose();\r\n            this._languageSelection = null;\r\n        }\r\n    };\r\n    ModelData.prototype.dispose = function () {\r\n        this._markerDecorations = this.model.deltaDecorations(this._markerDecorations, []);\r\n        this._modelEventListeners = dispose(this._modelEventListeners);\r\n        this._disposeLanguageSelection();\r\n    };\r\n    ModelData.prototype.acceptMarkerDecorations = function (newDecorations) {\r\n        this._markerDecorations = this.model.deltaDecorations(this._markerDecorations, newDecorations);\r\n    };\r\n    ModelData.prototype.setLanguage = function (languageSelection) {\r\n        var _this = this;\r\n        this._disposeLanguageSelection();\r\n        this._languageSelection = languageSelection;\r\n        this._languageSelectionListener = this._languageSelection.onDidChange(function () { return _this.model.setMode(languageSelection.languageIdentifier); });\r\n        this.model.setMode(languageSelection.languageIdentifier);\r\n    };\r\n    return ModelData;\r\n}());\r\nvar ModelMarkerHandler = /** @class */ (function () {\r\n    function ModelMarkerHandler() {\r\n    }\r\n    ModelMarkerHandler.setMarkers = function (modelData, markerService) {\r\n        // Limit to the first 500 errors/warnings\r\n        var markers = markerService.read({ resource: modelData.model.uri, take: 500 });\r\n        var newModelDecorations = markers.map(function (marker) {\r\n            return {\r\n                range: ModelMarkerHandler._createDecorationRange(modelData.model, marker),\r\n                options: ModelMarkerHandler._createDecorationOption(marker)\r\n            };\r\n        });\r\n        modelData.acceptMarkerDecorations(newModelDecorations);\r\n    };\r\n    ModelMarkerHandler._createDecorationRange = function (model, rawMarker) {\r\n        var ret = Range.lift(rawMarker);\r\n        if (rawMarker.severity === MarkerSeverity.Hint) {\r\n            if (!rawMarker.tags || rawMarker.tags.indexOf(1 /* Unnecessary */) === -1) {\r\n                // * never render hints on multiple lines\r\n                // * make enough space for three dots\r\n                ret = ret.setEndPosition(ret.startLineNumber, ret.startColumn + 2);\r\n            }\r\n        }\r\n        ret = model.validateRange(ret);\r\n        if (ret.isEmpty()) {\r\n            var word = model.getWordAtPosition(ret.getStartPosition());\r\n            if (word) {\r\n                ret = new Range(ret.startLineNumber, word.startColumn, ret.endLineNumber, word.endColumn);\r\n            }\r\n            else {\r\n                var maxColumn = model.getLineLastNonWhitespaceColumn(ret.startLineNumber) ||\r\n                    model.getLineMaxColumn(ret.startLineNumber);\r\n                if (maxColumn === 1) {\r\n                    // empty line\r\n                    // console.warn('marker on empty line:', marker);\r\n                }\r\n                else if (ret.endColumn >= maxColumn) {\r\n                    // behind eol\r\n                    ret = new Range(ret.startLineNumber, maxColumn - 1, ret.endLineNumber, maxColumn);\r\n                }\r\n                else {\r\n                    // extend marker to width = 1\r\n                    ret = new Range(ret.startLineNumber, ret.startColumn, ret.endLineNumber, ret.endColumn + 1);\r\n                }\r\n            }\r\n        }\r\n        else if (rawMarker.endColumn === Number.MAX_VALUE && rawMarker.startColumn === 1 && ret.startLineNumber === ret.endLineNumber) {\r\n            var minColumn = model.getLineFirstNonWhitespaceColumn(rawMarker.startLineNumber);\r\n            if (minColumn < ret.endColumn) {\r\n                ret = new Range(ret.startLineNumber, minColumn, ret.endLineNumber, ret.endColumn);\r\n                rawMarker.startColumn = minColumn;\r\n            }\r\n        }\r\n        return ret;\r\n    };\r\n    ModelMarkerHandler._createDecorationOption = function (marker) {\r\n        var className;\r\n        var color = undefined;\r\n        var zIndex;\r\n        var inlineClassName = undefined;\r\n        switch (marker.severity) {\r\n            case MarkerSeverity.Hint:\r\n                if (marker.tags && marker.tags.indexOf(1 /* Unnecessary */) >= 0) {\r\n                    className = \"squiggly-unnecessary\" /* EditorUnnecessaryDecoration */;\r\n                }\r\n                else {\r\n                    className = \"squiggly-hint\" /* EditorHintDecoration */;\r\n                }\r\n                zIndex = 0;\r\n                break;\r\n            case MarkerSeverity.Warning:\r\n                className = \"squiggly-warning\" /* EditorWarningDecoration */;\r\n                color = themeColorFromId(overviewRulerWarning);\r\n                zIndex = 20;\r\n                break;\r\n            case MarkerSeverity.Info:\r\n                className = \"squiggly-info\" /* EditorInfoDecoration */;\r\n                color = themeColorFromId(overviewRulerInfo);\r\n                zIndex = 10;\r\n                break;\r\n            case MarkerSeverity.Error:\r\n            default:\r\n                className = \"squiggly-error\" /* EditorErrorDecoration */;\r\n                color = themeColorFromId(overviewRulerError);\r\n                zIndex = 30;\r\n                break;\r\n        }\r\n        if (marker.tags) {\r\n            if (marker.tags.indexOf(1 /* Unnecessary */) !== -1) {\r\n                inlineClassName = \"squiggly-inline-unnecessary\" /* EditorUnnecessaryInlineDecoration */;\r\n            }\r\n        }\r\n        var hoverMessage = null;\r\n        var message = marker.message, source = marker.source, relatedInformation = marker.relatedInformation, code = marker.code;\r\n        if (typeof message === 'string') {\r\n            message = message.trim();\r\n            if (source) {\r\n                if (/\\n/g.test(message)) {\r\n                    if (code) {\r\n                        message = nls.localize('diagAndSourceAndCodeMultiline', \"[{0}]\\n{1} [{2}]\", source, message, code);\r\n                    }\r\n                    else {\r\n                        message = nls.localize('diagAndSourceMultiline', \"[{0}]\\n{1}\", source, message);\r\n                    }\r\n                }\r\n                else {\r\n                    if (code) {\r\n                        message = nls.localize('diagAndSourceAndCode', \"[{0}] {1} [{2}]\", source, message, code);\r\n                    }\r\n                    else {\r\n                        message = nls.localize('diagAndSource', \"[{0}] {1}\", source, message);\r\n                    }\r\n                }\r\n            }\r\n            hoverMessage = new MarkdownString().appendCodeblock('_', message);\r\n            if (!isFalsyOrEmpty(relatedInformation)) {\r\n                hoverMessage.appendMarkdown('\\n');\r\n                for (var _i = 0, _a = relatedInformation; _i < _a.length; _i++) {\r\n                    var _b = _a[_i], message_1 = _b.message, resource = _b.resource, startLineNumber = _b.startLineNumber, startColumn = _b.startColumn;\r\n                    hoverMessage.appendMarkdown(\"* [\" + basename(resource.path) + \"(\" + startLineNumber + \", \" + startColumn + \")](\" + resource.toString(false) + \"#\" + startLineNumber + \",\" + startColumn + \"): \");\r\n                    hoverMessage.appendText(\"\" + message_1);\r\n                    hoverMessage.appendMarkdown('\\n');\r\n                }\r\n                hoverMessage.appendMarkdown('\\n');\r\n            }\r\n        }\r\n        return {\r\n            stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n            className: className,\r\n            hoverMessage: hoverMessage,\r\n            showIfCollapsed: true,\r\n            overviewRuler: {\r\n                color: color,\r\n                position: OverviewRulerLane.Right\r\n            },\r\n            zIndex: zIndex,\r\n            inlineClassName: inlineClassName,\r\n        };\r\n    };\r\n    return ModelMarkerHandler;\r\n}());\r\nvar DEFAULT_EOL = (platform.isLinux || platform.isMacintosh) ? 1 /* LF */ : 2 /* CRLF */;\r\nvar ModelServiceImpl = /** @class */ (function (_super) {\r\n    __extends(ModelServiceImpl, _super);\r\n    function ModelServiceImpl(markerService, configurationService, resourcePropertiesService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onModelAdded = _this._register(new Emitter());\r\n        _this.onModelAdded = _this._onModelAdded.event;\r\n        _this._onModelRemoved = _this._register(new Emitter());\r\n        _this.onModelRemoved = _this._onModelRemoved.event;\r\n        _this._onModelModeChanged = _this._register(new Emitter());\r\n        _this.onModelModeChanged = _this._onModelModeChanged.event;\r\n        _this._markerService = markerService;\r\n        _this._configurationService = configurationService;\r\n        _this._resourcePropertiesService = resourcePropertiesService;\r\n        _this._models = {};\r\n        _this._modelCreationOptionsByLanguageAndResource = Object.create(null);\r\n        if (_this._markerService) {\r\n            _this._markerServiceSubscription = _this._markerService.onMarkerChanged(_this._handleMarkerChange, _this);\r\n        }\r\n        _this._configurationServiceSubscription = _this._configurationService.onDidChangeConfiguration(function (e) { return _this._updateModelOptions(); });\r\n        _this._updateModelOptions();\r\n        return _this;\r\n    }\r\n    ModelServiceImpl._readModelOptions = function (config, isForSimpleWidget) {\r\n        var tabSize = EDITOR_MODEL_DEFAULTS.tabSize;\r\n        if (config.editor && typeof config.editor.tabSize !== 'undefined') {\r\n            var parsedTabSize = parseInt(config.editor.tabSize, 10);\r\n            if (!isNaN(parsedTabSize)) {\r\n                tabSize = parsedTabSize;\r\n            }\r\n            if (tabSize < 1) {\r\n                tabSize = 1;\r\n            }\r\n        }\r\n        var insertSpaces = EDITOR_MODEL_DEFAULTS.insertSpaces;\r\n        if (config.editor && typeof config.editor.insertSpaces !== 'undefined') {\r\n            insertSpaces = (config.editor.insertSpaces === 'false' ? false : Boolean(config.editor.insertSpaces));\r\n        }\r\n        var newDefaultEOL = DEFAULT_EOL;\r\n        var eol = config.eol;\r\n        if (eol === '\\r\\n') {\r\n            newDefaultEOL = 2 /* CRLF */;\r\n        }\r\n        else if (eol === '\\n') {\r\n            newDefaultEOL = 1 /* LF */;\r\n        }\r\n        var trimAutoWhitespace = EDITOR_MODEL_DEFAULTS.trimAutoWhitespace;\r\n        if (config.editor && typeof config.editor.trimAutoWhitespace !== 'undefined') {\r\n            trimAutoWhitespace = (config.editor.trimAutoWhitespace === 'false' ? false : Boolean(config.editor.trimAutoWhitespace));\r\n        }\r\n        var detectIndentation = EDITOR_MODEL_DEFAULTS.detectIndentation;\r\n        if (config.editor && typeof config.editor.detectIndentation !== 'undefined') {\r\n            detectIndentation = (config.editor.detectIndentation === 'false' ? false : Boolean(config.editor.detectIndentation));\r\n        }\r\n        var largeFileOptimizations = EDITOR_MODEL_DEFAULTS.largeFileOptimizations;\r\n        if (config.editor && typeof config.editor.largeFileOptimizations !== 'undefined') {\r\n            largeFileOptimizations = (config.editor.largeFileOptimizations === 'false' ? false : Boolean(config.editor.largeFileOptimizations));\r\n        }\r\n        return {\r\n            isForSimpleWidget: isForSimpleWidget,\r\n            tabSize: tabSize,\r\n            insertSpaces: insertSpaces,\r\n            detectIndentation: detectIndentation,\r\n            defaultEOL: newDefaultEOL,\r\n            trimAutoWhitespace: trimAutoWhitespace,\r\n            largeFileOptimizations: largeFileOptimizations\r\n        };\r\n    };\r\n    ModelServiceImpl.prototype.getCreationOptions = function (language, resource, isForSimpleWidget) {\r\n        var creationOptions = this._modelCreationOptionsByLanguageAndResource[language + resource];\r\n        if (!creationOptions) {\r\n            var editor = this._configurationService.getValue('editor', { overrideIdentifier: language, resource: resource });\r\n            var eol = this._resourcePropertiesService.getEOL(resource, language);\r\n            creationOptions = ModelServiceImpl._readModelOptions({ editor: editor, eol: eol }, isForSimpleWidget);\r\n            this._modelCreationOptionsByLanguageAndResource[language + resource] = creationOptions;\r\n        }\r\n        return creationOptions;\r\n    };\r\n    ModelServiceImpl.prototype._updateModelOptions = function () {\r\n        var oldOptionsByLanguageAndResource = this._modelCreationOptionsByLanguageAndResource;\r\n        this._modelCreationOptionsByLanguageAndResource = Object.create(null);\r\n        // Update options on all models\r\n        var keys = Object.keys(this._models);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var modelId = keys[i];\r\n            var modelData = this._models[modelId];\r\n            var language = modelData.model.getLanguageIdentifier().language;\r\n            var uri = modelData.model.uri;\r\n            var oldOptions = oldOptionsByLanguageAndResource[language + uri];\r\n            var newOptions = this.getCreationOptions(language, uri, modelData.model.isForSimpleWidget);\r\n            ModelServiceImpl._setModelOptionsForModel(modelData.model, newOptions, oldOptions);\r\n        }\r\n    };\r\n    ModelServiceImpl._setModelOptionsForModel = function (model, newOptions, currentOptions) {\r\n        if (currentOptions\r\n            && (currentOptions.detectIndentation === newOptions.detectIndentation)\r\n            && (currentOptions.insertSpaces === newOptions.insertSpaces)\r\n            && (currentOptions.tabSize === newOptions.tabSize)\r\n            && (currentOptions.trimAutoWhitespace === newOptions.trimAutoWhitespace)) {\r\n            // Same indent opts, no need to touch the model\r\n            return;\r\n        }\r\n        if (newOptions.detectIndentation) {\r\n            model.detectIndentation(newOptions.insertSpaces, newOptions.tabSize);\r\n            model.updateOptions({\r\n                trimAutoWhitespace: newOptions.trimAutoWhitespace\r\n            });\r\n        }\r\n        else {\r\n            model.updateOptions({\r\n                insertSpaces: newOptions.insertSpaces,\r\n                tabSize: newOptions.tabSize,\r\n                trimAutoWhitespace: newOptions.trimAutoWhitespace\r\n            });\r\n        }\r\n    };\r\n    ModelServiceImpl.prototype.dispose = function () {\r\n        if (this._markerServiceSubscription) {\r\n            this._markerServiceSubscription.dispose();\r\n        }\r\n        this._configurationServiceSubscription.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ModelServiceImpl.prototype._handleMarkerChange = function (changedResources) {\r\n        var _this = this;\r\n        changedResources.forEach(function (resource) {\r\n            var modelId = MODEL_ID(resource);\r\n            var modelData = _this._models[modelId];\r\n            if (!modelData) {\r\n                return;\r\n            }\r\n            ModelMarkerHandler.setMarkers(modelData, _this._markerService);\r\n        });\r\n    };\r\n    ModelServiceImpl.prototype._cleanUp = function (model) {\r\n        var _this = this;\r\n        // clean up markers for internal, transient models\r\n        if (model.uri.scheme === network.Schemas.inMemory\r\n            || model.uri.scheme === network.Schemas.internal\r\n            || model.uri.scheme === network.Schemas.vscode) {\r\n            if (this._markerService) {\r\n                this._markerService.read({ resource: model.uri }).map(function (marker) { return marker.owner; }).forEach(function (owner) { return _this._markerService.remove(owner, [model.uri]); });\r\n            }\r\n        }\r\n        // clean up cache\r\n        delete this._modelCreationOptionsByLanguageAndResource[model.getLanguageIdentifier().language + model.uri];\r\n    };\r\n    // --- begin IModelService\r\n    ModelServiceImpl.prototype._createModelData = function (value, languageIdentifier, resource, isForSimpleWidget) {\r\n        var _this = this;\r\n        // create & save the model\r\n        var options = this.getCreationOptions(languageIdentifier.language, resource, isForSimpleWidget);\r\n        var model = new TextModel(value, options, languageIdentifier, resource);\r\n        var modelId = MODEL_ID(model.uri);\r\n        if (this._models[modelId]) {\r\n            // There already exists a model with this id => this is a programmer error\r\n            throw new Error('ModelService: Cannot add model because it already exists!');\r\n        }\r\n        var modelData = new ModelData(model, function (model) { return _this._onWillDispose(model); }, function (model, e) { return _this._onDidChangeLanguage(model, e); });\r\n        this._models[modelId] = modelData;\r\n        return modelData;\r\n    };\r\n    ModelServiceImpl.prototype.createModel = function (value, languageSelection, resource, isForSimpleWidget) {\r\n        if (isForSimpleWidget === void 0) { isForSimpleWidget = false; }\r\n        var modelData;\r\n        if (languageSelection) {\r\n            modelData = this._createModelData(value, languageSelection.languageIdentifier, resource, isForSimpleWidget);\r\n            this.setMode(modelData.model, languageSelection);\r\n        }\r\n        else {\r\n            modelData = this._createModelData(value, PLAINTEXT_LANGUAGE_IDENTIFIER, resource, isForSimpleWidget);\r\n        }\r\n        // handle markers (marker service => model)\r\n        if (this._markerService) {\r\n            ModelMarkerHandler.setMarkers(modelData, this._markerService);\r\n        }\r\n        this._onModelAdded.fire(modelData.model);\r\n        return modelData.model;\r\n    };\r\n    ModelServiceImpl.prototype.setMode = function (model, languageSelection) {\r\n        if (!languageSelection) {\r\n            return;\r\n        }\r\n        var modelData = this._models[MODEL_ID(model.uri)];\r\n        if (!modelData) {\r\n            return;\r\n        }\r\n        modelData.setLanguage(languageSelection);\r\n    };\r\n    ModelServiceImpl.prototype.getModels = function () {\r\n        var ret = [];\r\n        var keys = Object.keys(this._models);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var modelId = keys[i];\r\n            ret.push(this._models[modelId].model);\r\n        }\r\n        return ret;\r\n    };\r\n    ModelServiceImpl.prototype.getModel = function (resource) {\r\n        var modelId = MODEL_ID(resource);\r\n        var modelData = this._models[modelId];\r\n        if (!modelData) {\r\n            return null;\r\n        }\r\n        return modelData.model;\r\n    };\r\n    // --- end IModelService\r\n    ModelServiceImpl.prototype._onWillDispose = function (model) {\r\n        var modelId = MODEL_ID(model.uri);\r\n        var modelData = this._models[modelId];\r\n        delete this._models[modelId];\r\n        modelData.dispose();\r\n        this._cleanUp(model);\r\n        this._onModelRemoved.fire(model);\r\n    };\r\n    ModelServiceImpl.prototype._onDidChangeLanguage = function (model, e) {\r\n        var oldModeId = e.oldLanguage;\r\n        var newModeId = model.getLanguageIdentifier().language;\r\n        var oldOptions = this.getCreationOptions(oldModeId, model.uri, model.isForSimpleWidget);\r\n        var newOptions = this.getCreationOptions(newModeId, model.uri, model.isForSimpleWidget);\r\n        ModelServiceImpl._setModelOptionsForModel(model, newOptions, oldOptions);\r\n        this._onModelModeChanged.fire({ model: model, oldModeId: oldModeId });\r\n    };\r\n    ModelServiceImpl = __decorate([\r\n        __param(0, IMarkerService),\r\n        __param(1, IConfigurationService),\r\n        __param(2, ITextResourcePropertiesService)\r\n    ], ModelServiceImpl);\r\n    return ModelServiceImpl;\r\n}(Disposable));\r\nexport { ModelServiceImpl };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nvar AbstractCodeEditorService = /** @class */ (function (_super) {\r\n    __extends(AbstractCodeEditorService, _super);\r\n    function AbstractCodeEditorService() {\r\n        var _this = _super.call(this) || this;\r\n        _this._onCodeEditorAdd = _this._register(new Emitter());\r\n        _this.onCodeEditorAdd = _this._onCodeEditorAdd.event;\r\n        _this._onCodeEditorRemove = _this._register(new Emitter());\r\n        _this._onDiffEditorAdd = _this._register(new Emitter());\r\n        _this._onDiffEditorRemove = _this._register(new Emitter());\r\n        _this._codeEditors = Object.create(null);\r\n        _this._diffEditors = Object.create(null);\r\n        return _this;\r\n    }\r\n    AbstractCodeEditorService.prototype.addCodeEditor = function (editor) {\r\n        this._codeEditors[editor.getId()] = editor;\r\n        this._onCodeEditorAdd.fire(editor);\r\n    };\r\n    AbstractCodeEditorService.prototype.removeCodeEditor = function (editor) {\r\n        if (delete this._codeEditors[editor.getId()]) {\r\n            this._onCodeEditorRemove.fire(editor);\r\n        }\r\n    };\r\n    AbstractCodeEditorService.prototype.listCodeEditors = function () {\r\n        var _this = this;\r\n        return Object.keys(this._codeEditors).map(function (id) { return _this._codeEditors[id]; });\r\n    };\r\n    AbstractCodeEditorService.prototype.addDiffEditor = function (editor) {\r\n        this._diffEditors[editor.getId()] = editor;\r\n        this._onDiffEditorAdd.fire(editor);\r\n    };\r\n    AbstractCodeEditorService.prototype.removeDiffEditor = function (editor) {\r\n        if (delete this._diffEditors[editor.getId()]) {\r\n            this._onDiffEditorRemove.fire(editor);\r\n        }\r\n    };\r\n    AbstractCodeEditorService.prototype.listDiffEditors = function () {\r\n        var _this = this;\r\n        return Object.keys(this._diffEditors).map(function (id) { return _this._diffEditors[id]; });\r\n    };\r\n    AbstractCodeEditorService.prototype.getFocusedCodeEditor = function () {\r\n        var editorWithWidgetFocus = null;\r\n        var editors = this.listCodeEditors();\r\n        for (var i = 0; i < editors.length; i++) {\r\n            var editor = editors[i];\r\n            if (editor.hasTextFocus()) {\r\n                // bingo!\r\n                return editor;\r\n            }\r\n            if (editor.hasWidgetFocus()) {\r\n                editorWithWidgetFocus = editor;\r\n            }\r\n        }\r\n        return editorWithWidgetFocus;\r\n    };\r\n    return AbstractCodeEditorService;\r\n}(Disposable));\r\nexport { AbstractCodeEditorService };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { dispose as disposeAll } from '../../../base/common/lifecycle.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { AbstractCodeEditorService } from './abstractCodeEditorService.js';\r\nimport { isThemeColor } from '../../common/editorCommon.js';\r\nimport { OverviewRulerLane } from '../../common/model.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nvar CodeEditorServiceImpl = /** @class */ (function (_super) {\r\n    __extends(CodeEditorServiceImpl, _super);\r\n    function CodeEditorServiceImpl(themeService, styleSheet) {\r\n        if (styleSheet === void 0) { styleSheet = dom.createStyleSheet(); }\r\n        var _this = _super.call(this) || this;\r\n        _this._styleSheet = styleSheet;\r\n        _this._decorationOptionProviders = Object.create(null);\r\n        _this._themeService = themeService;\r\n        return _this;\r\n    }\r\n    CodeEditorServiceImpl.prototype.registerDecorationType = function (key, options, parentTypeKey) {\r\n        var provider = this._decorationOptionProviders[key];\r\n        if (!provider) {\r\n            var providerArgs = {\r\n                styleSheet: this._styleSheet,\r\n                key: key,\r\n                parentTypeKey: parentTypeKey,\r\n                options: options || Object.create(null)\r\n            };\r\n            if (!parentTypeKey) {\r\n                provider = new DecorationTypeOptionsProvider(this._themeService, providerArgs);\r\n            }\r\n            else {\r\n                provider = new DecorationSubTypeOptionsProvider(this._themeService, providerArgs);\r\n            }\r\n            this._decorationOptionProviders[key] = provider;\r\n        }\r\n        provider.refCount++;\r\n    };\r\n    CodeEditorServiceImpl.prototype.removeDecorationType = function (key) {\r\n        var provider = this._decorationOptionProviders[key];\r\n        if (provider) {\r\n            provider.refCount--;\r\n            if (provider.refCount <= 0) {\r\n                delete this._decorationOptionProviders[key];\r\n                provider.dispose();\r\n                this.listCodeEditors().forEach(function (ed) { return ed.removeDecorations(key); });\r\n            }\r\n        }\r\n    };\r\n    CodeEditorServiceImpl.prototype.resolveDecorationOptions = function (decorationTypeKey, writable) {\r\n        var provider = this._decorationOptionProviders[decorationTypeKey];\r\n        if (!provider) {\r\n            throw new Error('Unknown decoration type key: ' + decorationTypeKey);\r\n        }\r\n        return provider.getOptions(this, writable);\r\n    };\r\n    CodeEditorServiceImpl = __decorate([\r\n        __param(0, IThemeService)\r\n    ], CodeEditorServiceImpl);\r\n    return CodeEditorServiceImpl;\r\n}(AbstractCodeEditorService));\r\nexport { CodeEditorServiceImpl };\r\nvar DecorationSubTypeOptionsProvider = /** @class */ (function () {\r\n    function DecorationSubTypeOptionsProvider(themeService, providerArgs) {\r\n        this._parentTypeKey = providerArgs.parentTypeKey;\r\n        this.refCount = 0;\r\n        this._beforeContentRules = new DecorationCSSRules(3 /* BeforeContentClassName */, providerArgs, themeService);\r\n        this._afterContentRules = new DecorationCSSRules(4 /* AfterContentClassName */, providerArgs, themeService);\r\n    }\r\n    DecorationSubTypeOptionsProvider.prototype.getOptions = function (codeEditorService, writable) {\r\n        var options = codeEditorService.resolveDecorationOptions(this._parentTypeKey, true);\r\n        if (this._beforeContentRules) {\r\n            options.beforeContentClassName = this._beforeContentRules.className;\r\n        }\r\n        if (this._afterContentRules) {\r\n            options.afterContentClassName = this._afterContentRules.className;\r\n        }\r\n        return options;\r\n    };\r\n    DecorationSubTypeOptionsProvider.prototype.dispose = function () {\r\n        if (this._beforeContentRules) {\r\n            this._beforeContentRules.dispose();\r\n            this._beforeContentRules = null;\r\n        }\r\n        if (this._afterContentRules) {\r\n            this._afterContentRules.dispose();\r\n            this._afterContentRules = null;\r\n        }\r\n    };\r\n    return DecorationSubTypeOptionsProvider;\r\n}());\r\nvar DecorationTypeOptionsProvider = /** @class */ (function () {\r\n    function DecorationTypeOptionsProvider(themeService, providerArgs) {\r\n        var _this = this;\r\n        this.refCount = 0;\r\n        this._disposables = [];\r\n        var createCSSRules = function (type) {\r\n            var rules = new DecorationCSSRules(type, providerArgs, themeService);\r\n            if (rules.hasContent) {\r\n                _this._disposables.push(rules);\r\n                return rules.className;\r\n            }\r\n            return void 0;\r\n        };\r\n        var createInlineCSSRules = function (type) {\r\n            var rules = new DecorationCSSRules(type, providerArgs, themeService);\r\n            if (rules.hasContent) {\r\n                _this._disposables.push(rules);\r\n                return { className: rules.className, hasLetterSpacing: rules.hasLetterSpacing };\r\n            }\r\n            return null;\r\n        };\r\n        this.className = createCSSRules(0 /* ClassName */);\r\n        var inlineData = createInlineCSSRules(1 /* InlineClassName */);\r\n        if (inlineData) {\r\n            this.inlineClassName = inlineData.className;\r\n            this.inlineClassNameAffectsLetterSpacing = inlineData.hasLetterSpacing;\r\n        }\r\n        this.beforeContentClassName = createCSSRules(3 /* BeforeContentClassName */);\r\n        this.afterContentClassName = createCSSRules(4 /* AfterContentClassName */);\r\n        this.glyphMarginClassName = createCSSRules(2 /* GlyphMarginClassName */);\r\n        var options = providerArgs.options;\r\n        this.isWholeLine = Boolean(options.isWholeLine);\r\n        this.stickiness = options.rangeBehavior;\r\n        var lightOverviewRulerColor = options.light && options.light.overviewRulerColor || options.overviewRulerColor;\r\n        var darkOverviewRulerColor = options.dark && options.dark.overviewRulerColor || options.overviewRulerColor;\r\n        if (typeof lightOverviewRulerColor !== 'undefined'\r\n            || typeof darkOverviewRulerColor !== 'undefined') {\r\n            this.overviewRuler = {\r\n                color: lightOverviewRulerColor || darkOverviewRulerColor,\r\n                darkColor: darkOverviewRulerColor || lightOverviewRulerColor,\r\n                position: options.overviewRulerLane || OverviewRulerLane.Center\r\n            };\r\n        }\r\n    }\r\n    DecorationTypeOptionsProvider.prototype.getOptions = function (codeEditorService, writable) {\r\n        if (!writable) {\r\n            return this;\r\n        }\r\n        return {\r\n            inlineClassName: this.inlineClassName,\r\n            beforeContentClassName: this.beforeContentClassName,\r\n            afterContentClassName: this.afterContentClassName,\r\n            className: this.className,\r\n            glyphMarginClassName: this.glyphMarginClassName,\r\n            isWholeLine: this.isWholeLine,\r\n            overviewRuler: this.overviewRuler,\r\n            stickiness: this.stickiness\r\n        };\r\n    };\r\n    DecorationTypeOptionsProvider.prototype.dispose = function () {\r\n        this._disposables = disposeAll(this._disposables);\r\n    };\r\n    return DecorationTypeOptionsProvider;\r\n}());\r\nvar _CSS_MAP = {\r\n    color: 'color:{0} !important;',\r\n    opacity: 'opacity:{0}; will-change: opacity;',\r\n    backgroundColor: 'background-color:{0};',\r\n    outline: 'outline:{0};',\r\n    outlineColor: 'outline-color:{0};',\r\n    outlineStyle: 'outline-style:{0};',\r\n    outlineWidth: 'outline-width:{0};',\r\n    border: 'border:{0};',\r\n    borderColor: 'border-color:{0};',\r\n    borderRadius: 'border-radius:{0};',\r\n    borderSpacing: 'border-spacing:{0};',\r\n    borderStyle: 'border-style:{0};',\r\n    borderWidth: 'border-width:{0};',\r\n    fontStyle: 'font-style:{0};',\r\n    fontWeight: 'font-weight:{0};',\r\n    textDecoration: 'text-decoration:{0};',\r\n    cursor: 'cursor:{0};',\r\n    letterSpacing: 'letter-spacing:{0};',\r\n    gutterIconPath: 'background:url(\\'{0}\\') center center no-repeat;',\r\n    gutterIconSize: 'background-size:{0};',\r\n    contentText: 'content:\\'{0}\\';',\r\n    contentIconPath: 'content:url(\\'{0}\\');',\r\n    margin: 'margin:{0};',\r\n    width: 'width:{0};',\r\n    height: 'height:{0};'\r\n};\r\nvar DecorationCSSRules = /** @class */ (function () {\r\n    function DecorationCSSRules(ruleType, providerArgs, themeService) {\r\n        var _this = this;\r\n        this._theme = themeService.getTheme();\r\n        this._ruleType = ruleType;\r\n        this._providerArgs = providerArgs;\r\n        this._usesThemeColors = false;\r\n        this._hasContent = false;\r\n        this._hasLetterSpacing = false;\r\n        var className = CSSNameHelper.getClassName(this._providerArgs.key, ruleType);\r\n        if (this._providerArgs.parentTypeKey) {\r\n            className = className + ' ' + CSSNameHelper.getClassName(this._providerArgs.parentTypeKey, ruleType);\r\n        }\r\n        this._className = className;\r\n        this._unThemedSelector = CSSNameHelper.getSelector(this._providerArgs.key, this._providerArgs.parentTypeKey, ruleType);\r\n        this._buildCSS();\r\n        if (this._usesThemeColors) {\r\n            this._themeListener = themeService.onThemeChange(function (theme) {\r\n                _this._theme = themeService.getTheme();\r\n                _this._removeCSS();\r\n                _this._buildCSS();\r\n            });\r\n        }\r\n        else {\r\n            this._themeListener = null;\r\n        }\r\n    }\r\n    DecorationCSSRules.prototype.dispose = function () {\r\n        if (this._hasContent) {\r\n            this._removeCSS();\r\n            this._hasContent = false;\r\n        }\r\n        if (this._themeListener) {\r\n            this._themeListener.dispose();\r\n            this._themeListener = null;\r\n        }\r\n    };\r\n    Object.defineProperty(DecorationCSSRules.prototype, \"hasContent\", {\r\n        get: function () {\r\n            return this._hasContent;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorationCSSRules.prototype, \"hasLetterSpacing\", {\r\n        get: function () {\r\n            return this._hasLetterSpacing;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorationCSSRules.prototype, \"className\", {\r\n        get: function () {\r\n            return this._className;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    DecorationCSSRules.prototype._buildCSS = function () {\r\n        var options = this._providerArgs.options;\r\n        var unthemedCSS, lightCSS, darkCSS;\r\n        switch (this._ruleType) {\r\n            case 0 /* ClassName */:\r\n                unthemedCSS = this.getCSSTextForModelDecorationClassName(options);\r\n                lightCSS = this.getCSSTextForModelDecorationClassName(options.light);\r\n                darkCSS = this.getCSSTextForModelDecorationClassName(options.dark);\r\n                break;\r\n            case 1 /* InlineClassName */:\r\n                unthemedCSS = this.getCSSTextForModelDecorationInlineClassName(options);\r\n                lightCSS = this.getCSSTextForModelDecorationInlineClassName(options.light);\r\n                darkCSS = this.getCSSTextForModelDecorationInlineClassName(options.dark);\r\n                break;\r\n            case 2 /* GlyphMarginClassName */:\r\n                unthemedCSS = this.getCSSTextForModelDecorationGlyphMarginClassName(options);\r\n                lightCSS = this.getCSSTextForModelDecorationGlyphMarginClassName(options.light);\r\n                darkCSS = this.getCSSTextForModelDecorationGlyphMarginClassName(options.dark);\r\n                break;\r\n            case 3 /* BeforeContentClassName */:\r\n                unthemedCSS = this.getCSSTextForModelDecorationContentClassName(options.before);\r\n                lightCSS = this.getCSSTextForModelDecorationContentClassName(options.light && options.light.before);\r\n                darkCSS = this.getCSSTextForModelDecorationContentClassName(options.dark && options.dark.before);\r\n                break;\r\n            case 4 /* AfterContentClassName */:\r\n                unthemedCSS = this.getCSSTextForModelDecorationContentClassName(options.after);\r\n                lightCSS = this.getCSSTextForModelDecorationContentClassName(options.light && options.light.after);\r\n                darkCSS = this.getCSSTextForModelDecorationContentClassName(options.dark && options.dark.after);\r\n                break;\r\n            default:\r\n                throw new Error('Unknown rule type: ' + this._ruleType);\r\n        }\r\n        var sheet = this._providerArgs.styleSheet.sheet;\r\n        var hasContent = false;\r\n        if (unthemedCSS.length > 0) {\r\n            sheet.insertRule(this._unThemedSelector + \" {\" + unthemedCSS + \"}\", 0);\r\n            hasContent = true;\r\n        }\r\n        if (lightCSS.length > 0) {\r\n            sheet.insertRule(\".vs\" + this._unThemedSelector + \" {\" + lightCSS + \"}\", 0);\r\n            hasContent = true;\r\n        }\r\n        if (darkCSS.length > 0) {\r\n            sheet.insertRule(\".vs-dark\" + this._unThemedSelector + \", .hc-black\" + this._unThemedSelector + \" {\" + darkCSS + \"}\", 0);\r\n            hasContent = true;\r\n        }\r\n        this._hasContent = hasContent;\r\n    };\r\n    DecorationCSSRules.prototype._removeCSS = function () {\r\n        dom.removeCSSRulesContainingSelector(this._unThemedSelector, this._providerArgs.styleSheet);\r\n    };\r\n    /**\r\n     * Build the CSS for decorations styled via `className`.\r\n     */\r\n    DecorationCSSRules.prototype.getCSSTextForModelDecorationClassName = function (opts) {\r\n        if (!opts) {\r\n            return '';\r\n        }\r\n        var cssTextArr = [];\r\n        this.collectCSSText(opts, ['backgroundColor'], cssTextArr);\r\n        this.collectCSSText(opts, ['outline', 'outlineColor', 'outlineStyle', 'outlineWidth'], cssTextArr);\r\n        this.collectBorderSettingsCSSText(opts, cssTextArr);\r\n        return cssTextArr.join('');\r\n    };\r\n    /**\r\n     * Build the CSS for decorations styled via `inlineClassName`.\r\n     */\r\n    DecorationCSSRules.prototype.getCSSTextForModelDecorationInlineClassName = function (opts) {\r\n        if (!opts) {\r\n            return '';\r\n        }\r\n        var cssTextArr = [];\r\n        this.collectCSSText(opts, ['fontStyle', 'fontWeight', 'textDecoration', 'cursor', 'color', 'opacity', 'letterSpacing'], cssTextArr);\r\n        if (opts.letterSpacing) {\r\n            this._hasLetterSpacing = true;\r\n        }\r\n        return cssTextArr.join('');\r\n    };\r\n    /**\r\n     * Build the CSS for decorations styled before or after content.\r\n     */\r\n    DecorationCSSRules.prototype.getCSSTextForModelDecorationContentClassName = function (opts) {\r\n        if (!opts) {\r\n            return '';\r\n        }\r\n        var cssTextArr = [];\r\n        if (typeof opts !== 'undefined') {\r\n            this.collectBorderSettingsCSSText(opts, cssTextArr);\r\n            if (typeof opts.contentIconPath !== 'undefined') {\r\n                if (typeof opts.contentIconPath === 'string') {\r\n                    cssTextArr.push(strings.format(_CSS_MAP.contentIconPath, URI.file(opts.contentIconPath).toString().replace(/'/g, '%27')));\r\n                }\r\n                else {\r\n                    cssTextArr.push(strings.format(_CSS_MAP.contentIconPath, URI.revive(opts.contentIconPath).toString(true).replace(/'/g, '%27')));\r\n                }\r\n            }\r\n            if (typeof opts.contentText === 'string') {\r\n                var truncated = opts.contentText.match(/^.*$/m)[0]; // only take first line\r\n                var escaped = truncated.replace(/['\\\\]/g, '\\\\$&');\r\n                cssTextArr.push(strings.format(_CSS_MAP.contentText, escaped));\r\n            }\r\n            this.collectCSSText(opts, ['fontStyle', 'fontWeight', 'textDecoration', 'color', 'opacity', 'backgroundColor', 'margin'], cssTextArr);\r\n            if (this.collectCSSText(opts, ['width', 'height'], cssTextArr)) {\r\n                cssTextArr.push('display:inline-block;');\r\n            }\r\n        }\r\n        return cssTextArr.join('');\r\n    };\r\n    /**\r\n     * Build the CSS for decorations styled via `glpyhMarginClassName`.\r\n     */\r\n    DecorationCSSRules.prototype.getCSSTextForModelDecorationGlyphMarginClassName = function (opts) {\r\n        if (!opts) {\r\n            return '';\r\n        }\r\n        var cssTextArr = [];\r\n        if (typeof opts.gutterIconPath !== 'undefined') {\r\n            if (typeof opts.gutterIconPath === 'string') {\r\n                cssTextArr.push(strings.format(_CSS_MAP.gutterIconPath, URI.file(opts.gutterIconPath).toString()));\r\n            }\r\n            else {\r\n                cssTextArr.push(strings.format(_CSS_MAP.gutterIconPath, URI.revive(opts.gutterIconPath).toString(true).replace(/'/g, '%27')));\r\n            }\r\n            if (typeof opts.gutterIconSize !== 'undefined') {\r\n                cssTextArr.push(strings.format(_CSS_MAP.gutterIconSize, opts.gutterIconSize));\r\n            }\r\n        }\r\n        return cssTextArr.join('');\r\n    };\r\n    DecorationCSSRules.prototype.collectBorderSettingsCSSText = function (opts, cssTextArr) {\r\n        if (this.collectCSSText(opts, ['border', 'borderColor', 'borderRadius', 'borderSpacing', 'borderStyle', 'borderWidth'], cssTextArr)) {\r\n            cssTextArr.push(strings.format('box-sizing: border-box;'));\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    DecorationCSSRules.prototype.collectCSSText = function (opts, properties, cssTextArr) {\r\n        var lenBefore = cssTextArr.length;\r\n        for (var _i = 0, properties_1 = properties; _i < properties_1.length; _i++) {\r\n            var property = properties_1[_i];\r\n            var value = this.resolveValue(opts[property]);\r\n            if (typeof value === 'string') {\r\n                cssTextArr.push(strings.format(_CSS_MAP[property], value));\r\n            }\r\n        }\r\n        return cssTextArr.length !== lenBefore;\r\n    };\r\n    DecorationCSSRules.prototype.resolveValue = function (value) {\r\n        if (isThemeColor(value)) {\r\n            this._usesThemeColors = true;\r\n            var color = this._theme.getColor(value.id);\r\n            if (color) {\r\n                return color.toString();\r\n            }\r\n            return 'transparent';\r\n        }\r\n        return value;\r\n    };\r\n    return DecorationCSSRules;\r\n}());\r\nvar CSSNameHelper = /** @class */ (function () {\r\n    function CSSNameHelper() {\r\n    }\r\n    CSSNameHelper.getClassName = function (key, type) {\r\n        return 'ced-' + key + '-' + type;\r\n    };\r\n    CSSNameHelper.getSelector = function (key, parentKey, ruleType) {\r\n        var selector = '.monaco-editor .' + this.getClassName(key, ruleType);\r\n        if (parentKey) {\r\n            selector = selector + '.' + this.getClassName(parentKey, ruleType);\r\n        }\r\n        if (ruleType === 3 /* BeforeContentClassName */) {\r\n            selector += '::before';\r\n        }\r\n        else if (ruleType === 4 /* AfterContentClassName */) {\r\n            selector += '::after';\r\n        }\r\n        return selector;\r\n    };\r\n    return CSSNameHelper;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { windowOpenNoOpener } from '../../../base/browser/dom.js';\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport { CodeEditorServiceImpl } from '../../browser/services/codeEditorServiceImpl.js';\r\nvar StandaloneCodeEditorServiceImpl = /** @class */ (function (_super) {\r\n    __extends(StandaloneCodeEditorServiceImpl, _super);\r\n    function StandaloneCodeEditorServiceImpl() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    StandaloneCodeEditorServiceImpl.prototype.getActiveCodeEditor = function () {\r\n        return null; // not supported in the standalone case\r\n    };\r\n    StandaloneCodeEditorServiceImpl.prototype.openCodeEditor = function (input, source, sideBySide) {\r\n        if (!source) {\r\n            return Promise.resolve(null);\r\n        }\r\n        return Promise.resolve(this.doOpenEditor(source, input));\r\n    };\r\n    StandaloneCodeEditorServiceImpl.prototype.doOpenEditor = function (editor, input) {\r\n        var model = this.findModel(editor, input.resource);\r\n        if (!model) {\r\n            if (input.resource) {\r\n                var schema = input.resource.scheme;\r\n                if (schema === Schemas.http || schema === Schemas.https) {\r\n                    // This is a fully qualified http or https URL\r\n                    windowOpenNoOpener(input.resource.toString());\r\n                    return editor;\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n        var selection = (input.options ? input.options.selection : null);\r\n        if (selection) {\r\n            if (typeof selection.endLineNumber === 'number' && typeof selection.endColumn === 'number') {\r\n                editor.setSelection(selection);\r\n                editor.revealRangeInCenter(selection, 1 /* Immediate */);\r\n            }\r\n            else {\r\n                var pos = {\r\n                    lineNumber: selection.startLineNumber,\r\n                    column: selection.startColumn\r\n                };\r\n                editor.setPosition(pos);\r\n                editor.revealPositionInCenter(pos, 1 /* Immediate */);\r\n            }\r\n        }\r\n        return editor;\r\n    };\r\n    StandaloneCodeEditorServiceImpl.prototype.findModel = function (editor, resource) {\r\n        var model = editor.getModel();\r\n        if (model && model.uri.toString() !== resource.toString()) {\r\n            return null;\r\n        }\r\n        return model;\r\n    };\r\n    return StandaloneCodeEditorServiceImpl;\r\n}(CodeEditorServiceImpl));\r\nexport { StandaloneCodeEditorServiceImpl };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Color } from '../../../../base/common/color.js';\r\nvar ParsedTokenThemeRule = /** @class */ (function () {\r\n    function ParsedTokenThemeRule(token, index, fontStyle, foreground, background) {\r\n        this.token = token;\r\n        this.index = index;\r\n        this.fontStyle = fontStyle;\r\n        this.foreground = foreground;\r\n        this.background = background;\r\n    }\r\n    return ParsedTokenThemeRule;\r\n}());\r\nexport { ParsedTokenThemeRule };\r\n/**\r\n * Parse a raw theme into rules.\r\n */\r\nexport function parseTokenTheme(source) {\r\n    if (!source || !Array.isArray(source)) {\r\n        return [];\r\n    }\r\n    var result = [], resultLen = 0;\r\n    for (var i = 0, len = source.length; i < len; i++) {\r\n        var entry = source[i];\r\n        var fontStyle = -1 /* NotSet */;\r\n        if (typeof entry.fontStyle === 'string') {\r\n            fontStyle = 0 /* None */;\r\n            var segments = entry.fontStyle.split(' ');\r\n            for (var j = 0, lenJ = segments.length; j < lenJ; j++) {\r\n                var segment = segments[j];\r\n                switch (segment) {\r\n                    case 'italic':\r\n                        fontStyle = fontStyle | 1 /* Italic */;\r\n                        break;\r\n                    case 'bold':\r\n                        fontStyle = fontStyle | 2 /* Bold */;\r\n                        break;\r\n                    case 'underline':\r\n                        fontStyle = fontStyle | 4 /* Underline */;\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        var foreground = null;\r\n        if (typeof entry.foreground === 'string') {\r\n            foreground = entry.foreground;\r\n        }\r\n        var background = null;\r\n        if (typeof entry.background === 'string') {\r\n            background = entry.background;\r\n        }\r\n        result[resultLen++] = new ParsedTokenThemeRule(entry.token || '', i, fontStyle, foreground, background);\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Resolve rules (i.e. inheritance).\r\n */\r\nfunction resolveParsedTokenThemeRules(parsedThemeRules, customTokenColors) {\r\n    // Sort rules lexicographically, and then by index if necessary\r\n    parsedThemeRules.sort(function (a, b) {\r\n        var r = strcmp(a.token, b.token);\r\n        if (r !== 0) {\r\n            return r;\r\n        }\r\n        return a.index - b.index;\r\n    });\r\n    // Determine defaults\r\n    var defaultFontStyle = 0 /* None */;\r\n    var defaultForeground = '000000';\r\n    var defaultBackground = 'ffffff';\r\n    while (parsedThemeRules.length >= 1 && parsedThemeRules[0].token === '') {\r\n        var incomingDefaults = parsedThemeRules.shift();\r\n        if (incomingDefaults.fontStyle !== -1 /* NotSet */) {\r\n            defaultFontStyle = incomingDefaults.fontStyle;\r\n        }\r\n        if (incomingDefaults.foreground !== null) {\r\n            defaultForeground = incomingDefaults.foreground;\r\n        }\r\n        if (incomingDefaults.background !== null) {\r\n            defaultBackground = incomingDefaults.background;\r\n        }\r\n    }\r\n    var colorMap = new ColorMap();\r\n    // start with token colors from custom token themes\r\n    for (var _i = 0, customTokenColors_1 = customTokenColors; _i < customTokenColors_1.length; _i++) {\r\n        var color = customTokenColors_1[_i];\r\n        colorMap.getId(color);\r\n    }\r\n    var foregroundColorId = colorMap.getId(defaultForeground);\r\n    var backgroundColorId = colorMap.getId(defaultBackground);\r\n    var defaults = new ThemeTrieElementRule(defaultFontStyle, foregroundColorId, backgroundColorId);\r\n    var root = new ThemeTrieElement(defaults);\r\n    for (var i = 0, len = parsedThemeRules.length; i < len; i++) {\r\n        var rule = parsedThemeRules[i];\r\n        root.insert(rule.token, rule.fontStyle, colorMap.getId(rule.foreground), colorMap.getId(rule.background));\r\n    }\r\n    return new TokenTheme(colorMap, root);\r\n}\r\nvar colorRegExp = /^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;\r\nvar ColorMap = /** @class */ (function () {\r\n    function ColorMap() {\r\n        this._lastColorId = 0;\r\n        this._id2color = [];\r\n        this._color2id = new Map();\r\n    }\r\n    ColorMap.prototype.getId = function (color) {\r\n        if (color === null) {\r\n            return 0;\r\n        }\r\n        var match = color.match(colorRegExp);\r\n        if (!match) {\r\n            throw new Error('Illegal value for token color: ' + color);\r\n        }\r\n        color = match[1].toUpperCase();\r\n        var value = this._color2id.get(color);\r\n        if (value) {\r\n            return value;\r\n        }\r\n        value = ++this._lastColorId;\r\n        this._color2id.set(color, value);\r\n        this._id2color[value] = Color.fromHex('#' + color);\r\n        return value;\r\n    };\r\n    ColorMap.prototype.getColorMap = function () {\r\n        return this._id2color.slice(0);\r\n    };\r\n    return ColorMap;\r\n}());\r\nexport { ColorMap };\r\nvar TokenTheme = /** @class */ (function () {\r\n    function TokenTheme(colorMap, root) {\r\n        this._colorMap = colorMap;\r\n        this._root = root;\r\n        this._cache = new Map();\r\n    }\r\n    TokenTheme.createFromRawTokenTheme = function (source, customTokenColors) {\r\n        return this.createFromParsedTokenTheme(parseTokenTheme(source), customTokenColors);\r\n    };\r\n    TokenTheme.createFromParsedTokenTheme = function (source, customTokenColors) {\r\n        return resolveParsedTokenThemeRules(source, customTokenColors);\r\n    };\r\n    TokenTheme.prototype.getColorMap = function () {\r\n        return this._colorMap.getColorMap();\r\n    };\r\n    TokenTheme.prototype._match = function (token) {\r\n        return this._root.match(token);\r\n    };\r\n    TokenTheme.prototype.match = function (languageId, token) {\r\n        // The cache contains the metadata without the language bits set.\r\n        var result = this._cache.get(token);\r\n        if (typeof result === 'undefined') {\r\n            var rule = this._match(token);\r\n            var standardToken = toStandardTokenType(token);\r\n            result = (rule.metadata\r\n                | (standardToken << 8 /* TOKEN_TYPE_OFFSET */)) >>> 0;\r\n            this._cache.set(token, result);\r\n        }\r\n        return (result\r\n            | (languageId << 0 /* LANGUAGEID_OFFSET */)) >>> 0;\r\n    };\r\n    return TokenTheme;\r\n}());\r\nexport { TokenTheme };\r\nvar STANDARD_TOKEN_TYPE_REGEXP = /\\b(comment|string|regex)\\b/;\r\nexport function toStandardTokenType(tokenType) {\r\n    var m = tokenType.match(STANDARD_TOKEN_TYPE_REGEXP);\r\n    if (!m) {\r\n        return 0 /* Other */;\r\n    }\r\n    switch (m[1]) {\r\n        case 'comment':\r\n            return 1 /* Comment */;\r\n        case 'string':\r\n            return 2 /* String */;\r\n        case 'regex':\r\n            return 4 /* RegEx */;\r\n    }\r\n    throw new Error('Unexpected match for standard token type!');\r\n}\r\nexport function strcmp(a, b) {\r\n    if (a < b) {\r\n        return -1;\r\n    }\r\n    if (a > b) {\r\n        return 1;\r\n    }\r\n    return 0;\r\n}\r\nvar ThemeTrieElementRule = /** @class */ (function () {\r\n    function ThemeTrieElementRule(fontStyle, foreground, background) {\r\n        this._fontStyle = fontStyle;\r\n        this._foreground = foreground;\r\n        this._background = background;\r\n        this.metadata = ((this._fontStyle << 11 /* FONT_STYLE_OFFSET */)\r\n            | (this._foreground << 14 /* FOREGROUND_OFFSET */)\r\n            | (this._background << 23 /* BACKGROUND_OFFSET */)) >>> 0;\r\n    }\r\n    ThemeTrieElementRule.prototype.clone = function () {\r\n        return new ThemeTrieElementRule(this._fontStyle, this._foreground, this._background);\r\n    };\r\n    ThemeTrieElementRule.prototype.acceptOverwrite = function (fontStyle, foreground, background) {\r\n        if (fontStyle !== -1 /* NotSet */) {\r\n            this._fontStyle = fontStyle;\r\n        }\r\n        if (foreground !== 0 /* None */) {\r\n            this._foreground = foreground;\r\n        }\r\n        if (background !== 0 /* None */) {\r\n            this._background = background;\r\n        }\r\n        this.metadata = ((this._fontStyle << 11 /* FONT_STYLE_OFFSET */)\r\n            | (this._foreground << 14 /* FOREGROUND_OFFSET */)\r\n            | (this._background << 23 /* BACKGROUND_OFFSET */)) >>> 0;\r\n    };\r\n    return ThemeTrieElementRule;\r\n}());\r\nexport { ThemeTrieElementRule };\r\nvar ThemeTrieElement = /** @class */ (function () {\r\n    function ThemeTrieElement(mainRule) {\r\n        this._mainRule = mainRule;\r\n        this._children = new Map();\r\n    }\r\n    ThemeTrieElement.prototype.match = function (token) {\r\n        if (token === '') {\r\n            return this._mainRule;\r\n        }\r\n        var dotIndex = token.indexOf('.');\r\n        var head;\r\n        var tail;\r\n        if (dotIndex === -1) {\r\n            head = token;\r\n            tail = '';\r\n        }\r\n        else {\r\n            head = token.substring(0, dotIndex);\r\n            tail = token.substring(dotIndex + 1);\r\n        }\r\n        var child = this._children.get(head);\r\n        if (typeof child !== 'undefined') {\r\n            return child.match(tail);\r\n        }\r\n        return this._mainRule;\r\n    };\r\n    ThemeTrieElement.prototype.insert = function (token, fontStyle, foreground, background) {\r\n        if (token === '') {\r\n            // Merge into the main rule\r\n            this._mainRule.acceptOverwrite(fontStyle, foreground, background);\r\n            return;\r\n        }\r\n        var dotIndex = token.indexOf('.');\r\n        var head;\r\n        var tail;\r\n        if (dotIndex === -1) {\r\n            head = token;\r\n            tail = '';\r\n        }\r\n        else {\r\n            head = token.substring(0, dotIndex);\r\n            tail = token.substring(dotIndex + 1);\r\n        }\r\n        var child = this._children.get(head);\r\n        if (typeof child === 'undefined') {\r\n            child = new ThemeTrieElement(this._mainRule.clone());\r\n            this._children.set(head, child);\r\n        }\r\n        child.insert(tail, fontStyle, foreground, background);\r\n    };\r\n    return ThemeTrieElement;\r\n}());\r\nexport { ThemeTrieElement };\r\nexport function generateTokensCSSForColorMap(colorMap) {\r\n    var rules = [];\r\n    for (var i = 1, len = colorMap.length; i < len; i++) {\r\n        var color = colorMap[i];\r\n        rules[i] = \".mtk\" + i + \" { color: \" + color + \"; }\";\r\n    }\r\n    rules.push('.mtki { font-style: italic; }');\r\n    rules.push('.mtkb { font-weight: bold; }');\r\n    rules.push('.mtku { text-decoration: underline; text-underline-position: under; }');\r\n    return rules.join('\\n');\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar _a, _b, _c;\r\nimport { editorActiveIndentGuides, editorIndentGuides } from '../../common/view/editorColorRegistry.js';\r\nimport { editorBackground, editorForeground, editorInactiveSelection, editorSelectionHighlight } from '../../../platform/theme/common/colorRegistry.js';\r\n/* -------------------------------- Begin vs theme -------------------------------- */\r\nexport var vs = {\r\n    base: 'vs',\r\n    inherit: false,\r\n    rules: [\r\n        { token: '', foreground: '000000', background: 'fffffe' },\r\n        { token: 'invalid', foreground: 'cd3131' },\r\n        { token: 'emphasis', fontStyle: 'italic' },\r\n        { token: 'strong', fontStyle: 'bold' },\r\n        { token: 'variable', foreground: '001188' },\r\n        { token: 'variable.predefined', foreground: '4864AA' },\r\n        { token: 'constant', foreground: 'dd0000' },\r\n        { token: 'comment', foreground: '008000' },\r\n        { token: 'number', foreground: '09885A' },\r\n        { token: 'number.hex', foreground: '3030c0' },\r\n        { token: 'regexp', foreground: '800000' },\r\n        { token: 'annotation', foreground: '808080' },\r\n        { token: 'type', foreground: '008080' },\r\n        { token: 'delimiter', foreground: '000000' },\r\n        { token: 'delimiter.html', foreground: '383838' },\r\n        { token: 'delimiter.xml', foreground: '0000FF' },\r\n        { token: 'tag', foreground: '800000' },\r\n        { token: 'tag.id.pug', foreground: '4F76AC' },\r\n        { token: 'tag.class.pug', foreground: '4F76AC' },\r\n        { token: 'meta.scss', foreground: '800000' },\r\n        { token: 'metatag', foreground: 'e00000' },\r\n        { token: 'metatag.content.html', foreground: 'FF0000' },\r\n        { token: 'metatag.html', foreground: '808080' },\r\n        { token: 'metatag.xml', foreground: '808080' },\r\n        { token: 'metatag.php', fontStyle: 'bold' },\r\n        { token: 'key', foreground: '863B00' },\r\n        { token: 'string.key.json', foreground: 'A31515' },\r\n        { token: 'string.value.json', foreground: '0451A5' },\r\n        { token: 'attribute.name', foreground: 'FF0000' },\r\n        { token: 'attribute.value', foreground: '0451A5' },\r\n        { token: 'attribute.value.number', foreground: '09885A' },\r\n        { token: 'attribute.value.unit', foreground: '09885A' },\r\n        { token: 'attribute.value.html', foreground: '0000FF' },\r\n        { token: 'attribute.value.xml', foreground: '0000FF' },\r\n        { token: 'string', foreground: 'A31515' },\r\n        { token: 'string.html', foreground: '0000FF' },\r\n        { token: 'string.sql', foreground: 'FF0000' },\r\n        { token: 'string.yaml', foreground: '0451A5' },\r\n        { token: 'keyword', foreground: '0000FF' },\r\n        { token: 'keyword.json', foreground: '0451A5' },\r\n        { token: 'keyword.flow', foreground: 'AF00DB' },\r\n        { token: 'keyword.flow.scss', foreground: '0000FF' },\r\n        { token: 'operator.scss', foreground: '666666' },\r\n        { token: 'operator.sql', foreground: '778899' },\r\n        { token: 'operator.swift', foreground: '666666' },\r\n        { token: 'predefined.sql', foreground: 'FF00FF' },\r\n    ],\r\n    colors: (_a = {},\r\n        _a[editorBackground] = '#FFFFFE',\r\n        _a[editorForeground] = '#000000',\r\n        _a[editorInactiveSelection] = '#E5EBF1',\r\n        _a[editorIndentGuides] = '#D3D3D3',\r\n        _a[editorActiveIndentGuides] = '#939393',\r\n        _a[editorSelectionHighlight] = '#ADD6FF4D',\r\n        _a)\r\n};\r\n/* -------------------------------- End vs theme -------------------------------- */\r\n/* -------------------------------- Begin vs-dark theme -------------------------------- */\r\nexport var vs_dark = {\r\n    base: 'vs-dark',\r\n    inherit: false,\r\n    rules: [\r\n        { token: '', foreground: 'D4D4D4', background: '1E1E1E' },\r\n        { token: 'invalid', foreground: 'f44747' },\r\n        { token: 'emphasis', fontStyle: 'italic' },\r\n        { token: 'strong', fontStyle: 'bold' },\r\n        { token: 'variable', foreground: '74B0DF' },\r\n        { token: 'variable.predefined', foreground: '4864AA' },\r\n        { token: 'variable.parameter', foreground: '9CDCFE' },\r\n        { token: 'constant', foreground: '569CD6' },\r\n        { token: 'comment', foreground: '608B4E' },\r\n        { token: 'number', foreground: 'B5CEA8' },\r\n        { token: 'number.hex', foreground: '5BB498' },\r\n        { token: 'regexp', foreground: 'B46695' },\r\n        { token: 'annotation', foreground: 'cc6666' },\r\n        { token: 'type', foreground: '3DC9B0' },\r\n        { token: 'delimiter', foreground: 'DCDCDC' },\r\n        { token: 'delimiter.html', foreground: '808080' },\r\n        { token: 'delimiter.xml', foreground: '808080' },\r\n        { token: 'tag', foreground: '569CD6' },\r\n        { token: 'tag.id.pug', foreground: '4F76AC' },\r\n        { token: 'tag.class.pug', foreground: '4F76AC' },\r\n        { token: 'meta.scss', foreground: 'A79873' },\r\n        { token: 'meta.tag', foreground: 'CE9178' },\r\n        { token: 'metatag', foreground: 'DD6A6F' },\r\n        { token: 'metatag.content.html', foreground: '9CDCFE' },\r\n        { token: 'metatag.html', foreground: '569CD6' },\r\n        { token: 'metatag.xml', foreground: '569CD6' },\r\n        { token: 'metatag.php', fontStyle: 'bold' },\r\n        { token: 'key', foreground: '9CDCFE' },\r\n        { token: 'string.key.json', foreground: '9CDCFE' },\r\n        { token: 'string.value.json', foreground: 'CE9178' },\r\n        { token: 'attribute.name', foreground: '9CDCFE' },\r\n        { token: 'attribute.value', foreground: 'CE9178' },\r\n        { token: 'attribute.value.number.css', foreground: 'B5CEA8' },\r\n        { token: 'attribute.value.unit.css', foreground: 'B5CEA8' },\r\n        { token: 'attribute.value.hex.css', foreground: 'D4D4D4' },\r\n        { token: 'string', foreground: 'CE9178' },\r\n        { token: 'string.sql', foreground: 'FF0000' },\r\n        { token: 'keyword', foreground: '569CD6' },\r\n        { token: 'keyword.flow', foreground: 'C586C0' },\r\n        { token: 'keyword.json', foreground: 'CE9178' },\r\n        { token: 'keyword.flow.scss', foreground: '569CD6' },\r\n        { token: 'operator.scss', foreground: '909090' },\r\n        { token: 'operator.sql', foreground: '778899' },\r\n        { token: 'operator.swift', foreground: '909090' },\r\n        { token: 'predefined.sql', foreground: 'FF00FF' },\r\n    ],\r\n    colors: (_b = {},\r\n        _b[editorBackground] = '#1E1E1E',\r\n        _b[editorForeground] = '#D4D4D4',\r\n        _b[editorInactiveSelection] = '#3A3D41',\r\n        _b[editorIndentGuides] = '#404040',\r\n        _b[editorActiveIndentGuides] = '#707070',\r\n        _b[editorSelectionHighlight] = '#ADD6FF26',\r\n        _b)\r\n};\r\n/* -------------------------------- End vs-dark theme -------------------------------- */\r\n/* -------------------------------- Begin hc-black theme -------------------------------- */\r\nexport var hc_black = {\r\n    base: 'hc-black',\r\n    inherit: false,\r\n    rules: [\r\n        { token: '', foreground: 'FFFFFF', background: '000000' },\r\n        { token: 'invalid', foreground: 'f44747' },\r\n        { token: 'emphasis', fontStyle: 'italic' },\r\n        { token: 'strong', fontStyle: 'bold' },\r\n        { token: 'variable', foreground: '1AEBFF' },\r\n        { token: 'variable.parameter', foreground: '9CDCFE' },\r\n        { token: 'constant', foreground: '569CD6' },\r\n        { token: 'comment', foreground: '608B4E' },\r\n        { token: 'number', foreground: 'FFFFFF' },\r\n        { token: 'regexp', foreground: 'C0C0C0' },\r\n        { token: 'annotation', foreground: '569CD6' },\r\n        { token: 'type', foreground: '3DC9B0' },\r\n        { token: 'delimiter', foreground: 'FFFF00' },\r\n        { token: 'delimiter.html', foreground: 'FFFF00' },\r\n        { token: 'tag', foreground: '569CD6' },\r\n        { token: 'tag.id.pug', foreground: '4F76AC' },\r\n        { token: 'tag.class.pug', foreground: '4F76AC' },\r\n        { token: 'meta', foreground: 'D4D4D4' },\r\n        { token: 'meta.tag', foreground: 'CE9178' },\r\n        { token: 'metatag', foreground: '569CD6' },\r\n        { token: 'metatag.content.html', foreground: '1AEBFF' },\r\n        { token: 'metatag.html', foreground: '569CD6' },\r\n        { token: 'metatag.xml', foreground: '569CD6' },\r\n        { token: 'metatag.php', fontStyle: 'bold' },\r\n        { token: 'key', foreground: '9CDCFE' },\r\n        { token: 'string.key', foreground: '9CDCFE' },\r\n        { token: 'string.value', foreground: 'CE9178' },\r\n        { token: 'attribute.name', foreground: '569CD6' },\r\n        { token: 'attribute.value', foreground: '3FF23F' },\r\n        { token: 'string', foreground: 'CE9178' },\r\n        { token: 'string.sql', foreground: 'FF0000' },\r\n        { token: 'keyword', foreground: '569CD6' },\r\n        { token: 'keyword.flow', foreground: 'C586C0' },\r\n        { token: 'operator.sql', foreground: '778899' },\r\n        { token: 'operator.swift', foreground: '909090' },\r\n        { token: 'predefined.sql', foreground: 'FF00FF' },\r\n    ],\r\n    colors: (_c = {},\r\n        _c[editorBackground] = '#000000',\r\n        _c[editorForeground] = '#FFFFFF',\r\n        _c[editorIndentGuides] = '#FFFFFF',\r\n        _c[editorActiveIndentGuides] = '#FFFFFF',\r\n        _c)\r\n};\r\n/* -------------------------------- End hc-black theme -------------------------------- */\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { Color } from '../../../base/common/color.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { TokenizationRegistry } from '../../common/modes.js';\r\nimport { TokenTheme, generateTokensCSSForColorMap } from '../../common/modes/supports/tokenization.js';\r\nimport { hc_black, vs, vs_dark } from '../common/themes.js';\r\nimport { Registry } from '../../../platform/registry/common/platform.js';\r\nimport { Extensions } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { Extensions as ThemingExtensions } from '../../../platform/theme/common/themeService.js';\r\nvar VS_THEME_NAME = 'vs';\r\nvar VS_DARK_THEME_NAME = 'vs-dark';\r\nvar HC_BLACK_THEME_NAME = 'hc-black';\r\nvar colorRegistry = Registry.as(Extensions.ColorContribution);\r\nvar themingRegistry = Registry.as(ThemingExtensions.ThemingContribution);\r\nvar StandaloneTheme = /** @class */ (function () {\r\n    function StandaloneTheme(name, standaloneThemeData) {\r\n        this.themeData = standaloneThemeData;\r\n        var base = standaloneThemeData.base;\r\n        if (name.length > 0) {\r\n            this.id = base + ' ' + name;\r\n            this.themeName = name;\r\n        }\r\n        else {\r\n            this.id = base;\r\n            this.themeName = base;\r\n        }\r\n        this.colors = null;\r\n        this.defaultColors = Object.create(null);\r\n        this._tokenTheme = null;\r\n    }\r\n    Object.defineProperty(StandaloneTheme.prototype, \"base\", {\r\n        get: function () {\r\n            return this.themeData.base;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    StandaloneTheme.prototype.notifyBaseUpdated = function () {\r\n        if (this.themeData.inherit) {\r\n            this.colors = null;\r\n            this._tokenTheme = null;\r\n        }\r\n    };\r\n    StandaloneTheme.prototype.getColors = function () {\r\n        if (!this.colors) {\r\n            var colors = Object.create(null);\r\n            for (var id in this.themeData.colors) {\r\n                colors[id] = Color.fromHex(this.themeData.colors[id]);\r\n            }\r\n            if (this.themeData.inherit) {\r\n                var baseData = getBuiltinRules(this.themeData.base);\r\n                for (var id in baseData.colors) {\r\n                    if (!colors[id]) {\r\n                        colors[id] = Color.fromHex(baseData.colors[id]);\r\n                    }\r\n                }\r\n            }\r\n            this.colors = colors;\r\n        }\r\n        return this.colors;\r\n    };\r\n    StandaloneTheme.prototype.getColor = function (colorId, useDefault) {\r\n        var color = this.getColors()[colorId];\r\n        if (color) {\r\n            return color;\r\n        }\r\n        if (useDefault !== false) {\r\n            return this.getDefault(colorId);\r\n        }\r\n        return null;\r\n    };\r\n    StandaloneTheme.prototype.getDefault = function (colorId) {\r\n        var color = this.defaultColors[colorId];\r\n        if (color) {\r\n            return color;\r\n        }\r\n        color = colorRegistry.resolveDefaultColor(colorId, this);\r\n        this.defaultColors[colorId] = color;\r\n        return color;\r\n    };\r\n    StandaloneTheme.prototype.defines = function (colorId) {\r\n        return Object.prototype.hasOwnProperty.call(this.getColors(), colorId);\r\n    };\r\n    Object.defineProperty(StandaloneTheme.prototype, \"type\", {\r\n        get: function () {\r\n            switch (this.base) {\r\n                case VS_THEME_NAME: return 'light';\r\n                case HC_BLACK_THEME_NAME: return 'hc';\r\n                default: return 'dark';\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(StandaloneTheme.prototype, \"tokenTheme\", {\r\n        get: function () {\r\n            if (!this._tokenTheme) {\r\n                var rules = [];\r\n                var encodedTokensColors = [];\r\n                if (this.themeData.inherit) {\r\n                    var baseData = getBuiltinRules(this.themeData.base);\r\n                    rules = baseData.rules;\r\n                    if (baseData.encodedTokensColors) {\r\n                        encodedTokensColors = baseData.encodedTokensColors;\r\n                    }\r\n                }\r\n                rules = rules.concat(this.themeData.rules);\r\n                if (this.themeData.encodedTokensColors) {\r\n                    encodedTokensColors = this.themeData.encodedTokensColors;\r\n                }\r\n                this._tokenTheme = TokenTheme.createFromRawTokenTheme(rules, encodedTokensColors);\r\n            }\r\n            return this._tokenTheme;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return StandaloneTheme;\r\n}());\r\nfunction isBuiltinTheme(themeName) {\r\n    return (themeName === VS_THEME_NAME\r\n        || themeName === VS_DARK_THEME_NAME\r\n        || themeName === HC_BLACK_THEME_NAME);\r\n}\r\nfunction getBuiltinRules(builtinTheme) {\r\n    switch (builtinTheme) {\r\n        case VS_THEME_NAME:\r\n            return vs;\r\n        case VS_DARK_THEME_NAME:\r\n            return vs_dark;\r\n        case HC_BLACK_THEME_NAME:\r\n            return hc_black;\r\n    }\r\n}\r\nfunction newBuiltInTheme(builtinTheme) {\r\n    var themeData = getBuiltinRules(builtinTheme);\r\n    return new StandaloneTheme(builtinTheme, themeData);\r\n}\r\nvar StandaloneThemeServiceImpl = /** @class */ (function () {\r\n    function StandaloneThemeServiceImpl() {\r\n        this.environment = Object.create(null);\r\n        this._onThemeChange = new Emitter();\r\n        this._onIconThemeChange = new Emitter();\r\n        this._knownThemes = new Map();\r\n        this._knownThemes.set(VS_THEME_NAME, newBuiltInTheme(VS_THEME_NAME));\r\n        this._knownThemes.set(VS_DARK_THEME_NAME, newBuiltInTheme(VS_DARK_THEME_NAME));\r\n        this._knownThemes.set(HC_BLACK_THEME_NAME, newBuiltInTheme(HC_BLACK_THEME_NAME));\r\n        this._styleElement = dom.createStyleSheet();\r\n        this._styleElement.className = 'monaco-colors';\r\n        this.setTheme(VS_THEME_NAME);\r\n    }\r\n    Object.defineProperty(StandaloneThemeServiceImpl.prototype, \"onThemeChange\", {\r\n        get: function () {\r\n            return this._onThemeChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    StandaloneThemeServiceImpl.prototype.defineTheme = function (themeName, themeData) {\r\n        if (!/^[a-z0-9\\-]+$/i.test(themeName)) {\r\n            throw new Error('Illegal theme name!');\r\n        }\r\n        if (!isBuiltinTheme(themeData.base) && !isBuiltinTheme(themeName)) {\r\n            throw new Error('Illegal theme base!');\r\n        }\r\n        // set or replace theme\r\n        this._knownThemes.set(themeName, new StandaloneTheme(themeName, themeData));\r\n        if (isBuiltinTheme(themeName)) {\r\n            this._knownThemes.forEach(function (theme) {\r\n                if (theme.base === themeName) {\r\n                    theme.notifyBaseUpdated();\r\n                }\r\n            });\r\n        }\r\n        if (this._theme && this._theme.themeName === themeName) {\r\n            this.setTheme(themeName); // refresh theme\r\n        }\r\n    };\r\n    StandaloneThemeServiceImpl.prototype.getTheme = function () {\r\n        return this._theme;\r\n    };\r\n    StandaloneThemeServiceImpl.prototype.setTheme = function (themeName) {\r\n        var _this = this;\r\n        var theme;\r\n        if (this._knownThemes.has(themeName)) {\r\n            theme = this._knownThemes.get(themeName);\r\n        }\r\n        else {\r\n            theme = this._knownThemes.get(VS_THEME_NAME);\r\n        }\r\n        if (this._theme === theme) {\r\n            // Nothing to do\r\n            return theme.id;\r\n        }\r\n        this._theme = theme;\r\n        var cssRules = [];\r\n        var hasRule = {};\r\n        var ruleCollector = {\r\n            addRule: function (rule) {\r\n                if (!hasRule[rule]) {\r\n                    cssRules.push(rule);\r\n                    hasRule[rule] = true;\r\n                }\r\n            }\r\n        };\r\n        themingRegistry.getThemingParticipants().forEach(function (p) { return p(theme, ruleCollector, _this.environment); });\r\n        var tokenTheme = theme.tokenTheme;\r\n        var colorMap = tokenTheme.getColorMap();\r\n        ruleCollector.addRule(generateTokensCSSForColorMap(colorMap));\r\n        this._styleElement.innerHTML = cssRules.join('\\n');\r\n        TokenizationRegistry.setColorMap(colorMap);\r\n        this._onThemeChange.fire(theme);\r\n        return theme.id;\r\n    };\r\n    StandaloneThemeServiceImpl.prototype.getIconTheme = function () {\r\n        return {\r\n            hasFileIcons: false,\r\n            hasFolderIcons: false,\r\n            hidesExplorerArrows: false\r\n        };\r\n    };\r\n    return StandaloneThemeServiceImpl;\r\n}());\r\nexport { StandaloneThemeServiceImpl };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { Emitter, debounceEvent } from '../../../base/common/event.js';\r\nimport { dispose } from '../../../base/common/lifecycle.js';\r\nimport { keys } from '../../../base/common/map.js';\r\nimport { CommandsRegistry } from '../../commands/common/commands.js';\r\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\r\nimport { IContextKeyService, SET_CONTEXT_COMMAND_ID } from '../common/contextkey.js';\r\nimport { KeybindingResolver } from '../../keybinding/common/keybindingResolver.js';\r\nvar KEYBINDING_CONTEXT_ATTR = 'data-keybinding-context';\r\nvar Context = /** @class */ (function () {\r\n    function Context(id, parent) {\r\n        this._id = id;\r\n        this._parent = parent;\r\n        this._value = Object.create(null);\r\n        this._value['_contextId'] = id;\r\n    }\r\n    Context.prototype.setValue = function (key, value) {\r\n        // console.log('SET ' + key + ' = ' + value + ' ON ' + this._id);\r\n        if (this._value[key] !== value) {\r\n            this._value[key] = value;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Context.prototype.removeValue = function (key) {\r\n        // console.log('REMOVE ' + key + ' FROM ' + this._id);\r\n        if (key in this._value) {\r\n            delete this._value[key];\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Context.prototype.getValue = function (key) {\r\n        var ret = this._value[key];\r\n        if (typeof ret === 'undefined' && this._parent) {\r\n            return this._parent.getValue(key);\r\n        }\r\n        return ret;\r\n    };\r\n    return Context;\r\n}());\r\nexport { Context };\r\nvar NullContext = /** @class */ (function (_super) {\r\n    __extends(NullContext, _super);\r\n    function NullContext() {\r\n        return _super.call(this, -1, null) || this;\r\n    }\r\n    NullContext.prototype.setValue = function (key, value) {\r\n        return false;\r\n    };\r\n    NullContext.prototype.removeValue = function (key) {\r\n        return false;\r\n    };\r\n    NullContext.prototype.getValue = function (key) {\r\n        return undefined;\r\n    };\r\n    NullContext.INSTANCE = new NullContext();\r\n    return NullContext;\r\n}(Context));\r\nvar ConfigAwareContextValuesContainer = /** @class */ (function (_super) {\r\n    __extends(ConfigAwareContextValuesContainer, _super);\r\n    function ConfigAwareContextValuesContainer(id, _configurationService, emitter) {\r\n        var _this = _super.call(this, id, null) || this;\r\n        _this._configurationService = _configurationService;\r\n        _this._values = new Map();\r\n        _this._listener = _this._configurationService.onDidChangeConfiguration(function (event) {\r\n            if (event.source === 4 /* DEFAULT */) {\r\n                // new setting, reset everything\r\n                var allKeys = keys(_this._values);\r\n                _this._values.clear();\r\n                emitter.fire(allKeys);\r\n            }\r\n            else {\r\n                var changedKeys = [];\r\n                for (var _i = 0, _a = event.affectedKeys; _i < _a.length; _i++) {\r\n                    var configKey = _a[_i];\r\n                    var contextKey = \"config.\" + configKey;\r\n                    if (_this._values.has(contextKey)) {\r\n                        _this._values.delete(contextKey);\r\n                        changedKeys.push(contextKey);\r\n                    }\r\n                }\r\n                emitter.fire(changedKeys);\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n    ConfigAwareContextValuesContainer.prototype.dispose = function () {\r\n        this._listener.dispose();\r\n    };\r\n    ConfigAwareContextValuesContainer.prototype.getValue = function (key) {\r\n        if (key.indexOf(ConfigAwareContextValuesContainer._keyPrefix) !== 0) {\r\n            return _super.prototype.getValue.call(this, key);\r\n        }\r\n        if (this._values.has(key)) {\r\n            return this._values.get(key);\r\n        }\r\n        var configKey = key.substr(ConfigAwareContextValuesContainer._keyPrefix.length);\r\n        var configValue = this._configurationService.getValue(configKey);\r\n        var value = undefined;\r\n        switch (typeof configValue) {\r\n            case 'number':\r\n            case 'boolean':\r\n            case 'string':\r\n                value = configValue;\r\n                break;\r\n        }\r\n        this._values.set(key, value);\r\n        return value;\r\n    };\r\n    ConfigAwareContextValuesContainer.prototype.setValue = function (key, value) {\r\n        return _super.prototype.setValue.call(this, key, value);\r\n    };\r\n    ConfigAwareContextValuesContainer.prototype.removeValue = function (key) {\r\n        return _super.prototype.removeValue.call(this, key);\r\n    };\r\n    ConfigAwareContextValuesContainer._keyPrefix = 'config.';\r\n    return ConfigAwareContextValuesContainer;\r\n}(Context));\r\nvar ContextKey = /** @class */ (function () {\r\n    function ContextKey(parent, key, defaultValue) {\r\n        this._parent = parent;\r\n        this._key = key;\r\n        this._defaultValue = defaultValue;\r\n        this.reset();\r\n    }\r\n    ContextKey.prototype.set = function (value) {\r\n        this._parent.setContext(this._key, value);\r\n    };\r\n    ContextKey.prototype.reset = function () {\r\n        if (typeof this._defaultValue === 'undefined') {\r\n            this._parent.removeContext(this._key);\r\n        }\r\n        else {\r\n            this._parent.setContext(this._key, this._defaultValue);\r\n        }\r\n    };\r\n    ContextKey.prototype.get = function () {\r\n        return this._parent.getContextKeyValue(this._key);\r\n    };\r\n    return ContextKey;\r\n}());\r\nvar ContextKeyChangeEvent = /** @class */ (function () {\r\n    function ContextKeyChangeEvent() {\r\n        this._keys = [];\r\n    }\r\n    ContextKeyChangeEvent.prototype.collect = function (oneOrManyKeys) {\r\n        this._keys = this._keys.concat(oneOrManyKeys);\r\n    };\r\n    ContextKeyChangeEvent.prototype.affectsSome = function (keys) {\r\n        for (var _i = 0, _a = this._keys; _i < _a.length; _i++) {\r\n            var key = _a[_i];\r\n            if (keys.has(key)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    return ContextKeyChangeEvent;\r\n}());\r\nexport { ContextKeyChangeEvent };\r\nvar AbstractContextKeyService = /** @class */ (function () {\r\n    function AbstractContextKeyService(myContextId) {\r\n        this._isDisposed = false;\r\n        this._myContextId = myContextId;\r\n        this._onDidChangeContextKey = new Emitter();\r\n    }\r\n    AbstractContextKeyService.prototype.createKey = function (key, defaultValue) {\r\n        if (this._isDisposed) {\r\n            throw new Error(\"AbstractContextKeyService has been disposed\");\r\n        }\r\n        return new ContextKey(this, key, defaultValue);\r\n    };\r\n    Object.defineProperty(AbstractContextKeyService.prototype, \"onDidChangeContext\", {\r\n        get: function () {\r\n            if (!this._onDidChangeContext) {\r\n                this._onDidChangeContext = debounceEvent(this._onDidChangeContextKey.event, function (prev, cur) {\r\n                    if (!prev) {\r\n                        prev = new ContextKeyChangeEvent();\r\n                    }\r\n                    prev.collect(cur);\r\n                    return prev;\r\n                }, 25);\r\n            }\r\n            return this._onDidChangeContext;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AbstractContextKeyService.prototype.createScoped = function (domNode) {\r\n        if (this._isDisposed) {\r\n            throw new Error(\"AbstractContextKeyService has been disposed\");\r\n        }\r\n        return new ScopedContextKeyService(this, this._onDidChangeContextKey, domNode);\r\n    };\r\n    AbstractContextKeyService.prototype.contextMatchesRules = function (rules) {\r\n        if (this._isDisposed) {\r\n            throw new Error(\"AbstractContextKeyService has been disposed\");\r\n        }\r\n        var context = this.getContextValuesContainer(this._myContextId);\r\n        var result = KeybindingResolver.contextMatchesRules(context, rules);\r\n        // console.group(rules.serialize() + ' -> ' + result);\r\n        // rules.keys().forEach(key => { console.log(key, ctx[key]); });\r\n        // console.groupEnd();\r\n        return result;\r\n    };\r\n    AbstractContextKeyService.prototype.getContextKeyValue = function (key) {\r\n        if (this._isDisposed) {\r\n            return undefined;\r\n        }\r\n        return this.getContextValuesContainer(this._myContextId).getValue(key);\r\n    };\r\n    AbstractContextKeyService.prototype.setContext = function (key, value) {\r\n        if (this._isDisposed) {\r\n            return;\r\n        }\r\n        var myContext = this.getContextValuesContainer(this._myContextId);\r\n        if (!myContext) {\r\n            return;\r\n        }\r\n        if (myContext.setValue(key, value)) {\r\n            this._onDidChangeContextKey.fire(key);\r\n        }\r\n    };\r\n    AbstractContextKeyService.prototype.removeContext = function (key) {\r\n        if (this._isDisposed) {\r\n            return;\r\n        }\r\n        if (this.getContextValuesContainer(this._myContextId).removeValue(key)) {\r\n            this._onDidChangeContextKey.fire(key);\r\n        }\r\n    };\r\n    AbstractContextKeyService.prototype.getContext = function (target) {\r\n        if (this._isDisposed) {\r\n            return NullContext.INSTANCE;\r\n        }\r\n        return this.getContextValuesContainer(findContextAttr(target));\r\n    };\r\n    return AbstractContextKeyService;\r\n}());\r\nexport { AbstractContextKeyService };\r\nvar ContextKeyService = /** @class */ (function (_super) {\r\n    __extends(ContextKeyService, _super);\r\n    function ContextKeyService(configurationService) {\r\n        var _this = _super.call(this, 0) || this;\r\n        _this._toDispose = [];\r\n        _this._lastContextId = 0;\r\n        _this._contexts = Object.create(null);\r\n        var myContext = new ConfigAwareContextValuesContainer(_this._myContextId, configurationService, _this._onDidChangeContextKey);\r\n        _this._contexts[String(_this._myContextId)] = myContext;\r\n        _this._toDispose.push(myContext);\r\n        return _this;\r\n        // Uncomment this to see the contexts continuously logged\r\n        // let lastLoggedValue: string | null = null;\r\n        // setInterval(() => {\r\n        // \tlet values = Object.keys(this._contexts).map((key) => this._contexts[key]);\r\n        // \tlet logValue = values.map(v => JSON.stringify(v._value, null, '\\t')).join('\\n');\r\n        // \tif (lastLoggedValue !== logValue) {\r\n        // \t\tlastLoggedValue = logValue;\r\n        // \t\tconsole.log(lastLoggedValue);\r\n        // \t}\r\n        // }, 2000);\r\n    }\r\n    ContextKeyService.prototype.dispose = function () {\r\n        this._isDisposed = true;\r\n        this._toDispose = dispose(this._toDispose);\r\n    };\r\n    ContextKeyService.prototype.getContextValuesContainer = function (contextId) {\r\n        if (this._isDisposed) {\r\n            return NullContext.INSTANCE;\r\n        }\r\n        return this._contexts[String(contextId)];\r\n    };\r\n    ContextKeyService.prototype.createChildContext = function (parentContextId) {\r\n        if (parentContextId === void 0) { parentContextId = this._myContextId; }\r\n        if (this._isDisposed) {\r\n            throw new Error(\"ContextKeyService has been disposed\");\r\n        }\r\n        var id = (++this._lastContextId);\r\n        this._contexts[String(id)] = new Context(id, this.getContextValuesContainer(parentContextId));\r\n        return id;\r\n    };\r\n    ContextKeyService.prototype.disposeContext = function (contextId) {\r\n        if (this._isDisposed) {\r\n            return;\r\n        }\r\n        delete this._contexts[String(contextId)];\r\n    };\r\n    ContextKeyService = __decorate([\r\n        __param(0, IConfigurationService)\r\n    ], ContextKeyService);\r\n    return ContextKeyService;\r\n}(AbstractContextKeyService));\r\nexport { ContextKeyService };\r\nvar ScopedContextKeyService = /** @class */ (function (_super) {\r\n    __extends(ScopedContextKeyService, _super);\r\n    function ScopedContextKeyService(parent, emitter, domNode) {\r\n        var _this = _super.call(this, parent.createChildContext()) || this;\r\n        _this._parent = parent;\r\n        _this._onDidChangeContextKey = emitter;\r\n        if (domNode) {\r\n            _this._domNode = domNode;\r\n            _this._domNode.setAttribute(KEYBINDING_CONTEXT_ATTR, String(_this._myContextId));\r\n        }\r\n        return _this;\r\n    }\r\n    ScopedContextKeyService.prototype.dispose = function () {\r\n        this._isDisposed = true;\r\n        this._parent.disposeContext(this._myContextId);\r\n        if (this._domNode) {\r\n            this._domNode.removeAttribute(KEYBINDING_CONTEXT_ATTR);\r\n            this._domNode = undefined;\r\n        }\r\n    };\r\n    Object.defineProperty(ScopedContextKeyService.prototype, \"onDidChangeContext\", {\r\n        get: function () {\r\n            return this._parent.onDidChangeContext;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ScopedContextKeyService.prototype.getContextValuesContainer = function (contextId) {\r\n        if (this._isDisposed) {\r\n            return NullContext.INSTANCE;\r\n        }\r\n        return this._parent.getContextValuesContainer(contextId);\r\n    };\r\n    ScopedContextKeyService.prototype.createChildContext = function (parentContextId) {\r\n        if (parentContextId === void 0) { parentContextId = this._myContextId; }\r\n        if (this._isDisposed) {\r\n            throw new Error(\"ScopedContextKeyService has been disposed\");\r\n        }\r\n        return this._parent.createChildContext(parentContextId);\r\n    };\r\n    ScopedContextKeyService.prototype.disposeContext = function (contextId) {\r\n        if (this._isDisposed) {\r\n            return;\r\n        }\r\n        this._parent.disposeContext(contextId);\r\n    };\r\n    return ScopedContextKeyService;\r\n}(AbstractContextKeyService));\r\nfunction findContextAttr(domNode) {\r\n    while (domNode) {\r\n        if (domNode.hasAttribute(KEYBINDING_CONTEXT_ATTR)) {\r\n            var attr = domNode.getAttribute(KEYBINDING_CONTEXT_ATTR);\r\n            if (attr) {\r\n                return parseInt(attr, 10);\r\n            }\r\n            return NaN;\r\n        }\r\n        domNode = domNode.parentElement;\r\n    }\r\n    return 0;\r\n}\r\nCommandsRegistry.registerCommand(SET_CONTEXT_COMMAND_ID, function (accessor, contextKey, contextValue) {\r\n    accessor.get(IContextKeyService).createKey(String(contextKey), contextValue);\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './menu.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport * as strings from '../../../common/strings.js';\r\nimport { Action } from '../../../common/actions.js';\r\nimport { ActionBar, Separator, ActionItem, BaseActionItem } from '../actionbar/actionbar.js';\r\nimport { KeyCodeUtils } from '../../../common/keyCodes.js';\r\nimport { addClass, EventType, EventHelper, removeTabIndexAndUpdateFocus, isAncestor, hasClass, addDisposableListener, removeClass, append, $, addClasses, getClientArea, removeClasses } from '../../dom.js';\r\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\r\nimport { RunOnceScheduler } from '../../../common/async.js';\r\nimport { dispose } from '../../../common/lifecycle.js';\r\nexport var MENU_MNEMONIC_REGEX = /\\(&{1,2}(.)\\)|&{1,2}(.)/;\r\nexport var MENU_ESCAPED_MNEMONIC_REGEX = /(?:&amp;){1,2}(.)/;\r\nvar SubmenuAction = /** @class */ (function (_super) {\r\n    __extends(SubmenuAction, _super);\r\n    function SubmenuAction(label, entries, cssClass) {\r\n        var _this = _super.call(this, !!cssClass ? cssClass : 'submenu', label, '', true) || this;\r\n        _this.entries = entries;\r\n        return _this;\r\n    }\r\n    return SubmenuAction;\r\n}(Action));\r\nexport { SubmenuAction };\r\nvar Menu = /** @class */ (function (_super) {\r\n    __extends(Menu, _super);\r\n    function Menu(container, actions, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = this;\r\n        addClass(container, 'monaco-menu-container');\r\n        container.setAttribute('role', 'presentation');\r\n        var menuContainer = document.createElement('div');\r\n        addClass(menuContainer, 'monaco-menu');\r\n        menuContainer.setAttribute('role', 'presentation');\r\n        container.appendChild(menuContainer);\r\n        _this = _super.call(this, menuContainer, {\r\n            orientation: 2 /* VERTICAL */,\r\n            actionItemProvider: function (action) { return _this.doGetActionItem(action, options, parentData); },\r\n            context: options.context,\r\n            actionRunner: options.actionRunner,\r\n            ariaLabel: options.ariaLabel,\r\n            triggerKeys: { keys: [3 /* Enter */], keyDown: true }\r\n        }) || this;\r\n        _this.actionsList.setAttribute('role', 'menu');\r\n        _this.actionsList.tabIndex = 0;\r\n        _this.menuDisposables = [];\r\n        if (options.enableMnemonics) {\r\n            _this.menuDisposables.push(addDisposableListener(menuContainer, EventType.KEY_DOWN, function (e) {\r\n                var key = KeyCodeUtils.fromString(e.key);\r\n                if (_this.mnemonics.has(key)) {\r\n                    EventHelper.stop(e, true);\r\n                    var actions_1 = _this.mnemonics.get(key);\r\n                    if (actions_1.length === 1) {\r\n                        if (actions_1[0] instanceof SubmenuActionItem) {\r\n                            _this.focusItemByElement(actions_1[0].container);\r\n                        }\r\n                        actions_1[0].onClick(event);\r\n                    }\r\n                    if (actions_1.length > 1) {\r\n                        var action = actions_1.shift();\r\n                        _this.focusItemByElement(action.container);\r\n                        actions_1.push(action);\r\n                        _this.mnemonics.set(key, actions_1);\r\n                    }\r\n                }\r\n            }));\r\n        }\r\n        _this._register(addDisposableListener(_this.domNode, EventType.MOUSE_OUT, function (e) {\r\n            var relatedTarget = e.relatedTarget;\r\n            if (!isAncestor(relatedTarget, _this.domNode)) {\r\n                _this.focusedItem = undefined;\r\n                _this.updateFocus();\r\n                e.stopPropagation();\r\n            }\r\n        }));\r\n        _this._register(addDisposableListener(_this.actionsList, EventType.MOUSE_OVER, function (e) {\r\n            var target = e.target;\r\n            if (!target || !isAncestor(target, _this.actionsList) || target === _this.actionsList) {\r\n                return;\r\n            }\r\n            while (target.parentElement !== _this.actionsList) {\r\n                target = target.parentElement;\r\n            }\r\n            if (hasClass(target, 'action-item')) {\r\n                var lastFocusedItem = _this.focusedItem;\r\n                _this.setFocusedItem(target);\r\n                if (lastFocusedItem !== _this.focusedItem) {\r\n                    _this.updateFocus();\r\n                }\r\n            }\r\n        }));\r\n        var parentData = {\r\n            parent: _this\r\n        };\r\n        _this.mnemonics = new Map();\r\n        _this.push(actions, { icon: true, label: true, isMenu: true });\r\n        return _this;\r\n    }\r\n    Menu.prototype.style = function (style) {\r\n        var container = this.getContainer();\r\n        var fgColor = style.foregroundColor ? \"\" + style.foregroundColor : null;\r\n        var bgColor = style.backgroundColor ? \"\" + style.backgroundColor : null;\r\n        var border = style.borderColor ? \"2px solid \" + style.borderColor : null;\r\n        var shadow = style.shadowColor ? \"0 2px 4px \" + style.shadowColor : null;\r\n        container.style.border = border;\r\n        this.domNode.style.color = fgColor;\r\n        this.domNode.style.backgroundColor = bgColor;\r\n        container.style.boxShadow = shadow;\r\n        if (this.items) {\r\n            this.items.forEach(function (item) {\r\n                if (item instanceof MenuActionItem || item instanceof MenuSeparatorActionItem) {\r\n                    item.style(style);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    Menu.prototype.focusItemByElement = function (element) {\r\n        var lastFocusedItem = this.focusedItem;\r\n        this.setFocusedItem(element);\r\n        if (lastFocusedItem !== this.focusedItem) {\r\n            this.updateFocus();\r\n        }\r\n    };\r\n    Menu.prototype.setFocusedItem = function (element) {\r\n        for (var i = 0; i < this.actionsList.children.length; i++) {\r\n            var elem = this.actionsList.children[i];\r\n            if (element === elem) {\r\n                this.focusedItem = i;\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    Menu.prototype.doGetActionItem = function (action, options, parentData) {\r\n        if (action instanceof Separator) {\r\n            return new MenuSeparatorActionItem(options.context, action, { icon: true });\r\n        }\r\n        else if (action instanceof SubmenuAction) {\r\n            var menuActionItem = new SubmenuActionItem(action, action.entries, parentData, options);\r\n            if (options.enableMnemonics) {\r\n                var mnemonic = menuActionItem.getMnemonic();\r\n                if (mnemonic && menuActionItem.isEnabled()) {\r\n                    var actionItems = [];\r\n                    if (this.mnemonics.has(mnemonic)) {\r\n                        actionItems = this.mnemonics.get(mnemonic);\r\n                    }\r\n                    actionItems.push(menuActionItem);\r\n                    this.mnemonics.set(mnemonic, actionItems);\r\n                }\r\n            }\r\n            return menuActionItem;\r\n        }\r\n        else {\r\n            var menuItemOptions = { enableMnemonics: options.enableMnemonics };\r\n            if (options.getKeyBinding) {\r\n                var keybinding = options.getKeyBinding(action);\r\n                if (keybinding) {\r\n                    menuItemOptions.keybinding = keybinding.getLabel();\r\n                }\r\n            }\r\n            var menuActionItem = new MenuActionItem(options.context, action, menuItemOptions);\r\n            if (options.enableMnemonics) {\r\n                var mnemonic = menuActionItem.getMnemonic();\r\n                if (mnemonic && menuActionItem.isEnabled()) {\r\n                    var actionItems = [];\r\n                    if (this.mnemonics.has(mnemonic)) {\r\n                        actionItems = this.mnemonics.get(mnemonic);\r\n                    }\r\n                    actionItems.push(menuActionItem);\r\n                    this.mnemonics.set(mnemonic, actionItems);\r\n                }\r\n            }\r\n            return menuActionItem;\r\n        }\r\n    };\r\n    Menu.prototype.focus = function (selectFirst) {\r\n        if (selectFirst === void 0) { selectFirst = true; }\r\n        _super.prototype.focus.call(this, selectFirst);\r\n    };\r\n    return Menu;\r\n}(ActionBar));\r\nexport { Menu };\r\nvar MenuActionItem = /** @class */ (function (_super) {\r\n    __extends(MenuActionItem, _super);\r\n    function MenuActionItem(ctx, action, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = this;\r\n        options.isMenu = true;\r\n        _this = _super.call(this, action, action, options) || this;\r\n        _this.options = options;\r\n        _this.options.icon = options.icon !== undefined ? options.icon : false;\r\n        _this.options.label = options.label !== undefined ? options.label : true;\r\n        _this.cssClass = '';\r\n        // Set mnemonic\r\n        if (_this.options.label && options.enableMnemonics) {\r\n            var label = _this.getAction().label;\r\n            if (label) {\r\n                var matches = MENU_MNEMONIC_REGEX.exec(label);\r\n                if (matches) {\r\n                    _this.mnemonic = KeyCodeUtils.fromString((!!matches[1] ? matches[1] : matches[2]).toLocaleLowerCase());\r\n                }\r\n            }\r\n        }\r\n        return _this;\r\n    }\r\n    MenuActionItem.prototype.render = function (container) {\r\n        var _this = this;\r\n        _super.prototype.render.call(this, container);\r\n        this.container = container;\r\n        this.item = append(this.element, $('a.action-menu-item'));\r\n        if (this._action.id === Separator.ID) {\r\n            // A separator is a presentation item\r\n            this.item.setAttribute('role', 'presentation');\r\n        }\r\n        else {\r\n            this.item.setAttribute('role', 'menuitem');\r\n            if (this.mnemonic) {\r\n                this.item.setAttribute('aria-keyshortcuts', \"\" + this.mnemonic);\r\n            }\r\n        }\r\n        this.check = append(this.item, $('span.menu-item-check'));\r\n        this.check.setAttribute('role', 'none');\r\n        this.label = append(this.item, $('span.action-label'));\r\n        if (this.options.label && this.options.keybinding) {\r\n            append(this.item, $('span.keybinding')).textContent = this.options.keybinding;\r\n        }\r\n        this._register(addDisposableListener(this.element, EventType.MOUSE_UP, function (e) {\r\n            EventHelper.stop(e, true);\r\n            _this.onClick(e);\r\n        }));\r\n        this.updateClass();\r\n        this.updateLabel();\r\n        this.updateTooltip();\r\n        this.updateEnabled();\r\n        this.updateChecked();\r\n    };\r\n    MenuActionItem.prototype.blur = function () {\r\n        _super.prototype.blur.call(this);\r\n        this.applyStyle();\r\n    };\r\n    MenuActionItem.prototype.focus = function () {\r\n        _super.prototype.focus.call(this);\r\n        this.item.focus();\r\n        this.applyStyle();\r\n    };\r\n    MenuActionItem.prototype.updateLabel = function () {\r\n        if (this.options.label) {\r\n            var label = this.getAction().label;\r\n            if (label) {\r\n                var cleanLabel = cleanMnemonic(label);\r\n                if (!this.options.enableMnemonics) {\r\n                    label = cleanLabel;\r\n                }\r\n                this.label.setAttribute('aria-label', cleanLabel);\r\n                var matches = MENU_MNEMONIC_REGEX.exec(label);\r\n                if (matches) {\r\n                    label = strings.escape(label).replace(MENU_ESCAPED_MNEMONIC_REGEX, '<u aria-hidden=\"true\">$1</u>');\r\n                    this.item.setAttribute('aria-keyshortcuts', (!!matches[1] ? matches[1] : matches[2]).toLocaleLowerCase());\r\n                }\r\n            }\r\n            this.label.innerHTML = label.trim();\r\n        }\r\n    };\r\n    MenuActionItem.prototype.updateTooltip = function () {\r\n        var title = null;\r\n        if (this.getAction().tooltip) {\r\n            title = this.getAction().tooltip;\r\n        }\r\n        else if (!this.options.label && this.getAction().label && this.options.icon) {\r\n            title = this.getAction().label;\r\n            if (this.options.keybinding) {\r\n                title = nls.localize({ key: 'titleLabel', comment: ['action title', 'action keybinding'] }, \"{0} ({1})\", title, this.options.keybinding);\r\n            }\r\n        }\r\n        if (title) {\r\n            this.item.title = title;\r\n        }\r\n    };\r\n    MenuActionItem.prototype.updateClass = function () {\r\n        if (this.cssClass) {\r\n            removeClasses(this.item, this.cssClass);\r\n        }\r\n        if (this.options.icon) {\r\n            this.cssClass = this.getAction().class;\r\n            addClass(this.label, 'icon');\r\n            if (this.cssClass) {\r\n                addClasses(this.label, this.cssClass);\r\n            }\r\n            this.updateEnabled();\r\n        }\r\n        else {\r\n            removeClass(this.label, 'icon');\r\n        }\r\n    };\r\n    MenuActionItem.prototype.updateEnabled = function () {\r\n        if (this.getAction().enabled) {\r\n            removeClass(this.element, 'disabled');\r\n            removeClass(this.item, 'disabled');\r\n            this.item.tabIndex = 0;\r\n        }\r\n        else {\r\n            addClass(this.element, 'disabled');\r\n            addClass(this.item, 'disabled');\r\n            removeTabIndexAndUpdateFocus(this.item);\r\n        }\r\n    };\r\n    MenuActionItem.prototype.updateChecked = function () {\r\n        if (this.getAction().checked) {\r\n            addClass(this.item, 'checked');\r\n            this.item.setAttribute('role', 'menuitemcheckbox');\r\n            this.item.setAttribute('aria-checked', 'true');\r\n        }\r\n        else {\r\n            removeClass(this.item, 'checked');\r\n            this.item.setAttribute('role', 'menuitem');\r\n            this.item.setAttribute('aria-checked', 'false');\r\n        }\r\n    };\r\n    MenuActionItem.prototype.getMnemonic = function () {\r\n        return this.mnemonic;\r\n    };\r\n    MenuActionItem.prototype.applyStyle = function () {\r\n        var isSelected = hasClass(this.element, 'focused');\r\n        var fgColor = isSelected && this.menuStyle.selectionForegroundColor ? this.menuStyle.selectionForegroundColor : this.menuStyle.foregroundColor;\r\n        var bgColor = isSelected && this.menuStyle.selectionBackgroundColor ? this.menuStyle.selectionBackgroundColor : this.menuStyle.backgroundColor;\r\n        var border = isSelected && this.menuStyle.selectionBorderColor ? \"1px solid \" + this.menuStyle.selectionBorderColor : null;\r\n        this.item.style.color = fgColor ? \"\" + fgColor : null;\r\n        this.check.style.backgroundColor = fgColor ? \"\" + fgColor : null;\r\n        this.item.style.backgroundColor = bgColor ? \"\" + bgColor : null;\r\n        this.container.style.border = border;\r\n    };\r\n    MenuActionItem.prototype.style = function (style) {\r\n        this.menuStyle = style;\r\n        this.applyStyle();\r\n    };\r\n    return MenuActionItem;\r\n}(BaseActionItem));\r\nvar SubmenuActionItem = /** @class */ (function (_super) {\r\n    __extends(SubmenuActionItem, _super);\r\n    function SubmenuActionItem(action, submenuActions, parentData, submenuOptions) {\r\n        var _this = _super.call(this, action, action, submenuOptions) || this;\r\n        _this.submenuActions = submenuActions;\r\n        _this.parentData = parentData;\r\n        _this.submenuOptions = submenuOptions;\r\n        _this.submenuDisposables = [];\r\n        _this.showScheduler = new RunOnceScheduler(function () {\r\n            if (_this.mouseOver) {\r\n                _this.cleanupExistingSubmenu(false);\r\n                _this.createSubmenu(false);\r\n            }\r\n        }, 250);\r\n        _this.hideScheduler = new RunOnceScheduler(function () {\r\n            if ((!isAncestor(document.activeElement, _this.element) && _this.parentData.submenu === _this.mysubmenu)) {\r\n                _this.parentData.parent.focus(false);\r\n                _this.cleanupExistingSubmenu(true);\r\n            }\r\n        }, 750);\r\n        return _this;\r\n    }\r\n    SubmenuActionItem.prototype.render = function (container) {\r\n        var _this = this;\r\n        _super.prototype.render.call(this, container);\r\n        addClass(this.item, 'monaco-submenu-item');\r\n        this.item.setAttribute('aria-haspopup', 'true');\r\n        this.submenuIndicator = append(this.item, $('span.submenu-indicator'));\r\n        this.submenuIndicator.setAttribute('aria-hidden', 'true');\r\n        this._register(addDisposableListener(this.element, EventType.KEY_UP, function (e) {\r\n            var event = new StandardKeyboardEvent(e);\r\n            if (event.equals(17 /* RightArrow */) || event.equals(3 /* Enter */)) {\r\n                EventHelper.stop(e, true);\r\n                _this.createSubmenu(true);\r\n            }\r\n        }));\r\n        this._register(addDisposableListener(this.element, EventType.KEY_DOWN, function (e) {\r\n            var event = new StandardKeyboardEvent(e);\r\n            if (event.equals(17 /* RightArrow */) || event.equals(3 /* Enter */)) {\r\n                EventHelper.stop(e, true);\r\n            }\r\n        }));\r\n        this._register(addDisposableListener(this.element, EventType.MOUSE_OVER, function (e) {\r\n            if (!_this.mouseOver) {\r\n                _this.mouseOver = true;\r\n                _this.showScheduler.schedule();\r\n            }\r\n        }));\r\n        this._register(addDisposableListener(this.element, EventType.MOUSE_LEAVE, function (e) {\r\n            _this.mouseOver = false;\r\n        }));\r\n        this._register(addDisposableListener(this.element, EventType.FOCUS_OUT, function (e) {\r\n            if (!isAncestor(document.activeElement, _this.element)) {\r\n                _this.hideScheduler.schedule();\r\n            }\r\n        }));\r\n    };\r\n    SubmenuActionItem.prototype.onClick = function (e) {\r\n        // stop clicking from trying to run an action\r\n        EventHelper.stop(e, true);\r\n        this.cleanupExistingSubmenu(false);\r\n        this.createSubmenu(false);\r\n    };\r\n    SubmenuActionItem.prototype.cleanupExistingSubmenu = function (force) {\r\n        if (this.parentData.submenu && (force || (this.parentData.submenu !== this.mysubmenu))) {\r\n            this.parentData.submenu.dispose();\r\n            this.parentData.submenu = null;\r\n            if (this.submenuContainer) {\r\n                this.submenuDisposables = dispose(this.submenuDisposables);\r\n                this.submenuContainer = null;\r\n            }\r\n        }\r\n    };\r\n    SubmenuActionItem.prototype.createSubmenu = function (selectFirstItem) {\r\n        var _this = this;\r\n        if (selectFirstItem === void 0) { selectFirstItem = true; }\r\n        if (!this.parentData.submenu) {\r\n            this.submenuContainer = append(this.element, $('div.monaco-submenu'));\r\n            addClasses(this.submenuContainer, 'menubar-menu-items-holder', 'context-view');\r\n            this.submenuContainer.style.left = getClientArea(this.element).width + \"px\";\r\n            this.submenuDisposables.push(addDisposableListener(this.submenuContainer, EventType.KEY_UP, function (e) {\r\n                var event = new StandardKeyboardEvent(e);\r\n                if (event.equals(15 /* LeftArrow */)) {\r\n                    EventHelper.stop(e, true);\r\n                    _this.parentData.parent.focus();\r\n                    _this.parentData.submenu.dispose();\r\n                    _this.parentData.submenu = null;\r\n                    _this.submenuDisposables = dispose(_this.submenuDisposables);\r\n                    _this.submenuContainer = null;\r\n                }\r\n            }));\r\n            this.submenuDisposables.push(addDisposableListener(this.submenuContainer, EventType.KEY_DOWN, function (e) {\r\n                var event = new StandardKeyboardEvent(e);\r\n                if (event.equals(15 /* LeftArrow */)) {\r\n                    EventHelper.stop(e, true);\r\n                }\r\n            }));\r\n            this.parentData.submenu = new Menu(this.submenuContainer, this.submenuActions, this.submenuOptions);\r\n            if (this.menuStyle) {\r\n                this.parentData.submenu.style(this.menuStyle);\r\n            }\r\n            this.submenuDisposables.push(this.parentData.submenu.onDidCancel(function () {\r\n                _this.parentData.parent.focus();\r\n                _this.parentData.submenu.dispose();\r\n                _this.parentData.submenu = null;\r\n                _this.submenuDisposables = dispose(_this.submenuDisposables);\r\n                _this.submenuContainer = null;\r\n            }));\r\n            this.parentData.submenu.focus(selectFirstItem);\r\n            this.mysubmenu = this.parentData.submenu;\r\n        }\r\n        else {\r\n            this.parentData.submenu.focus(false);\r\n        }\r\n    };\r\n    SubmenuActionItem.prototype.applyStyle = function () {\r\n        _super.prototype.applyStyle.call(this);\r\n        var isSelected = hasClass(this.element, 'focused');\r\n        var fgColor = isSelected && this.menuStyle.selectionForegroundColor ? this.menuStyle.selectionForegroundColor : this.menuStyle.foregroundColor;\r\n        this.submenuIndicator.style.backgroundColor = fgColor ? \"\" + fgColor : null;\r\n        if (this.parentData.submenu) {\r\n            this.parentData.submenu.style(this.menuStyle);\r\n        }\r\n    };\r\n    SubmenuActionItem.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this.hideScheduler.dispose();\r\n        if (this.mysubmenu) {\r\n            this.mysubmenu.dispose();\r\n            this.mysubmenu = null;\r\n        }\r\n        if (this.submenuContainer) {\r\n            this.submenuDisposables = dispose(this.submenuDisposables);\r\n            this.submenuContainer = null;\r\n        }\r\n    };\r\n    return SubmenuActionItem;\r\n}(MenuActionItem));\r\nvar MenuSeparatorActionItem = /** @class */ (function (_super) {\r\n    __extends(MenuSeparatorActionItem, _super);\r\n    function MenuSeparatorActionItem() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MenuSeparatorActionItem.prototype.style = function (style) {\r\n        this.label.style.borderBottomColor = style.separatorColor ? \"\" + style.separatorColor : null;\r\n    };\r\n    return MenuSeparatorActionItem;\r\n}(ActionItem));\r\nexport function cleanMnemonic(label) {\r\n    var regex = MENU_MNEMONIC_REGEX;\r\n    var matches = regex.exec(label);\r\n    if (!matches) {\r\n        return label;\r\n    }\r\n    var mnemonicInText = matches[0].charAt(0) === '&';\r\n    return label.replace(regex, mnemonicInText ? '$2' : '').trim();\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { inputBackground, inputForeground, inputBorder, foreground, editorBackground, contrastBorder, listFocusBackground, listFocusForeground, listActiveSelectionBackground, listActiveSelectionForeground, listInactiveSelectionForeground, listInactiveSelectionBackground, listInactiveFocusBackground, listHoverBackground, listHoverForeground, listDropBackground, pickerGroupBorder, pickerGroupForeground, widgetShadow, inputValidationInfoBorder, inputValidationInfoBackground, inputValidationWarningBorder, inputValidationWarningBackground, inputValidationErrorBorder, inputValidationErrorBackground, activeContrastBorder, badgeBackground, badgeForeground, progressBarBackground, inputValidationInfoForeground, inputValidationWarningForeground, inputValidationErrorForeground, menuForeground, menuBackground, menuSelectionForeground, menuSelectionBackground, menuSelectionBorder, menuBorder, menuSeparatorBackground } from './colorRegistry.js';\r\nimport { mixin } from '../../../base/common/objects.js';\r\nexport function computeStyles(theme, styleMap) {\r\n    var styles = Object.create(null);\r\n    for (var key in styleMap) {\r\n        var value = styleMap[key];\r\n        if (typeof value === 'string') {\r\n            styles[key] = theme.getColor(value);\r\n        }\r\n        else if (typeof value === 'function') {\r\n            styles[key] = value(theme);\r\n        }\r\n    }\r\n    return styles;\r\n}\r\nexport function attachStyler(themeService, styleMap, widgetOrCallback) {\r\n    function applyStyles(theme) {\r\n        var styles = computeStyles(themeService.getTheme(), styleMap);\r\n        if (typeof widgetOrCallback === 'function') {\r\n            widgetOrCallback(styles);\r\n        }\r\n        else {\r\n            widgetOrCallback.style(styles);\r\n        }\r\n    }\r\n    applyStyles(themeService.getTheme());\r\n    return themeService.onThemeChange(applyStyles);\r\n}\r\nexport function attachBadgeStyler(widget, themeService, style) {\r\n    return attachStyler(themeService, {\r\n        badgeBackground: (style && style.badgeBackground) || badgeBackground,\r\n        badgeForeground: (style && style.badgeForeground) || badgeForeground,\r\n        badgeBorder: contrastBorder\r\n    }, widget);\r\n}\r\nexport function attachQuickOpenStyler(widget, themeService, style) {\r\n    return attachStyler(themeService, {\r\n        foreground: (style && style.foreground) || foreground,\r\n        background: (style && style.background) || editorBackground,\r\n        borderColor: style && style.borderColor || contrastBorder,\r\n        widgetShadow: style && style.widgetShadow || widgetShadow,\r\n        progressBarBackground: style && style.progressBarBackground || progressBarBackground,\r\n        pickerGroupForeground: style && style.pickerGroupForeground || pickerGroupForeground,\r\n        pickerGroupBorder: style && style.pickerGroupBorder || pickerGroupBorder,\r\n        inputBackground: (style && style.inputBackground) || inputBackground,\r\n        inputForeground: (style && style.inputForeground) || inputForeground,\r\n        inputBorder: (style && style.inputBorder) || inputBorder,\r\n        inputValidationInfoBorder: (style && style.inputValidationInfoBorder) || inputValidationInfoBorder,\r\n        inputValidationInfoBackground: (style && style.inputValidationInfoBackground) || inputValidationInfoBackground,\r\n        inputValidationInfoForeground: (style && style.inputValidationInfoForeground) || inputValidationInfoForeground,\r\n        inputValidationWarningBorder: (style && style.inputValidationWarningBorder) || inputValidationWarningBorder,\r\n        inputValidationWarningBackground: (style && style.inputValidationWarningBackground) || inputValidationWarningBackground,\r\n        inputValidationWarningForeground: (style && style.inputValidationWarningForeground) || inputValidationWarningForeground,\r\n        inputValidationErrorBorder: (style && style.inputValidationErrorBorder) || inputValidationErrorBorder,\r\n        inputValidationErrorBackground: (style && style.inputValidationErrorBackground) || inputValidationErrorBackground,\r\n        inputValidationErrorForeground: (style && style.inputValidationErrorForeground) || inputValidationErrorForeground,\r\n        listFocusBackground: (style && style.listFocusBackground) || listFocusBackground,\r\n        listFocusForeground: (style && style.listFocusForeground) || listFocusForeground,\r\n        listActiveSelectionBackground: (style && style.listActiveSelectionBackground) || listActiveSelectionBackground,\r\n        listActiveSelectionForeground: (style && style.listActiveSelectionForeground) || listActiveSelectionForeground,\r\n        listFocusAndSelectionBackground: style && style.listFocusAndSelectionBackground || listActiveSelectionBackground,\r\n        listFocusAndSelectionForeground: (style && style.listFocusAndSelectionForeground) || listActiveSelectionForeground,\r\n        listInactiveSelectionBackground: (style && style.listInactiveSelectionBackground) || listInactiveSelectionBackground,\r\n        listInactiveSelectionForeground: (style && style.listInactiveSelectionForeground) || listInactiveSelectionForeground,\r\n        listInactiveFocusBackground: (style && style.listInactiveFocusBackground) || listInactiveFocusBackground,\r\n        listHoverBackground: (style && style.listHoverBackground) || listHoverBackground,\r\n        listHoverForeground: (style && style.listHoverForeground) || listHoverForeground,\r\n        listDropBackground: (style && style.listDropBackground) || listDropBackground,\r\n        listFocusOutline: (style && style.listFocusOutline) || activeContrastBorder,\r\n        listSelectionOutline: (style && style.listSelectionOutline) || activeContrastBorder,\r\n        listHoverOutline: (style && style.listHoverOutline) || activeContrastBorder\r\n    }, widget);\r\n}\r\nexport function attachListStyler(widget, themeService, overrides) {\r\n    return attachStyler(themeService, mixin(overrides || Object.create(null), defaultListStyles, false), widget);\r\n}\r\nexport var defaultListStyles = {\r\n    listFocusBackground: listFocusBackground,\r\n    listFocusForeground: listFocusForeground,\r\n    listActiveSelectionBackground: listActiveSelectionBackground,\r\n    listActiveSelectionForeground: listActiveSelectionForeground,\r\n    listFocusAndSelectionBackground: listActiveSelectionBackground,\r\n    listFocusAndSelectionForeground: listActiveSelectionForeground,\r\n    listInactiveSelectionBackground: listInactiveSelectionBackground,\r\n    listInactiveSelectionForeground: listInactiveSelectionForeground,\r\n    listInactiveFocusBackground: listInactiveFocusBackground,\r\n    listHoverBackground: listHoverBackground,\r\n    listHoverForeground: listHoverForeground,\r\n    listDropBackground: listDropBackground,\r\n    listFocusOutline: activeContrastBorder,\r\n    listSelectionOutline: activeContrastBorder,\r\n    listHoverOutline: activeContrastBorder\r\n};\r\nexport var defaultMenuStyles = {\r\n    shadowColor: widgetShadow,\r\n    borderColor: menuBorder,\r\n    foregroundColor: menuForeground,\r\n    backgroundColor: menuBackground,\r\n    selectionForegroundColor: menuSelectionForeground,\r\n    selectionBackgroundColor: menuSelectionBackground,\r\n    selectionBorderColor: menuSelectionBorder,\r\n    separatorColor: menuSeparatorBackground\r\n};\r\nexport function attachMenuStyler(widget, themeService, style) {\r\n    var styles = __assign({}, defaultMenuStyles, style);\r\n    var fallback = {\r\n        foregroundColor: !!styles.foregroundColor && !!themeService && !!themeService.getTheme().getColor(styles.foregroundColor) ? styles.foregroundColor : foreground\r\n    };\r\n    return attachStyler(themeService, __assign({}, styles, fallback), widget);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './contextMenuHandler.css';\r\nimport { combinedDisposable, dispose } from '../../../base/common/lifecycle.js';\r\nimport { StandardMouseEvent } from '../../../base/browser/mouseEvent.js';\r\nimport { ActionRunner } from '../../../base/common/actions.js';\r\nimport { Menu } from '../../../base/browser/ui/menu/menu.js';\r\nimport { addDisposableListener, EventType } from '../../../base/browser/dom.js';\r\nimport { attachMenuStyler } from '../../theme/common/styler.js';\r\nimport { domEvent } from '../../../base/browser/event.js';\r\nvar ContextMenuHandler = /** @class */ (function () {\r\n    function ContextMenuHandler(element, contextViewService, telemetryService, notificationService, keybindingService, themeService) {\r\n        this.contextViewService = contextViewService;\r\n        this.telemetryService = telemetryService;\r\n        this.notificationService = notificationService;\r\n        this.keybindingService = keybindingService;\r\n        this.themeService = themeService;\r\n        this.setContainer(element);\r\n    }\r\n    ContextMenuHandler.prototype.setContainer = function (container) {\r\n        var _this = this;\r\n        if (this.element) {\r\n            this.elementDisposable = dispose(this.elementDisposable);\r\n            this.element = null;\r\n        }\r\n        if (container) {\r\n            this.element = container;\r\n            this.elementDisposable = addDisposableListener(this.element, EventType.MOUSE_DOWN, function (e) { return _this.onMouseDown(e); });\r\n        }\r\n    };\r\n    ContextMenuHandler.prototype.showContextMenu = function (delegate) {\r\n        var _this = this;\r\n        delegate.getActions().then(function (actions) {\r\n            if (!actions.length) {\r\n                return; // Don't render an empty context menu\r\n            }\r\n            _this.focusToReturn = document.activeElement;\r\n            var menu;\r\n            _this.contextViewService.showContextView({\r\n                getAnchor: function () { return delegate.getAnchor(); },\r\n                canRelayout: false,\r\n                render: function (container) {\r\n                    _this.menuContainerElement = container;\r\n                    var className = delegate.getMenuClassName ? delegate.getMenuClassName() : '';\r\n                    if (className) {\r\n                        container.className += ' ' + className;\r\n                    }\r\n                    var menuDisposables = [];\r\n                    var actionRunner = delegate.actionRunner || new ActionRunner();\r\n                    actionRunner.onDidBeforeRun(_this.onActionRun, _this, menuDisposables);\r\n                    actionRunner.onDidRun(_this.onDidActionRun, _this, menuDisposables);\r\n                    menu = new Menu(container, actions, {\r\n                        actionItemProvider: delegate.getActionItem,\r\n                        context: delegate.getActionsContext ? delegate.getActionsContext() : null,\r\n                        actionRunner: actionRunner,\r\n                        getKeyBinding: delegate.getKeyBinding ? delegate.getKeyBinding : function (action) { return _this.keybindingService.lookupKeybinding(action.id); }\r\n                    });\r\n                    menuDisposables.push(attachMenuStyler(menu, _this.themeService));\r\n                    menu.onDidCancel(function () { return _this.contextViewService.hideContextView(true); }, null, menuDisposables);\r\n                    menu.onDidBlur(function () { return _this.contextViewService.hideContextView(true); }, null, menuDisposables);\r\n                    domEvent(window, EventType.BLUR)(function () { _this.contextViewService.hideContextView(true); }, null, menuDisposables);\r\n                    return combinedDisposable(menuDisposables.concat([menu]));\r\n                },\r\n                focus: function () {\r\n                    menu.focus(!!delegate.autoSelectFirstItem);\r\n                },\r\n                onHide: function (didCancel) {\r\n                    if (delegate.onHide) {\r\n                        delegate.onHide(didCancel);\r\n                    }\r\n                    _this.menuContainerElement = null;\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ContextMenuHandler.prototype.onActionRun = function (e) {\r\n        if (this.telemetryService) {\r\n            /* __GDPR__\r\n                \"workbenchActionExecuted\" : {\r\n                    \"id\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\r\n                    \"from\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\r\n                }\r\n            */\r\n            this.telemetryService.publicLog('workbenchActionExecuted', { id: e.action.id, from: 'contextMenu' });\r\n        }\r\n        this.contextViewService.hideContextView(false);\r\n        // Restore focus here\r\n        if (this.focusToReturn) {\r\n            this.focusToReturn.focus();\r\n        }\r\n    };\r\n    ContextMenuHandler.prototype.onDidActionRun = function (e) {\r\n        if (e.error && this.notificationService) {\r\n            this.notificationService.error(e.error);\r\n        }\r\n    };\r\n    ContextMenuHandler.prototype.onMouseDown = function (e) {\r\n        if (!this.menuContainerElement) {\r\n            return;\r\n        }\r\n        var event = new StandardMouseEvent(e);\r\n        var element = event.target;\r\n        while (element) {\r\n            if (element === this.menuContainerElement) {\r\n                return;\r\n            }\r\n            element = element.parentElement;\r\n        }\r\n        this.contextViewService.hideContextView();\r\n    };\r\n    ContextMenuHandler.prototype.dispose = function () {\r\n        this.setContainer(null);\r\n    };\r\n    return ContextMenuHandler;\r\n}());\r\nexport { ContextMenuHandler };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { ContextMenuHandler } from './contextMenuHandler.js';\r\nimport { IContextViewService } from './contextView.js';\r\nimport { ITelemetryService } from '../../telemetry/common/telemetry.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { INotificationService } from '../../notification/common/notification.js';\r\nimport { IThemeService } from '../../theme/common/themeService.js';\r\nimport { IKeybindingService } from '../../keybinding/common/keybinding.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nvar ContextMenuService = /** @class */ (function (_super) {\r\n    __extends(ContextMenuService, _super);\r\n    function ContextMenuService(container, telemetryService, notificationService, contextViewService, keybindingService, themeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onDidContextMenu = _this._register(new Emitter());\r\n        _this.contextMenuHandler = _this._register(new ContextMenuHandler(container, contextViewService, telemetryService, notificationService, keybindingService, themeService));\r\n        return _this;\r\n    }\r\n    ContextMenuService.prototype.dispose = function () {\r\n        this.contextMenuHandler.dispose();\r\n    };\r\n    // ContextMenu\r\n    ContextMenuService.prototype.showContextMenu = function (delegate) {\r\n        this.contextMenuHandler.showContextMenu(delegate);\r\n        this._onDidContextMenu.fire();\r\n    };\r\n    ContextMenuService = __decorate([\r\n        __param(1, ITelemetryService),\r\n        __param(2, INotificationService),\r\n        __param(3, IContextViewService),\r\n        __param(4, IKeybindingService),\r\n        __param(5, IThemeService)\r\n    ], ContextMenuService);\r\n    return ContextMenuService;\r\n}(Disposable));\r\nexport { ContextMenuService };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport var Range;\r\n(function (Range) {\r\n    /**\r\n     * Returns the intersection between two ranges as a range itself.\r\n     * Returns `{ start: 0, end: 0 }` if the intersection is empty.\r\n     */\r\n    function intersect(one, other) {\r\n        if (one.start >= other.end || other.start >= one.end) {\r\n            return { start: 0, end: 0 };\r\n        }\r\n        var start = Math.max(one.start, other.start);\r\n        var end = Math.min(one.end, other.end);\r\n        if (end - start <= 0) {\r\n            return { start: 0, end: 0 };\r\n        }\r\n        return { start: start, end: end };\r\n    }\r\n    Range.intersect = intersect;\r\n    function isEmpty(range) {\r\n        return range.end - range.start <= 0;\r\n    }\r\n    Range.isEmpty = isEmpty;\r\n    function intersects(one, other) {\r\n        return !isEmpty(intersect(one, other));\r\n    }\r\n    Range.intersects = intersects;\r\n    function relativeComplement(one, other) {\r\n        var result = [];\r\n        var first = { start: one.start, end: Math.min(other.start, one.end) };\r\n        var second = { start: Math.max(other.end, one.start), end: one.end };\r\n        if (!isEmpty(first)) {\r\n            result.push(first);\r\n        }\r\n        if (!isEmpty(second)) {\r\n            result.push(second);\r\n        }\r\n        return result;\r\n    }\r\n    Range.relativeComplement = relativeComplement;\r\n})(Range || (Range = {}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './contextview.css';\r\nimport * as DOM from '../../dom.js';\r\nimport { dispose, toDisposable, combinedDisposable, Disposable } from '../../../common/lifecycle.js';\r\nimport { Range } from '../../../common/range.js';\r\n/**\r\n * Lays out a one dimensional view next to an anchor in a viewport.\r\n *\r\n * @returns The view offset within the viewport.\r\n */\r\nexport function layout(viewportSize, viewSize, anchor) {\r\n    var anchorEnd = anchor.offset + anchor.size;\r\n    if (anchor.position === 0 /* Before */) {\r\n        if (viewSize <= viewportSize - anchorEnd) {\r\n            return anchorEnd; // happy case, lay it out after the anchor\r\n        }\r\n        if (viewSize <= anchor.offset) {\r\n            return anchor.offset - viewSize; // ok case, lay it out before the anchor\r\n        }\r\n        return Math.max(viewportSize - viewSize, 0); // sad case, lay it over the anchor\r\n    }\r\n    else {\r\n        if (viewSize <= anchor.offset) {\r\n            return anchor.offset - viewSize; // happy case, lay it out before the anchor\r\n        }\r\n        if (viewSize <= viewportSize - anchorEnd) {\r\n            return anchorEnd; // ok case, lay it out after the anchor\r\n        }\r\n        return 0; // sad case, lay it over the anchor\r\n    }\r\n}\r\nvar ContextView = /** @class */ (function (_super) {\r\n    __extends(ContextView, _super);\r\n    function ContextView(container) {\r\n        var _this = _super.call(this) || this;\r\n        _this.view = DOM.$('.context-view');\r\n        DOM.hide(_this.view);\r\n        _this.setContainer(container);\r\n        _this._register(toDisposable(function () { return _this.setContainer(null); }));\r\n        return _this;\r\n    }\r\n    ContextView.prototype.setContainer = function (container) {\r\n        var _this = this;\r\n        if (this.container) {\r\n            this.toDisposeOnSetContainer = dispose(this.toDisposeOnSetContainer);\r\n            this.container.removeChild(this.view);\r\n            this.container = null;\r\n        }\r\n        if (container) {\r\n            this.container = container;\r\n            this.container.appendChild(this.view);\r\n            var toDisposeOnSetContainer_1 = [];\r\n            ContextView.BUBBLE_UP_EVENTS.forEach(function (event) {\r\n                toDisposeOnSetContainer_1.push(DOM.addStandardDisposableListener(_this.container, event, function (e) {\r\n                    _this.onDOMEvent(e, document.activeElement, false);\r\n                }));\r\n            });\r\n            ContextView.BUBBLE_DOWN_EVENTS.forEach(function (event) {\r\n                toDisposeOnSetContainer_1.push(DOM.addStandardDisposableListener(_this.container, event, function (e) {\r\n                    _this.onDOMEvent(e, document.activeElement, true);\r\n                }, true));\r\n            });\r\n            this.toDisposeOnSetContainer = combinedDisposable(toDisposeOnSetContainer_1);\r\n        }\r\n    };\r\n    ContextView.prototype.show = function (delegate) {\r\n        if (this.isVisible()) {\r\n            this.hide();\r\n        }\r\n        // Show static box\r\n        DOM.clearNode(this.view);\r\n        this.view.className = 'context-view';\r\n        this.view.style.top = '0px';\r\n        this.view.style.left = '0px';\r\n        DOM.show(this.view);\r\n        // Render content\r\n        this.toDisposeOnClean = delegate.render(this.view);\r\n        // Set active delegate\r\n        this.delegate = delegate;\r\n        // Layout\r\n        this.doLayout();\r\n        // Focus\r\n        if (this.delegate.focus) {\r\n            this.delegate.focus();\r\n        }\r\n    };\r\n    ContextView.prototype.layout = function () {\r\n        if (!this.isVisible()) {\r\n            return;\r\n        }\r\n        if (this.delegate.canRelayout === false) {\r\n            this.hide();\r\n            return;\r\n        }\r\n        if (this.delegate.layout) {\r\n            this.delegate.layout();\r\n        }\r\n        this.doLayout();\r\n    };\r\n    ContextView.prototype.doLayout = function () {\r\n        // Check that we still have a delegate - this.delegate.layout may have hidden\r\n        if (!this.isVisible()) {\r\n            return;\r\n        }\r\n        // Get anchor\r\n        var anchor = this.delegate.getAnchor();\r\n        // Compute around\r\n        var around;\r\n        // Get the element's position and size (to anchor the view)\r\n        if (DOM.isHTMLElement(anchor)) {\r\n            var elementPosition = DOM.getDomNodePagePosition(anchor);\r\n            around = {\r\n                top: elementPosition.top,\r\n                left: elementPosition.left,\r\n                width: elementPosition.width,\r\n                height: elementPosition.height\r\n            };\r\n        }\r\n        else {\r\n            var realAnchor = anchor;\r\n            around = {\r\n                top: realAnchor.y,\r\n                left: realAnchor.x,\r\n                width: realAnchor.width || 1,\r\n                height: realAnchor.height || 2\r\n            };\r\n        }\r\n        var viewSizeWidth = DOM.getTotalWidth(this.view);\r\n        var viewSizeHeight = DOM.getTotalHeight(this.view);\r\n        var anchorPosition = this.delegate.anchorPosition || 0 /* BELOW */;\r\n        var anchorAlignment = this.delegate.anchorAlignment || 0 /* LEFT */;\r\n        var verticalAnchor = { offset: around.top - window.pageYOffset, size: around.height, position: anchorPosition === 0 /* BELOW */ ? 0 /* Before */ : 1 /* After */ };\r\n        var horizontalAnchor;\r\n        if (anchorAlignment === 0 /* LEFT */) {\r\n            horizontalAnchor = { offset: around.left, size: 0, position: 0 /* Before */ };\r\n        }\r\n        else {\r\n            horizontalAnchor = { offset: around.left + around.width, size: 0, position: 1 /* After */ };\r\n        }\r\n        var top = layout(window.innerHeight, viewSizeHeight, verticalAnchor) + window.pageYOffset;\r\n        // if view intersects vertically with anchor, shift it horizontally\r\n        if (Range.intersects({ start: top, end: top + viewSizeHeight }, { start: verticalAnchor.offset, end: verticalAnchor.offset + verticalAnchor.size })) {\r\n            horizontalAnchor.size = around.width;\r\n        }\r\n        var left = layout(window.innerWidth, viewSizeWidth, horizontalAnchor);\r\n        DOM.removeClasses(this.view, 'top', 'bottom', 'left', 'right');\r\n        DOM.addClass(this.view, anchorPosition === 0 /* BELOW */ ? 'bottom' : 'top');\r\n        DOM.addClass(this.view, anchorAlignment === 0 /* LEFT */ ? 'left' : 'right');\r\n        var containerPosition = DOM.getDomNodePagePosition(this.container);\r\n        this.view.style.top = top - containerPosition.top + \"px\";\r\n        this.view.style.left = left - containerPosition.left + \"px\";\r\n        this.view.style.width = 'initial';\r\n    };\r\n    ContextView.prototype.hide = function (data) {\r\n        if (this.delegate && this.delegate.onHide) {\r\n            this.delegate.onHide(data);\r\n        }\r\n        this.delegate = null;\r\n        if (this.toDisposeOnClean) {\r\n            this.toDisposeOnClean.dispose();\r\n            this.toDisposeOnClean = null;\r\n        }\r\n        DOM.hide(this.view);\r\n    };\r\n    ContextView.prototype.isVisible = function () {\r\n        return !!this.delegate;\r\n    };\r\n    ContextView.prototype.onDOMEvent = function (e, element, onCapture) {\r\n        if (this.delegate) {\r\n            if (this.delegate.onDOMEvent) {\r\n                this.delegate.onDOMEvent(e, document.activeElement);\r\n            }\r\n            else if (onCapture && !DOM.isAncestor(e.target, this.container)) {\r\n                this.hide();\r\n            }\r\n        }\r\n    };\r\n    ContextView.prototype.dispose = function () {\r\n        this.hide();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ContextView.BUBBLE_UP_EVENTS = ['click', 'keydown', 'focus', 'blur'];\r\n    ContextView.BUBBLE_DOWN_EVENTS = ['click'];\r\n    return ContextView;\r\n}(Disposable));\r\nexport { ContextView };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator as createServiceDecorator } from '../../instantiation/common/instantiation.js';\r\nexport var ILogService = createServiceDecorator('logService');\r\nvar NullLogService = /** @class */ (function () {\r\n    function NullLogService() {\r\n    }\r\n    NullLogService.prototype.trace = function (message) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n    };\r\n    NullLogService.prototype.error = function (message) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n    };\r\n    NullLogService.prototype.dispose = function () { };\r\n    return NullLogService;\r\n}());\r\nexport { NullLogService };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { ContextView } from '../../../base/browser/ui/contextview/contextview.js';\r\nimport { ITelemetryService } from '../../telemetry/common/telemetry.js';\r\nimport { ILogService } from '../../log/common/log.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nvar ContextViewService = /** @class */ (function (_super) {\r\n    __extends(ContextViewService, _super);\r\n    function ContextViewService(container, telemetryService, logService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.logService = logService;\r\n        _this.contextView = _this._register(new ContextView(container));\r\n        return _this;\r\n    }\r\n    // ContextView\r\n    ContextViewService.prototype.setContainer = function (container) {\r\n        this.logService.trace('ContextViewService#setContainer');\r\n        this.contextView.setContainer(container);\r\n    };\r\n    ContextViewService.prototype.showContextView = function (delegate) {\r\n        this.logService.trace('ContextViewService#showContextView');\r\n        this.contextView.show(delegate);\r\n    };\r\n    ContextViewService.prototype.layout = function () {\r\n        this.contextView.layout();\r\n    };\r\n    ContextViewService.prototype.hideContextView = function (data) {\r\n        this.logService.trace('ContextViewService#hideContextView');\r\n        this.contextView.hide(data);\r\n    };\r\n    ContextViewService = __decorate([\r\n        __param(1, ITelemetryService),\r\n        __param(2, ILogService)\r\n    ], ContextViewService);\r\n    return ContextViewService;\r\n}(Disposable));\r\nexport { ContextViewService };\r\n","import { createDecorator } from '../../instantiation/common/instantiation.js';\r\nexport var IDialogService = createDecorator('dialogService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\r\n/**\r\n * Iterates over each entry in the provided set. The iterator allows\r\n * to remove elements and will stop when the callback returns {{false}}.\r\n */\r\nexport function forEach(from, callback) {\r\n    var _loop_1 = function (key) {\r\n        if (hasOwnProperty.call(from, key)) {\r\n            var result = callback({ key: key, value: from[key] }, function () {\r\n                delete from[key];\r\n            });\r\n            if (result === false) {\r\n                return { value: void 0 };\r\n            }\r\n        }\r\n    };\r\n    for (var key in from) {\r\n        var state_1 = _loop_1(key);\r\n        if (typeof state_1 === \"object\")\r\n            return state_1.value;\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isEmptyObject } from '../../../base/common/types.js';\r\nimport { forEach } from '../../../base/common/collections.js';\r\nfunction newNode(data) {\r\n    return {\r\n        data: data,\r\n        incoming: Object.create(null),\r\n        outgoing: Object.create(null)\r\n    };\r\n}\r\nvar Graph = /** @class */ (function () {\r\n    function Graph(_hashFn) {\r\n        this._hashFn = _hashFn;\r\n        this._nodes = Object.create(null);\r\n        // empty\r\n    }\r\n    Graph.prototype.roots = function () {\r\n        var ret = [];\r\n        forEach(this._nodes, function (entry) {\r\n            if (isEmptyObject(entry.value.outgoing)) {\r\n                ret.push(entry.value);\r\n            }\r\n        });\r\n        return ret;\r\n    };\r\n    Graph.prototype.insertEdge = function (from, to) {\r\n        var fromNode = this.lookupOrInsertNode(from), toNode = this.lookupOrInsertNode(to);\r\n        fromNode.outgoing[this._hashFn(to)] = toNode;\r\n        toNode.incoming[this._hashFn(from)] = fromNode;\r\n    };\r\n    Graph.prototype.removeNode = function (data) {\r\n        var key = this._hashFn(data);\r\n        delete this._nodes[key];\r\n        forEach(this._nodes, function (entry) {\r\n            delete entry.value.outgoing[key];\r\n            delete entry.value.incoming[key];\r\n        });\r\n    };\r\n    Graph.prototype.lookupOrInsertNode = function (data) {\r\n        var key = this._hashFn(data);\r\n        var node = this._nodes[key];\r\n        if (!node) {\r\n            node = newNode(data);\r\n            this._nodes[key] = node;\r\n        }\r\n        return node;\r\n    };\r\n    Graph.prototype.isEmpty = function () {\r\n        for (var _key in this._nodes) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    Graph.prototype.toString = function () {\r\n        var data = [];\r\n        forEach(this._nodes, function (entry) {\r\n            data.push(entry.key + \", (incoming)[\" + Object.keys(entry.value.incoming).join(', ') + \"], (outgoing)[\" + Object.keys(entry.value.outgoing).join(',') + \"]\");\r\n        });\r\n        return data.join('\\n');\r\n    };\r\n    return Graph;\r\n}());\r\nexport { Graph };\r\n","var SyncDescriptor = /** @class */ (function () {\r\n    function SyncDescriptor(ctor, staticArguments, supportsDelayedInstantiation) {\r\n        if (staticArguments === void 0) { staticArguments = []; }\r\n        if (supportsDelayedInstantiation === void 0) { supportsDelayedInstantiation = false; }\r\n        this.ctor = ctor;\r\n        this.staticArguments = staticArguments;\r\n        this.supportsDelayedInstantiation = supportsDelayedInstantiation;\r\n    }\r\n    return SyncDescriptor;\r\n}());\r\nexport { SyncDescriptor };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { illegalState } from '../../../base/common/errors.js';\r\nimport { create } from '../../../base/common/types.js';\r\nimport { Graph } from './graph.js';\r\nimport { SyncDescriptor } from './descriptors.js';\r\nimport { IInstantiationService, _util, optional } from './instantiation.js';\r\nimport { ServiceCollection } from './serviceCollection.js';\r\n// TRACING\r\nvar _enableTracing = false;\r\nvar InstantiationService = /** @class */ (function () {\r\n    function InstantiationService(services, strict, parent) {\r\n        if (services === void 0) { services = new ServiceCollection(); }\r\n        if (strict === void 0) { strict = false; }\r\n        this._services = services;\r\n        this._strict = strict;\r\n        this._parent = parent;\r\n        this._services.set(IInstantiationService, this);\r\n    }\r\n    InstantiationService.prototype.createChild = function (services) {\r\n        return new InstantiationService(services, this._strict, this);\r\n    };\r\n    InstantiationService.prototype.invokeFunction = function (fn) {\r\n        var _this = this;\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        var _trace = Trace.traceInvocation(fn);\r\n        var _done = false;\r\n        try {\r\n            var accessor = {\r\n                get: function (id, isOptional) {\r\n                    if (_done) {\r\n                        throw illegalState('service accessor is only valid during the invocation of its target method');\r\n                    }\r\n                    var result = _this._getOrCreateServiceInstance(id, _trace);\r\n                    if (!result && isOptional !== optional) {\r\n                        throw new Error(\"[invokeFunction] unknown service '\" + id + \"'\");\r\n                    }\r\n                    return result;\r\n                }\r\n            };\r\n            return fn.apply(undefined, [accessor].concat(args));\r\n        }\r\n        finally {\r\n            _done = true;\r\n            _trace.stop();\r\n        }\r\n    };\r\n    InstantiationService.prototype.createInstance = function (ctorOrDescriptor) {\r\n        var rest = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            rest[_i - 1] = arguments[_i];\r\n        }\r\n        var _trace;\r\n        var result;\r\n        if (ctorOrDescriptor instanceof SyncDescriptor) {\r\n            _trace = Trace.traceCreation(ctorOrDescriptor.ctor);\r\n            result = this._createInstance(ctorOrDescriptor.ctor, ctorOrDescriptor.staticArguments.concat(rest), _trace);\r\n        }\r\n        else {\r\n            _trace = Trace.traceCreation(ctorOrDescriptor);\r\n            result = this._createInstance(ctorOrDescriptor, rest, _trace);\r\n        }\r\n        _trace.stop();\r\n        return result;\r\n    };\r\n    InstantiationService.prototype._createInstance = function (ctor, args, _trace) {\r\n        if (args === void 0) { args = []; }\r\n        // arguments defined by service decorators\r\n        var serviceDependencies = _util.getServiceDependencies(ctor).sort(function (a, b) { return a.index - b.index; });\r\n        var serviceArgs = [];\r\n        for (var _i = 0, serviceDependencies_1 = serviceDependencies; _i < serviceDependencies_1.length; _i++) {\r\n            var dependency = serviceDependencies_1[_i];\r\n            var service = this._getOrCreateServiceInstance(dependency.id, _trace);\r\n            if (!service && this._strict && !dependency.optional) {\r\n                throw new Error(\"[createInstance] \" + ctor.name + \" depends on UNKNOWN service \" + dependency.id + \".\");\r\n            }\r\n            serviceArgs.push(service);\r\n        }\r\n        var firstServiceArgPos = serviceDependencies.length > 0 ? serviceDependencies[0].index : args.length;\r\n        // check for argument mismatches, adjust static args if needed\r\n        if (args.length !== firstServiceArgPos) {\r\n            console.warn(\"[createInstance] First service dependency of \" + ctor.name + \" at position \" + (firstServiceArgPos + 1) + \" conflicts with \" + args.length + \" static arguments\");\r\n            var delta = firstServiceArgPos - args.length;\r\n            if (delta > 0) {\r\n                args = args.concat(new Array(delta));\r\n            }\r\n            else {\r\n                args = args.slice(0, firstServiceArgPos);\r\n            }\r\n        }\r\n        // now create the instance\r\n        return create.apply(null, [ctor].concat(args, serviceArgs));\r\n    };\r\n    InstantiationService.prototype._setServiceInstance = function (id, instance) {\r\n        if (this._services.get(id) instanceof SyncDescriptor) {\r\n            this._services.set(id, instance);\r\n        }\r\n        else if (this._parent) {\r\n            this._parent._setServiceInstance(id, instance);\r\n        }\r\n        else {\r\n            throw new Error('illegalState - setting UNKNOWN service instance');\r\n        }\r\n    };\r\n    InstantiationService.prototype._getServiceInstanceOrDescriptor = function (id) {\r\n        var instanceOrDesc = this._services.get(id);\r\n        if (!instanceOrDesc && this._parent) {\r\n            return this._parent._getServiceInstanceOrDescriptor(id);\r\n        }\r\n        else {\r\n            return instanceOrDesc;\r\n        }\r\n    };\r\n    InstantiationService.prototype._getOrCreateServiceInstance = function (id, _trace) {\r\n        var thing = this._getServiceInstanceOrDescriptor(id);\r\n        if (thing instanceof SyncDescriptor) {\r\n            return this._createAndCacheServiceInstance(id, thing, _trace.branch(id, true));\r\n        }\r\n        else {\r\n            _trace.branch(id, false);\r\n            return thing;\r\n        }\r\n    };\r\n    InstantiationService.prototype._createAndCacheServiceInstance = function (id, desc, _trace) {\r\n        var graph = new Graph(function (data) { return data.id.toString(); });\r\n        function throwCycleError() {\r\n            var err = new Error('[createInstance] cyclic dependency between services');\r\n            err.message = graph.toString();\r\n            throw err;\r\n        }\r\n        var count = 0;\r\n        var stack = [{ id: id, desc: desc, _trace: _trace }];\r\n        while (stack.length) {\r\n            var item = stack.pop();\r\n            graph.lookupOrInsertNode(item);\r\n            // TODO@joh use the graph to find a cycle\r\n            // a weak heuristic for cycle checks\r\n            if (count++ > 100) {\r\n                throwCycleError();\r\n            }\r\n            // check all dependencies for existence and if they need to be created first\r\n            var dependencies = _util.getServiceDependencies(item.desc.ctor);\r\n            for (var _i = 0, dependencies_1 = dependencies; _i < dependencies_1.length; _i++) {\r\n                var dependency = dependencies_1[_i];\r\n                var instanceOrDesc = this._getServiceInstanceOrDescriptor(dependency.id);\r\n                if (!instanceOrDesc && !dependency.optional) {\r\n                    console.warn(\"[createInstance] \" + id + \" depends on \" + dependency.id + \" which is NOT registered.\");\r\n                }\r\n                if (instanceOrDesc instanceof SyncDescriptor) {\r\n                    var d = { id: dependency.id, desc: instanceOrDesc, _trace: item._trace.branch(dependency.id, true) };\r\n                    graph.insertEdge(item, d);\r\n                    stack.push(d);\r\n                }\r\n            }\r\n        }\r\n        while (true) {\r\n            var roots = graph.roots();\r\n            // if there is no more roots but still\r\n            // nodes in the graph we have a cycle\r\n            if (roots.length === 0) {\r\n                if (!graph.isEmpty()) {\r\n                    throwCycleError();\r\n                }\r\n                break;\r\n            }\r\n            for (var _a = 0, roots_1 = roots; _a < roots_1.length; _a++) {\r\n                var data = roots_1[_a].data;\r\n                // create instance and overwrite the service collections\r\n                var instance = this._createServiceInstanceWithOwner(data.id, data.desc.ctor, data.desc.staticArguments, false, data._trace);\r\n                this._setServiceInstance(data.id, instance);\r\n                graph.removeNode(data);\r\n            }\r\n        }\r\n        return this._getServiceInstanceOrDescriptor(id);\r\n    };\r\n    InstantiationService.prototype._createServiceInstanceWithOwner = function (id, ctor, args, supportsDelayedInstantiation, _trace) {\r\n        if (args === void 0) { args = []; }\r\n        if (this._services.get(id) instanceof SyncDescriptor) {\r\n            return this._createServiceInstance(ctor, args, supportsDelayedInstantiation, _trace);\r\n        }\r\n        else if (this._parent) {\r\n            return this._parent._createServiceInstanceWithOwner(id, ctor, args, supportsDelayedInstantiation, _trace);\r\n        }\r\n        else {\r\n            throw new Error('illegalState - creating UNKNOWN service instance');\r\n        }\r\n    };\r\n    InstantiationService.prototype._createServiceInstance = function (ctor, args, supportsDelayedInstantiation, _trace) {\r\n        if (args === void 0) { args = []; }\r\n        return this._createInstance(ctor, args, _trace);\r\n    };\r\n    return InstantiationService;\r\n}());\r\nexport { InstantiationService };\r\nvar Trace = /** @class */ (function () {\r\n    function Trace(type, name) {\r\n        this.type = type;\r\n        this.name = name;\r\n        this._start = Date.now();\r\n        this._dep = [];\r\n    }\r\n    Trace.traceInvocation = function (ctor) {\r\n        return !_enableTracing ? Trace._None : new Trace(1 /* Invocation */, ctor.name || ctor.toString().substring(0, 42).replace(/\\n/g, ''));\r\n    };\r\n    Trace.traceCreation = function (ctor) {\r\n        return !_enableTracing ? Trace._None : new Trace(0 /* Creation */, ctor.name);\r\n    };\r\n    Trace.prototype.branch = function (id, first) {\r\n        var child = new Trace(2 /* Branch */, id.toString());\r\n        this._dep.push([id, first, child]);\r\n        return child;\r\n    };\r\n    Trace.prototype.stop = function () {\r\n        var dur = Date.now() - this._start;\r\n        Trace._totals += dur;\r\n        var causedCreation = false;\r\n        function printChild(n, trace) {\r\n            var res = [];\r\n            var prefix = new Array(n + 1).join('\\t');\r\n            for (var _i = 0, _a = trace._dep; _i < _a.length; _i++) {\r\n                var _b = _a[_i], id = _b[0], first = _b[1], child = _b[2];\r\n                if (first && child) {\r\n                    causedCreation = true;\r\n                    res.push(prefix + \"CREATES -> \" + id);\r\n                    var nested = printChild(n + 1, child);\r\n                    if (nested) {\r\n                        res.push(nested);\r\n                    }\r\n                }\r\n                else {\r\n                    res.push(prefix + \"uses -> \" + id);\r\n                }\r\n            }\r\n            return res.join('\\n');\r\n        }\r\n        var lines = [\r\n            (this.type === 0 /* Creation */ ? 'CREATE' : 'CALL') + \" \" + this.name,\r\n            \"\" + printChild(1, this),\r\n            \"DONE, took \" + dur.toFixed(2) + \"ms (grand total \" + Trace._totals.toFixed(2) + \"ms)\"\r\n        ];\r\n        if (dur > 2 || causedCreation) {\r\n            console.log(lines.join('\\n'));\r\n        }\r\n    };\r\n    Trace._None = new /** @class */ (function (_super) {\r\n        __extends(class_1, _super);\r\n        function class_1() {\r\n            return _super.call(this, -1, null) || this;\r\n        }\r\n        class_1.prototype.stop = function () { };\r\n        class_1.prototype.branch = function () { return this; };\r\n        return class_1;\r\n    }(Trace));\r\n    Trace._totals = 0;\r\n    return Trace;\r\n}());\r\n//#endregion\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nvar LABEL_SERVICE_ID = 'label';\r\nexport var ILabelService = createDecorator(LABEL_SERVICE_ID);\r\n","import * as platform from '../../../common/platform.js';\r\nimport * as errors from '../../../common/errors.js';\r\nimport * as dom from '../../../browser/dom.js';\r\nimport { createKeybinding } from '../../../common/keyCodes.js';\r\nvar KeybindingDispatcher = /** @class */ (function () {\r\n    function KeybindingDispatcher() {\r\n        this._arr = [];\r\n    }\r\n    KeybindingDispatcher.prototype.set = function (keybinding, callback) {\r\n        this._arr.push({\r\n            keybinding: createKeybinding(keybinding, platform.OS),\r\n            callback: callback\r\n        });\r\n    };\r\n    KeybindingDispatcher.prototype.dispatch = function (keybinding) {\r\n        // Loop from the last to the first to handle overwrites\r\n        for (var i = this._arr.length - 1; i >= 0; i--) {\r\n            var item = this._arr[i];\r\n            if (keybinding.equals(item.keybinding)) {\r\n                return item.callback;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    return KeybindingDispatcher;\r\n}());\r\nexport { KeybindingDispatcher };\r\nvar DefaultController = /** @class */ (function () {\r\n    function DefaultController(options) {\r\n        if (options === void 0) { options = { clickBehavior: 0 /* ON_MOUSE_DOWN */, keyboardSupport: true, openMode: 0 /* SINGLE_CLICK */ }; }\r\n        var _this = this;\r\n        this.options = options;\r\n        this.downKeyBindingDispatcher = new KeybindingDispatcher();\r\n        this.upKeyBindingDispatcher = new KeybindingDispatcher();\r\n        if (typeof options.keyboardSupport !== 'boolean' || options.keyboardSupport) {\r\n            this.downKeyBindingDispatcher.set(16 /* UpArrow */, function (t, e) { return _this.onUp(t, e); });\r\n            this.downKeyBindingDispatcher.set(18 /* DownArrow */, function (t, e) { return _this.onDown(t, e); });\r\n            this.downKeyBindingDispatcher.set(15 /* LeftArrow */, function (t, e) { return _this.onLeft(t, e); });\r\n            this.downKeyBindingDispatcher.set(17 /* RightArrow */, function (t, e) { return _this.onRight(t, e); });\r\n            if (platform.isMacintosh) {\r\n                this.downKeyBindingDispatcher.set(2048 /* CtrlCmd */ | 16 /* UpArrow */, function (t, e) { return _this.onLeft(t, e); });\r\n                this.downKeyBindingDispatcher.set(256 /* WinCtrl */ | 44 /* KEY_N */, function (t, e) { return _this.onDown(t, e); });\r\n                this.downKeyBindingDispatcher.set(256 /* WinCtrl */ | 46 /* KEY_P */, function (t, e) { return _this.onUp(t, e); });\r\n            }\r\n            this.downKeyBindingDispatcher.set(11 /* PageUp */, function (t, e) { return _this.onPageUp(t, e); });\r\n            this.downKeyBindingDispatcher.set(12 /* PageDown */, function (t, e) { return _this.onPageDown(t, e); });\r\n            this.downKeyBindingDispatcher.set(14 /* Home */, function (t, e) { return _this.onHome(t, e); });\r\n            this.downKeyBindingDispatcher.set(13 /* End */, function (t, e) { return _this.onEnd(t, e); });\r\n            this.downKeyBindingDispatcher.set(10 /* Space */, function (t, e) { return _this.onSpace(t, e); });\r\n            this.downKeyBindingDispatcher.set(9 /* Escape */, function (t, e) { return _this.onEscape(t, e); });\r\n            this.upKeyBindingDispatcher.set(3 /* Enter */, this.onEnter.bind(this));\r\n            this.upKeyBindingDispatcher.set(2048 /* CtrlCmd */ | 3 /* Enter */, this.onEnter.bind(this));\r\n        }\r\n    }\r\n    DefaultController.prototype.onMouseDown = function (tree, element, event, origin) {\r\n        if (origin === void 0) { origin = 'mouse'; }\r\n        if (this.options.clickBehavior === 0 /* ON_MOUSE_DOWN */ && (event.leftButton || event.middleButton)) {\r\n            if (event.target) {\r\n                if (event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n                    return false; // Ignore event if target is a form input field (avoids browser specific issues)\r\n                }\r\n                if (dom.findParentWithClass(event.target, 'scrollbar', 'monaco-tree')) {\r\n                    return false;\r\n                }\r\n                if (dom.findParentWithClass(event.target, 'monaco-action-bar', 'row')) { // TODO@Joao not very nice way of checking for the action bar (implicit knowledge)\r\n                    return false; // Ignore event if target is over an action bar of the row\r\n                }\r\n            }\r\n            // Propagate to onLeftClick now\r\n            return this.onLeftClick(tree, element, event, origin);\r\n        }\r\n        return false;\r\n    };\r\n    DefaultController.prototype.onClick = function (tree, element, event) {\r\n        var isMac = platform.isMacintosh;\r\n        // A Ctrl click on the Mac is a context menu event\r\n        if (isMac && event.ctrlKey) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            return false;\r\n        }\r\n        if (event.target && event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n            return false; // Ignore event if target is a form input field (avoids browser specific issues)\r\n        }\r\n        if (this.options.clickBehavior === 0 /* ON_MOUSE_DOWN */ && (event.leftButton || event.middleButton)) {\r\n            return false; // Already handled by onMouseDown\r\n        }\r\n        return this.onLeftClick(tree, element, event);\r\n    };\r\n    DefaultController.prototype.onLeftClick = function (tree, element, eventish, origin) {\r\n        if (origin === void 0) { origin = 'mouse'; }\r\n        var event = eventish;\r\n        var payload = { origin: origin, originalEvent: eventish, didClickOnTwistie: this.isClickOnTwistie(event) };\r\n        if (tree.getInput() === element) {\r\n            tree.clearFocus(payload);\r\n            tree.clearSelection(payload);\r\n        }\r\n        else {\r\n            var isSingleMouseDown = eventish && event.browserEvent && event.browserEvent.type === 'mousedown' && event.browserEvent.detail === 1;\r\n            if (!isSingleMouseDown) {\r\n                eventish.preventDefault(); // we cannot preventDefault onMouseDown with single click because this would break DND otherwise\r\n            }\r\n            eventish.stopPropagation();\r\n            tree.domFocus();\r\n            tree.setSelection([element], payload);\r\n            tree.setFocus(element, payload);\r\n            if (this.shouldToggleExpansion(element, event, origin)) {\r\n                if (tree.isExpanded(element)) {\r\n                    tree.collapse(element).then(null, errors.onUnexpectedError);\r\n                }\r\n                else {\r\n                    tree.expand(element).then(null, errors.onUnexpectedError);\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.shouldToggleExpansion = function (element, event, origin) {\r\n        var isDoubleClick = (origin === 'mouse' && event.detail === 2);\r\n        return this.openOnSingleClick || isDoubleClick || this.isClickOnTwistie(event);\r\n    };\r\n    DefaultController.prototype.setOpenMode = function (openMode) {\r\n        this.options.openMode = openMode;\r\n    };\r\n    Object.defineProperty(DefaultController.prototype, \"openOnSingleClick\", {\r\n        get: function () {\r\n            return this.options.openMode === 0 /* SINGLE_CLICK */;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    DefaultController.prototype.isClickOnTwistie = function (event) {\r\n        var element = event.target;\r\n        if (!dom.hasClass(element, 'content')) {\r\n            return false;\r\n        }\r\n        var twistieStyle = window.getComputedStyle(element, ':before');\r\n        if (twistieStyle.backgroundImage === 'none' || twistieStyle.display === 'none') {\r\n            return false;\r\n        }\r\n        var twistieWidth = parseInt(twistieStyle.width) + parseInt(twistieStyle.paddingRight);\r\n        return event.browserEvent.offsetX <= twistieWidth;\r\n    };\r\n    DefaultController.prototype.onContextMenu = function (tree, element, event) {\r\n        if (event.target && event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n            return false; // allow context menu on input fields\r\n        }\r\n        // Prevent native context menu from showing up\r\n        if (event) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        }\r\n        return false;\r\n    };\r\n    DefaultController.prototype.onTap = function (tree, element, event) {\r\n        var target = event.initialTarget;\r\n        if (target && target.tagName && target.tagName.toLowerCase() === 'input') {\r\n            return false; // Ignore event if target is a form input field (avoids browser specific issues)\r\n        }\r\n        return this.onLeftClick(tree, element, event, 'touch');\r\n    };\r\n    DefaultController.prototype.onKeyDown = function (tree, event) {\r\n        return this.onKey(this.downKeyBindingDispatcher, tree, event);\r\n    };\r\n    DefaultController.prototype.onKeyUp = function (tree, event) {\r\n        return this.onKey(this.upKeyBindingDispatcher, tree, event);\r\n    };\r\n    DefaultController.prototype.onKey = function (bindings, tree, event) {\r\n        var handler = bindings.dispatch(event.toKeybinding());\r\n        if (handler) {\r\n            // TODO: TS 3.1 upgrade. Why are we checking against void?\r\n            if (handler(tree, event)) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    DefaultController.prototype.onUp = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusPrevious(1, payload);\r\n            tree.reveal(tree.getFocus()).then(null, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onPageUp = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusPreviousPage(payload);\r\n            tree.reveal(tree.getFocus()).then(null, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onDown = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusNext(1, payload);\r\n            tree.reveal(tree.getFocus()).then(null, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onPageDown = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusNextPage(payload);\r\n            tree.reveal(tree.getFocus()).then(null, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onHome = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusFirst(payload);\r\n            tree.reveal(tree.getFocus()).then(null, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onEnd = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusLast(payload);\r\n            tree.reveal(tree.getFocus()).then(null, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onLeft = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            var focus_1 = tree.getFocus();\r\n            tree.collapse(focus_1).then(function (didCollapse) {\r\n                if (focus_1 && !didCollapse) {\r\n                    tree.focusParent(payload);\r\n                    return tree.reveal(tree.getFocus());\r\n                }\r\n                return undefined;\r\n            }).then(null, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onRight = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            var focus_2 = tree.getFocus();\r\n            tree.expand(focus_2).then(function (didExpand) {\r\n                if (focus_2 && !didExpand) {\r\n                    tree.focusFirstChild(payload);\r\n                    return tree.reveal(tree.getFocus());\r\n                }\r\n                return undefined;\r\n            }).then(null, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onEnter = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            return false;\r\n        }\r\n        var focus = tree.getFocus();\r\n        if (focus) {\r\n            tree.setSelection([focus], payload);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onSpace = function (tree, event) {\r\n        if (tree.getHighlight()) {\r\n            return false;\r\n        }\r\n        var focus = tree.getFocus();\r\n        if (focus) {\r\n            tree.toggleExpansion(focus);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onEscape = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n            return true;\r\n        }\r\n        if (tree.getSelection().length) {\r\n            tree.clearSelection(payload);\r\n            return true;\r\n        }\r\n        if (tree.getFocus()) {\r\n            tree.clearFocus(payload);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return DefaultController;\r\n}());\r\nexport { DefaultController };\r\nvar DefaultDragAndDrop = /** @class */ (function () {\r\n    function DefaultDragAndDrop() {\r\n    }\r\n    DefaultDragAndDrop.prototype.getDragURI = function (tree, element) {\r\n        return null;\r\n    };\r\n    DefaultDragAndDrop.prototype.onDragStart = function (tree, data, originalEvent) {\r\n        return;\r\n    };\r\n    DefaultDragAndDrop.prototype.onDragOver = function (tree, data, targetElement, originalEvent) {\r\n        return null;\r\n    };\r\n    DefaultDragAndDrop.prototype.drop = function (tree, data, targetElement, originalEvent) {\r\n        return;\r\n    };\r\n    return DefaultDragAndDrop;\r\n}());\r\nexport { DefaultDragAndDrop };\r\nvar DefaultFilter = /** @class */ (function () {\r\n    function DefaultFilter() {\r\n    }\r\n    DefaultFilter.prototype.isVisible = function (tree, element) {\r\n        return true;\r\n    };\r\n    return DefaultFilter;\r\n}());\r\nexport { DefaultFilter };\r\nvar DefaultAccessibilityProvider = /** @class */ (function () {\r\n    function DefaultAccessibilityProvider() {\r\n    }\r\n    DefaultAccessibilityProvider.prototype.getAriaLabel = function (tree, element) {\r\n        return null;\r\n    };\r\n    return DefaultAccessibilityProvider;\r\n}());\r\nexport { DefaultAccessibilityProvider };\r\nvar DefaultTreestyler = /** @class */ (function () {\r\n    function DefaultTreestyler(styleElement, selectorSuffix) {\r\n        this.styleElement = styleElement;\r\n        this.selectorSuffix = selectorSuffix;\r\n    }\r\n    DefaultTreestyler.prototype.style = function (styles) {\r\n        var suffix = this.selectorSuffix ? \".\" + this.selectorSuffix : '';\r\n        var content = [];\r\n        if (styles.listFocusBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) { background-color: \" + styles.listFocusBackground + \"; }\");\r\n        }\r\n        if (styles.listFocusForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) { color: \" + styles.listFocusForeground + \"; }\");\r\n        }\r\n        if (styles.listActiveSelectionBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { background-color: \" + styles.listActiveSelectionBackground + \"; }\");\r\n        }\r\n        if (styles.listActiveSelectionForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { color: \" + styles.listActiveSelectionForeground + \"; }\");\r\n        }\r\n        if (styles.listFocusAndSelectionBackground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree-drag-image,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused.selected:not(.highlighted) { background-color: \" + styles.listFocusAndSelectionBackground + \"; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listFocusAndSelectionForeground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree-drag-image,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused.selected:not(.highlighted) { color: \" + styles.listFocusAndSelectionForeground + \"; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listInactiveSelectionBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { background-color: \" + styles.listInactiveSelectionBackground + \"; }\");\r\n        }\r\n        if (styles.listInactiveSelectionForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { color: \" + styles.listInactiveSelectionForeground + \"; }\");\r\n        }\r\n        if (styles.listHoverBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused) { background-color: \" + styles.listHoverBackground + \"; }\");\r\n        }\r\n        if (styles.listHoverForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused) { color: \" + styles.listHoverForeground + \"; }\");\r\n        }\r\n        if (styles.listDropBackground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-wrapper.drop-target,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.drop-target { background-color: \" + styles.listDropBackground + \" !important; color: inherit !important; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listFocusOutline) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree-drag-image\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{ border: 1px solid \" + styles.listFocusOutline + \"; background: #000; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{ border: 1px solid transparent; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) \\t\\t\\t\\t\\t\\t{ border: 1px dotted \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) \\t\\t\\t\\t\\t\\t{ border: 1px solid \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted)  \\t\\t\\t\\t\\t\\t\\t{ border: 1px solid \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused)  \\t{ border: 1px dashed \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-wrapper.drop-target,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.drop-target\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{ border: 1px dashed \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\");\r\n        }\r\n        var newStyles = content.join('\\n');\r\n        if (newStyles !== this.styleElement.innerHTML) {\r\n            this.styleElement.innerHTML = newStyles;\r\n        }\r\n    };\r\n    return DefaultTreestyler;\r\n}());\r\nexport { DefaultTreestyler };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as Assert from '../../../common/assert.js';\r\nimport { onUnexpectedError } from '../../../common/errors.js';\r\nimport { combinedDisposable } from '../../../common/lifecycle.js';\r\nimport * as WinJS from '../../../common/winjs.base.js';\r\nimport { Emitter, once, EventMultiplexer, Relay } from '../../../common/event.js';\r\nvar LockData = /** @class */ (function () {\r\n    function LockData(item) {\r\n        this._onDispose = new Emitter();\r\n        this.onDispose = this._onDispose.event;\r\n        this._item = item;\r\n    }\r\n    Object.defineProperty(LockData.prototype, \"item\", {\r\n        get: function () {\r\n            return this._item;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LockData.prototype.dispose = function () {\r\n        if (this._onDispose) {\r\n            this._onDispose.fire();\r\n            this._onDispose.dispose();\r\n            this._onDispose = null;\r\n        }\r\n    };\r\n    return LockData;\r\n}());\r\nexport { LockData };\r\nvar Lock = /** @class */ (function () {\r\n    function Lock() {\r\n        this.locks = Object.create({});\r\n    }\r\n    Lock.prototype.isLocked = function (item) {\r\n        return !!this.locks[item.id];\r\n    };\r\n    Lock.prototype.run = function (item, fn) {\r\n        var _this = this;\r\n        var lock = this.getLock(item);\r\n        if (lock) {\r\n            return new WinJS.TPromise(function (c, e) {\r\n                once(lock.onDispose)(function () {\r\n                    return _this.run(item, fn).then(c, e);\r\n                });\r\n            });\r\n        }\r\n        var result;\r\n        return new WinJS.TPromise(function (c, e) {\r\n            if (item.isDisposed()) {\r\n                return e(new Error('Item is disposed.'));\r\n            }\r\n            var lock = _this.locks[item.id] = new LockData(item);\r\n            result = fn().then(function (r) {\r\n                delete _this.locks[item.id];\r\n                lock.dispose();\r\n                return r;\r\n            }).then(c, e);\r\n            return result;\r\n        });\r\n    };\r\n    Lock.prototype.getLock = function (item) {\r\n        var key;\r\n        for (key in this.locks) {\r\n            var lock = this.locks[key];\r\n            if (item.intersects(lock.item)) {\r\n                return lock;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    return Lock;\r\n}());\r\nexport { Lock };\r\nvar ItemRegistry = /** @class */ (function () {\r\n    function ItemRegistry() {\r\n        this._isDisposed = false;\r\n        this._onDidRevealItem = new EventMultiplexer();\r\n        this.onDidRevealItem = this._onDidRevealItem.event;\r\n        this._onExpandItem = new EventMultiplexer();\r\n        this.onExpandItem = this._onExpandItem.event;\r\n        this._onDidExpandItem = new EventMultiplexer();\r\n        this.onDidExpandItem = this._onDidExpandItem.event;\r\n        this._onCollapseItem = new EventMultiplexer();\r\n        this.onCollapseItem = this._onCollapseItem.event;\r\n        this._onDidCollapseItem = new EventMultiplexer();\r\n        this.onDidCollapseItem = this._onDidCollapseItem.event;\r\n        this._onDidAddTraitItem = new EventMultiplexer();\r\n        this.onDidAddTraitItem = this._onDidAddTraitItem.event;\r\n        this._onDidRemoveTraitItem = new EventMultiplexer();\r\n        this.onDidRemoveTraitItem = this._onDidRemoveTraitItem.event;\r\n        this._onDidRefreshItem = new EventMultiplexer();\r\n        this.onDidRefreshItem = this._onDidRefreshItem.event;\r\n        this._onRefreshItemChildren = new EventMultiplexer();\r\n        this.onRefreshItemChildren = this._onRefreshItemChildren.event;\r\n        this._onDidRefreshItemChildren = new EventMultiplexer();\r\n        this.onDidRefreshItemChildren = this._onDidRefreshItemChildren.event;\r\n        this._onDidDisposeItem = new EventMultiplexer();\r\n        this.onDidDisposeItem = this._onDidDisposeItem.event;\r\n        this.items = {};\r\n    }\r\n    ItemRegistry.prototype.register = function (item) {\r\n        Assert.ok(!this.isRegistered(item.id), 'item already registered: ' + item.id);\r\n        var disposable = combinedDisposable([\r\n            this._onDidRevealItem.add(item.onDidReveal),\r\n            this._onExpandItem.add(item.onExpand),\r\n            this._onDidExpandItem.add(item.onDidExpand),\r\n            this._onCollapseItem.add(item.onCollapse),\r\n            this._onDidCollapseItem.add(item.onDidCollapse),\r\n            this._onDidAddTraitItem.add(item.onDidAddTrait),\r\n            this._onDidRemoveTraitItem.add(item.onDidRemoveTrait),\r\n            this._onDidRefreshItem.add(item.onDidRefresh),\r\n            this._onRefreshItemChildren.add(item.onRefreshChildren),\r\n            this._onDidRefreshItemChildren.add(item.onDidRefreshChildren),\r\n            this._onDidDisposeItem.add(item.onDidDispose)\r\n        ]);\r\n        this.items[item.id] = { item: item, disposable: disposable };\r\n    };\r\n    ItemRegistry.prototype.deregister = function (item) {\r\n        Assert.ok(this.isRegistered(item.id), 'item not registered: ' + item.id);\r\n        this.items[item.id].disposable.dispose();\r\n        delete this.items[item.id];\r\n    };\r\n    ItemRegistry.prototype.isRegistered = function (id) {\r\n        return this.items.hasOwnProperty(id);\r\n    };\r\n    ItemRegistry.prototype.getItem = function (id) {\r\n        var result = this.items[id];\r\n        return result ? result.item : null;\r\n    };\r\n    ItemRegistry.prototype.dispose = function () {\r\n        this.items = null;\r\n        this._onDidRevealItem.dispose();\r\n        this._onExpandItem.dispose();\r\n        this._onDidExpandItem.dispose();\r\n        this._onCollapseItem.dispose();\r\n        this._onDidCollapseItem.dispose();\r\n        this._onDidAddTraitItem.dispose();\r\n        this._onDidRemoveTraitItem.dispose();\r\n        this._onDidRefreshItem.dispose();\r\n        this._onRefreshItemChildren.dispose();\r\n        this._onDidRefreshItemChildren.dispose();\r\n        this._isDisposed = true;\r\n    };\r\n    ItemRegistry.prototype.isDisposed = function () {\r\n        return this._isDisposed;\r\n    };\r\n    return ItemRegistry;\r\n}());\r\nexport { ItemRegistry };\r\nvar Item = /** @class */ (function () {\r\n    function Item(id, registry, context, lock, element) {\r\n        this._onDidCreate = new Emitter();\r\n        this._onDidReveal = new Emitter();\r\n        this.onDidReveal = this._onDidReveal.event;\r\n        this._onExpand = new Emitter();\r\n        this.onExpand = this._onExpand.event;\r\n        this._onDidExpand = new Emitter();\r\n        this.onDidExpand = this._onDidExpand.event;\r\n        this._onCollapse = new Emitter();\r\n        this.onCollapse = this._onCollapse.event;\r\n        this._onDidCollapse = new Emitter();\r\n        this.onDidCollapse = this._onDidCollapse.event;\r\n        this._onDidAddTrait = new Emitter();\r\n        this.onDidAddTrait = this._onDidAddTrait.event;\r\n        this._onDidRemoveTrait = new Emitter();\r\n        this.onDidRemoveTrait = this._onDidRemoveTrait.event;\r\n        this._onDidRefresh = new Emitter();\r\n        this.onDidRefresh = this._onDidRefresh.event;\r\n        this._onRefreshChildren = new Emitter();\r\n        this.onRefreshChildren = this._onRefreshChildren.event;\r\n        this._onDidRefreshChildren = new Emitter();\r\n        this.onDidRefreshChildren = this._onDidRefreshChildren.event;\r\n        this._onDidDispose = new Emitter();\r\n        this.onDidDispose = this._onDidDispose.event;\r\n        this.registry = registry;\r\n        this.context = context;\r\n        this.lock = lock;\r\n        this.element = element;\r\n        this.id = id;\r\n        this.registry.register(this);\r\n        this.doesHaveChildren = this.context.dataSource.hasChildren(this.context.tree, this.element);\r\n        this.needsChildrenRefresh = true;\r\n        this.parent = null;\r\n        this.previous = null;\r\n        this.next = null;\r\n        this.firstChild = null;\r\n        this.lastChild = null;\r\n        this.traits = {};\r\n        this.depth = 0;\r\n        this.expanded = this.context.dataSource.shouldAutoexpand && this.context.dataSource.shouldAutoexpand(this.context.tree, element);\r\n        this._onDidCreate.fire(this);\r\n        this.visible = this._isVisible();\r\n        this.height = this._getHeight();\r\n        this._isDisposed = false;\r\n    }\r\n    Item.prototype.getElement = function () {\r\n        return this.element;\r\n    };\r\n    Item.prototype.hasChildren = function () {\r\n        return this.doesHaveChildren;\r\n    };\r\n    Item.prototype.getDepth = function () {\r\n        return this.depth;\r\n    };\r\n    Item.prototype.isVisible = function () {\r\n        return this.visible;\r\n    };\r\n    Item.prototype.setVisible = function (value) {\r\n        this.visible = value;\r\n    };\r\n    Item.prototype.isExpanded = function () {\r\n        return this.expanded;\r\n    };\r\n    /* protected */ Item.prototype._setExpanded = function (value) {\r\n        this.expanded = value;\r\n    };\r\n    Item.prototype.reveal = function (relativeTop) {\r\n        if (relativeTop === void 0) { relativeTop = null; }\r\n        var eventData = { item: this, relativeTop: relativeTop };\r\n        this._onDidReveal.fire(eventData);\r\n    };\r\n    Item.prototype.expand = function () {\r\n        var _this = this;\r\n        if (this.isExpanded() || !this.doesHaveChildren || this.lock.isLocked(this)) {\r\n            return WinJS.TPromise.as(false);\r\n        }\r\n        var result = this.lock.run(this, function () {\r\n            if (_this.isExpanded() || !_this.doesHaveChildren) {\r\n                return WinJS.TPromise.as(false);\r\n            }\r\n            var eventData = { item: _this };\r\n            var result;\r\n            _this._onExpand.fire(eventData);\r\n            if (_this.needsChildrenRefresh) {\r\n                result = _this.refreshChildren(false, true, true);\r\n            }\r\n            else {\r\n                result = WinJS.TPromise.as(null);\r\n            }\r\n            return result.then(function () {\r\n                _this._setExpanded(true);\r\n                _this._onDidExpand.fire(eventData);\r\n                return true;\r\n            });\r\n        });\r\n        return result.then(function (r) {\r\n            if (_this.isDisposed()) {\r\n                return false;\r\n            }\r\n            // Auto expand single child folders\r\n            if (_this.context.options.autoExpandSingleChildren && r && _this.firstChild !== null && _this.firstChild === _this.lastChild && _this.firstChild.isVisible()) {\r\n                return _this.firstChild.expand().then(function () { return true; });\r\n            }\r\n            return r;\r\n        });\r\n    };\r\n    Item.prototype.collapse = function (recursive) {\r\n        var _this = this;\r\n        if (recursive === void 0) { recursive = false; }\r\n        if (recursive) {\r\n            var collapseChildrenPromise = WinJS.TPromise.as(null);\r\n            this.forEachChild(function (child) {\r\n                collapseChildrenPromise = collapseChildrenPromise.then(function () { return child.collapse(true); });\r\n            });\r\n            return collapseChildrenPromise.then(function () {\r\n                return _this.collapse(false);\r\n            });\r\n        }\r\n        else {\r\n            if (!this.isExpanded() || this.lock.isLocked(this)) {\r\n                return WinJS.TPromise.as(false);\r\n            }\r\n            return this.lock.run(this, function () {\r\n                var eventData = { item: _this };\r\n                _this._onCollapse.fire(eventData);\r\n                _this._setExpanded(false);\r\n                _this._onDidCollapse.fire(eventData);\r\n                return WinJS.TPromise.as(true);\r\n            });\r\n        }\r\n    };\r\n    Item.prototype.addTrait = function (trait) {\r\n        var eventData = { item: this, trait: trait };\r\n        this.traits[trait] = true;\r\n        this._onDidAddTrait.fire(eventData);\r\n    };\r\n    Item.prototype.removeTrait = function (trait) {\r\n        var eventData = { item: this, trait: trait };\r\n        delete this.traits[trait];\r\n        this._onDidRemoveTrait.fire(eventData);\r\n    };\r\n    Item.prototype.hasTrait = function (trait) {\r\n        return this.traits[trait] || false;\r\n    };\r\n    Item.prototype.getAllTraits = function () {\r\n        var result = [];\r\n        var trait;\r\n        for (trait in this.traits) {\r\n            if (this.traits.hasOwnProperty(trait) && this.traits[trait]) {\r\n                result.push(trait);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    Item.prototype.getHeight = function () {\r\n        return this.height;\r\n    };\r\n    Item.prototype.refreshChildren = function (recursive, safe, force) {\r\n        var _this = this;\r\n        if (safe === void 0) { safe = false; }\r\n        if (force === void 0) { force = false; }\r\n        if (!force && !this.isExpanded()) {\r\n            var setNeedsChildrenRefresh_1 = function (item) {\r\n                item.needsChildrenRefresh = true;\r\n                item.forEachChild(setNeedsChildrenRefresh_1);\r\n            };\r\n            setNeedsChildrenRefresh_1(this);\r\n            return WinJS.TPromise.as(this);\r\n        }\r\n        this.needsChildrenRefresh = false;\r\n        var doRefresh = function () {\r\n            var eventData = { item: _this, isNested: safe };\r\n            _this._onRefreshChildren.fire(eventData);\r\n            var childrenPromise;\r\n            if (_this.doesHaveChildren) {\r\n                childrenPromise = _this.context.dataSource.getChildren(_this.context.tree, _this.element);\r\n            }\r\n            else {\r\n                childrenPromise = WinJS.TPromise.as([]);\r\n            }\r\n            var result = childrenPromise.then(function (elements) {\r\n                if (_this.isDisposed() || _this.registry.isDisposed()) {\r\n                    return WinJS.TPromise.as(null);\r\n                }\r\n                if (!Array.isArray(elements)) {\r\n                    return WinJS.TPromise.wrapError(new Error('Please return an array of children.'));\r\n                }\r\n                elements = !elements ? [] : elements.slice(0);\r\n                elements = _this.sort(elements);\r\n                var staleItems = {};\r\n                while (_this.firstChild !== null) {\r\n                    staleItems[_this.firstChild.id] = _this.firstChild;\r\n                    _this.removeChild(_this.firstChild);\r\n                }\r\n                for (var i = 0, len = elements.length; i < len; i++) {\r\n                    var element = elements[i];\r\n                    var id = _this.context.dataSource.getId(_this.context.tree, element);\r\n                    var item = staleItems[id] || new Item(id, _this.registry, _this.context, _this.lock, element);\r\n                    item.element = element;\r\n                    if (recursive) {\r\n                        item.needsChildrenRefresh = recursive;\r\n                    }\r\n                    delete staleItems[id];\r\n                    _this.addChild(item);\r\n                }\r\n                for (var staleItemId in staleItems) {\r\n                    if (staleItems.hasOwnProperty(staleItemId)) {\r\n                        staleItems[staleItemId].dispose();\r\n                    }\r\n                }\r\n                if (recursive) {\r\n                    return WinJS.Promise.join(_this.mapEachChild(function (child) {\r\n                        return child.doRefresh(recursive, true);\r\n                    }));\r\n                }\r\n                else {\r\n                    return WinJS.Promise.join(_this.mapEachChild(function (child) {\r\n                        if (child.isExpanded() && child.needsChildrenRefresh) {\r\n                            return child.doRefresh(recursive, true);\r\n                        }\r\n                        else {\r\n                            child.updateVisibility();\r\n                            return WinJS.TPromise.as(null);\r\n                        }\r\n                    }));\r\n                }\r\n            });\r\n            return result\r\n                .then(null, onUnexpectedError)\r\n                .then(function () { return _this._onDidRefreshChildren.fire(eventData); });\r\n        };\r\n        return safe ? doRefresh() : this.lock.run(this, doRefresh);\r\n    };\r\n    Item.prototype.doRefresh = function (recursive, safe) {\r\n        if (safe === void 0) { safe = false; }\r\n        this.doesHaveChildren = this.context.dataSource.hasChildren(this.context.tree, this.element);\r\n        this.height = this._getHeight();\r\n        this.updateVisibility();\r\n        this._onDidRefresh.fire(this);\r\n        return this.refreshChildren(recursive, safe);\r\n    };\r\n    Item.prototype.updateVisibility = function () {\r\n        this.setVisible(this._isVisible());\r\n    };\r\n    Item.prototype.refresh = function (recursive) {\r\n        return this.doRefresh(recursive);\r\n    };\r\n    Item.prototype.getNavigator = function () {\r\n        return new TreeNavigator(this);\r\n    };\r\n    Item.prototype.intersects = function (other) {\r\n        return this.isAncestorOf(other) || other.isAncestorOf(this);\r\n    };\r\n    Item.prototype.isAncestorOf = function (item) {\r\n        while (item) {\r\n            if (item.id === this.id) {\r\n                return true;\r\n            }\r\n            item = item.parent;\r\n        }\r\n        return false;\r\n    };\r\n    Item.prototype.addChild = function (item, afterItem) {\r\n        if (afterItem === void 0) { afterItem = this.lastChild; }\r\n        var isEmpty = this.firstChild === null;\r\n        var atHead = afterItem === null;\r\n        var atTail = afterItem === this.lastChild;\r\n        if (isEmpty) {\r\n            this.firstChild = this.lastChild = item;\r\n            item.next = item.previous = null;\r\n        }\r\n        else if (atHead) {\r\n            this.firstChild.previous = item;\r\n            item.next = this.firstChild;\r\n            item.previous = null;\r\n            this.firstChild = item;\r\n        }\r\n        else if (atTail) {\r\n            this.lastChild.next = item;\r\n            item.next = null;\r\n            item.previous = this.lastChild;\r\n            this.lastChild = item;\r\n        }\r\n        else {\r\n            item.previous = afterItem;\r\n            item.next = afterItem.next;\r\n            afterItem.next.previous = item;\r\n            afterItem.next = item;\r\n        }\r\n        item.parent = this;\r\n        item.depth = this.depth + 1;\r\n    };\r\n    Item.prototype.removeChild = function (item) {\r\n        var isFirstChild = this.firstChild === item;\r\n        var isLastChild = this.lastChild === item;\r\n        if (isFirstChild && isLastChild) {\r\n            this.firstChild = this.lastChild = null;\r\n        }\r\n        else if (isFirstChild) {\r\n            item.next.previous = null;\r\n            this.firstChild = item.next;\r\n        }\r\n        else if (isLastChild) {\r\n            item.previous.next = null;\r\n            this.lastChild = item.previous;\r\n        }\r\n        else {\r\n            item.next.previous = item.previous;\r\n            item.previous.next = item.next;\r\n        }\r\n        item.parent = null;\r\n        item.depth = null;\r\n    };\r\n    Item.prototype.forEachChild = function (fn) {\r\n        var child = this.firstChild, next;\r\n        while (child) {\r\n            next = child.next;\r\n            fn(child);\r\n            child = next;\r\n        }\r\n    };\r\n    Item.prototype.mapEachChild = function (fn) {\r\n        var result = [];\r\n        this.forEachChild(function (child) {\r\n            result.push(fn(child));\r\n        });\r\n        return result;\r\n    };\r\n    Item.prototype.sort = function (elements) {\r\n        var _this = this;\r\n        if (this.context.sorter) {\r\n            return elements.sort(function (element, otherElement) {\r\n                return _this.context.sorter.compare(_this.context.tree, element, otherElement);\r\n            });\r\n        }\r\n        return elements;\r\n    };\r\n    /* protected */ Item.prototype._getHeight = function () {\r\n        return this.context.renderer.getHeight(this.context.tree, this.element);\r\n    };\r\n    /* protected */ Item.prototype._isVisible = function () {\r\n        return this.context.filter.isVisible(this.context.tree, this.element);\r\n    };\r\n    Item.prototype.isDisposed = function () {\r\n        return this._isDisposed;\r\n    };\r\n    Item.prototype.dispose = function () {\r\n        this.forEachChild(function (child) { return child.dispose(); });\r\n        this.parent = null;\r\n        this.previous = null;\r\n        this.next = null;\r\n        this.firstChild = null;\r\n        this.lastChild = null;\r\n        this._onDidDispose.fire(this);\r\n        this.registry.deregister(this);\r\n        this._onDidCreate.dispose();\r\n        this._onDidReveal.dispose();\r\n        this._onExpand.dispose();\r\n        this._onDidExpand.dispose();\r\n        this._onCollapse.dispose();\r\n        this._onDidCollapse.dispose();\r\n        this._onDidAddTrait.dispose();\r\n        this._onDidRemoveTrait.dispose();\r\n        this._onDidRefresh.dispose();\r\n        this._onRefreshChildren.dispose();\r\n        this._onDidRefreshChildren.dispose();\r\n        this._onDidDispose.dispose();\r\n        this._isDisposed = true;\r\n    };\r\n    return Item;\r\n}());\r\nexport { Item };\r\nvar RootItem = /** @class */ (function (_super) {\r\n    __extends(RootItem, _super);\r\n    function RootItem(id, registry, context, lock, element) {\r\n        return _super.call(this, id, registry, context, lock, element) || this;\r\n    }\r\n    RootItem.prototype.isVisible = function () {\r\n        return false;\r\n    };\r\n    RootItem.prototype.setVisible = function (value) {\r\n        // no-op\r\n    };\r\n    RootItem.prototype.isExpanded = function () {\r\n        return true;\r\n    };\r\n    /* protected */ RootItem.prototype._setExpanded = function (value) {\r\n        // no-op\r\n    };\r\n    /* protected */ RootItem.prototype._getHeight = function () {\r\n        return 0;\r\n    };\r\n    /* protected */ RootItem.prototype._isVisible = function () {\r\n        return false;\r\n    };\r\n    return RootItem;\r\n}(Item));\r\nvar TreeNavigator = /** @class */ (function () {\r\n    function TreeNavigator(item, subTreeOnly) {\r\n        if (subTreeOnly === void 0) { subTreeOnly = true; }\r\n        this.item = item;\r\n        this.start = subTreeOnly ? item : null;\r\n    }\r\n    TreeNavigator.lastDescendantOf = function (item) {\r\n        if (!item) {\r\n            return null;\r\n        }\r\n        if (item instanceof RootItem) {\r\n            return TreeNavigator.lastDescendantOf(item.lastChild);\r\n        }\r\n        if (!item.isVisible()) {\r\n            return TreeNavigator.lastDescendantOf(item.previous);\r\n        }\r\n        if (!item.isExpanded() || item.lastChild === null) {\r\n            return item;\r\n        }\r\n        return TreeNavigator.lastDescendantOf(item.lastChild);\r\n    };\r\n    TreeNavigator.prototype.current = function () {\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.next = function () {\r\n        if (this.item) {\r\n            do {\r\n                if ((this.item instanceof RootItem || (this.item.isVisible() && this.item.isExpanded())) && this.item.firstChild) {\r\n                    this.item = this.item.firstChild;\r\n                }\r\n                else if (this.item === this.start) {\r\n                    this.item = null;\r\n                }\r\n                else {\r\n                    // select next brother, next uncle, next great-uncle, etc...\r\n                    while (this.item && this.item !== this.start && !this.item.next) {\r\n                        this.item = this.item.parent;\r\n                    }\r\n                    if (this.item === this.start) {\r\n                        this.item = null;\r\n                    }\r\n                    this.item = !this.item ? null : this.item.next;\r\n                }\r\n            } while (this.item && !this.item.isVisible());\r\n        }\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.previous = function () {\r\n        if (this.item) {\r\n            do {\r\n                var previous = TreeNavigator.lastDescendantOf(this.item.previous);\r\n                if (previous) {\r\n                    this.item = previous;\r\n                }\r\n                else if (this.item.parent && this.item.parent !== this.start && this.item.parent.isVisible()) {\r\n                    this.item = this.item.parent;\r\n                }\r\n                else {\r\n                    this.item = null;\r\n                }\r\n            } while (this.item && !this.item.isVisible());\r\n        }\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.parent = function () {\r\n        if (this.item) {\r\n            var parent = this.item.parent;\r\n            if (parent && parent !== this.start && parent.isVisible()) {\r\n                this.item = parent;\r\n            }\r\n            else {\r\n                this.item = null;\r\n            }\r\n        }\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.first = function () {\r\n        this.item = this.start;\r\n        this.next();\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.last = function () {\r\n        return TreeNavigator.lastDescendantOf(this.start);\r\n    };\r\n    return TreeNavigator;\r\n}());\r\nexport { TreeNavigator };\r\nvar TreeModel = /** @class */ (function () {\r\n    function TreeModel(context) {\r\n        this._onSetInput = new Emitter();\r\n        this.onSetInput = this._onSetInput.event;\r\n        this._onDidSetInput = new Emitter();\r\n        this.onDidSetInput = this._onDidSetInput.event;\r\n        this._onRefresh = new Emitter();\r\n        this.onRefresh = this._onRefresh.event;\r\n        this._onDidRefresh = new Emitter();\r\n        this.onDidRefresh = this._onDidRefresh.event;\r\n        this._onDidHighlight = new Emitter();\r\n        this.onDidHighlight = this._onDidHighlight.event;\r\n        this._onDidSelect = new Emitter();\r\n        this.onDidSelect = this._onDidSelect.event;\r\n        this._onDidFocus = new Emitter();\r\n        this.onDidFocus = this._onDidFocus.event;\r\n        this._onDidRevealItem = new Relay();\r\n        this.onDidRevealItem = this._onDidRevealItem.event;\r\n        this._onExpandItem = new Relay();\r\n        this.onExpandItem = this._onExpandItem.event;\r\n        this._onDidExpandItem = new Relay();\r\n        this.onDidExpandItem = this._onDidExpandItem.event;\r\n        this._onCollapseItem = new Relay();\r\n        this.onCollapseItem = this._onCollapseItem.event;\r\n        this._onDidCollapseItem = new Relay();\r\n        this.onDidCollapseItem = this._onDidCollapseItem.event;\r\n        this._onDidAddTraitItem = new Relay();\r\n        this.onDidAddTraitItem = this._onDidAddTraitItem.event;\r\n        this._onDidRemoveTraitItem = new Relay();\r\n        this.onDidRemoveTraitItem = this._onDidRemoveTraitItem.event;\r\n        this._onDidRefreshItem = new Relay();\r\n        this.onDidRefreshItem = this._onDidRefreshItem.event;\r\n        this._onRefreshItemChildren = new Relay();\r\n        this.onRefreshItemChildren = this._onRefreshItemChildren.event;\r\n        this._onDidRefreshItemChildren = new Relay();\r\n        this.onDidRefreshItemChildren = this._onDidRefreshItemChildren.event;\r\n        this._onDidDisposeItem = new Relay();\r\n        this.context = context;\r\n        this.input = null;\r\n        this.traitsToItems = {};\r\n    }\r\n    TreeModel.prototype.setInput = function (element) {\r\n        var _this = this;\r\n        var eventData = { item: this.input };\r\n        this._onSetInput.fire(eventData);\r\n        this.setSelection([]);\r\n        this.setFocus();\r\n        this.setHighlight();\r\n        this.lock = new Lock();\r\n        if (this.input) {\r\n            this.input.dispose();\r\n        }\r\n        if (this.registry) {\r\n            this.registry.dispose();\r\n            this.registryDisposable.dispose();\r\n        }\r\n        this.registry = new ItemRegistry();\r\n        this._onDidRevealItem.input = this.registry.onDidRevealItem;\r\n        this._onExpandItem.input = this.registry.onExpandItem;\r\n        this._onDidExpandItem.input = this.registry.onDidExpandItem;\r\n        this._onCollapseItem.input = this.registry.onCollapseItem;\r\n        this._onDidCollapseItem.input = this.registry.onDidCollapseItem;\r\n        this._onDidAddTraitItem.input = this.registry.onDidAddTraitItem;\r\n        this._onDidRemoveTraitItem.input = this.registry.onDidRemoveTraitItem;\r\n        this._onDidRefreshItem.input = this.registry.onDidRefreshItem;\r\n        this._onRefreshItemChildren.input = this.registry.onRefreshItemChildren;\r\n        this._onDidRefreshItemChildren.input = this.registry.onDidRefreshItemChildren;\r\n        this._onDidDisposeItem.input = this.registry.onDidDisposeItem;\r\n        this.registryDisposable = this.registry\r\n            .onDidDisposeItem(function (item) { return item.getAllTraits().forEach(function (trait) { return delete _this.traitsToItems[trait][item.id]; }); });\r\n        var id = this.context.dataSource.getId(this.context.tree, element);\r\n        this.input = new RootItem(id, this.registry, this.context, this.lock, element);\r\n        eventData = { item: this.input };\r\n        this._onDidSetInput.fire(eventData);\r\n        return this.refresh(this.input);\r\n    };\r\n    TreeModel.prototype.getInput = function () {\r\n        return this.input ? this.input.getElement() : null;\r\n    };\r\n    TreeModel.prototype.refresh = function (element, recursive) {\r\n        var _this = this;\r\n        if (element === void 0) { element = null; }\r\n        if (recursive === void 0) { recursive = true; }\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return WinJS.TPromise.as(null);\r\n        }\r\n        var eventData = { item: item, recursive: recursive };\r\n        this._onRefresh.fire(eventData);\r\n        return item.refresh(recursive).then(function () {\r\n            _this._onDidRefresh.fire(eventData);\r\n        });\r\n    };\r\n    TreeModel.prototype.expand = function (element) {\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return WinJS.TPromise.as(false);\r\n        }\r\n        return item.expand();\r\n    };\r\n    TreeModel.prototype.collapse = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return WinJS.TPromise.as(false);\r\n        }\r\n        return item.collapse(recursive);\r\n    };\r\n    TreeModel.prototype.toggleExpansion = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        return this.isExpanded(element) ? this.collapse(element, recursive) : this.expand(element);\r\n    };\r\n    TreeModel.prototype.isExpanded = function (element) {\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return false;\r\n        }\r\n        return item.isExpanded();\r\n    };\r\n    TreeModel.prototype.reveal = function (element, relativeTop) {\r\n        var _this = this;\r\n        if (relativeTop === void 0) { relativeTop = null; }\r\n        return this.resolveUnknownParentChain(element).then(function (chain) {\r\n            var result = WinJS.TPromise.as(null);\r\n            chain.forEach(function (e) {\r\n                result = result.then(function () { return _this.expand(e); });\r\n            });\r\n            return result;\r\n        }).then(function () {\r\n            var item = _this.getItem(element);\r\n            if (item) {\r\n                return item.reveal(relativeTop);\r\n            }\r\n        });\r\n    };\r\n    TreeModel.prototype.resolveUnknownParentChain = function (element) {\r\n        var _this = this;\r\n        return this.context.dataSource.getParent(this.context.tree, element).then(function (parent) {\r\n            if (!parent) {\r\n                return WinJS.TPromise.as([]);\r\n            }\r\n            return _this.resolveUnknownParentChain(parent).then(function (result) {\r\n                result.push(parent);\r\n                return result;\r\n            });\r\n        });\r\n    };\r\n    TreeModel.prototype.setHighlight = function (element, eventPayload) {\r\n        this.setTraits('highlighted', element ? [element] : []);\r\n        var eventData = { highlight: this.getHighlight(), payload: eventPayload };\r\n        this._onDidHighlight.fire(eventData);\r\n    };\r\n    TreeModel.prototype.getHighlight = function (includeHidden) {\r\n        var result = this.getElementsWithTrait('highlighted', includeHidden);\r\n        return result.length === 0 ? null : result[0];\r\n    };\r\n    TreeModel.prototype.setSelection = function (elements, eventPayload) {\r\n        this.setTraits('selected', elements);\r\n        var eventData = { selection: this.getSelection(), payload: eventPayload };\r\n        this._onDidSelect.fire(eventData);\r\n    };\r\n    TreeModel.prototype.getSelection = function (includeHidden) {\r\n        return this.getElementsWithTrait('selected', includeHidden);\r\n    };\r\n    TreeModel.prototype.setFocus = function (element, eventPayload) {\r\n        this.setTraits('focused', element ? [element] : []);\r\n        var eventData = { focus: this.getFocus(), payload: eventPayload };\r\n        this._onDidFocus.fire(eventData);\r\n    };\r\n    TreeModel.prototype.getFocus = function (includeHidden) {\r\n        var result = this.getElementsWithTrait('focused', includeHidden);\r\n        return result.length === 0 ? null : result[0];\r\n    };\r\n    TreeModel.prototype.focusNext = function (count, eventPayload) {\r\n        if (count === void 0) { count = 1; }\r\n        var item = this.getFocus() || this.input;\r\n        var nextItem;\r\n        var nav = this.getNavigator(item, false);\r\n        for (var i = 0; i < count; i++) {\r\n            nextItem = nav.next();\r\n            if (!nextItem) {\r\n                break;\r\n            }\r\n            item = nextItem;\r\n        }\r\n        this.setFocus(item, eventPayload);\r\n    };\r\n    TreeModel.prototype.focusPrevious = function (count, eventPayload) {\r\n        if (count === void 0) { count = 1; }\r\n        var item = this.getFocus() || this.input;\r\n        var previousItem;\r\n        var nav = this.getNavigator(item, false);\r\n        for (var i = 0; i < count; i++) {\r\n            previousItem = nav.previous();\r\n            if (!previousItem) {\r\n                break;\r\n            }\r\n            item = previousItem;\r\n        }\r\n        this.setFocus(item, eventPayload);\r\n    };\r\n    TreeModel.prototype.focusParent = function (eventPayload) {\r\n        var item = this.getFocus() || this.input;\r\n        var nav = this.getNavigator(item, false);\r\n        var parent = nav.parent();\r\n        if (parent) {\r\n            this.setFocus(parent, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.focusFirstChild = function (eventPayload) {\r\n        var item = this.getItem(this.getFocus() || this.input);\r\n        var nav = this.getNavigator(item, false);\r\n        var next = nav.next();\r\n        var parent = nav.parent();\r\n        if (parent === item) {\r\n            this.setFocus(next, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.focusFirst = function (eventPayload, from) {\r\n        this.focusNth(0, eventPayload, from);\r\n    };\r\n    TreeModel.prototype.focusNth = function (index, eventPayload, from) {\r\n        var navItem = this.getParent(from);\r\n        var nav = this.getNavigator(navItem);\r\n        var item = nav.first();\r\n        for (var i = 0; i < index; i++) {\r\n            item = nav.next();\r\n        }\r\n        if (item) {\r\n            this.setFocus(item, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.focusLast = function (eventPayload, from) {\r\n        var navItem = this.getParent(from);\r\n        var item;\r\n        if (from) {\r\n            item = navItem.lastChild;\r\n        }\r\n        else {\r\n            var nav = this.getNavigator(navItem);\r\n            item = nav.last();\r\n        }\r\n        if (item) {\r\n            this.setFocus(item, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.getParent = function (from) {\r\n        if (from) {\r\n            var fromItem = this.getItem(from);\r\n            if (fromItem && fromItem.parent) {\r\n                return fromItem.parent;\r\n            }\r\n        }\r\n        return this.getItem(this.input);\r\n    };\r\n    TreeModel.prototype.getNavigator = function (element, subTreeOnly) {\r\n        if (element === void 0) { element = null; }\r\n        if (subTreeOnly === void 0) { subTreeOnly = true; }\r\n        return new TreeNavigator(this.getItem(element), subTreeOnly);\r\n    };\r\n    TreeModel.prototype.getItem = function (element) {\r\n        if (element === void 0) { element = null; }\r\n        if (element === null) {\r\n            return this.input;\r\n        }\r\n        else if (element instanceof Item) {\r\n            return element;\r\n        }\r\n        else if (typeof element === 'string') {\r\n            return this.registry.getItem(element);\r\n        }\r\n        else {\r\n            return this.registry.getItem(this.context.dataSource.getId(this.context.tree, element));\r\n        }\r\n    };\r\n    TreeModel.prototype.removeTraits = function (trait, elements) {\r\n        var items = this.traitsToItems[trait] || {};\r\n        var item;\r\n        var id;\r\n        if (elements.length === 0) {\r\n            for (id in items) {\r\n                if (items.hasOwnProperty(id)) {\r\n                    item = items[id];\r\n                    item.removeTrait(trait);\r\n                }\r\n            }\r\n            delete this.traitsToItems[trait];\r\n        }\r\n        else {\r\n            for (var i = 0, len = elements.length; i < len; i++) {\r\n                item = this.getItem(elements[i]);\r\n                if (item) {\r\n                    item.removeTrait(trait);\r\n                    delete items[item.id];\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TreeModel.prototype.setTraits = function (trait, elements) {\r\n        if (elements.length === 0) {\r\n            this.removeTraits(trait, elements);\r\n        }\r\n        else {\r\n            var items = {};\r\n            var item;\r\n            for (var i = 0, len = elements.length; i < len; i++) {\r\n                item = this.getItem(elements[i]);\r\n                if (item) {\r\n                    items[item.id] = item;\r\n                }\r\n            }\r\n            var traitItems = this.traitsToItems[trait] || {};\r\n            var itemsToRemoveTrait = [];\r\n            var id;\r\n            for (id in traitItems) {\r\n                if (traitItems.hasOwnProperty(id)) {\r\n                    if (items.hasOwnProperty(id)) {\r\n                        delete items[id];\r\n                    }\r\n                    else {\r\n                        itemsToRemoveTrait.push(traitItems[id]);\r\n                    }\r\n                }\r\n            }\r\n            for (var i = 0, len = itemsToRemoveTrait.length; i < len; i++) {\r\n                item = itemsToRemoveTrait[i];\r\n                item.removeTrait(trait);\r\n                delete traitItems[item.id];\r\n            }\r\n            for (id in items) {\r\n                if (items.hasOwnProperty(id)) {\r\n                    item = items[id];\r\n                    item.addTrait(trait);\r\n                    traitItems[id] = item;\r\n                }\r\n            }\r\n            this.traitsToItems[trait] = traitItems;\r\n        }\r\n    };\r\n    TreeModel.prototype.getElementsWithTrait = function (trait, includeHidden) {\r\n        var elements = [];\r\n        var items = this.traitsToItems[trait] || {};\r\n        var id;\r\n        for (id in items) {\r\n            if (items.hasOwnProperty(id) && (items[id].isVisible() || includeHidden)) {\r\n                elements.push(items[id].getElement());\r\n            }\r\n        }\r\n        return elements;\r\n    };\r\n    TreeModel.prototype.dispose = function () {\r\n        if (this.registry) {\r\n            this.registry.dispose();\r\n            this.registry = null;\r\n        }\r\n        this._onSetInput.dispose();\r\n        this._onDidSetInput.dispose();\r\n        this._onRefresh.dispose();\r\n        this._onDidRefresh.dispose();\r\n        this._onDidHighlight.dispose();\r\n        this._onDidSelect.dispose();\r\n        this._onDidFocus.dispose();\r\n        this._onDidRevealItem.dispose();\r\n        this._onExpandItem.dispose();\r\n        this._onDidExpandItem.dispose();\r\n        this._onCollapseItem.dispose();\r\n        this._onDidCollapseItem.dispose();\r\n        this._onDidAddTraitItem.dispose();\r\n        this._onDidRemoveTraitItem.dispose();\r\n        this._onDidRefreshItem.dispose();\r\n        this._onRefreshItemChildren.dispose();\r\n        this._onDidRefreshItemChildren.dispose();\r\n        this._onDidDisposeItem.dispose();\r\n    };\r\n    return TreeModel;\r\n}());\r\nexport { TreeModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar ElementsDragAndDropData = /** @class */ (function () {\r\n    function ElementsDragAndDropData(elements) {\r\n        this.elements = elements;\r\n    }\r\n    ElementsDragAndDropData.prototype.update = function (event) {\r\n        // no-op\r\n    };\r\n    return ElementsDragAndDropData;\r\n}());\r\nexport { ElementsDragAndDropData };\r\nvar ExternalElementsDragAndDropData = /** @class */ (function () {\r\n    function ExternalElementsDragAndDropData(elements) {\r\n        this.elements = elements;\r\n    }\r\n    ExternalElementsDragAndDropData.prototype.update = function (event) {\r\n        // no-op\r\n    };\r\n    return ExternalElementsDragAndDropData;\r\n}());\r\nexport { ExternalElementsDragAndDropData };\r\nvar DesktopDragAndDropData = /** @class */ (function () {\r\n    function DesktopDragAndDropData() {\r\n        this.types = [];\r\n        this.files = [];\r\n    }\r\n    DesktopDragAndDropData.prototype.update = function (event) {\r\n        if (event.dataTransfer.types) {\r\n            this.types = [];\r\n            Array.prototype.push.apply(this.types, event.dataTransfer.types);\r\n        }\r\n        if (event.dataTransfer.files) {\r\n            this.files = [];\r\n            Array.prototype.push.apply(this.files, event.dataTransfer.files);\r\n            this.files = this.files.filter(function (f) { return f.size || f.type; });\r\n        }\r\n    };\r\n    return DesktopDragAndDropData;\r\n}());\r\nexport { DesktopDragAndDropData };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { ArrayIterator } from '../../../common/iterator.js';\r\nvar HeightMap = /** @class */ (function () {\r\n    function HeightMap() {\r\n        this.heightMap = [];\r\n        this.indexes = {};\r\n    }\r\n    HeightMap.prototype.getContentHeight = function () {\r\n        var last = this.heightMap[this.heightMap.length - 1];\r\n        return !last ? 0 : last.top + last.height;\r\n    };\r\n    HeightMap.prototype.onInsertItems = function (iterator, afterItemId) {\r\n        if (afterItemId === void 0) { afterItemId = null; }\r\n        var item;\r\n        var viewItem;\r\n        var i, j;\r\n        var totalSize;\r\n        var sizeDiff = 0;\r\n        if (afterItemId === null) {\r\n            i = 0;\r\n            totalSize = 0;\r\n        }\r\n        else {\r\n            i = this.indexes[afterItemId] + 1;\r\n            viewItem = this.heightMap[i - 1];\r\n            if (!viewItem) {\r\n                console.error('view item doesnt exist');\r\n                return undefined;\r\n            }\r\n            totalSize = viewItem.top + viewItem.height;\r\n        }\r\n        var boundSplice = this.heightMap.splice.bind(this.heightMap, i, 0);\r\n        var itemsToInsert = [];\r\n        while (item = iterator.next()) {\r\n            viewItem = this.createViewItem(item);\r\n            viewItem.top = totalSize + sizeDiff;\r\n            this.indexes[item.id] = i++;\r\n            itemsToInsert.push(viewItem);\r\n            sizeDiff += viewItem.height;\r\n        }\r\n        boundSplice.apply(this.heightMap, itemsToInsert);\r\n        for (j = i; j < this.heightMap.length; j++) {\r\n            viewItem = this.heightMap[j];\r\n            viewItem.top += sizeDiff;\r\n            this.indexes[viewItem.model.id] = j;\r\n        }\r\n        for (j = itemsToInsert.length - 1; j >= 0; j--) {\r\n            this.onInsertItem(itemsToInsert[j]);\r\n        }\r\n        for (j = this.heightMap.length - 1; j >= i; j--) {\r\n            this.onRefreshItem(this.heightMap[j]);\r\n        }\r\n        return sizeDiff;\r\n    };\r\n    HeightMap.prototype.onInsertItem = function (item) {\r\n        // noop\r\n    };\r\n    // Contiguous items\r\n    HeightMap.prototype.onRemoveItems = function (iterator) {\r\n        var itemId;\r\n        var viewItem;\r\n        var startIndex = null;\r\n        var i;\r\n        var sizeDiff = 0;\r\n        while (itemId = iterator.next()) {\r\n            i = this.indexes[itemId];\r\n            viewItem = this.heightMap[i];\r\n            if (!viewItem) {\r\n                console.error('view item doesnt exist');\r\n                return;\r\n            }\r\n            sizeDiff -= viewItem.height;\r\n            delete this.indexes[itemId];\r\n            this.onRemoveItem(viewItem);\r\n            if (startIndex === null) {\r\n                startIndex = i;\r\n            }\r\n        }\r\n        if (sizeDiff === 0) {\r\n            return;\r\n        }\r\n        this.heightMap.splice(startIndex, i - startIndex + 1);\r\n        for (i = startIndex; i < this.heightMap.length; i++) {\r\n            viewItem = this.heightMap[i];\r\n            viewItem.top += sizeDiff;\r\n            this.indexes[viewItem.model.id] = i;\r\n            this.onRefreshItem(viewItem);\r\n        }\r\n    };\r\n    HeightMap.prototype.onRemoveItem = function (item) {\r\n        // noop\r\n    };\r\n    HeightMap.prototype.onRefreshItemSet = function (items) {\r\n        var _this = this;\r\n        var sortedItems = items.sort(function (a, b) { return _this.indexes[a.id] - _this.indexes[b.id]; });\r\n        this.onRefreshItems(new ArrayIterator(sortedItems));\r\n    };\r\n    // Ordered, but not necessarily contiguous items\r\n    HeightMap.prototype.onRefreshItems = function (iterator) {\r\n        var item;\r\n        var viewItem;\r\n        var newHeight;\r\n        var i, j = null;\r\n        var cummDiff = 0;\r\n        while (item = iterator.next()) {\r\n            i = this.indexes[item.id];\r\n            for (; cummDiff !== 0 && j !== null && j < i; j++) {\r\n                viewItem = this.heightMap[j];\r\n                viewItem.top += cummDiff;\r\n                this.onRefreshItem(viewItem);\r\n            }\r\n            viewItem = this.heightMap[i];\r\n            newHeight = item.getHeight();\r\n            viewItem.top += cummDiff;\r\n            cummDiff += newHeight - viewItem.height;\r\n            viewItem.height = newHeight;\r\n            this.onRefreshItem(viewItem, true);\r\n            j = i + 1;\r\n        }\r\n        if (cummDiff !== 0 && j !== null) {\r\n            for (; j < this.heightMap.length; j++) {\r\n                viewItem = this.heightMap[j];\r\n                viewItem.top += cummDiff;\r\n                this.onRefreshItem(viewItem);\r\n            }\r\n        }\r\n    };\r\n    HeightMap.prototype.onRefreshItem = function (item, needsRender) {\r\n        if (needsRender === void 0) { needsRender = false; }\r\n        // noop\r\n    };\r\n    HeightMap.prototype.indexAt = function (position) {\r\n        var left = 0;\r\n        var right = this.heightMap.length;\r\n        var center;\r\n        var item;\r\n        // Binary search\r\n        while (left < right) {\r\n            center = Math.floor((left + right) / 2);\r\n            item = this.heightMap[center];\r\n            if (position < item.top) {\r\n                right = center;\r\n            }\r\n            else if (position >= item.top + item.height) {\r\n                if (left === center) {\r\n                    break;\r\n                }\r\n                left = center;\r\n            }\r\n            else {\r\n                return center;\r\n            }\r\n        }\r\n        return this.heightMap.length;\r\n    };\r\n    HeightMap.prototype.indexAfter = function (position) {\r\n        return Math.min(this.indexAt(position) + 1, this.heightMap.length);\r\n    };\r\n    HeightMap.prototype.itemAtIndex = function (index) {\r\n        return this.heightMap[index];\r\n    };\r\n    HeightMap.prototype.itemAfter = function (item) {\r\n        return this.heightMap[this.indexes[item.model.id] + 1] || null;\r\n    };\r\n    HeightMap.prototype.createViewItem = function (item) {\r\n        throw new Error('not implemented');\r\n    };\r\n    HeightMap.prototype.dispose = function () {\r\n        this.heightMap = null;\r\n        this.indexes = null;\r\n    };\r\n    return HeightMap;\r\n}());\r\nexport { HeightMap };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar ContextMenuEvent = /** @class */ (function () {\r\n    function ContextMenuEvent(posx, posy, target) {\r\n        this._posx = posx;\r\n        this._posy = posy;\r\n        this._target = target;\r\n    }\r\n    ContextMenuEvent.prototype.preventDefault = function () {\r\n        // no-op\r\n    };\r\n    ContextMenuEvent.prototype.stopPropagation = function () {\r\n        // no-op\r\n    };\r\n    Object.defineProperty(ContextMenuEvent.prototype, \"target\", {\r\n        get: function () {\r\n            return this._target;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return ContextMenuEvent;\r\n}());\r\nexport { ContextMenuEvent };\r\nvar MouseContextMenuEvent = /** @class */ (function (_super) {\r\n    __extends(MouseContextMenuEvent, _super);\r\n    function MouseContextMenuEvent(originalEvent) {\r\n        var _this = _super.call(this, originalEvent.posx, originalEvent.posy, originalEvent.target) || this;\r\n        _this.originalEvent = originalEvent;\r\n        return _this;\r\n    }\r\n    MouseContextMenuEvent.prototype.preventDefault = function () {\r\n        this.originalEvent.preventDefault();\r\n    };\r\n    MouseContextMenuEvent.prototype.stopPropagation = function () {\r\n        this.originalEvent.stopPropagation();\r\n    };\r\n    return MouseContextMenuEvent;\r\n}(ContextMenuEvent));\r\nexport { MouseContextMenuEvent };\r\nvar KeyboardContextMenuEvent = /** @class */ (function (_super) {\r\n    __extends(KeyboardContextMenuEvent, _super);\r\n    function KeyboardContextMenuEvent(posx, posy, originalEvent) {\r\n        var _this = _super.call(this, posx, posy, originalEvent.target) || this;\r\n        _this.originalEvent = originalEvent;\r\n        return _this;\r\n    }\r\n    KeyboardContextMenuEvent.prototype.preventDefault = function () {\r\n        this.originalEvent.preventDefault();\r\n    };\r\n    KeyboardContextMenuEvent.prototype.stopPropagation = function () {\r\n        this.originalEvent.stopPropagation();\r\n    };\r\n    return KeyboardContextMenuEvent;\r\n}(ContextMenuEvent));\r\nexport { KeyboardContextMenuEvent };\r\n","// Common data transfers\r\nexport var DataTransfers = {\r\n    /**\r\n     * Application specific resource transfer type\r\n     */\r\n    RESOURCES: 'ResourceURLs',\r\n    /**\r\n     * Browser specific transfer type to download\r\n     */\r\n    DOWNLOAD_URL: 'DownloadURL',\r\n    /**\r\n     * Browser specific transfer type for files\r\n     */\r\n    FILES: 'Files',\r\n    /**\r\n     * Typicaly transfer type for copy/paste transfers.\r\n     */\r\n    TEXT: 'text/plain'\r\n};\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as Platform from '../../../common/platform.js';\r\nimport * as Browser from '../../../browser/browser.js';\r\nimport * as Lifecycle from '../../../common/lifecycle.js';\r\nimport * as DOM from '../../../browser/dom.js';\r\nimport * as Diff from '../../../common/diff/diff.js';\r\nimport * as Touch from '../../../browser/touch.js';\r\nimport * as strings from '../../../common/strings.js';\r\nimport * as Mouse from '../../../browser/mouseEvent.js';\r\nimport * as Keyboard from '../../../browser/keyboardEvent.js';\r\nimport * as dnd from './treeDnd.js';\r\nimport { ArrayIterator, MappedIterator } from '../../../common/iterator.js';\r\nimport { ScrollableElement } from '../../../browser/ui/scrollbar/scrollableElement.js';\r\nimport { HeightMap } from './treeViewModel.js';\r\nimport * as _ from './tree.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { DataTransfers } from '../../../browser/dnd.js';\r\nimport { DefaultTreestyler } from './treeDefaults.js';\r\nimport { Delayer, timeout } from '../../../common/async.js';\r\nfunction removeFromParent(element) {\r\n    try {\r\n        element.parentElement.removeChild(element);\r\n    }\r\n    catch (e) {\r\n        // this will throw if this happens due to a blur event, nasty business\r\n    }\r\n}\r\nvar RowCache = /** @class */ (function () {\r\n    function RowCache(context) {\r\n        this.context = context;\r\n        this._cache = { '': [] };\r\n    }\r\n    RowCache.prototype.alloc = function (templateId) {\r\n        var result = this.cache(templateId).pop();\r\n        if (!result) {\r\n            var content = document.createElement('div');\r\n            content.className = 'content';\r\n            var row = document.createElement('div');\r\n            row.appendChild(content);\r\n            var templateData = null;\r\n            try {\r\n                templateData = this.context.renderer.renderTemplate(this.context.tree, templateId, content);\r\n            }\r\n            catch (err) {\r\n                console.error('Tree usage error: exception while rendering template');\r\n                console.error(err);\r\n            }\r\n            result = {\r\n                element: row,\r\n                templateId: templateId,\r\n                templateData: templateData\r\n            };\r\n        }\r\n        return result;\r\n    };\r\n    RowCache.prototype.release = function (templateId, row) {\r\n        removeFromParent(row.element);\r\n        this.cache(templateId).push(row);\r\n    };\r\n    RowCache.prototype.cache = function (templateId) {\r\n        return this._cache[templateId] || (this._cache[templateId] = []);\r\n    };\r\n    RowCache.prototype.garbageCollect = function () {\r\n        var _this = this;\r\n        if (this._cache) {\r\n            Object.keys(this._cache).forEach(function (templateId) {\r\n                _this._cache[templateId].forEach(function (cachedRow) {\r\n                    _this.context.renderer.disposeTemplate(_this.context.tree, templateId, cachedRow.templateData);\r\n                    cachedRow.element = null;\r\n                    cachedRow.templateData = null;\r\n                });\r\n                delete _this._cache[templateId];\r\n            });\r\n        }\r\n    };\r\n    RowCache.prototype.dispose = function () {\r\n        this.garbageCollect();\r\n        this._cache = null;\r\n        this.context = null;\r\n    };\r\n    return RowCache;\r\n}());\r\nexport { RowCache };\r\nvar ViewItem = /** @class */ (function () {\r\n    function ViewItem(context, model) {\r\n        var _this = this;\r\n        this.width = 0;\r\n        this.context = context;\r\n        this.model = model;\r\n        this.id = this.model.id;\r\n        this.row = null;\r\n        this.top = 0;\r\n        this.height = model.getHeight();\r\n        this._styles = {};\r\n        model.getAllTraits().forEach(function (t) { return _this._styles[t] = true; });\r\n        if (model.isExpanded()) {\r\n            this.addClass('expanded');\r\n        }\r\n    }\r\n    Object.defineProperty(ViewItem.prototype, \"expanded\", {\r\n        set: function (value) {\r\n            value ? this.addClass('expanded') : this.removeClass('expanded');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"loading\", {\r\n        set: function (value) {\r\n            value ? this.addClass('loading') : this.removeClass('loading');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"draggable\", {\r\n        get: function () {\r\n            return this._draggable;\r\n        },\r\n        set: function (value) {\r\n            this._draggable = value;\r\n            this.render(true);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"dropTarget\", {\r\n        set: function (value) {\r\n            value ? this.addClass('drop-target') : this.removeClass('drop-target');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"element\", {\r\n        get: function () {\r\n            return this.row && this.row.element;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"templateId\", {\r\n        get: function () {\r\n            return this._templateId || (this._templateId = (this.context.renderer.getTemplateId && this.context.renderer.getTemplateId(this.context.tree, this.model.getElement())));\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ViewItem.prototype.addClass = function (name) {\r\n        this._styles[name] = true;\r\n        this.render(true);\r\n    };\r\n    ViewItem.prototype.removeClass = function (name) {\r\n        delete this._styles[name]; // is this slow?\r\n        this.render(true);\r\n    };\r\n    ViewItem.prototype.render = function (skipUserRender) {\r\n        var _this = this;\r\n        if (skipUserRender === void 0) { skipUserRender = false; }\r\n        if (!this.model || !this.element) {\r\n            return;\r\n        }\r\n        var classes = ['monaco-tree-row'];\r\n        classes.push.apply(classes, Object.keys(this._styles));\r\n        if (this.model.hasChildren()) {\r\n            classes.push('has-children');\r\n        }\r\n        this.element.className = classes.join(' ');\r\n        this.element.draggable = this.draggable;\r\n        this.element.style.height = this.height + 'px';\r\n        // ARIA\r\n        this.element.setAttribute('role', 'treeitem');\r\n        var accessibility = this.context.accessibilityProvider;\r\n        var ariaLabel = accessibility.getAriaLabel(this.context.tree, this.model.getElement());\r\n        if (ariaLabel) {\r\n            this.element.setAttribute('aria-label', ariaLabel);\r\n        }\r\n        if (accessibility.getPosInSet && accessibility.getSetSize) {\r\n            this.element.setAttribute('aria-setsize', accessibility.getSetSize());\r\n            this.element.setAttribute('aria-posinset', accessibility.getPosInSet(this.context.tree, this.model.getElement()));\r\n        }\r\n        if (this.model.hasTrait('focused')) {\r\n            var base64Id = strings.safeBtoa(this.model.id);\r\n            this.element.setAttribute('aria-selected', 'true');\r\n            this.element.setAttribute('id', base64Id);\r\n        }\r\n        else {\r\n            this.element.setAttribute('aria-selected', 'false');\r\n            this.element.removeAttribute('id');\r\n        }\r\n        if (this.model.hasChildren()) {\r\n            this.element.setAttribute('aria-expanded', String(!!this._styles['expanded']));\r\n        }\r\n        else {\r\n            this.element.removeAttribute('aria-expanded');\r\n        }\r\n        this.element.setAttribute('aria-level', String(this.model.getDepth()));\r\n        if (this.context.options.paddingOnRow) {\r\n            this.element.style.paddingLeft = this.context.options.twistiePixels + ((this.model.getDepth() - 1) * this.context.options.indentPixels) + 'px';\r\n        }\r\n        else {\r\n            this.element.style.paddingLeft = ((this.model.getDepth() - 1) * this.context.options.indentPixels) + 'px';\r\n            this.row.element.firstElementChild.style.paddingLeft = this.context.options.twistiePixels + 'px';\r\n        }\r\n        var uri = this.context.dnd.getDragURI(this.context.tree, this.model.getElement());\r\n        if (uri !== this.uri) {\r\n            if (this.unbindDragStart) {\r\n                this.unbindDragStart.dispose();\r\n                this.unbindDragStart = null;\r\n            }\r\n            if (uri) {\r\n                this.uri = uri;\r\n                this.draggable = true;\r\n                this.unbindDragStart = DOM.addDisposableListener(this.element, 'dragstart', function (e) {\r\n                    _this.onDragStart(e);\r\n                });\r\n            }\r\n            else {\r\n                this.uri = null;\r\n            }\r\n        }\r\n        if (!skipUserRender && this.element) {\r\n            var style = window.getComputedStyle(this.element);\r\n            var paddingLeft = parseFloat(style.paddingLeft);\r\n            if (this.context.horizontalScrolling) {\r\n                this.element.style.width = 'fit-content';\r\n            }\r\n            try {\r\n                this.context.renderer.renderElement(this.context.tree, this.model.getElement(), this.templateId, this.row.templateData);\r\n            }\r\n            catch (err) {\r\n                console.error('Tree usage error: exception while rendering element');\r\n                console.error(err);\r\n            }\r\n            if (this.context.horizontalScrolling) {\r\n                this.width = DOM.getContentWidth(this.element) + paddingLeft;\r\n                this.element.style.width = '';\r\n            }\r\n        }\r\n    };\r\n    ViewItem.prototype.insertInDOM = function (container, afterElement) {\r\n        if (!this.row) {\r\n            this.row = this.context.cache.alloc(this.templateId);\r\n            // used in reverse lookup from HTMLElement to Item\r\n            this.element[TreeView.BINDING] = this;\r\n        }\r\n        if (this.element.parentElement) {\r\n            return;\r\n        }\r\n        if (afterElement === null) {\r\n            container.appendChild(this.element);\r\n        }\r\n        else {\r\n            try {\r\n                container.insertBefore(this.element, afterElement);\r\n            }\r\n            catch (e) {\r\n                console.warn('Failed to locate previous tree element');\r\n                container.appendChild(this.element);\r\n            }\r\n        }\r\n        this.render();\r\n    };\r\n    ViewItem.prototype.removeFromDOM = function () {\r\n        if (!this.row) {\r\n            return;\r\n        }\r\n        if (this.unbindDragStart) {\r\n            this.unbindDragStart.dispose();\r\n            this.unbindDragStart = null;\r\n        }\r\n        this.uri = null;\r\n        this.element[TreeView.BINDING] = null;\r\n        this.context.cache.release(this.templateId, this.row);\r\n        this.row = null;\r\n    };\r\n    ViewItem.prototype.dispose = function () {\r\n        this.row = null;\r\n        this.model = null;\r\n    };\r\n    return ViewItem;\r\n}());\r\nexport { ViewItem };\r\nvar RootViewItem = /** @class */ (function (_super) {\r\n    __extends(RootViewItem, _super);\r\n    function RootViewItem(context, model, wrapper) {\r\n        var _this = _super.call(this, context, model) || this;\r\n        _this.row = {\r\n            element: wrapper,\r\n            templateData: null,\r\n            templateId: null\r\n        };\r\n        return _this;\r\n    }\r\n    RootViewItem.prototype.render = function () {\r\n        if (!this.model || !this.element) {\r\n            return;\r\n        }\r\n        var classes = ['monaco-tree-wrapper'];\r\n        classes.push.apply(classes, Object.keys(this._styles));\r\n        if (this.model.hasChildren()) {\r\n            classes.push('has-children');\r\n        }\r\n        this.element.className = classes.join(' ');\r\n    };\r\n    RootViewItem.prototype.insertInDOM = function (container, afterElement) {\r\n        // noop\r\n    };\r\n    RootViewItem.prototype.removeFromDOM = function () {\r\n        // noop\r\n    };\r\n    return RootViewItem;\r\n}(ViewItem));\r\nfunction reactionEquals(one, other) {\r\n    if (!one && !other) {\r\n        return true;\r\n    }\r\n    else if (!one || !other) {\r\n        return false;\r\n    }\r\n    else if (one.accept !== other.accept) {\r\n        return false;\r\n    }\r\n    else if (one.bubble !== other.bubble) {\r\n        return false;\r\n    }\r\n    else if (one.effect !== other.effect) {\r\n        return false;\r\n    }\r\n    else {\r\n        return true;\r\n    }\r\n}\r\nvar TreeView = /** @class */ (function (_super) {\r\n    __extends(TreeView, _super);\r\n    function TreeView(context, container) {\r\n        var _this = _super.call(this) || this;\r\n        _this.lastClickTimeStamp = 0;\r\n        _this.contentWidthUpdateDelayer = new Delayer(50);\r\n        _this.isRefreshing = false;\r\n        _this.refreshingPreviousChildrenIds = {};\r\n        _this.currentDropDisposable = Lifecycle.Disposable.None;\r\n        _this._onDOMFocus = new Emitter();\r\n        _this._onDOMBlur = new Emitter();\r\n        _this._onDidScroll = new Emitter();\r\n        TreeView.counter++;\r\n        _this.instance = TreeView.counter;\r\n        var horizontalScrollMode = typeof context.options.horizontalScrollMode === 'undefined' ? 2 /* Hidden */ : context.options.horizontalScrollMode;\r\n        _this.horizontalScrolling = horizontalScrollMode !== 2 /* Hidden */;\r\n        _this.context = {\r\n            dataSource: context.dataSource,\r\n            renderer: context.renderer,\r\n            controller: context.controller,\r\n            dnd: context.dnd,\r\n            filter: context.filter,\r\n            sorter: context.sorter,\r\n            tree: context.tree,\r\n            accessibilityProvider: context.accessibilityProvider,\r\n            options: context.options,\r\n            cache: new RowCache(context),\r\n            horizontalScrolling: _this.horizontalScrolling\r\n        };\r\n        _this.modelListeners = [];\r\n        _this.viewListeners = [];\r\n        _this.model = null;\r\n        _this.items = {};\r\n        _this.domNode = document.createElement('div');\r\n        _this.domNode.className = \"monaco-tree no-focused-item monaco-tree-instance-\" + _this.instance;\r\n        // to allow direct tabbing into the tree instead of first focusing the tree\r\n        _this.domNode.tabIndex = context.options.preventRootFocus ? -1 : 0;\r\n        _this.styleElement = DOM.createStyleSheet(_this.domNode);\r\n        _this.treeStyler = context.styler;\r\n        if (!_this.treeStyler) {\r\n            _this.treeStyler = new DefaultTreestyler(_this.styleElement, \"monaco-tree-instance-\" + _this.instance);\r\n        }\r\n        // ARIA\r\n        _this.domNode.setAttribute('role', 'tree');\r\n        if (_this.context.options.ariaLabel) {\r\n            _this.domNode.setAttribute('aria-label', _this.context.options.ariaLabel);\r\n        }\r\n        if (_this.context.options.alwaysFocused) {\r\n            DOM.addClass(_this.domNode, 'focused');\r\n        }\r\n        if (!_this.context.options.paddingOnRow) {\r\n            DOM.addClass(_this.domNode, 'no-row-padding');\r\n        }\r\n        _this.wrapper = document.createElement('div');\r\n        _this.wrapper.className = 'monaco-tree-wrapper';\r\n        _this.scrollableElement = new ScrollableElement(_this.wrapper, {\r\n            alwaysConsumeMouseWheel: true,\r\n            horizontal: horizontalScrollMode,\r\n            vertical: (typeof context.options.verticalScrollMode !== 'undefined' ? context.options.verticalScrollMode : 1 /* Auto */),\r\n            useShadows: context.options.useShadows\r\n        });\r\n        _this.scrollableElement.onScroll(function (e) {\r\n            _this.render(e.scrollTop, e.height, e.scrollLeft, e.width, e.scrollWidth);\r\n            _this._onDidScroll.fire();\r\n        });\r\n        if (Browser.isIE) {\r\n            _this.wrapper.style.msTouchAction = 'none';\r\n            _this.wrapper.style.msContentZooming = 'none';\r\n        }\r\n        else {\r\n            Touch.Gesture.addTarget(_this.wrapper);\r\n        }\r\n        _this.rowsContainer = document.createElement('div');\r\n        _this.rowsContainer.className = 'monaco-tree-rows';\r\n        if (context.options.showTwistie) {\r\n            _this.rowsContainer.className += ' show-twisties';\r\n        }\r\n        var focusTracker = DOM.trackFocus(_this.domNode);\r\n        _this.viewListeners.push(focusTracker.onDidFocus(function () { return _this.onFocus(); }));\r\n        _this.viewListeners.push(focusTracker.onDidBlur(function () { return _this.onBlur(); }));\r\n        _this.viewListeners.push(focusTracker);\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'keydown', function (e) { return _this.onKeyDown(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'keyup', function (e) { return _this.onKeyUp(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'mousedown', function (e) { return _this.onMouseDown(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'mouseup', function (e) { return _this.onMouseUp(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'auxclick', function (e) {\r\n            if (e && e.button === 1) {\r\n                _this.onMouseMiddleClick(e);\r\n            }\r\n        }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'click', function (e) { return _this.onClick(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'contextmenu', function (e) { return _this.onContextMenu(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, Touch.EventType.Tap, function (e) { return _this.onTap(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, Touch.EventType.Change, function (e) { return _this.onTouchChange(e); }));\r\n        if (Browser.isIE) {\r\n            _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'MSPointerDown', function (e) { return _this.onMsPointerDown(e); }));\r\n            _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'MSGestureTap', function (e) { return _this.onMsGestureTap(e); }));\r\n            // these events come too fast, we throttle them\r\n            _this.viewListeners.push(DOM.addDisposableThrottledListener(_this.wrapper, 'MSGestureChange', function (e) { return _this.onThrottledMsGestureChange(e); }, function (lastEvent, event) {\r\n                event.stopPropagation();\r\n                event.preventDefault();\r\n                var result = { translationY: event.translationY, translationX: event.translationX };\r\n                if (lastEvent) {\r\n                    result.translationY += lastEvent.translationY;\r\n                    result.translationX += lastEvent.translationX;\r\n                }\r\n                return result;\r\n            }));\r\n        }\r\n        _this.viewListeners.push(DOM.addDisposableListener(window, 'dragover', function (e) { return _this.onDragOver(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'drop', function (e) { return _this.onDrop(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(window, 'dragend', function (e) { return _this.onDragEnd(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(window, 'dragleave', function (e) { return _this.onDragOver(e); }));\r\n        _this.wrapper.appendChild(_this.rowsContainer);\r\n        _this.domNode.appendChild(_this.scrollableElement.getDomNode());\r\n        container.appendChild(_this.domNode);\r\n        _this.lastRenderTop = 0;\r\n        _this.lastRenderHeight = 0;\r\n        _this.didJustPressContextMenuKey = false;\r\n        _this.currentDropTarget = null;\r\n        _this.currentDropTargets = [];\r\n        _this.shouldInvalidateDropReaction = false;\r\n        _this.dragAndDropScrollInterval = null;\r\n        _this.dragAndDropScrollTimeout = null;\r\n        _this.onHiddenScrollTop = null;\r\n        _this.onRowsChanged();\r\n        _this.layout();\r\n        _this.setupMSGesture();\r\n        _this.applyStyles(context.options);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(TreeView.prototype, \"onDOMFocus\", {\r\n        get: function () { return this._onDOMFocus.event; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    TreeView.prototype.applyStyles = function (styles) {\r\n        this.treeStyler.style(styles);\r\n    };\r\n    TreeView.prototype.createViewItem = function (item) {\r\n        return new ViewItem(this.context, item);\r\n    };\r\n    TreeView.prototype.getHTMLElement = function () {\r\n        return this.domNode;\r\n    };\r\n    TreeView.prototype.focus = function () {\r\n        this.domNode.focus();\r\n    };\r\n    TreeView.prototype.isFocused = function () {\r\n        return document.activeElement === this.domNode;\r\n    };\r\n    TreeView.prototype.blur = function () {\r\n        this.domNode.blur();\r\n    };\r\n    TreeView.prototype.setupMSGesture = function () {\r\n        var _this = this;\r\n        if (window.MSGesture) {\r\n            this.msGesture = new MSGesture();\r\n            setTimeout(function () { return _this.msGesture.target = _this.wrapper; }, 100); // TODO@joh, TODO@IETeam\r\n        }\r\n    };\r\n    TreeView.prototype.isTreeVisible = function () {\r\n        return this.onHiddenScrollTop === null;\r\n    };\r\n    TreeView.prototype.layout = function (height, width) {\r\n        if (!this.isTreeVisible()) {\r\n            return;\r\n        }\r\n        this.viewHeight = height || DOM.getContentHeight(this.wrapper); // render\r\n        this.scrollHeight = this.getContentHeight();\r\n        if (this.horizontalScrolling) {\r\n            this.viewWidth = width || DOM.getContentWidth(this.wrapper);\r\n        }\r\n    };\r\n    TreeView.prototype.render = function (scrollTop, viewHeight, scrollLeft, viewWidth, scrollWidth) {\r\n        var i;\r\n        var stop;\r\n        var renderTop = scrollTop;\r\n        var renderBottom = scrollTop + viewHeight;\r\n        var thisRenderBottom = this.lastRenderTop + this.lastRenderHeight;\r\n        // when view scrolls down, start rendering from the renderBottom\r\n        for (i = this.indexAfter(renderBottom) - 1, stop = this.indexAt(Math.max(thisRenderBottom, renderTop)); i >= stop; i--) {\r\n            this.insertItemInDOM(this.itemAtIndex(i));\r\n        }\r\n        // when view scrolls up, start rendering from either this.renderTop or renderBottom\r\n        for (i = Math.min(this.indexAt(this.lastRenderTop), this.indexAfter(renderBottom)) - 1, stop = this.indexAt(renderTop); i >= stop; i--) {\r\n            this.insertItemInDOM(this.itemAtIndex(i));\r\n        }\r\n        // when view scrolls down, start unrendering from renderTop\r\n        for (i = this.indexAt(this.lastRenderTop), stop = Math.min(this.indexAt(renderTop), this.indexAfter(thisRenderBottom)); i < stop; i++) {\r\n            this.removeItemFromDOM(this.itemAtIndex(i));\r\n        }\r\n        // when view scrolls up, start unrendering from either renderBottom this.renderTop\r\n        for (i = Math.max(this.indexAfter(renderBottom), this.indexAt(this.lastRenderTop)), stop = this.indexAfter(thisRenderBottom); i < stop; i++) {\r\n            this.removeItemFromDOM(this.itemAtIndex(i));\r\n        }\r\n        var topItem = this.itemAtIndex(this.indexAt(renderTop));\r\n        if (topItem) {\r\n            this.rowsContainer.style.top = (topItem.top - renderTop) + 'px';\r\n        }\r\n        if (this.horizontalScrolling) {\r\n            this.rowsContainer.style.left = -scrollLeft + 'px';\r\n            this.rowsContainer.style.width = Math.max(scrollWidth, viewWidth) + \"px\";\r\n        }\r\n        this.lastRenderTop = renderTop;\r\n        this.lastRenderHeight = renderBottom - renderTop;\r\n    };\r\n    TreeView.prototype.setModel = function (newModel) {\r\n        this.releaseModel();\r\n        this.model = newModel;\r\n        this.model.onRefresh(this.onRefreshing, this, this.modelListeners);\r\n        this.model.onDidRefresh(this.onRefreshed, this, this.modelListeners);\r\n        this.model.onSetInput(this.onClearingInput, this, this.modelListeners);\r\n        this.model.onDidSetInput(this.onSetInput, this, this.modelListeners);\r\n        this.model.onDidFocus(this.onModelFocusChange, this, this.modelListeners);\r\n        this.model.onRefreshItemChildren(this.onItemChildrenRefreshing, this, this.modelListeners);\r\n        this.model.onDidRefreshItemChildren(this.onItemChildrenRefreshed, this, this.modelListeners);\r\n        this.model.onDidRefreshItem(this.onItemRefresh, this, this.modelListeners);\r\n        this.model.onExpandItem(this.onItemExpanding, this, this.modelListeners);\r\n        this.model.onDidExpandItem(this.onItemExpanded, this, this.modelListeners);\r\n        this.model.onCollapseItem(this.onItemCollapsing, this, this.modelListeners);\r\n        this.model.onDidRevealItem(this.onItemReveal, this, this.modelListeners);\r\n        this.model.onDidAddTraitItem(this.onItemAddTrait, this, this.modelListeners);\r\n        this.model.onDidRemoveTraitItem(this.onItemRemoveTrait, this, this.modelListeners);\r\n    };\r\n    TreeView.prototype.onRefreshing = function () {\r\n        this.isRefreshing = true;\r\n    };\r\n    TreeView.prototype.onRefreshed = function () {\r\n        this.isRefreshing = false;\r\n        this.onRowsChanged();\r\n    };\r\n    TreeView.prototype.onRowsChanged = function (scrollTop) {\r\n        if (scrollTop === void 0) { scrollTop = this.scrollTop; }\r\n        if (this.isRefreshing) {\r\n            return;\r\n        }\r\n        this.scrollTop = scrollTop;\r\n        this.updateScrollWidth();\r\n    };\r\n    TreeView.prototype.updateScrollWidth = function () {\r\n        var _this = this;\r\n        if (!this.horizontalScrolling) {\r\n            return;\r\n        }\r\n        this.contentWidthUpdateDelayer.trigger(function () {\r\n            var keys = Object.keys(_this.items);\r\n            var scrollWidth = 0;\r\n            for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n                var key = keys_1[_i];\r\n                scrollWidth = Math.max(scrollWidth, _this.items[key].width);\r\n            }\r\n            _this.scrollWidth = scrollWidth + 10 /* scrollbar */;\r\n        });\r\n    };\r\n    TreeView.prototype.focusNextPage = function (eventPayload) {\r\n        var _this = this;\r\n        var lastPageIndex = this.indexAt(this.scrollTop + this.viewHeight);\r\n        lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\r\n        var lastPageElement = this.itemAtIndex(lastPageIndex).model.getElement();\r\n        var currentlyFocusedElement = this.model.getFocus();\r\n        if (currentlyFocusedElement !== lastPageElement) {\r\n            this.model.setFocus(lastPageElement, eventPayload);\r\n        }\r\n        else {\r\n            var previousScrollTop = this.scrollTop;\r\n            this.scrollTop += this.viewHeight;\r\n            if (this.scrollTop !== previousScrollTop) {\r\n                // Let the scroll event listener run\r\n                setTimeout(function () {\r\n                    _this.focusNextPage(eventPayload);\r\n                }, 0);\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.focusPreviousPage = function (eventPayload) {\r\n        var _this = this;\r\n        var firstPageIndex;\r\n        if (this.scrollTop === 0) {\r\n            firstPageIndex = this.indexAt(this.scrollTop);\r\n        }\r\n        else {\r\n            firstPageIndex = this.indexAfter(this.scrollTop - 1);\r\n        }\r\n        var firstPageElement = this.itemAtIndex(firstPageIndex).model.getElement();\r\n        var currentlyFocusedElement = this.model.getFocus();\r\n        if (currentlyFocusedElement !== firstPageElement) {\r\n            this.model.setFocus(firstPageElement, eventPayload);\r\n        }\r\n        else {\r\n            var previousScrollTop = this.scrollTop;\r\n            this.scrollTop -= this.viewHeight;\r\n            if (this.scrollTop !== previousScrollTop) {\r\n                // Let the scroll event listener run\r\n                setTimeout(function () {\r\n                    _this.focusPreviousPage(eventPayload);\r\n                }, 0);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(TreeView.prototype, \"viewHeight\", {\r\n        get: function () {\r\n            var scrollDimensions = this.scrollableElement.getScrollDimensions();\r\n            return scrollDimensions.height;\r\n        },\r\n        set: function (height) {\r\n            this.scrollableElement.setScrollDimensions({ height: height });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"scrollHeight\", {\r\n        set: function (scrollHeight) {\r\n            this.scrollableElement.setScrollDimensions({ scrollHeight: scrollHeight });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"viewWidth\", {\r\n        get: function () {\r\n            var scrollDimensions = this.scrollableElement.getScrollDimensions();\r\n            return scrollDimensions.width;\r\n        },\r\n        set: function (viewWidth) {\r\n            this.scrollableElement.setScrollDimensions({ width: viewWidth });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"scrollWidth\", {\r\n        set: function (scrollWidth) {\r\n            this.scrollableElement.setScrollDimensions({ scrollWidth: scrollWidth });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"scrollTop\", {\r\n        get: function () {\r\n            var scrollPosition = this.scrollableElement.getScrollPosition();\r\n            return scrollPosition.scrollTop;\r\n        },\r\n        set: function (scrollTop) {\r\n            this.scrollableElement.setScrollDimensions({\r\n                scrollHeight: this.getContentHeight()\r\n            });\r\n            this.scrollableElement.setScrollPosition({\r\n                scrollTop: scrollTop\r\n            });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // Events\r\n    TreeView.prototype.onClearingInput = function (e) {\r\n        var item = e.item;\r\n        if (item) {\r\n            this.onRemoveItems(new MappedIterator(item.getNavigator(), function (item) { return item && item.id; }));\r\n            this.onRowsChanged();\r\n        }\r\n    };\r\n    TreeView.prototype.onSetInput = function (e) {\r\n        this.context.cache.garbageCollect();\r\n        this.inputItem = new RootViewItem(this.context, e.item, this.wrapper);\r\n    };\r\n    TreeView.prototype.onItemChildrenRefreshing = function (e) {\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem && this.context.options.showLoading) {\r\n            viewItem.loadingTimer = setTimeout(function () {\r\n                viewItem.loadingTimer = 0;\r\n                viewItem.loading = true;\r\n            }, TreeView.LOADING_DECORATION_DELAY);\r\n        }\r\n        if (!e.isNested) {\r\n            var childrenIds = [];\r\n            var navigator = item.getNavigator();\r\n            var childItem;\r\n            while (childItem = navigator.next()) {\r\n                childrenIds.push(childItem.id);\r\n            }\r\n            this.refreshingPreviousChildrenIds[item.id] = childrenIds;\r\n        }\r\n    };\r\n    TreeView.prototype.onItemChildrenRefreshed = function (e) {\r\n        var _this = this;\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            if (viewItem.loadingTimer) {\r\n                clearTimeout(viewItem.loadingTimer);\r\n                viewItem.loadingTimer = 0;\r\n            }\r\n            viewItem.loading = false;\r\n        }\r\n        if (!e.isNested) {\r\n            var previousChildrenIds = this.refreshingPreviousChildrenIds[item.id];\r\n            var afterModelItems = [];\r\n            var navigator = item.getNavigator();\r\n            var childItem;\r\n            while (childItem = navigator.next()) {\r\n                afterModelItems.push(childItem);\r\n            }\r\n            var skipDiff = Math.abs(previousChildrenIds.length - afterModelItems.length) > 1000;\r\n            var diff = void 0;\r\n            var doToInsertItemsAlreadyExist = void 0;\r\n            if (!skipDiff) {\r\n                var lcs = new Diff.LcsDiff({\r\n                    getLength: function () { return previousChildrenIds.length; },\r\n                    getElementAtIndex: function (i) { return previousChildrenIds[i]; }\r\n                }, {\r\n                    getLength: function () { return afterModelItems.length; },\r\n                    getElementAtIndex: function (i) { return afterModelItems[i].id; }\r\n                }, null);\r\n                diff = lcs.ComputeDiff(false);\r\n                // this means that the result of the diff algorithm would result\r\n                // in inserting items that were already registered. this can only\r\n                // happen if the data provider returns bad ids OR if the sorting\r\n                // of the elements has changed\r\n                doToInsertItemsAlreadyExist = diff.some(function (d) {\r\n                    if (d.modifiedLength > 0) {\r\n                        for (var i = d.modifiedStart, len = d.modifiedStart + d.modifiedLength; i < len; i++) {\r\n                            if (_this.items.hasOwnProperty(afterModelItems[i].id)) {\r\n                                return true;\r\n                            }\r\n                        }\r\n                    }\r\n                    return false;\r\n                });\r\n            }\r\n            // 50 is an optimization number, at some point we're better off\r\n            // just replacing everything\r\n            if (!skipDiff && !doToInsertItemsAlreadyExist && diff.length < 50) {\r\n                for (var i = 0, len = diff.length; i < len; i++) {\r\n                    var diffChange = diff[i];\r\n                    if (diffChange.originalLength > 0) {\r\n                        this.onRemoveItems(new ArrayIterator(previousChildrenIds, diffChange.originalStart, diffChange.originalStart + diffChange.originalLength));\r\n                    }\r\n                    if (diffChange.modifiedLength > 0) {\r\n                        var beforeItem = afterModelItems[diffChange.modifiedStart - 1] || item;\r\n                        beforeItem = beforeItem.getDepth() > 0 ? beforeItem : null;\r\n                        this.onInsertItems(new ArrayIterator(afterModelItems, diffChange.modifiedStart, diffChange.modifiedStart + diffChange.modifiedLength), beforeItem ? beforeItem.id : null);\r\n                    }\r\n                }\r\n            }\r\n            else if (skipDiff || diff.length) {\r\n                this.onRemoveItems(new ArrayIterator(previousChildrenIds));\r\n                this.onInsertItems(new ArrayIterator(afterModelItems), item.getDepth() > 0 ? item.id : null);\r\n            }\r\n            if (skipDiff || diff.length) {\r\n                this.onRowsChanged();\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.onItemRefresh = function (item) {\r\n        this.onItemsRefresh([item]);\r\n    };\r\n    TreeView.prototype.onItemsRefresh = function (items) {\r\n        var _this = this;\r\n        this.onRefreshItemSet(items.filter(function (item) { return _this.items.hasOwnProperty(item.id); }));\r\n        this.onRowsChanged();\r\n    };\r\n    TreeView.prototype.onItemExpanding = function (e) {\r\n        var viewItem = this.items[e.item.id];\r\n        if (viewItem) {\r\n            viewItem.expanded = true;\r\n        }\r\n    };\r\n    TreeView.prototype.onItemExpanded = function (e) {\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.expanded = true;\r\n            var height = this.onInsertItems(item.getNavigator(), item.id);\r\n            var scrollTop = this.scrollTop;\r\n            if (viewItem.top + viewItem.height <= this.scrollTop) {\r\n                scrollTop += height;\r\n            }\r\n            this.onRowsChanged(scrollTop);\r\n        }\r\n    };\r\n    TreeView.prototype.onItemCollapsing = function (e) {\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.expanded = false;\r\n            this.onRemoveItems(new MappedIterator(item.getNavigator(), function (item) { return item && item.id; }));\r\n            this.onRowsChanged();\r\n        }\r\n    };\r\n    TreeView.prototype.onItemReveal = function (e) {\r\n        var item = e.item;\r\n        var relativeTop = e.relativeTop;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            if (relativeTop !== null) {\r\n                relativeTop = relativeTop < 0 ? 0 : relativeTop;\r\n                relativeTop = relativeTop > 1 ? 1 : relativeTop;\r\n                // y = mx + b\r\n                var m = viewItem.height - this.viewHeight;\r\n                this.scrollTop = m * relativeTop + viewItem.top;\r\n            }\r\n            else {\r\n                var viewItemBottom = viewItem.top + viewItem.height;\r\n                var wrapperBottom = this.scrollTop + this.viewHeight;\r\n                if (viewItem.top < this.scrollTop) {\r\n                    this.scrollTop = viewItem.top;\r\n                }\r\n                else if (viewItemBottom >= wrapperBottom) {\r\n                    this.scrollTop = viewItemBottom - this.viewHeight;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.onItemAddTrait = function (e) {\r\n        var item = e.item;\r\n        var trait = e.trait;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.addClass(trait);\r\n        }\r\n        if (trait === 'highlighted') {\r\n            DOM.addClass(this.domNode, trait);\r\n            // Ugly Firefox fix: input fields can't be selected if parent nodes are draggable\r\n            if (viewItem) {\r\n                this.highlightedItemWasDraggable = !!viewItem.draggable;\r\n                if (viewItem.draggable) {\r\n                    viewItem.draggable = false;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.onItemRemoveTrait = function (e) {\r\n        var item = e.item;\r\n        var trait = e.trait;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.removeClass(trait);\r\n        }\r\n        if (trait === 'highlighted') {\r\n            DOM.removeClass(this.domNode, trait);\r\n            // Ugly Firefox fix: input fields can't be selected if parent nodes are draggable\r\n            if (this.highlightedItemWasDraggable) {\r\n                viewItem.draggable = true;\r\n            }\r\n            this.highlightedItemWasDraggable = false;\r\n        }\r\n    };\r\n    TreeView.prototype.onModelFocusChange = function () {\r\n        var focus = this.model && this.model.getFocus();\r\n        DOM.toggleClass(this.domNode, 'no-focused-item', !focus);\r\n        // ARIA\r\n        if (focus) {\r\n            this.domNode.setAttribute('aria-activedescendant', strings.safeBtoa(this.context.dataSource.getId(this.context.tree, focus)));\r\n        }\r\n        else {\r\n            this.domNode.removeAttribute('aria-activedescendant');\r\n        }\r\n    };\r\n    // HeightMap \"events\"\r\n    TreeView.prototype.onInsertItem = function (item) {\r\n        var _this = this;\r\n        item.onDragStart = function (e) { _this.onDragStart(item, e); };\r\n        item.needsRender = true;\r\n        this.refreshViewItem(item);\r\n        this.items[item.id] = item;\r\n    };\r\n    TreeView.prototype.onRefreshItem = function (item, needsRender) {\r\n        if (needsRender === void 0) { needsRender = false; }\r\n        item.needsRender = item.needsRender || needsRender;\r\n        this.refreshViewItem(item);\r\n    };\r\n    TreeView.prototype.onRemoveItem = function (item) {\r\n        this.removeItemFromDOM(item);\r\n        item.dispose();\r\n        delete this.items[item.id];\r\n    };\r\n    // ViewItem refresh\r\n    TreeView.prototype.refreshViewItem = function (item) {\r\n        item.render();\r\n        if (this.shouldBeRendered(item)) {\r\n            this.insertItemInDOM(item);\r\n        }\r\n        else {\r\n            this.removeItemFromDOM(item);\r\n        }\r\n    };\r\n    // DOM Events\r\n    TreeView.prototype.onClick = function (e) {\r\n        if (this.lastPointerType && this.lastPointerType !== 'mouse') {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        if (Browser.isIE && Date.now() - this.lastClickTimeStamp < 300) {\r\n            // IE10+ doesn't set the detail property correctly. While IE10 simply\r\n            // counts the number of clicks, IE11 reports always 1. To align with\r\n            // other browser, we set the value to 2 if clicks events come in a 300ms\r\n            // sequence.\r\n            event.detail = 2;\r\n        }\r\n        this.lastClickTimeStamp = Date.now();\r\n        this.context.controller.onClick(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onMouseMiddleClick = function (e) {\r\n        if (!this.context.controller.onMouseMiddleClick) {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onMouseMiddleClick(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onMouseDown = function (e) {\r\n        this.didJustPressContextMenuKey = false;\r\n        if (!this.context.controller.onMouseDown) {\r\n            return;\r\n        }\r\n        if (this.lastPointerType && this.lastPointerType !== 'mouse') {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        if (event.ctrlKey && Platform.isNative && Platform.isMacintosh) {\r\n            return;\r\n        }\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onMouseDown(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onMouseUp = function (e) {\r\n        if (!this.context.controller.onMouseUp) {\r\n            return;\r\n        }\r\n        if (this.lastPointerType && this.lastPointerType !== 'mouse') {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        if (event.ctrlKey && Platform.isNative && Platform.isMacintosh) {\r\n            return;\r\n        }\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onMouseUp(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onTap = function (e) {\r\n        var item = this.getItemAround(e.initialTarget);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onTap(this.context.tree, item.model.getElement(), e);\r\n    };\r\n    TreeView.prototype.onTouchChange = function (event) {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        this.scrollTop -= event.translationY;\r\n    };\r\n    TreeView.prototype.onContextMenu = function (event) {\r\n        var resultEvent;\r\n        var element;\r\n        if (event instanceof KeyboardEvent || this.didJustPressContextMenuKey) {\r\n            this.didJustPressContextMenuKey = false;\r\n            var keyboardEvent = new Keyboard.StandardKeyboardEvent(event);\r\n            element = this.model.getFocus();\r\n            var position;\r\n            if (!element) {\r\n                element = this.model.getInput();\r\n                position = DOM.getDomNodePagePosition(this.inputItem.element);\r\n            }\r\n            else {\r\n                var id = this.context.dataSource.getId(this.context.tree, element);\r\n                var viewItem = this.items[id];\r\n                position = DOM.getDomNodePagePosition(viewItem.element);\r\n            }\r\n            resultEvent = new _.KeyboardContextMenuEvent(position.left + position.width, position.top, keyboardEvent);\r\n        }\r\n        else {\r\n            var mouseEvent = new Mouse.StandardMouseEvent(event);\r\n            var item = this.getItemAround(mouseEvent.target);\r\n            if (!item) {\r\n                return;\r\n            }\r\n            element = item.model.getElement();\r\n            resultEvent = new _.MouseContextMenuEvent(mouseEvent);\r\n        }\r\n        this.context.controller.onContextMenu(this.context.tree, element, resultEvent);\r\n    };\r\n    TreeView.prototype.onKeyDown = function (e) {\r\n        var event = new Keyboard.StandardKeyboardEvent(e);\r\n        this.didJustPressContextMenuKey = event.keyCode === 58 /* ContextMenu */ || (event.shiftKey && event.keyCode === 68 /* F10 */);\r\n        if (event.target && event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n            return; // Ignore event if target is a form input field (avoids browser specific issues)\r\n        }\r\n        if (this.didJustPressContextMenuKey) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        }\r\n        this.context.controller.onKeyDown(this.context.tree, event);\r\n    };\r\n    TreeView.prototype.onKeyUp = function (e) {\r\n        if (this.didJustPressContextMenuKey) {\r\n            this.onContextMenu(e);\r\n        }\r\n        this.didJustPressContextMenuKey = false;\r\n        this.context.controller.onKeyUp(this.context.tree, new Keyboard.StandardKeyboardEvent(e));\r\n    };\r\n    TreeView.prototype.onDragStart = function (item, e) {\r\n        if (this.model.getHighlight()) {\r\n            return;\r\n        }\r\n        var element = item.model.getElement();\r\n        var selection = this.model.getSelection();\r\n        var elements;\r\n        if (selection.indexOf(element) > -1) {\r\n            elements = selection;\r\n        }\r\n        else {\r\n            elements = [element];\r\n        }\r\n        e.dataTransfer.effectAllowed = 'copyMove';\r\n        e.dataTransfer.setData(DataTransfers.RESOURCES, JSON.stringify([item.uri]));\r\n        if (e.dataTransfer.setDragImage) {\r\n            var label = void 0;\r\n            if (this.context.dnd.getDragLabel) {\r\n                label = this.context.dnd.getDragLabel(this.context.tree, elements);\r\n            }\r\n            else {\r\n                label = String(elements.length);\r\n            }\r\n            var dragImage_1 = document.createElement('div');\r\n            dragImage_1.className = 'monaco-tree-drag-image';\r\n            dragImage_1.textContent = label;\r\n            document.body.appendChild(dragImage_1);\r\n            e.dataTransfer.setDragImage(dragImage_1, -10, -10);\r\n            setTimeout(function () { return document.body.removeChild(dragImage_1); }, 0);\r\n        }\r\n        this.currentDragAndDropData = new dnd.ElementsDragAndDropData(elements);\r\n        TreeView.currentExternalDragAndDropData = new dnd.ExternalElementsDragAndDropData(elements);\r\n        this.context.dnd.onDragStart(this.context.tree, this.currentDragAndDropData, new Mouse.DragMouseEvent(e));\r\n    };\r\n    TreeView.prototype.setupDragAndDropScrollInterval = function () {\r\n        var _this = this;\r\n        var viewTop = DOM.getTopLeftOffset(this.wrapper).top;\r\n        if (!this.dragAndDropScrollInterval) {\r\n            this.dragAndDropScrollInterval = window.setInterval(function () {\r\n                if (_this.dragAndDropMouseY === undefined) {\r\n                    return;\r\n                }\r\n                var diff = _this.dragAndDropMouseY - viewTop;\r\n                var scrollDiff = 0;\r\n                var upperLimit = _this.viewHeight - 35;\r\n                if (diff < 35) {\r\n                    scrollDiff = Math.max(-14, 0.2 * (diff - 35));\r\n                }\r\n                else if (diff > upperLimit) {\r\n                    scrollDiff = Math.min(14, 0.2 * (diff - upperLimit));\r\n                }\r\n                _this.scrollTop += scrollDiff;\r\n            }, 10);\r\n            this.cancelDragAndDropScrollTimeout();\r\n            this.dragAndDropScrollTimeout = window.setTimeout(function () {\r\n                _this.cancelDragAndDropScrollInterval();\r\n                _this.dragAndDropScrollTimeout = null;\r\n            }, 1000);\r\n        }\r\n    };\r\n    TreeView.prototype.cancelDragAndDropScrollInterval = function () {\r\n        if (this.dragAndDropScrollInterval) {\r\n            window.clearInterval(this.dragAndDropScrollInterval);\r\n            this.dragAndDropScrollInterval = null;\r\n        }\r\n        this.cancelDragAndDropScrollTimeout();\r\n    };\r\n    TreeView.prototype.cancelDragAndDropScrollTimeout = function () {\r\n        if (this.dragAndDropScrollTimeout) {\r\n            window.clearTimeout(this.dragAndDropScrollTimeout);\r\n            this.dragAndDropScrollTimeout = null;\r\n        }\r\n    };\r\n    TreeView.prototype.onDragOver = function (e) {\r\n        var _this = this;\r\n        var event = new Mouse.DragMouseEvent(e);\r\n        var viewItem = this.getItemAround(event.target);\r\n        if (!viewItem || (event.posx === 0 && event.posy === 0 && event.browserEvent.type === DOM.EventType.DRAG_LEAVE)) {\r\n            // dragging outside of tree\r\n            if (this.currentDropTarget) {\r\n                // clear previously hovered element feedback\r\n                this.currentDropTargets.forEach(function (i) { return i.dropTarget = false; });\r\n                this.currentDropTargets = [];\r\n                this.currentDropDisposable.dispose();\r\n            }\r\n            this.cancelDragAndDropScrollInterval();\r\n            this.currentDropTarget = null;\r\n            this.currentDropElement = null;\r\n            this.dragAndDropMouseY = null;\r\n            return false;\r\n        }\r\n        // dragging inside the tree\r\n        this.setupDragAndDropScrollInterval();\r\n        this.dragAndDropMouseY = event.posy;\r\n        if (!this.currentDragAndDropData) {\r\n            // just started dragging\r\n            if (TreeView.currentExternalDragAndDropData) {\r\n                this.currentDragAndDropData = TreeView.currentExternalDragAndDropData;\r\n            }\r\n            else {\r\n                if (!event.dataTransfer.types) {\r\n                    return false;\r\n                }\r\n                this.currentDragAndDropData = new dnd.DesktopDragAndDropData();\r\n            }\r\n        }\r\n        this.currentDragAndDropData.update(event);\r\n        var element;\r\n        var item = viewItem.model;\r\n        var reaction;\r\n        // check the bubble up behavior\r\n        do {\r\n            element = item ? item.getElement() : this.model.getInput();\r\n            reaction = this.context.dnd.onDragOver(this.context.tree, this.currentDragAndDropData, element, event);\r\n            if (!reaction || reaction.bubble !== 1 /* BUBBLE_UP */) {\r\n                break;\r\n            }\r\n            item = item && item.parent;\r\n        } while (item);\r\n        if (!item) {\r\n            this.currentDropElement = null;\r\n            return false;\r\n        }\r\n        var canDrop = reaction && reaction.accept;\r\n        if (canDrop) {\r\n            this.currentDropElement = item.getElement();\r\n            event.preventDefault();\r\n            event.dataTransfer.dropEffect = reaction.effect === 0 /* COPY */ ? 'copy' : 'move';\r\n        }\r\n        else {\r\n            this.currentDropElement = null;\r\n        }\r\n        // item is the model item where drop() should be called\r\n        // can be null\r\n        var currentDropTarget = item.id === this.inputItem.id ? this.inputItem : this.items[item.id];\r\n        if (this.shouldInvalidateDropReaction || this.currentDropTarget !== currentDropTarget || !reactionEquals(this.currentDropElementReaction, reaction)) {\r\n            this.shouldInvalidateDropReaction = false;\r\n            if (this.currentDropTarget) {\r\n                this.currentDropTargets.forEach(function (i) { return i.dropTarget = false; });\r\n                this.currentDropTargets = [];\r\n                this.currentDropDisposable.dispose();\r\n            }\r\n            this.currentDropTarget = currentDropTarget;\r\n            this.currentDropElementReaction = reaction;\r\n            if (canDrop) {\r\n                // setup hover feedback for drop target\r\n                if (this.currentDropTarget) {\r\n                    this.currentDropTarget.dropTarget = true;\r\n                    this.currentDropTargets.push(this.currentDropTarget);\r\n                }\r\n                if (reaction.bubble === 0 /* BUBBLE_DOWN */) {\r\n                    var nav = item.getNavigator();\r\n                    var child;\r\n                    while (child = nav.next()) {\r\n                        viewItem = this.items[child.id];\r\n                        if (viewItem) {\r\n                            viewItem.dropTarget = true;\r\n                            this.currentDropTargets.push(viewItem);\r\n                        }\r\n                    }\r\n                }\r\n                if (reaction.autoExpand) {\r\n                    var timeoutPromise_1 = timeout(500);\r\n                    this.currentDropDisposable = Lifecycle.toDisposable(function () { return timeoutPromise_1.cancel(); });\r\n                    timeoutPromise_1\r\n                        .then(function () { return _this.context.tree.expand(_this.currentDropElement); })\r\n                        .then(function () { return _this.shouldInvalidateDropReaction = true; });\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    TreeView.prototype.onDrop = function (e) {\r\n        if (this.currentDropElement) {\r\n            var event = new Mouse.DragMouseEvent(e);\r\n            event.preventDefault();\r\n            this.currentDragAndDropData.update(event);\r\n            this.context.dnd.drop(this.context.tree, this.currentDragAndDropData, this.currentDropElement, event);\r\n            this.onDragEnd(e);\r\n        }\r\n        this.cancelDragAndDropScrollInterval();\r\n    };\r\n    TreeView.prototype.onDragEnd = function (e) {\r\n        if (this.currentDropTarget) {\r\n            this.currentDropTargets.forEach(function (i) { return i.dropTarget = false; });\r\n            this.currentDropTargets = [];\r\n        }\r\n        this.currentDropDisposable.dispose();\r\n        this.cancelDragAndDropScrollInterval();\r\n        this.currentDragAndDropData = null;\r\n        TreeView.currentExternalDragAndDropData = null;\r\n        this.currentDropElement = null;\r\n        this.currentDropTarget = null;\r\n        this.dragAndDropMouseY = null;\r\n    };\r\n    TreeView.prototype.onFocus = function () {\r\n        if (!this.context.options.alwaysFocused) {\r\n            DOM.addClass(this.domNode, 'focused');\r\n        }\r\n        this._onDOMFocus.fire();\r\n    };\r\n    TreeView.prototype.onBlur = function () {\r\n        if (!this.context.options.alwaysFocused) {\r\n            DOM.removeClass(this.domNode, 'focused');\r\n        }\r\n        this.domNode.removeAttribute('aria-activedescendant'); // ARIA\r\n        this._onDOMBlur.fire();\r\n    };\r\n    // MS specific DOM Events\r\n    TreeView.prototype.onMsPointerDown = function (event) {\r\n        if (!this.msGesture) {\r\n            return;\r\n        }\r\n        // Circumvent IE11 breaking change in e.pointerType & TypeScript's stale definitions\r\n        var pointerType = event.pointerType;\r\n        if (pointerType === (event.MSPOINTER_TYPE_MOUSE || 'mouse')) {\r\n            this.lastPointerType = 'mouse';\r\n            return;\r\n        }\r\n        else if (pointerType === (event.MSPOINTER_TYPE_TOUCH || 'touch')) {\r\n            this.lastPointerType = 'touch';\r\n        }\r\n        else {\r\n            return;\r\n        }\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        this.msGesture.addPointer(event.pointerId);\r\n    };\r\n    TreeView.prototype.onThrottledMsGestureChange = function (event) {\r\n        this.scrollTop -= event.translationY;\r\n    };\r\n    TreeView.prototype.onMsGestureTap = function (event) {\r\n        event.initialTarget = document.elementFromPoint(event.clientX, event.clientY);\r\n        this.onTap(event);\r\n    };\r\n    // DOM changes\r\n    TreeView.prototype.insertItemInDOM = function (item) {\r\n        var elementAfter = null;\r\n        var itemAfter = this.itemAfter(item);\r\n        if (itemAfter && itemAfter.element) {\r\n            elementAfter = itemAfter.element;\r\n        }\r\n        item.insertInDOM(this.rowsContainer, elementAfter);\r\n    };\r\n    TreeView.prototype.removeItemFromDOM = function (item) {\r\n        if (!item) {\r\n            return;\r\n        }\r\n        item.removeFromDOM();\r\n    };\r\n    // Helpers\r\n    TreeView.prototype.shouldBeRendered = function (item) {\r\n        return item.top < this.lastRenderTop + this.lastRenderHeight && item.top + item.height > this.lastRenderTop;\r\n    };\r\n    TreeView.prototype.getItemAround = function (element) {\r\n        var candidate = this.inputItem;\r\n        do {\r\n            if (element[TreeView.BINDING]) {\r\n                candidate = element[TreeView.BINDING];\r\n            }\r\n            if (element === this.wrapper || element === this.domNode) {\r\n                return candidate;\r\n            }\r\n            if (element === this.scrollableElement.getDomNode() || element === document.body) {\r\n                return null;\r\n            }\r\n        } while (element = element.parentElement);\r\n        return undefined;\r\n    };\r\n    // Cleanup\r\n    TreeView.prototype.releaseModel = function () {\r\n        if (this.model) {\r\n            this.modelListeners = Lifecycle.dispose(this.modelListeners);\r\n            this.model = null;\r\n        }\r\n    };\r\n    TreeView.prototype.dispose = function () {\r\n        var _this = this;\r\n        // TODO@joao: improve\r\n        this.scrollableElement.dispose();\r\n        this.releaseModel();\r\n        this.modelListeners = null;\r\n        this.viewListeners = Lifecycle.dispose(this.viewListeners);\r\n        this._onDOMFocus.dispose();\r\n        this._onDOMBlur.dispose();\r\n        if (this.domNode.parentNode) {\r\n            this.domNode.parentNode.removeChild(this.domNode);\r\n        }\r\n        this.domNode = null;\r\n        if (this.items) {\r\n            Object.keys(this.items).forEach(function (key) { return _this.items[key].removeFromDOM(); });\r\n            this.items = null;\r\n        }\r\n        if (this.context.cache) {\r\n            this.context.cache.dispose();\r\n            this.context.cache = null;\r\n        }\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    TreeView.BINDING = 'monaco-tree-row';\r\n    TreeView.LOADING_DECORATION_DELAY = 800;\r\n    TreeView.counter = 0;\r\n    TreeView.currentExternalDragAndDropData = null;\r\n    return TreeView;\r\n}(HeightMap));\r\nexport { TreeView };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './tree.css';\r\nimport * as TreeDefaults from './treeDefaults.js';\r\nimport * as Model from './treeModel.js';\r\nimport * as View from './treeView.js';\r\nimport { Emitter, Relay } from '../../../common/event.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nvar TreeContext = /** @class */ (function () {\r\n    function TreeContext(tree, configuration, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.tree = tree;\r\n        this.configuration = configuration;\r\n        this.options = options;\r\n        if (!configuration.dataSource) {\r\n            throw new Error('You must provide a Data Source to the tree.');\r\n        }\r\n        this.dataSource = configuration.dataSource;\r\n        this.renderer = configuration.renderer;\r\n        this.controller = configuration.controller || new TreeDefaults.DefaultController({ clickBehavior: 1 /* ON_MOUSE_UP */, keyboardSupport: typeof options.keyboardSupport !== 'boolean' || options.keyboardSupport });\r\n        this.dnd = configuration.dnd || new TreeDefaults.DefaultDragAndDrop();\r\n        this.filter = configuration.filter || new TreeDefaults.DefaultFilter();\r\n        this.sorter = configuration.sorter || null;\r\n        this.accessibilityProvider = configuration.accessibilityProvider || new TreeDefaults.DefaultAccessibilityProvider();\r\n        this.styler = configuration.styler || null;\r\n    }\r\n    return TreeContext;\r\n}());\r\nexport { TreeContext };\r\nvar defaultStyles = {\r\n    listFocusBackground: Color.fromHex('#073655'),\r\n    listActiveSelectionBackground: Color.fromHex('#0E639C'),\r\n    listActiveSelectionForeground: Color.fromHex('#FFFFFF'),\r\n    listFocusAndSelectionBackground: Color.fromHex('#094771'),\r\n    listFocusAndSelectionForeground: Color.fromHex('#FFFFFF'),\r\n    listInactiveSelectionBackground: Color.fromHex('#3F3F46'),\r\n    listHoverBackground: Color.fromHex('#2A2D2E'),\r\n    listDropBackground: Color.fromHex('#383B3D')\r\n};\r\nvar Tree = /** @class */ (function () {\r\n    function Tree(container, configuration, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this._onDidChangeFocus = new Relay();\r\n        this.onDidChangeFocus = this._onDidChangeFocus.event;\r\n        this._onDidChangeSelection = new Relay();\r\n        this.onDidChangeSelection = this._onDidChangeSelection.event;\r\n        this._onHighlightChange = new Relay();\r\n        this._onDidExpandItem = new Relay();\r\n        this._onDidCollapseItem = new Relay();\r\n        this._onDispose = new Emitter();\r\n        this.onDidDispose = this._onDispose.event;\r\n        this.container = container;\r\n        mixin(options, defaultStyles, false);\r\n        options.twistiePixels = typeof options.twistiePixels === 'number' ? options.twistiePixels : 32;\r\n        options.showTwistie = options.showTwistie === false ? false : true;\r\n        options.indentPixels = typeof options.indentPixels === 'number' ? options.indentPixels : 12;\r\n        options.alwaysFocused = options.alwaysFocused === true ? true : false;\r\n        options.useShadows = options.useShadows === false ? false : true;\r\n        options.paddingOnRow = options.paddingOnRow === false ? false : true;\r\n        options.showLoading = options.showLoading === false ? false : true;\r\n        this.context = new TreeContext(this, configuration, options);\r\n        this.model = new Model.TreeModel(this.context);\r\n        this.view = new View.TreeView(this.context, this.container);\r\n        this.view.setModel(this.model);\r\n        this._onDidChangeFocus.input = this.model.onDidFocus;\r\n        this._onDidChangeSelection.input = this.model.onDidSelect;\r\n        this._onHighlightChange.input = this.model.onDidHighlight;\r\n        this._onDidExpandItem.input = this.model.onDidExpandItem;\r\n        this._onDidCollapseItem.input = this.model.onDidCollapseItem;\r\n    }\r\n    Tree.prototype.style = function (styles) {\r\n        this.view.applyStyles(styles);\r\n    };\r\n    Object.defineProperty(Tree.prototype, \"onDidFocus\", {\r\n        get: function () {\r\n            return this.view && this.view.onDOMFocus;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Tree.prototype.getHTMLElement = function () {\r\n        return this.view.getHTMLElement();\r\n    };\r\n    Tree.prototype.layout = function (height, width) {\r\n        this.view.layout(height, width);\r\n    };\r\n    Tree.prototype.domFocus = function () {\r\n        this.view.focus();\r\n    };\r\n    Tree.prototype.isDOMFocused = function () {\r\n        return this.view.isFocused();\r\n    };\r\n    Tree.prototype.domBlur = function () {\r\n        this.view.blur();\r\n    };\r\n    Tree.prototype.setInput = function (element) {\r\n        return this.model.setInput(element);\r\n    };\r\n    Tree.prototype.getInput = function () {\r\n        return this.model.getInput();\r\n    };\r\n    Tree.prototype.refresh = function (element, recursive) {\r\n        if (element === void 0) { element = null; }\r\n        if (recursive === void 0) { recursive = true; }\r\n        return this.model.refresh(element, recursive);\r\n    };\r\n    Tree.prototype.expand = function (element) {\r\n        return this.model.expand(element);\r\n    };\r\n    Tree.prototype.collapse = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        return this.model.collapse(element, recursive);\r\n    };\r\n    Tree.prototype.toggleExpansion = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        return this.model.toggleExpansion(element, recursive);\r\n    };\r\n    Tree.prototype.isExpanded = function (element) {\r\n        return this.model.isExpanded(element);\r\n    };\r\n    Tree.prototype.reveal = function (element, relativeTop) {\r\n        if (relativeTop === void 0) { relativeTop = null; }\r\n        return this.model.reveal(element, relativeTop);\r\n    };\r\n    Tree.prototype.getHighlight = function () {\r\n        return this.model.getHighlight();\r\n    };\r\n    Tree.prototype.clearHighlight = function (eventPayload) {\r\n        this.model.setHighlight(null, eventPayload);\r\n    };\r\n    Tree.prototype.setSelection = function (elements, eventPayload) {\r\n        this.model.setSelection(elements, eventPayload);\r\n    };\r\n    Tree.prototype.getSelection = function () {\r\n        return this.model.getSelection();\r\n    };\r\n    Tree.prototype.clearSelection = function (eventPayload) {\r\n        this.model.setSelection([], eventPayload);\r\n    };\r\n    Tree.prototype.setFocus = function (element, eventPayload) {\r\n        this.model.setFocus(element, eventPayload);\r\n    };\r\n    Tree.prototype.getFocus = function () {\r\n        return this.model.getFocus();\r\n    };\r\n    Tree.prototype.focusNext = function (count, eventPayload) {\r\n        this.model.focusNext(count, eventPayload);\r\n    };\r\n    Tree.prototype.focusPrevious = function (count, eventPayload) {\r\n        this.model.focusPrevious(count, eventPayload);\r\n    };\r\n    Tree.prototype.focusParent = function (eventPayload) {\r\n        this.model.focusParent(eventPayload);\r\n    };\r\n    Tree.prototype.focusFirstChild = function (eventPayload) {\r\n        this.model.focusFirstChild(eventPayload);\r\n    };\r\n    Tree.prototype.focusFirst = function (eventPayload, from) {\r\n        this.model.focusFirst(eventPayload, from);\r\n    };\r\n    Tree.prototype.focusNth = function (index, eventPayload) {\r\n        this.model.focusNth(index, eventPayload);\r\n    };\r\n    Tree.prototype.focusLast = function (eventPayload, from) {\r\n        this.model.focusLast(eventPayload, from);\r\n    };\r\n    Tree.prototype.focusNextPage = function (eventPayload) {\r\n        this.view.focusNextPage(eventPayload);\r\n    };\r\n    Tree.prototype.focusPreviousPage = function (eventPayload) {\r\n        this.view.focusPreviousPage(eventPayload);\r\n    };\r\n    Tree.prototype.clearFocus = function (eventPayload) {\r\n        this.model.setFocus(null, eventPayload);\r\n    };\r\n    Tree.prototype.dispose = function () {\r\n        this._onDispose.fire();\r\n        if (this.model !== null) {\r\n            this.model.dispose();\r\n            this.model = null;\r\n        }\r\n        if (this.view !== null) {\r\n            this.view.dispose();\r\n            this.view = null;\r\n        }\r\n        this._onDidChangeFocus.dispose();\r\n        this._onDidChangeSelection.dispose();\r\n        this._onHighlightChange.dispose();\r\n        this._onDidExpandItem.dispose();\r\n        this._onDidCollapseItem.dispose();\r\n        this._onDispose.dispose();\r\n    };\r\n    return Tree;\r\n}());\r\nexport { Tree };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar _a;\r\nimport { createStyleSheet } from '../../../base/browser/dom.js';\r\nimport { combinedDisposable, dispose, toDisposable } from '../../../base/common/lifecycle.js';\r\nimport { isUndefinedOrNull } from '../../../base/common/types.js';\r\nimport { DefaultController, DefaultTreestyler } from '../../../base/parts/tree/browser/treeDefaults.js';\r\nimport { Tree } from '../../../base/parts/tree/browser/treeImpl.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\r\nimport { Extensions as ConfigurationExtensions } from '../../configuration/common/configurationRegistry.js';\r\nimport { IContextKeyService, RawContextKey } from '../../contextkey/common/contextkey.js';\r\nimport { createDecorator, IInstantiationService } from '../../instantiation/common/instantiation.js';\r\nimport { Registry } from '../../registry/common/platform.js';\r\nimport { attachListStyler, computeStyles, defaultListStyles } from '../../theme/common/styler.js';\r\nimport { IThemeService } from '../../theme/common/themeService.js';\r\nexport var IListService = createDecorator('listService');\r\nvar ListService = /** @class */ (function () {\r\n    function ListService(contextKeyService) {\r\n        this.lists = [];\r\n        this._lastFocusedWidget = undefined;\r\n    }\r\n    Object.defineProperty(ListService.prototype, \"lastFocusedList\", {\r\n        get: function () {\r\n            return this._lastFocusedWidget;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ListService.prototype.register = function (widget, extraContextKeys) {\r\n        var _this = this;\r\n        if (this.lists.some(function (l) { return l.widget === widget; })) {\r\n            throw new Error('Cannot register the same widget multiple times');\r\n        }\r\n        // Keep in our lists list\r\n        var registeredList = { widget: widget, extraContextKeys: extraContextKeys };\r\n        this.lists.push(registeredList);\r\n        // Check for currently being focused\r\n        if (widget.getHTMLElement() === document.activeElement) {\r\n            this._lastFocusedWidget = widget;\r\n        }\r\n        var result = combinedDisposable([\r\n            widget.onDidFocus(function () { return _this._lastFocusedWidget = widget; }),\r\n            toDisposable(function () { return _this.lists.splice(_this.lists.indexOf(registeredList), 1); }),\r\n            widget.onDidDispose(function () {\r\n                _this.lists = _this.lists.filter(function (l) { return l !== registeredList; });\r\n                if (_this._lastFocusedWidget === widget) {\r\n                    _this._lastFocusedWidget = undefined;\r\n                }\r\n            })\r\n        ]);\r\n        return result;\r\n    };\r\n    ListService = __decorate([\r\n        __param(0, IContextKeyService)\r\n    ], ListService);\r\n    return ListService;\r\n}());\r\nexport { ListService };\r\nvar RawWorkbenchListFocusContextKey = new RawContextKey('listFocus', true);\r\nexport var WorkbenchListSupportsMultiSelectContextKey = new RawContextKey('listSupportsMultiselect', true);\r\nexport var WorkbenchListHasSelectionOrFocus = new RawContextKey('listHasSelectionOrFocus', false);\r\nexport var WorkbenchListDoubleSelection = new RawContextKey('listDoubleSelection', false);\r\nexport var WorkbenchListMultiSelection = new RawContextKey('listMultiSelection', false);\r\nfunction createScopedContextKeyService(contextKeyService, widget) {\r\n    var result = contextKeyService.createScoped(widget.getHTMLElement());\r\n    RawWorkbenchListFocusContextKey.bindTo(result);\r\n    return result;\r\n}\r\nexport var multiSelectModifierSettingKey = 'workbench.list.multiSelectModifier';\r\nexport var openModeSettingKey = 'workbench.list.openMode';\r\nexport var horizontalScrollingKey = 'workbench.tree.horizontalScrolling';\r\nfunction useAltAsMultipleSelectionModifier(configurationService) {\r\n    return configurationService.getValue(multiSelectModifierSettingKey) === 'alt';\r\n}\r\nfunction useSingleClickToOpen(configurationService) {\r\n    return configurationService.getValue(openModeSettingKey) !== 'doubleClick';\r\n}\r\nvar sharedTreeStyleSheet;\r\nfunction getSharedTreeStyleSheet() {\r\n    if (!sharedTreeStyleSheet) {\r\n        sharedTreeStyleSheet = createStyleSheet();\r\n    }\r\n    return sharedTreeStyleSheet;\r\n}\r\nfunction handleTreeController(configuration, instantiationService) {\r\n    if (!configuration.controller) {\r\n        configuration.controller = instantiationService.createInstance(WorkbenchTreeController, {});\r\n    }\r\n    if (!configuration.styler) {\r\n        configuration.styler = new DefaultTreestyler(getSharedTreeStyleSheet());\r\n    }\r\n    return configuration;\r\n}\r\nvar WorkbenchTree = /** @class */ (function (_super) {\r\n    __extends(WorkbenchTree, _super);\r\n    function WorkbenchTree(container, configuration, options, contextKeyService, listService, themeService, instantiationService, configurationService) {\r\n        var _this = this;\r\n        var config = handleTreeController(configuration, instantiationService);\r\n        var horizontalScrollMode = configurationService.getValue(horizontalScrollingKey) ? 1 /* Auto */ : 2 /* Hidden */;\r\n        var opts = __assign({ horizontalScrollMode: horizontalScrollMode, keyboardSupport: false }, computeStyles(themeService.getTheme(), defaultListStyles), options);\r\n        _this = _super.call(this, container, config, opts) || this;\r\n        _this.disposables = [];\r\n        _this.contextKeyService = createScopedContextKeyService(contextKeyService, _this);\r\n        WorkbenchListSupportsMultiSelectContextKey.bindTo(_this.contextKeyService);\r\n        _this.listHasSelectionOrFocus = WorkbenchListHasSelectionOrFocus.bindTo(_this.contextKeyService);\r\n        _this.listDoubleSelection = WorkbenchListDoubleSelection.bindTo(_this.contextKeyService);\r\n        _this.listMultiSelection = WorkbenchListMultiSelection.bindTo(_this.contextKeyService);\r\n        _this._openOnSingleClick = useSingleClickToOpen(configurationService);\r\n        _this._useAltAsMultipleSelectionModifier = useAltAsMultipleSelectionModifier(configurationService);\r\n        _this.disposables.push(_this.contextKeyService, listService.register(_this), attachListStyler(_this, themeService));\r\n        _this.disposables.push(_this.onDidChangeSelection(function () {\r\n            var selection = _this.getSelection();\r\n            var focus = _this.getFocus();\r\n            _this.listHasSelectionOrFocus.set((selection && selection.length > 0) || !!focus);\r\n            _this.listDoubleSelection.set(selection && selection.length === 2);\r\n            _this.listMultiSelection.set(selection && selection.length > 1);\r\n        }));\r\n        _this.disposables.push(_this.onDidChangeFocus(function () {\r\n            var selection = _this.getSelection();\r\n            var focus = _this.getFocus();\r\n            _this.listHasSelectionOrFocus.set((selection && selection.length > 0) || !!focus);\r\n        }));\r\n        _this.disposables.push(configurationService.onDidChangeConfiguration(function (e) {\r\n            if (e.affectsConfiguration(openModeSettingKey)) {\r\n                _this._openOnSingleClick = useSingleClickToOpen(configurationService);\r\n            }\r\n            if (e.affectsConfiguration(multiSelectModifierSettingKey)) {\r\n                _this._useAltAsMultipleSelectionModifier = useAltAsMultipleSelectionModifier(configurationService);\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    WorkbenchTree.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this.disposables = dispose(this.disposables);\r\n    };\r\n    WorkbenchTree = __decorate([\r\n        __param(3, IContextKeyService),\r\n        __param(4, IListService),\r\n        __param(5, IThemeService),\r\n        __param(6, IInstantiationService),\r\n        __param(7, IConfigurationService)\r\n    ], WorkbenchTree);\r\n    return WorkbenchTree;\r\n}(Tree));\r\nexport { WorkbenchTree };\r\nfunction massageControllerOptions(options) {\r\n    if (typeof options.keyboardSupport !== 'boolean') {\r\n        options.keyboardSupport = false;\r\n    }\r\n    if (typeof options.clickBehavior !== 'number') {\r\n        options.clickBehavior = 0 /* ON_MOUSE_DOWN */;\r\n    }\r\n    return options;\r\n}\r\nvar WorkbenchTreeController = /** @class */ (function (_super) {\r\n    __extends(WorkbenchTreeController, _super);\r\n    function WorkbenchTreeController(options, configurationService) {\r\n        var _this = _super.call(this, massageControllerOptions(options)) || this;\r\n        _this.configurationService = configurationService;\r\n        _this.disposables = [];\r\n        // if the open mode is not set, we configure it based on settings\r\n        if (isUndefinedOrNull(options.openMode)) {\r\n            _this.setOpenMode(_this.getOpenModeSetting());\r\n            _this.registerListeners();\r\n        }\r\n        return _this;\r\n    }\r\n    WorkbenchTreeController.prototype.registerListeners = function () {\r\n        var _this = this;\r\n        this.disposables.push(this.configurationService.onDidChangeConfiguration(function (e) {\r\n            if (e.affectsConfiguration(openModeSettingKey)) {\r\n                _this.setOpenMode(_this.getOpenModeSetting());\r\n            }\r\n        }));\r\n    };\r\n    WorkbenchTreeController.prototype.getOpenModeSetting = function () {\r\n        return useSingleClickToOpen(this.configurationService) ? 0 /* SINGLE_CLICK */ : 1 /* DOUBLE_CLICK */;\r\n    };\r\n    WorkbenchTreeController.prototype.dispose = function () {\r\n        this.disposables = dispose(this.disposables);\r\n    };\r\n    WorkbenchTreeController = __decorate([\r\n        __param(1, IConfigurationService)\r\n    ], WorkbenchTreeController);\r\n    return WorkbenchTreeController;\r\n}(DefaultController));\r\nexport { WorkbenchTreeController };\r\nvar configurationRegistry = Registry.as(ConfigurationExtensions.Configuration);\r\nconfigurationRegistry.registerConfiguration({\r\n    'id': 'workbench',\r\n    'order': 7,\r\n    'title': localize('workbenchConfigurationTitle', \"Workbench\"),\r\n    'type': 'object',\r\n    'properties': (_a = {},\r\n        _a[multiSelectModifierSettingKey] = {\r\n            'type': 'string',\r\n            'enum': ['ctrlCmd', 'alt'],\r\n            'enumDescriptions': [\r\n                localize('multiSelectModifier.ctrlCmd', \"Maps to `Control` on Windows and Linux and to `Command` on macOS.\"),\r\n                localize('multiSelectModifier.alt', \"Maps to `Alt` on Windows and Linux and to `Option` on macOS.\")\r\n            ],\r\n            'default': 'ctrlCmd',\r\n            'description': localize({\r\n                key: 'multiSelectModifier',\r\n                comment: [\r\n                    '- `ctrlCmd` refers to a value the setting can take and should not be localized.',\r\n                    '- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized.'\r\n                ]\r\n            }, \"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.\")\r\n        },\r\n        _a[openModeSettingKey] = {\r\n            'type': 'string',\r\n            'enum': ['singleClick', 'doubleClick'],\r\n            'default': 'singleClick',\r\n            'description': localize({\r\n                key: 'openModeModifier',\r\n                comment: ['`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized.']\r\n            }, \"Controls how to open items in trees and lists using the mouse (if supported). For parents with children in trees, this setting will control if a single click expands the parent or a double click. Note that some trees and lists might choose to ignore this setting if it is not applicable. \")\r\n        },\r\n        _a[horizontalScrollingKey] = {\r\n            'type': 'boolean',\r\n            'default': false,\r\n            'description': localize('horizontalScrolling setting', \"Controls whether trees support horizontal scrolling in the workbench.\")\r\n        },\r\n        _a)\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isFalsyOrEmpty } from '../../../base/common/arrays.js';\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport { isEmptyObject } from '../../../base/common/types.js';\r\nimport { Emitter, debounceEvent } from '../../../base/common/event.js';\r\nimport { MarkerSeverity } from './markers.js';\r\nvar MapMap;\r\n(function (MapMap) {\r\n    function get(map, key1, key2) {\r\n        if (map[key1]) {\r\n            return map[key1][key2];\r\n        }\r\n        return undefined;\r\n    }\r\n    MapMap.get = get;\r\n    function set(map, key1, key2, value) {\r\n        if (!map[key1]) {\r\n            map[key1] = Object.create(null);\r\n        }\r\n        map[key1][key2] = value;\r\n    }\r\n    MapMap.set = set;\r\n    function remove(map, key1, key2) {\r\n        if (map[key1] && map[key1][key2]) {\r\n            delete map[key1][key2];\r\n            if (isEmptyObject(map[key1])) {\r\n                delete map[key1];\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    MapMap.remove = remove;\r\n})(MapMap || (MapMap = {}));\r\nvar MarkerStats = /** @class */ (function () {\r\n    function MarkerStats(service) {\r\n        this.errors = 0;\r\n        this.infos = 0;\r\n        this.warnings = 0;\r\n        this.unknowns = 0;\r\n        this._data = Object.create(null);\r\n        this._service = service;\r\n        this._subscription = service.onMarkerChanged(this._update, this);\r\n    }\r\n    MarkerStats.prototype.dispose = function () {\r\n        this._subscription.dispose();\r\n        this._data = undefined;\r\n    };\r\n    MarkerStats.prototype._update = function (resources) {\r\n        if (!this._data) {\r\n            return;\r\n        }\r\n        for (var _i = 0, resources_1 = resources; _i < resources_1.length; _i++) {\r\n            var resource = resources_1[_i];\r\n            var key = resource.toString();\r\n            var oldStats = this._data[key];\r\n            if (oldStats) {\r\n                this._substract(oldStats);\r\n            }\r\n            var newStats = this._resourceStats(resource);\r\n            this._add(newStats);\r\n            this._data[key] = newStats;\r\n        }\r\n    };\r\n    MarkerStats.prototype._resourceStats = function (resource) {\r\n        var result = { errors: 0, warnings: 0, infos: 0, unknowns: 0 };\r\n        // TODO this is a hack\r\n        if (resource.scheme === Schemas.inMemory || resource.scheme === Schemas.walkThrough || resource.scheme === Schemas.walkThroughSnippet) {\r\n            return result;\r\n        }\r\n        for (var _i = 0, _a = this._service.read({ resource: resource }); _i < _a.length; _i++) {\r\n            var severity = _a[_i].severity;\r\n            if (severity === MarkerSeverity.Error) {\r\n                result.errors += 1;\r\n            }\r\n            else if (severity === MarkerSeverity.Warning) {\r\n                result.warnings += 1;\r\n            }\r\n            else if (severity === MarkerSeverity.Info) {\r\n                result.infos += 1;\r\n            }\r\n            else {\r\n                result.unknowns += 1;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    MarkerStats.prototype._substract = function (op) {\r\n        this.errors -= op.errors;\r\n        this.warnings -= op.warnings;\r\n        this.infos -= op.infos;\r\n        this.unknowns -= op.unknowns;\r\n    };\r\n    MarkerStats.prototype._add = function (op) {\r\n        this.errors += op.errors;\r\n        this.warnings += op.warnings;\r\n        this.infos += op.infos;\r\n        this.unknowns += op.unknowns;\r\n    };\r\n    return MarkerStats;\r\n}());\r\nvar MarkerService = /** @class */ (function () {\r\n    function MarkerService() {\r\n        this._onMarkerChanged = new Emitter();\r\n        this._onMarkerChangedEvent = debounceEvent(this._onMarkerChanged.event, MarkerService._debouncer, 0);\r\n        this._byResource = Object.create(null);\r\n        this._byOwner = Object.create(null);\r\n        this._stats = new MarkerStats(this);\r\n    }\r\n    MarkerService.prototype.dispose = function () {\r\n        this._stats.dispose();\r\n    };\r\n    Object.defineProperty(MarkerService.prototype, \"onMarkerChanged\", {\r\n        get: function () {\r\n            return this._onMarkerChangedEvent;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerService.prototype.remove = function (owner, resources) {\r\n        if (!isFalsyOrEmpty(resources)) {\r\n            for (var _i = 0, resources_2 = resources; _i < resources_2.length; _i++) {\r\n                var resource = resources_2[_i];\r\n                this.changeOne(owner, resource, []);\r\n            }\r\n        }\r\n    };\r\n    MarkerService.prototype.changeOne = function (owner, resource, markerData) {\r\n        if (isFalsyOrEmpty(markerData)) {\r\n            // remove marker for this (owner,resource)-tuple\r\n            var a = MapMap.remove(this._byResource, resource.toString(), owner);\r\n            var b = MapMap.remove(this._byOwner, owner, resource.toString());\r\n            if (a !== b) {\r\n                throw new Error('invalid marker service state');\r\n            }\r\n            if (a && b) {\r\n                this._onMarkerChanged.fire([resource]);\r\n            }\r\n        }\r\n        else {\r\n            // insert marker for this (owner,resource)-tuple\r\n            var markers = [];\r\n            for (var _i = 0, markerData_1 = markerData; _i < markerData_1.length; _i++) {\r\n                var data = markerData_1[_i];\r\n                var marker = MarkerService._toMarker(owner, resource, data);\r\n                if (marker) {\r\n                    markers.push(marker);\r\n                }\r\n            }\r\n            MapMap.set(this._byResource, resource.toString(), owner, markers);\r\n            MapMap.set(this._byOwner, owner, resource.toString(), markers);\r\n            this._onMarkerChanged.fire([resource]);\r\n        }\r\n    };\r\n    MarkerService._toMarker = function (owner, resource, data) {\r\n        var code = data.code, severity = data.severity, message = data.message, source = data.source, startLineNumber = data.startLineNumber, startColumn = data.startColumn, endLineNumber = data.endLineNumber, endColumn = data.endColumn, relatedInformation = data.relatedInformation, tags = data.tags;\r\n        if (!message) {\r\n            return undefined;\r\n        }\r\n        // santize data\r\n        startLineNumber = startLineNumber > 0 ? startLineNumber : 1;\r\n        startColumn = startColumn > 0 ? startColumn : 1;\r\n        endLineNumber = endLineNumber >= startLineNumber ? endLineNumber : startLineNumber;\r\n        endColumn = endColumn > 0 ? endColumn : startColumn;\r\n        return {\r\n            resource: resource,\r\n            owner: owner,\r\n            code: code || undefined,\r\n            severity: severity,\r\n            message: message,\r\n            source: source,\r\n            startLineNumber: startLineNumber,\r\n            startColumn: startColumn,\r\n            endLineNumber: endLineNumber,\r\n            endColumn: endColumn,\r\n            relatedInformation: relatedInformation,\r\n            tags: tags,\r\n        };\r\n    };\r\n    MarkerService.prototype.read = function (filter) {\r\n        if (filter === void 0) { filter = Object.create(null); }\r\n        var owner = filter.owner, resource = filter.resource, severities = filter.severities, take = filter.take;\r\n        if (!take || take < 0) {\r\n            take = -1;\r\n        }\r\n        if (owner && resource) {\r\n            // exactly one owner AND resource\r\n            var data = MapMap.get(this._byResource, resource.toString(), owner);\r\n            if (!data) {\r\n                return [];\r\n            }\r\n            else {\r\n                var result = [];\r\n                for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\r\n                    var marker = data_1[_i];\r\n                    if (MarkerService._accept(marker, severities)) {\r\n                        var newLen = result.push(marker);\r\n                        if (take > 0 && newLen === take) {\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                return result;\r\n            }\r\n        }\r\n        else if (!owner && !resource) {\r\n            // all\r\n            var result = [];\r\n            for (var key1 in this._byResource) {\r\n                for (var key2 in this._byResource[key1]) {\r\n                    for (var _a = 0, _b = this._byResource[key1][key2]; _a < _b.length; _a++) {\r\n                        var data = _b[_a];\r\n                        if (MarkerService._accept(data, severities)) {\r\n                            var newLen = result.push(data);\r\n                            if (take > 0 && newLen === take) {\r\n                                return result;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        else {\r\n            // of one resource OR owner\r\n            var map = owner\r\n                ? this._byOwner[owner]\r\n                : resource ? this._byResource[resource.toString()] : undefined;\r\n            if (!map) {\r\n                return [];\r\n            }\r\n            var result = [];\r\n            for (var key in map) {\r\n                for (var _c = 0, _d = map[key]; _c < _d.length; _c++) {\r\n                    var data = _d[_c];\r\n                    if (MarkerService._accept(data, severities)) {\r\n                        var newLen = result.push(data);\r\n                        if (take > 0 && newLen === take) {\r\n                            return result;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n    };\r\n    MarkerService._accept = function (marker, severities) {\r\n        return severities === void 0 || (severities & marker.severity) === marker.severity;\r\n    };\r\n    MarkerService._debouncer = function (last, event) {\r\n        if (!last) {\r\n            MarkerService._dedupeMap = Object.create(null);\r\n            last = [];\r\n        }\r\n        for (var _i = 0, event_1 = event; _i < event_1.length; _i++) {\r\n            var uri = event_1[_i];\r\n            if (MarkerService._dedupeMap[uri.toString()] === void 0) {\r\n                MarkerService._dedupeMap[uri.toString()] = true;\r\n                last.push(uri);\r\n            }\r\n        }\r\n        return last;\r\n    };\r\n    return MarkerService;\r\n}());\r\nexport { MarkerService };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nexport var IProgressService = createDecorator('progressService');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nimport { Event } from '../../../base/common/event.js';\r\nexport var IStorageService = createDecorator('storageService');\r\nexport var NullStorageService = new /** @class */ (function () {\r\n    function class_1() {\r\n        this._serviceBrand = undefined;\r\n        this.onDidChangeStorage = Event.None;\r\n        this.onWillSaveState = Event.None;\r\n    }\r\n    class_1.prototype.get = function (key, scope, fallbackValue) {\r\n        return fallbackValue;\r\n    };\r\n    class_1.prototype.getBoolean = function (key, scope, fallbackValue) {\r\n        return fallbackValue;\r\n    };\r\n    class_1.prototype.getInteger = function (key, scope, fallbackValue) {\r\n        return fallbackValue;\r\n    };\r\n    class_1.prototype.store = function (key, value, scope) {\r\n        return Promise.resolve();\r\n    };\r\n    class_1.prototype.remove = function (key, scope) {\r\n        return Promise.resolve();\r\n    };\r\n    return class_1;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { IBulkEditService } from '../../browser/services/bulkEditService.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { EditorWorkerServiceImpl } from '../../common/services/editorWorkerServiceImpl.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { ModeServiceImpl } from '../../common/services/modeServiceImpl.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { ModelServiceImpl } from '../../common/services/modelServiceImpl.js';\r\nimport { ITextResourceConfigurationService, ITextResourcePropertiesService } from '../../common/services/resourceConfiguration.js';\r\nimport { SimpleBulkEditService, SimpleConfigurationService, SimpleDialogService, SimpleMenuService, SimpleNotificationService, SimpleProgressService, SimpleResourceConfigurationService, SimpleResourcePropertiesService, SimpleUriLabelService, SimpleWorkspaceContextService, StandaloneCommandService, StandaloneKeybindingService, StandaloneTelemetryService } from './simpleServices.js';\r\nimport { StandaloneCodeEditorServiceImpl } from './standaloneCodeServiceImpl.js';\r\nimport { StandaloneThemeServiceImpl } from './standaloneThemeServiceImpl.js';\r\nimport { IStandaloneThemeService } from '../common/standaloneThemeService.js';\r\nimport { IMenuService } from '../../../platform/actions/common/actions.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nimport { ContextKeyService } from '../../../platform/contextkey/browser/contextKeyService.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { ContextMenuService } from '../../../platform/contextview/browser/contextMenuService.js';\r\nimport { IContextMenuService, IContextViewService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { ContextViewService } from '../../../platform/contextview/browser/contextViewService.js';\r\nimport { IDialogService } from '../../../platform/dialogs/common/dialogs.js';\r\nimport { IInstantiationService, createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { InstantiationService } from '../../../platform/instantiation/common/instantiationService.js';\r\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { ILabelService } from '../../../platform/label/common/label.js';\r\nimport { IListService, ListService } from '../../../platform/list/browser/listService.js';\r\nimport { ILogService, NullLogService } from '../../../platform/log/common/log.js';\r\nimport { MarkerService } from '../../../platform/markers/common/markerService.js';\r\nimport { IMarkerService } from '../../../platform/markers/common/markers.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { IStorageService, NullStorageService } from '../../../platform/storage/common/storage.js';\r\nimport { ITelemetryService } from '../../../platform/telemetry/common/telemetry.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { IWorkspaceContextService } from '../../../platform/workspace/common/workspace.js';\r\nexport var StaticServices;\r\n(function (StaticServices) {\r\n    var _serviceCollection = new ServiceCollection();\r\n    var LazyStaticService = /** @class */ (function () {\r\n        function LazyStaticService(serviceId, factory) {\r\n            this._serviceId = serviceId;\r\n            this._factory = factory;\r\n            this._value = null;\r\n        }\r\n        Object.defineProperty(LazyStaticService.prototype, \"id\", {\r\n            get: function () { return this._serviceId; },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        LazyStaticService.prototype.get = function (overrides) {\r\n            if (!this._value) {\r\n                if (overrides) {\r\n                    this._value = overrides[this._serviceId.toString()];\r\n                }\r\n                if (!this._value) {\r\n                    this._value = this._factory(overrides);\r\n                }\r\n                if (!this._value) {\r\n                    throw new Error('Service ' + this._serviceId + ' is missing!');\r\n                }\r\n                _serviceCollection.set(this._serviceId, this._value);\r\n            }\r\n            return this._value;\r\n        };\r\n        return LazyStaticService;\r\n    }());\r\n    StaticServices.LazyStaticService = LazyStaticService;\r\n    var _all = [];\r\n    function define(serviceId, factory) {\r\n        var r = new LazyStaticService(serviceId, factory);\r\n        _all.push(r);\r\n        return r;\r\n    }\r\n    function init(overrides) {\r\n        // Create a fresh service collection\r\n        var result = new ServiceCollection();\r\n        // Initialize the service collection with the overrides\r\n        for (var serviceId in overrides) {\r\n            if (overrides.hasOwnProperty(serviceId)) {\r\n                result.set(createDecorator(serviceId), overrides[serviceId]);\r\n            }\r\n        }\r\n        // Make sure the same static services are present in all service collections\r\n        _all.forEach(function (service) { return result.set(service.id, service.get(overrides)); });\r\n        // Ensure the collection gets the correct instantiation service\r\n        var instantiationService = new InstantiationService(result, true);\r\n        result.set(IInstantiationService, instantiationService);\r\n        return [result, instantiationService];\r\n    }\r\n    StaticServices.init = init;\r\n    StaticServices.instantiationService = define(IInstantiationService, function () { return new InstantiationService(_serviceCollection, true); });\r\n    var configurationServiceImpl = new SimpleConfigurationService();\r\n    StaticServices.configurationService = define(IConfigurationService, function () { return configurationServiceImpl; });\r\n    StaticServices.resourceConfigurationService = define(ITextResourceConfigurationService, function () { return new SimpleResourceConfigurationService(configurationServiceImpl); });\r\n    StaticServices.resourcePropertiesService = define(ITextResourcePropertiesService, function () { return new SimpleResourcePropertiesService(configurationServiceImpl); });\r\n    StaticServices.contextService = define(IWorkspaceContextService, function () { return new SimpleWorkspaceContextService(); });\r\n    StaticServices.labelService = define(ILabelService, function () { return new SimpleUriLabelService(); });\r\n    StaticServices.telemetryService = define(ITelemetryService, function () { return new StandaloneTelemetryService(); });\r\n    StaticServices.dialogService = define(IDialogService, function () { return new SimpleDialogService(); });\r\n    StaticServices.notificationService = define(INotificationService, function () { return new SimpleNotificationService(); });\r\n    StaticServices.markerService = define(IMarkerService, function () { return new MarkerService(); });\r\n    StaticServices.modeService = define(IModeService, function (o) { return new ModeServiceImpl(); });\r\n    StaticServices.modelService = define(IModelService, function (o) { return new ModelServiceImpl(StaticServices.markerService.get(o), StaticServices.configurationService.get(o), StaticServices.resourcePropertiesService.get(o)); });\r\n    StaticServices.editorWorkerService = define(IEditorWorkerService, function (o) { return new EditorWorkerServiceImpl(StaticServices.modelService.get(o), StaticServices.resourceConfigurationService.get(o)); });\r\n    StaticServices.standaloneThemeService = define(IStandaloneThemeService, function () { return new StandaloneThemeServiceImpl(); });\r\n    StaticServices.codeEditorService = define(ICodeEditorService, function (o) { return new StandaloneCodeEditorServiceImpl(StaticServices.standaloneThemeService.get(o)); });\r\n    StaticServices.progressService = define(IProgressService, function () { return new SimpleProgressService(); });\r\n    StaticServices.storageService = define(IStorageService, function () { return NullStorageService; });\r\n    StaticServices.logService = define(ILogService, function () { return new NullLogService(); });\r\n})(StaticServices || (StaticServices = {}));\r\nvar DynamicStandaloneServices = /** @class */ (function (_super) {\r\n    __extends(DynamicStandaloneServices, _super);\r\n    function DynamicStandaloneServices(domElement, overrides) {\r\n        var _this = _super.call(this) || this;\r\n        var _a = StaticServices.init(overrides), _serviceCollection = _a[0], _instantiationService = _a[1];\r\n        _this._serviceCollection = _serviceCollection;\r\n        _this._instantiationService = _instantiationService;\r\n        var configurationService = _this.get(IConfigurationService);\r\n        var notificationService = _this.get(INotificationService);\r\n        var telemetryService = _this.get(ITelemetryService);\r\n        var themeService = _this.get(IThemeService);\r\n        var ensure = function (serviceId, factory) {\r\n            var value = null;\r\n            if (overrides) {\r\n                value = overrides[serviceId.toString()];\r\n            }\r\n            if (!value) {\r\n                value = factory();\r\n            }\r\n            _this._serviceCollection.set(serviceId, value);\r\n            return value;\r\n        };\r\n        var contextKeyService = ensure(IContextKeyService, function () { return _this._register(new ContextKeyService(configurationService)); });\r\n        ensure(IListService, function () { return new ListService(contextKeyService); });\r\n        var commandService = ensure(ICommandService, function () { return new StandaloneCommandService(_this._instantiationService); });\r\n        var keybindingService = ensure(IKeybindingService, function () { return _this._register(new StandaloneKeybindingService(contextKeyService, commandService, telemetryService, notificationService, domElement)); });\r\n        var contextViewService = ensure(IContextViewService, function () { return _this._register(new ContextViewService(domElement, telemetryService, new NullLogService())); });\r\n        ensure(IContextMenuService, function () { return _this._register(new ContextMenuService(domElement, telemetryService, notificationService, contextViewService, keybindingService, themeService)); });\r\n        ensure(IMenuService, function () { return new SimpleMenuService(commandService); });\r\n        ensure(IBulkEditService, function () { return new SimpleBulkEditService(StaticServices.modelService.get(IModelService)); });\r\n        return _this;\r\n    }\r\n    DynamicStandaloneServices.prototype.get = function (serviceId) {\r\n        var r = this._serviceCollection.get(serviceId);\r\n        if (!r) {\r\n            throw new Error('Missing service ' + serviceId);\r\n        }\r\n        return r;\r\n    };\r\n    DynamicStandaloneServices.prototype.set = function (serviceId, instance) {\r\n        this._serviceCollection.set(serviceId, instance);\r\n    };\r\n    DynamicStandaloneServices.prototype.has = function (serviceId) {\r\n        return this._serviceCollection.has(serviceId);\r\n    };\r\n    return DynamicStandaloneServices;\r\n}(Disposable));\r\nexport { DynamicStandaloneServices };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\r\nexport var IOpenerService = createDecorator('openerService');\r\nexport var NullOpenerService = Object.freeze({\r\n    _serviceBrand: undefined,\r\n    open: function () { return Promise.resolve(undefined); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './standalone-tokens.css';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { OpenerService } from '../../browser/services/openerService.js';\r\nimport { DiffNavigator } from '../../browser/widget/diffNavigator.js';\r\nimport * as editorOptions from '../../common/config/editorOptions.js';\r\nimport { BareFontInfo, FontInfo } from '../../common/config/fontInfo.js';\r\nimport * as editorCommon from '../../common/editorCommon.js';\r\nimport { FindMatch, TextModelResolvedOptions } from '../../common/model.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { NULL_STATE, nullTokenize } from '../../common/modes/nullMode.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { ITextModelService } from '../../common/services/resolverService.js';\r\nimport { createWebWorker as actualCreateWebWorker } from '../../common/services/webWorker.js';\r\nimport * as standaloneEnums from '../../common/standalone/standaloneEnums.js';\r\nimport { Colorizer } from './colorizer.js';\r\nimport { SimpleEditorModelResolverService } from './simpleServices.js';\r\nimport { StandaloneDiffEditor, StandaloneEditor } from './standaloneCodeEditor.js';\r\nimport { DynamicStandaloneServices, StaticServices } from './standaloneServices.js';\r\nimport { IStandaloneThemeService } from '../common/standaloneThemeService.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IContextViewService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nfunction withAllStandaloneServices(domElement, override, callback) {\r\n    var services = new DynamicStandaloneServices(domElement, override);\r\n    var simpleEditorModelResolverService = null;\r\n    if (!services.has(ITextModelService)) {\r\n        simpleEditorModelResolverService = new SimpleEditorModelResolverService();\r\n        services.set(ITextModelService, simpleEditorModelResolverService);\r\n    }\r\n    if (!services.has(IOpenerService)) {\r\n        services.set(IOpenerService, new OpenerService(services.get(ICodeEditorService), services.get(ICommandService)));\r\n    }\r\n    var result = callback(services);\r\n    if (simpleEditorModelResolverService) {\r\n        simpleEditorModelResolverService.setEditor(result);\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Create a new editor under `domElement`.\r\n * `domElement` should be empty (not contain other dom nodes).\r\n * The editor will read the size of `domElement`.\r\n */\r\nexport function create(domElement, options, override) {\r\n    return withAllStandaloneServices(domElement, override || {}, function (services) {\r\n        return new StandaloneEditor(domElement, options, services, services.get(IInstantiationService), services.get(ICodeEditorService), services.get(ICommandService), services.get(IContextKeyService), services.get(IKeybindingService), services.get(IContextViewService), services.get(IStandaloneThemeService), services.get(INotificationService), services.get(IConfigurationService));\r\n    });\r\n}\r\n/**\r\n * Emitted when an editor is created.\r\n * Creating a diff editor might cause this listener to be invoked with the two editors.\r\n * @event\r\n */\r\nexport function onDidCreateEditor(listener) {\r\n    return StaticServices.codeEditorService.get().onCodeEditorAdd(function (editor) {\r\n        listener(editor);\r\n    });\r\n}\r\n/**\r\n * Create a new diff editor under `domElement`.\r\n * `domElement` should be empty (not contain other dom nodes).\r\n * The editor will read the size of `domElement`.\r\n */\r\nexport function createDiffEditor(domElement, options, override) {\r\n    return withAllStandaloneServices(domElement, override, function (services) {\r\n        return new StandaloneDiffEditor(domElement, options, services, services.get(IInstantiationService), services.get(IContextKeyService), services.get(IKeybindingService), services.get(IContextViewService), services.get(IEditorWorkerService), services.get(ICodeEditorService), services.get(IStandaloneThemeService), services.get(INotificationService), services.get(IConfigurationService));\r\n    });\r\n}\r\nexport function createDiffNavigator(diffEditor, opts) {\r\n    return new DiffNavigator(diffEditor, opts);\r\n}\r\nfunction doCreateModel(value, languageSelection, uri) {\r\n    return StaticServices.modelService.get().createModel(value, languageSelection, uri);\r\n}\r\n/**\r\n * Create a new editor model.\r\n * You can specify the language that should be set for this model or let the language be inferred from the `uri`.\r\n */\r\nexport function createModel(value, language, uri) {\r\n    value = value || '';\r\n    if (!language) {\r\n        var path = uri ? uri.path : null;\r\n        var firstLF = value.indexOf('\\n');\r\n        var firstLine = value;\r\n        if (firstLF !== -1) {\r\n            firstLine = value.substring(0, firstLF);\r\n        }\r\n        return doCreateModel(value, StaticServices.modeService.get().createByFilepathOrFirstLine(path, firstLine), uri);\r\n    }\r\n    return doCreateModel(value, StaticServices.modeService.get().create(language), uri);\r\n}\r\n/**\r\n * Change the language for a model.\r\n */\r\nexport function setModelLanguage(model, languageId) {\r\n    StaticServices.modelService.get().setMode(model, StaticServices.modeService.get().create(languageId));\r\n}\r\n/**\r\n * Set the markers for a model.\r\n */\r\nexport function setModelMarkers(model, owner, markers) {\r\n    if (model) {\r\n        StaticServices.markerService.get().changeOne(owner, model.uri, markers);\r\n    }\r\n}\r\n/**\r\n * Get markers for owner and/or resource\r\n * @returns {IMarker[]} list of markers\r\n * @param filter\r\n */\r\nexport function getModelMarkers(filter) {\r\n    return StaticServices.markerService.get().read(filter);\r\n}\r\n/**\r\n * Get the model that has `uri` if it exists.\r\n */\r\nexport function getModel(uri) {\r\n    return StaticServices.modelService.get().getModel(uri);\r\n}\r\n/**\r\n * Get all the created models.\r\n */\r\nexport function getModels() {\r\n    return StaticServices.modelService.get().getModels();\r\n}\r\n/**\r\n * Emitted when a model is created.\r\n * @event\r\n */\r\nexport function onDidCreateModel(listener) {\r\n    return StaticServices.modelService.get().onModelAdded(listener);\r\n}\r\n/**\r\n * Emitted right before a model is disposed.\r\n * @event\r\n */\r\nexport function onWillDisposeModel(listener) {\r\n    return StaticServices.modelService.get().onModelRemoved(listener);\r\n}\r\n/**\r\n * Emitted when a different language is set to a model.\r\n * @event\r\n */\r\nexport function onDidChangeModelLanguage(listener) {\r\n    return StaticServices.modelService.get().onModelModeChanged(function (e) {\r\n        listener({\r\n            model: e.model,\r\n            oldLanguage: e.oldModeId\r\n        });\r\n    });\r\n}\r\n/**\r\n * Create a new web worker that has model syncing capabilities built in.\r\n * Specify an AMD module to load that will `create` an object that will be proxied.\r\n */\r\nexport function createWebWorker(opts) {\r\n    return actualCreateWebWorker(StaticServices.modelService.get(), opts);\r\n}\r\n/**\r\n * Colorize the contents of `domNode` using attribute `data-lang`.\r\n */\r\nexport function colorizeElement(domNode, options) {\r\n    return Colorizer.colorizeElement(StaticServices.standaloneThemeService.get(), StaticServices.modeService.get(), domNode, options);\r\n}\r\n/**\r\n * Colorize `text` using language `languageId`.\r\n */\r\nexport function colorize(text, languageId, options) {\r\n    return Colorizer.colorize(StaticServices.modeService.get(), text, languageId, options);\r\n}\r\n/**\r\n * Colorize a line in a model.\r\n */\r\nexport function colorizeModelLine(model, lineNumber, tabSize) {\r\n    if (tabSize === void 0) { tabSize = 4; }\r\n    return Colorizer.colorizeModelLine(model, lineNumber, tabSize);\r\n}\r\n/**\r\n * @internal\r\n */\r\nfunction getSafeTokenizationSupport(language) {\r\n    var tokenizationSupport = modes.TokenizationRegistry.get(language);\r\n    if (tokenizationSupport) {\r\n        return tokenizationSupport;\r\n    }\r\n    return {\r\n        getInitialState: function () { return NULL_STATE; },\r\n        tokenize: function (line, state, deltaOffset) { return nullTokenize(language, line, state, deltaOffset); },\r\n        tokenize2: undefined,\r\n    };\r\n}\r\n/**\r\n * Tokenize `text` using language `languageId`\r\n */\r\nexport function tokenize(text, languageId) {\r\n    var modeService = StaticServices.modeService.get();\r\n    // Needed in order to get the mode registered for subsequent look-ups\r\n    modeService.triggerMode(languageId);\r\n    var tokenizationSupport = getSafeTokenizationSupport(languageId);\r\n    var lines = text.split(/\\r\\n|\\r|\\n/);\r\n    var result = [];\r\n    var state = tokenizationSupport.getInitialState();\r\n    for (var i = 0, len = lines.length; i < len; i++) {\r\n        var line = lines[i];\r\n        var tokenizationResult = tokenizationSupport.tokenize(line, state, 0);\r\n        result[i] = tokenizationResult.tokens;\r\n        state = tokenizationResult.endState;\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Define a new theme or update an existing theme.\r\n */\r\nexport function defineTheme(themeName, themeData) {\r\n    StaticServices.standaloneThemeService.get().defineTheme(themeName, themeData);\r\n}\r\n/**\r\n * Switches to a theme.\r\n */\r\nexport function setTheme(themeName) {\r\n    StaticServices.standaloneThemeService.get().setTheme(themeName);\r\n}\r\n/**\r\n * @internal\r\n */\r\nexport function createMonacoEditorAPI() {\r\n    return {\r\n        // methods\r\n        create: create,\r\n        onDidCreateEditor: onDidCreateEditor,\r\n        createDiffEditor: createDiffEditor,\r\n        createDiffNavigator: createDiffNavigator,\r\n        createModel: createModel,\r\n        setModelLanguage: setModelLanguage,\r\n        setModelMarkers: setModelMarkers,\r\n        getModelMarkers: getModelMarkers,\r\n        getModels: getModels,\r\n        getModel: getModel,\r\n        onDidCreateModel: onDidCreateModel,\r\n        onWillDisposeModel: onWillDisposeModel,\r\n        onDidChangeModelLanguage: onDidChangeModelLanguage,\r\n        createWebWorker: createWebWorker,\r\n        colorizeElement: colorizeElement,\r\n        colorize: colorize,\r\n        colorizeModelLine: colorizeModelLine,\r\n        tokenize: tokenize,\r\n        defineTheme: defineTheme,\r\n        setTheme: setTheme,\r\n        // enums\r\n        ScrollbarVisibility: standaloneEnums.ScrollbarVisibility,\r\n        WrappingIndent: standaloneEnums.WrappingIndent,\r\n        OverviewRulerLane: standaloneEnums.OverviewRulerLane,\r\n        EndOfLinePreference: standaloneEnums.EndOfLinePreference,\r\n        DefaultEndOfLine: standaloneEnums.DefaultEndOfLine,\r\n        EndOfLineSequence: standaloneEnums.EndOfLineSequence,\r\n        TrackedRangeStickiness: standaloneEnums.TrackedRangeStickiness,\r\n        CursorChangeReason: standaloneEnums.CursorChangeReason,\r\n        MouseTargetType: standaloneEnums.MouseTargetType,\r\n        TextEditorCursorStyle: standaloneEnums.TextEditorCursorStyle,\r\n        TextEditorCursorBlinkingStyle: standaloneEnums.TextEditorCursorBlinkingStyle,\r\n        ContentWidgetPositionPreference: standaloneEnums.ContentWidgetPositionPreference,\r\n        OverlayWidgetPositionPreference: standaloneEnums.OverlayWidgetPositionPreference,\r\n        RenderMinimap: standaloneEnums.RenderMinimap,\r\n        ScrollType: standaloneEnums.ScrollType,\r\n        RenderLineNumbersType: standaloneEnums.RenderLineNumbersType,\r\n        // classes\r\n        InternalEditorOptions: editorOptions.InternalEditorOptions,\r\n        BareFontInfo: BareFontInfo,\r\n        FontInfo: FontInfo,\r\n        TextModelResolvedOptions: TextModelResolvedOptions,\r\n        FindMatch: FindMatch,\r\n        // vars\r\n        EditorType: editorCommon.EditorType\r\n    };\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport function isFuzzyActionArr(what) {\r\n    return (Array.isArray(what));\r\n}\r\nexport function isFuzzyAction(what) {\r\n    return !isFuzzyActionArr(what);\r\n}\r\nexport function isString(what) {\r\n    return (typeof what === 'string');\r\n}\r\nexport function isIAction(what) {\r\n    return !isString(what);\r\n}\r\n// Small helper functions\r\n/**\r\n * Is a string null, undefined, or empty?\r\n */\r\nexport function empty(s) {\r\n    return (s ? false : true);\r\n}\r\n/**\r\n * Puts a string to lower case if 'ignoreCase' is set.\r\n */\r\nexport function fixCase(lexer, str) {\r\n    return (lexer.ignoreCase && str ? str.toLowerCase() : str);\r\n}\r\n/**\r\n * Ensures there are no bad characters in a CSS token class.\r\n */\r\nexport function sanitize(s) {\r\n    return s.replace(/[&<>'\"_]/g, '-'); // used on all output token CSS classes\r\n}\r\n// Logging\r\n/**\r\n * Logs a message.\r\n */\r\nexport function log(lexer, msg) {\r\n    console.log(lexer.languageId + \": \" + msg);\r\n}\r\n// Throwing errors\r\nexport function createError(lexer, msg) {\r\n    return new Error(lexer.languageId + \": \" + msg);\r\n}\r\n// Helper functions for rule finding and substitution\r\n/**\r\n * substituteMatches is used on lexer strings and can substitutes predefined patterns:\r\n * \t\t$$  => $\r\n * \t\t$#  => id\r\n * \t\t$n  => matched entry n\r\n * \t\t@attr => contents of lexer[attr]\r\n *\r\n * See documentation for more info\r\n */\r\nexport function substituteMatches(lexer, str, id, matches, state) {\r\n    var re = /\\$((\\$)|(#)|(\\d\\d?)|[sS](\\d\\d?)|@(\\w+))/g;\r\n    var stateMatches = null;\r\n    return str.replace(re, function (full, sub, dollar, hash, n, s, attr, ofs, total) {\r\n        if (!empty(dollar)) {\r\n            return '$'; // $$\r\n        }\r\n        if (!empty(hash)) {\r\n            return fixCase(lexer, id); // default $#\r\n        }\r\n        if (!empty(n) && n < matches.length) {\r\n            return fixCase(lexer, matches[n]); // $n\r\n        }\r\n        if (!empty(attr) && lexer && typeof (lexer[attr]) === 'string') {\r\n            return lexer[attr]; //@attribute\r\n        }\r\n        if (stateMatches === null) { // split state on demand\r\n            stateMatches = state.split('.');\r\n            stateMatches.unshift(state);\r\n        }\r\n        if (!empty(s) && s < stateMatches.length) {\r\n            return fixCase(lexer, stateMatches[s]); //$Sn\r\n        }\r\n        return '';\r\n    });\r\n}\r\n/**\r\n * Find the tokenizer rules for a specific state (i.e. next action)\r\n */\r\nexport function findRules(lexer, inState) {\r\n    var state = inState;\r\n    while (state && state.length > 0) {\r\n        var rules = lexer.tokenizer[state];\r\n        if (rules) {\r\n            return rules;\r\n        }\r\n        var idx = state.lastIndexOf('.');\r\n        if (idx < 0) {\r\n            state = null; // no further parent\r\n        }\r\n        else {\r\n            state = state.substr(0, idx);\r\n        }\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Is a certain state defined? In contrast to 'findRules' this works on a ILexerMin.\r\n * This is used during compilation where we may know the defined states\r\n * but not yet whether the corresponding rules are correct.\r\n */\r\nexport function stateExists(lexer, inState) {\r\n    var state = inState;\r\n    while (state && state.length > 0) {\r\n        var exist = lexer.stateNames[state];\r\n        if (exist) {\r\n            return true;\r\n        }\r\n        var idx = state.lastIndexOf('.');\r\n        if (idx < 0) {\r\n            state = null; // no further parent\r\n        }\r\n        else {\r\n            state = state.substr(0, idx);\r\n        }\r\n    }\r\n    return false;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/*\r\n * This module only exports 'compile' which compiles a JSON language definition\r\n * into a typed and checked ILexer definition.\r\n */\r\nimport * as objects from '../../../../base/common/objects.js';\r\nimport * as monarchCommon from './monarchCommon.js';\r\n/*\r\n * Type helpers\r\n *\r\n * Note: this is just for sanity checks on the JSON description which is\r\n * helpful for the programmer. No checks are done anymore once the lexer is\r\n * already 'compiled and checked'.\r\n *\r\n */\r\nfunction isArrayOf(elemType, obj) {\r\n    if (!obj) {\r\n        return false;\r\n    }\r\n    if (!(Array.isArray(obj))) {\r\n        return false;\r\n    }\r\n    for (var idx in obj) {\r\n        if (obj.hasOwnProperty(idx)) {\r\n            if (!(elemType(obj[idx]))) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction bool(prop, defValue) {\r\n    if (typeof prop === 'boolean') {\r\n        return prop;\r\n    }\r\n    return defValue;\r\n}\r\nfunction string(prop, defValue) {\r\n    if (typeof (prop) === 'string') {\r\n        return prop;\r\n    }\r\n    return defValue;\r\n}\r\n// Lexer helpers\r\n/**\r\n * Compiles a regular expression string, adding the 'i' flag if 'ignoreCase' is set.\r\n * Also replaces @\\w+ or sequences with the content of the specified attribute\r\n */\r\nfunction compileRegExp(lexer, str) {\r\n    var n = 0;\r\n    while (str.indexOf('@') >= 0 && n < 5) { // at most 5 expansions\r\n        n++;\r\n        str = str.replace(/@(\\w+)/g, function (s, attr) {\r\n            var sub = '';\r\n            if (typeof (lexer[attr]) === 'string') {\r\n                sub = lexer[attr];\r\n            }\r\n            else if (lexer[attr] && lexer[attr] instanceof RegExp) {\r\n                sub = lexer[attr].source;\r\n            }\r\n            else {\r\n                if (lexer[attr] === undefined) {\r\n                    throw monarchCommon.createError(lexer, 'language definition does not contain attribute \\'' + attr + '\\', used at: ' + str);\r\n                }\r\n                else {\r\n                    throw monarchCommon.createError(lexer, 'attribute reference \\'' + attr + '\\' must be a string, used at: ' + str);\r\n                }\r\n            }\r\n            return (monarchCommon.empty(sub) ? '' : '(?:' + sub + ')');\r\n        });\r\n    }\r\n    return new RegExp(str, (lexer.ignoreCase ? 'i' : ''));\r\n}\r\n/**\r\n * Compiles guard functions for case matches.\r\n * This compiles 'cases' attributes into efficient match functions.\r\n *\r\n */\r\nfunction selectScrutinee(id, matches, state, num) {\r\n    if (num < 0) {\r\n        return id;\r\n    }\r\n    if (num < matches.length) {\r\n        return matches[num];\r\n    }\r\n    if (num >= 100) {\r\n        num = num - 100;\r\n        var parts = state.split('.');\r\n        parts.unshift(state);\r\n        if (num < parts.length) {\r\n            return parts[num];\r\n        }\r\n    }\r\n    return null;\r\n}\r\nfunction createGuard(lexer, ruleName, tkey, val) {\r\n    // get the scrutinee and pattern\r\n    var scrut = -1; // -1: $!, 0-99: $n, 100+n: $Sn\r\n    var oppat = tkey;\r\n    var matches = tkey.match(/^\\$(([sS]?)(\\d\\d?)|#)(.*)$/);\r\n    if (matches) {\r\n        if (matches[3]) { // if digits\r\n            scrut = parseInt(matches[3]);\r\n            if (matches[2]) {\r\n                scrut = scrut + 100; // if [sS] present\r\n            }\r\n        }\r\n        oppat = matches[4];\r\n    }\r\n    // get operator\r\n    var op = '~';\r\n    var pat = oppat;\r\n    if (!oppat || oppat.length === 0) {\r\n        op = '!=';\r\n        pat = '';\r\n    }\r\n    else if (/^\\w*$/.test(pat)) { // just a word\r\n        op = '==';\r\n    }\r\n    else {\r\n        matches = oppat.match(/^(@|!@|~|!~|==|!=)(.*)$/);\r\n        if (matches) {\r\n            op = matches[1];\r\n            pat = matches[2];\r\n        }\r\n    }\r\n    // set the tester function\r\n    var tester;\r\n    // special case a regexp that matches just words\r\n    if ((op === '~' || op === '!~') && /^(\\w|\\|)*$/.test(pat)) {\r\n        var inWords_1 = objects.createKeywordMatcher(pat.split('|'), lexer.ignoreCase);\r\n        tester = function (s) { return (op === '~' ? inWords_1(s) : !inWords_1(s)); };\r\n    }\r\n    else if (op === '@' || op === '!@') {\r\n        var words = lexer[pat];\r\n        if (!words) {\r\n            throw monarchCommon.createError(lexer, 'the @ match target \\'' + pat + '\\' is not defined, in rule: ' + ruleName);\r\n        }\r\n        if (!(isArrayOf(function (elem) { return (typeof (elem) === 'string'); }, words))) {\r\n            throw monarchCommon.createError(lexer, 'the @ match target \\'' + pat + '\\' must be an array of strings, in rule: ' + ruleName);\r\n        }\r\n        var inWords_2 = objects.createKeywordMatcher(words, lexer.ignoreCase);\r\n        tester = function (s) { return (op === '@' ? inWords_2(s) : !inWords_2(s)); };\r\n    }\r\n    else if (op === '~' || op === '!~') {\r\n        if (pat.indexOf('$') < 0) {\r\n            // precompile regular expression\r\n            var re_1 = compileRegExp(lexer, '^' + pat + '$');\r\n            tester = function (s) { return (op === '~' ? re_1.test(s) : !re_1.test(s)); };\r\n        }\r\n        else {\r\n            tester = function (s, id, matches, state) {\r\n                var re = compileRegExp(lexer, '^' + monarchCommon.substituteMatches(lexer, pat, id, matches, state) + '$');\r\n                return re.test(s);\r\n            };\r\n        }\r\n    }\r\n    else { // if (op==='==' || op==='!=') {\r\n        if (pat.indexOf('$') < 0) {\r\n            var patx_1 = monarchCommon.fixCase(lexer, pat);\r\n            tester = function (s) { return (op === '==' ? s === patx_1 : s !== patx_1); };\r\n        }\r\n        else {\r\n            var patx_2 = monarchCommon.fixCase(lexer, pat);\r\n            tester = function (s, id, matches, state, eos) {\r\n                var patexp = monarchCommon.substituteMatches(lexer, patx_2, id, matches, state);\r\n                return (op === '==' ? s === patexp : s !== patexp);\r\n            };\r\n        }\r\n    }\r\n    // return the branch object\r\n    if (scrut === -1) {\r\n        return {\r\n            name: tkey, value: val, test: function (id, matches, state, eos) {\r\n                return tester(id, id, matches, state, eos);\r\n            }\r\n        };\r\n    }\r\n    else {\r\n        return {\r\n            name: tkey, value: val, test: function (id, matches, state, eos) {\r\n                var scrutinee = selectScrutinee(id, matches, state, scrut);\r\n                return tester(!scrutinee ? '' : scrutinee, id, matches, state, eos);\r\n            }\r\n        };\r\n    }\r\n}\r\n/**\r\n * Compiles an action: i.e. optimize regular expressions and case matches\r\n * and do many sanity checks.\r\n *\r\n * This is called only during compilation but if the lexer definition\r\n * contains user functions as actions (which is usually not allowed), then this\r\n * may be called during lexing. It is important therefore to compile common cases efficiently\r\n */\r\nfunction compileAction(lexer, ruleName, action) {\r\n    if (!action) {\r\n        return { token: '' };\r\n    }\r\n    else if (typeof (action) === 'string') {\r\n        return action; // { token: action };\r\n    }\r\n    else if (action.token || action.token === '') {\r\n        if (typeof (action.token) !== 'string') {\r\n            throw monarchCommon.createError(lexer, 'a \\'token\\' attribute must be of type string, in rule: ' + ruleName);\r\n            return { token: '' };\r\n        }\r\n        else {\r\n            // only copy specific typed fields (only happens once during compile Lexer)\r\n            var newAction = { token: action.token };\r\n            if (action.token.indexOf('$') >= 0) {\r\n                newAction.tokenSubst = true;\r\n            }\r\n            if (typeof (action.bracket) === 'string') {\r\n                if (action.bracket === '@open') {\r\n                    newAction.bracket = 1 /* Open */;\r\n                }\r\n                else if (action.bracket === '@close') {\r\n                    newAction.bracket = -1 /* Close */;\r\n                }\r\n                else {\r\n                    throw monarchCommon.createError(lexer, 'a \\'bracket\\' attribute must be either \\'@open\\' or \\'@close\\', in rule: ' + ruleName);\r\n                }\r\n            }\r\n            if (action.next) {\r\n                if (typeof (action.next) !== 'string') {\r\n                    throw monarchCommon.createError(lexer, 'the next state must be a string value in rule: ' + ruleName);\r\n                }\r\n                else {\r\n                    var next = action.next;\r\n                    if (!/^(@pop|@push|@popall)$/.test(next)) {\r\n                        if (next[0] === '@') {\r\n                            next = next.substr(1); // peel off starting @ sign\r\n                        }\r\n                        if (next.indexOf('$') < 0) { // no dollar substitution, we can check if the state exists\r\n                            if (!monarchCommon.stateExists(lexer, monarchCommon.substituteMatches(lexer, next, '', [], ''))) {\r\n                                throw monarchCommon.createError(lexer, 'the next state \\'' + action.next + '\\' is not defined in rule: ' + ruleName);\r\n                            }\r\n                        }\r\n                    }\r\n                    newAction.next = next;\r\n                }\r\n            }\r\n            if (typeof (action.goBack) === 'number') {\r\n                newAction.goBack = action.goBack;\r\n            }\r\n            if (typeof (action.switchTo) === 'string') {\r\n                newAction.switchTo = action.switchTo;\r\n            }\r\n            if (typeof (action.log) === 'string') {\r\n                newAction.log = action.log;\r\n            }\r\n            if (typeof (action.nextEmbedded) === 'string') {\r\n                newAction.nextEmbedded = action.nextEmbedded;\r\n                lexer.usesEmbedded = true;\r\n            }\r\n            return newAction;\r\n        }\r\n    }\r\n    else if (Array.isArray(action)) {\r\n        var results = [];\r\n        for (var idx in action) {\r\n            if (action.hasOwnProperty(idx)) {\r\n                results[idx] = compileAction(lexer, ruleName, action[idx]);\r\n            }\r\n        }\r\n        return { group: results };\r\n    }\r\n    else if (action.cases) {\r\n        // build an array of test cases\r\n        var cases_1 = [];\r\n        // for each case, push a test function and result value\r\n        for (var tkey in action.cases) {\r\n            if (action.cases.hasOwnProperty(tkey)) {\r\n                var val = compileAction(lexer, ruleName, action.cases[tkey]);\r\n                // what kind of case\r\n                if (tkey === '@default' || tkey === '@' || tkey === '') {\r\n                    cases_1.push({ test: undefined, value: val, name: tkey });\r\n                }\r\n                else if (tkey === '@eos') {\r\n                    cases_1.push({ test: function (id, matches, state, eos) { return eos; }, value: val, name: tkey });\r\n                }\r\n                else {\r\n                    cases_1.push(createGuard(lexer, ruleName, tkey, val)); // call separate function to avoid local variable capture\r\n                }\r\n            }\r\n        }\r\n        // create a matching function\r\n        var def_1 = lexer.defaultToken;\r\n        return {\r\n            test: function (id, matches, state, eos) {\r\n                for (var idx in cases_1) {\r\n                    if (cases_1.hasOwnProperty(idx)) {\r\n                        var _case = cases_1[idx];\r\n                        var didmatch = (!_case.test || _case.test(id, matches, state, eos));\r\n                        if (didmatch) {\r\n                            return _case.value;\r\n                        }\r\n                    }\r\n                }\r\n                return def_1;\r\n            }\r\n        };\r\n    }\r\n    else {\r\n        throw monarchCommon.createError(lexer, 'an action must be a string, an object with a \\'token\\' or \\'cases\\' attribute, or an array of actions; in rule: ' + ruleName);\r\n        return '';\r\n    }\r\n}\r\n/**\r\n * Helper class for creating matching rules\r\n */\r\nvar Rule = /** @class */ (function () {\r\n    function Rule(name) {\r\n        this.regex = new RegExp('');\r\n        this.action = { token: '' };\r\n        this.matchOnlyAtLineStart = false;\r\n        this.name = '';\r\n        this.name = name;\r\n    }\r\n    Rule.prototype.setRegex = function (lexer, re) {\r\n        var sregex;\r\n        if (typeof (re) === 'string') {\r\n            sregex = re;\r\n        }\r\n        else if (re instanceof RegExp) {\r\n            sregex = re.source;\r\n        }\r\n        else {\r\n            throw monarchCommon.createError(lexer, 'rules must start with a match string or regular expression: ' + this.name);\r\n        }\r\n        this.matchOnlyAtLineStart = (sregex.length > 0 && sregex[0] === '^');\r\n        this.name = this.name + ': ' + sregex;\r\n        this.regex = compileRegExp(lexer, '^(?:' + (this.matchOnlyAtLineStart ? sregex.substr(1) : sregex) + ')');\r\n    };\r\n    Rule.prototype.setAction = function (lexer, act) {\r\n        this.action = compileAction(lexer, this.name, act);\r\n    };\r\n    return Rule;\r\n}());\r\n/**\r\n * Compiles a json description function into json where all regular expressions,\r\n * case matches etc, are compiled and all include rules are expanded.\r\n * We also compile the bracket definitions, supply defaults, and do many sanity checks.\r\n * If the 'jsonStrict' parameter is 'false', we allow at certain locations\r\n * regular expression objects and functions that get called during lexing.\r\n * (Currently we have no samples that need this so perhaps we should always have\r\n * jsonStrict to true).\r\n */\r\nexport function compile(languageId, json) {\r\n    if (!json || typeof (json) !== 'object') {\r\n        throw new Error('Monarch: expecting a language definition object');\r\n    }\r\n    // Create our lexer\r\n    var lexer = {};\r\n    lexer.languageId = languageId;\r\n    lexer.noThrow = false; // raise exceptions during compilation\r\n    lexer.maxStack = 100;\r\n    // Set standard fields: be defensive about types\r\n    lexer.start = (typeof json.start === 'string' ? json.start : null);\r\n    lexer.ignoreCase = bool(json.ignoreCase, false);\r\n    lexer.tokenPostfix = string(json.tokenPostfix, '.' + lexer.languageId);\r\n    lexer.defaultToken = string(json.defaultToken, 'source');\r\n    lexer.usesEmbedded = false; // becomes true if we find a nextEmbedded action\r\n    // For calling compileAction later on\r\n    var lexerMin = json;\r\n    lexerMin.languageId = languageId;\r\n    lexerMin.ignoreCase = lexer.ignoreCase;\r\n    lexerMin.noThrow = lexer.noThrow;\r\n    lexerMin.usesEmbedded = lexer.usesEmbedded;\r\n    lexerMin.stateNames = json.tokenizer;\r\n    lexerMin.defaultToken = lexer.defaultToken;\r\n    // Compile an array of rules into newrules where RegExp objects are created.\r\n    function addRules(state, newrules, rules) {\r\n        for (var idx in rules) {\r\n            if (rules.hasOwnProperty(idx)) {\r\n                var rule = rules[idx];\r\n                var include = rule.include;\r\n                if (include) {\r\n                    if (typeof (include) !== 'string') {\r\n                        throw monarchCommon.createError(lexer, 'an \\'include\\' attribute must be a string at: ' + state);\r\n                    }\r\n                    if (include[0] === '@') {\r\n                        include = include.substr(1); // peel off starting @\r\n                    }\r\n                    if (!json.tokenizer[include]) {\r\n                        throw monarchCommon.createError(lexer, 'include target \\'' + include + '\\' is not defined at: ' + state);\r\n                    }\r\n                    addRules(state + '.' + include, newrules, json.tokenizer[include]);\r\n                }\r\n                else {\r\n                    var newrule = new Rule(state);\r\n                    // Set up new rule attributes\r\n                    if (Array.isArray(rule) && rule.length >= 1 && rule.length <= 3) {\r\n                        newrule.setRegex(lexerMin, rule[0]);\r\n                        if (rule.length >= 3) {\r\n                            if (typeof (rule[1]) === 'string') {\r\n                                newrule.setAction(lexerMin, { token: rule[1], next: rule[2] });\r\n                            }\r\n                            else if (typeof (rule[1]) === 'object') {\r\n                                var rule1 = rule[1];\r\n                                rule1.next = rule[2];\r\n                                newrule.setAction(lexerMin, rule1);\r\n                            }\r\n                            else {\r\n                                throw monarchCommon.createError(lexer, 'a next state as the last element of a rule can only be given if the action is either an object or a string, at: ' + state);\r\n                            }\r\n                        }\r\n                        else {\r\n                            newrule.setAction(lexerMin, rule[1]);\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (!rule.regex) {\r\n                            throw monarchCommon.createError(lexer, 'a rule must either be an array, or an object with a \\'regex\\' or \\'include\\' field at: ' + state);\r\n                        }\r\n                        if (rule.name) {\r\n                            if (typeof rule.name === 'string') {\r\n                                newrule.name = rule.name;\r\n                            }\r\n                        }\r\n                        if (rule.matchOnlyAtStart) {\r\n                            newrule.matchOnlyAtLineStart = bool(rule.matchOnlyAtLineStart, false);\r\n                        }\r\n                        newrule.setRegex(lexerMin, rule.regex);\r\n                        newrule.setAction(lexerMin, rule.action);\r\n                    }\r\n                    newrules.push(newrule);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // compile the tokenizer rules\r\n    if (!json.tokenizer || typeof (json.tokenizer) !== 'object') {\r\n        throw monarchCommon.createError(lexer, 'a language definition must define the \\'tokenizer\\' attribute as an object');\r\n    }\r\n    lexer.tokenizer = [];\r\n    for (var key in json.tokenizer) {\r\n        if (json.tokenizer.hasOwnProperty(key)) {\r\n            if (!lexer.start) {\r\n                lexer.start = key;\r\n            }\r\n            var rules = json.tokenizer[key];\r\n            lexer.tokenizer[key] = new Array();\r\n            addRules('tokenizer.' + key, lexer.tokenizer[key], rules);\r\n        }\r\n    }\r\n    lexer.usesEmbedded = lexerMin.usesEmbedded; // can be set during compileAction\r\n    // Set simple brackets\r\n    if (json.brackets) {\r\n        if (!(Array.isArray(json.brackets))) {\r\n            throw monarchCommon.createError(lexer, 'the \\'brackets\\' attribute must be defined as an array');\r\n        }\r\n    }\r\n    else {\r\n        json.brackets = [\r\n            { open: '{', close: '}', token: 'delimiter.curly' },\r\n            { open: '[', close: ']', token: 'delimiter.square' },\r\n            { open: '(', close: ')', token: 'delimiter.parenthesis' },\r\n            { open: '<', close: '>', token: 'delimiter.angle' }\r\n        ];\r\n    }\r\n    var brackets = [];\r\n    for (var bracketIdx in json.brackets) {\r\n        if (json.brackets.hasOwnProperty(bracketIdx)) {\r\n            var desc = json.brackets[bracketIdx];\r\n            if (desc && Array.isArray(desc) && desc.length === 3) {\r\n                desc = { token: desc[2], open: desc[0], close: desc[1] };\r\n            }\r\n            if (desc.open === desc.close) {\r\n                throw monarchCommon.createError(lexer, 'open and close brackets in a \\'brackets\\' attribute must be different: ' + desc.open +\r\n                    '\\n hint: use the \\'bracket\\' attribute if matching on equal brackets is required.');\r\n            }\r\n            if (typeof desc.open === 'string' && typeof desc.token === 'string' && typeof desc.close === 'string') {\r\n                brackets.push({\r\n                    token: desc.token + lexer.tokenPostfix,\r\n                    open: monarchCommon.fixCase(lexer, desc.open),\r\n                    close: monarchCommon.fixCase(lexer, desc.close)\r\n                });\r\n            }\r\n            else {\r\n                throw monarchCommon.createError(lexer, 'every element in the \\'brackets\\' array must be a \\'{open,close,token}\\' object or array');\r\n            }\r\n        }\r\n    }\r\n    lexer.brackets = brackets;\r\n    // Disable throw so the syntax highlighter goes, no matter what\r\n    lexer.noThrow = true;\r\n    return lexer;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Token, TokenizationResult, TokenizationResult2 } from '../../../common/core/token.js';\r\nimport * as modes from '../../../common/modes.js';\r\nimport { NULL_MODE_ID, NULL_STATE } from '../../../common/modes/nullMode.js';\r\nimport * as monarchCommon from './monarchCommon.js';\r\nvar CACHE_STACK_DEPTH = 5;\r\n/**\r\n * Reuse the same stack elements up to a certain depth.\r\n */\r\nvar MonarchStackElementFactory = /** @class */ (function () {\r\n    function MonarchStackElementFactory(maxCacheDepth) {\r\n        this._maxCacheDepth = maxCacheDepth;\r\n        this._entries = Object.create(null);\r\n    }\r\n    MonarchStackElementFactory.create = function (parent, state) {\r\n        return this._INSTANCE.create(parent, state);\r\n    };\r\n    MonarchStackElementFactory.prototype.create = function (parent, state) {\r\n        if (parent !== null && parent.depth >= this._maxCacheDepth) {\r\n            // no caching above a certain depth\r\n            return new MonarchStackElement(parent, state);\r\n        }\r\n        var stackElementId = MonarchStackElement.getStackElementId(parent);\r\n        if (stackElementId.length > 0) {\r\n            stackElementId += '|';\r\n        }\r\n        stackElementId += state;\r\n        var result = this._entries[stackElementId];\r\n        if (result) {\r\n            return result;\r\n        }\r\n        result = new MonarchStackElement(parent, state);\r\n        this._entries[stackElementId] = result;\r\n        return result;\r\n    };\r\n    MonarchStackElementFactory._INSTANCE = new MonarchStackElementFactory(CACHE_STACK_DEPTH);\r\n    return MonarchStackElementFactory;\r\n}());\r\nvar MonarchStackElement = /** @class */ (function () {\r\n    function MonarchStackElement(parent, state) {\r\n        this.parent = parent;\r\n        this.state = state;\r\n        this.depth = (this.parent ? this.parent.depth : 0) + 1;\r\n    }\r\n    MonarchStackElement.getStackElementId = function (element) {\r\n        var result = '';\r\n        while (element !== null) {\r\n            if (result.length > 0) {\r\n                result += '|';\r\n            }\r\n            result += element.state;\r\n            element = element.parent;\r\n        }\r\n        return result;\r\n    };\r\n    MonarchStackElement._equals = function (a, b) {\r\n        while (a !== null && b !== null) {\r\n            if (a === b) {\r\n                return true;\r\n            }\r\n            if (a.state !== b.state) {\r\n                return false;\r\n            }\r\n            a = a.parent;\r\n            b = b.parent;\r\n        }\r\n        if (a === null && b === null) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    MonarchStackElement.prototype.equals = function (other) {\r\n        return MonarchStackElement._equals(this, other);\r\n    };\r\n    MonarchStackElement.prototype.push = function (state) {\r\n        return MonarchStackElementFactory.create(this, state);\r\n    };\r\n    MonarchStackElement.prototype.pop = function () {\r\n        return this.parent;\r\n    };\r\n    MonarchStackElement.prototype.popall = function () {\r\n        var result = this;\r\n        while (result.parent) {\r\n            result = result.parent;\r\n        }\r\n        return result;\r\n    };\r\n    MonarchStackElement.prototype.switchTo = function (state) {\r\n        return MonarchStackElementFactory.create(this.parent, state);\r\n    };\r\n    return MonarchStackElement;\r\n}());\r\nvar EmbeddedModeData = /** @class */ (function () {\r\n    function EmbeddedModeData(modeId, state) {\r\n        this.modeId = modeId;\r\n        this.state = state;\r\n    }\r\n    EmbeddedModeData.prototype.equals = function (other) {\r\n        return (this.modeId === other.modeId\r\n            && this.state.equals(other.state));\r\n    };\r\n    EmbeddedModeData.prototype.clone = function () {\r\n        var stateClone = this.state.clone();\r\n        // save an object\r\n        if (stateClone === this.state) {\r\n            return this;\r\n        }\r\n        return new EmbeddedModeData(this.modeId, this.state);\r\n    };\r\n    return EmbeddedModeData;\r\n}());\r\n/**\r\n * Reuse the same line states up to a certain depth.\r\n */\r\nvar MonarchLineStateFactory = /** @class */ (function () {\r\n    function MonarchLineStateFactory(maxCacheDepth) {\r\n        this._maxCacheDepth = maxCacheDepth;\r\n        this._entries = Object.create(null);\r\n    }\r\n    MonarchLineStateFactory.create = function (stack, embeddedModeData) {\r\n        return this._INSTANCE.create(stack, embeddedModeData);\r\n    };\r\n    MonarchLineStateFactory.prototype.create = function (stack, embeddedModeData) {\r\n        if (embeddedModeData !== null) {\r\n            // no caching when embedding\r\n            return new MonarchLineState(stack, embeddedModeData);\r\n        }\r\n        if (stack !== null && stack.depth >= this._maxCacheDepth) {\r\n            // no caching above a certain depth\r\n            return new MonarchLineState(stack, embeddedModeData);\r\n        }\r\n        var stackElementId = MonarchStackElement.getStackElementId(stack);\r\n        var result = this._entries[stackElementId];\r\n        if (result) {\r\n            return result;\r\n        }\r\n        result = new MonarchLineState(stack, null);\r\n        this._entries[stackElementId] = result;\r\n        return result;\r\n    };\r\n    MonarchLineStateFactory._INSTANCE = new MonarchLineStateFactory(CACHE_STACK_DEPTH);\r\n    return MonarchLineStateFactory;\r\n}());\r\nvar MonarchLineState = /** @class */ (function () {\r\n    function MonarchLineState(stack, embeddedModeData) {\r\n        this.stack = stack;\r\n        this.embeddedModeData = embeddedModeData;\r\n    }\r\n    MonarchLineState.prototype.clone = function () {\r\n        var embeddedModeDataClone = this.embeddedModeData ? this.embeddedModeData.clone() : null;\r\n        // save an object\r\n        if (embeddedModeDataClone === this.embeddedModeData) {\r\n            return this;\r\n        }\r\n        return MonarchLineStateFactory.create(this.stack, this.embeddedModeData);\r\n    };\r\n    MonarchLineState.prototype.equals = function (other) {\r\n        if (!(other instanceof MonarchLineState)) {\r\n            return false;\r\n        }\r\n        if (!this.stack.equals(other.stack)) {\r\n            return false;\r\n        }\r\n        if (this.embeddedModeData === null && other.embeddedModeData === null) {\r\n            return true;\r\n        }\r\n        if (this.embeddedModeData === null || other.embeddedModeData === null) {\r\n            return false;\r\n        }\r\n        return this.embeddedModeData.equals(other.embeddedModeData);\r\n    };\r\n    return MonarchLineState;\r\n}());\r\nvar hasOwnProperty = Object.hasOwnProperty;\r\nvar MonarchClassicTokensCollector = /** @class */ (function () {\r\n    function MonarchClassicTokensCollector() {\r\n        this._tokens = [];\r\n        this._language = null;\r\n        this._lastTokenType = null;\r\n        this._lastTokenLanguage = null;\r\n    }\r\n    MonarchClassicTokensCollector.prototype.enterMode = function (startOffset, modeId) {\r\n        this._language = modeId;\r\n    };\r\n    MonarchClassicTokensCollector.prototype.emit = function (startOffset, type) {\r\n        if (this._lastTokenType === type && this._lastTokenLanguage === this._language) {\r\n            return;\r\n        }\r\n        this._lastTokenType = type;\r\n        this._lastTokenLanguage = this._language;\r\n        this._tokens.push(new Token(startOffset, type, this._language));\r\n    };\r\n    MonarchClassicTokensCollector.prototype.nestedModeTokenize = function (embeddedModeLine, embeddedModeData, offsetDelta) {\r\n        var nestedModeId = embeddedModeData.modeId;\r\n        var embeddedModeState = embeddedModeData.state;\r\n        var nestedModeTokenizationSupport = modes.TokenizationRegistry.get(nestedModeId);\r\n        if (!nestedModeTokenizationSupport) {\r\n            this.enterMode(offsetDelta, nestedModeId);\r\n            this.emit(offsetDelta, '');\r\n            return embeddedModeState;\r\n        }\r\n        var nestedResult = nestedModeTokenizationSupport.tokenize(embeddedModeLine, embeddedModeState, offsetDelta);\r\n        this._tokens = this._tokens.concat(nestedResult.tokens);\r\n        this._lastTokenType = null;\r\n        this._lastTokenLanguage = null;\r\n        this._language = null;\r\n        return nestedResult.endState;\r\n    };\r\n    MonarchClassicTokensCollector.prototype.finalize = function (endState) {\r\n        return new TokenizationResult(this._tokens, endState);\r\n    };\r\n    return MonarchClassicTokensCollector;\r\n}());\r\nvar MonarchModernTokensCollector = /** @class */ (function () {\r\n    function MonarchModernTokensCollector(modeService, theme) {\r\n        this._modeService = modeService;\r\n        this._theme = theme;\r\n        this._prependTokens = null;\r\n        this._tokens = [];\r\n        this._currentLanguageId = 0 /* Null */;\r\n        this._lastTokenMetadata = 0;\r\n    }\r\n    MonarchModernTokensCollector.prototype.enterMode = function (startOffset, modeId) {\r\n        this._currentLanguageId = this._modeService.getLanguageIdentifier(modeId).id;\r\n    };\r\n    MonarchModernTokensCollector.prototype.emit = function (startOffset, type) {\r\n        var metadata = this._theme.match(this._currentLanguageId, type);\r\n        if (this._lastTokenMetadata === metadata) {\r\n            return;\r\n        }\r\n        this._lastTokenMetadata = metadata;\r\n        this._tokens.push(startOffset);\r\n        this._tokens.push(metadata);\r\n    };\r\n    MonarchModernTokensCollector._merge = function (a, b, c) {\r\n        var aLen = (a !== null ? a.length : 0);\r\n        var bLen = b.length;\r\n        var cLen = (c !== null ? c.length : 0);\r\n        if (aLen === 0 && bLen === 0 && cLen === 0) {\r\n            return new Uint32Array(0);\r\n        }\r\n        if (aLen === 0 && bLen === 0) {\r\n            return c;\r\n        }\r\n        if (bLen === 0 && cLen === 0) {\r\n            return a;\r\n        }\r\n        var result = new Uint32Array(aLen + bLen + cLen);\r\n        if (a !== null) {\r\n            result.set(a);\r\n        }\r\n        for (var i = 0; i < bLen; i++) {\r\n            result[aLen + i] = b[i];\r\n        }\r\n        if (c !== null) {\r\n            result.set(c, aLen + bLen);\r\n        }\r\n        return result;\r\n    };\r\n    MonarchModernTokensCollector.prototype.nestedModeTokenize = function (embeddedModeLine, embeddedModeData, offsetDelta) {\r\n        var nestedModeId = embeddedModeData.modeId;\r\n        var embeddedModeState = embeddedModeData.state;\r\n        var nestedModeTokenizationSupport = modes.TokenizationRegistry.get(nestedModeId);\r\n        if (!nestedModeTokenizationSupport) {\r\n            this.enterMode(offsetDelta, nestedModeId);\r\n            this.emit(offsetDelta, '');\r\n            return embeddedModeState;\r\n        }\r\n        var nestedResult = nestedModeTokenizationSupport.tokenize2(embeddedModeLine, embeddedModeState, offsetDelta);\r\n        this._prependTokens = MonarchModernTokensCollector._merge(this._prependTokens, this._tokens, nestedResult.tokens);\r\n        this._tokens = [];\r\n        this._currentLanguageId = 0;\r\n        this._lastTokenMetadata = 0;\r\n        return nestedResult.endState;\r\n    };\r\n    MonarchModernTokensCollector.prototype.finalize = function (endState) {\r\n        return new TokenizationResult2(MonarchModernTokensCollector._merge(this._prependTokens, this._tokens, null), endState);\r\n    };\r\n    return MonarchModernTokensCollector;\r\n}());\r\nvar MonarchTokenizer = /** @class */ (function () {\r\n    function MonarchTokenizer(modeService, standaloneThemeService, modeId, lexer) {\r\n        var _this = this;\r\n        this._modeService = modeService;\r\n        this._standaloneThemeService = standaloneThemeService;\r\n        this._modeId = modeId;\r\n        this._lexer = lexer;\r\n        this._embeddedModes = Object.create(null);\r\n        // Set up listening for embedded modes\r\n        var emitting = false;\r\n        this._tokenizationRegistryListener = modes.TokenizationRegistry.onDidChange(function (e) {\r\n            if (emitting) {\r\n                return;\r\n            }\r\n            var isOneOfMyEmbeddedModes = false;\r\n            for (var i = 0, len = e.changedLanguages.length; i < len; i++) {\r\n                var language = e.changedLanguages[i];\r\n                if (_this._embeddedModes[language]) {\r\n                    isOneOfMyEmbeddedModes = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (isOneOfMyEmbeddedModes) {\r\n                emitting = true;\r\n                modes.TokenizationRegistry.fire([_this._modeId]);\r\n                emitting = false;\r\n            }\r\n        });\r\n    }\r\n    MonarchTokenizer.prototype.dispose = function () {\r\n        this._tokenizationRegistryListener.dispose();\r\n    };\r\n    MonarchTokenizer.prototype.getInitialState = function () {\r\n        var rootState = MonarchStackElementFactory.create(null, this._lexer.start);\r\n        return MonarchLineStateFactory.create(rootState, null);\r\n    };\r\n    MonarchTokenizer.prototype.tokenize = function (line, lineState, offsetDelta) {\r\n        var tokensCollector = new MonarchClassicTokensCollector();\r\n        var endLineState = this._tokenize(line, lineState, offsetDelta, tokensCollector);\r\n        return tokensCollector.finalize(endLineState);\r\n    };\r\n    MonarchTokenizer.prototype.tokenize2 = function (line, lineState, offsetDelta) {\r\n        var tokensCollector = new MonarchModernTokensCollector(this._modeService, this._standaloneThemeService.getTheme().tokenTheme);\r\n        var endLineState = this._tokenize(line, lineState, offsetDelta, tokensCollector);\r\n        return tokensCollector.finalize(endLineState);\r\n    };\r\n    MonarchTokenizer.prototype._tokenize = function (line, lineState, offsetDelta, collector) {\r\n        if (lineState.embeddedModeData) {\r\n            return this._nestedTokenize(line, lineState, offsetDelta, collector);\r\n        }\r\n        else {\r\n            return this._myTokenize(line, lineState, offsetDelta, collector);\r\n        }\r\n    };\r\n    MonarchTokenizer.prototype._findLeavingNestedModeOffset = function (line, state) {\r\n        var rules = this._lexer.tokenizer[state.stack.state];\r\n        if (!rules) {\r\n            rules = monarchCommon.findRules(this._lexer, state.stack.state); // do parent matching\r\n            if (!rules) {\r\n                throw monarchCommon.createError(this._lexer, 'tokenizer state is not defined: ' + state.stack.state);\r\n            }\r\n        }\r\n        var popOffset = -1;\r\n        var hasEmbeddedPopRule = false;\r\n        for (var idx in rules) {\r\n            if (!hasOwnProperty.call(rules, idx)) {\r\n                continue;\r\n            }\r\n            var rule = rules[idx];\r\n            if (!monarchCommon.isIAction(rule.action) || rule.action.nextEmbedded !== '@pop') {\r\n                continue;\r\n            }\r\n            hasEmbeddedPopRule = true;\r\n            var regex = rule.regex;\r\n            var regexSource = rule.regex.source;\r\n            if (regexSource.substr(0, 4) === '^(?:' && regexSource.substr(regexSource.length - 1, 1) === ')') {\r\n                regex = new RegExp(regexSource.substr(4, regexSource.length - 5), regex.ignoreCase ? 'i' : '');\r\n            }\r\n            var result = line.search(regex);\r\n            if (result === -1) {\r\n                continue;\r\n            }\r\n            if (popOffset === -1 || result < popOffset) {\r\n                popOffset = result;\r\n            }\r\n        }\r\n        if (!hasEmbeddedPopRule) {\r\n            throw monarchCommon.createError(this._lexer, 'no rule containing nextEmbedded: \"@pop\" in tokenizer embedded state: ' + state.stack.state);\r\n        }\r\n        return popOffset;\r\n    };\r\n    MonarchTokenizer.prototype._nestedTokenize = function (line, lineState, offsetDelta, tokensCollector) {\r\n        var popOffset = this._findLeavingNestedModeOffset(line, lineState);\r\n        if (popOffset === -1) {\r\n            // tokenization will not leave nested mode\r\n            var nestedEndState = tokensCollector.nestedModeTokenize(line, lineState.embeddedModeData, offsetDelta);\r\n            return MonarchLineStateFactory.create(lineState.stack, new EmbeddedModeData(lineState.embeddedModeData.modeId, nestedEndState));\r\n        }\r\n        var nestedModeLine = line.substring(0, popOffset);\r\n        if (nestedModeLine.length > 0) {\r\n            // tokenize with the nested mode\r\n            tokensCollector.nestedModeTokenize(nestedModeLine, lineState.embeddedModeData, offsetDelta);\r\n        }\r\n        var restOfTheLine = line.substring(popOffset);\r\n        return this._myTokenize(restOfTheLine, lineState, offsetDelta + popOffset, tokensCollector);\r\n    };\r\n    MonarchTokenizer.prototype._myTokenize = function (line, lineState, offsetDelta, tokensCollector) {\r\n        tokensCollector.enterMode(offsetDelta, this._modeId);\r\n        var lineLength = line.length;\r\n        var embeddedModeData = lineState.embeddedModeData;\r\n        var stack = lineState.stack;\r\n        var pos = 0;\r\n        var groupMatching = null;\r\n        while (pos < lineLength) {\r\n            var pos0 = pos;\r\n            var stackLen0 = stack.depth;\r\n            var groupLen0 = groupMatching ? groupMatching.groups.length : 0;\r\n            var state = stack.state;\r\n            var matches = null;\r\n            var matched = null;\r\n            var action = null;\r\n            var rule = null;\r\n            var enteringEmbeddedMode = null;\r\n            // check if we need to process group matches first\r\n            if (groupMatching) {\r\n                matches = groupMatching.matches;\r\n                var groupEntry = groupMatching.groups.shift();\r\n                matched = groupEntry.matched;\r\n                action = groupEntry.action;\r\n                rule = groupMatching.rule;\r\n                // cleanup if necessary\r\n                if (groupMatching.groups.length === 0) {\r\n                    groupMatching = null;\r\n                }\r\n            }\r\n            else {\r\n                // otherwise we match on the token stream\r\n                if (pos >= lineLength) {\r\n                    // nothing to do\r\n                    break;\r\n                }\r\n                // get the rules for this state\r\n                var rules = this._lexer.tokenizer[state];\r\n                if (!rules) {\r\n                    rules = monarchCommon.findRules(this._lexer, state); // do parent matching\r\n                    if (!rules) {\r\n                        throw monarchCommon.createError(this._lexer, 'tokenizer state is not defined: ' + state);\r\n                    }\r\n                }\r\n                // try each rule until we match\r\n                var restOfLine = line.substr(pos);\r\n                for (var idx in rules) {\r\n                    if (hasOwnProperty.call(rules, idx)) {\r\n                        var rule_1 = rules[idx];\r\n                        if (pos === 0 || !rule_1.matchOnlyAtLineStart) {\r\n                            matches = restOfLine.match(rule_1.regex);\r\n                            if (matches) {\r\n                                matched = matches[0];\r\n                                action = rule_1.action;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // We matched 'rule' with 'matches' and 'action'\r\n            if (!matches) {\r\n                matches = [''];\r\n                matched = '';\r\n            }\r\n            if (!action) {\r\n                // bad: we didn't match anything, and there is no action to take\r\n                // we need to advance the stream or we get progress trouble\r\n                if (pos < lineLength) {\r\n                    matches = [line.charAt(pos)];\r\n                    matched = matches[0];\r\n                }\r\n                action = this._lexer.defaultToken;\r\n            }\r\n            // advance stream\r\n            pos += matched.length;\r\n            // maybe call action function (used for 'cases')\r\n            while (monarchCommon.isFuzzyAction(action) && monarchCommon.isIAction(action) && action.test) {\r\n                action = action.test(matched, matches, state, pos === lineLength);\r\n            }\r\n            var result = null;\r\n            // set the result: either a string or an array of actions\r\n            if (typeof action === 'string' || Array.isArray(action)) {\r\n                result = action;\r\n            }\r\n            else if (action.group) {\r\n                result = action.group;\r\n            }\r\n            else if (action.token !== null && action.token !== undefined) {\r\n                // do $n replacements?\r\n                if (action.tokenSubst) {\r\n                    result = monarchCommon.substituteMatches(this._lexer, action.token, matched, matches, state);\r\n                }\r\n                else {\r\n                    result = action.token;\r\n                }\r\n                // enter embedded mode?\r\n                if (action.nextEmbedded) {\r\n                    if (action.nextEmbedded === '@pop') {\r\n                        if (!embeddedModeData) {\r\n                            throw monarchCommon.createError(this._lexer, 'cannot pop embedded mode if not inside one');\r\n                        }\r\n                        embeddedModeData = null;\r\n                    }\r\n                    else if (embeddedModeData) {\r\n                        throw monarchCommon.createError(this._lexer, 'cannot enter embedded mode from within an embedded mode');\r\n                    }\r\n                    else {\r\n                        enteringEmbeddedMode = monarchCommon.substituteMatches(this._lexer, action.nextEmbedded, matched, matches, state);\r\n                    }\r\n                }\r\n                // state transformations\r\n                if (action.goBack) { // back up the stream..\r\n                    pos = Math.max(0, pos - action.goBack);\r\n                }\r\n                if (action.switchTo && typeof action.switchTo === 'string') {\r\n                    var nextState = monarchCommon.substituteMatches(this._lexer, action.switchTo, matched, matches, state); // switch state without a push...\r\n                    if (nextState[0] === '@') {\r\n                        nextState = nextState.substr(1); // peel off starting '@'\r\n                    }\r\n                    if (!monarchCommon.findRules(this._lexer, nextState)) {\r\n                        throw monarchCommon.createError(this._lexer, 'trying to switch to a state \\'' + nextState + '\\' that is undefined in rule: ' + rule.name);\r\n                    }\r\n                    else {\r\n                        stack = stack.switchTo(nextState);\r\n                    }\r\n                }\r\n                else if (action.transform && typeof action.transform === 'function') {\r\n                    throw monarchCommon.createError(this._lexer, 'action.transform not supported');\r\n                }\r\n                else if (action.next) {\r\n                    if (action.next === '@push') {\r\n                        if (stack.depth >= this._lexer.maxStack) {\r\n                            throw monarchCommon.createError(this._lexer, 'maximum tokenizer stack size reached: [' +\r\n                                stack.state + ',' + stack.parent.state + ',...]');\r\n                        }\r\n                        else {\r\n                            stack = stack.push(state);\r\n                        }\r\n                    }\r\n                    else if (action.next === '@pop') {\r\n                        if (stack.depth <= 1) {\r\n                            throw monarchCommon.createError(this._lexer, 'trying to pop an empty stack in rule: ' + rule.name);\r\n                        }\r\n                        else {\r\n                            stack = stack.pop();\r\n                        }\r\n                    }\r\n                    else if (action.next === '@popall') {\r\n                        stack = stack.popall();\r\n                    }\r\n                    else {\r\n                        var nextState = monarchCommon.substituteMatches(this._lexer, action.next, matched, matches, state);\r\n                        if (nextState[0] === '@') {\r\n                            nextState = nextState.substr(1); // peel off starting '@'\r\n                        }\r\n                        if (!monarchCommon.findRules(this._lexer, nextState)) {\r\n                            throw monarchCommon.createError(this._lexer, 'trying to set a next state \\'' + nextState + '\\' that is undefined in rule: ' + rule.name);\r\n                        }\r\n                        else {\r\n                            stack = stack.push(nextState);\r\n                        }\r\n                    }\r\n                }\r\n                if (action.log && typeof (action.log) === 'string') {\r\n                    monarchCommon.log(this._lexer, this._lexer.languageId + ': ' + monarchCommon.substituteMatches(this._lexer, action.log, matched, matches, state));\r\n                }\r\n            }\r\n            // check result\r\n            if (result === null) {\r\n                throw monarchCommon.createError(this._lexer, 'lexer rule has no well-defined action in rule: ' + rule.name);\r\n            }\r\n            // is the result a group match?\r\n            if (Array.isArray(result)) {\r\n                if (groupMatching && groupMatching.groups.length > 0) {\r\n                    throw monarchCommon.createError(this._lexer, 'groups cannot be nested: ' + rule.name);\r\n                }\r\n                if (matches.length !== result.length + 1) {\r\n                    throw monarchCommon.createError(this._lexer, 'matched number of groups does not match the number of actions in rule: ' + rule.name);\r\n                }\r\n                var totalLen = 0;\r\n                for (var i = 1; i < matches.length; i++) {\r\n                    totalLen += matches[i].length;\r\n                }\r\n                if (totalLen !== matched.length) {\r\n                    throw monarchCommon.createError(this._lexer, 'with groups, all characters should be matched in consecutive groups in rule: ' + rule.name);\r\n                }\r\n                groupMatching = {\r\n                    rule: rule,\r\n                    matches: matches,\r\n                    groups: []\r\n                };\r\n                for (var i = 0; i < result.length; i++) {\r\n                    groupMatching.groups[i] = {\r\n                        action: result[i],\r\n                        matched: matches[i + 1]\r\n                    };\r\n                }\r\n                pos -= matched.length;\r\n                // call recursively to initiate first result match\r\n                continue;\r\n            }\r\n            else {\r\n                // regular result\r\n                // check for '@rematch'\r\n                if (result === '@rematch') {\r\n                    pos -= matched.length;\r\n                    matched = ''; // better set the next state too..\r\n                    matches = null;\r\n                    result = '';\r\n                }\r\n                // check progress\r\n                if (matched.length === 0) {\r\n                    if (stackLen0 !== stack.depth || state !== stack.state || (!groupMatching ? 0 : groupMatching.groups.length) !== groupLen0) {\r\n                        continue;\r\n                    }\r\n                    else {\r\n                        throw monarchCommon.createError(this._lexer, 'no progress in tokenizer in rule: ' + rule.name);\r\n                        pos = lineLength; // must make progress or editor loops\r\n                    }\r\n                }\r\n                // return the result (and check for brace matching)\r\n                // todo: for efficiency we could pre-sanitize tokenPostfix and substitutions\r\n                var tokenType = null;\r\n                if (monarchCommon.isString(result) && result.indexOf('@brackets') === 0) {\r\n                    var rest = result.substr('@brackets'.length);\r\n                    var bracket = findBracket(this._lexer, matched);\r\n                    if (!bracket) {\r\n                        throw monarchCommon.createError(this._lexer, '@brackets token returned but no bracket defined as: ' + matched);\r\n                        bracket = { token: '', bracketType: 0 /* None */ };\r\n                    }\r\n                    tokenType = monarchCommon.sanitize(bracket.token + rest);\r\n                }\r\n                else {\r\n                    var token = (result === '' ? '' : result + this._lexer.tokenPostfix);\r\n                    tokenType = monarchCommon.sanitize(token);\r\n                }\r\n                tokensCollector.emit(pos0 + offsetDelta, tokenType);\r\n            }\r\n            if (enteringEmbeddedMode !== null) {\r\n                // substitute language alias to known modes to support syntax highlighting\r\n                var enteringEmbeddedModeId = this._modeService.getModeIdForLanguageName(enteringEmbeddedMode);\r\n                if (enteringEmbeddedModeId) {\r\n                    enteringEmbeddedMode = enteringEmbeddedModeId;\r\n                }\r\n                var embeddedModeData_1 = this._getNestedEmbeddedModeData(enteringEmbeddedMode);\r\n                if (pos < lineLength) {\r\n                    // there is content from the embedded mode on this line\r\n                    var restOfLine = line.substr(pos);\r\n                    return this._nestedTokenize(restOfLine, MonarchLineStateFactory.create(stack, embeddedModeData_1), offsetDelta + pos, tokensCollector);\r\n                }\r\n                else {\r\n                    return MonarchLineStateFactory.create(stack, embeddedModeData_1);\r\n                }\r\n            }\r\n        }\r\n        return MonarchLineStateFactory.create(stack, embeddedModeData);\r\n    };\r\n    MonarchTokenizer.prototype._getNestedEmbeddedModeData = function (mimetypeOrModeId) {\r\n        var nestedModeId = this._locateMode(mimetypeOrModeId);\r\n        if (nestedModeId) {\r\n            var tokenizationSupport = modes.TokenizationRegistry.get(nestedModeId);\r\n            if (tokenizationSupport) {\r\n                return new EmbeddedModeData(nestedModeId, tokenizationSupport.getInitialState());\r\n            }\r\n        }\r\n        return new EmbeddedModeData(nestedModeId || NULL_MODE_ID, NULL_STATE);\r\n    };\r\n    MonarchTokenizer.prototype._locateMode = function (mimetypeOrModeId) {\r\n        if (!mimetypeOrModeId || !this._modeService.isRegisteredMode(mimetypeOrModeId)) {\r\n            return null;\r\n        }\r\n        var modeId = this._modeService.getModeId(mimetypeOrModeId);\r\n        if (modeId) {\r\n            // Fire mode loading event\r\n            this._modeService.triggerMode(modeId);\r\n            this._embeddedModes[modeId] = true;\r\n        }\r\n        return modeId;\r\n    };\r\n    return MonarchTokenizer;\r\n}());\r\n/**\r\n * Searches for a bracket in the 'brackets' attribute that matches the input.\r\n */\r\nfunction findBracket(lexer, matched) {\r\n    if (!matched) {\r\n        return null;\r\n    }\r\n    matched = monarchCommon.fixCase(lexer, matched);\r\n    var brackets = lexer.brackets;\r\n    for (var i = 0; i < brackets.length; i++) {\r\n        var bracket = brackets[i];\r\n        if (bracket.open === matched) {\r\n            return { token: bracket.token, bracketType: 1 /* Open */ };\r\n        }\r\n        else if (bracket.close === matched) {\r\n            return { token: bracket.token, bracketType: -1 /* Close */ };\r\n        }\r\n    }\r\n    return null;\r\n}\r\nexport function createTokenizationSupport(modeService, standaloneThemeService, modeId, lexer) {\r\n    return new MonarchTokenizer(modeService, standaloneThemeService, modeId, lexer);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Token, TokenizationResult, TokenizationResult2 } from '../../common/core/token.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { ModesRegistry } from '../../common/modes/modesRegistry.js';\r\nimport * as standaloneEnums from '../../common/standalone/standaloneEnums.js';\r\nimport { StaticServices } from './standaloneServices.js';\r\nimport { compile } from '../common/monarch/monarchCompile.js';\r\nimport { createTokenizationSupport } from '../common/monarch/monarchLexer.js';\r\n/**\r\n * Register information about a new language.\r\n */\r\nexport function register(language) {\r\n    ModesRegistry.registerLanguage(language);\r\n}\r\n/**\r\n * Get the information of all the registered languages.\r\n */\r\nexport function getLanguages() {\r\n    var result = [];\r\n    result = result.concat(ModesRegistry.getLanguages());\r\n    return result;\r\n}\r\nexport function getEncodedLanguageId(languageId) {\r\n    var lid = StaticServices.modeService.get().getLanguageIdentifier(languageId);\r\n    return lid ? lid.id : 0;\r\n}\r\n/**\r\n * An event emitted when a language is first time needed (e.g. a model has it set).\r\n * @event\r\n */\r\nexport function onLanguage(languageId, callback) {\r\n    var disposable = StaticServices.modeService.get().onDidCreateMode(function (mode) {\r\n        if (mode.getId() === languageId) {\r\n            // stop listening\r\n            disposable.dispose();\r\n            // invoke actual listener\r\n            callback();\r\n        }\r\n    });\r\n    return disposable;\r\n}\r\n/**\r\n * Set the editing configuration for a language.\r\n */\r\nexport function setLanguageConfiguration(languageId, configuration) {\r\n    var languageIdentifier = StaticServices.modeService.get().getLanguageIdentifier(languageId);\r\n    if (!languageIdentifier) {\r\n        throw new Error(\"Cannot set configuration for unknown language \" + languageId);\r\n    }\r\n    return LanguageConfigurationRegistry.register(languageIdentifier, configuration);\r\n}\r\n/**\r\n * @internal\r\n */\r\nvar EncodedTokenizationSupport2Adapter = /** @class */ (function () {\r\n    function EncodedTokenizationSupport2Adapter(actual) {\r\n        this._actual = actual;\r\n    }\r\n    EncodedTokenizationSupport2Adapter.prototype.getInitialState = function () {\r\n        return this._actual.getInitialState();\r\n    };\r\n    EncodedTokenizationSupport2Adapter.prototype.tokenize = function (line, state, offsetDelta) {\r\n        throw new Error('Not supported!');\r\n    };\r\n    EncodedTokenizationSupport2Adapter.prototype.tokenize2 = function (line, state) {\r\n        var result = this._actual.tokenizeEncoded(line, state);\r\n        return new TokenizationResult2(result.tokens, result.endState);\r\n    };\r\n    return EncodedTokenizationSupport2Adapter;\r\n}());\r\nexport { EncodedTokenizationSupport2Adapter };\r\n/**\r\n * @internal\r\n */\r\nvar TokenizationSupport2Adapter = /** @class */ (function () {\r\n    function TokenizationSupport2Adapter(standaloneThemeService, languageIdentifier, actual) {\r\n        this._standaloneThemeService = standaloneThemeService;\r\n        this._languageIdentifier = languageIdentifier;\r\n        this._actual = actual;\r\n    }\r\n    TokenizationSupport2Adapter.prototype.getInitialState = function () {\r\n        return this._actual.getInitialState();\r\n    };\r\n    TokenizationSupport2Adapter.prototype._toClassicTokens = function (tokens, language, offsetDelta) {\r\n        var result = [];\r\n        var previousStartIndex = 0;\r\n        for (var i = 0, len = tokens.length; i < len; i++) {\r\n            var t = tokens[i];\r\n            var startIndex = t.startIndex;\r\n            // Prevent issues stemming from a buggy external tokenizer.\r\n            if (i === 0) {\r\n                // Force first token to start at first index!\r\n                startIndex = 0;\r\n            }\r\n            else if (startIndex < previousStartIndex) {\r\n                // Force tokens to be after one another!\r\n                startIndex = previousStartIndex;\r\n            }\r\n            result[i] = new Token(startIndex + offsetDelta, t.scopes, language);\r\n            previousStartIndex = startIndex;\r\n        }\r\n        return result;\r\n    };\r\n    TokenizationSupport2Adapter.prototype.tokenize = function (line, state, offsetDelta) {\r\n        var actualResult = this._actual.tokenize(line, state);\r\n        var tokens = this._toClassicTokens(actualResult.tokens, this._languageIdentifier.language, offsetDelta);\r\n        var endState;\r\n        // try to save an object if possible\r\n        if (actualResult.endState.equals(state)) {\r\n            endState = state;\r\n        }\r\n        else {\r\n            endState = actualResult.endState;\r\n        }\r\n        return new TokenizationResult(tokens, endState);\r\n    };\r\n    TokenizationSupport2Adapter.prototype._toBinaryTokens = function (tokens, offsetDelta) {\r\n        var languageId = this._languageIdentifier.id;\r\n        var tokenTheme = this._standaloneThemeService.getTheme().tokenTheme;\r\n        var result = [], resultLen = 0;\r\n        var previousStartIndex = 0;\r\n        for (var i = 0, len = tokens.length; i < len; i++) {\r\n            var t = tokens[i];\r\n            var metadata = tokenTheme.match(languageId, t.scopes);\r\n            if (resultLen > 0 && result[resultLen - 1] === metadata) {\r\n                // same metadata\r\n                continue;\r\n            }\r\n            var startIndex = t.startIndex;\r\n            // Prevent issues stemming from a buggy external tokenizer.\r\n            if (i === 0) {\r\n                // Force first token to start at first index!\r\n                startIndex = 0;\r\n            }\r\n            else if (startIndex < previousStartIndex) {\r\n                // Force tokens to be after one another!\r\n                startIndex = previousStartIndex;\r\n            }\r\n            result[resultLen++] = startIndex + offsetDelta;\r\n            result[resultLen++] = metadata;\r\n            previousStartIndex = startIndex;\r\n        }\r\n        var actualResult = new Uint32Array(resultLen);\r\n        for (var i = 0; i < resultLen; i++) {\r\n            actualResult[i] = result[i];\r\n        }\r\n        return actualResult;\r\n    };\r\n    TokenizationSupport2Adapter.prototype.tokenize2 = function (line, state, offsetDelta) {\r\n        var actualResult = this._actual.tokenize(line, state);\r\n        var tokens = this._toBinaryTokens(actualResult.tokens, offsetDelta);\r\n        var endState;\r\n        // try to save an object if possible\r\n        if (actualResult.endState.equals(state)) {\r\n            endState = state;\r\n        }\r\n        else {\r\n            endState = actualResult.endState;\r\n        }\r\n        return new TokenizationResult2(tokens, endState);\r\n    };\r\n    return TokenizationSupport2Adapter;\r\n}());\r\nexport { TokenizationSupport2Adapter };\r\nfunction isEncodedTokensProvider(provider) {\r\n    return provider['tokenizeEncoded'];\r\n}\r\n/**\r\n * Set the tokens provider for a language (manual implementation).\r\n */\r\nexport function setTokensProvider(languageId, provider) {\r\n    var languageIdentifier = StaticServices.modeService.get().getLanguageIdentifier(languageId);\r\n    if (!languageIdentifier) {\r\n        throw new Error(\"Cannot set tokens provider for unknown language \" + languageId);\r\n    }\r\n    var adapter;\r\n    if (isEncodedTokensProvider(provider)) {\r\n        adapter = new EncodedTokenizationSupport2Adapter(provider);\r\n    }\r\n    else {\r\n        adapter = new TokenizationSupport2Adapter(StaticServices.standaloneThemeService.get(), languageIdentifier, provider);\r\n    }\r\n    return modes.TokenizationRegistry.register(languageId, adapter);\r\n}\r\n/**\r\n * Set the tokens provider for a language (monarch implementation).\r\n */\r\nexport function setMonarchTokensProvider(languageId, languageDef) {\r\n    var lexer = compile(languageId, languageDef);\r\n    var adapter = createTokenizationSupport(StaticServices.modeService.get(), StaticServices.standaloneThemeService.get(), languageId, lexer);\r\n    return modes.TokenizationRegistry.register(languageId, adapter);\r\n}\r\n/**\r\n * Register a reference provider (used by e.g. reference search).\r\n */\r\nexport function registerReferenceProvider(languageId, provider) {\r\n    return modes.ReferenceProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a rename provider (used by e.g. rename symbol).\r\n */\r\nexport function registerRenameProvider(languageId, provider) {\r\n    return modes.RenameProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a signature help provider (used by e.g. parameter hints).\r\n */\r\nexport function registerSignatureHelpProvider(languageId, provider) {\r\n    return modes.SignatureHelpProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a hover provider (used by e.g. editor hover).\r\n */\r\nexport function registerHoverProvider(languageId, provider) {\r\n    return modes.HoverProviderRegistry.register(languageId, {\r\n        provideHover: function (model, position, token) {\r\n            var word = model.getWordAtPosition(position);\r\n            return Promise.resolve(provider.provideHover(model, position, token)).then(function (value) {\r\n                if (!value) {\r\n                    return undefined;\r\n                }\r\n                if (!value.range && word) {\r\n                    value.range = new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\r\n                }\r\n                if (!value.range) {\r\n                    value.range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\r\n                }\r\n                return value;\r\n            });\r\n        }\r\n    });\r\n}\r\n/**\r\n * Register a document symbol provider (used by e.g. outline).\r\n */\r\nexport function registerDocumentSymbolProvider(languageId, provider) {\r\n    return modes.DocumentSymbolProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a document highlight provider (used by e.g. highlight occurrences).\r\n */\r\nexport function registerDocumentHighlightProvider(languageId, provider) {\r\n    return modes.DocumentHighlightProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a definition provider (used by e.g. go to definition).\r\n */\r\nexport function registerDefinitionProvider(languageId, provider) {\r\n    return modes.DefinitionProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a implementation provider (used by e.g. go to implementation).\r\n */\r\nexport function registerImplementationProvider(languageId, provider) {\r\n    return modes.ImplementationProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a type definition provider (used by e.g. go to type definition).\r\n */\r\nexport function registerTypeDefinitionProvider(languageId, provider) {\r\n    return modes.TypeDefinitionProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a code lens provider (used by e.g. inline code lenses).\r\n */\r\nexport function registerCodeLensProvider(languageId, provider) {\r\n    return modes.CodeLensProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a code action provider (used by e.g. quick fix).\r\n */\r\nexport function registerCodeActionProvider(languageId, provider) {\r\n    return modes.CodeActionProviderRegistry.register(languageId, {\r\n        provideCodeActions: function (model, range, context, token) {\r\n            var markers = StaticServices.markerService.get().read({ resource: model.uri }).filter(function (m) {\r\n                return Range.areIntersectingOrTouching(m, range);\r\n            });\r\n            return provider.provideCodeActions(model, range, { markers: markers, only: context.only }, token);\r\n        }\r\n    });\r\n}\r\n/**\r\n * Register a formatter that can handle only entire models.\r\n */\r\nexport function registerDocumentFormattingEditProvider(languageId, provider) {\r\n    return modes.DocumentFormattingEditProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a formatter that can handle a range inside a model.\r\n */\r\nexport function registerDocumentRangeFormattingEditProvider(languageId, provider) {\r\n    return modes.DocumentRangeFormattingEditProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a formatter than can do formatting as the user types.\r\n */\r\nexport function registerOnTypeFormattingEditProvider(languageId, provider) {\r\n    return modes.OnTypeFormattingEditProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a link provider that can find links in text.\r\n */\r\nexport function registerLinkProvider(languageId, provider) {\r\n    return modes.LinkProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a completion item provider (use by e.g. suggestions).\r\n */\r\nexport function registerCompletionItemProvider(languageId, provider) {\r\n    return modes.CompletionProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a document color provider (used by Color Picker, Color Decorator).\r\n */\r\nexport function registerColorProvider(languageId, provider) {\r\n    return modes.ColorProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * Register a folding range provider\r\n */\r\nexport function registerFoldingRangeProvider(languageId, provider) {\r\n    return modes.FoldingRangeProviderRegistry.register(languageId, provider);\r\n}\r\n/**\r\n * @internal\r\n */\r\nexport function createMonacoLanguagesAPI() {\r\n    return {\r\n        register: register,\r\n        getLanguages: getLanguages,\r\n        onLanguage: onLanguage,\r\n        getEncodedLanguageId: getEncodedLanguageId,\r\n        // provider methods\r\n        setLanguageConfiguration: setLanguageConfiguration,\r\n        setTokensProvider: setTokensProvider,\r\n        setMonarchTokensProvider: setMonarchTokensProvider,\r\n        registerReferenceProvider: registerReferenceProvider,\r\n        registerRenameProvider: registerRenameProvider,\r\n        registerCompletionItemProvider: registerCompletionItemProvider,\r\n        registerSignatureHelpProvider: registerSignatureHelpProvider,\r\n        registerHoverProvider: registerHoverProvider,\r\n        registerDocumentSymbolProvider: registerDocumentSymbolProvider,\r\n        registerDocumentHighlightProvider: registerDocumentHighlightProvider,\r\n        registerDefinitionProvider: registerDefinitionProvider,\r\n        registerImplementationProvider: registerImplementationProvider,\r\n        registerTypeDefinitionProvider: registerTypeDefinitionProvider,\r\n        registerCodeLensProvider: registerCodeLensProvider,\r\n        registerCodeActionProvider: registerCodeActionProvider,\r\n        registerDocumentFormattingEditProvider: registerDocumentFormattingEditProvider,\r\n        registerDocumentRangeFormattingEditProvider: registerDocumentRangeFormattingEditProvider,\r\n        registerOnTypeFormattingEditProvider: registerOnTypeFormattingEditProvider,\r\n        registerLinkProvider: registerLinkProvider,\r\n        registerColorProvider: registerColorProvider,\r\n        registerFoldingRangeProvider: registerFoldingRangeProvider,\r\n        // enums\r\n        DocumentHighlightKind: standaloneEnums.DocumentHighlightKind,\r\n        CompletionItemKind: standaloneEnums.CompletionItemKind,\r\n        CompletionItemInsertTextRule: standaloneEnums.CompletionItemInsertTextRule,\r\n        SymbolKind: standaloneEnums.SymbolKind,\r\n        IndentAction: standaloneEnums.IndentAction,\r\n        CompletionTriggerKind: standaloneEnums.CompletionTriggerKind,\r\n        SignatureHelpTriggerReason: standaloneEnums.SignatureHelpTriggerReason,\r\n        // classes\r\n        FoldingRangeKind: modes.FoldingRangeKind,\r\n    };\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { PolyfillPromise } from '../base/common/winjs.polyfill.promise.js';\r\nimport { EDITOR_DEFAULTS } from './common/config/editorOptions.js';\r\nimport { createMonacoBaseAPI } from './common/standalone/standaloneBase.js';\r\nimport { createMonacoEditorAPI } from './standalone/browser/standaloneEditor.js';\r\nimport { createMonacoLanguagesAPI } from './standalone/browser/standaloneLanguages.js';\r\nvar global = self;\r\n// When missing, polyfill the native promise\r\n// with our winjs-based polyfill\r\nif (typeof global.Promise === 'undefined') {\r\n    global.Promise = PolyfillPromise;\r\n}\r\n// Set defaults for standalone editor\r\nEDITOR_DEFAULTS.wrappingIndent = 0 /* None */;\r\nEDITOR_DEFAULTS.viewInfo.glyphMargin = false;\r\nEDITOR_DEFAULTS.autoIndent = false;\r\nvar api = createMonacoBaseAPI();\r\napi.editor = createMonacoEditorAPI();\r\napi.languages = createMonacoLanguagesAPI();\r\nexport var CancellationTokenSource = api.CancellationTokenSource;\r\nexport var Emitter = api.Emitter;\r\nexport var KeyCode = api.KeyCode;\r\nexport var KeyMod = api.KeyMod;\r\nexport var Position = api.Position;\r\nexport var Range = api.Range;\r\nexport var Selection = api.Selection;\r\nexport var SelectionDirection = api.SelectionDirection;\r\nexport var MarkerSeverity = api.MarkerSeverity;\r\nexport var MarkerTag = api.MarkerTag;\r\nexport var Promise = api.Promise;\r\nexport var Uri = api.Uri;\r\nexport var Token = api.Token;\r\nexport var editor = api.editor;\r\nexport var languages = api.languages;\r\nglobal.monaco = api;\r\nif (typeof global.require !== 'undefined' && typeof global.require.config === 'function') {\r\n    global.require.config({\r\n        ignoreDuplicateModules: [\r\n            'vscode-languageserver-types',\r\n            'vscode-languageserver-types/main',\r\n            'vscode-nls',\r\n            'vscode-nls/vscode-nls',\r\n            'jsonc-parser',\r\n            'jsonc-parser/main',\r\n            'vscode-uri',\r\n            'vscode-uri/index',\r\n            'vs/basic-languages/typescript/typescript'\r\n        ]\r\n    });\r\n}\r\n","import * as monaco from 'monaco-editor/esm/vs/editor/editor.api';\n\nfunction noop() { }\n\nexport default {\n  name: 'MonacoEditor',\n  props: {\n    diffEditor: { type: Boolean, default: false },      //是否使用diff模式\n    width: {type: [String, Number], default: '100%'},\n    height: {type: [String, Number], default: '100%'},\n    original: String,       //只有在diff模式下有效\n    value: String,\n    language: {type: String, default: 'javascript'},\n    theme: {type: String, default: 'vs'},\n    options: {type: Object, default() {return {};}},\n    editorMounted: {type: Function, default: noop},\n    editorBeforeMount: {type: Function, default: noop}\n  },\n\n  watch: {\n    options: {\n      deep: true,\n      handler(options) {\n        this.editor && this.editor.updateOptions(options)\n      }\n    },\n\n    value() {\n      this.editor && this.value !== this.editor.getValue() && this.editor.setValue(this.value);\n    },\n\n    language() {\n      if(!this.editor) return;\n      if(this.diffEditor){      //diff模式下更新language\n        const { original, modified } = this.editor.getModel();\n        monaco.editor.setModelLanguage(original, this.language);\n        monaco.editor.setModelLanguage(modified, this.language);\n      }else\n        monaco.editor.setModelLanguage(this.editor.getModel(), this.language);\n    },\n\n    theme() {\n      this.editor && monaco.editor.setTheme(this.theme);\n    },\n\n    style() {\n      this.editor && this.$nextTick(() => {\n        this.editor.layout();\n      });\n    }\n  },\n\n  computed: {\n    style() {\n      return {\n        width: !/^\\d+$/.test(this.width) ? this.width : `${this.width}px`,\n        height: !/^\\d+$/.test(this.height) ? this.height : `${this.height}px`\n      }\n    }\n  },\n\n  mounted () {\n    this.initMonaco();\n  },\n\n  beforeDestroy() {\n    this.editor && this.editor.dispose();\n  },\n\n  render (h) {\n    return (\n      <div class=\"monaco_editor_container\" style={this.style}></div>\n    );\n  },\n\n  methods: {\n    initMonaco() {\n      const { value, language, theme, options } = this;\n      Object.assign(options, this._editorBeforeMount());      //编辑器初始化前\n      this.editor = monaco.editor[this.diffEditor ? 'createDiffEditor' : 'create'](this.$el, {\n        value: this.value,\n        language: this.language,\n        theme: this.theme,\n        ...options\n      });\n      this.diffEditor && this._setModel(this.value, this.original);\n      this._editorMounted(this.editor);      //编辑器初始化后\n    },\n\n    _setModel(value, original) {     //diff模式下设置model\n      const { language } = this;\n      const originalModel = monaco.editor.createModel(original, language);\n      const modifiedModel = monaco.editor.createModel(value, language);\n      this.editor.setModel({\n        original: originalModel,\n        modified: modifiedModel\n      });\n    },\n\n    _editorBeforeMount() {\n      const options = this.editorBeforeMount(monaco);\n      return options || {};\n    },\n\n    _editorMounted(editor) {\n      this.editorMounted(editor, monaco);\n      if(this.diffEditor){\n        editor.onDidUpdateDiff(() => {\n          const value = editor.getModel().modified.getValue();\n          this._emitChange(value, event);\n        });\n      }else{\n        editor.onDidChangeModelContent(event => {\n          const value = editor.getValue();\n          this._emitChange(value, event);\n        });\n      }\n    },\n\n    _emitChange(value, event) {\n      this.$emit('change', value, event);\n      this.$emit('input', value);\n    }\n  }\n}","import './setPublicPath'\nimport mod from '~entry'\nexport default mod\nexport * from '~entry'\n","module.exports = '\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003' +\n  '\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n"],"sourceRoot":""}